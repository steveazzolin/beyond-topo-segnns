nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 1039555

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 09:33:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 09:33:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.612
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.582
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.455
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.459
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.330
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.174
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.621
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.641
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.645
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.640


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.907
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.217 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.835 +- 0.217 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.05 all KL = 0.869 +- 0.217 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.05 all L1 = 0.86 +- 0.184 (in-sample avg dev_std = 0.300)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.902
SUFF_SIMPLE for r=0.1 class 0.0 = 0.889 +- 0.213 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.838 +- 0.213 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 all KL = 0.869 +- 0.213 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 all L1 = 0.861 +- 0.181 (in-sample avg dev_std = 0.298)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.896
SUFF_SIMPLE for r=0.2 class 0.0 = 0.879 +- 0.221 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.83 +- 0.221 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all KL = 0.859 +- 0.221 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all L1 = 0.852 +- 0.188 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.887
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.814 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 all KL = 0.842 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 all L1 = 0.836 +- 0.205 (in-sample avg dev_std = 0.311)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.859
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.276 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.766 +- 0.276 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all KL = 0.825 +- 0.276 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all L1 = 0.812 +- 0.242 (in-sample avg dev_std = 0.259)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.514
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.094 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.883 +- 0.094 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.05 all KL = 0.966 +- 0.094 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.05 all L1 = 0.94 +- 0.142 (in-sample avg dev_std = 0.109)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.513
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.096 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.88 +- 0.096 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 all KL = 0.965 +- 0.096 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 all L1 = 0.939 +- 0.145 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.511
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.102 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.876 +- 0.102 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.2 all KL = 0.963 +- 0.102 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.2 all L1 = 0.936 +- 0.150 (in-sample avg dev_std = 0.101)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.508
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.114 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.868 +- 0.114 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.4 all KL = 0.958 +- 0.114 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.4 all L1 = 0.933 +- 0.160 (in-sample avg dev_std = 0.094)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.144 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.853 +- 0.144 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.144 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.180 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.735
SUFF_SIMPLE for r=0.05 class 0.0 = 0.864 +- 0.314 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.868 +- 0.314 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 all KL = 0.836 +- 0.314 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 all L1 = 0.866 +- 0.239 (in-sample avg dev_std = 0.317)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.734
SUFF_SIMPLE for r=0.1 class 0.0 = 0.864 +- 0.315 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.865 +- 0.315 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 all KL = 0.838 +- 0.315 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 all L1 = 0.865 +- 0.245 (in-sample avg dev_std = 0.305)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.737
SUFF_SIMPLE for r=0.2 class 0.0 = 0.865 +- 0.301 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.885 +- 0.301 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all KL = 0.853 +- 0.301 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all L1 = 0.875 +- 0.241 (in-sample avg dev_std = 0.244)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.734
SUFF_SIMPLE for r=0.4 class 0.0 = 0.866 +- 0.294 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.294 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all KL = 0.866 +- 0.294 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all L1 = 0.878 +- 0.249 (in-sample avg dev_std = 0.219)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.73
SUFF_SIMPLE for r=0.8 class 0.0 = 0.892 +- 0.263 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.899 +- 0.263 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.8 all KL = 0.9 +- 0.263 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.8 all L1 = 0.896 +- 0.238 (in-sample avg dev_std = 0.076)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.921
NEC for r=0.05 class 0.0 = 0.053 +- 0.182 (in-sample avg dev_std = 0.227)
NEC for r=0.05 class 1.0 = 0.202 +- 0.182 (in-sample avg dev_std = 0.227)
NEC for r=0.05 all KL = 0.121 +- 0.182 (in-sample avg dev_std = 0.227)
NEC for r=0.05 all L1 = 0.136 +- 0.173 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 0.0 = 0.046 +- 0.142 (in-sample avg dev_std = 0.210)
NEC for r=0.1 class 1.0 = 0.141 +- 0.142 (in-sample avg dev_std = 0.210)
NEC for r=0.1 all KL = 0.084 +- 0.142 (in-sample avg dev_std = 0.210)
NEC for r=0.1 all L1 = 0.099 +- 0.135 (in-sample avg dev_std = 0.210)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.952
NEC for r=0.2 class 0.0 = 0.043 +- 0.110 (in-sample avg dev_std = 0.195)
NEC for r=0.2 class 1.0 = 0.095 +- 0.110 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all KL = 0.057 +- 0.110 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all L1 = 0.072 +- 0.108 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.959
NEC for r=0.4 class 0.0 = 0.043 +- 0.095 (in-sample avg dev_std = 0.176)
NEC for r=0.4 class 1.0 = 0.074 +- 0.095 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all KL = 0.046 +- 0.095 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all L1 = 0.06 +- 0.090 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.956
NEC for r=0.8 class 0.0 = 0.048 +- 0.089 (in-sample avg dev_std = 0.164)
NEC for r=0.8 class 1.0 = 0.058 +- 0.089 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all KL = 0.037 +- 0.089 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all L1 = 0.054 +- 0.089 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.518
NEC for r=0.05 class 0.0 = 0.002 +- 0.119 (in-sample avg dev_std = 0.134)
NEC for r=0.05 class 1.0 = 0.126 +- 0.119 (in-sample avg dev_std = 0.134)
NEC for r=0.05 all KL = 0.042 +- 0.119 (in-sample avg dev_std = 0.134)
NEC for r=0.05 all L1 = 0.064 +- 0.154 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.534
NEC for r=0.1 class 0.0 = 0.001 +- 0.079 (in-sample avg dev_std = 0.134)
NEC for r=0.1 class 1.0 = 0.098 +- 0.079 (in-sample avg dev_std = 0.134)
NEC for r=0.1 all KL = 0.027 +- 0.079 (in-sample avg dev_std = 0.134)
NEC for r=0.1 all L1 = 0.05 +- 0.118 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.539
NEC for r=0.2 class 0.0 = 0.001 +- 0.056 (in-sample avg dev_std = 0.120)
NEC for r=0.2 class 1.0 = 0.072 +- 0.056 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all KL = 0.018 +- 0.056 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all L1 = 0.036 +- 0.090 (in-sample avg dev_std = 0.120)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.537
NEC for r=0.4 class 0.0 = 0.001 +- 0.042 (in-sample avg dev_std = 0.106)
NEC for r=0.4 class 1.0 = 0.058 +- 0.042 (in-sample avg dev_std = 0.106)
NEC for r=0.4 all KL = 0.013 +- 0.042 (in-sample avg dev_std = 0.106)
NEC for r=0.4 all L1 = 0.029 +- 0.074 (in-sample avg dev_std = 0.106)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.533
NEC for r=0.8 class 0.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.095)
NEC for r=0.8 class 1.0 = 0.062 +- 0.039 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all KL = 0.012 +- 0.039 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all L1 = 0.032 +- 0.078 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.642
NEC for r=0.05 class 0.0 = 0.21 +- 0.374 (in-sample avg dev_std = 0.442)
NEC for r=0.05 class 1.0 = 0.461 +- 0.374 (in-sample avg dev_std = 0.442)
NEC for r=0.05 all KL = 0.375 +- 0.374 (in-sample avg dev_std = 0.442)
NEC for r=0.05 all L1 = 0.334 +- 0.309 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.685
NEC for r=0.1 class 0.0 = 0.156 +- 0.322 (in-sample avg dev_std = 0.412)
NEC for r=0.1 class 1.0 = 0.329 +- 0.322 (in-sample avg dev_std = 0.412)
NEC for r=0.1 all KL = 0.275 +- 0.322 (in-sample avg dev_std = 0.412)
NEC for r=0.1 all L1 = 0.242 +- 0.259 (in-sample avg dev_std = 0.412)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.711
NEC for r=0.2 class 0.0 = 0.117 +- 0.281 (in-sample avg dev_std = 0.338)
NEC for r=0.2 class 1.0 = 0.229 +- 0.281 (in-sample avg dev_std = 0.338)
NEC for r=0.2 all KL = 0.195 +- 0.281 (in-sample avg dev_std = 0.338)
NEC for r=0.2 all L1 = 0.172 +- 0.226 (in-sample avg dev_std = 0.338)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.742
NEC for r=0.4 class 0.0 = 0.107 +- 0.249 (in-sample avg dev_std = 0.301)
NEC for r=0.4 class 1.0 = 0.142 +- 0.249 (in-sample avg dev_std = 0.301)
NEC for r=0.4 all KL = 0.144 +- 0.249 (in-sample avg dev_std = 0.301)
NEC for r=0.4 all L1 = 0.124 +- 0.193 (in-sample avg dev_std = 0.301)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.741
NEC for r=0.8 class 0.0 = 0.112 +- 0.261 (in-sample avg dev_std = 0.305)
NEC for r=0.8 class 1.0 = 0.117 +- 0.261 (in-sample avg dev_std = 0.305)
NEC for r=0.8 all KL = 0.14 +- 0.261 (in-sample avg dev_std = 0.305)
NEC for r=0.8 all L1 = 0.115 +- 0.194 (in-sample avg dev_std = 0.305)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 09:50:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 09:50:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.524
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.564
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.554
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.480
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.193
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.565
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.624
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.636


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.886
SUFF_SIMPLE for r=0.05 class 0.0 = 0.88 +- 0.325 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.762 +- 0.325 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all KL = 0.742 +- 0.325 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all L1 = 0.815 +- 0.215 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.894
SUFF_SIMPLE for r=0.1 class 0.0 = 0.878 +- 0.314 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.785 +- 0.314 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.314 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all L1 = 0.827 +- 0.213 (in-sample avg dev_std = 0.403)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.891
SUFF_SIMPLE for r=0.2 class 0.0 = 0.869 +- 0.316 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.79 +- 0.316 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.316 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all L1 = 0.825 +- 0.214 (in-sample avg dev_std = 0.407)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.883
SUFF_SIMPLE for r=0.4 class 0.0 = 0.87 +- 0.317 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.773 +- 0.317 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all KL = 0.766 +- 0.317 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.231 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.867
SUFF_SIMPLE for r=0.8 class 0.0 = 0.862 +- 0.322 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.762 +- 0.322 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.8 all KL = 0.776 +- 0.322 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.8 all L1 = 0.806 +- 0.265 (in-sample avg dev_std = 0.308)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.524
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.835 +- 0.198 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 all KL = 0.922 +- 0.198 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.194 (in-sample avg dev_std = 0.181)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.524
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.835 +- 0.198 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all KL = 0.923 +- 0.198 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all L1 = 0.915 +- 0.195 (in-sample avg dev_std = 0.176)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.521
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.202 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.202 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all KL = 0.922 +- 0.202 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.197 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.518
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.207 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.83 +- 0.207 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.92 +- 0.207 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.913 +- 0.201 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.223 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.82 +- 0.223 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.8 all KL = 0.916 +- 0.223 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.216 (in-sample avg dev_std = 0.138)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.707
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.369 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.807 +- 0.369 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.369 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.05 all L1 = 0.852 +- 0.249 (in-sample avg dev_std = 0.365)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.711
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.356 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.827 +- 0.356 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all KL = 0.793 +- 0.356 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all L1 = 0.865 +- 0.244 (in-sample avg dev_std = 0.335)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.71
SUFF_SIMPLE for r=0.2 class 0.0 = 0.909 +- 0.337 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.843 +- 0.337 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all KL = 0.823 +- 0.337 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all L1 = 0.876 +- 0.244 (in-sample avg dev_std = 0.308)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.707
SUFF_SIMPLE for r=0.4 class 0.0 = 0.915 +- 0.329 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.842 +- 0.329 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all KL = 0.839 +- 0.329 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all L1 = 0.879 +- 0.250 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4964
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.718
SUFF_SIMPLE for r=0.8 class 0.0 = 0.921 +- 0.285 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.88 +- 0.285 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all KL = 0.89 +- 0.285 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all L1 = 0.901 +- 0.241 (in-sample avg dev_std = 0.146)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.099 +- 0.441 (in-sample avg dev_std = 0.394)
NEC for r=0.05 class 1.0 = 0.611 +- 0.441 (in-sample avg dev_std = 0.394)
NEC for r=0.05 all KL = 0.518 +- 0.441 (in-sample avg dev_std = 0.394)
NEC for r=0.05 all L1 = 0.383 +- 0.331 (in-sample avg dev_std = 0.394)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.774
NEC for r=0.1 class 0.0 = 0.085 +- 0.408 (in-sample avg dev_std = 0.485)
NEC for r=0.1 class 1.0 = 0.468 +- 0.408 (in-sample avg dev_std = 0.485)
NEC for r=0.1 all KL = 0.444 +- 0.408 (in-sample avg dev_std = 0.485)
NEC for r=0.1 all L1 = 0.297 +- 0.284 (in-sample avg dev_std = 0.485)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.855
NEC for r=0.2 class 0.0 = 0.073 +- 0.363 (in-sample avg dev_std = 0.481)
NEC for r=0.2 class 1.0 = 0.319 +- 0.363 (in-sample avg dev_std = 0.481)
NEC for r=0.2 all KL = 0.337 +- 0.363 (in-sample avg dev_std = 0.481)
NEC for r=0.2 all L1 = 0.209 +- 0.228 (in-sample avg dev_std = 0.481)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.902
NEC for r=0.4 class 0.0 = 0.063 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.4 class 1.0 = 0.208 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.4 all KL = 0.243 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.4 all L1 = 0.143 +- 0.175 (in-sample avg dev_std = 0.421)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.933
NEC for r=0.8 class 0.0 = 0.061 +- 0.271 (in-sample avg dev_std = 0.349)
NEC for r=0.8 class 1.0 = 0.137 +- 0.271 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all KL = 0.169 +- 0.271 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all L1 = 0.103 +- 0.142 (in-sample avg dev_std = 0.349)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.005 +- 0.234 (in-sample avg dev_std = 0.137)
NEC for r=0.05 class 1.0 = 0.186 +- 0.234 (in-sample avg dev_std = 0.137)
NEC for r=0.05 all KL = 0.091 +- 0.234 (in-sample avg dev_std = 0.137)
NEC for r=0.05 all L1 = 0.097 +- 0.223 (in-sample avg dev_std = 0.137)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.516
NEC for r=0.1 class 0.0 = 0.005 +- 0.220 (in-sample avg dev_std = 0.192)
NEC for r=0.1 class 1.0 = 0.175 +- 0.220 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all KL = 0.086 +- 0.220 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.192)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.53
NEC for r=0.2 class 0.0 = 0.004 +- 0.197 (in-sample avg dev_std = 0.213)
NEC for r=0.2 class 1.0 = 0.158 +- 0.197 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.077 +- 0.197 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.081 +- 0.185 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.538
NEC for r=0.4 class 0.0 = 0.003 +- 0.168 (in-sample avg dev_std = 0.202)
NEC for r=0.4 class 1.0 = 0.14 +- 0.168 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all KL = 0.064 +- 0.168 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all L1 = 0.072 +- 0.165 (in-sample avg dev_std = 0.202)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.542
NEC for r=0.8 class 0.0 = 0.003 +- 0.147 (in-sample avg dev_std = 0.183)
NEC for r=0.8 class 1.0 = 0.131 +- 0.147 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all KL = 0.055 +- 0.147 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all L1 = 0.067 +- 0.154 (in-sample avg dev_std = 0.183)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.643
NEC for r=0.05 class 0.0 = 0.292 +- 0.452 (in-sample avg dev_std = 0.471)
NEC for r=0.05 class 1.0 = 0.563 +- 0.452 (in-sample avg dev_std = 0.471)
NEC for r=0.05 all KL = 0.59 +- 0.452 (in-sample avg dev_std = 0.471)
NEC for r=0.05 all L1 = 0.426 +- 0.354 (in-sample avg dev_std = 0.471)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.667
NEC for r=0.1 class 0.0 = 0.253 +- 0.436 (in-sample avg dev_std = 0.501)
NEC for r=0.1 class 1.0 = 0.463 +- 0.436 (in-sample avg dev_std = 0.501)
NEC for r=0.1 all KL = 0.534 +- 0.436 (in-sample avg dev_std = 0.501)
NEC for r=0.1 all L1 = 0.356 +- 0.330 (in-sample avg dev_std = 0.501)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.681
NEC for r=0.2 class 0.0 = 0.207 +- 0.420 (in-sample avg dev_std = 0.509)
NEC for r=0.2 class 1.0 = 0.367 +- 0.420 (in-sample avg dev_std = 0.509)
NEC for r=0.2 all KL = 0.453 +- 0.420 (in-sample avg dev_std = 0.509)
NEC for r=0.2 all L1 = 0.286 +- 0.303 (in-sample avg dev_std = 0.509)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.702
NEC for r=0.4 class 0.0 = 0.165 +- 0.389 (in-sample avg dev_std = 0.493)
NEC for r=0.4 class 1.0 = 0.268 +- 0.389 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all KL = 0.366 +- 0.389 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all L1 = 0.216 +- 0.260 (in-sample avg dev_std = 0.493)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.713
NEC for r=0.8 class 0.0 = 0.124 +- 0.363 (in-sample avg dev_std = 0.446)
NEC for r=0.8 class 1.0 = 0.207 +- 0.363 (in-sample avg dev_std = 0.446)
NEC for r=0.8 all KL = 0.291 +- 0.363 (in-sample avg dev_std = 0.446)
NEC for r=0.8 all L1 = 0.165 +- 0.232 (in-sample avg dev_std = 0.446)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 10:07:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 10:07:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.558
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.583
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.538
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.497
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.275
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.171
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.163
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.627
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.633
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.631


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.89
SUFF_SIMPLE for r=0.05 class 0.0 = 0.902 +- 0.270 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.79 +- 0.270 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.05 all KL = 0.808 +- 0.270 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.05 all L1 = 0.84 +- 0.195 (in-sample avg dev_std = 0.378)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.889
SUFF_SIMPLE for r=0.1 class 0.0 = 0.901 +- 0.258 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.258 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.1 all KL = 0.83 +- 0.258 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.1 all L1 = 0.849 +- 0.195 (in-sample avg dev_std = 0.342)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.896
SUFF_SIMPLE for r=0.2 class 0.0 = 0.899 +- 0.246 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.821 +- 0.246 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 all KL = 0.84 +- 0.246 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 all L1 = 0.856 +- 0.190 (in-sample avg dev_std = 0.334)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.905
SUFF_SIMPLE for r=0.4 class 0.0 = 0.893 +- 0.243 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.835 +- 0.243 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all KL = 0.857 +- 0.243 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all L1 = 0.861 +- 0.197 (in-sample avg dev_std = 0.305)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.889
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.271 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.81 +- 0.271 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 all KL = 0.848 +- 0.271 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 all L1 = 0.849 +- 0.228 (in-sample avg dev_std = 0.263)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.158 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.158 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 all KL = 0.947 +- 0.158 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.162 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.528
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.155 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.155 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 all KL = 0.948 +- 0.155 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 all L1 = 0.939 +- 0.159 (in-sample avg dev_std = 0.163)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.525
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.156 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.882 +- 0.156 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 all KL = 0.948 +- 0.156 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 all L1 = 0.939 +- 0.161 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.525
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.159 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.88 +- 0.159 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all KL = 0.947 +- 0.159 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.164 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.515
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.184 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.184 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all KL = 0.94 +- 0.184 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all L1 = 0.932 +- 0.183 (in-sample avg dev_std = 0.143)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.726
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.305 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.305 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all KL = 0.85 +- 0.305 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all L1 = 0.871 +- 0.242 (in-sample avg dev_std = 0.270)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.73
SUFF_SIMPLE for r=0.1 class 0.0 = 0.897 +- 0.295 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.86 +- 0.295 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 all KL = 0.863 +- 0.295 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.237 (in-sample avg dev_std = 0.250)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.734
SUFF_SIMPLE for r=0.2 class 0.0 = 0.9 +- 0.288 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.864 +- 0.288 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 all KL = 0.869 +- 0.288 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.235 (in-sample avg dev_std = 0.234)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.737
SUFF_SIMPLE for r=0.4 class 0.0 = 0.902 +- 0.283 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.283 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 all KL = 0.875 +- 0.283 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 all L1 = 0.886 +- 0.234 (in-sample avg dev_std = 0.213)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.736
SUFF_SIMPLE for r=0.8 class 0.0 = 0.907 +- 0.257 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.257 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.257 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.088)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.713
NEC for r=0.05 class 0.0 = 0.069 +- 0.399 (in-sample avg dev_std = 0.363)
NEC for r=0.05 class 1.0 = 0.532 +- 0.399 (in-sample avg dev_std = 0.363)
NEC for r=0.05 all KL = 0.421 +- 0.399 (in-sample avg dev_std = 0.363)
NEC for r=0.05 all L1 = 0.326 +- 0.304 (in-sample avg dev_std = 0.363)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.793
NEC for r=0.1 class 0.0 = 0.056 +- 0.358 (in-sample avg dev_std = 0.431)
NEC for r=0.1 class 1.0 = 0.408 +- 0.358 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all KL = 0.344 +- 0.358 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all L1 = 0.251 +- 0.257 (in-sample avg dev_std = 0.431)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.862
NEC for r=0.2 class 0.0 = 0.047 +- 0.312 (in-sample avg dev_std = 0.422)
NEC for r=0.2 class 1.0 = 0.284 +- 0.312 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all KL = 0.259 +- 0.312 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all L1 = 0.178 +- 0.204 (in-sample avg dev_std = 0.422)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.912
NEC for r=0.4 class 0.0 = 0.038 +- 0.246 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.186 +- 0.246 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.174 +- 0.246 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.12 +- 0.150 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.944
NEC for r=0.8 class 0.0 = 0.045 +- 0.187 (in-sample avg dev_std = 0.282)
NEC for r=0.8 class 1.0 = 0.112 +- 0.187 (in-sample avg dev_std = 0.282)
NEC for r=0.8 all KL = 0.108 +- 0.187 (in-sample avg dev_std = 0.282)
NEC for r=0.8 all L1 = 0.082 +- 0.111 (in-sample avg dev_std = 0.282)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.008 +- 0.211 (in-sample avg dev_std = 0.139)
NEC for r=0.05 class 1.0 = 0.147 +- 0.211 (in-sample avg dev_std = 0.139)
NEC for r=0.05 all KL = 0.073 +- 0.211 (in-sample avg dev_std = 0.139)
NEC for r=0.05 all L1 = 0.078 +- 0.203 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.519
NEC for r=0.1 class 0.0 = 0.007 +- 0.190 (in-sample avg dev_std = 0.184)
NEC for r=0.1 class 1.0 = 0.132 +- 0.190 (in-sample avg dev_std = 0.184)
NEC for r=0.1 all KL = 0.065 +- 0.190 (in-sample avg dev_std = 0.184)
NEC for r=0.1 all L1 = 0.07 +- 0.181 (in-sample avg dev_std = 0.184)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.531
NEC for r=0.2 class 0.0 = 0.005 +- 0.158 (in-sample avg dev_std = 0.188)
NEC for r=0.2 class 1.0 = 0.113 +- 0.158 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.053 +- 0.158 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.059 +- 0.155 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.536
NEC for r=0.4 class 0.0 = 0.004 +- 0.135 (in-sample avg dev_std = 0.177)
NEC for r=0.4 class 1.0 = 0.101 +- 0.135 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all KL = 0.045 +- 0.135 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all L1 = 0.053 +- 0.139 (in-sample avg dev_std = 0.177)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.54
NEC for r=0.8 class 0.0 = 0.003 +- 0.116 (in-sample avg dev_std = 0.163)
NEC for r=0.8 class 1.0 = 0.091 +- 0.116 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all KL = 0.037 +- 0.116 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all L1 = 0.047 +- 0.125 (in-sample avg dev_std = 0.163)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.638
NEC for r=0.05 class 0.0 = 0.276 +- 0.435 (in-sample avg dev_std = 0.460)
NEC for r=0.05 class 1.0 = 0.582 +- 0.435 (in-sample avg dev_std = 0.460)
NEC for r=0.05 all KL = 0.539 +- 0.435 (in-sample avg dev_std = 0.460)
NEC for r=0.05 all L1 = 0.427 +- 0.351 (in-sample avg dev_std = 0.460)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.676
NEC for r=0.1 class 0.0 = 0.235 +- 0.409 (in-sample avg dev_std = 0.479)
NEC for r=0.1 class 1.0 = 0.46 +- 0.409 (in-sample avg dev_std = 0.479)
NEC for r=0.1 all KL = 0.462 +- 0.409 (in-sample avg dev_std = 0.479)
NEC for r=0.1 all L1 = 0.346 +- 0.325 (in-sample avg dev_std = 0.479)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.696
NEC for r=0.2 class 0.0 = 0.187 +- 0.378 (in-sample avg dev_std = 0.469)
NEC for r=0.2 class 1.0 = 0.351 +- 0.378 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all KL = 0.37 +- 0.378 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all L1 = 0.268 +- 0.289 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.713
NEC for r=0.4 class 0.0 = 0.147 +- 0.340 (in-sample avg dev_std = 0.430)
NEC for r=0.4 class 1.0 = 0.257 +- 0.340 (in-sample avg dev_std = 0.430)
NEC for r=0.4 all KL = 0.281 +- 0.340 (in-sample avg dev_std = 0.430)
NEC for r=0.4 all L1 = 0.201 +- 0.254 (in-sample avg dev_std = 0.430)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.732
NEC for r=0.8 class 0.0 = 0.119 +- 0.309 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.189 +- 0.309 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.215 +- 0.309 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.153 +- 0.222 (in-sample avg dev_std = 0.390)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 10:25:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 10:25:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.586
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.506
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.464
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.182
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.140
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.583
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.629
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.873
SUFF_SIMPLE for r=0.05 class 0.0 = 0.911 +- 0.311 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.752 +- 0.311 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.05 all KL = 0.782 +- 0.311 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.05 all L1 = 0.823 +- 0.214 (in-sample avg dev_std = 0.424)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.892
SUFF_SIMPLE for r=0.1 class 0.0 = 0.905 +- 0.280 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.803 +- 0.280 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.1 all KL = 0.825 +- 0.280 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.1 all L1 = 0.848 +- 0.199 (in-sample avg dev_std = 0.374)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.89
SUFF_SIMPLE for r=0.2 class 0.0 = 0.904 +- 0.274 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.807 +- 0.274 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.2 all KL = 0.834 +- 0.274 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.2 all L1 = 0.85 +- 0.201 (in-sample avg dev_std = 0.368)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.89
SUFF_SIMPLE for r=0.4 class 0.0 = 0.892 +- 0.272 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.808 +- 0.272 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all KL = 0.834 +- 0.272 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.209 (in-sample avg dev_std = 0.344)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.869
SUFF_SIMPLE for r=0.8 class 0.0 = 0.875 +- 0.287 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.792 +- 0.287 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all KL = 0.833 +- 0.287 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all L1 = 0.829 +- 0.246 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.089 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.089 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.05 all KL = 0.974 +- 0.089 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.05 all L1 = 0.959 +- 0.125 (in-sample avg dev_std = 0.089)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.512
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.091 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.917 +- 0.091 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all KL = 0.973 +- 0.091 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.127 (in-sample avg dev_std = 0.090)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.511
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.096 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.914 +- 0.096 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.096 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.2 all L1 = 0.956 +- 0.132 (in-sample avg dev_std = 0.086)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.107 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.107 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 all KL = 0.969 +- 0.107 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.139 (in-sample avg dev_std = 0.083)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.502
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.899 +- 0.137 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all KL = 0.961 +- 0.137 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.157 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.7
SUFF_SIMPLE for r=0.05 class 0.0 = 0.897 +- 0.344 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.788 +- 0.344 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all KL = 0.788 +- 0.344 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all L1 = 0.843 +- 0.261 (in-sample avg dev_std = 0.376)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.705
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.331 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.331 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 all KL = 0.809 +- 0.331 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 all L1 = 0.856 +- 0.255 (in-sample avg dev_std = 0.347)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.702
SUFF_SIMPLE for r=0.2 class 0.0 = 0.913 +- 0.307 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.307 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 all KL = 0.84 +- 0.307 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 all L1 = 0.874 +- 0.245 (in-sample avg dev_std = 0.304)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.701
SUFF_SIMPLE for r=0.4 class 0.0 = 0.917 +- 0.303 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.303 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all KL = 0.846 +- 0.303 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all L1 = 0.875 +- 0.247 (in-sample avg dev_std = 0.290)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4962
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.703
SUFF_SIMPLE for r=0.8 class 0.0 = 0.916 +- 0.296 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.85 +- 0.296 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.296 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.251 (in-sample avg dev_std = 0.233)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.58
NEC for r=0.05 class 0.0 = 0.083 +- 0.444 (in-sample avg dev_std = 0.341)
NEC for r=0.05 class 1.0 = 0.694 +- 0.444 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all KL = 0.502 +- 0.444 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all L1 = 0.422 +- 0.361 (in-sample avg dev_std = 0.341)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.691
NEC for r=0.1 class 0.0 = 0.071 +- 0.418 (in-sample avg dev_std = 0.535)
NEC for r=0.1 class 1.0 = 0.578 +- 0.418 (in-sample avg dev_std = 0.535)
NEC for r=0.1 all KL = 0.454 +- 0.418 (in-sample avg dev_std = 0.535)
NEC for r=0.1 all L1 = 0.352 +- 0.314 (in-sample avg dev_std = 0.535)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.801
NEC for r=0.2 class 0.0 = 0.054 +- 0.370 (in-sample avg dev_std = 0.535)
NEC for r=0.2 class 1.0 = 0.406 +- 0.370 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all KL = 0.353 +- 0.370 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all L1 = 0.249 +- 0.257 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.869
NEC for r=0.4 class 0.0 = 0.043 +- 0.316 (in-sample avg dev_std = 0.474)
NEC for r=0.4 class 1.0 = 0.267 +- 0.316 (in-sample avg dev_std = 0.474)
NEC for r=0.4 all KL = 0.249 +- 0.316 (in-sample avg dev_std = 0.474)
NEC for r=0.4 all L1 = 0.167 +- 0.200 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.907
NEC for r=0.8 class 0.0 = 0.04 +- 0.270 (in-sample avg dev_std = 0.395)
NEC for r=0.8 class 1.0 = 0.178 +- 0.270 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all KL = 0.17 +- 0.270 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all L1 = 0.116 +- 0.158 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.05 class 1.0 = 0.109 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all KL = 0.046 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all L1 = 0.055 +- 0.171 (in-sample avg dev_std = 0.060)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 0.0 = 0.001 +- 0.144 (in-sample avg dev_std = 0.136)
NEC for r=0.1 class 1.0 = 0.096 +- 0.144 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all KL = 0.039 +- 0.144 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all L1 = 0.048 +- 0.151 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.517
NEC for r=0.2 class 0.0 = 0.0 +- 0.115 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.073 +- 0.115 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.03 +- 0.115 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.037 +- 0.120 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.522
NEC for r=0.4 class 0.0 = 0.0 +- 0.086 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.058 +- 0.086 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.021 +- 0.086 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.029 +- 0.094 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.522
NEC for r=0.8 class 0.0 = 0.0 +- 0.071 (in-sample avg dev_std = 0.121)
NEC for r=0.8 class 1.0 = 0.056 +- 0.071 (in-sample avg dev_std = 0.121)
NEC for r=0.8 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.121)
NEC for r=0.8 all L1 = 0.029 +- 0.088 (in-sample avg dev_std = 0.121)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.56
NEC for r=0.05 class 0.0 = 0.31 +- 0.448 (in-sample avg dev_std = 0.425)
NEC for r=0.05 class 1.0 = 0.668 +- 0.448 (in-sample avg dev_std = 0.425)
NEC for r=0.05 all KL = 0.581 +- 0.448 (in-sample avg dev_std = 0.425)
NEC for r=0.05 all L1 = 0.487 +- 0.376 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.591
NEC for r=0.1 class 0.0 = 0.275 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.1 class 1.0 = 0.584 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all KL = 0.536 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all L1 = 0.428 +- 0.349 (in-sample avg dev_std = 0.538)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.628
NEC for r=0.2 class 0.0 = 0.224 +- 0.404 (in-sample avg dev_std = 0.574)
NEC for r=0.2 class 1.0 = 0.467 +- 0.404 (in-sample avg dev_std = 0.574)
NEC for r=0.2 all KL = 0.457 +- 0.404 (in-sample avg dev_std = 0.574)
NEC for r=0.2 all L1 = 0.344 +- 0.315 (in-sample avg dev_std = 0.574)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.668
NEC for r=0.4 class 0.0 = 0.167 +- 0.370 (in-sample avg dev_std = 0.553)
NEC for r=0.4 class 1.0 = 0.336 +- 0.370 (in-sample avg dev_std = 0.553)
NEC for r=0.4 all KL = 0.357 +- 0.370 (in-sample avg dev_std = 0.553)
NEC for r=0.4 all L1 = 0.251 +- 0.272 (in-sample avg dev_std = 0.553)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.691
NEC for r=0.8 class 0.0 = 0.131 +- 0.344 (in-sample avg dev_std = 0.499)
NEC for r=0.8 class 1.0 = 0.258 +- 0.344 (in-sample avg dev_std = 0.499)
NEC for r=0.8 all KL = 0.287 +- 0.344 (in-sample avg dev_std = 0.499)
NEC for r=0.8 all L1 = 0.194 +- 0.244 (in-sample avg dev_std = 0.499)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 10:43:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 10:43:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.589
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.571
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.528
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.491
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.419
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.308
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.237
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.203
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.196
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.563
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.600
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.619
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.626
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.634


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.869
SUFF_SIMPLE for r=0.05 class 0.0 = 0.909 +- 0.320 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.717 +- 0.320 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all KL = 0.76 +- 0.320 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all L1 = 0.803 +- 0.222 (in-sample avg dev_std = 0.448)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.893
SUFF_SIMPLE for r=0.1 class 0.0 = 0.906 +- 0.290 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.771 +- 0.290 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all KL = 0.803 +- 0.290 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all L1 = 0.831 +- 0.198 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.91
SUFF_SIMPLE for r=0.2 class 0.0 = 0.9 +- 0.258 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.811 +- 0.258 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 all KL = 0.839 +- 0.258 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 all L1 = 0.851 +- 0.188 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.246 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.815 +- 0.246 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 all KL = 0.847 +- 0.246 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 all L1 = 0.852 +- 0.188 (in-sample avg dev_std = 0.339)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.883
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.270 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.788 +- 0.270 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all KL = 0.839 +- 0.270 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all L1 = 0.829 +- 0.234 (in-sample avg dev_std = 0.275)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.517
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.123 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.861 +- 0.123 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.123 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all L1 = 0.929 +- 0.160 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.517
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.125 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.86 +- 0.125 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.1 all KL = 0.952 +- 0.125 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.161 (in-sample avg dev_std = 0.128)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.515
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.126 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.858 +- 0.126 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 all KL = 0.952 +- 0.126 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.165 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.513
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.134 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.853 +- 0.134 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 all KL = 0.948 +- 0.134 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 all L1 = 0.925 +- 0.170 (in-sample avg dev_std = 0.115)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.505
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.165 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.165 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all KL = 0.937 +- 0.165 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.190 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.705
SUFF_SIMPLE for r=0.05 class 0.0 = 0.895 +- 0.348 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.791 +- 0.348 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.05 all KL = 0.793 +- 0.348 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.05 all L1 = 0.843 +- 0.255 (in-sample avg dev_std = 0.368)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.714
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.324 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.821 +- 0.324 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all KL = 0.829 +- 0.324 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all L1 = 0.862 +- 0.246 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.713
SUFF_SIMPLE for r=0.2 class 0.0 = 0.916 +- 0.287 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.854 +- 0.287 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all KL = 0.87 +- 0.287 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all L1 = 0.885 +- 0.233 (in-sample avg dev_std = 0.264)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.715
SUFF_SIMPLE for r=0.4 class 0.0 = 0.921 +- 0.276 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.862 +- 0.276 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all KL = 0.883 +- 0.276 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all L1 = 0.892 +- 0.231 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4960
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.711
SUFF_SIMPLE for r=0.8 class 0.0 = 0.918 +- 0.264 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.879 +- 0.264 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.264 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all L1 = 0.899 +- 0.236 (in-sample avg dev_std = 0.119)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.511
NEC for r=0.05 class 0.0 = 0.08 +- 0.453 (in-sample avg dev_std = 0.321)
NEC for r=0.05 class 1.0 = 0.775 +- 0.453 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all KL = 0.53 +- 0.453 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all L1 = 0.465 +- 0.377 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.639
NEC for r=0.1 class 0.0 = 0.067 +- 0.431 (in-sample avg dev_std = 0.545)
NEC for r=0.1 class 1.0 = 0.647 +- 0.431 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all KL = 0.48 +- 0.431 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all L1 = 0.389 +- 0.334 (in-sample avg dev_std = 0.545)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.758
NEC for r=0.2 class 0.0 = 0.057 +- 0.394 (in-sample avg dev_std = 0.575)
NEC for r=0.2 class 1.0 = 0.485 +- 0.394 (in-sample avg dev_std = 0.575)
NEC for r=0.2 all KL = 0.394 +- 0.394 (in-sample avg dev_std = 0.575)
NEC for r=0.2 all L1 = 0.294 +- 0.285 (in-sample avg dev_std = 0.575)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.856
NEC for r=0.4 class 0.0 = 0.045 +- 0.345 (in-sample avg dev_std = 0.514)
NEC for r=0.4 class 1.0 = 0.314 +- 0.345 (in-sample avg dev_std = 0.514)
NEC for r=0.4 all KL = 0.278 +- 0.345 (in-sample avg dev_std = 0.514)
NEC for r=0.4 all L1 = 0.194 +- 0.225 (in-sample avg dev_std = 0.514)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.911
NEC for r=0.8 class 0.0 = 0.041 +- 0.291 (in-sample avg dev_std = 0.432)
NEC for r=0.8 class 1.0 = 0.194 +- 0.291 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all KL = 0.184 +- 0.291 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all L1 = 0.126 +- 0.168 (in-sample avg dev_std = 0.432)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.002 +- 0.194 (in-sample avg dev_std = 0.086)
NEC for r=0.05 class 1.0 = 0.172 +- 0.194 (in-sample avg dev_std = 0.086)
NEC for r=0.05 all KL = 0.072 +- 0.194 (in-sample avg dev_std = 0.086)
NEC for r=0.05 all L1 = 0.088 +- 0.206 (in-sample avg dev_std = 0.086)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.513
NEC for r=0.1 class 0.0 = 0.002 +- 0.173 (in-sample avg dev_std = 0.169)
NEC for r=0.1 class 1.0 = 0.151 +- 0.173 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all KL = 0.062 +- 0.173 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all L1 = 0.077 +- 0.182 (in-sample avg dev_std = 0.169)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.523
NEC for r=0.2 class 0.0 = 0.002 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.2 class 1.0 = 0.126 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.049 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.064 +- 0.153 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.531
NEC for r=0.4 class 0.0 = 0.002 +- 0.109 (in-sample avg dev_std = 0.171)
NEC for r=0.4 class 1.0 = 0.104 +- 0.109 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all KL = 0.036 +- 0.109 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all L1 = 0.053 +- 0.126 (in-sample avg dev_std = 0.171)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.533
NEC for r=0.8 class 0.0 = 0.002 +- 0.087 (in-sample avg dev_std = 0.146)
NEC for r=0.8 class 1.0 = 0.095 +- 0.087 (in-sample avg dev_std = 0.146)
NEC for r=0.8 all KL = 0.028 +- 0.087 (in-sample avg dev_std = 0.146)
NEC for r=0.8 all L1 = 0.049 +- 0.112 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.556
NEC for r=0.05 class 0.0 = 0.302 +- 0.441 (in-sample avg dev_std = 0.406)
NEC for r=0.05 class 1.0 = 0.692 +- 0.441 (in-sample avg dev_std = 0.406)
NEC for r=0.05 all KL = 0.568 +- 0.441 (in-sample avg dev_std = 0.406)
NEC for r=0.05 all L1 = 0.495 +- 0.382 (in-sample avg dev_std = 0.406)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.59
NEC for r=0.1 class 0.0 = 0.269 +- 0.425 (in-sample avg dev_std = 0.550)
NEC for r=0.1 class 1.0 = 0.61 +- 0.425 (in-sample avg dev_std = 0.550)
NEC for r=0.1 all KL = 0.525 +- 0.425 (in-sample avg dev_std = 0.550)
NEC for r=0.1 all L1 = 0.437 +- 0.355 (in-sample avg dev_std = 0.550)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.628
NEC for r=0.2 class 0.0 = 0.221 +- 0.410 (in-sample avg dev_std = 0.607)
NEC for r=0.2 class 1.0 = 0.494 +- 0.410 (in-sample avg dev_std = 0.607)
NEC for r=0.2 all KL = 0.458 +- 0.410 (in-sample avg dev_std = 0.607)
NEC for r=0.2 all L1 = 0.356 +- 0.321 (in-sample avg dev_std = 0.607)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.665
NEC for r=0.4 class 0.0 = 0.164 +- 0.387 (in-sample avg dev_std = 0.587)
NEC for r=0.4 class 1.0 = 0.373 +- 0.387 (in-sample avg dev_std = 0.587)
NEC for r=0.4 all KL = 0.374 +- 0.387 (in-sample avg dev_std = 0.587)
NEC for r=0.4 all L1 = 0.267 +- 0.279 (in-sample avg dev_std = 0.587)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.692
NEC for r=0.8 class 0.0 = 0.131 +- 0.362 (in-sample avg dev_std = 0.539)
NEC for r=0.8 class 1.0 = 0.28 +- 0.362 (in-sample avg dev_std = 0.539)
NEC for r=0.8 all KL = 0.308 +- 0.362 (in-sample avg dev_std = 0.539)
NEC for r=0.8 all L1 = 0.205 +- 0.243 (in-sample avg dev_std = 0.539)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 11:00:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 11:00:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.544
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.543
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.467
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.374
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.311
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.326
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.120
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.063
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.572
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.579
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.581
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.586


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.814
SUFF_SIMPLE for r=0.05 class 0.0 = 0.887 +- 0.292 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.633 +- 0.292 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 all KL = 0.738 +- 0.292 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 all L1 = 0.747 +- 0.237 (in-sample avg dev_std = 0.444)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.836
SUFF_SIMPLE for r=0.1 class 0.0 = 0.883 +- 0.274 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.676 +- 0.274 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.274 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 all L1 = 0.769 +- 0.226 (in-sample avg dev_std = 0.408)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.849
SUFF_SIMPLE for r=0.2 class 0.0 = 0.882 +- 0.269 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.714 +- 0.269 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.2 all KL = 0.796 +- 0.269 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.2 all L1 = 0.789 +- 0.226 (in-sample avg dev_std = 0.376)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.862
SUFF_SIMPLE for r=0.4 class 0.0 = 0.881 +- 0.257 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.729 +- 0.257 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all KL = 0.808 +- 0.257 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all L1 = 0.797 +- 0.225 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.848
SUFF_SIMPLE for r=0.8 class 0.0 = 0.875 +- 0.280 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.726 +- 0.280 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.8 all KL = 0.825 +- 0.280 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.8 all L1 = 0.793 +- 0.259 (in-sample avg dev_std = 0.240)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.084 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.084 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 all KL = 0.975 +- 0.084 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 all L1 = 0.958 +- 0.120 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.082 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.918 +- 0.082 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all KL = 0.975 +- 0.082 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.120 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.080 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.919 +- 0.080 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.2 all KL = 0.976 +- 0.080 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.118 (in-sample avg dev_std = 0.052)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.081 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.918 +- 0.081 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.081 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 all L1 = 0.958 +- 0.119 (in-sample avg dev_std = 0.051)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.087 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.087 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.087 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.031)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.702
SUFF_SIMPLE for r=0.05 class 0.0 = 0.914 +- 0.313 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.313 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all KL = 0.852 +- 0.313 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.242 (in-sample avg dev_std = 0.245)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.706
SUFF_SIMPLE for r=0.1 class 0.0 = 0.916 +- 0.300 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.300 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all KL = 0.865 +- 0.300 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all L1 = 0.886 +- 0.235 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.711
SUFF_SIMPLE for r=0.2 class 0.0 = 0.925 +- 0.269 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.87 +- 0.269 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.892 +- 0.269 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.898 +- 0.229 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.714
SUFF_SIMPLE for r=0.4 class 0.0 = 0.93 +- 0.256 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.256 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.256 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.904 +- 0.226 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.708
SUFF_SIMPLE for r=0.8 class 0.0 = 0.936 +- 0.247 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.885 +- 0.247 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all KL = 0.916 +- 0.247 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.226 (in-sample avg dev_std = 0.079)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.555
NEC for r=0.05 class 0.0 = 0.119 +- 0.419 (in-sample avg dev_std = 0.354)
NEC for r=0.05 class 1.0 = 0.721 +- 0.419 (in-sample avg dev_std = 0.354)
NEC for r=0.05 all KL = 0.495 +- 0.419 (in-sample avg dev_std = 0.354)
NEC for r=0.05 all L1 = 0.453 +- 0.356 (in-sample avg dev_std = 0.354)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.661
NEC for r=0.1 class 0.0 = 0.108 +- 0.387 (in-sample avg dev_std = 0.493)
NEC for r=0.1 class 1.0 = 0.607 +- 0.387 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all KL = 0.432 +- 0.387 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all L1 = 0.384 +- 0.318 (in-sample avg dev_std = 0.493)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.757
NEC for r=0.2 class 0.0 = 0.087 +- 0.333 (in-sample avg dev_std = 0.535)
NEC for r=0.2 class 1.0 = 0.475 +- 0.333 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all KL = 0.349 +- 0.333 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all L1 = 0.302 +- 0.261 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.831
NEC for r=0.4 class 0.0 = 0.08 +- 0.277 (in-sample avg dev_std = 0.493)
NEC for r=0.4 class 1.0 = 0.345 +- 0.277 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all KL = 0.26 +- 0.277 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all L1 = 0.227 +- 0.215 (in-sample avg dev_std = 0.493)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.889
NEC for r=0.8 class 0.0 = 0.067 +- 0.217 (in-sample avg dev_std = 0.397)
NEC for r=0.8 class 1.0 = 0.218 +- 0.217 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all KL = 0.162 +- 0.217 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all L1 = 0.151 +- 0.167 (in-sample avg dev_std = 0.397)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.104 (in-sample avg dev_std = 0.023)
NEC for r=0.05 class 1.0 = 0.089 +- 0.104 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all KL = 0.031 +- 0.104 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all L1 = 0.045 +- 0.132 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.097 (in-sample avg dev_std = 0.050)
NEC for r=0.1 class 1.0 = 0.085 +- 0.097 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all KL = 0.029 +- 0.097 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all L1 = 0.043 +- 0.127 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.001 +- 0.086 (in-sample avg dev_std = 0.066)
NEC for r=0.2 class 1.0 = 0.08 +- 0.086 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all KL = 0.025 +- 0.086 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all L1 = 0.041 +- 0.118 (in-sample avg dev_std = 0.066)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
NEC for r=0.4 class 0.0 = 0.001 +- 0.075 (in-sample avg dev_std = 0.072)
NEC for r=0.4 class 1.0 = 0.073 +- 0.075 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all KL = 0.022 +- 0.075 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all L1 = 0.037 +- 0.109 (in-sample avg dev_std = 0.072)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
NEC for r=0.8 class 0.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.076)
NEC for r=0.8 class 1.0 = 0.067 +- 0.061 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all KL = 0.018 +- 0.061 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all L1 = 0.034 +- 0.098 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.573
NEC for r=0.05 class 0.0 = 0.308 +- 0.430 (in-sample avg dev_std = 0.433)
NEC for r=0.05 class 1.0 = 0.685 +- 0.430 (in-sample avg dev_std = 0.433)
NEC for r=0.05 all KL = 0.559 +- 0.430 (in-sample avg dev_std = 0.433)
NEC for r=0.05 all L1 = 0.494 +- 0.370 (in-sample avg dev_std = 0.433)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.597
NEC for r=0.1 class 0.0 = 0.272 +- 0.408 (in-sample avg dev_std = 0.558)
NEC for r=0.1 class 1.0 = 0.609 +- 0.408 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all KL = 0.514 +- 0.408 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all L1 = 0.438 +- 0.343 (in-sample avg dev_std = 0.558)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
NEC for r=0.2 class 0.0 = 0.217 +- 0.378 (in-sample avg dev_std = 0.590)
NEC for r=0.2 class 1.0 = 0.474 +- 0.378 (in-sample avg dev_std = 0.590)
NEC for r=0.2 all KL = 0.422 +- 0.378 (in-sample avg dev_std = 0.590)
NEC for r=0.2 all L1 = 0.344 +- 0.310 (in-sample avg dev_std = 0.590)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 0.0 = 0.163 +- 0.344 (in-sample avg dev_std = 0.543)
NEC for r=0.4 class 1.0 = 0.341 +- 0.344 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all KL = 0.32 +- 0.344 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all L1 = 0.251 +- 0.271 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.69
NEC for r=0.8 class 0.0 = 0.119 +- 0.312 (in-sample avg dev_std = 0.468)
NEC for r=0.8 class 1.0 = 0.239 +- 0.312 (in-sample avg dev_std = 0.468)
NEC for r=0.8 all KL = 0.237 +- 0.312 (in-sample avg dev_std = 0.468)
NEC for r=0.8 all L1 = 0.178 +- 0.234 (in-sample avg dev_std = 0.468)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 11:19:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 11:19:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.572
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.518
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.472
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.186
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.147
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.135
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.554
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.599
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.618
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.624
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.877
SUFF_SIMPLE for r=0.05 class 0.0 = 0.922 +- 0.288 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.288 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all KL = 0.816 +- 0.288 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all L1 = 0.836 +- 0.213 (in-sample avg dev_std = 0.371)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.9
SUFF_SIMPLE for r=0.1 class 0.0 = 0.918 +- 0.259 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.259 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all KL = 0.855 +- 0.259 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all L1 = 0.857 +- 0.204 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.909
SUFF_SIMPLE for r=0.2 class 0.0 = 0.914 +- 0.221 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.835 +- 0.221 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all KL = 0.878 +- 0.221 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all L1 = 0.871 +- 0.188 (in-sample avg dev_std = 0.278)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.902
SUFF_SIMPLE for r=0.4 class 0.0 = 0.905 +- 0.228 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.834 +- 0.228 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 all KL = 0.87 +- 0.228 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 all L1 = 0.865 +- 0.197 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.866
SUFF_SIMPLE for r=0.8 class 0.0 = 0.898 +- 0.285 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.781 +- 0.285 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all KL = 0.841 +- 0.285 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all L1 = 0.833 +- 0.250 (in-sample avg dev_std = 0.260)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.502
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.095 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.922 +- 0.095 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.05 all KL = 0.974 +- 0.095 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.05 all L1 = 0.961 +- 0.128 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.096 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.096 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 all KL = 0.974 +- 0.096 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 all L1 = 0.96 +- 0.129 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.502
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.098 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.921 +- 0.098 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.2 all KL = 0.973 +- 0.098 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.2 all L1 = 0.96 +- 0.130 (in-sample avg dev_std = 0.069)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.100 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.100 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all KL = 0.973 +- 0.100 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all L1 = 0.96 +- 0.132 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.121 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.121 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all KL = 0.967 +- 0.121 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.144 (in-sample avg dev_std = 0.047)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.716
SUFF_SIMPLE for r=0.05 class 0.0 = 0.919 +- 0.299 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.299 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all KL = 0.864 +- 0.299 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all L1 = 0.877 +- 0.255 (in-sample avg dev_std = 0.230)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.726
SUFF_SIMPLE for r=0.1 class 0.0 = 0.92 +- 0.281 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.857 +- 0.281 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.281 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.889 +- 0.244 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.729
SUFF_SIMPLE for r=0.2 class 0.0 = 0.919 +- 0.282 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.861 +- 0.282 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all KL = 0.882 +- 0.282 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all L1 = 0.891 +- 0.242 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.734
SUFF_SIMPLE for r=0.4 class 0.0 = 0.917 +- 0.280 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.865 +- 0.280 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.883 +- 0.280 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.891 +- 0.242 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.262 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.886 +- 0.262 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all KL = 0.904 +- 0.262 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.236 (in-sample avg dev_std = 0.085)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.537
NEC for r=0.05 class 0.0 = 0.059 +- 0.447 (in-sample avg dev_std = 0.367)
NEC for r=0.05 class 1.0 = 0.727 +- 0.447 (in-sample avg dev_std = 0.367)
NEC for r=0.05 all KL = 0.506 +- 0.447 (in-sample avg dev_std = 0.367)
NEC for r=0.05 all L1 = 0.429 +- 0.364 (in-sample avg dev_std = 0.367)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.665
NEC for r=0.1 class 0.0 = 0.051 +- 0.411 (in-sample avg dev_std = 0.515)
NEC for r=0.1 class 1.0 = 0.585 +- 0.411 (in-sample avg dev_std = 0.515)
NEC for r=0.1 all KL = 0.439 +- 0.411 (in-sample avg dev_std = 0.515)
NEC for r=0.1 all L1 = 0.347 +- 0.318 (in-sample avg dev_std = 0.515)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.779
NEC for r=0.2 class 0.0 = 0.038 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.2 class 1.0 = 0.412 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all KL = 0.328 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all L1 = 0.245 +- 0.268 (in-sample avg dev_std = 0.508)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.86
NEC for r=0.4 class 0.0 = 0.033 +- 0.308 (in-sample avg dev_std = 0.471)
NEC for r=0.4 class 1.0 = 0.277 +- 0.308 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all KL = 0.238 +- 0.308 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all L1 = 0.168 +- 0.203 (in-sample avg dev_std = 0.471)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.902
NEC for r=0.8 class 0.0 = 0.036 +- 0.256 (in-sample avg dev_std = 0.395)
NEC for r=0.8 class 1.0 = 0.189 +- 0.256 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all KL = 0.167 +- 0.256 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all L1 = 0.121 +- 0.161 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.0 +- 0.133 (in-sample avg dev_std = 0.055)
NEC for r=0.05 class 1.0 = 0.088 +- 0.133 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all KL = 0.035 +- 0.133 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all L1 = 0.044 +- 0.149 (in-sample avg dev_std = 0.055)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
NEC for r=0.1 class 0.0 = 0.0 +- 0.114 (in-sample avg dev_std = 0.110)
NEC for r=0.1 class 1.0 = 0.076 +- 0.114 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.029 +- 0.114 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.039 +- 0.130 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.507
NEC for r=0.2 class 0.0 = 0.0 +- 0.093 (in-sample avg dev_std = 0.115)
NEC for r=0.2 class 1.0 = 0.066 +- 0.093 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all KL = 0.023 +- 0.093 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all L1 = 0.033 +- 0.113 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.0 +- 0.072 (in-sample avg dev_std = 0.101)
NEC for r=0.4 class 1.0 = 0.059 +- 0.072 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all KL = 0.017 +- 0.072 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all L1 = 0.03 +- 0.099 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.511
NEC for r=0.8 class 0.0 = 0.0 +- 0.060 (in-sample avg dev_std = 0.086)
NEC for r=0.8 class 1.0 = 0.057 +- 0.060 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all KL = 0.015 +- 0.060 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all L1 = 0.029 +- 0.093 (in-sample avg dev_std = 0.086)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.552
NEC for r=0.05 class 0.0 = 0.301 +- 0.448 (in-sample avg dev_std = 0.453)
NEC for r=0.05 class 1.0 = 0.708 +- 0.448 (in-sample avg dev_std = 0.453)
NEC for r=0.05 all KL = 0.603 +- 0.448 (in-sample avg dev_std = 0.453)
NEC for r=0.05 all L1 = 0.502 +- 0.368 (in-sample avg dev_std = 0.453)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.589
NEC for r=0.1 class 0.0 = 0.259 +- 0.424 (in-sample avg dev_std = 0.545)
NEC for r=0.1 class 1.0 = 0.605 +- 0.424 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all KL = 0.552 +- 0.424 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all L1 = 0.43 +- 0.339 (in-sample avg dev_std = 0.545)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.63
NEC for r=0.2 class 0.0 = 0.201 +- 0.396 (in-sample avg dev_std = 0.554)
NEC for r=0.2 class 1.0 = 0.47 +- 0.396 (in-sample avg dev_std = 0.554)
NEC for r=0.2 all KL = 0.454 +- 0.396 (in-sample avg dev_std = 0.554)
NEC for r=0.2 all L1 = 0.334 +- 0.307 (in-sample avg dev_std = 0.554)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.673
NEC for r=0.4 class 0.0 = 0.146 +- 0.362 (in-sample avg dev_std = 0.513)
NEC for r=0.4 class 1.0 = 0.344 +- 0.362 (in-sample avg dev_std = 0.513)
NEC for r=0.4 all KL = 0.344 +- 0.362 (in-sample avg dev_std = 0.513)
NEC for r=0.4 all L1 = 0.244 +- 0.269 (in-sample avg dev_std = 0.513)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.703
NEC for r=0.8 class 0.0 = 0.115 +- 0.327 (in-sample avg dev_std = 0.454)
NEC for r=0.8 class 1.0 = 0.255 +- 0.327 (in-sample avg dev_std = 0.454)
NEC for r=0.8 all KL = 0.262 +- 0.327 (in-sample avg dev_std = 0.454)
NEC for r=0.8 all L1 = 0.184 +- 0.241 (in-sample avg dev_std = 0.454)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 11:37:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 11:37:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.520
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.497
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.408
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.300
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.219
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.266
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.161
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.055
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.528
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.538
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.529
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.536


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.807
SUFF_SIMPLE for r=0.05 class 0.0 = 0.857 +- 0.280 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.674 +- 0.280 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.802 +- 0.280 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.755 +- 0.239 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.823
SUFF_SIMPLE for r=0.1 class 0.0 = 0.859 +- 0.248 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.707 +- 0.248 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 all KL = 0.831 +- 0.248 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 all L1 = 0.775 +- 0.222 (in-sample avg dev_std = 0.295)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.84
SUFF_SIMPLE for r=0.2 class 0.0 = 0.856 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.74 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all L1 = 0.792 +- 0.213 (in-sample avg dev_std = 0.237)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.838
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.209 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.209 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all KL = 0.858 +- 0.209 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all L1 = 0.788 +- 0.213 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.806
SUFF_SIMPLE for r=0.8 class 0.0 = 0.826 +- 0.244 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.682 +- 0.244 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all KL = 0.821 +- 0.244 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all L1 = 0.747 +- 0.247 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.083 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.862 +- 0.083 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all KL = 0.963 +- 0.083 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all L1 = 0.928 +- 0.142 (in-sample avg dev_std = 0.066)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.085 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.861 +- 0.085 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 all KL = 0.962 +- 0.085 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.144 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.085 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.861 +- 0.085 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all KL = 0.962 +- 0.085 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all L1 = 0.928 +- 0.144 (in-sample avg dev_std = 0.062)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.088 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.859 +- 0.088 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all KL = 0.961 +- 0.088 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.146 (in-sample avg dev_std = 0.060)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.096 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.096 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all KL = 0.958 +- 0.096 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.151 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.622
SUFF_SIMPLE for r=0.05 class 0.0 = 0.91 +- 0.282 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.812 +- 0.282 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.05 all KL = 0.871 +- 0.282 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.05 all L1 = 0.862 +- 0.246 (in-sample avg dev_std = 0.190)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.628
SUFF_SIMPLE for r=0.1 class 0.0 = 0.913 +- 0.267 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.829 +- 0.267 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 all KL = 0.886 +- 0.267 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 all L1 = 0.871 +- 0.239 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.632
SUFF_SIMPLE for r=0.2 class 0.0 = 0.915 +- 0.261 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.261 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.891 +- 0.261 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.875 +- 0.234 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.634
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.263 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.263 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all KL = 0.89 +- 0.263 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all L1 = 0.875 +- 0.234 (in-sample avg dev_std = 0.133)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.64
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.246 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.851 +- 0.246 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.246 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all L1 = 0.886 +- 0.230 (in-sample avg dev_std = 0.046)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.15 +- 0.400 (in-sample avg dev_std = 0.292)
NEC for r=0.05 class 1.0 = 0.727 +- 0.400 (in-sample avg dev_std = 0.292)
NEC for r=0.05 all KL = 0.482 +- 0.400 (in-sample avg dev_std = 0.292)
NEC for r=0.05 all L1 = 0.47 +- 0.349 (in-sample avg dev_std = 0.292)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.626
NEC for r=0.1 class 0.0 = 0.134 +- 0.369 (in-sample avg dev_std = 0.493)
NEC for r=0.1 class 1.0 = 0.608 +- 0.369 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all KL = 0.416 +- 0.369 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all L1 = 0.397 +- 0.310 (in-sample avg dev_std = 0.493)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.732
NEC for r=0.2 class 0.0 = 0.103 +- 0.327 (in-sample avg dev_std = 0.510)
NEC for r=0.2 class 1.0 = 0.448 +- 0.327 (in-sample avg dev_std = 0.510)
NEC for r=0.2 all KL = 0.307 +- 0.327 (in-sample avg dev_std = 0.510)
NEC for r=0.2 all L1 = 0.294 +- 0.263 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.811
NEC for r=0.4 class 0.0 = 0.094 +- 0.281 (in-sample avg dev_std = 0.476)
NEC for r=0.4 class 1.0 = 0.322 +- 0.281 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all KL = 0.224 +- 0.281 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all L1 = 0.22 +- 0.218 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.861
NEC for r=0.8 class 0.0 = 0.08 +- 0.218 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.216 +- 0.218 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.146 +- 0.218 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.155 +- 0.168 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.004 +- 0.141 (in-sample avg dev_std = 0.056)
NEC for r=0.05 class 1.0 = 0.162 +- 0.141 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all KL = 0.058 +- 0.141 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all L1 = 0.084 +- 0.175 (in-sample avg dev_std = 0.056)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.004 +- 0.123 (in-sample avg dev_std = 0.102)
NEC for r=0.1 class 1.0 = 0.147 +- 0.123 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all KL = 0.05 +- 0.123 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all L1 = 0.076 +- 0.159 (in-sample avg dev_std = 0.102)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.003 +- 0.097 (in-sample avg dev_std = 0.117)
NEC for r=0.2 class 1.0 = 0.128 +- 0.097 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all KL = 0.038 +- 0.097 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all L1 = 0.066 +- 0.137 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
NEC for r=0.4 class 0.0 = 0.003 +- 0.069 (in-sample avg dev_std = 0.108)
NEC for r=0.4 class 1.0 = 0.111 +- 0.069 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all KL = 0.028 +- 0.069 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all L1 = 0.057 +- 0.116 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.51
NEC for r=0.8 class 0.0 = 0.003 +- 0.054 (in-sample avg dev_std = 0.093)
NEC for r=0.8 class 1.0 = 0.103 +- 0.054 (in-sample avg dev_std = 0.093)
NEC for r=0.8 all KL = 0.022 +- 0.054 (in-sample avg dev_std = 0.093)
NEC for r=0.8 all L1 = 0.053 +- 0.106 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.544
NEC for r=0.05 class 0.0 = 0.306 +- 0.396 (in-sample avg dev_std = 0.276)
NEC for r=0.05 class 1.0 = 0.592 +- 0.396 (in-sample avg dev_std = 0.276)
NEC for r=0.05 all KL = 0.442 +- 0.396 (in-sample avg dev_std = 0.276)
NEC for r=0.05 all L1 = 0.447 +- 0.351 (in-sample avg dev_std = 0.276)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.558
NEC for r=0.1 class 0.0 = 0.269 +- 0.382 (in-sample avg dev_std = 0.431)
NEC for r=0.1 class 1.0 = 0.529 +- 0.382 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all KL = 0.401 +- 0.382 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all L1 = 0.398 +- 0.332 (in-sample avg dev_std = 0.431)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.575
NEC for r=0.2 class 0.0 = 0.222 +- 0.356 (in-sample avg dev_std = 0.507)
NEC for r=0.2 class 1.0 = 0.45 +- 0.356 (in-sample avg dev_std = 0.507)
NEC for r=0.2 all KL = 0.349 +- 0.356 (in-sample avg dev_std = 0.507)
NEC for r=0.2 all L1 = 0.334 +- 0.302 (in-sample avg dev_std = 0.507)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.593
NEC for r=0.4 class 0.0 = 0.174 +- 0.331 (in-sample avg dev_std = 0.503)
NEC for r=0.4 class 1.0 = 0.367 +- 0.331 (in-sample avg dev_std = 0.503)
NEC for r=0.4 all KL = 0.29 +- 0.331 (in-sample avg dev_std = 0.503)
NEC for r=0.4 all L1 = 0.269 +- 0.274 (in-sample avg dev_std = 0.503)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.605
NEC for r=0.8 class 0.0 = 0.122 +- 0.295 (in-sample avg dev_std = 0.425)
NEC for r=0.8 class 1.0 = 0.275 +- 0.295 (in-sample avg dev_std = 0.425)
NEC for r=0.8 all KL = 0.215 +- 0.295 (in-sample avg dev_std = 0.425)
NEC for r=0.8 all L1 = 0.197 +- 0.247 (in-sample avg dev_std = 0.425)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 11:55:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 11:55:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.523
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.492
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.418
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.345
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.225
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.102
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.556
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.592
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.607
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.612
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.609


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.841
SUFF_SIMPLE for r=0.05 class 0.0 = 0.883 +- 0.297 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.65 +- 0.297 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.05 all KL = 0.712 +- 0.297 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.05 all L1 = 0.754 +- 0.222 (in-sample avg dev_std = 0.458)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.853
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.290 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.676 +- 0.290 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all KL = 0.737 +- 0.290 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all L1 = 0.77 +- 0.216 (in-sample avg dev_std = 0.442)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.868
SUFF_SIMPLE for r=0.2 class 0.0 = 0.883 +- 0.267 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.71 +- 0.267 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all KL = 0.763 +- 0.267 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all L1 = 0.787 +- 0.206 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.863
SUFF_SIMPLE for r=0.4 class 0.0 = 0.874 +- 0.275 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.709 +- 0.275 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.4 all KL = 0.761 +- 0.275 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.4 all L1 = 0.783 +- 0.215 (in-sample avg dev_std = 0.405)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.862
SUFF_SIMPLE for r=0.8 class 0.0 = 0.871 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.709 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 all KL = 0.782 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 all L1 = 0.781 +- 0.239 (in-sample avg dev_std = 0.318)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.5
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.154 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.838 +- 0.154 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.05 all KL = 0.94 +- 0.154 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.184 (in-sample avg dev_std = 0.083)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.151 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.151 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.151 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.182 (in-sample avg dev_std = 0.088)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.150 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.150 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.150 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.182 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.150 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.84 +- 0.150 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.150 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.182 (in-sample avg dev_std = 0.088)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.154 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.154 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.154 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.185 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.709
SUFF_SIMPLE for r=0.05 class 0.0 = 0.897 +- 0.326 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.801 +- 0.326 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.808 +- 0.326 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.85 +- 0.254 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.711
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.317 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.819 +- 0.317 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all KL = 0.828 +- 0.317 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all L1 = 0.861 +- 0.253 (in-sample avg dev_std = 0.294)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.716
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.828 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all KL = 0.842 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all L1 = 0.868 +- 0.252 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.719
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.303 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.837 +- 0.303 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.4 all KL = 0.859 +- 0.303 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.4 all L1 = 0.876 +- 0.253 (in-sample avg dev_std = 0.224)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.741
SUFF_SIMPLE for r=0.8 class 0.0 = 0.927 +- 0.253 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.888 +- 0.253 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.253 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.227 (in-sample avg dev_std = 0.089)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.635
NEC for r=0.05 class 0.0 = 0.095 +- 0.404 (in-sample avg dev_std = 0.347)
NEC for r=0.05 class 1.0 = 0.652 +- 0.404 (in-sample avg dev_std = 0.347)
NEC for r=0.05 all KL = 0.473 +- 0.404 (in-sample avg dev_std = 0.347)
NEC for r=0.05 all L1 = 0.403 +- 0.326 (in-sample avg dev_std = 0.347)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.734
NEC for r=0.1 class 0.0 = 0.087 +- 0.363 (in-sample avg dev_std = 0.450)
NEC for r=0.1 class 1.0 = 0.533 +- 0.363 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all KL = 0.405 +- 0.363 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all L1 = 0.334 +- 0.283 (in-sample avg dev_std = 0.450)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.825
NEC for r=0.2 class 0.0 = 0.076 +- 0.313 (in-sample avg dev_std = 0.472)
NEC for r=0.2 class 1.0 = 0.392 +- 0.313 (in-sample avg dev_std = 0.472)
NEC for r=0.2 all KL = 0.312 +- 0.313 (in-sample avg dev_std = 0.472)
NEC for r=0.2 all L1 = 0.251 +- 0.231 (in-sample avg dev_std = 0.472)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.868
NEC for r=0.4 class 0.0 = 0.065 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.4 class 1.0 = 0.303 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.4 all KL = 0.247 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.4 all L1 = 0.196 +- 0.189 (in-sample avg dev_std = 0.450)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.918
NEC for r=0.8 class 0.0 = 0.06 +- 0.215 (in-sample avg dev_std = 0.362)
NEC for r=0.8 class 1.0 = 0.189 +- 0.215 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all KL = 0.157 +- 0.215 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all L1 = 0.132 +- 0.151 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.169 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.169 +- 0.169 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.065 +- 0.169 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.086 +- 0.193 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.002 +- 0.164 (in-sample avg dev_std = 0.061)
NEC for r=0.1 class 1.0 = 0.166 +- 0.164 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.064 +- 0.164 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.085 +- 0.190 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.002 +- 0.154 (in-sample avg dev_std = 0.097)
NEC for r=0.2 class 1.0 = 0.16 +- 0.154 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all KL = 0.06 +- 0.154 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all L1 = 0.082 +- 0.182 (in-sample avg dev_std = 0.097)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.505
NEC for r=0.4 class 0.0 = 0.002 +- 0.139 (in-sample avg dev_std = 0.122)
NEC for r=0.4 class 1.0 = 0.15 +- 0.139 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all KL = 0.054 +- 0.139 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all L1 = 0.076 +- 0.170 (in-sample avg dev_std = 0.122)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
NEC for r=0.8 class 0.0 = 0.002 +- 0.126 (in-sample avg dev_std = 0.132)
NEC for r=0.8 class 1.0 = 0.14 +- 0.126 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all KL = 0.048 +- 0.126 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all L1 = 0.072 +- 0.160 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.603
NEC for r=0.05 class 0.0 = 0.282 +- 0.440 (in-sample avg dev_std = 0.504)
NEC for r=0.05 class 1.0 = 0.631 +- 0.440 (in-sample avg dev_std = 0.504)
NEC for r=0.05 all KL = 0.575 +- 0.440 (in-sample avg dev_std = 0.504)
NEC for r=0.05 all L1 = 0.454 +- 0.351 (in-sample avg dev_std = 0.504)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
NEC for r=0.1 class 0.0 = 0.237 +- 0.414 (in-sample avg dev_std = 0.538)
NEC for r=0.1 class 1.0 = 0.543 +- 0.414 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all KL = 0.52 +- 0.414 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all L1 = 0.388 +- 0.326 (in-sample avg dev_std = 0.538)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.66
NEC for r=0.2 class 0.0 = 0.188 +- 0.384 (in-sample avg dev_std = 0.516)
NEC for r=0.2 class 1.0 = 0.423 +- 0.384 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all KL = 0.422 +- 0.384 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all L1 = 0.304 +- 0.298 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.689
NEC for r=0.4 class 0.0 = 0.144 +- 0.353 (in-sample avg dev_std = 0.476)
NEC for r=0.4 class 1.0 = 0.32 +- 0.353 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all KL = 0.327 +- 0.353 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all L1 = 0.231 +- 0.267 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.714
NEC for r=0.8 class 0.0 = 0.119 +- 0.319 (in-sample avg dev_std = 0.432)
NEC for r=0.8 class 1.0 = 0.234 +- 0.319 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all KL = 0.25 +- 0.319 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all L1 = 0.176 +- 0.235 (in-sample avg dev_std = 0.432)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 12:13:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 12:13:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.570
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.615
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.591
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.537
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.487
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.427
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.204
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.132
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.634
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.638
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.637


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.919
SUFF_SIMPLE for r=0.05 class 0.0 = 0.9 +- 0.234 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.88 +- 0.234 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all KL = 0.873 +- 0.234 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all L1 = 0.889 +- 0.179 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.922
SUFF_SIMPLE for r=0.1 class 0.0 = 0.899 +- 0.233 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.885 +- 0.233 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.233 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all L1 = 0.891 +- 0.179 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.914
SUFF_SIMPLE for r=0.2 class 0.0 = 0.893 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.866 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 all L1 = 0.878 +- 0.189 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.902
SUFF_SIMPLE for r=0.4 class 0.0 = 0.882 +- 0.259 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.858 +- 0.259 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all KL = 0.853 +- 0.259 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all L1 = 0.869 +- 0.207 (in-sample avg dev_std = 0.308)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.881
SUFF_SIMPLE for r=0.8 class 0.0 = 0.884 +- 0.288 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.288 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all KL = 0.835 +- 0.288 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all L1 = 0.842 +- 0.246 (in-sample avg dev_std = 0.269)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.109 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.884 +- 0.109 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.962 +- 0.109 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.146 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.524
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.881 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.96 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.94 +- 0.149 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.522
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.118 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.118 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all KL = 0.958 +- 0.118 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.155 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.517
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.132 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.132 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.132 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.4 all L1 = 0.934 +- 0.165 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.509
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.165 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.165 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all KL = 0.942 +- 0.165 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all L1 = 0.927 +- 0.186 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.741
SUFF_SIMPLE for r=0.05 class 0.0 = 0.862 +- 0.321 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.894 +- 0.321 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.841 +- 0.321 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.246 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.737
SUFF_SIMPLE for r=0.1 class 0.0 = 0.86 +- 0.317 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.898 +- 0.317 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all KL = 0.847 +- 0.317 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.249 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.735
SUFF_SIMPLE for r=0.2 class 0.0 = 0.856 +- 0.321 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.896 +- 0.321 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all KL = 0.847 +- 0.321 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all L1 = 0.876 +- 0.259 (in-sample avg dev_std = 0.264)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.734
SUFF_SIMPLE for r=0.4 class 0.0 = 0.855 +- 0.327 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.327 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.327 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all L1 = 0.873 +- 0.265 (in-sample avg dev_std = 0.258)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.746
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.240 (in-sample avg dev_std = 0.079)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.893
NEC for r=0.05 class 0.0 = 0.086 +- 0.289 (in-sample avg dev_std = 0.321)
NEC for r=0.05 class 1.0 = 0.172 +- 0.289 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all KL = 0.15 +- 0.289 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all L1 = 0.133 +- 0.225 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.923
NEC for r=0.1 class 0.0 = 0.068 +- 0.243 (in-sample avg dev_std = 0.314)
NEC for r=0.1 class 1.0 = 0.12 +- 0.243 (in-sample avg dev_std = 0.314)
NEC for r=0.1 all KL = 0.114 +- 0.243 (in-sample avg dev_std = 0.314)
NEC for r=0.1 all L1 = 0.096 +- 0.174 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.954
NEC for r=0.2 class 0.0 = 0.049 +- 0.167 (in-sample avg dev_std = 0.233)
NEC for r=0.2 class 1.0 = 0.064 +- 0.167 (in-sample avg dev_std = 0.233)
NEC for r=0.2 all KL = 0.065 +- 0.167 (in-sample avg dev_std = 0.233)
NEC for r=0.2 all L1 = 0.057 +- 0.114 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.955
NEC for r=0.4 class 0.0 = 0.045 +- 0.152 (in-sample avg dev_std = 0.226)
NEC for r=0.4 class 1.0 = 0.055 +- 0.152 (in-sample avg dev_std = 0.226)
NEC for r=0.4 all KL = 0.058 +- 0.152 (in-sample avg dev_std = 0.226)
NEC for r=0.4 all L1 = 0.051 +- 0.104 (in-sample avg dev_std = 0.226)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
NEC for r=0.8 class 0.0 = 0.048 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 class 1.0 = 0.039 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all KL = 0.045 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all L1 = 0.043 +- 0.101 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.555
NEC for r=0.05 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.208)
NEC for r=0.05 class 1.0 = 0.167 +- 0.162 (in-sample avg dev_std = 0.208)
NEC for r=0.05 all KL = 0.071 +- 0.162 (in-sample avg dev_std = 0.208)
NEC for r=0.05 all L1 = 0.085 +- 0.180 (in-sample avg dev_std = 0.208)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.578
NEC for r=0.1 class 0.0 = 0.001 +- 0.129 (in-sample avg dev_std = 0.197)
NEC for r=0.1 class 1.0 = 0.143 +- 0.129 (in-sample avg dev_std = 0.197)
NEC for r=0.1 all KL = 0.057 +- 0.129 (in-sample avg dev_std = 0.197)
NEC for r=0.1 all L1 = 0.073 +- 0.154 (in-sample avg dev_std = 0.197)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.573
NEC for r=0.2 class 0.0 = 0.001 +- 0.087 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.1 +- 0.087 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.035 +- 0.087 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.051 +- 0.115 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.561
NEC for r=0.4 class 0.0 = 0.0 +- 0.057 (in-sample avg dev_std = 0.130)
NEC for r=0.4 class 1.0 = 0.072 +- 0.057 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all KL = 0.02 +- 0.057 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all L1 = 0.037 +- 0.088 (in-sample avg dev_std = 0.130)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.552
NEC for r=0.8 class 0.0 = 0.001 +- 0.049 (in-sample avg dev_std = 0.107)
NEC for r=0.8 class 1.0 = 0.068 +- 0.049 (in-sample avg dev_std = 0.107)
NEC for r=0.8 all KL = 0.016 +- 0.049 (in-sample avg dev_std = 0.107)
NEC for r=0.8 all L1 = 0.035 +- 0.084 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.631
NEC for r=0.05 class 0.0 = 0.222 +- 0.427 (in-sample avg dev_std = 0.564)
NEC for r=0.05 class 1.0 = 0.472 +- 0.427 (in-sample avg dev_std = 0.564)
NEC for r=0.05 all KL = 0.471 +- 0.427 (in-sample avg dev_std = 0.564)
NEC for r=0.05 all L1 = 0.345 +- 0.331 (in-sample avg dev_std = 0.564)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.667
NEC for r=0.1 class 0.0 = 0.165 +- 0.391 (in-sample avg dev_std = 0.541)
NEC for r=0.1 class 1.0 = 0.352 +- 0.391 (in-sample avg dev_std = 0.541)
NEC for r=0.1 all KL = 0.373 +- 0.391 (in-sample avg dev_std = 0.541)
NEC for r=0.1 all L1 = 0.257 +- 0.289 (in-sample avg dev_std = 0.541)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.698
NEC for r=0.2 class 0.0 = 0.123 +- 0.348 (in-sample avg dev_std = 0.473)
NEC for r=0.2 class 1.0 = 0.244 +- 0.348 (in-sample avg dev_std = 0.473)
NEC for r=0.2 all KL = 0.277 +- 0.348 (in-sample avg dev_std = 0.473)
NEC for r=0.2 all L1 = 0.183 +- 0.245 (in-sample avg dev_std = 0.473)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.729
NEC for r=0.4 class 0.0 = 0.11 +- 0.318 (in-sample avg dev_std = 0.393)
NEC for r=0.4 class 1.0 = 0.164 +- 0.318 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all KL = 0.208 +- 0.318 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all L1 = 0.136 +- 0.222 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 0.0 = 0.108 +- 0.310 (in-sample avg dev_std = 0.358)
NEC for r=0.8 class 1.0 = 0.119 +- 0.310 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all KL = 0.174 +- 0.310 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all L1 = 0.113 +- 0.211 (in-sample avg dev_std = 0.358)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.869, 0.869, 0.859, 0.842, 0.825], 'all_L1': [0.86, 0.861, 0.852, 0.836, 0.812]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.767, 0.765, 0.766, 0.776], 'all_L1': [0.815, 0.827, 0.825, 0.816, 0.806]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.83, 0.84, 0.857, 0.848], 'all_L1': [0.84, 0.849, 0.856, 0.861, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.782, 0.825, 0.834, 0.834, 0.833], 'all_L1': [0.823, 0.848, 0.85, 0.846, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.76, 0.803, 0.839, 0.847, 0.839], 'all_L1': [0.803, 0.831, 0.851, 0.852, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.767, 0.796, 0.808, 0.825], 'all_L1': [0.747, 0.769, 0.789, 0.797, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.855, 0.878, 0.87, 0.841], 'all_L1': [0.836, 0.857, 0.871, 0.865, 0.833]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.831, 0.858, 0.858, 0.821], 'all_L1': [0.755, 0.775, 0.792, 0.788, 0.747]}), defaultdict(<class 'list'>, {'all_KL': [0.712, 0.737, 0.763, 0.761, 0.782], 'all_L1': [0.754, 0.77, 0.787, 0.783, 0.781]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.877, 0.858, 0.853, 0.835], 'all_L1': [0.889, 0.891, 0.878, 0.869, 0.842]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.121, 0.084, 0.057, 0.046, 0.037], 'all_L1': [0.136, 0.099, 0.072, 0.06, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.444, 0.337, 0.243, 0.169], 'all_L1': [0.383, 0.297, 0.209, 0.143, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.344, 0.259, 0.174, 0.108], 'all_L1': [0.326, 0.251, 0.178, 0.12, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.454, 0.353, 0.249, 0.17], 'all_L1': [0.422, 0.352, 0.249, 0.167, 0.116]}), defaultdict(<class 'list'>, {'all_KL': [0.53, 0.48, 0.394, 0.278, 0.184], 'all_L1': [0.465, 0.389, 0.294, 0.194, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.432, 0.349, 0.26, 0.162], 'all_L1': [0.453, 0.384, 0.302, 0.227, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.506, 0.439, 0.328, 0.238, 0.167], 'all_L1': [0.429, 0.347, 0.245, 0.168, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.416, 0.307, 0.224, 0.146], 'all_L1': [0.47, 0.397, 0.294, 0.22, 0.155]}), defaultdict(<class 'list'>, {'all_KL': [0.473, 0.405, 0.312, 0.247, 0.157], 'all_L1': [0.403, 0.334, 0.251, 0.196, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.15, 0.114, 0.065, 0.058, 0.045], 'all_L1': [0.133, 0.096, 0.057, 0.051, 0.043]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.966, 0.965, 0.963, 0.958, 0.947], 'all_L1': [0.94, 0.939, 0.936, 0.933, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.922, 0.923, 0.922, 0.92, 0.916], 'all_L1': [0.915, 0.915, 0.914, 0.913, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.947, 0.948, 0.948, 0.947, 0.94], 'all_L1': [0.938, 0.939, 0.939, 0.938, 0.932]}), defaultdict(<class 'list'>, {'all_KL': [0.974, 0.973, 0.972, 0.969, 0.961], 'all_L1': [0.959, 0.958, 0.956, 0.954, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.952, 0.952, 0.948, 0.937], 'all_L1': [0.929, 0.928, 0.927, 0.925, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.975, 0.975, 0.976, 0.975, 0.973], 'all_L1': [0.958, 0.958, 0.959, 0.958, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.974, 0.974, 0.973, 0.973, 0.967], 'all_L1': [0.961, 0.96, 0.96, 0.96, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.962, 0.962, 0.961, 0.958], 'all_L1': [0.928, 0.928, 0.928, 0.927, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.94, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.917, 0.918, 0.918, 0.918, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.962, 0.96, 0.958, 0.953, 0.942], 'all_L1': [0.941, 0.94, 0.938, 0.934, 0.927]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.042, 0.027, 0.018, 0.013, 0.012], 'all_L1': [0.064, 0.05, 0.036, 0.029, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.091, 0.086, 0.077, 0.064, 0.055], 'all_L1': [0.097, 0.09, 0.081, 0.072, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.073, 0.065, 0.053, 0.045, 0.037], 'all_L1': [0.078, 0.07, 0.059, 0.053, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.039, 0.03, 0.021, 0.017], 'all_L1': [0.055, 0.048, 0.037, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.062, 0.049, 0.036, 0.028], 'all_L1': [0.088, 0.077, 0.064, 0.053, 0.049]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.029, 0.025, 0.022, 0.018], 'all_L1': [0.045, 0.043, 0.041, 0.037, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.035, 0.029, 0.023, 0.017, 0.015], 'all_L1': [0.044, 0.039, 0.033, 0.03, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.05, 0.038, 0.028, 0.022], 'all_L1': [0.084, 0.076, 0.066, 0.057, 0.053]}), defaultdict(<class 'list'>, {'all_KL': [0.065, 0.064, 0.06, 0.054, 0.048], 'all_L1': [0.086, 0.085, 0.082, 0.076, 0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.057, 0.035, 0.02, 0.016], 'all_L1': [0.085, 0.073, 0.051, 0.037, 0.035]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.836, 0.838, 0.853, 0.866, 0.9], 'all_L1': [0.866, 0.865, 0.875, 0.878, 0.896]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.793, 0.823, 0.839, 0.89], 'all_L1': [0.852, 0.865, 0.876, 0.879, 0.901]}), defaultdict(<class 'list'>, {'all_KL': [0.85, 0.863, 0.869, 0.875, 0.902], 'all_L1': [0.871, 0.879, 0.882, 0.886, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.788, 0.809, 0.84, 0.846, 0.868], 'all_L1': [0.843, 0.856, 0.874, 0.875, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.829, 0.87, 0.883, 0.902], 'all_L1': [0.843, 0.862, 0.885, 0.892, 0.899]}), defaultdict(<class 'list'>, {'all_KL': [0.852, 0.865, 0.892, 0.904, 0.916], 'all_L1': [0.878, 0.886, 0.898, 0.904, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.881, 0.882, 0.883, 0.904], 'all_L1': [0.877, 0.889, 0.891, 0.891, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.886, 0.891, 0.89, 0.908], 'all_L1': [0.862, 0.871, 0.875, 0.875, 0.886]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.828, 0.842, 0.859, 0.908], 'all_L1': [0.85, 0.861, 0.868, 0.876, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.841, 0.847, 0.847, 0.845, 0.902], 'all_L1': [0.878, 0.879, 0.876, 0.873, 0.906]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.375, 0.275, 0.195, 0.144, 0.14], 'all_L1': [0.334, 0.242, 0.172, 0.124, 0.115]}), defaultdict(<class 'list'>, {'all_KL': [0.59, 0.534, 0.453, 0.366, 0.291], 'all_L1': [0.426, 0.356, 0.286, 0.216, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.462, 0.37, 0.281, 0.215], 'all_L1': [0.427, 0.346, 0.268, 0.201, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.536, 0.457, 0.357, 0.287], 'all_L1': [0.487, 0.428, 0.344, 0.251, 0.194]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.525, 0.458, 0.374, 0.308], 'all_L1': [0.495, 0.437, 0.356, 0.267, 0.205]}), defaultdict(<class 'list'>, {'all_KL': [0.559, 0.514, 0.422, 0.32, 0.237], 'all_L1': [0.494, 0.438, 0.344, 0.251, 0.178]}), defaultdict(<class 'list'>, {'all_KL': [0.603, 0.552, 0.454, 0.344, 0.262], 'all_L1': [0.502, 0.43, 0.334, 0.244, 0.184]}), defaultdict(<class 'list'>, {'all_KL': [0.442, 0.401, 0.349, 0.29, 0.215], 'all_L1': [0.447, 0.398, 0.334, 0.269, 0.197]}), defaultdict(<class 'list'>, {'all_KL': [0.575, 0.52, 0.422, 0.327, 0.25], 'all_L1': [0.454, 0.388, 0.304, 0.231, 0.176]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.373, 0.277, 0.208, 0.174], 'all_L1': [0.345, 0.257, 0.183, 0.136, 0.113]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.812 +- 0.045, 0.828 +- 0.041, 0.835 +- 0.033, 0.831 +- 0.031, 0.812 +- 0.030
suff_simple class all_KL  =  0.790 +- 0.051, 0.816 +- 0.044, 0.829 +- 0.038, 0.830 +- 0.037, 0.823 +- 0.023
suff_simple_acc_int  =  0.868 +- 0.035, 0.880 +- 0.030, 0.886 +- 0.025, 0.885 +- 0.022, 0.863 +- 0.022
nec class all_L1  =  0.362 +- 0.121, 0.295 +- 0.107, 0.215 +- 0.084, 0.155 +- 0.058, 0.108 +- 0.036
nec class all_KL  =  0.420 +- 0.145, 0.361 +- 0.136, 0.276 +- 0.113, 0.202 +- 0.079, 0.135 +- 0.051
nec_acc_int  =  0.653 +- 0.142, 0.745 +- 0.108, 0.828 +- 0.074, 0.882 +- 0.047, 0.918 +- 0.030

Eval split val
suff_simple class all_L1  =  0.939 +- 0.016, 0.938 +- 0.016, 0.938 +- 0.016, 0.936 +- 0.016, 0.931 +- 0.016
suff_simple class all_KL  =  0.958 +- 0.016, 0.957 +- 0.016, 0.957 +- 0.016, 0.955 +- 0.016, 0.948 +- 0.016
suff_simple_acc_int  =  0.512 +- 0.011, 0.512 +- 0.011, 0.511 +- 0.009, 0.509 +- 0.009, 0.503 +- 0.005
nec class all_L1  =  0.073 +- 0.018, 0.065 +- 0.017, 0.055 +- 0.017, 0.047 +- 0.017, 0.045 +- 0.015
nec class all_KL  =  0.058 +- 0.018, 0.051 +- 0.019, 0.041 +- 0.018, 0.032 +- 0.016, 0.027 +- 0.014
nec_acc_int  =  0.507 +- 0.017, 0.517 +- 0.023, 0.523 +- 0.021, 0.525 +- 0.018, 0.525 +- 0.016

Eval split test
suff_simple class all_L1  =  0.862 +- 0.013, 0.871 +- 0.011, 0.880 +- 0.009, 0.883 +- 0.010, 0.899 +- 0.008
suff_simple class all_KL  =  0.827 +- 0.034, 0.844 +- 0.029, 0.861 +- 0.022, 0.869 +- 0.021, 0.900 +- 0.012
suff_simple_acc_int  =  0.706 +- 0.031, 0.710 +- 0.030, 0.712 +- 0.029, 0.713 +- 0.029, 0.716 +- 0.029
nec class all_L1  =  0.441 +- 0.057, 0.372 +- 0.069, 0.292 +- 0.063, 0.219 +- 0.049, 0.168 +- 0.031
nec class all_KL  =  0.530 +- 0.072, 0.469 +- 0.087, 0.386 +- 0.085, 0.301 +- 0.070, 0.238 +- 0.051
nec_acc_int  =  0.594 +- 0.039, 0.624 +- 0.043, 0.653 +- 0.041, 0.684 +- 0.040, 0.702 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.587 +- 0.045, 0.561 +- 0.042, 0.525 +- 0.035, 0.493 +- 0.023, 0.460 +- 0.014
Faith. Armon (L1)= 		  =  0.484 +- 0.130, 0.420 +- 0.129, 0.332 +- 0.114, 0.255 +- 0.086, 0.189 +- 0.057
Faith. GMean (L1)= 	  =  0.530 +- 0.097, 0.481 +- 0.099, 0.411 +- 0.093, 0.349 +- 0.073, 0.291 +- 0.051
Faith. Aritm (KL)= 		  =  0.605 +- 0.054, 0.589 +- 0.057, 0.553 +- 0.052, 0.516 +- 0.038, 0.478 +- 0.025
Faith. Armon (KL)= 		  =  0.526 +- 0.148, 0.480 +- 0.155, 0.398 +- 0.146, 0.315 +- 0.113, 0.227 +- 0.079
Faith. GMean (KL)= 	  =  0.560 +- 0.110, 0.526 +- 0.120, 0.461 +- 0.120, 0.396 +- 0.097, 0.324 +- 0.074

Eval split val
Faith. Aritm (L1)= 		  =  0.506 +- 0.004, 0.502 +- 0.003, 0.496 +- 0.004, 0.492 +- 0.005, 0.488 +- 0.005
Faith. Armon (L1)= 		  =  0.134 +- 0.031, 0.121 +- 0.031, 0.103 +- 0.031, 0.089 +- 0.030, 0.085 +- 0.027
Faith. GMean (L1)= 	  =  0.259 +- 0.032, 0.245 +- 0.032, 0.224 +- 0.034, 0.207 +- 0.035, 0.201 +- 0.032
Faith. Aritm (KL)= 		  =  0.508 +- 0.004, 0.504 +- 0.003, 0.499 +- 0.003, 0.493 +- 0.004, 0.488 +- 0.005
Faith. Armon (KL)= 		  =  0.109 +- 0.033, 0.096 +- 0.033, 0.078 +- 0.032, 0.061 +- 0.030, 0.052 +- 0.027
Faith. GMean (KL)= 	  =  0.233 +- 0.036, 0.216 +- 0.039, 0.193 +- 0.041, 0.169 +- 0.042, 0.154 +- 0.039

Eval split test
Faith. Aritm (L1)= 		  =  0.652 +- 0.027, 0.622 +- 0.035, 0.586 +- 0.034, 0.551 +- 0.027, 0.534 +- 0.015
Faith. Armon (L1)= 		  =  0.581 +- 0.052, 0.517 +- 0.071, 0.435 +- 0.076, 0.348 +- 0.066, 0.282 +- 0.044
Faith. GMean (L1)= 	  =  0.615 +- 0.040, 0.567 +- 0.055, 0.504 +- 0.060, 0.437 +- 0.054, 0.387 +- 0.037
Faith. Aritm (KL)= 		  =  0.679 +- 0.032, 0.657 +- 0.043, 0.623 +- 0.044, 0.585 +- 0.037, 0.569 +- 0.024
Faith. Armon (KL)= 		  =  0.642 +- 0.054, 0.597 +- 0.077, 0.527 +- 0.088, 0.442 +- 0.084, 0.373 +- 0.065
Faith. GMean (KL)= 	  =  0.660 +- 0.043, 0.626 +- 0.061, 0.572 +- 0.069, 0.507 +- 0.066, 0.460 +- 0.050
Computed for split load_split = id



Completed in  2:57:13.990052  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 12:30:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 12:30:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.612
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.582
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.455
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.459
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.330
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.174
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.621
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.641
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.645
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.640


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.62
SUFF_SIMPLE for r=0.05 class 0.0 = 0.75 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.394 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 all KL = 0.469 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 all L1 = 0.553 +- 0.298 (in-sample avg dev_std = 0.557)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.6
SUFF_SIMPLE for r=0.1 class 0.0 = 0.737 +- 0.386 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.394 +- 0.386 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 all KL = 0.473 +- 0.386 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 all L1 = 0.547 +- 0.309 (in-sample avg dev_std = 0.521)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.587
SUFF_SIMPLE for r=0.2 class 0.0 = 0.728 +- 0.399 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.395 +- 0.399 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all KL = 0.474 +- 0.399 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all L1 = 0.543 +- 0.324 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.541
SUFF_SIMPLE for r=0.4 class 0.0 = 0.74 +- 0.420 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.342 +- 0.420 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all KL = 0.462 +- 0.420 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.344 (in-sample avg dev_std = 0.417)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.54
SUFF_SIMPLE for r=0.8 class 0.0 = 0.835 +- 0.442 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.311 +- 0.442 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all KL = 0.516 +- 0.442 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all L1 = 0.545 +- 0.373 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 all KL = 0.935 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.036)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.1 all KL = 0.935 +- 0.177 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.1 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.033)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.178 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.841 +- 0.178 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 all KL = 0.935 +- 0.178 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.016)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.69
SUFF_SIMPLE for r=0.05 class 0.0 = 0.746 +- 0.391 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.391 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.718 +- 0.391 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.756 +- 0.309 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.692
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.385 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.786 +- 0.385 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.1 all KL = 0.737 +- 0.385 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.1 all L1 = 0.765 +- 0.318 (in-sample avg dev_std = 0.276)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.692
SUFF_SIMPLE for r=0.2 class 0.0 = 0.756 +- 0.379 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.799 +- 0.379 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.379 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.778 +- 0.320 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.682
SUFF_SIMPLE for r=0.4 class 0.0 = 0.777 +- 0.383 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.775 +- 0.383 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all KL = 0.767 +- 0.383 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.332 (in-sample avg dev_std = 0.128)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398048000000001
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.863 +- 0.285 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.285 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all KL = 0.877 +- 0.285 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all L1 = 0.866 +- 0.257 (in-sample avg dev_std = 0.013)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.532
NEC for r=0.05 class 0.0 = 0.091 +- 0.448 (in-sample avg dev_std = 0.009)
NEC for r=0.05 class 1.0 = 0.734 +- 0.448 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all KL = 0.489 +- 0.448 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all L1 = 0.447 +- 0.380 (in-sample avg dev_std = 0.009)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.537
NEC for r=0.1 class 0.0 = 0.093 +- 0.440 (in-sample avg dev_std = 0.321)
NEC for r=0.1 class 1.0 = 0.742 +- 0.440 (in-sample avg dev_std = 0.321)
NEC for r=0.1 all KL = 0.503 +- 0.440 (in-sample avg dev_std = 0.321)
NEC for r=0.1 all L1 = 0.453 +- 0.364 (in-sample avg dev_std = 0.321)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.677
NEC for r=0.2 class 0.0 = 0.09 +- 0.390 (in-sample avg dev_std = 0.441)
NEC for r=0.2 class 1.0 = 0.584 +- 0.390 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all KL = 0.414 +- 0.390 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all L1 = 0.364 +- 0.312 (in-sample avg dev_std = 0.441)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.776
NEC for r=0.4 class 0.0 = 0.095 +- 0.340 (in-sample avg dev_std = 0.458)
NEC for r=0.4 class 1.0 = 0.441 +- 0.340 (in-sample avg dev_std = 0.458)
NEC for r=0.4 all KL = 0.329 +- 0.340 (in-sample avg dev_std = 0.458)
NEC for r=0.4 all L1 = 0.287 +- 0.264 (in-sample avg dev_std = 0.458)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.79
NEC for r=0.8 class 0.0 = 0.158 +- 0.317 (in-sample avg dev_std = 0.492)
NEC for r=0.8 class 1.0 = 0.393 +- 0.317 (in-sample avg dev_std = 0.492)
NEC for r=0.8 all KL = 0.332 +- 0.317 (in-sample avg dev_std = 0.492)
NEC for r=0.8 all L1 = 0.288 +- 0.241 (in-sample avg dev_std = 0.492)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.003 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.158 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.172 (in-sample avg dev_std = 0.020)
NEC for r=0.1 class 1.0 = 0.158 +- 0.172 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all KL = 0.063 +- 0.172 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all L1 = 0.081 +- 0.195 (in-sample avg dev_std = 0.020)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.509
NEC for r=0.2 class 0.0 = 0.003 +- 0.156 (in-sample avg dev_std = 0.130)
NEC for r=0.2 class 1.0 = 0.155 +- 0.156 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all KL = 0.062 +- 0.156 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all L1 = 0.08 +- 0.181 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.513
NEC for r=0.4 class 0.0 = 0.003 +- 0.144 (in-sample avg dev_std = 0.144)
NEC for r=0.4 class 1.0 = 0.147 +- 0.144 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.057 +- 0.144 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.076 +- 0.172 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.503
NEC for r=0.8 class 0.0 = 0.002 +- 0.156 (in-sample avg dev_std = 0.106)
NEC for r=0.8 class 1.0 = 0.15 +- 0.156 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all KL = 0.058 +- 0.156 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all L1 = 0.077 +- 0.183 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.551
NEC for r=0.05 class 0.0 = 0.326 +- 0.440 (in-sample avg dev_std = 0.147)
NEC for r=0.05 class 1.0 = 0.684 +- 0.440 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all KL = 0.554 +- 0.440 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all L1 = 0.503 +- 0.383 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.565
NEC for r=0.1 class 0.0 = 0.298 +- 0.419 (in-sample avg dev_std = 0.370)
NEC for r=0.1 class 1.0 = 0.647 +- 0.419 (in-sample avg dev_std = 0.370)
NEC for r=0.1 all KL = 0.525 +- 0.419 (in-sample avg dev_std = 0.370)
NEC for r=0.1 all L1 = 0.47 +- 0.358 (in-sample avg dev_std = 0.370)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.597
NEC for r=0.2 class 0.0 = 0.244 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.2 class 1.0 = 0.55 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.2 all KL = 0.448 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.2 all L1 = 0.395 +- 0.328 (in-sample avg dev_std = 0.444)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.66
NEC for r=0.4 class 0.0 = 0.201 +- 0.353 (in-sample avg dev_std = 0.433)
NEC for r=0.4 class 1.0 = 0.383 +- 0.353 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all KL = 0.332 +- 0.353 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all L1 = 0.291 +- 0.284 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398048000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.701
NEC for r=0.8 class 0.0 = 0.212 +- 0.333 (in-sample avg dev_std = 0.404)
NEC for r=0.8 class 1.0 = 0.269 +- 0.333 (in-sample avg dev_std = 0.404)
NEC for r=0.8 all KL = 0.285 +- 0.333 (in-sample avg dev_std = 0.404)
NEC for r=0.8 all L1 = 0.24 +- 0.259 (in-sample avg dev_std = 0.404)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 12:47:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 12:47:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.524
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.564
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.554
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.480
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.193
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.565
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.624
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.636


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.771 +- 0.403 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.339 +- 0.403 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all KL = 0.405 +- 0.403 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all L1 = 0.532 +- 0.319 (in-sample avg dev_std = 0.547)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.594
SUFF_SIMPLE for r=0.1 class 0.0 = 0.779 +- 0.407 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.352 +- 0.407 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.407 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.1 all L1 = 0.542 +- 0.322 (in-sample avg dev_std = 0.541)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.591
SUFF_SIMPLE for r=0.2 class 0.0 = 0.777 +- 0.409 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.335 +- 0.409 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 all KL = 0.406 +- 0.409 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 all L1 = 0.532 +- 0.319 (in-sample avg dev_std = 0.558)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.573
SUFF_SIMPLE for r=0.4 class 0.0 = 0.811 +- 0.424 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.296 +- 0.424 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all KL = 0.416 +- 0.424 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all L1 = 0.526 +- 0.334 (in-sample avg dev_std = 0.505)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.591
SUFF_SIMPLE for r=0.8 class 0.0 = 0.847 +- 0.457 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.368 +- 0.457 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all KL = 0.529 +- 0.457 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all L1 = 0.582 +- 0.381 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.503
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.240 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.81 +- 0.240 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all KL = 0.905 +- 0.240 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.227 (in-sample avg dev_std = 0.145)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.238 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.81 +- 0.238 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all KL = 0.907 +- 0.238 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all L1 = 0.902 +- 0.228 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.5
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.238 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.81 +- 0.238 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all KL = 0.908 +- 0.238 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all L1 = 0.902 +- 0.229 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.236 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.236 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 all KL = 0.911 +- 0.236 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.231 (in-sample avg dev_std = 0.080)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.235 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.235 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all KL = 0.913 +- 0.235 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.232 (in-sample avg dev_std = 0.010)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.646
SUFF_SIMPLE for r=0.05 class 0.0 = 0.814 +- 0.444 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.607 +- 0.444 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all KL = 0.58 +- 0.444 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all L1 = 0.712 +- 0.325 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.653
SUFF_SIMPLE for r=0.1 class 0.0 = 0.832 +- 0.443 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.636 +- 0.443 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.1 all KL = 0.633 +- 0.443 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.1 all L1 = 0.735 +- 0.332 (in-sample avg dev_std = 0.389)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.649
SUFF_SIMPLE for r=0.2 class 0.0 = 0.848 +- 0.431 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.661 +- 0.431 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 all KL = 0.688 +- 0.431 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 all L1 = 0.756 +- 0.337 (in-sample avg dev_std = 0.337)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
SUFF_SIMPLE for r=0.4 class 0.0 = 0.852 +- 0.417 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.689 +- 0.417 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all KL = 0.729 +- 0.417 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all L1 = 0.772 +- 0.340 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4964
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.707
SUFF_SIMPLE for r=0.8 class 0.0 = 0.888 +- 0.310 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.310 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 all KL = 0.867 +- 0.310 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 all L1 = 0.872 +- 0.272 (in-sample avg dev_std = 0.040)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.463
NEC for r=0.05 class 0.0 = 0.109 +- 0.463 (in-sample avg dev_std = 0.058)
NEC for r=0.05 class 1.0 = 0.819 +- 0.463 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all KL = 0.567 +- 0.463 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all L1 = 0.502 +- 0.390 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.477
NEC for r=0.1 class 0.0 = 0.133 +- 0.457 (in-sample avg dev_std = 0.302)
NEC for r=0.1 class 1.0 = 0.814 +- 0.457 (in-sample avg dev_std = 0.302)
NEC for r=0.1 all KL = 0.582 +- 0.457 (in-sample avg dev_std = 0.302)
NEC for r=0.1 all L1 = 0.51 +- 0.375 (in-sample avg dev_std = 0.302)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.547
NEC for r=0.2 class 0.0 = 0.145 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.747 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.578 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.478 +- 0.351 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.621
NEC for r=0.4 class 0.0 = 0.16 +- 0.425 (in-sample avg dev_std = 0.555)
NEC for r=0.4 class 1.0 = 0.658 +- 0.425 (in-sample avg dev_std = 0.555)
NEC for r=0.4 all KL = 0.558 +- 0.425 (in-sample avg dev_std = 0.555)
NEC for r=0.4 all L1 = 0.436 +- 0.321 (in-sample avg dev_std = 0.555)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.674
NEC for r=0.8 class 0.0 = 0.195 +- 0.402 (in-sample avg dev_std = 0.602)
NEC for r=0.8 class 1.0 = 0.575 +- 0.402 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all KL = 0.546 +- 0.402 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all L1 = 0.405 +- 0.293 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.005 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.187 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.088 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.097 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.008 +- 0.237 (in-sample avg dev_std = 0.056)
NEC for r=0.1 class 1.0 = 0.187 +- 0.237 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all KL = 0.091 +- 0.237 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all L1 = 0.098 +- 0.229 (in-sample avg dev_std = 0.056)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.013 +- 0.245 (in-sample avg dev_std = 0.151)
NEC for r=0.2 class 1.0 = 0.19 +- 0.245 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all KL = 0.101 +- 0.245 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all L1 = 0.102 +- 0.228 (in-sample avg dev_std = 0.151)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.506
NEC for r=0.4 class 0.0 = 0.01 +- 0.241 (in-sample avg dev_std = 0.168)
NEC for r=0.4 class 1.0 = 0.189 +- 0.241 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all KL = 0.098 +- 0.241 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all L1 = 0.1 +- 0.225 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
NEC for r=0.8 class 0.0 = 0.007 +- 0.238 (in-sample avg dev_std = 0.168)
NEC for r=0.8 class 1.0 = 0.188 +- 0.238 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all KL = 0.096 +- 0.238 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all L1 = 0.099 +- 0.223 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.524
NEC for r=0.05 class 0.0 = 0.327 +- 0.465 (in-sample avg dev_std = 0.129)
NEC for r=0.05 class 1.0 = 0.744 +- 0.465 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all KL = 0.623 +- 0.465 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all L1 = 0.533 +- 0.395 (in-sample avg dev_std = 0.129)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.557
NEC for r=0.1 class 0.0 = 0.326 +- 0.463 (in-sample avg dev_std = 0.337)
NEC for r=0.1 class 1.0 = 0.712 +- 0.463 (in-sample avg dev_std = 0.337)
NEC for r=0.1 all KL = 0.626 +- 0.463 (in-sample avg dev_std = 0.337)
NEC for r=0.1 all L1 = 0.517 +- 0.383 (in-sample avg dev_std = 0.337)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.599
NEC for r=0.2 class 0.0 = 0.315 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.2 class 1.0 = 0.638 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all KL = 0.615 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all L1 = 0.475 +- 0.364 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.641
NEC for r=0.4 class 0.0 = 0.296 +- 0.440 (in-sample avg dev_std = 0.540)
NEC for r=0.4 class 1.0 = 0.526 +- 0.440 (in-sample avg dev_std = 0.540)
NEC for r=0.4 all KL = 0.583 +- 0.440 (in-sample avg dev_std = 0.540)
NEC for r=0.4 all L1 = 0.41 +- 0.335 (in-sample avg dev_std = 0.540)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.267 +- 0.419 (in-sample avg dev_std = 0.568)
NEC for r=0.8 class 1.0 = 0.441 +- 0.419 (in-sample avg dev_std = 0.568)
NEC for r=0.8 all KL = 0.544 +- 0.419 (in-sample avg dev_std = 0.568)
NEC for r=0.8 all L1 = 0.353 +- 0.308 (in-sample avg dev_std = 0.568)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 13:05:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 01:05:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.558
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.583
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.538
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.497
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.275
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.171
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.163
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.627
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.633
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.631


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 0.0 = 0.798 +- 0.393 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.393 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 all KL = 0.464 +- 0.393 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 all L1 = 0.562 +- 0.313 (in-sample avg dev_std = 0.536)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.815 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.376 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.1 all KL = 0.477 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.1 all L1 = 0.572 +- 0.316 (in-sample avg dev_std = 0.524)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.627
SUFF_SIMPLE for r=0.2 class 0.0 = 0.807 +- 0.397 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.388 +- 0.397 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all KL = 0.47 +- 0.397 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.310 (in-sample avg dev_std = 0.532)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.612
SUFF_SIMPLE for r=0.4 class 0.0 = 0.827 +- 0.411 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.363 +- 0.411 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.4 all KL = 0.481 +- 0.411 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.4 all L1 = 0.57 +- 0.325 (in-sample avg dev_std = 0.480)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.578
SUFF_SIMPLE for r=0.8 class 0.0 = 0.853 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.369 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.543 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.585 +- 0.376 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.216 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.216 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.211 (in-sample avg dev_std = 0.101)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.216 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.216 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.211 (in-sample avg dev_std = 0.099)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.216 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.216 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.2 all L1 = 0.922 +- 0.212 (in-sample avg dev_std = 0.080)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.046)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.686
SUFF_SIMPLE for r=0.05 class 0.0 = 0.809 +- 0.385 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.711 +- 0.385 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all KL = 0.734 +- 0.385 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all L1 = 0.76 +- 0.319 (in-sample avg dev_std = 0.246)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.688
SUFF_SIMPLE for r=0.1 class 0.0 = 0.813 +- 0.380 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.725 +- 0.380 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all KL = 0.75 +- 0.380 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all L1 = 0.77 +- 0.319 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.693
SUFF_SIMPLE for r=0.2 class 0.0 = 0.822 +- 0.376 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.728 +- 0.376 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.76 +- 0.376 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.775 +- 0.320 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.687
SUFF_SIMPLE for r=0.4 class 0.0 = 0.825 +- 0.376 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.727 +- 0.376 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all KL = 0.763 +- 0.376 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.324 (in-sample avg dev_std = 0.155)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.735
SUFF_SIMPLE for r=0.8 class 0.0 = 0.858 +- 0.284 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.284 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.284 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all L1 = 0.863 +- 0.256 (in-sample avg dev_std = 0.032)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.472
NEC for r=0.05 class 0.0 = 0.086 +- 0.459 (in-sample avg dev_std = 0.094)
NEC for r=0.05 class 1.0 = 0.795 +- 0.459 (in-sample avg dev_std = 0.094)
NEC for r=0.05 all KL = 0.534 +- 0.459 (in-sample avg dev_std = 0.094)
NEC for r=0.05 all L1 = 0.479 +- 0.390 (in-sample avg dev_std = 0.094)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.471
NEC for r=0.1 class 0.0 = 0.105 +- 0.455 (in-sample avg dev_std = 0.292)
NEC for r=0.1 class 1.0 = 0.803 +- 0.455 (in-sample avg dev_std = 0.292)
NEC for r=0.1 all KL = 0.555 +- 0.455 (in-sample avg dev_std = 0.292)
NEC for r=0.1 all L1 = 0.492 +- 0.377 (in-sample avg dev_std = 0.292)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.531
NEC for r=0.2 class 0.0 = 0.115 +- 0.443 (in-sample avg dev_std = 0.457)
NEC for r=0.2 class 1.0 = 0.759 +- 0.443 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all KL = 0.549 +- 0.443 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all L1 = 0.472 +- 0.354 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.608
NEC for r=0.4 class 0.0 = 0.14 +- 0.412 (in-sample avg dev_std = 0.526)
NEC for r=0.4 class 1.0 = 0.654 +- 0.412 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all KL = 0.52 +- 0.412 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all L1 = 0.425 +- 0.319 (in-sample avg dev_std = 0.526)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.692
NEC for r=0.8 class 0.0 = 0.155 +- 0.383 (in-sample avg dev_std = 0.552)
NEC for r=0.8 class 1.0 = 0.538 +- 0.383 (in-sample avg dev_std = 0.552)
NEC for r=0.8 all KL = 0.467 +- 0.383 (in-sample avg dev_std = 0.552)
NEC for r=0.8 all L1 = 0.367 +- 0.289 (in-sample avg dev_std = 0.552)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.495
NEC for r=0.05 class 0.0 = 0.017 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.147 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.215 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.022 +- 0.224 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.145 +- 0.224 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.079 +- 0.224 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.084 +- 0.213 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.018 +- 0.226 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.149 +- 0.226 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.084 +- 0.226 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.084 +- 0.210 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
NEC for r=0.4 class 0.0 = 0.014 +- 0.218 (in-sample avg dev_std = 0.176)
NEC for r=0.4 class 1.0 = 0.147 +- 0.218 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all KL = 0.08 +- 0.218 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all L1 = 0.081 +- 0.204 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
NEC for r=0.8 class 0.0 = 0.008 +- 0.208 (in-sample avg dev_std = 0.168)
NEC for r=0.8 class 1.0 = 0.145 +- 0.208 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all KL = 0.074 +- 0.208 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all L1 = 0.077 +- 0.199 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.533
NEC for r=0.05 class 0.0 = 0.306 +- 0.452 (in-sample avg dev_std = 0.147)
NEC for r=0.05 class 1.0 = 0.729 +- 0.452 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all KL = 0.576 +- 0.452 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all L1 = 0.515 +- 0.385 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.56
NEC for r=0.1 class 0.0 = 0.308 +- 0.450 (in-sample avg dev_std = 0.317)
NEC for r=0.1 class 1.0 = 0.71 +- 0.450 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all KL = 0.586 +- 0.450 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all L1 = 0.507 +- 0.377 (in-sample avg dev_std = 0.317)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.606
NEC for r=0.2 class 0.0 = 0.295 +- 0.437 (in-sample avg dev_std = 0.443)
NEC for r=0.2 class 1.0 = 0.638 +- 0.437 (in-sample avg dev_std = 0.443)
NEC for r=0.2 all KL = 0.57 +- 0.437 (in-sample avg dev_std = 0.443)
NEC for r=0.2 all L1 = 0.464 +- 0.356 (in-sample avg dev_std = 0.443)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.647
NEC for r=0.4 class 0.0 = 0.276 +- 0.414 (in-sample avg dev_std = 0.496)
NEC for r=0.4 class 1.0 = 0.517 +- 0.414 (in-sample avg dev_std = 0.496)
NEC for r=0.4 all KL = 0.514 +- 0.414 (in-sample avg dev_std = 0.496)
NEC for r=0.4 all L1 = 0.395 +- 0.328 (in-sample avg dev_std = 0.496)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.682
NEC for r=0.8 class 0.0 = 0.247 +- 0.386 (in-sample avg dev_std = 0.506)
NEC for r=0.8 class 1.0 = 0.405 +- 0.386 (in-sample avg dev_std = 0.506)
NEC for r=0.8 all KL = 0.44 +- 0.386 (in-sample avg dev_std = 0.506)
NEC for r=0.8 all L1 = 0.325 +- 0.299 (in-sample avg dev_std = 0.506)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 13:21:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 01:21:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.586
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.506
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.464
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.182
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.140
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.583
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.629
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.59
SUFF_SIMPLE for r=0.05 class 0.0 = 0.825 +- 0.410 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.311 +- 0.410 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.05 all KL = 0.459 +- 0.410 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.05 all L1 = 0.54 +- 0.325 (in-sample avg dev_std = 0.503)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.599
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.407 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.331 +- 0.407 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.1 all KL = 0.475 +- 0.407 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.1 all L1 = 0.55 +- 0.327 (in-sample avg dev_std = 0.469)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.589
SUFF_SIMPLE for r=0.2 class 0.0 = 0.832 +- 0.410 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.306 +- 0.410 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.2 all KL = 0.463 +- 0.410 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.2 all L1 = 0.54 +- 0.328 (in-sample avg dev_std = 0.473)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.559
SUFF_SIMPLE for r=0.4 class 0.0 = 0.844 +- 0.424 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.271 +- 0.424 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.424 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all L1 = 0.526 +- 0.343 (in-sample avg dev_std = 0.417)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.598
SUFF_SIMPLE for r=0.8 class 0.0 = 0.84 +- 0.437 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.373 +- 0.437 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all KL = 0.543 +- 0.437 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all L1 = 0.581 +- 0.368 (in-sample avg dev_std = 0.203)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.017)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.009)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.005)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.639
SUFF_SIMPLE for r=0.05 class 0.0 = 0.807 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.574 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all KL = 0.6 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all L1 = 0.692 +- 0.328 (in-sample avg dev_std = 0.473)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.644
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.411 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.598 +- 0.411 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all KL = 0.635 +- 0.411 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all L1 = 0.711 +- 0.332 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.637
SUFF_SIMPLE for r=0.2 class 0.0 = 0.834 +- 0.405 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.625 +- 0.405 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all KL = 0.669 +- 0.405 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all L1 = 0.731 +- 0.333 (in-sample avg dev_std = 0.395)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.635
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.410 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.632 +- 0.410 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all KL = 0.683 +- 0.410 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all L1 = 0.736 +- 0.338 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4962
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.350 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.792 +- 0.350 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all KL = 0.827 +- 0.350 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all L1 = 0.837 +- 0.308 (in-sample avg dev_std = 0.116)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.459
NEC for r=0.05 class 0.0 = 0.105 +- 0.461 (in-sample avg dev_std = 0.013)
NEC for r=0.05 class 1.0 = 0.813 +- 0.461 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all KL = 0.548 +- 0.461 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all L1 = 0.497 +- 0.388 (in-sample avg dev_std = 0.013)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.45
NEC for r=0.1 class 0.0 = 0.115 +- 0.459 (in-sample avg dev_std = 0.158)
NEC for r=0.1 class 1.0 = 0.824 +- 0.459 (in-sample avg dev_std = 0.158)
NEC for r=0.1 all KL = 0.562 +- 0.459 (in-sample avg dev_std = 0.158)
NEC for r=0.1 all L1 = 0.508 +- 0.385 (in-sample avg dev_std = 0.158)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.494
NEC for r=0.2 class 0.0 = 0.113 +- 0.454 (in-sample avg dev_std = 0.351)
NEC for r=0.2 class 1.0 = 0.791 +- 0.454 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all KL = 0.551 +- 0.454 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all L1 = 0.488 +- 0.373 (in-sample avg dev_std = 0.351)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.582
NEC for r=0.4 class 0.0 = 0.109 +- 0.439 (in-sample avg dev_std = 0.526)
NEC for r=0.4 class 1.0 = 0.712 +- 0.439 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all KL = 0.524 +- 0.439 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all L1 = 0.443 +- 0.345 (in-sample avg dev_std = 0.526)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.664
NEC for r=0.8 class 0.0 = 0.141 +- 0.404 (in-sample avg dev_std = 0.603)
NEC for r=0.8 class 1.0 = 0.612 +- 0.404 (in-sample avg dev_std = 0.603)
NEC for r=0.8 all KL = 0.495 +- 0.404 (in-sample avg dev_std = 0.603)
NEC for r=0.8 all L1 = 0.402 +- 0.303 (in-sample avg dev_std = 0.603)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.173 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.161 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.109 +- 0.161 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.047 +- 0.161 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.057 +- 0.172 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.166 (in-sample avg dev_std = 0.048)
NEC for r=0.2 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.048)
NEC for r=0.2 all KL = 0.049 +- 0.166 (in-sample avg dev_std = 0.048)
NEC for r=0.2 all L1 = 0.057 +- 0.174 (in-sample avg dev_std = 0.048)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.001 +- 0.161 (in-sample avg dev_std = 0.073)
NEC for r=0.4 class 1.0 = 0.108 +- 0.161 (in-sample avg dev_std = 0.073)
NEC for r=0.4 all KL = 0.047 +- 0.161 (in-sample avg dev_std = 0.073)
NEC for r=0.4 all L1 = 0.055 +- 0.170 (in-sample avg dev_std = 0.073)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.001 +- 0.160 (in-sample avg dev_std = 0.066)
NEC for r=0.8 class 1.0 = 0.109 +- 0.160 (in-sample avg dev_std = 0.066)
NEC for r=0.8 all KL = 0.046 +- 0.160 (in-sample avg dev_std = 0.066)
NEC for r=0.8 all L1 = 0.055 +- 0.170 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.519
NEC for r=0.05 class 0.0 = 0.33 +- 0.463 (in-sample avg dev_std = 0.085)
NEC for r=0.05 class 1.0 = 0.732 +- 0.463 (in-sample avg dev_std = 0.085)
NEC for r=0.05 all KL = 0.609 +- 0.463 (in-sample avg dev_std = 0.085)
NEC for r=0.05 all L1 = 0.529 +- 0.395 (in-sample avg dev_std = 0.085)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.523
NEC for r=0.1 class 0.0 = 0.333 +- 0.459 (in-sample avg dev_std = 0.240)
NEC for r=0.1 class 1.0 = 0.728 +- 0.459 (in-sample avg dev_std = 0.240)
NEC for r=0.1 all KL = 0.613 +- 0.459 (in-sample avg dev_std = 0.240)
NEC for r=0.1 all L1 = 0.528 +- 0.390 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.324 +- 0.449 (in-sample avg dev_std = 0.405)
NEC for r=0.2 class 1.0 = 0.686 +- 0.449 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all KL = 0.596 +- 0.449 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all L1 = 0.503 +- 0.375 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.59
NEC for r=0.4 class 0.0 = 0.3 +- 0.430 (in-sample avg dev_std = 0.530)
NEC for r=0.4 class 1.0 = 0.591 +- 0.430 (in-sample avg dev_std = 0.530)
NEC for r=0.4 all KL = 0.548 +- 0.430 (in-sample avg dev_std = 0.530)
NEC for r=0.4 all L1 = 0.444 +- 0.350 (in-sample avg dev_std = 0.530)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.276 +- 0.402 (in-sample avg dev_std = 0.604)
NEC for r=0.8 class 1.0 = 0.532 +- 0.402 (in-sample avg dev_std = 0.604)
NEC for r=0.8 all KL = 0.529 +- 0.402 (in-sample avg dev_std = 0.604)
NEC for r=0.8 all L1 = 0.403 +- 0.318 (in-sample avg dev_std = 0.604)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 13:38:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 01:38:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.589
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.571
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.528
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.491
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.419
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.308
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.237
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.203
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.196
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.563
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.600
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.619
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.626
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.634


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.575
SUFF_SIMPLE for r=0.05 class 0.0 = 0.819 +- 0.405 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.295 +- 0.405 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 all KL = 0.45 +- 0.405 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 all L1 = 0.529 +- 0.320 (in-sample avg dev_std = 0.507)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.596
SUFF_SIMPLE for r=0.1 class 0.0 = 0.833 +- 0.403 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.311 +- 0.403 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 all KL = 0.468 +- 0.403 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 all L1 = 0.544 +- 0.319 (in-sample avg dev_std = 0.508)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.593
SUFF_SIMPLE for r=0.2 class 0.0 = 0.841 +- 0.407 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.299 +- 0.407 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.2 all KL = 0.466 +- 0.407 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.2 all L1 = 0.541 +- 0.321 (in-sample avg dev_std = 0.509)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.565
SUFF_SIMPLE for r=0.4 class 0.0 = 0.835 +- 0.414 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.279 +- 0.414 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.414 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.4 all L1 = 0.527 +- 0.333 (in-sample avg dev_std = 0.453)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.566
SUFF_SIMPLE for r=0.8 class 0.0 = 0.846 +- 0.441 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.334 +- 0.441 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.8 all KL = 0.527 +- 0.441 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.8 all L1 = 0.562 +- 0.370 (in-sample avg dev_std = 0.219)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.020)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.010)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.013)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.657
SUFF_SIMPLE for r=0.05 class 0.0 = 0.795 +- 0.412 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.603 +- 0.412 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 all KL = 0.641 +- 0.412 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 all L1 = 0.7 +- 0.322 (in-sample avg dev_std = 0.405)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.664
SUFF_SIMPLE for r=0.1 class 0.0 = 0.82 +- 0.401 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.642 +- 0.401 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all KL = 0.694 +- 0.401 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all L1 = 0.732 +- 0.322 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.663
SUFF_SIMPLE for r=0.2 class 0.0 = 0.836 +- 0.383 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.687 +- 0.383 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.383 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all L1 = 0.762 +- 0.320 (in-sample avg dev_std = 0.276)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.663
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.380 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.703 +- 0.380 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 all KL = 0.76 +- 0.380 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 all L1 = 0.771 +- 0.322 (in-sample avg dev_std = 0.232)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4960
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.705
SUFF_SIMPLE for r=0.8 class 0.0 = 0.871 +- 0.292 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.85 +- 0.292 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.292 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all L1 = 0.861 +- 0.265 (in-sample avg dev_std = 0.030)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.442
NEC for r=0.05 class 0.0 = 0.094 +- 0.459 (in-sample avg dev_std = 0.018)
NEC for r=0.05 class 1.0 = 0.831 +- 0.459 (in-sample avg dev_std = 0.018)
NEC for r=0.05 all KL = 0.548 +- 0.459 (in-sample avg dev_std = 0.018)
NEC for r=0.05 all L1 = 0.502 +- 0.389 (in-sample avg dev_std = 0.018)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.458
NEC for r=0.1 class 0.0 = 0.097 +- 0.458 (in-sample avg dev_std = 0.162)
NEC for r=0.1 class 1.0 = 0.825 +- 0.458 (in-sample avg dev_std = 0.162)
NEC for r=0.1 all KL = 0.55 +- 0.458 (in-sample avg dev_std = 0.162)
NEC for r=0.1 all L1 = 0.5 +- 0.385 (in-sample avg dev_std = 0.162)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.483
NEC for r=0.2 class 0.0 = 0.101 +- 0.454 (in-sample avg dev_std = 0.314)
NEC for r=0.2 class 1.0 = 0.805 +- 0.454 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all KL = 0.545 +- 0.454 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all L1 = 0.491 +- 0.377 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.562
NEC for r=0.4 class 0.0 = 0.116 +- 0.436 (in-sample avg dev_std = 0.500)
NEC for r=0.4 class 1.0 = 0.74 +- 0.436 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all KL = 0.532 +- 0.436 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all L1 = 0.462 +- 0.345 (in-sample avg dev_std = 0.500)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.646
NEC for r=0.8 class 0.0 = 0.134 +- 0.408 (in-sample avg dev_std = 0.602)
NEC for r=0.8 class 1.0 = 0.647 +- 0.408 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all KL = 0.505 +- 0.408 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all L1 = 0.418 +- 0.307 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.175 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.005 +- 0.192 (in-sample avg dev_std = 0.029)
NEC for r=0.1 class 1.0 = 0.174 +- 0.192 (in-sample avg dev_std = 0.029)
NEC for r=0.1 all KL = 0.072 +- 0.192 (in-sample avg dev_std = 0.029)
NEC for r=0.1 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.029)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.005 +- 0.199 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.176 +- 0.199 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.077 +- 0.199 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.092 +- 0.210 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.004 +- 0.195 (in-sample avg dev_std = 0.081)
NEC for r=0.4 class 1.0 = 0.175 +- 0.195 (in-sample avg dev_std = 0.081)
NEC for r=0.4 all KL = 0.075 +- 0.195 (in-sample avg dev_std = 0.081)
NEC for r=0.4 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.081)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.003 +- 0.193 (in-sample avg dev_std = 0.083)
NEC for r=0.8 class 1.0 = 0.175 +- 0.193 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all KL = 0.073 +- 0.193 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all L1 = 0.089 +- 0.206 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.523
NEC for r=0.05 class 0.0 = 0.313 +- 0.447 (in-sample avg dev_std = 0.054)
NEC for r=0.05 class 1.0 = 0.729 +- 0.447 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all KL = 0.582 +- 0.447 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all L1 = 0.518 +- 0.393 (in-sample avg dev_std = 0.054)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.528
NEC for r=0.1 class 0.0 = 0.318 +- 0.447 (in-sample avg dev_std = 0.187)
NEC for r=0.1 class 1.0 = 0.728 +- 0.447 (in-sample avg dev_std = 0.187)
NEC for r=0.1 all KL = 0.59 +- 0.447 (in-sample avg dev_std = 0.187)
NEC for r=0.1 all L1 = 0.521 +- 0.391 (in-sample avg dev_std = 0.187)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.547
NEC for r=0.2 class 0.0 = 0.312 +- 0.441 (in-sample avg dev_std = 0.371)
NEC for r=0.2 class 1.0 = 0.698 +- 0.441 (in-sample avg dev_std = 0.371)
NEC for r=0.2 all KL = 0.576 +- 0.441 (in-sample avg dev_std = 0.371)
NEC for r=0.2 all L1 = 0.503 +- 0.381 (in-sample avg dev_std = 0.371)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.587
NEC for r=0.4 class 0.0 = 0.29 +- 0.427 (in-sample avg dev_std = 0.528)
NEC for r=0.4 class 1.0 = 0.626 +- 0.427 (in-sample avg dev_std = 0.528)
NEC for r=0.4 all KL = 0.539 +- 0.427 (in-sample avg dev_std = 0.528)
NEC for r=0.4 all L1 = 0.456 +- 0.355 (in-sample avg dev_std = 0.528)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.624
NEC for r=0.8 class 0.0 = 0.273 +- 0.408 (in-sample avg dev_std = 0.618)
NEC for r=0.8 class 1.0 = 0.552 +- 0.408 (in-sample avg dev_std = 0.618)
NEC for r=0.8 all KL = 0.52 +- 0.408 (in-sample avg dev_std = 0.618)
NEC for r=0.8 all L1 = 0.411 +- 0.321 (in-sample avg dev_std = 0.618)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 13:55:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 01:55:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.544
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.543
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.467
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.374
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.311
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.326
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.120
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.063
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.572
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.579
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.581
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.586


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.478
SUFF_SIMPLE for r=0.05 class 0.0 = 0.837 +- 0.420 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.195 +- 0.420 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.420 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.05 all L1 = 0.481 +- 0.354 (in-sample avg dev_std = 0.302)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.478
SUFF_SIMPLE for r=0.1 class 0.0 = 0.835 +- 0.421 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.199 +- 0.421 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all KL = 0.442 +- 0.421 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all L1 = 0.482 +- 0.355 (in-sample avg dev_std = 0.304)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.502
SUFF_SIMPLE for r=0.2 class 0.0 = 0.833 +- 0.418 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.226 +- 0.418 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all KL = 0.456 +- 0.418 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all L1 = 0.497 +- 0.352 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.474
SUFF_SIMPLE for r=0.4 class 0.0 = 0.816 +- 0.420 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.215 +- 0.420 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all KL = 0.443 +- 0.420 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all L1 = 0.483 +- 0.357 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.483
SUFF_SIMPLE for r=0.8 class 0.0 = 0.851 +- 0.436 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.227 +- 0.436 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all KL = 0.481 +- 0.436 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all L1 = 0.505 +- 0.376 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.667
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.397 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.709 +- 0.397 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all KL = 0.738 +- 0.397 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all L1 = 0.773 +- 0.317 (in-sample avg dev_std = 0.214)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.668
SUFF_SIMPLE for r=0.1 class 0.0 = 0.84 +- 0.384 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.731 +- 0.384 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all KL = 0.764 +- 0.384 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all L1 = 0.786 +- 0.315 (in-sample avg dev_std = 0.184)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.671
SUFF_SIMPLE for r=0.2 class 0.0 = 0.845 +- 0.365 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.748 +- 0.365 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 all KL = 0.792 +- 0.365 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 all L1 = 0.797 +- 0.315 (in-sample avg dev_std = 0.145)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.672
SUFF_SIMPLE for r=0.4 class 0.0 = 0.856 +- 0.358 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.747 +- 0.358 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 all KL = 0.803 +- 0.358 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 all L1 = 0.802 +- 0.315 (in-sample avg dev_std = 0.123)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF_SIMPLE for r=0.8 class 0.0 = 0.9 +- 0.272 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.272 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.272 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.8 all L1 = 0.879 +- 0.248 (in-sample avg dev_std = 0.019)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.467
NEC for r=0.05 class 0.0 = 0.12 +- 0.440 (in-sample avg dev_std = 0.022)
NEC for r=0.05 class 1.0 = 0.801 +- 0.440 (in-sample avg dev_std = 0.022)
NEC for r=0.05 all KL = 0.533 +- 0.440 (in-sample avg dev_std = 0.022)
NEC for r=0.05 all L1 = 0.497 +- 0.382 (in-sample avg dev_std = 0.022)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
NEC for r=0.1 class 0.0 = 0.122 +- 0.443 (in-sample avg dev_std = 0.071)
NEC for r=0.1 class 1.0 = 0.827 +- 0.443 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.546 +- 0.443 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.513 +- 0.382 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.464
NEC for r=0.2 class 0.0 = 0.132 +- 0.438 (in-sample avg dev_std = 0.232)
NEC for r=0.2 class 1.0 = 0.815 +- 0.438 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all KL = 0.543 +- 0.438 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all L1 = 0.51 +- 0.372 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.148 +- 0.420 (in-sample avg dev_std = 0.392)
NEC for r=0.4 class 1.0 = 0.778 +- 0.420 (in-sample avg dev_std = 0.392)
NEC for r=0.4 all KL = 0.537 +- 0.420 (in-sample avg dev_std = 0.392)
NEC for r=0.4 all L1 = 0.497 +- 0.351 (in-sample avg dev_std = 0.392)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.558
NEC for r=0.8 class 0.0 = 0.148 +- 0.406 (in-sample avg dev_std = 0.475)
NEC for r=0.8 class 1.0 = 0.73 +- 0.406 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all KL = 0.514 +- 0.406 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all L1 = 0.47 +- 0.335 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.004)
NEC for r=0.1 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.4 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.004)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.008)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.535
NEC for r=0.05 class 0.0 = 0.329 +- 0.438 (in-sample avg dev_std = 0.023)
NEC for r=0.05 class 1.0 = 0.732 +- 0.438 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all KL = 0.578 +- 0.438 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all L1 = 0.528 +- 0.385 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.524
NEC for r=0.1 class 0.0 = 0.334 +- 0.437 (in-sample avg dev_std = 0.181)
NEC for r=0.1 class 1.0 = 0.75 +- 0.437 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all KL = 0.594 +- 0.437 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all L1 = 0.54 +- 0.380 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.534
NEC for r=0.2 class 0.0 = 0.325 +- 0.430 (in-sample avg dev_std = 0.405)
NEC for r=0.2 class 1.0 = 0.71 +- 0.430 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all KL = 0.579 +- 0.430 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all L1 = 0.515 +- 0.369 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.577
NEC for r=0.4 class 0.0 = 0.29 +- 0.409 (in-sample avg dev_std = 0.543)
NEC for r=0.4 class 1.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all KL = 0.525 +- 0.409 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all L1 = 0.451 +- 0.343 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.635
NEC for r=0.8 class 0.0 = 0.258 +- 0.380 (in-sample avg dev_std = 0.586)
NEC for r=0.8 class 1.0 = 0.498 +- 0.380 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all KL = 0.47 +- 0.380 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all L1 = 0.377 +- 0.307 (in-sample avg dev_std = 0.586)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 14:13:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 02:13:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.572
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.518
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.472
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.186
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.147
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.135
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.554
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.599
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.618
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.624
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.609
SUFF_SIMPLE for r=0.05 class 0.0 = 0.86 +- 0.404 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.335 +- 0.404 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.05 all KL = 0.504 +- 0.404 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.05 all L1 = 0.57 +- 0.330 (in-sample avg dev_std = 0.455)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.628
SUFF_SIMPLE for r=0.1 class 0.0 = 0.862 +- 0.397 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.353 +- 0.397 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.1 all KL = 0.509 +- 0.397 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.1 all L1 = 0.58 +- 0.322 (in-sample avg dev_std = 0.461)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.626
SUFF_SIMPLE for r=0.2 class 0.0 = 0.858 +- 0.402 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.347 +- 0.402 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 all KL = 0.503 +- 0.402 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.323 (in-sample avg dev_std = 0.475)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF_SIMPLE for r=0.4 class 0.0 = 0.853 +- 0.411 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.311 +- 0.411 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all KL = 0.481 +- 0.411 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all L1 = 0.553 +- 0.336 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.568
SUFF_SIMPLE for r=0.8 class 0.0 = 0.853 +- 0.444 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.351 +- 0.444 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all KL = 0.541 +- 0.444 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all L1 = 0.575 +- 0.377 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.152 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.683
SUFF_SIMPLE for r=0.05 class 0.0 = 0.857 +- 0.381 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.722 +- 0.381 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.381 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.05 all L1 = 0.79 +- 0.332 (in-sample avg dev_std = 0.166)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.687
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.378 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.735 +- 0.378 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all KL = 0.779 +- 0.378 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all L1 = 0.794 +- 0.328 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.686
SUFF_SIMPLE for r=0.2 class 0.0 = 0.844 +- 0.384 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.729 +- 0.384 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 all KL = 0.77 +- 0.384 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 all L1 = 0.787 +- 0.332 (in-sample avg dev_std = 0.150)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.684
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.383 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.728 +- 0.383 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.774 +- 0.383 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.789 +- 0.333 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.724
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.286 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.286 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.286 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.876 +- 0.260 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.448
NEC for r=0.05 class 0.0 = 0.078 +- 0.465 (in-sample avg dev_std = 0.021)
NEC for r=0.05 class 1.0 = 0.823 +- 0.465 (in-sample avg dev_std = 0.021)
NEC for r=0.05 all KL = 0.542 +- 0.465 (in-sample avg dev_std = 0.021)
NEC for r=0.05 all L1 = 0.491 +- 0.397 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.453
NEC for r=0.1 class 0.0 = 0.079 +- 0.464 (in-sample avg dev_std = 0.126)
NEC for r=0.1 class 1.0 = 0.82 +- 0.464 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all KL = 0.542 +- 0.464 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all L1 = 0.49 +- 0.394 (in-sample avg dev_std = 0.126)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
NEC for r=0.2 class 0.0 = 0.087 +- 0.455 (in-sample avg dev_std = 0.329)
NEC for r=0.2 class 1.0 = 0.792 +- 0.455 (in-sample avg dev_std = 0.329)
NEC for r=0.2 all KL = 0.532 +- 0.455 (in-sample avg dev_std = 0.329)
NEC for r=0.2 all L1 = 0.478 +- 0.379 (in-sample avg dev_std = 0.329)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.579
NEC for r=0.4 class 0.0 = 0.091 +- 0.435 (in-sample avg dev_std = 0.494)
NEC for r=0.4 class 1.0 = 0.716 +- 0.435 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all KL = 0.507 +- 0.435 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all L1 = 0.437 +- 0.347 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.655
NEC for r=0.8 class 0.0 = 0.112 +- 0.400 (in-sample avg dev_std = 0.551)
NEC for r=0.8 class 1.0 = 0.619 +- 0.400 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all KL = 0.469 +- 0.400 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all L1 = 0.393 +- 0.312 (in-sample avg dev_std = 0.551)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.012)
NEC for r=0.1 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.021)
NEC for r=0.2 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.021)
NEC for r=0.2 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.021)
NEC for r=0.2 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.021)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.040)
NEC for r=0.4 class 1.0 = 0.089 +- 0.136 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.040)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.001 +- 0.134 (in-sample avg dev_std = 0.038)
NEC for r=0.8 class 1.0 = 0.089 +- 0.134 (in-sample avg dev_std = 0.038)
NEC for r=0.8 all KL = 0.036 +- 0.134 (in-sample avg dev_std = 0.038)
NEC for r=0.8 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.038)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.342 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.05 class 1.0 = 0.767 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all KL = 0.624 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all L1 = 0.552 +- 0.381 (in-sample avg dev_std = 0.054)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.517
NEC for r=0.1 class 0.0 = 0.337 +- 0.454 (in-sample avg dev_std = 0.222)
NEC for r=0.1 class 1.0 = 0.765 +- 0.454 (in-sample avg dev_std = 0.222)
NEC for r=0.1 all KL = 0.627 +- 0.454 (in-sample avg dev_std = 0.222)
NEC for r=0.1 all L1 = 0.549 +- 0.380 (in-sample avg dev_std = 0.222)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.539
NEC for r=0.2 class 0.0 = 0.32 +- 0.448 (in-sample avg dev_std = 0.427)
NEC for r=0.2 class 1.0 = 0.721 +- 0.448 (in-sample avg dev_std = 0.427)
NEC for r=0.2 all KL = 0.613 +- 0.448 (in-sample avg dev_std = 0.427)
NEC for r=0.2 all L1 = 0.518 +- 0.367 (in-sample avg dev_std = 0.427)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.583
NEC for r=0.4 class 0.0 = 0.285 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.4 class 1.0 = 0.623 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.4 all KL = 0.566 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.4 all L1 = 0.452 +- 0.341 (in-sample avg dev_std = 0.538)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.627
NEC for r=0.8 class 0.0 = 0.246 +- 0.400 (in-sample avg dev_std = 0.570)
NEC for r=0.8 class 1.0 = 0.506 +- 0.400 (in-sample avg dev_std = 0.570)
NEC for r=0.8 all KL = 0.495 +- 0.400 (in-sample avg dev_std = 0.570)
NEC for r=0.8 all L1 = 0.375 +- 0.314 (in-sample avg dev_std = 0.570)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 14:29:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 02:29:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.520
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.497
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.408
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.300
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.219
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.266
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.161
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.055
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.528
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.538
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.529
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.536


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.484
SUFF_SIMPLE for r=0.05 class 0.0 = 0.784 +- 0.387 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.229 +- 0.387 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all KL = 0.471 +- 0.387 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all L1 = 0.477 +- 0.331 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.485
SUFF_SIMPLE for r=0.1 class 0.0 = 0.786 +- 0.388 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.228 +- 0.388 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all KL = 0.47 +- 0.388 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all L1 = 0.477 +- 0.331 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.506
SUFF_SIMPLE for r=0.2 class 0.0 = 0.784 +- 0.382 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.254 +- 0.382 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all KL = 0.483 +- 0.382 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all L1 = 0.49 +- 0.328 (in-sample avg dev_std = 0.276)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.763 +- 0.392 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.265 +- 0.392 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all KL = 0.482 +- 0.392 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all L1 = 0.487 +- 0.337 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.492
SUFF_SIMPLE for r=0.8 class 0.0 = 0.779 +- 0.406 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.273 +- 0.406 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all KL = 0.499 +- 0.406 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all L1 = 0.499 +- 0.353 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 0.0 = 0.82 +- 0.351 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.641 +- 0.351 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.351 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 all L1 = 0.732 +- 0.301 (in-sample avg dev_std = 0.131)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454658
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.612
SUFF_SIMPLE for r=0.1 class 0.0 = 0.823 +- 0.344 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.655 +- 0.344 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 all KL = 0.776 +- 0.344 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 all L1 = 0.74 +- 0.295 (in-sample avg dev_std = 0.140)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
SUFF_SIMPLE for r=0.2 class 0.0 = 0.818 +- 0.348 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.657 +- 0.348 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all KL = 0.779 +- 0.348 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all L1 = 0.738 +- 0.297 (in-sample avg dev_std = 0.118)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.622
SUFF_SIMPLE for r=0.4 class 0.0 = 0.818 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.654 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all KL = 0.779 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all L1 = 0.737 +- 0.301 (in-sample avg dev_std = 0.103)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.662
SUFF_SIMPLE for r=0.8 class 0.0 = 0.878 +- 0.260 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.769 +- 0.260 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.8 all KL = 0.878 +- 0.260 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.8 all L1 = 0.824 +- 0.247 (in-sample avg dev_std = 0.038)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.456
NEC for r=0.05 class 0.0 = 0.161 +- 0.416 (in-sample avg dev_std = 0.005)
NEC for r=0.05 class 1.0 = 0.779 +- 0.416 (in-sample avg dev_std = 0.005)
NEC for r=0.05 all KL = 0.513 +- 0.416 (in-sample avg dev_std = 0.005)
NEC for r=0.05 all L1 = 0.503 +- 0.365 (in-sample avg dev_std = 0.005)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.454
NEC for r=0.1 class 0.0 = 0.165 +- 0.416 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.79 +- 0.416 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.522 +- 0.416 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.511 +- 0.361 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.47
NEC for r=0.2 class 0.0 = 0.184 +- 0.409 (in-sample avg dev_std = 0.260)
NEC for r=0.2 class 1.0 = 0.781 +- 0.409 (in-sample avg dev_std = 0.260)
NEC for r=0.2 all KL = 0.527 +- 0.409 (in-sample avg dev_std = 0.260)
NEC for r=0.2 all L1 = 0.515 +- 0.348 (in-sample avg dev_std = 0.260)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.538
NEC for r=0.4 class 0.0 = 0.186 +- 0.388 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 1.0 = 0.726 +- 0.388 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all KL = 0.495 +- 0.388 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all L1 = 0.485 +- 0.326 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.594
NEC for r=0.8 class 0.0 = 0.191 +- 0.365 (in-sample avg dev_std = 0.443)
NEC for r=0.8 class 1.0 = 0.667 +- 0.365 (in-sample avg dev_std = 0.443)
NEC for r=0.8 all KL = 0.458 +- 0.365 (in-sample avg dev_std = 0.443)
NEC for r=0.8 all L1 = 0.455 +- 0.304 (in-sample avg dev_std = 0.443)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.005 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.165 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.085 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.005 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.164 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.057 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.085 +- 0.176 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.004 +- 0.145 (in-sample avg dev_std = 0.017)
NEC for r=0.2 class 1.0 = 0.166 +- 0.145 (in-sample avg dev_std = 0.017)
NEC for r=0.2 all KL = 0.061 +- 0.145 (in-sample avg dev_std = 0.017)
NEC for r=0.2 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.017)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.005 +- 0.144 (in-sample avg dev_std = 0.021)
NEC for r=0.4 class 1.0 = 0.166 +- 0.144 (in-sample avg dev_std = 0.021)
NEC for r=0.4 all KL = 0.061 +- 0.144 (in-sample avg dev_std = 0.021)
NEC for r=0.4 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.021)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.005 +- 0.144 (in-sample avg dev_std = 0.015)
NEC for r=0.8 class 1.0 = 0.166 +- 0.144 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all KL = 0.061 +- 0.144 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.321 +- 0.395 (in-sample avg dev_std = 0.015)
NEC for r=0.05 class 1.0 = 0.601 +- 0.395 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all KL = 0.438 +- 0.395 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all L1 = 0.459 +- 0.353 (in-sample avg dev_std = 0.015)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454658
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.537
NEC for r=0.1 class 0.0 = 0.329 +- 0.392 (in-sample avg dev_std = 0.095)
NEC for r=0.1 class 1.0 = 0.615 +- 0.392 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.458 +- 0.392 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.47 +- 0.349 (in-sample avg dev_std = 0.095)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.533
NEC for r=0.2 class 0.0 = 0.324 +- 0.391 (in-sample avg dev_std = 0.247)
NEC for r=0.2 class 1.0 = 0.624 +- 0.391 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all KL = 0.467 +- 0.391 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all L1 = 0.472 +- 0.342 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.53
NEC for r=0.4 class 0.0 = 0.301 +- 0.387 (in-sample avg dev_std = 0.393)
NEC for r=0.4 class 1.0 = 0.599 +- 0.387 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all KL = 0.448 +- 0.387 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all L1 = 0.448 +- 0.331 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.553
NEC for r=0.8 class 0.0 = 0.263 +- 0.369 (in-sample avg dev_std = 0.474)
NEC for r=0.8 class 1.0 = 0.519 +- 0.369 (in-sample avg dev_std = 0.474)
NEC for r=0.8 all KL = 0.394 +- 0.369 (in-sample avg dev_std = 0.474)
NEC for r=0.8 all L1 = 0.389 +- 0.311 (in-sample avg dev_std = 0.474)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 14:47:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 02:47:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.523
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.492
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.418
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.345
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.225
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.102
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.556
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.592
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.607
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.612
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.609


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.815 +- 0.410 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.226 +- 0.410 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all KL = 0.418 +- 0.410 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all L1 = 0.489 +- 0.331 (in-sample avg dev_std = 0.477)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.52
SUFF_SIMPLE for r=0.1 class 0.0 = 0.804 +- 0.406 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.23 +- 0.406 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 all KL = 0.415 +- 0.406 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 all L1 = 0.486 +- 0.329 (in-sample avg dev_std = 0.476)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.526
SUFF_SIMPLE for r=0.2 class 0.0 = 0.805 +- 0.407 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.24 +- 0.407 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 all KL = 0.419 +- 0.407 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 all L1 = 0.492 +- 0.327 (in-sample avg dev_std = 0.485)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.533
SUFF_SIMPLE for r=0.4 class 0.0 = 0.831 +- 0.426 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.25 +- 0.426 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 all KL = 0.453 +- 0.426 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.348 (in-sample avg dev_std = 0.403)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.559
SUFF_SIMPLE for r=0.8 class 0.0 = 0.847 +- 0.445 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.32 +- 0.445 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all KL = 0.526 +- 0.445 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all L1 = 0.555 +- 0.378 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.653
SUFF_SIMPLE for r=0.05 class 0.0 = 0.831 +- 0.404 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.683 +- 0.404 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.742 +- 0.328 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.658
SUFF_SIMPLE for r=0.1 class 0.0 = 0.839 +- 0.401 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.672 +- 0.401 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all KL = 0.714 +- 0.401 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all L1 = 0.756 +- 0.333 (in-sample avg dev_std = 0.286)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.663
SUFF_SIMPLE for r=0.2 class 0.0 = 0.848 +- 0.398 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.685 +- 0.398 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.738 +- 0.398 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.336 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.67
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.391 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.706 +- 0.391 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.391 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all L1 = 0.778 +- 0.337 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.274 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.873 +- 0.274 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.274 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.247 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.463
NEC for r=0.05 class 0.0 = 0.112 +- 0.451 (in-sample avg dev_std = 0.034)
NEC for r=0.05 class 1.0 = 0.814 +- 0.451 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all KL = 0.548 +- 0.451 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all L1 = 0.501 +- 0.381 (in-sample avg dev_std = 0.034)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.468
NEC for r=0.1 class 0.0 = 0.119 +- 0.450 (in-sample avg dev_std = 0.149)
NEC for r=0.1 class 1.0 = 0.822 +- 0.450 (in-sample avg dev_std = 0.149)
NEC for r=0.1 all KL = 0.556 +- 0.450 (in-sample avg dev_std = 0.149)
NEC for r=0.1 all L1 = 0.509 +- 0.376 (in-sample avg dev_std = 0.149)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.492
NEC for r=0.2 class 0.0 = 0.122 +- 0.445 (in-sample avg dev_std = 0.311)
NEC for r=0.2 class 1.0 = 0.806 +- 0.445 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all KL = 0.555 +- 0.445 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all L1 = 0.501 +- 0.365 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.544
NEC for r=0.4 class 0.0 = 0.135 +- 0.430 (in-sample avg dev_std = 0.454)
NEC for r=0.4 class 1.0 = 0.764 +- 0.430 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all KL = 0.549 +- 0.430 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all L1 = 0.484 +- 0.344 (in-sample avg dev_std = 0.454)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.6
NEC for r=0.8 class 0.0 = 0.159 +- 0.404 (in-sample avg dev_std = 0.523)
NEC for r=0.8 class 1.0 = 0.699 +- 0.404 (in-sample avg dev_std = 0.523)
NEC for r=0.8 all KL = 0.534 +- 0.404 (in-sample avg dev_std = 0.523)
NEC for r=0.8 all L1 = 0.458 +- 0.314 (in-sample avg dev_std = 0.523)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.012)
NEC for r=0.2 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.012)
NEC for r=0.2 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.012)
NEC for r=0.2 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.012)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.016)
NEC for r=0.4 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.016)
NEC for r=0.4 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.016)
NEC for r=0.4 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.016)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.8 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.534
NEC for r=0.05 class 0.0 = 0.326 +- 0.461 (in-sample avg dev_std = 0.057)
NEC for r=0.05 class 1.0 = 0.742 +- 0.461 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all KL = 0.61 +- 0.461 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all L1 = 0.532 +- 0.390 (in-sample avg dev_std = 0.057)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.523
NEC for r=0.1 class 0.0 = 0.325 +- 0.458 (in-sample avg dev_std = 0.301)
NEC for r=0.1 class 1.0 = 0.757 +- 0.458 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all KL = 0.626 +- 0.458 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all L1 = 0.538 +- 0.381 (in-sample avg dev_std = 0.301)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.554
NEC for r=0.2 class 0.0 = 0.305 +- 0.445 (in-sample avg dev_std = 0.476)
NEC for r=0.2 class 1.0 = 0.702 +- 0.445 (in-sample avg dev_std = 0.476)
NEC for r=0.2 all KL = 0.613 +- 0.445 (in-sample avg dev_std = 0.476)
NEC for r=0.2 all L1 = 0.501 +- 0.358 (in-sample avg dev_std = 0.476)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 0.0 = 0.27 +- 0.421 (in-sample avg dev_std = 0.542)
NEC for r=0.4 class 1.0 = 0.597 +- 0.421 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all KL = 0.561 +- 0.421 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all L1 = 0.432 +- 0.331 (in-sample avg dev_std = 0.542)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
NEC for r=0.8 class 0.0 = 0.246 +- 0.389 (in-sample avg dev_std = 0.547)
NEC for r=0.8 class 1.0 = 0.482 +- 0.389 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all KL = 0.496 +- 0.389 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all L1 = 0.362 +- 0.302 (in-sample avg dev_std = 0.547)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 15:05:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 03:05:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.570
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.615
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.591
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.537
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.487
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.427
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.204
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.132
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.634
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.638
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.637


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.679
SUFF_SIMPLE for r=0.05 class 0.0 = 0.727 +- 0.385 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.503 +- 0.385 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 all KL = 0.482 +- 0.385 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 all L1 = 0.603 +- 0.295 (in-sample avg dev_std = 0.608)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.655
SUFF_SIMPLE for r=0.1 class 0.0 = 0.703 +- 0.385 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.503 +- 0.385 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all KL = 0.479 +- 0.385 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all L1 = 0.593 +- 0.304 (in-sample avg dev_std = 0.582)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.627
SUFF_SIMPLE for r=0.2 class 0.0 = 0.702 +- 0.397 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.466 +- 0.397 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 all KL = 0.456 +- 0.397 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 all L1 = 0.571 +- 0.312 (in-sample avg dev_std = 0.585)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.595
SUFF_SIMPLE for r=0.4 class 0.0 = 0.705 +- 0.411 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.423 +- 0.411 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 all KL = 0.444 +- 0.411 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 all L1 = 0.549 +- 0.324 (in-sample avg dev_std = 0.554)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.624
SUFF_SIMPLE for r=0.8 class 0.0 = 0.831 +- 0.444 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.442 +- 0.444 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all KL = 0.57 +- 0.444 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.372 (in-sample avg dev_std = 0.259)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.206 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.837 +- 0.206 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.206 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.211 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.211 (in-sample avg dev_std = 0.060)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.2 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.044)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.206 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.206 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.699
SUFF_SIMPLE for r=0.05 class 0.0 = 0.746 +- 0.393 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.834 +- 0.393 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all KL = 0.74 +- 0.393 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all L1 = 0.789 +- 0.318 (in-sample avg dev_std = 0.362)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.698
SUFF_SIMPLE for r=0.1 class 0.0 = 0.737 +- 0.387 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.852 +- 0.387 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all KL = 0.757 +- 0.387 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all L1 = 0.794 +- 0.326 (in-sample avg dev_std = 0.290)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.69
SUFF_SIMPLE for r=0.2 class 0.0 = 0.744 +- 0.390 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.838 +- 0.390 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all KL = 0.757 +- 0.390 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all L1 = 0.79 +- 0.332 (in-sample avg dev_std = 0.243)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.684
SUFF_SIMPLE for r=0.4 class 0.0 = 0.765 +- 0.396 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.396 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all KL = 0.76 +- 0.396 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all L1 = 0.787 +- 0.339 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.289 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.906 +- 0.289 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all KL = 0.883 +- 0.289 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all L1 = 0.888 +- 0.259 (in-sample avg dev_std = 0.021)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.54
NEC for r=0.05 class 0.0 = 0.081 +- 0.470 (in-sample avg dev_std = 0.007)
NEC for r=0.05 class 1.0 = 0.701 +- 0.470 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all KL = 0.47 +- 0.470 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all L1 = 0.425 +- 0.399 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.573
NEC for r=0.1 class 0.0 = 0.077 +- 0.458 (in-sample avg dev_std = 0.419)
NEC for r=0.1 class 1.0 = 0.715 +- 0.458 (in-sample avg dev_std = 0.419)
NEC for r=0.1 all KL = 0.503 +- 0.458 (in-sample avg dev_std = 0.419)
NEC for r=0.1 all L1 = 0.43 +- 0.371 (in-sample avg dev_std = 0.419)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.695
NEC for r=0.2 class 0.0 = 0.086 +- 0.412 (in-sample avg dev_std = 0.524)
NEC for r=0.2 class 1.0 = 0.549 +- 0.412 (in-sample avg dev_std = 0.524)
NEC for r=0.2 all KL = 0.433 +- 0.412 (in-sample avg dev_std = 0.524)
NEC for r=0.2 all L1 = 0.343 +- 0.320 (in-sample avg dev_std = 0.524)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.79
NEC for r=0.4 class 0.0 = 0.104 +- 0.371 (in-sample avg dev_std = 0.532)
NEC for r=0.4 class 1.0 = 0.395 +- 0.371 (in-sample avg dev_std = 0.532)
NEC for r=0.4 all KL = 0.351 +- 0.371 (in-sample avg dev_std = 0.532)
NEC for r=0.4 all L1 = 0.265 +- 0.269 (in-sample avg dev_std = 0.532)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.844
NEC for r=0.8 class 0.0 = 0.147 +- 0.324 (in-sample avg dev_std = 0.518)
NEC for r=0.8 class 1.0 = 0.288 +- 0.324 (in-sample avg dev_std = 0.518)
NEC for r=0.8 all KL = 0.311 +- 0.324 (in-sample avg dev_std = 0.518)
NEC for r=0.8 all L1 = 0.225 +- 0.224 (in-sample avg dev_std = 0.518)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.204 (in-sample avg dev_std = 0.042)
NEC for r=0.1 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all KL = 0.073 +- 0.204 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all L1 = 0.084 +- 0.211 (in-sample avg dev_std = 0.042)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.522
NEC for r=0.2 class 0.0 = 0.005 +- 0.207 (in-sample avg dev_std = 0.208)
NEC for r=0.2 class 1.0 = 0.177 +- 0.207 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all KL = 0.093 +- 0.207 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all L1 = 0.092 +- 0.200 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.529
NEC for r=0.4 class 0.0 = 0.006 +- 0.189 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.162 +- 0.189 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.084 +- 0.189 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.084 +- 0.185 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.515
NEC for r=0.8 class 0.0 = 0.003 +- 0.184 (in-sample avg dev_std = 0.169)
NEC for r=0.8 class 1.0 = 0.155 +- 0.184 (in-sample avg dev_std = 0.169)
NEC for r=0.8 all KL = 0.071 +- 0.184 (in-sample avg dev_std = 0.169)
NEC for r=0.8 all L1 = 0.08 +- 0.190 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.549
NEC for r=0.05 class 0.0 = 0.334 +- 0.471 (in-sample avg dev_std = 0.229)
NEC for r=0.05 class 1.0 = 0.689 +- 0.471 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all KL = 0.595 +- 0.471 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all L1 = 0.509 +- 0.395 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.562
NEC for r=0.1 class 0.0 = 0.305 +- 0.456 (in-sample avg dev_std = 0.454)
NEC for r=0.1 class 1.0 = 0.649 +- 0.456 (in-sample avg dev_std = 0.454)
NEC for r=0.1 all KL = 0.585 +- 0.456 (in-sample avg dev_std = 0.454)
NEC for r=0.1 all L1 = 0.475 +- 0.373 (in-sample avg dev_std = 0.454)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.597
NEC for r=0.2 class 0.0 = 0.253 +- 0.433 (in-sample avg dev_std = 0.551)
NEC for r=0.2 class 1.0 = 0.545 +- 0.433 (in-sample avg dev_std = 0.551)
NEC for r=0.2 all KL = 0.527 +- 0.433 (in-sample avg dev_std = 0.551)
NEC for r=0.2 all L1 = 0.397 +- 0.344 (in-sample avg dev_std = 0.551)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.65
NEC for r=0.4 class 0.0 = 0.209 +- 0.403 (in-sample avg dev_std = 0.549)
NEC for r=0.4 class 1.0 = 0.402 +- 0.403 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all KL = 0.429 +- 0.403 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all L1 = 0.304 +- 0.309 (in-sample avg dev_std = 0.549)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
NEC for r=0.8 class 0.0 = 0.23 +- 0.381 (in-sample avg dev_std = 0.520)
NEC for r=0.8 class 1.0 = 0.269 +- 0.381 (in-sample avg dev_std = 0.520)
NEC for r=0.8 all KL = 0.367 +- 0.381 (in-sample avg dev_std = 0.520)
NEC for r=0.8 all L1 = 0.249 +- 0.282 (in-sample avg dev_std = 0.520)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.469, 0.473, 0.474, 0.462, 0.516], 'all_L1': [0.553, 0.547, 0.543, 0.52, 0.545]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.417, 0.406, 0.416, 0.529], 'all_L1': [0.532, 0.542, 0.532, 0.526, 0.582]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.477, 0.47, 0.481, 0.543], 'all_L1': [0.562, 0.572, 0.575, 0.57, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.475, 0.463, 0.458, 0.543], 'all_L1': [0.54, 0.55, 0.54, 0.526, 0.581]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.468, 0.466, 0.456, 0.527], 'all_L1': [0.529, 0.544, 0.541, 0.527, 0.562]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.442, 0.456, 0.443, 0.481], 'all_L1': [0.481, 0.482, 0.497, 0.483, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.504, 0.509, 0.503, 0.481, 0.541], 'all_L1': [0.57, 0.58, 0.575, 0.553, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.47, 0.483, 0.482, 0.499], 'all_L1': [0.477, 0.477, 0.49, 0.487, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.415, 0.419, 0.453, 0.526], 'all_L1': [0.489, 0.486, 0.492, 0.509, 0.555]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.479, 0.456, 0.444, 0.57], 'all_L1': [0.603, 0.593, 0.571, 0.549, 0.615]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.489, 0.503, 0.414, 0.329, 0.332], 'all_L1': [0.447, 0.453, 0.364, 0.287, 0.288]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.582, 0.578, 0.558, 0.546], 'all_L1': [0.502, 0.51, 0.478, 0.436, 0.405]}), defaultdict(<class 'list'>, {'all_KL': [0.534, 0.555, 0.549, 0.52, 0.467], 'all_L1': [0.479, 0.492, 0.472, 0.425, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.562, 0.551, 0.524, 0.495], 'all_L1': [0.497, 0.508, 0.488, 0.443, 0.402]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.55, 0.545, 0.532, 0.505], 'all_L1': [0.502, 0.5, 0.491, 0.462, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.546, 0.543, 0.537, 0.514], 'all_L1': [0.497, 0.513, 0.51, 0.497, 0.47]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.542, 0.532, 0.507, 0.469], 'all_L1': [0.491, 0.49, 0.478, 0.437, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.522, 0.527, 0.495, 0.458], 'all_L1': [0.503, 0.511, 0.515, 0.485, 0.455]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.556, 0.555, 0.549, 0.534], 'all_L1': [0.501, 0.509, 0.501, 0.484, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.503, 0.433, 0.351, 0.311], 'all_L1': [0.425, 0.43, 0.343, 0.265, 0.225]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.935, 0.935, 0.936, 0.935, 0.936], 'all_L1': [0.919, 0.919, 0.919, 0.919, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.905, 0.907, 0.908, 0.911, 0.913], 'all_L1': [0.901, 0.902, 0.902, 0.903, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.927, 0.928, 0.928, 0.928], 'all_L1': [0.921, 0.921, 0.922, 0.921, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.953, 0.953, 0.953, 0.953], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.926, 0.926], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.968], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.964, 0.964, 0.964, 0.964], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.939, 0.939, 0.939, 0.939], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.934], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.928, 0.928, 0.928, 0.928], 'all_L1': [0.917, 0.917, 0.917, 0.917, 0.917]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.063, 0.063, 0.062, 0.057, 0.058], 'all_L1': [0.081, 0.081, 0.08, 0.076, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.091, 0.101, 0.098, 0.096], 'all_L1': [0.097, 0.098, 0.102, 0.1, 0.099]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.079, 0.084, 0.08, 0.074], 'all_L1': [0.083, 0.084, 0.084, 0.081, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.047, 0.049, 0.047, 0.046], 'all_L1': [0.056, 0.057, 0.057, 0.055, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.072, 0.077, 0.075, 0.073], 'all_L1': [0.09, 0.09, 0.092, 0.09, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.031, 0.032, 0.032, 0.032], 'all_L1': [0.046, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.036, 0.036, 0.036, 0.036], 'all_L1': [0.046, 0.046, 0.046, 0.045, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.057, 0.061, 0.061, 0.061], 'all_L1': [0.085, 0.085, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.066, 0.066, 0.066, 0.066], 'all_L1': [0.086, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.073, 0.093, 0.084, 0.071], 'all_L1': [0.083, 0.084, 0.092, 0.084, 0.08]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.718, 0.737, 0.758, 0.767, 0.877], 'all_L1': [0.756, 0.765, 0.778, 0.776, 0.866]}), defaultdict(<class 'list'>, {'all_KL': [0.58, 0.633, 0.688, 0.729, 0.867], 'all_L1': [0.712, 0.735, 0.756, 0.772, 0.872]}), defaultdict(<class 'list'>, {'all_KL': [0.734, 0.75, 0.76, 0.763, 0.868], 'all_L1': [0.76, 0.77, 0.775, 0.776, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.635, 0.669, 0.683, 0.827], 'all_L1': [0.692, 0.711, 0.731, 0.736, 0.837]}), defaultdict(<class 'list'>, {'all_KL': [0.641, 0.694, 0.745, 0.76, 0.873], 'all_L1': [0.7, 0.732, 0.762, 0.771, 0.861]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.764, 0.792, 0.803, 0.894], 'all_L1': [0.773, 0.786, 0.797, 0.802, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.779, 0.77, 0.774, 0.879], 'all_L1': [0.79, 0.794, 0.787, 0.789, 0.876]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.776, 0.779, 0.779, 0.878], 'all_L1': [0.732, 0.74, 0.738, 0.737, 0.824]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.714, 0.738, 0.758, 0.889], 'all_L1': [0.742, 0.756, 0.768, 0.778, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.757, 0.757, 0.76, 0.883], 'all_L1': [0.789, 0.794, 0.79, 0.787, 0.888]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.554, 0.525, 0.448, 0.332, 0.285], 'all_L1': [0.503, 0.47, 0.395, 0.291, 0.24]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.626, 0.615, 0.583, 0.544], 'all_L1': [0.533, 0.517, 0.475, 0.41, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.586, 0.57, 0.514, 0.44], 'all_L1': [0.515, 0.507, 0.464, 0.395, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.609, 0.613, 0.596, 0.548, 0.529], 'all_L1': [0.529, 0.528, 0.503, 0.444, 0.403]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.59, 0.576, 0.539, 0.52], 'all_L1': [0.518, 0.521, 0.503, 0.456, 0.411]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.594, 0.579, 0.525, 0.47], 'all_L1': [0.528, 0.54, 0.515, 0.451, 0.377]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.627, 0.613, 0.566, 0.495], 'all_L1': [0.552, 0.549, 0.518, 0.452, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.458, 0.467, 0.448, 0.394], 'all_L1': [0.459, 0.47, 0.472, 0.448, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.626, 0.613, 0.561, 0.496], 'all_L1': [0.532, 0.538, 0.501, 0.432, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.595, 0.585, 0.527, 0.429, 0.367], 'all_L1': [0.509, 0.475, 0.397, 0.304, 0.249]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.534 +- 0.039, 0.537 +- 0.040, 0.536 +- 0.032, 0.525 +- 0.026, 0.560 +- 0.034
suff_simple class all_KL  =  0.456 +- 0.028, 0.463 +- 0.028, 0.460 +- 0.027, 0.458 +- 0.020, 0.528 +- 0.024
suff_simple_acc_int  =  0.576 +- 0.060, 0.578 +- 0.058, 0.577 +- 0.046, 0.553 +- 0.042, 0.560 +- 0.042
nec class all_L1  =  0.484 +- 0.026, 0.492 +- 0.027, 0.464 +- 0.057, 0.422 +- 0.077, 0.388 +- 0.074
nec class all_KL  =  0.529 +- 0.028, 0.542 +- 0.024, 0.523 +- 0.051, 0.490 +- 0.077, 0.463 +- 0.076
nec_acc_int  =  0.474 +- 0.032, 0.479 +- 0.040, 0.534 +- 0.080, 0.611 +- 0.091, 0.672 +- 0.083

Eval split val
suff_simple class all_L1  =  0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018
suff_simple class all_KL  =  0.938 +- 0.018, 0.938 +- 0.018, 0.938 +- 0.018, 0.939 +- 0.017, 0.939 +- 0.017
suff_simple_acc_int  =  0.497 +- 0.002, 0.497 +- 0.002, 0.497 +- 0.001, 0.496 +- 0.001, 0.496 +- 0.000
nec class all_L1  =  0.075 +- 0.018, 0.076 +- 0.018, 0.077 +- 0.019, 0.075 +- 0.018, 0.074 +- 0.018
nec class all_KL  =  0.061 +- 0.017, 0.061 +- 0.018, 0.066 +- 0.022, 0.064 +- 0.020, 0.061 +- 0.018
nec_acc_int  =  0.496 +- 0.001, 0.497 +- 0.002, 0.501 +- 0.008, 0.503 +- 0.010, 0.502 +- 0.006

Eval split test
suff_simple class all_L1  =  0.745 +- 0.033, 0.758 +- 0.027, 0.768 +- 0.021, 0.772 +- 0.020, 0.865 +- 0.019
suff_simple class all_KL  =  0.697 +- 0.065, 0.724 +- 0.051, 0.746 +- 0.037, 0.758 +- 0.030, 0.874 +- 0.017
suff_simple_acc_int  =  0.663 +- 0.026, 0.666 +- 0.025, 0.667 +- 0.023, 0.665 +- 0.021, 0.712 +- 0.027
nec class all_L1  =  0.518 +- 0.024, 0.512 +- 0.028, 0.474 +- 0.043, 0.408 +- 0.059, 0.348 +- 0.057
nec class all_KL  =  0.579 +- 0.052, 0.583 +- 0.051, 0.560 +- 0.057, 0.504 +- 0.074, 0.454 +- 0.079
nec_acc_int  =  0.532 +- 0.012, 0.540 +- 0.018, 0.565 +- 0.029, 0.607 +- 0.039, 0.645 +- 0.042


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.509 +- 0.014, 0.514 +- 0.015, 0.500 +- 0.024, 0.474 +- 0.035, 0.474 +- 0.029
Faith. Armon (L1)= 		  =  0.506 +- 0.013, 0.512 +- 0.016, 0.494 +- 0.032, 0.462 +- 0.050, 0.452 +- 0.052
Faith. GMean (L1)= 	  =  0.508 +- 0.013, 0.513 +- 0.015, 0.497 +- 0.028, 0.468 +- 0.042, 0.463 +- 0.041
Faith. Aritm (KL)= 		  =  0.493 +- 0.013, 0.502 +- 0.013, 0.491 +- 0.025, 0.474 +- 0.039, 0.495 +- 0.035
Faith. Armon (KL)= 		  =  0.489 +- 0.015, 0.498 +- 0.015, 0.487 +- 0.025, 0.470 +- 0.041, 0.489 +- 0.046
Faith. GMean (KL)= 	  =  0.491 +- 0.014, 0.500 +- 0.014, 0.489 +- 0.025, 0.472 +- 0.040, 0.492 +- 0.041

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.001, 0.500 +- 0.001, 0.501 +- 0.002, 0.500 +- 0.001, 0.499 +- 0.001
Faith. Armon (L1)= 		  =  0.139 +- 0.031, 0.139 +- 0.031, 0.142 +- 0.033, 0.138 +- 0.032, 0.136 +- 0.031
Faith. GMean (L1)= 	  =  0.261 +- 0.031, 0.262 +- 0.031, 0.264 +- 0.033, 0.261 +- 0.032, 0.259 +- 0.031
Faith. Aritm (KL)= 		  =  0.499 +- 0.001, 0.500 +- 0.001, 0.502 +- 0.003, 0.501 +- 0.003, 0.500 +- 0.002
Faith. Armon (KL)= 		  =  0.114 +- 0.031, 0.115 +- 0.032, 0.123 +- 0.038, 0.118 +- 0.035, 0.114 +- 0.032
Faith. GMean (KL)= 	  =  0.236 +- 0.034, 0.237 +- 0.035, 0.245 +- 0.041, 0.241 +- 0.038, 0.237 +- 0.035

Eval split test
Faith. Aritm (L1)= 		  =  0.631 +- 0.021, 0.635 +- 0.020, 0.621 +- 0.022, 0.590 +- 0.029, 0.607 +- 0.026
Faith. Armon (L1)= 		  =  0.610 +- 0.021, 0.610 +- 0.023, 0.585 +- 0.034, 0.531 +- 0.053, 0.494 +- 0.060
Faith. GMean (L1)= 	  =  0.621 +- 0.021, 0.622 +- 0.021, 0.603 +- 0.028, 0.560 +- 0.041, 0.547 +- 0.045
Faith. Aritm (KL)= 		  =  0.638 +- 0.031, 0.653 +- 0.027, 0.653 +- 0.027, 0.631 +- 0.036, 0.664 +- 0.037
Faith. Armon (KL)= 		  =  0.629 +- 0.036, 0.643 +- 0.032, 0.637 +- 0.036, 0.602 +- 0.056, 0.593 +- 0.071
Faith. GMean (KL)= 	  =  0.633 +- 0.033, 0.648 +- 0.029, 0.645 +- 0.031, 0.616 +- 0.046, 0.627 +- 0.056
Computed for split load_split = id



Completed in  2:50:30.607309  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 15:21:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 03:21:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.612
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.582
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.455
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.459
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.330
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.174
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.621
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.641
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.645
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.640


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.518
SUFF_SIMPLE for r=0.05 class 0.0 = 0.665 +- 0.394 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.359 +- 0.394 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all KL = 0.424 +- 0.394 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all L1 = 0.495 +- 0.326 (in-sample avg dev_std = 0.473)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.504
SUFF_SIMPLE for r=0.1 class 0.0 = 0.627 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.402 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all KL = 0.439 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all L1 = 0.502 +- 0.345 (in-sample avg dev_std = 0.438)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.506
SUFF_SIMPLE for r=0.2 class 0.0 = 0.641 +- 0.424 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.405 +- 0.424 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 all KL = 0.453 +- 0.424 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 all L1 = 0.51 +- 0.356 (in-sample avg dev_std = 0.384)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.48
SUFF_SIMPLE for r=0.4 class 0.0 = 0.674 +- 0.436 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.358 +- 0.436 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 all KL = 0.457 +- 0.436 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 all L1 = 0.499 +- 0.367 (in-sample avg dev_std = 0.244)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.52
SUFF_SIMPLE for r=0.8 class 0.0 = 0.835 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.291 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.506 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.534 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.182 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.84 +- 0.182 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all KL = 0.932 +- 0.182 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.197 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.188 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.188 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 all KL = 0.929 +- 0.188 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.198 (in-sample avg dev_std = 0.073)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.194 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.194 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.194 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.198 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.494
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.204 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.838 +- 0.204 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 all KL = 0.922 +- 0.204 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 all L1 = 0.913 +- 0.201 (in-sample avg dev_std = 0.099)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.658
SUFF_SIMPLE for r=0.05 class 0.0 = 0.702 +- 0.399 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.751 +- 0.399 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all KL = 0.692 +- 0.399 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all L1 = 0.727 +- 0.318 (in-sample avg dev_std = 0.335)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.665
SUFF_SIMPLE for r=0.1 class 0.0 = 0.703 +- 0.397 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.759 +- 0.397 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all KL = 0.705 +- 0.397 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all L1 = 0.731 +- 0.328 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.658
SUFF_SIMPLE for r=0.2 class 0.0 = 0.729 +- 0.399 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.74 +- 0.399 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all KL = 0.717 +- 0.399 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.337 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.645
SUFF_SIMPLE for r=0.4 class 0.0 = 0.729 +- 0.421 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.669 +- 0.421 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 all KL = 0.685 +- 0.421 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 all L1 = 0.699 +- 0.361 (in-sample avg dev_std = 0.120)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.861 +- 0.285 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.863 +- 0.285 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.8 all KL = 0.875 +- 0.285 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.8 all L1 = 0.862 +- 0.256 (in-sample avg dev_std = 0.004)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.532
NEC for r=0.05 class 0.0 = 0.091 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.734 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.489 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.447 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.466
NEC for r=0.1 class 0.0 = 0.098 +- 0.456 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.801 +- 0.456 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.532 +- 0.456 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.487 +- 0.384 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.104 +- 0.443 (in-sample avg dev_std = 0.317)
NEC for r=0.2 class 1.0 = 0.773 +- 0.443 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all KL = 0.525 +- 0.443 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all L1 = 0.475 +- 0.363 (in-sample avg dev_std = 0.317)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.618
NEC for r=0.4 class 0.0 = 0.115 +- 0.408 (in-sample avg dev_std = 0.456)
NEC for r=0.4 class 1.0 = 0.663 +- 0.408 (in-sample avg dev_std = 0.456)
NEC for r=0.4 all KL = 0.475 +- 0.408 (in-sample avg dev_std = 0.456)
NEC for r=0.4 all L1 = 0.418 +- 0.324 (in-sample avg dev_std = 0.456)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.633
NEC for r=0.8 class 0.0 = 0.214 +- 0.379 (in-sample avg dev_std = 0.519)
NEC for r=0.8 class 1.0 = 0.6 +- 0.379 (in-sample avg dev_std = 0.519)
NEC for r=0.8 all KL = 0.497 +- 0.379 (in-sample avg dev_std = 0.519)
NEC for r=0.8 all L1 = 0.428 +- 0.300 (in-sample avg dev_std = 0.519)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.003 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.158 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.158 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.063 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.005 +- 0.172 (in-sample avg dev_std = 0.031)
NEC for r=0.2 class 1.0 = 0.157 +- 0.172 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.064 +- 0.172 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.082 +- 0.195 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.506
NEC for r=0.4 class 0.0 = 0.009 +- 0.184 (in-sample avg dev_std = 0.148)
NEC for r=0.4 class 1.0 = 0.169 +- 0.184 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all KL = 0.084 +- 0.184 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all L1 = 0.089 +- 0.191 (in-sample avg dev_std = 0.148)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.003 +- 0.176 (in-sample avg dev_std = 0.081)
NEC for r=0.8 class 1.0 = 0.16 +- 0.176 (in-sample avg dev_std = 0.081)
NEC for r=0.8 all KL = 0.066 +- 0.176 (in-sample avg dev_std = 0.081)
NEC for r=0.8 all L1 = 0.082 +- 0.195 (in-sample avg dev_std = 0.081)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.55
NEC for r=0.05 class 0.0 = 0.33 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.688 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.557 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.507 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.538
NEC for r=0.1 class 0.0 = 0.334 +- 0.439 (in-sample avg dev_std = 0.139)
NEC for r=0.1 class 1.0 = 0.704 +- 0.439 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all KL = 0.572 +- 0.439 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all L1 = 0.517 +- 0.380 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.306 +- 0.419 (in-sample avg dev_std = 0.373)
NEC for r=0.2 class 1.0 = 0.671 +- 0.419 (in-sample avg dev_std = 0.373)
NEC for r=0.2 all KL = 0.546 +- 0.419 (in-sample avg dev_std = 0.373)
NEC for r=0.2 all L1 = 0.486 +- 0.356 (in-sample avg dev_std = 0.373)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.601
NEC for r=0.4 class 0.0 = 0.262 +- 0.394 (in-sample avg dev_std = 0.442)
NEC for r=0.4 class 1.0 = 0.534 +- 0.394 (in-sample avg dev_std = 0.442)
NEC for r=0.4 all KL = 0.448 +- 0.394 (in-sample avg dev_std = 0.442)
NEC for r=0.4 all L1 = 0.397 +- 0.325 (in-sample avg dev_std = 0.442)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.267 +- 0.361 (in-sample avg dev_std = 0.440)
NEC for r=0.8 class 1.0 = 0.386 +- 0.361 (in-sample avg dev_std = 0.440)
NEC for r=0.8 all KL = 0.377 +- 0.361 (in-sample avg dev_std = 0.440)
NEC for r=0.8 all L1 = 0.326 +- 0.288 (in-sample avg dev_std = 0.440)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 15:37:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 03:37:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.524
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.564
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.554
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.480
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.193
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.565
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.624
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.636


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.802 +- 0.428 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.208 +- 0.428 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all KL = 0.383 +- 0.428 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all L1 = 0.473 +- 0.343 (in-sample avg dev_std = 0.463)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.506
SUFF_SIMPLE for r=0.1 class 0.0 = 0.819 +- 0.434 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.214 +- 0.434 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 all KL = 0.396 +- 0.434 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 all L1 = 0.484 +- 0.350 (in-sample avg dev_std = 0.457)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.438 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.199 +- 0.438 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all KL = 0.398 +- 0.438 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all L1 = 0.48 +- 0.356 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.484
SUFF_SIMPLE for r=0.4 class 0.0 = 0.861 +- 0.453 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.186 +- 0.453 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.4 all KL = 0.424 +- 0.453 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.4 all L1 = 0.487 +- 0.373 (in-sample avg dev_std = 0.304)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.572
SUFF_SIMPLE for r=0.8 class 0.0 = 0.854 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.356 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.537 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.578 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.242 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.807 +- 0.242 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.904 +- 0.242 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.242 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.807 +- 0.242 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.1 all KL = 0.905 +- 0.242 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.1 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.116)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.238 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.808 +- 0.238 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.2 all KL = 0.909 +- 0.238 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.2 all L1 = 0.902 +- 0.231 (in-sample avg dev_std = 0.085)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.236 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.236 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.912 +- 0.236 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.232 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.913 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.232 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.606
SUFF_SIMPLE for r=0.05 class 0.0 = 0.766 +- 0.459 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.488 +- 0.459 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 all KL = 0.502 +- 0.459 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 all L1 = 0.629 +- 0.353 (in-sample avg dev_std = 0.437)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.611
SUFF_SIMPLE for r=0.1 class 0.0 = 0.783 +- 0.464 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.521 +- 0.464 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 all KL = 0.557 +- 0.464 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 all L1 = 0.654 +- 0.364 (in-sample avg dev_std = 0.371)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.611
SUFF_SIMPLE for r=0.2 class 0.0 = 0.799 +- 0.458 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.556 +- 0.458 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 all KL = 0.614 +- 0.458 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 all L1 = 0.679 +- 0.372 (in-sample avg dev_std = 0.307)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.62
SUFF_SIMPLE for r=0.4 class 0.0 = 0.8 +- 0.448 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.595 +- 0.448 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 all KL = 0.655 +- 0.448 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 all L1 = 0.698 +- 0.374 (in-sample avg dev_std = 0.230)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4964
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.707
SUFF_SIMPLE for r=0.8 class 0.0 = 0.885 +- 0.310 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.310 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all KL = 0.865 +- 0.310 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all L1 = 0.871 +- 0.273 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.466
NEC for r=0.05 class 0.0 = 0.108 +- 0.464 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.816 +- 0.464 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.565 +- 0.464 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.501 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.452
NEC for r=0.1 class 0.0 = 0.121 +- 0.462 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.824 +- 0.462 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.573 +- 0.462 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.51 +- 0.385 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
NEC for r=0.2 class 0.0 = 0.15 +- 0.449 (in-sample avg dev_std = 0.309)
NEC for r=0.2 class 1.0 = 0.8 +- 0.449 (in-sample avg dev_std = 0.309)
NEC for r=0.2 all KL = 0.588 +- 0.449 (in-sample avg dev_std = 0.309)
NEC for r=0.2 all L1 = 0.51 +- 0.366 (in-sample avg dev_std = 0.309)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.194 +- 0.432 (in-sample avg dev_std = 0.482)
NEC for r=0.4 class 1.0 = 0.761 +- 0.432 (in-sample avg dev_std = 0.482)
NEC for r=0.4 all KL = 0.609 +- 0.432 (in-sample avg dev_std = 0.482)
NEC for r=0.4 all L1 = 0.508 +- 0.341 (in-sample avg dev_std = 0.482)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.561
NEC for r=0.8 class 0.0 = 0.24 +- 0.414 (in-sample avg dev_std = 0.572)
NEC for r=0.8 class 1.0 = 0.696 +- 0.414 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all KL = 0.613 +- 0.414 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all L1 = 0.493 +- 0.320 (in-sample avg dev_std = 0.572)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.005 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.187 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.088 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.097 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.007 +- 0.236 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.187 +- 0.236 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.09 +- 0.236 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.098 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.01 +- 0.242 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.191 +- 0.242 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.096 +- 0.242 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.101 +- 0.231 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.503
NEC for r=0.4 class 0.0 = 0.02 +- 0.256 (in-sample avg dev_std = 0.189)
NEC for r=0.4 class 1.0 = 0.19 +- 0.256 (in-sample avg dev_std = 0.189)
NEC for r=0.4 all KL = 0.11 +- 0.256 (in-sample avg dev_std = 0.189)
NEC for r=0.4 all L1 = 0.106 +- 0.230 (in-sample avg dev_std = 0.189)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.505
NEC for r=0.8 class 0.0 = 0.014 +- 0.248 (in-sample avg dev_std = 0.170)
NEC for r=0.8 class 1.0 = 0.189 +- 0.248 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all KL = 0.102 +- 0.248 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all L1 = 0.102 +- 0.228 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.518
NEC for r=0.05 class 0.0 = 0.327 +- 0.464 (in-sample avg dev_std = 0.014)
NEC for r=0.05 class 1.0 = 0.747 +- 0.464 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all KL = 0.622 +- 0.464 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all L1 = 0.535 +- 0.395 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.515
NEC for r=0.1 class 0.0 = 0.329 +- 0.464 (in-sample avg dev_std = 0.116)
NEC for r=0.1 class 1.0 = 0.752 +- 0.464 (in-sample avg dev_std = 0.116)
NEC for r=0.1 all KL = 0.627 +- 0.464 (in-sample avg dev_std = 0.116)
NEC for r=0.1 all L1 = 0.538 +- 0.394 (in-sample avg dev_std = 0.116)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.542
NEC for r=0.2 class 0.0 = 0.335 +- 0.463 (in-sample avg dev_std = 0.328)
NEC for r=0.2 class 1.0 = 0.726 +- 0.463 (in-sample avg dev_std = 0.328)
NEC for r=0.2 all KL = 0.63 +- 0.463 (in-sample avg dev_std = 0.328)
NEC for r=0.2 all L1 = 0.528 +- 0.383 (in-sample avg dev_std = 0.328)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.595
NEC for r=0.4 class 0.0 = 0.333 +- 0.451 (in-sample avg dev_std = 0.478)
NEC for r=0.4 class 1.0 = 0.64 +- 0.451 (in-sample avg dev_std = 0.478)
NEC for r=0.4 all KL = 0.622 +- 0.451 (in-sample avg dev_std = 0.478)
NEC for r=0.4 all L1 = 0.485 +- 0.358 (in-sample avg dev_std = 0.478)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.632
NEC for r=0.8 class 0.0 = 0.326 +- 0.427 (in-sample avg dev_std = 0.560)
NEC for r=0.8 class 1.0 = 0.558 +- 0.427 (in-sample avg dev_std = 0.560)
NEC for r=0.8 all KL = 0.62 +- 0.427 (in-sample avg dev_std = 0.560)
NEC for r=0.8 all L1 = 0.44 +- 0.329 (in-sample avg dev_std = 0.560)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 15:53:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 03:53:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.558
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.583
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.538
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.497
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.275
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.171
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.163
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.627
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.633
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.631


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.505
SUFF_SIMPLE for r=0.05 class 0.0 = 0.831 +- 0.429 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.222 +- 0.429 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all KL = 0.42 +- 0.429 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.347 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.430 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.216 +- 0.430 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.430 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 all L1 = 0.491 +- 0.348 (in-sample avg dev_std = 0.446)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.516
SUFF_SIMPLE for r=0.2 class 0.0 = 0.817 +- 0.429 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.253 +- 0.429 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.429 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.2 all L1 = 0.505 +- 0.349 (in-sample avg dev_std = 0.414)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.5
SUFF_SIMPLE for r=0.4 class 0.0 = 0.852 +- 0.447 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.23 +- 0.447 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.447 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all L1 = 0.508 +- 0.371 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.556
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.353 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.543 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.575 +- 0.387 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.05 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.057)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.039)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.019)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.652
SUFF_SIMPLE for r=0.05 class 0.0 = 0.769 +- 0.413 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.617 +- 0.413 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all KL = 0.66 +- 0.413 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all L1 = 0.694 +- 0.345 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.65
SUFF_SIMPLE for r=0.1 class 0.0 = 0.764 +- 0.414 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.623 +- 0.414 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 all KL = 0.668 +- 0.414 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 all L1 = 0.695 +- 0.350 (in-sample avg dev_std = 0.195)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.656
SUFF_SIMPLE for r=0.2 class 0.0 = 0.773 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.618 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all KL = 0.671 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all L1 = 0.697 +- 0.353 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.651
SUFF_SIMPLE for r=0.4 class 0.0 = 0.771 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.619 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all KL = 0.67 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all L1 = 0.696 +- 0.354 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.734
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.287 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.864 +- 0.287 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 all KL = 0.863 +- 0.287 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 all L1 = 0.858 +- 0.258 (in-sample avg dev_std = 0.014)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.472
NEC for r=0.05 class 0.0 = 0.086 +- 0.458 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.793 +- 0.458 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.532 +- 0.458 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.478 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.46
NEC for r=0.1 class 0.0 = 0.094 +- 0.458 (in-sample avg dev_std = 0.030)
NEC for r=0.1 class 1.0 = 0.806 +- 0.458 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all KL = 0.543 +- 0.458 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all L1 = 0.488 +- 0.385 (in-sample avg dev_std = 0.030)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.467
NEC for r=0.2 class 0.0 = 0.12 +- 0.449 (in-sample avg dev_std = 0.279)
NEC for r=0.2 class 1.0 = 0.806 +- 0.449 (in-sample avg dev_std = 0.279)
NEC for r=0.2 all KL = 0.561 +- 0.449 (in-sample avg dev_std = 0.279)
NEC for r=0.2 all L1 = 0.5 +- 0.373 (in-sample avg dev_std = 0.279)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.503
NEC for r=0.4 class 0.0 = 0.149 +- 0.435 (in-sample avg dev_std = 0.440)
NEC for r=0.4 class 1.0 = 0.769 +- 0.435 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all KL = 0.569 +- 0.435 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all L1 = 0.492 +- 0.351 (in-sample avg dev_std = 0.440)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.57
NEC for r=0.8 class 0.0 = 0.208 +- 0.404 (in-sample avg dev_std = 0.543)
NEC for r=0.8 class 1.0 = 0.684 +- 0.404 (in-sample avg dev_std = 0.543)
NEC for r=0.8 all KL = 0.572 +- 0.404 (in-sample avg dev_std = 0.543)
NEC for r=0.8 all L1 = 0.472 +- 0.316 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.495
NEC for r=0.05 class 0.0 = 0.017 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.147 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.215 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.024 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.143 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.079 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.084 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.026 +- 0.233 (in-sample avg dev_std = 0.106)
NEC for r=0.2 class 1.0 = 0.148 +- 0.233 (in-sample avg dev_std = 0.106)
NEC for r=0.2 all KL = 0.087 +- 0.233 (in-sample avg dev_std = 0.106)
NEC for r=0.2 all L1 = 0.088 +- 0.216 (in-sample avg dev_std = 0.106)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.021 +- 0.230 (in-sample avg dev_std = 0.178)
NEC for r=0.4 class 1.0 = 0.149 +- 0.230 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all KL = 0.087 +- 0.230 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all L1 = 0.085 +- 0.211 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
NEC for r=0.8 class 0.0 = 0.012 +- 0.220 (in-sample avg dev_std = 0.154)
NEC for r=0.8 class 1.0 = 0.149 +- 0.220 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all KL = 0.079 +- 0.220 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all L1 = 0.081 +- 0.208 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.524
NEC for r=0.05 class 0.0 = 0.305 +- 0.452 (in-sample avg dev_std = 0.029)
NEC for r=0.05 class 1.0 = 0.733 +- 0.452 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all KL = 0.574 +- 0.452 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all L1 = 0.516 +- 0.386 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.527
NEC for r=0.1 class 0.0 = 0.309 +- 0.451 (in-sample avg dev_std = 0.159)
NEC for r=0.1 class 1.0 = 0.742 +- 0.451 (in-sample avg dev_std = 0.159)
NEC for r=0.1 all KL = 0.586 +- 0.451 (in-sample avg dev_std = 0.159)
NEC for r=0.1 all L1 = 0.523 +- 0.383 (in-sample avg dev_std = 0.159)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.559
NEC for r=0.2 class 0.0 = 0.314 +- 0.447 (in-sample avg dev_std = 0.316)
NEC for r=0.2 class 1.0 = 0.718 +- 0.447 (in-sample avg dev_std = 0.316)
NEC for r=0.2 all KL = 0.596 +- 0.447 (in-sample avg dev_std = 0.316)
NEC for r=0.2 all L1 = 0.513 +- 0.373 (in-sample avg dev_std = 0.316)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.601
NEC for r=0.4 class 0.0 = 0.315 +- 0.431 (in-sample avg dev_std = 0.446)
NEC for r=0.4 class 1.0 = 0.636 +- 0.431 (in-sample avg dev_std = 0.446)
NEC for r=0.4 all KL = 0.58 +- 0.431 (in-sample avg dev_std = 0.446)
NEC for r=0.4 all L1 = 0.474 +- 0.350 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.643
NEC for r=0.8 class 0.0 = 0.305 +- 0.406 (in-sample avg dev_std = 0.518)
NEC for r=0.8 class 1.0 = 0.535 +- 0.406 (in-sample avg dev_std = 0.518)
NEC for r=0.8 all KL = 0.543 +- 0.406 (in-sample avg dev_std = 0.518)
NEC for r=0.8 all L1 = 0.419 +- 0.320 (in-sample avg dev_std = 0.518)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 16:08:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 04:08:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.586
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.506
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.464
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.182
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.140
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.583
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.629
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.461
SUFF_SIMPLE for r=0.05 class 0.0 = 0.832 +- 0.440 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.178 +- 0.440 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 all KL = 0.414 +- 0.440 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 all L1 = 0.47 +- 0.362 (in-sample avg dev_std = 0.311)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.453
SUFF_SIMPLE for r=0.1 class 0.0 = 0.837 +- 0.444 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.169 +- 0.444 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.444 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 all L1 = 0.467 +- 0.367 (in-sample avg dev_std = 0.254)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
SUFF_SIMPLE for r=0.2 class 0.0 = 0.855 +- 0.449 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.166 +- 0.449 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all KL = 0.426 +- 0.449 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all L1 = 0.473 +- 0.372 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.451
SUFF_SIMPLE for r=0.4 class 0.0 = 0.858 +- 0.450 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.450 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all KL = 0.429 +- 0.450 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all L1 = 0.474 +- 0.376 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.56
SUFF_SIMPLE for r=0.8 class 0.0 = 0.841 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.529 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.561 +- 0.381 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.596
SUFF_SIMPLE for r=0.05 class 0.0 = 0.749 +- 0.428 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.447 +- 0.428 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 all KL = 0.502 +- 0.428 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 all L1 = 0.6 +- 0.349 (in-sample avg dev_std = 0.480)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.596
SUFF_SIMPLE for r=0.1 class 0.0 = 0.767 +- 0.436 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.463 +- 0.436 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all KL = 0.534 +- 0.436 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all L1 = 0.617 +- 0.357 (in-sample avg dev_std = 0.442)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.591
SUFF_SIMPLE for r=0.2 class 0.0 = 0.781 +- 0.437 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.496 +- 0.437 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all KL = 0.573 +- 0.437 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all L1 = 0.641 +- 0.363 (in-sample avg dev_std = 0.404)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.585
SUFF_SIMPLE for r=0.4 class 0.0 = 0.784 +- 0.447 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.507 +- 0.447 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.4 all KL = 0.592 +- 0.447 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.4 all L1 = 0.647 +- 0.373 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4962
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.669
SUFF_SIMPLE for r=0.8 class 0.0 = 0.879 +- 0.353 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.788 +- 0.353 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.826 +- 0.353 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.834 +- 0.312 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.458
NEC for r=0.05 class 0.0 = 0.106 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.812 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.548 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.497 +- 0.388 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.448
NEC for r=0.1 class 0.0 = 0.118 +- 0.457 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.816 +- 0.457 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.558 +- 0.457 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.505 +- 0.380 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.46
NEC for r=0.2 class 0.0 = 0.121 +- 0.456 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.811 +- 0.456 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.559 +- 0.456 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.503 +- 0.380 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.488
NEC for r=0.4 class 0.0 = 0.128 +- 0.451 (in-sample avg dev_std = 0.317)
NEC for r=0.4 class 1.0 = 0.795 +- 0.451 (in-sample avg dev_std = 0.317)
NEC for r=0.4 all KL = 0.557 +- 0.451 (in-sample avg dev_std = 0.317)
NEC for r=0.4 all L1 = 0.497 +- 0.371 (in-sample avg dev_std = 0.317)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.53
NEC for r=0.8 class 0.0 = 0.17 +- 0.429 (in-sample avg dev_std = 0.486)
NEC for r=0.8 class 1.0 = 0.755 +- 0.429 (in-sample avg dev_std = 0.486)
NEC for r=0.8 all KL = 0.568 +- 0.429 (in-sample avg dev_std = 0.486)
NEC for r=0.8 all L1 = 0.494 +- 0.342 (in-sample avg dev_std = 0.486)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.173 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.108 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.046 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.056 +- 0.171 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.006 +- 0.159 (in-sample avg dev_std = 0.026)
NEC for r=0.2 class 1.0 = 0.106 +- 0.159 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all KL = 0.047 +- 0.159 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all L1 = 0.056 +- 0.170 (in-sample avg dev_std = 0.026)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.167 (in-sample avg dev_std = 0.036)
NEC for r=0.4 class 1.0 = 0.111 +- 0.167 (in-sample avg dev_std = 0.036)
NEC for r=0.4 all KL = 0.049 +- 0.167 (in-sample avg dev_std = 0.036)
NEC for r=0.4 all L1 = 0.057 +- 0.174 (in-sample avg dev_std = 0.036)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.166 (in-sample avg dev_std = 0.023)
NEC for r=0.8 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all KL = 0.047 +- 0.166 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all L1 = 0.056 +- 0.174 (in-sample avg dev_std = 0.023)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.517
NEC for r=0.05 class 0.0 = 0.329 +- 0.462 (in-sample avg dev_std = 0.012)
NEC for r=0.05 class 1.0 = 0.732 +- 0.462 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all KL = 0.608 +- 0.462 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all L1 = 0.528 +- 0.395 (in-sample avg dev_std = 0.012)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 0.0 = 0.334 +- 0.461 (in-sample avg dev_std = 0.100)
NEC for r=0.1 class 1.0 = 0.74 +- 0.461 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all KL = 0.616 +- 0.461 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all L1 = 0.535 +- 0.393 (in-sample avg dev_std = 0.100)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.524
NEC for r=0.2 class 0.0 = 0.337 +- 0.458 (in-sample avg dev_std = 0.247)
NEC for r=0.2 class 1.0 = 0.727 +- 0.458 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all KL = 0.614 +- 0.458 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all L1 = 0.529 +- 0.388 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.557
NEC for r=0.4 class 0.0 = 0.33 +- 0.448 (in-sample avg dev_std = 0.414)
NEC for r=0.4 class 1.0 = 0.672 +- 0.448 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all KL = 0.591 +- 0.448 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all L1 = 0.499 +- 0.374 (in-sample avg dev_std = 0.414)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.586
NEC for r=0.8 class 0.0 = 0.336 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 class 1.0 = 0.636 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 all KL = 0.599 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 all L1 = 0.484 +- 0.338 (in-sample avg dev_std = 0.548)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 16:24:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 04:24:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.589
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.571
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.528
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.491
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.419
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.308
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.237
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.203
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.196
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.563
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.600
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.619
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.626
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.634


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.459
SUFF_SIMPLE for r=0.05 class 0.0 = 0.831 +- 0.432 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.176 +- 0.432 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.414 +- 0.432 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.468 +- 0.356 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.472
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.177 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all KL = 0.43 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all L1 = 0.478 +- 0.363 (in-sample avg dev_std = 0.312)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.47
SUFF_SIMPLE for r=0.2 class 0.0 = 0.86 +- 0.443 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.172 +- 0.443 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.443 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.2 all L1 = 0.479 +- 0.366 (in-sample avg dev_std = 0.275)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.454
SUFF_SIMPLE for r=0.4 class 0.0 = 0.857 +- 0.446 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.168 +- 0.446 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all KL = 0.432 +- 0.446 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all L1 = 0.475 +- 0.371 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.546
SUFF_SIMPLE for r=0.8 class 0.0 = 0.85 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.315 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.526 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.554 +- 0.380 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.618
SUFF_SIMPLE for r=0.05 class 0.0 = 0.744 +- 0.430 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.484 +- 0.430 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.05 all KL = 0.557 +- 0.430 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.343 (in-sample avg dev_std = 0.400)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.767 +- 0.429 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.524 +- 0.429 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all KL = 0.609 +- 0.429 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all L1 = 0.647 +- 0.350 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.621
SUFF_SIMPLE for r=0.2 class 0.0 = 0.783 +- 0.421 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.565 +- 0.421 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all KL = 0.655 +- 0.421 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all L1 = 0.676 +- 0.354 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
SUFF_SIMPLE for r=0.4 class 0.0 = 0.781 +- 0.422 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.589 +- 0.422 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all KL = 0.669 +- 0.422 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all L1 = 0.686 +- 0.354 (in-sample avg dev_std = 0.237)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4960
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.705
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.292 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.292 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.872 +- 0.292 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.859 +- 0.265 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.442
NEC for r=0.05 class 0.0 = 0.093 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.831 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.547 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.502 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.464
NEC for r=0.1 class 0.0 = 0.096 +- 0.455 (in-sample avg dev_std = 0.003)
NEC for r=0.1 class 1.0 = 0.816 +- 0.455 (in-sample avg dev_std = 0.003)
NEC for r=0.1 all KL = 0.542 +- 0.455 (in-sample avg dev_std = 0.003)
NEC for r=0.1 all L1 = 0.495 +- 0.383 (in-sample avg dev_std = 0.003)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.46
NEC for r=0.2 class 0.0 = 0.109 +- 0.452 (in-sample avg dev_std = 0.151)
NEC for r=0.2 class 1.0 = 0.813 +- 0.452 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all KL = 0.548 +- 0.452 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all L1 = 0.499 +- 0.380 (in-sample avg dev_std = 0.151)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.47
NEC for r=0.4 class 0.0 = 0.13 +- 0.445 (in-sample avg dev_std = 0.300)
NEC for r=0.4 class 1.0 = 0.811 +- 0.445 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all KL = 0.56 +- 0.445 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all L1 = 0.507 +- 0.368 (in-sample avg dev_std = 0.300)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.528
NEC for r=0.8 class 0.0 = 0.178 +- 0.423 (in-sample avg dev_std = 0.475)
NEC for r=0.8 class 1.0 = 0.751 +- 0.423 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all KL = 0.561 +- 0.423 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all L1 = 0.496 +- 0.340 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.175 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.005 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.173 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.071 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.007 +- 0.191 (in-sample avg dev_std = 0.029)
NEC for r=0.2 class 1.0 = 0.173 +- 0.191 (in-sample avg dev_std = 0.029)
NEC for r=0.2 all KL = 0.073 +- 0.191 (in-sample avg dev_std = 0.029)
NEC for r=0.2 all L1 = 0.091 +- 0.207 (in-sample avg dev_std = 0.029)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.004 +- 0.198 (in-sample avg dev_std = 0.045)
NEC for r=0.4 class 1.0 = 0.177 +- 0.198 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.076 +- 0.198 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.091 +- 0.210 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.003 +- 0.198 (in-sample avg dev_std = 0.023)
NEC for r=0.8 class 1.0 = 0.177 +- 0.198 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all KL = 0.074 +- 0.198 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all L1 = 0.09 +- 0.210 (in-sample avg dev_std = 0.023)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.522
NEC for r=0.05 class 0.0 = 0.312 +- 0.445 (in-sample avg dev_std = 0.007)
NEC for r=0.05 class 1.0 = 0.728 +- 0.445 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all KL = 0.579 +- 0.445 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all L1 = 0.517 +- 0.392 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.52
NEC for r=0.1 class 0.0 = 0.316 +- 0.445 (in-sample avg dev_std = 0.056)
NEC for r=0.1 class 1.0 = 0.73 +- 0.445 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all KL = 0.587 +- 0.445 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all L1 = 0.521 +- 0.391 (in-sample avg dev_std = 0.056)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.527
NEC for r=0.2 class 0.0 = 0.321 +- 0.447 (in-sample avg dev_std = 0.184)
NEC for r=0.2 class 1.0 = 0.724 +- 0.447 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all KL = 0.589 +- 0.447 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all L1 = 0.52 +- 0.390 (in-sample avg dev_std = 0.184)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.553
NEC for r=0.4 class 0.0 = 0.316 +- 0.439 (in-sample avg dev_std = 0.373)
NEC for r=0.4 class 1.0 = 0.696 +- 0.439 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all KL = 0.575 +- 0.439 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all L1 = 0.504 +- 0.376 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.585
NEC for r=0.8 class 0.0 = 0.328 +- 0.416 (in-sample avg dev_std = 0.542)
NEC for r=0.8 class 1.0 = 0.653 +- 0.416 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all KL = 0.582 +- 0.416 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all L1 = 0.488 +- 0.343 (in-sample avg dev_std = 0.542)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 16:41:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 04:41:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.544
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.543
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.467
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.374
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.311
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.326
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.120
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.063
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.572
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.579
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.581
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.586


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.452
SUFF_SIMPLE for r=0.05 class 0.0 = 0.842 +- 0.429 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.173 +- 0.429 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all KL = 0.435 +- 0.429 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all L1 = 0.471 +- 0.365 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.444
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.429 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.172 +- 0.429 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.429 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all L1 = 0.466 +- 0.365 (in-sample avg dev_std = 0.156)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.821 +- 0.427 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.244 +- 0.427 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all KL = 0.471 +- 0.427 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all L1 = 0.501 +- 0.366 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.45
SUFF_SIMPLE for r=0.4 class 0.0 = 0.82 +- 0.432 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.197 +- 0.432 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all KL = 0.442 +- 0.432 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all L1 = 0.475 +- 0.368 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.48
SUFF_SIMPLE for r=0.8 class 0.0 = 0.851 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.224 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.48 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.504 +- 0.377 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.636
SUFF_SIMPLE for r=0.05 class 0.0 = 0.797 +- 0.422 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.63 +- 0.422 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all KL = 0.679 +- 0.422 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all L1 = 0.715 +- 0.341 (in-sample avg dev_std = 0.206)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.633
SUFF_SIMPLE for r=0.1 class 0.0 = 0.793 +- 0.413 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.643 +- 0.413 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all KL = 0.696 +- 0.413 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all L1 = 0.719 +- 0.343 (in-sample avg dev_std = 0.161)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.636
SUFF_SIMPLE for r=0.2 class 0.0 = 0.793 +- 0.411 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.642 +- 0.411 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all KL = 0.709 +- 0.411 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all L1 = 0.719 +- 0.354 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
SUFF_SIMPLE for r=0.4 class 0.0 = 0.802 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.641 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all KL = 0.719 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all L1 = 0.723 +- 0.354 (in-sample avg dev_std = 0.126)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF_SIMPLE for r=0.8 class 0.0 = 0.893 +- 0.272 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.272 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.893 +- 0.272 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.874 +- 0.249 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.468
NEC for r=0.05 class 0.0 = 0.119 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.801 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.532 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.497 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
NEC for r=0.1 class 0.0 = 0.115 +- 0.443 (in-sample avg dev_std = 0.006)
NEC for r=0.1 class 1.0 = 0.822 +- 0.443 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all KL = 0.541 +- 0.443 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all L1 = 0.507 +- 0.383 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
NEC for r=0.2 class 0.0 = 0.129 +- 0.441 (in-sample avg dev_std = 0.064)
NEC for r=0.2 class 1.0 = 0.824 +- 0.441 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all KL = 0.546 +- 0.441 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all L1 = 0.514 +- 0.377 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.456
NEC for r=0.4 class 0.0 = 0.143 +- 0.435 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.82 +- 0.435 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.551 +- 0.435 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.518 +- 0.371 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.477
NEC for r=0.8 class 0.0 = 0.163 +- 0.424 (in-sample avg dev_std = 0.256)
NEC for r=0.8 class 1.0 = 0.8 +- 0.424 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all KL = 0.552 +- 0.424 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all L1 = 0.516 +- 0.360 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.104 (in-sample avg dev_std = 0.004)
NEC for r=0.2 class 1.0 = 0.09 +- 0.104 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all KL = 0.031 +- 0.104 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all L1 = 0.046 +- 0.132 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.536
NEC for r=0.05 class 0.0 = 0.329 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.73 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.576 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.527 +- 0.384 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.52
NEC for r=0.1 class 0.0 = 0.338 +- 0.435 (in-sample avg dev_std = 0.025)
NEC for r=0.1 class 1.0 = 0.751 +- 0.435 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all KL = 0.592 +- 0.435 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all L1 = 0.542 +- 0.378 (in-sample avg dev_std = 0.025)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.511
NEC for r=0.2 class 0.0 = 0.343 +- 0.436 (in-sample avg dev_std = 0.179)
NEC for r=0.2 class 1.0 = 0.74 +- 0.436 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all KL = 0.592 +- 0.436 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all L1 = 0.539 +- 0.378 (in-sample avg dev_std = 0.179)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.54
NEC for r=0.4 class 0.0 = 0.327 +- 0.429 (in-sample avg dev_std = 0.399)
NEC for r=0.4 class 1.0 = 0.696 +- 0.429 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all KL = 0.572 +- 0.429 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all L1 = 0.509 +- 0.366 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.596
NEC for r=0.8 class 0.0 = 0.313 +- 0.401 (in-sample avg dev_std = 0.537)
NEC for r=0.8 class 1.0 = 0.616 +- 0.401 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all KL = 0.551 +- 0.401 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all L1 = 0.462 +- 0.333 (in-sample avg dev_std = 0.537)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 16:57:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 04:57:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.572
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.518
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.472
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.186
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.147
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.135
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.554
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.599
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.618
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.624
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.483
SUFF_SIMPLE for r=0.05 class 0.0 = 0.875 +- 0.442 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.189 +- 0.442 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all KL = 0.441 +- 0.442 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all L1 = 0.495 +- 0.368 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.869 +- 0.437 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.194 +- 0.437 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all KL = 0.436 +- 0.437 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.364 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.51
SUFF_SIMPLE for r=0.2 class 0.0 = 0.842 +- 0.434 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.238 +- 0.434 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 all KL = 0.45 +- 0.434 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 all L1 = 0.508 +- 0.362 (in-sample avg dev_std = 0.296)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.469
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.446 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.192 +- 0.446 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all KL = 0.44 +- 0.446 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all L1 = 0.491 +- 0.375 (in-sample avg dev_std = 0.194)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.54
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.325 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.53 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.56 +- 0.386 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.654
SUFF_SIMPLE for r=0.05 class 0.0 = 0.814 +- 0.421 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.633 +- 0.421 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all KL = 0.704 +- 0.421 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all L1 = 0.725 +- 0.363 (in-sample avg dev_std = 0.148)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.655
SUFF_SIMPLE for r=0.1 class 0.0 = 0.801 +- 0.422 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.64 +- 0.422 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.699 +- 0.422 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.722 +- 0.361 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.648
SUFF_SIMPLE for r=0.2 class 0.0 = 0.795 +- 0.430 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.621 +- 0.430 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all KL = 0.683 +- 0.430 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all L1 = 0.709 +- 0.369 (in-sample avg dev_std = 0.118)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.652
SUFF_SIMPLE for r=0.4 class 0.0 = 0.797 +- 0.426 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.628 +- 0.426 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all KL = 0.69 +- 0.426 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all L1 = 0.714 +- 0.367 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.724
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.287 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.287 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.287 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.874 +- 0.260 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.448
NEC for r=0.05 class 0.0 = 0.078 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.823 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.542 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.491 +- 0.396 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.45
NEC for r=0.1 class 0.0 = 0.081 +- 0.462 (in-sample avg dev_std = 0.004)
NEC for r=0.1 class 1.0 = 0.814 +- 0.462 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all KL = 0.54 +- 0.462 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all L1 = 0.487 +- 0.393 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.455
NEC for r=0.2 class 0.0 = 0.094 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.2 class 1.0 = 0.812 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all KL = 0.542 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all L1 = 0.492 +- 0.387 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.477
NEC for r=0.4 class 0.0 = 0.106 +- 0.451 (in-sample avg dev_std = 0.307)
NEC for r=0.4 class 1.0 = 0.805 +- 0.451 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all KL = 0.548 +- 0.451 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all L1 = 0.493 +- 0.374 (in-sample avg dev_std = 0.307)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.547
NEC for r=0.8 class 0.0 = 0.132 +- 0.434 (in-sample avg dev_std = 0.459)
NEC for r=0.8 class 1.0 = 0.743 +- 0.434 (in-sample avg dev_std = 0.459)
NEC for r=0.8 all KL = 0.536 +- 0.434 (in-sample avg dev_std = 0.459)
NEC for r=0.8 all L1 = 0.471 +- 0.351 (in-sample avg dev_std = 0.459)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.089 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.138 (in-sample avg dev_std = 0.014)
NEC for r=0.4 class 1.0 = 0.09 +- 0.138 (in-sample avg dev_std = 0.014)
NEC for r=0.4 all KL = 0.036 +- 0.138 (in-sample avg dev_std = 0.014)
NEC for r=0.4 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.138 (in-sample avg dev_std = 0.028)
NEC for r=0.8 class 1.0 = 0.09 +- 0.138 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all KL = 0.037 +- 0.138 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.028)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.346 +- 0.452 (in-sample avg dev_std = 0.004)
NEC for r=0.05 class 1.0 = 0.765 +- 0.452 (in-sample avg dev_std = 0.004)
NEC for r=0.05 all KL = 0.624 +- 0.452 (in-sample avg dev_std = 0.004)
NEC for r=0.05 all L1 = 0.553 +- 0.377 (in-sample avg dev_std = 0.004)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.513
NEC for r=0.1 class 0.0 = 0.354 +- 0.450 (in-sample avg dev_std = 0.063)
NEC for r=0.1 class 1.0 = 0.768 +- 0.450 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all KL = 0.63 +- 0.450 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all L1 = 0.559 +- 0.374 (in-sample avg dev_std = 0.063)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.516
NEC for r=0.2 class 0.0 = 0.346 +- 0.453 (in-sample avg dev_std = 0.213)
NEC for r=0.2 class 1.0 = 0.761 +- 0.453 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.627 +- 0.453 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.551 +- 0.377 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.548
NEC for r=0.4 class 0.0 = 0.33 +- 0.446 (in-sample avg dev_std = 0.422)
NEC for r=0.4 class 1.0 = 0.711 +- 0.446 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all KL = 0.61 +- 0.446 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all L1 = 0.518 +- 0.364 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.584
NEC for r=0.8 class 0.0 = 0.307 +- 0.423 (in-sample avg dev_std = 0.537)
NEC for r=0.8 class 1.0 = 0.627 +- 0.423 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all KL = 0.578 +- 0.423 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all L1 = 0.465 +- 0.338 (in-sample avg dev_std = 0.537)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 17:13:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 05:13:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.520
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.497
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.408
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.300
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.219
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.266
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.161
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.055
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.528
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.538
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.529
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.536


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.787 +- 0.404 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.192 +- 0.404 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all KL = 0.45 +- 0.404 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all L1 = 0.457 +- 0.345 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.449
SUFF_SIMPLE for r=0.1 class 0.0 = 0.783 +- 0.401 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.195 +- 0.401 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.401 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 all L1 = 0.457 +- 0.343 (in-sample avg dev_std = 0.111)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
SUFF_SIMPLE for r=0.2 class 0.0 = 0.78 +- 0.402 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.257 +- 0.402 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all KL = 0.49 +- 0.402 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all L1 = 0.49 +- 0.346 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.474
SUFF_SIMPLE for r=0.4 class 0.0 = 0.762 +- 0.402 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.251 +- 0.402 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 all KL = 0.475 +- 0.402 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 all L1 = 0.479 +- 0.346 (in-sample avg dev_std = 0.055)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.779 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.271 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.497 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.497 +- 0.354 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.611
SUFF_SIMPLE for r=0.05 class 0.0 = 0.769 +- 0.374 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.517 +- 0.374 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.684 +- 0.374 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.644 +- 0.319 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454658
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.61
SUFF_SIMPLE for r=0.1 class 0.0 = 0.77 +- 0.369 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.529 +- 0.369 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 all KL = 0.694 +- 0.369 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 all L1 = 0.651 +- 0.315 (in-sample avg dev_std = 0.121)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.62
SUFF_SIMPLE for r=0.2 class 0.0 = 0.756 +- 0.381 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.51 +- 0.381 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.2 all KL = 0.678 +- 0.381 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.2 all L1 = 0.635 +- 0.323 (in-sample avg dev_std = 0.111)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.617
SUFF_SIMPLE for r=0.4 class 0.0 = 0.755 +- 0.384 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.505 +- 0.384 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all KL = 0.676 +- 0.384 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all L1 = 0.631 +- 0.326 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.666
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.263 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.753 +- 0.263 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.869 +- 0.263 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.811 +- 0.255 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.456
NEC for r=0.05 class 0.0 = 0.161 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.778 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.513 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.503 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.452
NEC for r=0.1 class 0.0 = 0.164 +- 0.411 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.782 +- 0.411 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.515 +- 0.411 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.506 +- 0.358 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
NEC for r=0.2 class 0.0 = 0.187 +- 0.410 (in-sample avg dev_std = 0.051)
NEC for r=0.2 class 1.0 = 0.792 +- 0.410 (in-sample avg dev_std = 0.051)
NEC for r=0.2 all KL = 0.532 +- 0.410 (in-sample avg dev_std = 0.051)
NEC for r=0.2 all L1 = 0.522 +- 0.351 (in-sample avg dev_std = 0.051)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.471
NEC for r=0.4 class 0.0 = 0.199 +- 0.405 (in-sample avg dev_std = 0.187)
NEC for r=0.4 class 1.0 = 0.783 +- 0.405 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all KL = 0.53 +- 0.405 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all L1 = 0.522 +- 0.344 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.486
NEC for r=0.8 class 0.0 = 0.215 +- 0.391 (in-sample avg dev_std = 0.251)
NEC for r=0.8 class 1.0 = 0.769 +- 0.391 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all KL = 0.531 +- 0.391 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all L1 = 0.522 +- 0.333 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.005 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.165 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.085 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.006 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.163 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.057 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.085 +- 0.175 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.006 +- 0.137 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.162 +- 0.137 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.057 +- 0.137 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.085 +- 0.175 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.4 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.002)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.001)
NEC for r=0.8 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.321 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.597 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.433 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.457 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454658
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.536
NEC for r=0.1 class 0.0 = 0.33 +- 0.393 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.606 +- 0.393 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.445 +- 0.393 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.466 +- 0.347 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.527
NEC for r=0.2 class 0.0 = 0.339 +- 0.390 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.636 +- 0.390 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.474 +- 0.390 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.486 +- 0.344 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.518
NEC for r=0.4 class 0.0 = 0.341 +- 0.391 (in-sample avg dev_std = 0.234)
NEC for r=0.4 class 1.0 = 0.653 +- 0.391 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all KL = 0.488 +- 0.391 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all L1 = 0.495 +- 0.339 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.539
NEC for r=0.8 class 0.0 = 0.324 +- 0.383 (in-sample avg dev_std = 0.377)
NEC for r=0.8 class 1.0 = 0.611 +- 0.383 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all KL = 0.461 +- 0.383 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all L1 = 0.465 +- 0.326 (in-sample avg dev_std = 0.377)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 17:29:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 05:29:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.523
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.492
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.418
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.345
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.225
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.102
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.556
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.592
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.607
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.612
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.609


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.461
SUFF_SIMPLE for r=0.05 class 0.0 = 0.821 +- 0.427 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.173 +- 0.427 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all KL = 0.407 +- 0.427 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all L1 = 0.462 +- 0.353 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.465
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.424 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.176 +- 0.424 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.1 all KL = 0.408 +- 0.424 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.1 all L1 = 0.464 +- 0.352 (in-sample avg dev_std = 0.350)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
SUFF_SIMPLE for r=0.2 class 0.0 = 0.816 +- 0.428 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.177 +- 0.428 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all KL = 0.408 +- 0.428 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all L1 = 0.462 +- 0.355 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.485
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.441 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.214 +- 0.441 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.441 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 all L1 = 0.494 +- 0.371 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.552
SUFF_SIMPLE for r=0.8 class 0.0 = 0.847 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.313 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.525 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.551 +- 0.381 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.171 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.171 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.171 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.171 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.83 +- 0.171 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.171 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.022)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.003)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.618
SUFF_SIMPLE for r=0.05 class 0.0 = 0.787 +- 0.435 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.556 +- 0.435 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 all KL = 0.613 +- 0.435 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 all L1 = 0.673 +- 0.359 (in-sample avg dev_std = 0.310)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.621
SUFF_SIMPLE for r=0.1 class 0.0 = 0.793 +- 0.436 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.575 +- 0.436 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all KL = 0.641 +- 0.436 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all L1 = 0.685 +- 0.367 (in-sample avg dev_std = 0.237)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.629
SUFF_SIMPLE for r=0.2 class 0.0 = 0.802 +- 0.435 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.59 +- 0.435 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all KL = 0.663 +- 0.435 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all L1 = 0.697 +- 0.370 (in-sample avg dev_std = 0.187)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.636
SUFF_SIMPLE for r=0.4 class 0.0 = 0.802 +- 0.431 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.604 +- 0.431 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all KL = 0.674 +- 0.431 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all L1 = 0.704 +- 0.370 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.274 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.872 +- 0.274 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.274 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.247 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.464
NEC for r=0.05 class 0.0 = 0.11 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.814 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.547 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.5 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.464
NEC for r=0.1 class 0.0 = 0.119 +- 0.450 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.822 +- 0.450 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.554 +- 0.450 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.509 +- 0.377 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.124 +- 0.450 (in-sample avg dev_std = 0.133)
NEC for r=0.2 class 1.0 = 0.826 +- 0.450 (in-sample avg dev_std = 0.133)
NEC for r=0.2 all KL = 0.56 +- 0.450 (in-sample avg dev_std = 0.133)
NEC for r=0.2 all L1 = 0.513 +- 0.376 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.473
NEC for r=0.4 class 0.0 = 0.133 +- 0.445 (in-sample avg dev_std = 0.270)
NEC for r=0.4 class 1.0 = 0.821 +- 0.445 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all KL = 0.564 +- 0.445 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all L1 = 0.514 +- 0.369 (in-sample avg dev_std = 0.270)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.483
NEC for r=0.8 class 0.0 = 0.193 +- 0.421 (in-sample avg dev_std = 0.408)
NEC for r=0.8 class 1.0 = 0.797 +- 0.421 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all KL = 0.59 +- 0.421 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all L1 = 0.528 +- 0.342 (in-sample avg dev_std = 0.408)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.008)
NEC for r=0.2 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.008)
NEC for r=0.2 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.008)
NEC for r=0.2 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.008)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.011)
NEC for r=0.4 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.011)
NEC for r=0.4 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.011)
NEC for r=0.4 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.011)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.8 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.8 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.8 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.017)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.534
NEC for r=0.05 class 0.0 = 0.327 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.742 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.61 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.532 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.334 +- 0.459 (in-sample avg dev_std = 0.058)
NEC for r=0.1 class 1.0 = 0.77 +- 0.459 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all KL = 0.628 +- 0.459 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all L1 = 0.549 +- 0.386 (in-sample avg dev_std = 0.058)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.519
NEC for r=0.2 class 0.0 = 0.336 +- 0.455 (in-sample avg dev_std = 0.291)
NEC for r=0.2 class 1.0 = 0.764 +- 0.455 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all KL = 0.632 +- 0.455 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all L1 = 0.547 +- 0.377 (in-sample avg dev_std = 0.291)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.556
NEC for r=0.4 class 0.0 = 0.32 +- 0.441 (in-sample avg dev_std = 0.471)
NEC for r=0.4 class 1.0 = 0.703 +- 0.441 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all KL = 0.618 +- 0.441 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all L1 = 0.509 +- 0.353 (in-sample avg dev_std = 0.471)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.596
NEC for r=0.8 class 0.0 = 0.3 +- 0.407 (in-sample avg dev_std = 0.542)
NEC for r=0.8 class 1.0 = 0.609 +- 0.407 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all KL = 0.588 +- 0.407 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all L1 = 0.452 +- 0.321 (in-sample avg dev_std = 0.542)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Nov  4 17:46:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/04/2024 05:46:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.570
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.615
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.591
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.537
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.487
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.427
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.204
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.132
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.634
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.638
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.637


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.535
SUFF_SIMPLE for r=0.05 class 0.0 = 0.589 +- 0.407 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.437 +- 0.407 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.05 all KL = 0.395 +- 0.407 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.05 all L1 = 0.505 +- 0.331 (in-sample avg dev_std = 0.569)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.537
SUFF_SIMPLE for r=0.1 class 0.0 = 0.58 +- 0.425 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.464 +- 0.425 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 all KL = 0.42 +- 0.425 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 all L1 = 0.516 +- 0.344 (in-sample avg dev_std = 0.543)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.51
SUFF_SIMPLE for r=0.2 class 0.0 = 0.584 +- 0.429 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.445 +- 0.429 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.2 all KL = 0.42 +- 0.429 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.353 (in-sample avg dev_std = 0.479)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF_SIMPLE for r=0.4 class 0.0 = 0.631 +- 0.443 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.405 +- 0.443 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all KL = 0.435 +- 0.443 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all L1 = 0.506 +- 0.365 (in-sample avg dev_std = 0.400)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.588
SUFF_SIMPLE for r=0.8 class 0.0 = 0.836 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.409 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.565 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.6 +- 0.388 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.99 +- 0.231 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.231 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.231 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.212 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.986 +- 0.243 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.828 +- 0.243 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 all KL = 0.898 +- 0.243 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 all L1 = 0.906 +- 0.214 (in-sample avg dev_std = 0.167)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.495
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.264 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.825 +- 0.264 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.264 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.899 +- 0.220 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.96 +- 0.280 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.821 +- 0.280 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all KL = 0.876 +- 0.280 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.235 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.664
SUFF_SIMPLE for r=0.05 class 0.0 = 0.699 +- 0.410 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.82 +- 0.410 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.410 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 all L1 = 0.759 +- 0.335 (in-sample avg dev_std = 0.358)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.668
SUFF_SIMPLE for r=0.1 class 0.0 = 0.697 +- 0.404 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.83 +- 0.404 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 all KL = 0.726 +- 0.404 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 all L1 = 0.763 +- 0.343 (in-sample avg dev_std = 0.278)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.656
SUFF_SIMPLE for r=0.2 class 0.0 = 0.714 +- 0.414 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.787 +- 0.414 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 all KL = 0.716 +- 0.414 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 all L1 = 0.75 +- 0.353 (in-sample avg dev_std = 0.222)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.654
SUFF_SIMPLE for r=0.4 class 0.0 = 0.715 +- 0.431 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.722 +- 0.431 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all KL = 0.682 +- 0.431 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all L1 = 0.719 +- 0.369 (in-sample avg dev_std = 0.173)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.907 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.884 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.888 +- 0.259 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.54
NEC for r=0.05 class 0.0 = 0.081 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.701 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.47 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.424 +- 0.398 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.079 +- 0.473 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.782 +- 0.473 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.524 +- 0.473 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.468 +- 0.397 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.524
NEC for r=0.2 class 0.0 = 0.092 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.2 class 1.0 = 0.76 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.2 all KL = 0.536 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.2 all L1 = 0.462 +- 0.374 (in-sample avg dev_std = 0.390)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.633
NEC for r=0.4 class 0.0 = 0.124 +- 0.419 (in-sample avg dev_std = 0.537)
NEC for r=0.4 class 1.0 = 0.625 +- 0.419 (in-sample avg dev_std = 0.537)
NEC for r=0.4 all KL = 0.5 +- 0.419 (in-sample avg dev_std = 0.537)
NEC for r=0.4 all L1 = 0.402 +- 0.332 (in-sample avg dev_std = 0.537)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.701
NEC for r=0.8 class 0.0 = 0.24 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.8 class 1.0 = 0.501 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.8 all KL = 0.511 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.8 all L1 = 0.385 +- 0.278 (in-sample avg dev_std = 0.631)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.495
NEC for r=0.1 class 0.0 = 0.003 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.162 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.084 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.005 +- 0.212 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.166 +- 0.212 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.079 +- 0.212 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.086 +- 0.213 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
NEC for r=0.4 class 0.0 = 0.012 +- 0.232 (in-sample avg dev_std = 0.202)
NEC for r=0.4 class 1.0 = 0.178 +- 0.232 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all KL = 0.108 +- 0.232 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all L1 = 0.096 +- 0.208 (in-sample avg dev_std = 0.202)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.503
NEC for r=0.8 class 0.0 = 0.004 +- 0.211 (in-sample avg dev_std = 0.137)
NEC for r=0.8 class 1.0 = 0.168 +- 0.211 (in-sample avg dev_std = 0.137)
NEC for r=0.8 all KL = 0.082 +- 0.211 (in-sample avg dev_std = 0.137)
NEC for r=0.8 all L1 = 0.087 +- 0.209 (in-sample avg dev_std = 0.137)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.337 +- 0.473 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.702 +- 0.473 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.598 +- 0.473 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.517 +- 0.399 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.541
NEC for r=0.1 class 0.0 = 0.34 +- 0.466 (in-sample avg dev_std = 0.230)
NEC for r=0.1 class 1.0 = 0.708 +- 0.466 (in-sample avg dev_std = 0.230)
NEC for r=0.1 all KL = 0.611 +- 0.466 (in-sample avg dev_std = 0.230)
NEC for r=0.1 all L1 = 0.522 +- 0.391 (in-sample avg dev_std = 0.230)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.558
NEC for r=0.2 class 0.0 = 0.313 +- 0.451 (in-sample avg dev_std = 0.453)
NEC for r=0.2 class 1.0 = 0.658 +- 0.451 (in-sample avg dev_std = 0.453)
NEC for r=0.2 all KL = 0.597 +- 0.451 (in-sample avg dev_std = 0.453)
NEC for r=0.2 all L1 = 0.483 +- 0.370 (in-sample avg dev_std = 0.453)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 0.0 = 0.271 +- 0.427 (in-sample avg dev_std = 0.548)
NEC for r=0.4 class 1.0 = 0.542 +- 0.427 (in-sample avg dev_std = 0.548)
NEC for r=0.4 all KL = 0.537 +- 0.427 (in-sample avg dev_std = 0.548)
NEC for r=0.4 all L1 = 0.405 +- 0.343 (in-sample avg dev_std = 0.548)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.288 +- 0.397 (in-sample avg dev_std = 0.571)
NEC for r=0.8 class 1.0 = 0.379 +- 0.397 (in-sample avg dev_std = 0.571)
NEC for r=0.8 all KL = 0.472 +- 0.397 (in-sample avg dev_std = 0.571)
NEC for r=0.8 all L1 = 0.333 +- 0.307 (in-sample avg dev_std = 0.571)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.424, 0.439, 0.453, 0.457, 0.506], 'all_L1': [0.495, 0.502, 0.51, 0.499, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.396, 0.398, 0.424, 0.537], 'all_L1': [0.473, 0.484, 0.48, 0.487, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.417, 0.433, 0.456, 0.543], 'all_L1': [0.494, 0.491, 0.505, 0.508, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.417, 0.426, 0.429, 0.529], 'all_L1': [0.47, 0.467, 0.473, 0.474, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.43, 0.433, 0.432, 0.526], 'all_L1': [0.468, 0.478, 0.479, 0.475, 0.554]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.429, 0.471, 0.442, 0.48], 'all_L1': [0.471, 0.466, 0.501, 0.475, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.441, 0.436, 0.45, 0.44, 0.53], 'all_L1': [0.495, 0.495, 0.508, 0.491, 0.56]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.449, 0.49, 0.475, 0.497], 'all_L1': [0.457, 0.457, 0.49, 0.479, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.408, 0.408, 0.454, 0.525], 'all_L1': [0.462, 0.464, 0.462, 0.494, 0.551]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.42, 0.42, 0.435, 0.565], 'all_L1': [0.505, 0.516, 0.507, 0.506, 0.6]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.489, 0.532, 0.525, 0.475, 0.497], 'all_L1': [0.447, 0.487, 0.475, 0.418, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.573, 0.588, 0.609, 0.613], 'all_L1': [0.501, 0.51, 0.51, 0.508, 0.493]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.543, 0.561, 0.569, 0.572], 'all_L1': [0.478, 0.488, 0.5, 0.492, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.558, 0.559, 0.557, 0.568], 'all_L1': [0.497, 0.505, 0.503, 0.497, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.542, 0.548, 0.56, 0.561], 'all_L1': [0.502, 0.495, 0.499, 0.507, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.541, 0.546, 0.551, 0.552], 'all_L1': [0.497, 0.507, 0.514, 0.518, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.54, 0.542, 0.548, 0.536], 'all_L1': [0.491, 0.487, 0.492, 0.493, 0.471]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.515, 0.532, 0.53, 0.531], 'all_L1': [0.503, 0.506, 0.522, 0.522, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.554, 0.56, 0.564, 0.59], 'all_L1': [0.5, 0.509, 0.513, 0.514, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.524, 0.536, 0.5, 0.511], 'all_L1': [0.424, 0.468, 0.462, 0.402, 0.385]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.932, 0.929, 0.926, 0.922, 0.936], 'all_L1': [0.918, 0.916, 0.916, 0.913, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.905, 0.909, 0.912, 0.913], 'all_L1': [0.9, 0.9, 0.902, 0.903, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.928, 0.928, 0.928, 0.928, 0.928], 'all_L1': [0.921, 0.921, 0.921, 0.921, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.953, 0.953, 0.953, 0.953], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.926, 0.926], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.968], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.964, 0.964, 0.964, 0.964], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.939, 0.939, 0.939, 0.939], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.934], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.898, 0.884, 0.876, 0.928], 'all_L1': [0.91, 0.906, 0.899, 0.89, 0.917]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.063, 0.063, 0.064, 0.084, 0.066], 'all_L1': [0.081, 0.081, 0.082, 0.089, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.09, 0.096, 0.11, 0.102], 'all_L1': [0.097, 0.098, 0.101, 0.106, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.079, 0.087, 0.087, 0.079], 'all_L1': [0.083, 0.084, 0.088, 0.085, 0.081]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.046, 0.047, 0.049, 0.047], 'all_L1': [0.056, 0.056, 0.056, 0.057, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.071, 0.073, 0.076, 0.074], 'all_L1': [0.09, 0.09, 0.091, 0.091, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.031, 0.031, 0.032, 0.032], 'all_L1': [0.046, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.036, 0.036, 0.036, 0.037], 'all_L1': [0.046, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.057, 0.057, 0.061, 0.061], 'all_L1': [0.085, 0.085, 0.085, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.066, 0.066, 0.066, 0.066], 'all_L1': [0.086, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.072, 0.079, 0.108, 0.082], 'all_L1': [0.083, 0.084, 0.086, 0.096, 0.087]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.692, 0.705, 0.717, 0.685, 0.875], 'all_L1': [0.727, 0.731, 0.734, 0.699, 0.862]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.557, 0.614, 0.655, 0.865], 'all_L1': [0.629, 0.654, 0.679, 0.698, 0.871]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.668, 0.671, 0.67, 0.863], 'all_L1': [0.694, 0.695, 0.697, 0.696, 0.858]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.534, 0.573, 0.592, 0.826], 'all_L1': [0.6, 0.617, 0.641, 0.647, 0.834]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.609, 0.655, 0.669, 0.872], 'all_L1': [0.615, 0.647, 0.676, 0.686, 0.859]}), defaultdict(<class 'list'>, {'all_KL': [0.679, 0.696, 0.709, 0.719, 0.893], 'all_L1': [0.715, 0.719, 0.719, 0.723, 0.874]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.699, 0.683, 0.69, 0.879], 'all_L1': [0.725, 0.722, 0.709, 0.714, 0.874]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.694, 0.678, 0.676, 0.869], 'all_L1': [0.644, 0.651, 0.635, 0.631, 0.811]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.641, 0.663, 0.674, 0.889], 'all_L1': [0.673, 0.685, 0.697, 0.704, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.726, 0.716, 0.682, 0.884], 'all_L1': [0.759, 0.763, 0.75, 0.719, 0.888]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.557, 0.572, 0.546, 0.448, 0.377], 'all_L1': [0.507, 0.517, 0.486, 0.397, 0.326]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.627, 0.63, 0.622, 0.62], 'all_L1': [0.535, 0.538, 0.528, 0.485, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.586, 0.596, 0.58, 0.543], 'all_L1': [0.516, 0.523, 0.513, 0.474, 0.419]}), defaultdict(<class 'list'>, {'all_KL': [0.608, 0.616, 0.614, 0.591, 0.599], 'all_L1': [0.528, 0.535, 0.529, 0.499, 0.484]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.587, 0.589, 0.575, 0.582], 'all_L1': [0.517, 0.521, 0.52, 0.504, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.592, 0.592, 0.572, 0.551], 'all_L1': [0.527, 0.542, 0.539, 0.509, 0.462]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.63, 0.627, 0.61, 0.578], 'all_L1': [0.553, 0.559, 0.551, 0.518, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.445, 0.474, 0.488, 0.461], 'all_L1': [0.457, 0.466, 0.486, 0.495, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.628, 0.632, 0.618, 0.588], 'all_L1': [0.532, 0.549, 0.547, 0.509, 0.452]}), defaultdict(<class 'list'>, {'all_KL': [0.598, 0.611, 0.597, 0.537, 0.472], 'all_L1': [0.517, 0.522, 0.483, 0.405, 0.333]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.479 +- 0.016, 0.482 +- 0.018, 0.491 +- 0.016, 0.489 +- 0.012, 0.551 +- 0.031
suff_simple class all_KL  =  0.418 +- 0.019, 0.424 +- 0.015, 0.438 +- 0.027, 0.444 +- 0.015, 0.524 +- 0.023
suff_simple_acc_int  =  0.482 +- 0.029, 0.482 +- 0.028, 0.488 +- 0.021, 0.475 +- 0.019, 0.540 +- 0.033
nec class all_L1  =  0.484 +- 0.026, 0.496 +- 0.013, 0.499 +- 0.018, 0.487 +- 0.040, 0.480 +- 0.042
nec class all_KL  =  0.528 +- 0.028, 0.542 +- 0.016, 0.550 +- 0.017, 0.546 +- 0.035, 0.553 +- 0.034
nec_acc_int  =  0.475 +- 0.032, 0.459 +- 0.011, 0.471 +- 0.025, 0.510 +- 0.060, 0.552 +- 0.067

Eval split val
suff_simple class all_L1  =  0.924 +- 0.018, 0.923 +- 0.019, 0.923 +- 0.019, 0.922 +- 0.021, 0.925 +- 0.018
suff_simple class all_KL  =  0.935 +- 0.020, 0.934 +- 0.022, 0.933 +- 0.024, 0.932 +- 0.025, 0.939 +- 0.017
suff_simple_acc_int  =  0.497 +- 0.001, 0.497 +- 0.001, 0.496 +- 0.001, 0.495 +- 0.002, 0.496 +- 0.000
nec class all_L1  =  0.075 +- 0.018, 0.076 +- 0.018, 0.077 +- 0.019, 0.079 +- 0.020, 0.076 +- 0.019
nec class all_KL  =  0.061 +- 0.017, 0.061 +- 0.018, 0.064 +- 0.020, 0.071 +- 0.026, 0.065 +- 0.020
nec_acc_int  =  0.496 +- 0.001, 0.497 +- 0.002, 0.498 +- 0.003, 0.499 +- 0.005, 0.499 +- 0.003

Eval split test
suff_simple class all_L1  =  0.678 +- 0.051, 0.688 +- 0.043, 0.694 +- 0.035, 0.692 +- 0.029, 0.862 +- 0.022
suff_simple class all_KL  =  0.630 +- 0.077, 0.653 +- 0.063, 0.668 +- 0.043, 0.671 +- 0.031, 0.871 +- 0.018
suff_simple_acc_int  =  0.631 +- 0.023, 0.633 +- 0.024, 0.633 +- 0.021, 0.632 +- 0.020, 0.712 +- 0.027
nec class all_L1  =  0.519 +- 0.024, 0.527 +- 0.024, 0.518 +- 0.024, 0.480 +- 0.041, 0.433 +- 0.055
nec class all_KL  =  0.578 +- 0.053, 0.589 +- 0.052, 0.590 +- 0.046, 0.564 +- 0.054, 0.537 +- 0.073
nec_acc_int  =  0.529 +- 0.011, 0.523 +- 0.011, 0.533 +- 0.016, 0.567 +- 0.029, 0.609 +- 0.038


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.481 +- 0.008, 0.489 +- 0.004, 0.495 +- 0.008, 0.488 +- 0.017, 0.516 +- 0.017
Faith. Armon (L1)= 		  =  0.481 +- 0.009, 0.489 +- 0.005, 0.495 +- 0.008, 0.487 +- 0.018, 0.511 +- 0.022
Faith. GMean (L1)= 	  =  0.481 +- 0.008, 0.489 +- 0.004, 0.495 +- 0.008, 0.487 +- 0.018, 0.514 +- 0.019
Faith. Aritm (KL)= 		  =  0.473 +- 0.016, 0.483 +- 0.004, 0.494 +- 0.010, 0.495 +- 0.016, 0.538 +- 0.022
Faith. Armon (KL)= 		  =  0.466 +- 0.016, 0.475 +- 0.006, 0.487 +- 0.013, 0.489 +- 0.014, 0.537 +- 0.021
Faith. GMean (KL)= 	  =  0.470 +- 0.016, 0.479 +- 0.005, 0.490 +- 0.011, 0.492 +- 0.015, 0.538 +- 0.021

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.001, 0.499 +- 0.002, 0.500 +- 0.003, 0.500 +- 0.003, 0.501 +- 0.001
Faith. Armon (L1)= 		  =  0.139 +- 0.031, 0.139 +- 0.031, 0.141 +- 0.032, 0.144 +- 0.034, 0.140 +- 0.032
Faith. GMean (L1)= 	  =  0.261 +- 0.031, 0.262 +- 0.031, 0.263 +- 0.032, 0.267 +- 0.034, 0.263 +- 0.032
Faith. Aritm (KL)= 		  =  0.498 +- 0.003, 0.498 +- 0.005, 0.498 +- 0.006, 0.502 +- 0.005, 0.502 +- 0.003
Faith. Armon (KL)= 		  =  0.114 +- 0.031, 0.114 +- 0.031, 0.118 +- 0.035, 0.130 +- 0.044, 0.120 +- 0.036
Faith. GMean (KL)= 	  =  0.236 +- 0.033, 0.236 +- 0.034, 0.240 +- 0.038, 0.252 +- 0.046, 0.243 +- 0.038

Eval split test
Faith. Aritm (L1)= 		  =  0.599 +- 0.030, 0.608 +- 0.027, 0.606 +- 0.020, 0.586 +- 0.022, 0.647 +- 0.026
Faith. Armon (L1)= 		  =  0.587 +- 0.027, 0.596 +- 0.025, 0.592 +- 0.019, 0.565 +- 0.030, 0.574 +- 0.050
Faith. GMean (L1)= 	  =  0.593 +- 0.028, 0.602 +- 0.026, 0.599 +- 0.019, 0.575 +- 0.026, 0.609 +- 0.039
Faith. Aritm (KL)= 		  =  0.604 +- 0.038, 0.621 +- 0.034, 0.629 +- 0.025, 0.618 +- 0.028, 0.704 +- 0.035
Faith. Armon (KL)= 		  =  0.598 +- 0.042, 0.616 +- 0.037, 0.624 +- 0.028, 0.611 +- 0.034, 0.661 +- 0.058
Faith. GMean (KL)= 	  =  0.601 +- 0.040, 0.618 +- 0.035, 0.626 +- 0.027, 0.614 +- 0.031, 0.682 +- 0.047
Computed for split load_split = id



Completed in  2:39:23.669630  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.1
scripts/faithfulness.sh: line 78: syntax error near unexpected token `)'
