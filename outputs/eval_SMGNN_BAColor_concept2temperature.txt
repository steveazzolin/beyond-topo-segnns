
[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0003 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0004 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0003 	
Val ACCURACY: 1.0000 	Val Loss: 0.0004 	
Test ACCURACY: 1.0000 	Test Loss: 0.0003 	

Weight vector of global side channel:
W: [[-0.5153764   0.51601976]] b:[-0.5790223]

Coeff rule on x1: x1 >= [-1.123494]

Concept relevance scores for this run:
 [[5.839839e-04 9.994160e-01]] 



#D#Running with seed = 2
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0000 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0000 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0000 	
Val ACCURACY: 1.0000 	Val Loss: 0.0000 	
Test ACCURACY: 1.0000 	Test Loss: 0.0000 	

Weight vector of global side channel:
W: [[-0.41202936  0.4118573 ]] b:[-0.33252698]

Coeff rule on x1: x1 >= [-0.80704683]

Concept relevance scores for this run:
 [[0.26006633 0.73993367]] 



#D#Running with seed = 3
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0002 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0001 	
Val ACCURACY: 1.0000 	Val Loss: 0.0011 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[ 0.35703847 -0.35558924]] b:[-0.18342285]

Coeff rule on x1: x1 >= [0.51373416]

Concept relevance scores for this run:
 [[0.00437645 0.9956236 ]] 



#D#Running with seed = 4
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0000 	
Val ACCURACY: 1.0000 	Val Loss: 0.0001 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[ 0.4737075 -0.4721932]] b:[-0.17666696]

Coeff rule on x1: x1 >= [0.37294525]

Concept relevance scores for this run:
 [[2.3809042e-04 9.9976188e-01]] 



#D#Running with seed = 5
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0001 	
Val ACCURACY: 1.0000 	Val Loss: 0.0001 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[-0.49258503  0.493076  ]] b:[-0.5194575]

Coeff rule on x1: x1 >= [-1.054554]

Concept relevance scores for this run:
 [[1.0558806e-05 9.9998945e-01]] 



#D#Running with seed = 6
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
595 6
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 6,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 6,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0001 	
Val ACCURACY: 1.0000 	Val Loss: 0.0001 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[-0.48388448  0.48438784]] b:[-0.5540048]

Coeff rule on x1: x1 >= [-1.1449113]

Concept relevance scores for this run:
 [[3.9677214e-04 9.9960321e-01]] 



#D#Running with seed = 7
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
692 7
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 7,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 7,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0000 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0000 	
Val ACCURACY: 1.0000 	Val Loss: 0.0001 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[-0.42044505  0.42131633]] b:[-0.5263411]

Coeff rule on x1: x1 >= [-1.2518665]

Concept relevance scores for this run:
 [[3.96533e-06 9.99996e-01]] 



#D#Running with seed = 8
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
789 8
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 8,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 8,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0001 	
Val ACCURACY: 1.0000 	Val Loss: 0.0002 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[ 0.4183703 -0.4172455]] b:[-0.07311822]

Coeff rule on x1: x1 >= [0.17476915]

Concept relevance scores for this run:
 [[0.28105426 0.71894574]] 



#D#Running with seed = 9
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
886 9
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 9,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 9,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0108
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0148
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0080
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0148
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0080

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0108
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0148
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0080
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0148
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0080

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0108 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0148 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0080 	
Val ACCURACY: 0.9848 	Val Loss: 0.0199 	
Test ACCURACY: 1.0000 	Test Loss: 0.0118 	

Weight vector of global side channel:
W: [[-0.20599844  0.20454146]] b:[-0.26258224]

Coeff rule on x1: x1 >= [-1.2746807]

Concept relevance scores for this run:
 [[0.00241446 0.9975855 ]] 



#D#Running with seed = 10
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
983 10
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 10,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 10,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Oct 20 19:10:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/20/2024 07:10:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/BAColor_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.001/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0000 	
Val ACCURACY: 1.0000 	Val Loss: 0.0002 	
Test ACCURACY: 1.0000 	Test Loss: 0.0001 	

Weight vector of global side channel:
W: [[ 0.5258195  -0.52380806]] b:[-0.17556459]

Coeff rule on x1: x1 >= [0.33388758]

Concept relevance scores for this run:
 [[0.00200631 0.9979937 ]] 



Final accuracies: 
TRAIN      = 1.000 +- 0.000
ID_VAL     = 1.000 +- 0.000
ID_TEST    = 1.000 +- 0.000
VAL        = 0.998 +- 0.005
TEST       = 1.000 +- 0.000


Final accuracies (model with id_val acc above 0.0% - 10 runs): 
TRAIN      = 1.000 +- 0.000
ID_VAL     = 1.000 +- 0.000
ID_TEST    = 1.000 +- 0.000
VAL        = 0.998 +- 0.005
TEST       = 1.000 +- 0.000


Averaged channel relevance scores (model with id_val acc above 0.0% - 10 runs): 
[0.05511511 0.9448849 ] +- [0.10783265 0.10783264]


Final Test WIoUs (model with id_val acc above 0.0% - 10 runs):
TRAIN      = nan +- nan
ID_VAL     = nan +- nan
ID_TEST    = nan +- nan
VAL        = nan +- nan
TEST       = nan +- nan


Global side channel coefficient wrt x1 (model with id_val acc above 0.0% - 10 runs):
[-0.52612174] +- [0.72838485]


Average global channel weights (model with id_val acc above 0.0% - 10 runs):
[-0.07553829  0.07623626] +- [0.43332544 0.43275422]


Final losses: 
TRAIN      = 0.0012 +- 0.0032
ID_VAL     = 0.0016 +- 0.0044
ID_TEST    = 0.0009 +- 0.0024
VAL        = 0.0022 +- 0.0059
TEST       = 0.0013 +- 0.0035
Diff id_val-test  = 0.0003 
