I'm the stability of the DET :))
The PID of this script is: 4158587 running on GPU-1
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:51:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:51:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.279506
Plausibility completed in  0:00:26.168210
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6348, device='cuda:1')  +-  tensor(0.2832, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6675, device='cuda:1')  +-  tensor(0.1676, device='cuda:1') (0.097)
Original Stability MCC for r=0.3 = 0.987 +- 0.051
Intervened Stability MCC for r=0.3 = 0.538 +- 0.393
Original Stability F1 for r=0.3 = 0.991 +- 0.035
Intervened Stability F1 for r=0.3 = 0.717 +- 0.230
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.037676
Plausibility completed in  0:00:26.071444
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6242, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8957, device='cuda:1')  +-  tensor(0.1120, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.985 +- 0.066
Intervened Stability MCC for r=0.6 = 0.460 +- 0.411
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.844 +- 0.116
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:52:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:52:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.179603
Plausibility completed in  0:00:26.234939
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6578, device='cuda:1')  +-  tensor(0.3066, device='cuda:1') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6780, device='cuda:1')  +-  tensor(0.1708, device='cuda:1') (0.091)
Original Stability MCC for r=0.3 = 0.989 +- 0.047
Intervened Stability MCC for r=0.3 = 0.489 +- 0.421
Original Stability F1 for r=0.3 = 0.992 +- 0.032
Intervened Stability F1 for r=0.3 = 0.682 +- 0.256
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.984911
Plausibility completed in  0:00:26.252187
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6367, device='cuda:1')  +-  tensor(0.3022, device='cuda:1') (0.072)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8992, device='cuda:1')  +-  tensor(0.1200, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.990 +- 0.042
Intervened Stability MCC for r=0.6 = 0.605 +- 0.430
Original Stability F1 for r=0.6 = 0.996 +- 0.016
Intervened Stability F1 for r=0.6 = 0.875 +- 0.136
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:54:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:54:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.233337
Plausibility completed in  0:00:26.197012
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6046, device='cuda:1')  +-  tensor(0.2817, device='cuda:1') (0.085)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6291, device='cuda:1')  +-  tensor(0.1589, device='cuda:1') (0.090)
Original Stability MCC for r=0.3 = 0.993 +- 0.035
Intervened Stability MCC for r=0.3 = 0.407 +- 0.422
Original Stability F1 for r=0.3 = 0.995 +- 0.024
Intervened Stability F1 for r=0.3 = 0.643 +- 0.238
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.235921
Plausibility completed in  0:00:25.960600
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5856, device='cuda:1')  +-  tensor(0.2860, device='cuda:1') (0.079)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8481, device='cuda:1')  +-  tensor(0.1240, device='cuda:1') (0.057)
Original Stability MCC for r=0.6 = 0.988 +- 0.053
Intervened Stability MCC for r=0.6 = 0.226 +- 0.380
Original Stability F1 for r=0.6 = 0.996 +- 0.019
Intervened Stability F1 for r=0.6 = 0.790 +- 0.112
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:55:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:55:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.187585
Plausibility completed in  0:00:26.323234
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6637, device='cuda:1')  +-  tensor(0.2592, device='cuda:1') (0.141)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6770, device='cuda:1')  +-  tensor(0.1665, device='cuda:1') (0.143)
Original Stability MCC for r=0.3 = 0.981 +- 0.073
Intervened Stability MCC for r=0.3 = 0.486 +- 0.376
Original Stability F1 for r=0.3 = 0.987 +- 0.049
Intervened Stability F1 for r=0.3 = 0.679 +- 0.226
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.979946
Plausibility completed in  0:00:25.619130
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6800, device='cuda:1')  +-  tensor(0.2935, device='cuda:1') (0.098)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8763, device='cuda:1')  +-  tensor(0.1657, device='cuda:1') (0.065)
Original Stability MCC for r=0.6 = 0.986 +- 0.057
Intervened Stability MCC for r=0.6 = 0.308 +- 0.436
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.808 +- 0.122
Num considered samples: 2966
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:56:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:45 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:56:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.172775
Plausibility completed in  0:00:26.552395
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6455, device='cuda:1')  +-  tensor(0.2686, device='cuda:1') (0.110)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6805, device='cuda:1')  +-  tensor(0.1436, device='cuda:1') (0.118)
Original Stability MCC for r=0.3 = 0.986 +- 0.058
Intervened Stability MCC for r=0.3 = 0.542 +- 0.360
Original Stability F1 for r=0.3 = 0.991 +- 0.040
Intervened Stability F1 for r=0.3 = 0.716 +- 0.211
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.146703
Plausibility completed in  0:00:26.684331
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6348, device='cuda:1')  +-  tensor(0.2802, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8704, device='cuda:1')  +-  tensor(0.1097, device='cuda:1') (0.068)
Original Stability MCC for r=0.6 = 0.986 +- 0.060
Intervened Stability MCC for r=0.6 = 0.361 +- 0.404
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.815 +- 0.117
Num considered samples: 3000

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76367326 0.76345528] +- [0.07432533 0.07391123] (mean across ratios: 0.76 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.64129108 0.63226736] +- [0.0208843 0.0301613] (mean across ratios: 0.64 +- 0.02)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81151148 0.98362483] +- [0.05535978 0.00662554] (mean across ratios: 0.90 +- 0.03)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.6664188  0.87795304] +- [0.01914947 0.01850471] (mean across ratios: 0.77 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9913427 0.9952078] +- [0.00248355 0.00062013] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.68745906 0.82668461] +- [0.02737332 0.02987356] (mean across ratios: 0.76 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98730783 0.98697734] +- [0.00367879 0.00186159] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.4923634  0.39186369] +- [0.0487306  0.13063326] (mean across ratios: 0.44 +- 0.07)

Overall time of execution:  0:06:46.750429
DONE LECI GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:58:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:58:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.224775
Plausibility completed in  0:00:26.422958
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6328, device='cuda:1')  +-  tensor(0.3090, device='cuda:1') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6567, device='cuda:1')  +-  tensor(0.1792, device='cuda:1') (0.078)
Original Stability MCC for r=0.3 = 0.986 +- 0.057
Intervened Stability MCC for r=0.3 = 0.435 +- 0.442
Original Stability F1 for r=0.3 = 0.991 +- 0.038
Intervened Stability F1 for r=0.3 = 0.679 +- 0.239
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.002475
Plausibility completed in  0:00:26.329581
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5803, device='cuda:1')  +-  tensor(0.3188, device='cuda:1') (0.044)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8999, device='cuda:1')  +-  tensor(0.1110, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.984 +- 0.066
Intervened Stability MCC for r=0.6 = 0.319 +- 0.407
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.889 +- 0.118
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 12:59:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 12:59:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.049874
Plausibility completed in  0:00:26.124333
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6174, device='cuda:1')  +-  tensor(0.3184, device='cuda:1') (0.068)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6292, device='cuda:1')  +-  tensor(0.1666, device='cuda:1') (0.082)
Original Stability MCC for r=0.3 = 0.988 +- 0.046
Intervened Stability MCC for r=0.3 = 0.368 +- 0.462
Original Stability F1 for r=0.3 = 0.992 +- 0.031
Intervened Stability F1 for r=0.3 = 0.633 +- 0.264
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.874412
Plausibility completed in  0:00:26.160584
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5903, device='cuda:1')  +-  tensor(0.3208, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8992, device='cuda:1')  +-  tensor(0.1125, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.991 +- 0.040
Intervened Stability MCC for r=0.6 = 0.373 +- 0.449
Original Stability F1 for r=0.6 = 0.997 +- 0.015
Intervened Stability F1 for r=0.6 = 0.888 +- 0.123
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:01:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:01:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.066286
Plausibility completed in  0:00:26.064249
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6142, device='cuda:1')  +-  tensor(0.3118, device='cuda:1') (0.066)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6118, device='cuda:1')  +-  tensor(0.1851, device='cuda:1') (0.070)
Original Stability MCC for r=0.3 = 0.992 +- 0.036
Intervened Stability MCC for r=0.3 = 0.303 +- 0.446
Original Stability F1 for r=0.3 = 0.995 +- 0.024
Intervened Stability F1 for r=0.3 = 0.601 +- 0.249
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.070580
Plausibility completed in  0:00:25.817457
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6089, device='cuda:1')  +-  tensor(0.3215, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8712, device='cuda:1')  +-  tensor(0.1231, device='cuda:1') (0.039)
Original Stability MCC for r=0.6 = 0.986 +- 0.059
Intervened Stability MCC for r=0.6 = 0.109 +- 0.291
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.845 +- 0.115
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:02:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:02:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:02:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.056468
Plausibility completed in  0:00:26.239523
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6122, device='cuda:1')  +-  tensor(0.3052, device='cuda:1') (0.113)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.1707, device='cuda:1') (0.114)
Original Stability MCC for r=0.3 = 0.978 +- 0.080
Intervened Stability MCC for r=0.3 = 0.390 +- 0.424
Original Stability F1 for r=0.3 = 0.985 +- 0.054
Intervened Stability F1 for r=0.3 = 0.642 +- 0.243
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.826160
Plausibility completed in  0:00:25.589017
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6307, device='cuda:1')  +-  tensor(0.3233, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8694, device='cuda:1')  +-  tensor(0.1729, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.988 +- 0.050
Intervened Stability MCC for r=0.6 = 0.078 +- 0.317
Original Stability F1 for r=0.6 = 0.995 +- 0.018
Intervened Stability F1 for r=0.6 = 0.847 +- 0.126
Num considered samples: 2966
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:03:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:03:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.042022
Plausibility completed in  0:00:26.143946
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6170, device='cuda:1')  +-  tensor(0.2891, device='cuda:1') (0.100)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6334, device='cuda:1')  +-  tensor(0.1521, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.986 +- 0.064
Intervened Stability MCC for r=0.3 = 0.414 +- 0.434
Original Stability F1 for r=0.3 = 0.990 +- 0.044
Intervened Stability F1 for r=0.3 = 0.670 +- 0.220
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.876251
Plausibility completed in  0:00:26.109765
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6091, device='cuda:1')  +-  tensor(0.3040, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8760, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.047)
Original Stability MCC for r=0.6 = 0.985 +- 0.063
Intervened Stability MCC for r=0.6 = 0.123 +- 0.300
Original Stability F1 for r=0.6 = 0.995 +- 0.023
Intervened Stability F1 for r=0.6 = 0.847 +- 0.115
Num considered samples: 3000

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76367326 0.76345528] +- [0.07432533 0.07391123] (mean across ratios: 0.76 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.61870856 0.60387461] +- [0.00729872 0.01739561] (mean across ratios: 0.61 +- 0.01)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81151148 0.98362483] +- [0.05535978 0.00662554] (mean across ratios: 0.90 +- 0.03)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62982818 0.88313484] +- [0.01546273 0.01358007] (mean across ratios: 0.76 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9905368  0.99519711] +- [0.00314366 0.00080587] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.64505442 0.86301003] +- [0.02772926 0.02078309] (mean across ratios: 0.75 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98612506 0.98692455] +- [0.00465677 0.00235561] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.38207405 0.20065048] +- [0.04547416 0.12100501] (mean across ratios: 0.29 +- 0.06)

Overall time of execution:  0:06:44.841938
DONE LECI GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:05:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:05:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.975881
Plausibility completed in  0:00:25.930048
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3766, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3861, device='cuda:1')  +-  tensor(0.0662, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.034
Intervened Stability MCC for r=0.3 = 0.030 +- 0.233
Original Stability F1 for r=0.3 = 0.998 +- 0.022
Intervened Stability F1 for r=0.3 = 0.360 +- 0.156
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.763274
Plausibility completed in  0:00:25.697389
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3760, device='cuda:1')  +-  tensor(0.2173, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7148, device='cuda:1')  +-  tensor(0.0709, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.028
Intervened Stability MCC for r=0.6 = 0.135 +- 0.328
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.733 +- 0.117
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:06:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:06:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:06:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.896684
Plausibility completed in  0:00:26.014340
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3726, device='cuda:1')  +-  tensor(0.2156, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3786, device='cuda:1')  +-  tensor(0.0591, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.033
Intervened Stability MCC for r=0.3 = 0.026 +- 0.246
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.354 +- 0.161
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.742525
Plausibility completed in  0:00:25.799480
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3715, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7139, device='cuda:1')  +-  tensor(0.0699, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = 0.128 +- 0.306
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.735 +- 0.105
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:08:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:08:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.748898
Plausibility completed in  0:00:26.077386
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.2159, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3796, device='cuda:1')  +-  tensor(0.0615, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.032
Intervened Stability MCC for r=0.3 = 0.031 +- 0.251
Original Stability F1 for r=0.3 = 0.997 +- 0.022
Intervened Stability F1 for r=0.3 = 0.355 +- 0.165
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.956486
Plausibility completed in  0:00:25.812616
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.2149, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7111, device='cuda:1')  +-  tensor(0.0693, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.025
Intervened Stability MCC for r=0.6 = 0.124 +- 0.324
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.728 +- 0.118
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:09:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:09:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.899250
Plausibility completed in  0:00:26.079025
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3703, device='cuda:1')  +-  tensor(0.2141, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3782, device='cuda:1')  +-  tensor(0.0590, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.038
Intervened Stability MCC for r=0.3 = 0.025 +- 0.230
Original Stability F1 for r=0.3 = 0.997 +- 0.025
Intervened Stability F1 for r=0.3 = 0.354 +- 0.156
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.753405
Plausibility completed in  0:00:25.805278
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3702, device='cuda:1')  +-  tensor(0.2141, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7155, device='cuda:1')  +-  tensor(0.0718, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.026
Intervened Stability MCC for r=0.6 = 0.080 +- 0.302
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.725 +- 0.113
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:10:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:10:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.776066
Plausibility completed in  0:00:26.154461
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3736, device='cuda:1')  +-  tensor(0.2167, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3780, device='cuda:1')  +-  tensor(0.0586, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.993 +- 0.056
Intervened Stability MCC for r=0.3 = 0.033 +- 0.251
Original Stability F1 for r=0.3 = 0.995 +- 0.036
Intervened Stability F1 for r=0.3 = 0.357 +- 0.163
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.000204
Plausibility completed in  0:00:25.976228
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3724, device='cuda:1')  +-  tensor(0.2151, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7117, device='cuda:1')  +-  tensor(0.0671, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.166 +- 0.320
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.740 +- 0.114
Num considered samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386574 0.32386574] +- [0.00206968 0.00206968] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.37272234 0.37194271] +- [0.00234611 0.00225198] (mean across ratios: 0.37 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38008853 0.71339667] +- [0.00304574 0.00172896] (mean across ratios: 0.55 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99701786 0.99877404] +- [0.00083908 0.00024787] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.35588848 0.73204262] +- [0.00212708 0.00518063] (mean across ratios: 0.54 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99552962 0.99671434] +- [0.00127731 0.00067287] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.02893165 0.12647073] +- [0.0029946  0.02750807] (mean across ratios: 0.08 +- 0.01)

Overall time of execution:  0:06:43.438752
DONE GSAT GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:12:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:12:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.064762
Plausibility completed in  0:00:26.344835
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4338, device='cuda:1')  +-  tensor(0.2689, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4410, device='cuda:1')  +-  tensor(0.1005, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.995 +- 0.041
Intervened Stability MCC for r=0.3 = 0.094 +- 0.264
Original Stability F1 for r=0.3 = 0.997 +- 0.026
Intervened Stability F1 for r=0.3 = 0.465 +- 0.190
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.843311
Plausibility completed in  0:00:26.377286
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4248, device='cuda:1')  +-  tensor(0.2570, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8029, device='cuda:1')  +-  tensor(0.1152, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.030
Intervened Stability MCC for r=0.6 = -0.009 +- 0.179
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:13:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:13:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.839992
Plausibility completed in  0:00:26.405363
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4300, device='cuda:1')  +-  tensor(0.2666, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4315, device='cuda:1')  +-  tensor(0.0893, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.032
Intervened Stability MCC for r=0.3 = 0.075 +- 0.236
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.456 +- 0.168
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.805205
Plausibility completed in  0:00:26.428864
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4128, device='cuda:1')  +-  tensor(0.2452, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7897, device='cuda:1')  +-  tensor(0.1006, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.032
Intervened Stability MCC for r=0.6 = 0.018 +- 0.224
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.789 +- 0.119
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:15:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:15:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.994655
Plausibility completed in  0:00:26.479820
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4276, device='cuda:1')  +-  tensor(0.2664, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4326, device='cuda:1')  +-  tensor(0.0921, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.032
Intervened Stability MCC for r=0.3 = 0.049 +- 0.248
Original Stability F1 for r=0.3 = 0.997 +- 0.022
Intervened Stability F1 for r=0.3 = 0.442 +- 0.169
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.807492
Plausibility completed in  0:00:26.462484
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4173, device='cuda:1')  +-  tensor(0.2545, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7949, device='cuda:1')  +-  tensor(0.1056, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.003 +- 0.203
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.794 +- 0.132
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:16:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:16:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.974334
Plausibility completed in  0:00:26.400765
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4263, device='cuda:1')  +-  tensor(0.2646, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.0892, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.026
Intervened Stability MCC for r=0.3 = 0.048 +- 0.230
Original Stability F1 for r=0.3 = 0.998 +- 0.017
Intervened Stability F1 for r=0.3 = 0.446 +- 0.157
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.798499
Plausibility completed in  0:00:26.437137
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4168, device='cuda:1')  +-  tensor(0.2526, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8018, device='cuda:1')  +-  tensor(0.1149, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.025
Intervened Stability MCC for r=0.6 = -0.006 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.794 +- 0.137
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:17:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 01:17:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.984174
Plausibility completed in  0:00:26.391703
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4305, device='cuda:1')  +-  tensor(0.2668, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4312, device='cuda:1')  +-  tensor(0.0891, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.050
Intervened Stability MCC for r=0.3 = 0.084 +- 0.244
Original Stability F1 for r=0.3 = 0.996 +- 0.033
Intervened Stability F1 for r=0.3 = 0.460 +- 0.170
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.806394
Plausibility completed in  0:00:26.175989
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4230, device='cuda:1')  +-  tensor(0.2565, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8018, device='cuda:1')  +-  tensor(0.1135, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.012 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Num considered samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.323866   0.32386587] +- [0.0020694  0.00206954] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42963926 0.41895556] +- [0.00258234 0.00436726] (mean across ratios: 0.42 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.433468   0.79824038] +- [0.00382765 0.00513948] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99724357 0.99879121] +- [0.00073615 0.00035956] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.45390203 0.79509509] +- [0.00846058 0.0037528 ] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99588292 0.99676454] +- [0.00112746 0.00098688] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.07024082 0.00353941] +- [0.01843348 0.01018605] (mean across ratios: 0.04 +- 0.01)

Overall time of execution:  0:06:47.337996
DONE GSAT GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:19:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:19:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.020643
Plausibility completed in  0:00:25.475922
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5069, device='cuda:1')  +-  tensor(0.2764, device='cuda:1') (0.087)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5344, device='cuda:1')  +-  tensor(0.1100, device='cuda:1') (0.100)
Original Stability MCC for r=0.3 = 0.895 +- 0.195
Intervened Stability MCC for r=0.3 = 0.377 +- 0.413
Original Stability F1 for r=0.3 = 0.932 +- 0.122
Intervened Stability F1 for r=0.3 = 0.617 +- 0.246
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.706239
Plausibility completed in  0:00:24.941922
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4743, device='cuda:1')  +-  tensor(0.2583, device='cuda:1') (0.067)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8636, device='cuda:1')  +-  tensor(0.1611, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 0.967 +- 0.079
Intervened Stability MCC for r=0.6 = 0.531 +- 0.386
Original Stability F1 for r=0.6 = 0.988 +- 0.029
Intervened Stability F1 for r=0.6 = 0.863 +- 0.110
Num considered samples: 2944
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:20:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:20:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.795897
Plausibility completed in  0:00:25.603215
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5075, device='cuda:1')  +-  tensor(0.2764, device='cuda:1') (0.059)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6541, device='cuda:1')  +-  tensor(0.1350, device='cuda:1') (0.073)
Original Stability MCC for r=0.3 = 0.976 +- 0.073
Intervened Stability MCC for r=0.3 = 0.625 +- 0.317
Original Stability F1 for r=0.3 = 0.983 +- 0.049
Intervened Stability F1 for r=0.3 = 0.768 +- 0.181
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.973469
Plausibility completed in  0:00:25.342349
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5008, device='cuda:1')  +-  tensor(0.2700, device='cuda:1') (0.034)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9333, device='cuda:1')  +-  tensor(0.0867, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.972 +- 0.101
Intervened Stability MCC for r=0.6 = 0.583 +- 0.372
Original Stability F1 for r=0.6 = 0.990 +- 0.035
Intervened Stability F1 for r=0.6 = 0.890 +- 0.098
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:22:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:22:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.956763
Plausibility completed in  0:00:25.680463
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5956, device='cuda:1')  +-  tensor(0.2757, device='cuda:1') (0.115)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6924, device='cuda:1')  +-  tensor(0.1373, device='cuda:1') (0.122)
Original Stability MCC for r=0.3 = 0.944 +- 0.155
Intervened Stability MCC for r=0.3 = 0.525 +- 0.393
Original Stability F1 for r=0.3 = 0.963 +- 0.099
Intervened Stability F1 for r=0.3 = 0.712 +- 0.222
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.788532
Plausibility completed in  0:00:25.672499
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5693, device='cuda:1')  +-  tensor(0.2724, device='cuda:1') (0.090)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9091, device='cuda:1')  +-  tensor(0.0992, device='cuda:1') (0.052)
Original Stability MCC for r=0.6 = 0.986 +- 0.053
Intervened Stability MCC for r=0.6 = 0.545 +- 0.361
Original Stability F1 for r=0.6 = 0.995 +- 0.019
Intervened Stability F1 for r=0.6 = 0.871 +- 0.100
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:23:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:23:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.816620
Plausibility completed in  0:00:25.672700
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2951, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.1293, device='cuda:1') (0.069)
Original Stability MCC for r=0.3 = 0.966 +- 0.096
Intervened Stability MCC for r=0.3 = 0.537 +- 0.375
Original Stability F1 for r=0.3 = 0.978 +- 0.062
Intervened Stability F1 for r=0.3 = 0.715 +- 0.215
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.041665
Plausibility completed in  0:00:25.378832
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4973, device='cuda:1')  +-  tensor(0.2863, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9096, device='cuda:1')  +-  tensor(0.0923, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.973 +- 0.083
Intervened Stability MCC for r=0.6 = 0.593 +- 0.368
Original Stability F1 for r=0.6 = 0.990 +- 0.030
Intervened Stability F1 for r=0.6 = 0.885 +- 0.100
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:24:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:24:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.476


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.958577
Plausibility completed in  0:00:25.481589
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3314, device='cuda:1')  +-  tensor(0.1665, device='cuda:1') (0.093)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5528, device='cuda:1')  +-  tensor(0.1390, device='cuda:1') (0.093)
Original Stability MCC for r=0.3 = 0.940 +- 0.140
Intervened Stability MCC for r=0.3 = 0.449 +- 0.385
Original Stability F1 for r=0.3 = 0.960 +- 0.094
Intervened Stability F1 for r=0.3 = 0.658 +- 0.224
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.893917
Plausibility completed in  0:00:25.149764
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3115, device='cuda:1')  +-  tensor(0.1807, device='cuda:1') (0.068)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8661, device='cuda:1')  +-  tensor(0.1596, device='cuda:1') (0.049)
Original Stability MCC for r=0.6 = 0.980 +- 0.060
Intervened Stability MCC for r=0.6 = 0.511 +- 0.428
Original Stability F1 for r=0.6 = 0.993 +- 0.022
Intervened Stability F1 for r=0.6 = 0.861 +- 0.114
Num considered samples: 2944

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56387447 0.56376567] +- [0.09189798 0.09200944] (mean across ratios: 0.56 +- 0.07)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.48990941 0.47064189] +- [0.08627723 0.08567982] (mean across ratios: 0.48 +- 0.06)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.67785172 0.96908492] +- [0.09343448 0.01478107] (mean across ratios: 0.82 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60163935 0.89634204] +- [0.06105913 0.02719069] (mean across ratios: 0.75 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96310983 0.99104607] +- [0.01797389 0.0024707 ] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69390479 0.87399392] +- [0.05188363 0.01159223] (mean across ratios: 0.78 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.94412767 0.97560967] +- [0.02795863 0.00681575] (mean across ratios: 0.96 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.5025342  0.55260134] +- [0.08390491 0.03098617] (mean across ratios: 0.53 +- 0.04)

Overall time of execution:  0:06:35.990179
DONE CIGA GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:26:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:26:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.211953
Plausibility completed in  0:00:26.138708
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5323, device='cuda:1')  +-  tensor(0.3260, device='cuda:1') (0.067)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5188, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.075)
Original Stability MCC for r=0.3 = 0.894 +- 0.195
Intervened Stability MCC for r=0.3 = 0.180 +- 0.445
Original Stability F1 for r=0.3 = 0.931 +- 0.122
Intervened Stability F1 for r=0.3 = 0.535 +- 0.252
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.875626
Plausibility completed in  0:00:25.496196
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4915, device='cuda:1')  +-  tensor(0.2976, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8690, device='cuda:1')  +-  tensor(0.1582, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.966 +- 0.082
Intervened Stability MCC for r=0.6 = 0.225 +- 0.353
Original Stability F1 for r=0.6 = 0.987 +- 0.030
Intervened Stability F1 for r=0.6 = 0.862 +- 0.100
Num considered samples: 2944
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:27:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:27:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.148250
Plausibility completed in  0:00:26.193996
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5294, device='cuda:1')  +-  tensor(0.3031, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6388, device='cuda:1')  +-  tensor(0.1621, device='cuda:1') (0.064)
Original Stability MCC for r=0.3 = 0.975 +- 0.074
Intervened Stability MCC for r=0.3 = 0.453 +- 0.405
Original Stability F1 for r=0.3 = 0.983 +- 0.050
Intervened Stability F1 for r=0.3 = 0.695 +- 0.196
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.944803
Plausibility completed in  0:00:26.164566
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4981, device='cuda:1')  +-  tensor(0.2785, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9136, device='cuda:1')  +-  tensor(0.1034, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.973 +- 0.096
Intervened Stability MCC for r=0.6 = 0.322 +- 0.436
Original Stability F1 for r=0.6 = 0.991 +- 0.033
Intervened Stability F1 for r=0.6 = 0.889 +- 0.108
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:29:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:29:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.127235
Plausibility completed in  0:00:26.118027
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5838, device='cuda:1')  +-  tensor(0.3178, device='cuda:1') (0.088)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6424, device='cuda:1')  +-  tensor(0.1538, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.945 +- 0.154
Intervened Stability MCC for r=0.3 = 0.344 +- 0.459
Original Stability F1 for r=0.3 = 0.964 +- 0.098
Intervened Stability F1 for r=0.3 = 0.631 +- 0.242
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.227840
Plausibility completed in  0:00:25.915809
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5427, device='cuda:1')  +-  tensor(0.3154, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8943, device='cuda:1')  +-  tensor(0.1105, device='cuda:1') (0.042)
Original Stability MCC for r=0.6 = 0.985 +- 0.057
Intervened Stability MCC for r=0.6 = 0.294 +- 0.400
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.871 +- 0.107
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:30:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:30:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.136194
Plausibility completed in  0:00:26.205749
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5460, device='cuda:1')  +-  tensor(0.3276, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.1524, device='cuda:1') (0.062)
Original Stability MCC for r=0.3 = 0.964 +- 0.098
Intervened Stability MCC for r=0.3 = 0.346 +- 0.446
Original Stability F1 for r=0.3 = 0.976 +- 0.063
Intervened Stability F1 for r=0.3 = 0.634 +- 0.219
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.997200
Plausibility completed in  0:00:25.934556
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5293, device='cuda:1')  +-  tensor(0.3237, device='cuda:1') (0.038)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9054, device='cuda:1')  +-  tensor(0.1035, device='cuda:1') (0.031)
Original Stability MCC for r=0.6 = 0.972 +- 0.086
Intervened Stability MCC for r=0.6 = 0.303 +- 0.422
Original Stability F1 for r=0.6 = 0.990 +- 0.030
Intervened Stability F1 for r=0.6 = 0.884 +- 0.104
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:31:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 01:31:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.476


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.144953
Plausibility completed in  0:00:26.164556
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3223, device='cuda:1')  +-  tensor(0.2092, device='cuda:1') (0.075)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5488, device='cuda:1')  +-  tensor(0.1541, device='cuda:1') (0.072)
Original Stability MCC for r=0.3 = 0.940 +- 0.140
Intervened Stability MCC for r=0.3 = 0.290 +- 0.397
Original Stability F1 for r=0.3 = 0.960 +- 0.094
Intervened Stability F1 for r=0.3 = 0.597 +- 0.206
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.092407
Plausibility completed in  0:00:25.442792
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2841, device='cuda:1')  +-  tensor(0.2045, device='cuda:1') (0.049)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8633, device='cuda:1')  +-  tensor(0.1610, device='cuda:1') (0.034)
Original Stability MCC for r=0.6 = 0.981 +- 0.059
Intervened Stability MCC for r=0.6 = 0.297 +- 0.456
Original Stability F1 for r=0.6 = 0.993 +- 0.022
Intervened Stability F1 for r=0.6 = 0.860 +- 0.106
Num considered samples: 2944

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56387447 0.5637656 ] +- [0.09189798 0.09200948] (mean across ratios: 0.56 +- 0.07)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50277141 0.46912543] +- [0.09228154 0.09443699] (mean across ratios: 0.49 +- 0.07)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.67785167 0.96908485] +- [0.09343448 0.01478117] (mean across ratios: 0.82 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.58530911 0.88910885] +- [0.04886559 0.01979827] (mean across ratios: 0.74 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96290846 0.99099363] +- [0.0178542  0.00250489] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.61834489 0.87317419] +- [0.05237168 0.01163992] (mean across ratios: 0.75 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.9438203  0.97542883] +- [0.02781186 0.00687591] (mean across ratios: 0.96 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.32265492 0.28807904] +- [0.08883428 0.03295086] (mean across ratios: 0.31 +- 0.05)

Overall time of execution:  0:06:47.874090
DONE CIGA GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:33:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:33:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.074474
Plausibility completed in  0:01:56.566837
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.005
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.002
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:13.841553
Plausibility completed in  0:01:55.075677
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.991 +- 0.018
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.002
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:46:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:46:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.528987
Plausibility completed in  0:01:57.013793
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5656, device='cuda:1')  +-  tensor(0.0090, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.988 +- 0.056
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.995 +- 0.025
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:13.967113
Plausibility completed in  0:01:54.732916
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9300, device='cuda:1')  +-  tensor(0.0174, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.966 +- 0.121
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.996 +- 0.018
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 13:58:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 01:58:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.358237
Plausibility completed in  0:01:56.462105
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5385, device='cuda:1')  +-  tensor(0.0308, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.794 +- 0.153
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.901 +- 0.085
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.108951
Plausibility completed in  0:01:55.809188
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8375, device='cuda:1')  +-  tensor(0.0454, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.490 +- 0.106
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.904 +- 0.036
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:10:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:10:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.468913
Plausibility completed in  0:01:55.821328
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.382363
Plausibility completed in  0:01:54.885817
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:22:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:22:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.512084
Plausibility completed in  0:01:56.132648
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.458411
Plausibility completed in  0:01:54.874742
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000

\FINISHED GOODCMNIST - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30034459 0.60039657] +- [0. 0.] (mean across ratios: 0.45 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.56041994 0.91257505] +- [0.0109414  0.03756578] (mean across ratios: 0.74 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9999995  0.99999955] +- [1.66893005e-07 7.15255737e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.97857629 0.9797137 ] +- [0.03872483 0.03779968] (mean across ratios: 0.98 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999983 0.99999985] +- [3.33786011e-07 3.09944153e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.95506023 0.88592942] +- [0.08058123 0.19820544] (mean across ratios: 0.92 +- 0.11)

Overall time of execution:  1:00:43.035309
DONE LECI GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:34:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:34:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.175736
Plausibility completed in  0:01:52.113009
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.004
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.002
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:13.679100
Plausibility completed in  0:01:50.967432
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.029
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:47:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:47:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.501771
Plausibility completed in  0:01:53.985559
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6365, device='cuda:1')  +-  tensor(0.0124, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.990 +- 0.047
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.996 +- 0.019
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.133807
Plausibility completed in  0:01:55.084391
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9990, device='cuda:1')  +-  tensor(0.0118, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.005 +- 0.056
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.998 +- 0.010
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:59:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.819347
Plausibility completed in  0:01:55.550833
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6062, device='cuda:1')  +-  tensor(0.0355, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.601 +- 0.153
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.834 +- 0.074
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.726886
Plausibility completed in  0:01:51.316077
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9424, device='cuda:1')  +-  tensor(0.0507, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.066 +- 0.132
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.877 +- 0.032
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:13:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:13:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.788111
Plausibility completed in  0:01:53.171520
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.140935
Plausibility completed in  0:01:55.011412
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:27:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.492497
Plausibility completed in  0:01:53.965663
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.018394
Plausibility completed in  0:01:56.446066
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000

\FINISHED GOODCMNIST - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30034459 0.60039657] +- [0. 0.] (mean across ratios: 0.45 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.63075912 0.98826845] +- [0.01229642 0.02295409] (mean across ratios: 0.81 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999958 0.99999958] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.96549431 0.97478507] +- [0.06596051 0.04878054] (mean across ratios: 0.97 +- 0.04)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.91701752 0.01478284] +- [0.15780502 0.02580282] (mean across ratios: 0.47 +- 0.08)

Overall time of execution:  1:06:45.867956
DONE LECI GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:41:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 03:41:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9513
Train Loss: 0.1416
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3406
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3538
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.8665
OOD Test ACCURACY: 0.2856
OOD Test Loss: 5.0562

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.8921
Train Loss: 0.3223
ID Validation ACCURACY: 0.8611
ID Validation Loss: 0.4189
ID Test ACCURACY: 0.8610
ID Test Loss: 0.4250
OOD Validation ACCURACY: 0.8180
OOD Validation Loss: 0.5733
OOD Test ACCURACY: 0.3071
OOD Test Loss: 3.0050

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.2856 0.8610 0.3071 0.8611 0.8180[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.286634
Plausibility completed in  0:02:05.522374
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3527, device='cuda:1')  +-  tensor(0.0069, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.484 +- 0.169
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.656 +- 0.113
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.168064
Plausibility completed in  0:02:15.936626
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6831, device='cuda:1')  +-  tensor(0.0085, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.379 +- 0.181
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.793 +- 0.060
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:01:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 04:01:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ACCURACY: 0.9519
Train Loss: 0.1382
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3621
ID Test ACCURACY: 0.8871
ID Test Loss: 0.3798
OOD Validation ACCURACY: 0.7449
OOD Validation Loss: 1.1037
OOD Test ACCURACY: 0.3044
OOD Test Loss: 5.2755

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.9417
Train Loss: 0.1662
ID Validation ACCURACY: 0.8909
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8841
ID Test Loss: 0.3721
OOD Validation ACCURACY: 0.8134
OOD Validation Loss: 0.6389
OOD Test ACCURACY: 0.4137
OOD Test Loss: 2.6973

[0m[1;37mINFO[0m: [1mChartInfo 0.8871 0.3044 0.8841 0.4137 0.8909 0.8134[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.046275
Plausibility completed in  0:02:06.248153
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3509, device='cuda:1')  +-  tensor(0.0064, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.450 +- 0.174
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.633 +- 0.116
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.146460
Plausibility completed in  0:02:21.080799
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6816, device='cuda:1')  +-  tensor(0.0081, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.353 +- 0.176
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.784 +- 0.058
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:17:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 04:17:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9534
Train Loss: 0.1343
ID Validation ACCURACY: 0.8954
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8914
ID Test Loss: 0.3791
OOD Validation ACCURACY: 0.7987
OOD Validation Loss: 0.7966
OOD Test ACCURACY: 0.2186
OOD Test Loss: 11.4348

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9452
Train Loss: 0.1585
ID Validation ACCURACY: 0.8876
ID Validation Loss: 0.3718
ID Test ACCURACY: 0.8883
ID Test Loss: 0.3697
OOD Validation ACCURACY: 0.8087
OOD Validation Loss: 0.7290
OOD Test ACCURACY: 0.2657
OOD Test Loss: 10.3527

[0m[1;37mINFO[0m: [1mChartInfo 0.8914 0.2186 0.8883 0.2657 0.8876 0.8087[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.787243
Plausibility completed in  0:02:05.025903
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3542, device='cuda:1')  +-  tensor(0.0073, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.479 +- 0.171
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.653 +- 0.114
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.444586
Plausibility completed in  0:02:26.459366
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6841, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.369 +- 0.175
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.789 +- 0.058
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:33:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 04:33:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9613
Train Loss: 0.1134
ID Validation ACCURACY: 0.8956
ID Validation Loss: 0.3556
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3603
OOD Validation ACCURACY: 0.7163
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.1731
OOD Test Loss: 12.4917

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.9177
Train Loss: 0.2366
ID Validation ACCURACY: 0.8739
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.8733
ID Test Loss: 0.3982
OOD Validation ACCURACY: 0.7943
OOD Validation Loss: 0.6922
OOD Test ACCURACY: 0.3307
OOD Test Loss: 3.3639

[0m[1;37mINFO[0m: [1mChartInfo 0.8920 0.1731 0.8733 0.3307 0.8739 0.7943[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.984802
Plausibility completed in  0:02:05.622938
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3522, device='cuda:1')  +-  tensor(0.0075, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.472 +- 0.186
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.648 +- 0.124
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.841072
Plausibility completed in  0:02:27.942459
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6831, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.372 +- 0.206
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.790 +- 0.069
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:48:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 04:48:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9609
Train Loss: 0.1130
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3439
ID Test ACCURACY: 0.8937
ID Test Loss: 0.3554
OOD Validation ACCURACY: 0.7863
OOD Validation Loss: 0.8914
OOD Test ACCURACY: 0.2307
OOD Test Loss: 10.8940

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.9328
Train Loss: 0.1957
ID Validation ACCURACY: 0.8821
ID Validation Loss: 0.3581
ID Test ACCURACY: 0.8791
ID Test Loss: 0.3593
OOD Validation ACCURACY: 0.8147
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.3769
OOD Test Loss: 3.0655

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.2307 0.8791 0.3769 0.8821 0.8147[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.983199
Plausibility completed in  0:02:05.958823
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3539, device='cuda:1')  +-  tensor(0.0070, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.484 +- 0.176
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.656 +- 0.117
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.678915
Plausibility completed in  0:02:21.713804
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6845, device='cuda:1')  +-  tensor(0.0086, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.383 +- 0.180
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.794 +- 0.060
Num considered samples: 7000

\FINISHED GOODCMNIST - GSATvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33171532 0.64207134] +- [0.00149599 0.00160698] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.35277729 0.68329914] +- [0.00118923 0.00099381] (mean across ratios: 0.52 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999878 0.99999901] +- [5.85947310e-07 3.40529844e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.64927621 0.79001974] +- [0.00859003 0.00347627] (mean across ratios: 0.72 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999889 0.99999862] +- [8.16039614e-07 8.26250241e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.4737717  0.37102455] +- [0.01288339 0.01042038] (mean across ratios: 0.42 +- 0.01)

Overall time of execution:  1:22:43.114692
DONE GSAT GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:04:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 05:04:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9513
Train Loss: 0.1416
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3406
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3538
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.8665
OOD Test ACCURACY: 0.2856
OOD Test Loss: 5.0562

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.8921
Train Loss: 0.3223
ID Validation ACCURACY: 0.8611
ID Validation Loss: 0.4189
ID Test ACCURACY: 0.8610
ID Test Loss: 0.4250
OOD Validation ACCURACY: 0.8180
OOD Validation Loss: 0.5733
OOD Test ACCURACY: 0.3071
OOD Test Loss: 3.0050

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.2856 0.8610 0.3071 0.8611 0.8180[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.572117
Plausibility completed in  0:02:06.814962
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3843, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.180 +- 0.188
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.488 +- 0.117
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:20.543888
Plausibility completed in  0:02:40.848661
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7523, device='cuda:1')  +-  tensor(0.0097, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.063 +- 0.136
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.766 +- 0.035
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:25:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 05:25:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ACCURACY: 0.9519
Train Loss: 0.1382
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3621
ID Test ACCURACY: 0.8871
ID Test Loss: 0.3798
OOD Validation ACCURACY: 0.7449
OOD Validation Loss: 1.1037
OOD Test ACCURACY: 0.3044
OOD Test Loss: 5.2755

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.9417
Train Loss: 0.1662
ID Validation ACCURACY: 0.8909
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8841
ID Test Loss: 0.3721
OOD Validation ACCURACY: 0.8134
OOD Validation Loss: 0.6389
OOD Test ACCURACY: 0.4137
OOD Test Loss: 2.6973

[0m[1;37mINFO[0m: [1mChartInfo 0.8871 0.3044 0.8841 0.4137 0.8909 0.8134[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.414292
Plausibility completed in  0:02:07.732404
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3820, device='cuda:1')  +-  tensor(0.0079, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.122 +- 0.189
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.452 +- 0.117
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:18.495429
Plausibility completed in  0:02:28.476442
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7522, device='cuda:1')  +-  tensor(0.0101, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.064 +- 0.137
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.766 +- 0.036
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:40:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 05:40:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9534
Train Loss: 0.1343
ID Validation ACCURACY: 0.8954
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8914
ID Test Loss: 0.3791
OOD Validation ACCURACY: 0.7987
OOD Validation Loss: 0.7966
OOD Test ACCURACY: 0.2186
OOD Test Loss: 11.4348

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9452
Train Loss: 0.1585
ID Validation ACCURACY: 0.8876
ID Validation Loss: 0.3718
ID Test ACCURACY: 0.8883
ID Test Loss: 0.3697
OOD Validation ACCURACY: 0.8087
OOD Validation Loss: 0.7290
OOD Test ACCURACY: 0.2657
OOD Test Loss: 10.3527

[0m[1;37mINFO[0m: [1mChartInfo 0.8914 0.2186 0.8883 0.2657 0.8876 0.8087[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.433801
Plausibility completed in  0:02:10.166557
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3834, device='cuda:1')  +-  tensor(0.0074, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.158 +- 0.189
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.474 +- 0.117
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.952998
Plausibility completed in  0:02:16.857577
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7519, device='cuda:1')  +-  tensor(0.0094, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.051 +- 0.131
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.763 +- 0.033
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:56:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 05:56:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9613
Train Loss: 0.1134
ID Validation ACCURACY: 0.8956
ID Validation Loss: 0.3556
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3603
OOD Validation ACCURACY: 0.7163
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.1731
OOD Test Loss: 12.4917

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.9177
Train Loss: 0.2366
ID Validation ACCURACY: 0.8739
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.8733
ID Test Loss: 0.3982
OOD Validation ACCURACY: 0.7943
OOD Validation Loss: 0.6922
OOD Test ACCURACY: 0.3307
OOD Test Loss: 3.3639

[0m[1;37mINFO[0m: [1mChartInfo 0.8920 0.1731 0.8733 0.3307 0.8739 0.7943[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.457719
Plausibility completed in  0:02:09.606990
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3843, device='cuda:1')  +-  tensor(0.0105, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.168 +- 0.220
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.480 +- 0.138
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.455018
Plausibility completed in  0:02:21.865846
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7536, device='cuda:1')  +-  tensor(0.0127, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.102 +- 0.174
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.775 +- 0.047
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:11:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 06:11:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9609
Train Loss: 0.1130
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3439
ID Test ACCURACY: 0.8937
ID Test Loss: 0.3554
OOD Validation ACCURACY: 0.7863
OOD Validation Loss: 0.8914
OOD Test ACCURACY: 0.2307
OOD Test Loss: 10.8940

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.9328
Train Loss: 0.1957
ID Validation ACCURACY: 0.8821
ID Validation Loss: 0.3581
ID Test ACCURACY: 0.8791
ID Test Loss: 0.3593
OOD Validation ACCURACY: 0.8147
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.3769
OOD Test Loss: 3.0655

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.2307 0.8791 0.3769 0.8821 0.8147[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.434546
Plausibility completed in  0:02:05.327530
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3846, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.170 +- 0.197
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.482 +- 0.123
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:19.998768
Plausibility completed in  0:02:20.731127
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7527, device='cuda:1')  +-  tensor(0.0102, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.065 +- 0.141
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.766 +- 0.036
Num considered samples: 7000

\FINISHED GOODCMNIST - GSATvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33171531 0.64207127] +- [0.00149599 0.00160697] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38372111 0.75252882] +- [0.00097319 0.00061023] (mean across ratios: 0.57 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999868 0.99999912] +- [5.24249874e-07 3.56433782e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.47510275 0.76705861] +- [0.01259624 0.00406187] (mean across ratios: 0.62 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999871 0.99999886] +- [7.45034217e-07 8.37355105e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15956827 0.0691787 ] +- [0.0201928  0.01730779] (mean across ratios: 0.11 +- 0.01)

Overall time of execution:  1:22:21.315259
DONE GSAT GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:27:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 06:27:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.3715
Train Loss: 2.7499
ID Validation ACCURACY: 0.3654
ID Validation Loss: 2.7861
ID Test ACCURACY: 0.3729
ID Test Loss: 2.7814
OOD Validation ACCURACY: 0.3491
OOD Validation Loss: 3.1257
OOD Test ACCURACY: 0.2690
OOD Test Loss: 4.6794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.3198
Train Loss: 3.3902
ID Validation ACCURACY: 0.3150
ID Validation Loss: 3.4229
ID Test ACCURACY: 0.3230
ID Test Loss: 3.4163
OOD Validation ACCURACY: 0.3611
OOD Validation Loss: 3.3370
OOD Test ACCURACY: 0.2419
OOD Test Loss: 7.8889

[0m[1;37mINFO[0m: [1mChartInfo 0.3729 0.2690 0.3230 0.2419 0.3150 0.3611[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.500818
Plausibility completed in  0:01:51.670896
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5720, device='cuda:1')  +-  tensor(0.0832, device='cuda:1') (0.015)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.868 +- 0.061
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.912 +- 0.041
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.070057
Plausibility completed in  0:01:55.050112
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8830, device='cuda:1')  +-  tensor(0.0755, device='cuda:1') (0.014)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.726 +- 0.128
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.909 +- 0.042
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:47:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 06:47:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.7181
Train Loss: 0.8746
ID Validation ACCURACY: 0.6574
ID Validation Loss: 1.2188
ID Test ACCURACY: 0.6584
ID Test Loss: 1.2023
OOD Validation ACCURACY: 0.4703
OOD Validation Loss: 2.8402
OOD Test ACCURACY: 0.1883
OOD Test Loss: 15.9927

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.6624
Train Loss: 1.0155
ID Validation ACCURACY: 0.6256
ID Validation Loss: 1.1994
ID Test ACCURACY: 0.6141
ID Test Loss: 1.2223
OOD Validation ACCURACY: 0.5277
OOD Validation Loss: 1.8377
OOD Test ACCURACY: 0.2083
OOD Test Loss: 11.1952

[0m[1;37mINFO[0m: [1mChartInfo 0.6584 0.1883 0.6141 0.2083 0.6256 0.5277[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.012808
Plausibility completed in  0:01:45.628069
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4819, device='cuda:1')  +-  tensor(0.0266, device='cuda:1') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.709 +- 0.109
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.806 +- 0.072
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.477130
Plausibility completed in  0:01:57.812308
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8038, device='cuda:1')  +-  tensor(0.0210, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.554 +- 0.100
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.851 +- 0.033
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:02:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:16 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:02:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ACCURACY: 0.4452
Train Loss: 1.8491
ID Validation ACCURACY: 0.4349
ID Validation Loss: 1.9176
ID Test ACCURACY: 0.4390
ID Test Loss: 1.8691
OOD Validation ACCURACY: 0.3544
OOD Validation Loss: 2.4861
OOD Test ACCURACY: 0.2210
OOD Test Loss: 3.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.4067
Train Loss: 2.3142
ID Validation ACCURACY: 0.3957
ID Validation Loss: 2.4284
ID Test ACCURACY: 0.4073
ID Test Loss: 2.3439
OOD Validation ACCURACY: 0.3826
OOD Validation Loss: 2.4420
OOD Test ACCURACY: 0.2560
OOD Test Loss: 4.6004

[0m[1;37mINFO[0m: [1mChartInfo 0.4390 0.2210 0.4073 0.2560 0.3957 0.3826[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.909238
Plausibility completed in  0:01:42.845234
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5367, device='cuda:1')  +-  tensor(0.0965, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.826 +- 0.059
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.884 +- 0.039
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.566004
Plausibility completed in  0:01:58.810163
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8579, device='cuda:1')  +-  tensor(0.0822, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.709 +- 0.108
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.903 +- 0.035
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:16:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:16:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.6588
Train Loss: 0.9911
ID Validation ACCURACY: 0.6276
ID Validation Loss: 1.1178
ID Test ACCURACY: 0.6277
ID Test Loss: 1.1142
OOD Validation ACCURACY: 0.4983
OOD Validation Loss: 1.7285
OOD Test ACCURACY: 0.2486
OOD Test Loss: 4.9047

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5989
Train Loss: 1.1783
ID Validation ACCURACY: 0.5699
ID Validation Loss: 1.3077
ID Test ACCURACY: 0.5776
ID Test Loss: 1.2851
OOD Validation ACCURACY: 0.5351
OOD Validation Loss: 1.4928
OOD Test ACCURACY: 0.2547
OOD Test Loss: 5.2471

[0m[1;37mINFO[0m: [1mChartInfo 0.6277 0.2486 0.5776 0.2547 0.5699 0.5351[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.000392
Plausibility completed in  0:01:42.479339
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4820, device='cuda:1')  +-  tensor(0.0266, device='cuda:1') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.700 +- 0.113
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.800 +- 0.075
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.239762
Plausibility completed in  0:01:46.312940
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8011, device='cuda:1')  +-  tensor(0.0211, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.530 +- 0.108
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.843 +- 0.035
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:31:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:31:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.4206
Train Loss: 1.8923
ID Validation ACCURACY: 0.4203
ID Validation Loss: 1.9484
ID Test ACCURACY: 0.4191
ID Test Loss: 1.8983
OOD Validation ACCURACY: 0.3490
OOD Validation Loss: 2.3843
OOD Test ACCURACY: 0.2689
OOD Test Loss: 2.7813

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.4088
Train Loss: 1.8664
ID Validation ACCURACY: 0.4009
ID Validation Loss: 1.9187
ID Test ACCURACY: 0.4040
ID Test Loss: 1.9019
OOD Validation ACCURACY: 0.3840
OOD Validation Loss: 2.1207
OOD Test ACCURACY: 0.2513
OOD Test Loss: 3.0490

[0m[1;37mINFO[0m: [1mChartInfo 0.4191 0.2689 0.4040 0.2513 0.4009 0.3840[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.093614
Plausibility completed in  0:01:41.564847
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5637, device='cuda:1')  +-  tensor(0.0983, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.823 +- 0.061
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.882 +- 0.040
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.205266
Plausibility completed in  0:01:41.809232
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8712, device='cuda:1')  +-  tensor(0.0773, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.706 +- 0.102
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.902 +- 0.033
Num considered samples: 7000

\FINISHED GOODCMNIST - CIGAvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.59635774 0.90472876] +- [0.10245757 0.10339225] (mean across ratios: 0.75 +- 0.07)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.52727264 0.84340161] +- [0.0387966  0.03437445] (mean across ratios: 0.69 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999825 0.99999923] +- [6.54675017e-07 3.01578299e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.85694298 0.8817277 ] +- [0.04505835 0.02833179] (mean across ratios: 0.87 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999809 0.99999917] +- [9.58134236e-07 7.06258452e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.78523039 0.6451538 ] +- [0.06765152 0.08459749] (mean across ratios: 0.72 +- 0.05)

Overall time of execution:  1:18:56.229736
DONE CIGA GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:46:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:34 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.3715
Train Loss: 2.7499
ID Validation ACCURACY: 0.3654
ID Validation Loss: 2.7861
ID Test ACCURACY: 0.3729
ID Test Loss: 2.7814
OOD Validation ACCURACY: 0.3491
OOD Validation Loss: 3.1257
OOD Test ACCURACY: 0.2690
OOD Test Loss: 4.6794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.3198
Train Loss: 3.3902
ID Validation ACCURACY: 0.3150
ID Validation Loss: 3.4229
ID Test ACCURACY: 0.3230
ID Test Loss: 3.4163
OOD Validation ACCURACY: 0.3611
OOD Validation Loss: 3.3370
OOD Test ACCURACY: 0.2419
OOD Test Loss: 7.8889

[0m[1;37mINFO[0m: [1mChartInfo 0.3729 0.2690 0.3230 0.2419 0.3150 0.3611[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:19.156632
Plausibility completed in  0:01:39.904682
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4619, device='cuda:1')  +-  tensor(0.0550, device='cuda:1') (0.014)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.680 +- 0.135
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.800 +- 0.083
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.363664
Plausibility completed in  0:01:39.020975
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7741, device='cuda:1')  +-  tensor(0.0237, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.172 +- 0.177
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.794 +- 0.039
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:05:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:05:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.7181
Train Loss: 0.8746
ID Validation ACCURACY: 0.6574
ID Validation Loss: 1.2188
ID Test ACCURACY: 0.6584
ID Test Loss: 1.2023
OOD Validation ACCURACY: 0.4703
OOD Validation Loss: 2.8402
OOD Test ACCURACY: 0.1883
OOD Test Loss: 15.9927

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.6624
Train Loss: 1.0155
ID Validation ACCURACY: 0.6256
ID Validation Loss: 1.1994
ID Test ACCURACY: 0.6141
ID Test Loss: 1.2223
OOD Validation ACCURACY: 0.5277
OOD Validation Loss: 1.8377
OOD Test ACCURACY: 0.2083
OOD Test Loss: 11.1952

[0m[1;37mINFO[0m: [1mChartInfo 0.6584 0.1883 0.6141 0.2083 0.6256 0.5277[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.973142
Plausibility completed in  0:01:45.226236
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4609, device='cuda:1')  +-  tensor(0.0358, device='cuda:1') (0.009)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.409 +- 0.193
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.632 +- 0.118
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.122893
Plausibility completed in  0:01:38.158663
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8180, device='cuda:1')  +-  tensor(0.0195, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.242 +- 0.094
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.811 +- 0.023
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:21:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:21:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ACCURACY: 0.4452
Train Loss: 1.8491
ID Validation ACCURACY: 0.4349
ID Validation Loss: 1.9176
ID Test ACCURACY: 0.4390
ID Test Loss: 1.8691
OOD Validation ACCURACY: 0.3544
OOD Validation Loss: 2.4861
OOD Test ACCURACY: 0.2210
OOD Test Loss: 3.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.4067
Train Loss: 2.3142
ID Validation ACCURACY: 0.3957
ID Validation Loss: 2.4284
ID Test ACCURACY: 0.4073
ID Test Loss: 2.3439
OOD Validation ACCURACY: 0.3826
OOD Validation Loss: 2.4420
OOD Test ACCURACY: 0.2560
OOD Test Loss: 4.6004

[0m[1;37mINFO[0m: [1mChartInfo 0.4390 0.2210 0.4073 0.2560 0.3957 0.3826[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:19.989656
Plausibility completed in  0:01:53.887412
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4416, device='cuda:1')  +-  tensor(0.0571, device='cuda:1') (0.013)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.564 +- 0.156
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.728 +- 0.096
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.211504
Plausibility completed in  0:01:38.619307
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7659, device='cuda:1')  +-  tensor(0.0167, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.135 +- 0.141
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.785 +- 0.030
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:35:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:35:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.6588
Train Loss: 0.9911
ID Validation ACCURACY: 0.6276
ID Validation Loss: 1.1178
ID Test ACCURACY: 0.6277
ID Test Loss: 1.1142
OOD Validation ACCURACY: 0.4983
OOD Validation Loss: 1.7285
OOD Test ACCURACY: 0.2486
OOD Test Loss: 4.9047

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5989
Train Loss: 1.1783
ID Validation ACCURACY: 0.5699
ID Validation Loss: 1.3077
ID Test ACCURACY: 0.5776
ID Test Loss: 1.2851
OOD Validation ACCURACY: 0.5351
OOD Validation Loss: 1.4928
OOD Test ACCURACY: 0.2547
OOD Test Loss: 5.2471

[0m[1;37mINFO[0m: [1mChartInfo 0.6277 0.2486 0.5776 0.2547 0.5699 0.5351[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.129719
Plausibility completed in  0:01:55.403754
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4589, device='cuda:1')  +-  tensor(0.0360, device='cuda:1') (0.008)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.380 +- 0.200
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.614 +- 0.123
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.203937
Plausibility completed in  0:01:39.049559
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8137, device='cuda:1')  +-  tensor(0.0201, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.214 +- 0.095
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.804 +- 0.023
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:50:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 08:50:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.4206
Train Loss: 1.8923
ID Validation ACCURACY: 0.4203
ID Validation Loss: 1.9484
ID Test ACCURACY: 0.4191
ID Test Loss: 1.8983
OOD Validation ACCURACY: 0.3490
OOD Validation Loss: 2.3843
OOD Test ACCURACY: 0.2689
OOD Test Loss: 2.7813

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.4088
Train Loss: 1.8664
ID Validation ACCURACY: 0.4009
ID Validation Loss: 1.9187
ID Test ACCURACY: 0.4040
ID Test Loss: 1.9019
OOD Validation ACCURACY: 0.3840
OOD Validation Loss: 2.1207
OOD Test ACCURACY: 0.2513
OOD Test Loss: 3.0490

[0m[1;37mINFO[0m: [1mChartInfo 0.4191 0.2689 0.4040 0.2513 0.4009 0.3840[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:21.278107
Plausibility completed in  0:02:01.315979
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0632, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.546 +- 0.166
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.717 +- 0.102
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.337962
Plausibility completed in  0:01:42.439750
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7674, device='cuda:1')  +-  tensor(0.0175, device='cuda:1') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.109 +- 0.144
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.778 +- 0.031
Num considered samples: 7000

\FINISHED GOODCMNIST - CIGAvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.59635783 0.90472901] +- [0.10245741 0.10339214] (mean across ratios: 0.75 +- 0.07)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.45585253 0.78780228] +- [0.00740705 0.02308196] (mean across ratios: 0.62 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9999982  0.99999938] +- [8.65725405e-07 1.90734863e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69822724 0.79422951] +- [0.06815577 0.01194386] (mean across ratios: 0.75 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999807 0.99999949] +- [1.21721966e-06 4.95256855e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.5158632  0.17442583] +- [0.10925228 0.04912955] (mean across ratios: 0.35 +- 0.06)

Overall time of execution:  1:18:41.124920
DONE CIGA GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:05:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:05:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:06:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:07:00 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:27.768857
Plausibility completed in  0:02:10.483090
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3552, device='cuda:1')  +-  tensor(0.0258, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.912 +- 0.117
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.943 +- 0.075
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:30.343060
Plausibility completed in  0:02:10.284916
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7018, device='cuda:1')  +-  tensor(0.0397, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.798 +- 0.180
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.940 +- 0.051
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:13:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:13:58 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:14:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:14:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:15:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:15:46 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:32.247908
Plausibility completed in  0:02:01.229109
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5775, device='cuda:1')  +-  tensor(0.0483, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 1.000 +- 0.013
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:29.044712
Plausibility completed in  0:01:55.004615
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9319, device='cuda:1')  +-  tensor(0.0545, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.807 +- 0.394
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11305
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:22:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:22:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:23:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:23:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:23:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:23:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:05 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:24:06 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.638586
Plausibility completed in  0:02:06.972514
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3554, device='cuda:1')  +-  tensor(0.0255, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.898 +- 0.149
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.934 +- 0.094
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:32.298710
Plausibility completed in  0:02:12.500793
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7026, device='cuda:1')  +-  tensor(0.0413, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.645 +- 0.228
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.895 +- 0.064
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:30:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:30:59 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:31:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:31:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:32:50 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:31.636793
Plausibility completed in  0:02:01.611033
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3549, device='cuda:1')  +-  tensor(0.0252, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.960 +- 0.080
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.974 +- 0.051
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.483366
Plausibility completed in  0:01:49.506855
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6995, device='cuda:1')  +-  tensor(0.0391, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.920 +- 0.119
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.977 +- 0.033
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:39:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:39:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:41:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:41:16 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:31.957706
Plausibility completed in  0:02:09.598571
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.0257, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.001
Intervened Stability MCC for r=0.3 = 0.927 +- 0.110
Original Stability F1 for r=0.3 = 1.000 +- 0.001
Intervened Stability F1 for r=0.3 = 0.953 +- 0.069
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:31.826571
Plausibility completed in  0:02:15.654801
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6990, device='cuda:1')  +-  tensor(0.0395, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.864 +- 0.147
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.960 +- 0.041
Num considered samples: 11314

\FINISHED LBAPcore - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30712721 0.60698806] +- [0.0001327  0.00014632] (mean across ratios: 0.46 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.39970395 0.74695436] +- [0.08891349 0.09247365] (mean across ratios: 0.57 +- 0.06)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999799 0.99999946] +- [2.95639038e-06 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.96094221 0.95408915] +- [0.02363417 0.03576436] (mean across ratios: 0.96 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999783 1.        ] +- [4.33921814e-06 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.93908638 0.80705703] +- [0.03675072 0.09202896] (mean across ratios: 0.87 +- 0.05)

Overall time of execution:  0:43:10.174197
DONE LECI LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:49:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:49:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:49:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:49:58 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:50:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:50:41 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.954566
Plausibility completed in  0:01:52.284369
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4147, device='cuda:1')  +-  tensor(0.0546, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.001
Intervened Stability MCC for r=0.3 = 0.872 +- 0.149
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.926 +- 0.083
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:28.768916
Plausibility completed in  0:02:02.376873
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8141, device='cuda:1')  +-  tensor(0.0737, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.629 +- 0.306
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.936 +- 0.053
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:57:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 09:57:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 09:57:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 09:57:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 09:58:53 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:30.752858
Plausibility completed in  0:02:05.274193
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6725, device='cuda:1')  +-  tensor(0.0806, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.990 +- 0.101
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:27.567008
Plausibility completed in  0:01:48.214999
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9920, device='cuda:1')  +-  tensor(0.0369, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.116 +- 0.320
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11305
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:05:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:05:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:06:58 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:32.065547
Plausibility completed in  0:02:08.574871
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4150, device='cuda:1')  +-  tensor(0.0544, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.850 +- 0.171
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.914 +- 0.094
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:30.579360
Plausibility completed in  0:02:13.803947
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8152, device='cuda:1')  +-  tensor(0.0758, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.404 +- 0.336
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.895 +- 0.064
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:14:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:14:09 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:14:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:15:55 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.892334
Plausibility completed in  0:01:48.615677
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4144, device='cuda:1')  +-  tensor(0.0541, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.927 +- 0.116
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.958 +- 0.061
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.407099
Plausibility completed in  0:01:52.756019
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8116, device='cuda:1')  +-  tensor(0.0737, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.836 +- 0.258
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.977 +- 0.030
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:22:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:22:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:22:58 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:23:12 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:23:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:23:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:24:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:24:04 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:32.151540
Plausibility completed in  0:02:06.823408
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4150, device='cuda:1')  +-  tensor(0.0547, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.870 +- 0.152
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.926 +- 0.081
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:29.581903
Plausibility completed in  0:02:00.846329
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8109, device='cuda:1')  +-  tensor(0.0736, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.777 +- 0.263
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.965 +- 0.035
Num considered samples: 11314

\FINISHED LBAPcore - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30712724 0.60698805] +- [0.00013273 0.00014633] (mean across ratios: 0.46 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.46633248 0.84875824] +- [0.10310559 0.0716286 ] (mean across ratios: 0.66 +- 0.06)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999853 0.99999946] +- [1.85966492e-06 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.94474443 0.95452135] +- [0.03135798 0.03629345] (mean across ratios: 0.95 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999866 1.        ] +- [2.67028809e-06 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.9016034  0.55256615] +- [0.05091062 0.26439979] (mean across ratios: 0.73 +- 0.13)

Overall time of execution:  0:42:15.475785
DONE LECI LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:31:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:31:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:32:15 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:32:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:32:40 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:33:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:33:24 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.012313
Plausibility completed in  0:01:47.736546
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3532, device='cuda:1')  +-  tensor(0.0253, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.195 +- 0.213
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.471 +- 0.144
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.320417
Plausibility completed in  0:02:05.622916
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6838, device='cuda:1')  +-  tensor(0.0338, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = 0.200 +- 0.215
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.741 +- 0.075
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:39:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:39:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:40:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:40:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:40:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:41:37 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:29.811042
Plausibility completed in  0:02:15.752124
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3537, device='cuda:1')  +-  tensor(0.0221, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.235 +- 0.213
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.497 +- 0.144
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:29.844262
Plausibility completed in  0:01:58.476382
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6836, device='cuda:1')  +-  tensor(0.0313, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.007
Intervened Stability MCC for r=0.6 = 0.192 +- 0.214
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.739 +- 0.074
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:48:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:48:46 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:49:16 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:49:26 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:49:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:49:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:50:07 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.361600
Plausibility completed in  0:02:08.701342
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3527, device='cuda:1')  +-  tensor(0.0242, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.194 +- 0.212
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.471 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:29.020377
Plausibility completed in  0:02:02.837247
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6836, device='cuda:1')  +-  tensor(0.0330, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.196 +- 0.215
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.740 +- 0.075
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:56:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 10:56:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 10:57:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 10:57:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 10:57:54 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:15 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 10:58:34 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:33.564827
Plausibility completed in  0:01:50.577344
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3543, device='cuda:1')  +-  tensor(0.0250, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.009
Intervened Stability MCC for r=0.3 = 0.222 +- 0.214
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.488 +- 0.145
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.698051
Plausibility completed in  0:01:46.646670
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6849, device='cuda:1')  +-  tensor(0.0337, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.195 +- 0.216
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.740 +- 0.075
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:05:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:41 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:27 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:47 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:06:48 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:33.194612
Plausibility completed in  0:02:12.707183
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3523, device='cuda:1')  +-  tensor(0.0240, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.193 +- 0.213
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.470 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:29.069682
Plausibility completed in  0:02:07.887365
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6830, device='cuda:1')  +-  tensor(0.0331, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.190 +- 0.215
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.738 +- 0.075
Num considered samples: 11314

\FINISHED LBAPcore - GSATvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33948976 0.64027609] +- [0.00426269 0.00345016] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.35325828 0.68379092] +- [0.00071868 0.00061251] (mean across ratios: 0.52 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99976467 0.9998523 ] +- [4.94833783e-05 2.98249636e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.47910572 0.73978935] +- [0.01113829 0.00097089] (mean across ratios: 0.61 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99965539 0.99960752] +- [7.26573393e-05 8.18542269e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.20802311 0.19452009] +- [0.01718869 0.00341977] (mean across ratios: 0.20 +- 0.01)

Overall time of execution:  0:42:36.870372
DONE GSAT LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:14:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:14:27 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:15:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:15:57 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.789213
Plausibility completed in  0:01:56.757784
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4121, device='cuda:1')  +-  tensor(0.0552, device='cuda:1') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.007
Intervened Stability MCC for r=0.3 = 0.169 +- 0.227
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.501 +- 0.145
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:27.036340
Plausibility completed in  0:01:57.841206
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7922, device='cuda:1')  +-  tensor(0.0709, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.157 +- 0.248
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.822 +- 0.080
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:22:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:22:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:22:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:23:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:23:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:23:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:24:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:24:05 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:31.557962
Plausibility completed in  0:02:00.586904
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4121, device='cuda:1')  +-  tensor(0.0516, device='cuda:1') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.216 +- 0.224
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.530 +- 0.141
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.214471
Plausibility completed in  0:01:45.623006
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7923, device='cuda:1')  +-  tensor(0.0697, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.143 +- 0.240
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.819 +- 0.078
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:30:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:30:41 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:31:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:31:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:31:32 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:31:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:32:03 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.325978
Plausibility completed in  0:02:05.453846
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.0535, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.166 +- 0.225
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.500 +- 0.144
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.308729
Plausibility completed in  0:01:46.443222
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7922, device='cuda:1')  +-  tensor(0.0706, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.153 +- 0.246
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.821 +- 0.080
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:38:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:38:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:38:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:38:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:09 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:39:40 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.213854
Plausibility completed in  0:01:58.059405
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4131, device='cuda:1')  +-  tensor(0.0540, device='cuda:1') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.009
Intervened Stability MCC for r=0.3 = 0.203 +- 0.227
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.522 +- 0.144
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.704087
Plausibility completed in  0:01:45.436905
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7933, device='cuda:1')  +-  tensor(0.0707, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.011
Intervened Stability MCC for r=0.6 = 0.152 +- 0.247
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.821 +- 0.079
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:45:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:45:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:46:19 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:46:29 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:46:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:46:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:47:10 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.147398
Plausibility completed in  0:01:58.213563
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4108, device='cuda:1')  +-  tensor(0.0535, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.167 +- 0.226
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.500 +- 0.144
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.168072
Plausibility completed in  0:01:45.893223
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7917, device='cuda:1')  +-  tensor(0.0708, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.010
Intervened Stability MCC for r=0.6 = 0.147 +- 0.246
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.820 +- 0.080
Num considered samples: 11314

\FINISHED LBAPcore - GSATvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33948976 0.6402761 ] +- [0.0042627  0.00345016] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.41183963 0.79233468] +- [0.00082258 0.00052011] (mean across ratios: 0.60 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9997718  0.99982923] +- [4.26522209e-05 1.44442606e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.51068715 0.82064128] +- [0.01266619 0.00086815] (mean across ratios: 0.67 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99966569 0.99954487] +- [6.22969247e-05 4.08520582e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.18431545 0.15031142] +- [0.02126229 0.00471229] (mean across ratios: 0.17 +- 0.01)

Overall time of execution:  0:38:56.121645
DONE GSAT LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:53:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:53:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/20/2024 11:54:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1597
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2366
ID Test ROC-AUC: 0.9233
ID Test Loss: 0.2412
OOD Validation ROC-AUC: 0.6572
OOD Validation Loss: 0.3846
OOD Test ROC-AUC: 0.6967
OOD Test Loss: 0.5574

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ROC-AUC: 0.8713
Train Loss: 0.2869
ID Validation ROC-AUC: 0.8665
ID Validation Loss: 0.2911
ID Test ROC-AUC: 0.8695
ID Test Loss: 0.2927
OOD Validation ROC-AUC: 0.6861
OOD Validation Loss: 0.2792
OOD Test ROC-AUC: 0.7034
OOD Test Loss: 0.4207

[0m[1;37mINFO[0m: [1mChartInfo 0.9233 0.6967 0.8695 0.7034 0.8665 0.6861[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:54:58 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:29.374093
Plausibility completed in  0:09:50.519120
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5205, device='cuda:1')  +-  tensor(0.0604, device='cuda:1') (0.022)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.794 +- 0.157
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.866 +- 0.101
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.440667
Plausibility completed in  0:09:41.895140
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8430, device='cuda:1')  +-  tensor(0.0452, device='cuda:1') (0.020)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.766 +- 0.167
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.925 +- 0.052
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:18:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:18:27 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:18:57 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:07 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:17 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:33 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.9829
Train Loss: 0.1261
ID Validation ROC-AUC: 0.9196
ID Validation Loss: 0.2917
ID Test ROC-AUC: 0.9170
ID Test Loss: 0.3056
OOD Validation ROC-AUC: 0.6433
OOD Validation Loss: 0.4965
OOD Test ROC-AUC: 0.6785
OOD Test Loss: 0.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8825
Train Loss: 0.2710
ID Validation ROC-AUC: 0.8746
ID Validation Loss: 0.2831
ID Test ROC-AUC: 0.8768
ID Test Loss: 0.2841
OOD Validation ROC-AUC: 0.6840
OOD Validation Loss: 0.3139
OOD Test ROC-AUC: 0.7101
OOD Test Loss: 0.4991

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.6785 0.8768 0.7101 0.8746 0.6840[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:19:48 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.501798
Plausibility completed in  0:09:40.353573
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5362, device='cuda:1')  +-  tensor(0.0535, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.851 +- 0.134
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.903 +- 0.086
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.020690
Plausibility completed in  0:09:57.394670
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8372, device='cuda:1')  +-  tensor(0.0430, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.814 +- 0.159
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.940 +- 0.050
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:43:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:02 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:12 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:38 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9540
Train Loss: 0.1749
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2164
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2244
OOD Validation ROC-AUC: 0.6596
OOD Validation Loss: 0.3480
OOD Test ROC-AUC: 0.6987
OOD Test Loss: 0.4931

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8972
Train Loss: 0.2438
ID Validation ROC-AUC: 0.8845
ID Validation Loss: 0.2539
ID Test ROC-AUC: 0.8865
ID Test Loss: 0.2549
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2839
OOD Test ROC-AUC: 0.7162
OOD Test Loss: 0.4332

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.6987 0.8865 0.7162 0.8845 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:44:53 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.779712
Plausibility completed in  0:09:55.284161
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4699, device='cuda:1')  +-  tensor(0.0552, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.776 +- 0.166
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.854 +- 0.108
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.448001
Plausibility completed in  0:09:39.983734
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7967, device='cuda:1')  +-  tensor(0.0535, device='cuda:1') (0.014)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.738 +- 0.192
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.916 +- 0.061
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:08:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:08:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:08:52 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:02 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:12 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 31...
[0m[1;37mINFO[0m: [1mCheckpoint 31: 
-----------------------------------
Train ROC-AUC: 0.9785
Train Loss: 0.1297
ID Validation ROC-AUC: 0.9231
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9232
ID Test Loss: 0.2591
OOD Validation ROC-AUC: 0.6355
OOD Validation Loss: 0.4365
OOD Test ROC-AUC: 0.6820
OOD Test Loss: 0.6119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.2539
ID Validation ROC-AUC: 0.8928
ID Validation Loss: 0.2745
ID Test ROC-AUC: 0.8905
ID Test Loss: 0.2822
OOD Validation ROC-AUC: 0.6800
OOD Validation Loss: 0.3263
OOD Test ROC-AUC: 0.7103
OOD Test Loss: 0.5223

[0m[1;37mINFO[0m: [1mChartInfo 0.9232 0.6820 0.8905 0.7103 0.8928 0.6800[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:09:43 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:31.039489
Plausibility completed in  0:09:37.392774
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5367, device='cuda:1')  +-  tensor(0.0552, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 0.998 +- 0.015
Intervened Stability MCC for r=0.3 = 0.846 +- 0.130
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.900 +- 0.084
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.878176
Plausibility completed in  0:09:39.603529
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8505, device='cuda:1')  +-  tensor(0.0457, device='cuda:1') (0.013)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.828 +- 0.150
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.945 +- 0.047
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:33:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:10 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:40 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:50 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:01 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:23 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9685
Train Loss: 0.1653
ID Validation ROC-AUC: 0.9224
ID Validation Loss: 0.2315
ID Test ROC-AUC: 0.9196
ID Test Loss: 0.2391
OOD Validation ROC-AUC: 0.6434
OOD Validation Loss: 0.3691
OOD Test ROC-AUC: 0.6778
OOD Test Loss: 0.5284

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8955
Train Loss: 0.2439
ID Validation ROC-AUC: 0.8855
ID Validation Loss: 0.2541
ID Test ROC-AUC: 0.8869
ID Test Loss: 0.2554
OOD Validation ROC-AUC: 0.6944
OOD Validation Loss: 0.2933
OOD Test ROC-AUC: 0.7180
OOD Test Loss: 0.4561

[0m[1;37mINFO[0m: [1mChartInfo 0.9196 0.6778 0.8869 0.7180 0.8855 0.6944[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:34:49 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.196560
Plausibility completed in  0:09:47.626105
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5299, device='cuda:1')  +-  tensor(0.0575, device='cuda:1') (0.021)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.779 +- 0.167
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.856 +- 0.108
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.594887
Plausibility completed in  0:09:47.820717
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8406, device='cuda:1')  +-  tensor(0.0469, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.756 +- 0.181
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.922 +- 0.057
Num considered samples: 11314

\FINISHED LBAPcore - CIGAvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.47064147 0.78715104] +- [0.0265129  0.02136482] (mean across ratios: 0.63 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.51865764 0.83360221] +- [0.02507396 0.01896384] (mean across ratios: 0.68 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99873418 0.99931338] +- [9.66190520e-05 7.61966868e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.87581751 0.92959886] +- [0.02117312 0.01110787] (mean across ratios: 0.90 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99815185 0.99819695] +- [0.00014253 0.00020166] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.80931352 0.78034785] +- [0.03254045 0.03463039] (mean across ratios: 0.79 +- 0.02)

Overall time of execution:  2:04:46.846465
DONE CIGA LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:58:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:58:39 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:59:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:59:21 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:59:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:59:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:02 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:02 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 02:00:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1597
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2366
ID Test ROC-AUC: 0.9233
ID Test Loss: 0.2412
OOD Validation ROC-AUC: 0.6572
OOD Validation Loss: 0.3846
OOD Test ROC-AUC: 0.6967
OOD Test Loss: 0.5574

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ROC-AUC: 0.8713
Train Loss: 0.2869
ID Validation ROC-AUC: 0.8665
ID Validation Loss: 0.2911
ID Test ROC-AUC: 0.8695
ID Test Loss: 0.2927
OOD Validation ROC-AUC: 0.6861
OOD Validation Loss: 0.2792
OOD Test ROC-AUC: 0.7034
OOD Test Loss: 0.4207

[0m[1;37mINFO[0m: [1mChartInfo 0.9233 0.6967 0.8695 0.7034 0.8665 0.6861[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:00:04 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.286886
Plausibility completed in  0:09:18.132341
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5822, device='cuda:1')  +-  tensor(0.0726, device='cuda:1') (0.032)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.680 +- 0.198
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.812 +- 0.115
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.638798
Plausibility completed in  0:08:58.359243
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9034, device='cuda:1')  +-  tensor(0.0449, device='cuda:1') (0.021)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.638 +- 0.267
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.929 +- 0.050
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 02:22:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:11 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:41 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:02 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:18 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.9829
Train Loss: 0.1261
ID Validation ROC-AUC: 0.9196
ID Validation Loss: 0.2917
ID Test ROC-AUC: 0.9170
ID Test Loss: 0.3056
OOD Validation ROC-AUC: 0.6433
OOD Validation Loss: 0.4965
OOD Test ROC-AUC: 0.6785
OOD Test Loss: 0.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8825
Train Loss: 0.2710
ID Validation ROC-AUC: 0.8746
ID Validation Loss: 0.2831
ID Test ROC-AUC: 0.8768
ID Test Loss: 0.2841
OOD Validation ROC-AUC: 0.6840
OOD Validation Loss: 0.3139
OOD Test ROC-AUC: 0.7101
OOD Test Loss: 0.4991

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.6785 0.8768 0.7101 0.8746 0.6840[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:23:33 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.737212
Plausibility completed in  0:09:15.512706
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5868, device='cuda:1')  +-  tensor(0.0664, device='cuda:1') (0.024)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.765 +- 0.179
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.861 +- 0.105
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.006994
Plausibility completed in  0:08:59.253220
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8948, device='cuda:1')  +-  tensor(0.0513, device='cuda:1') (0.015)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.694 +- 0.270
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.938 +- 0.053
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 02:45:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 02:45:38 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 02:46:09 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 02:46:19 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 02:46:29 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 02:46:45 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9540
Train Loss: 0.1749
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2164
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2244
OOD Validation ROC-AUC: 0.6596
OOD Validation Loss: 0.3480
OOD Test ROC-AUC: 0.6987
OOD Test Loss: 0.4931

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8972
Train Loss: 0.2438
ID Validation ROC-AUC: 0.8845
ID Validation Loss: 0.2539
ID Test ROC-AUC: 0.8865
ID Test Loss: 0.2549
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2839
OOD Test ROC-AUC: 0.7162
OOD Test Loss: 0.4332

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.6987 0.8865 0.7162 0.8845 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:47:00 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.712938
Plausibility completed in  0:09:17.144937
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5414, device='cuda:1')  +-  tensor(0.0827, device='cuda:1') (0.026)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.644 +- 0.220
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.788 +- 0.130
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.527907
Plausibility completed in  0:08:59.174096
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8734, device='cuda:1')  +-  tensor(0.0620, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.599 +- 0.291
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.918 +- 0.062
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:09:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 03:09:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 03:09:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 03:09:47 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 03:09:57 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 31...
[0m[1;37mINFO[0m: [1mCheckpoint 31: 
-----------------------------------
Train ROC-AUC: 0.9785
Train Loss: 0.1297
ID Validation ROC-AUC: 0.9231
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9232
ID Test Loss: 0.2591
OOD Validation ROC-AUC: 0.6355
OOD Validation Loss: 0.4365
OOD Test ROC-AUC: 0.6820
OOD Test Loss: 0.6119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.2539
ID Validation ROC-AUC: 0.8928
ID Validation Loss: 0.2745
ID Test ROC-AUC: 0.8905
ID Test Loss: 0.2822
OOD Validation ROC-AUC: 0.6800
OOD Validation Loss: 0.3263
OOD Test ROC-AUC: 0.7103
OOD Test Loss: 0.5223

[0m[1;37mINFO[0m: [1mChartInfo 0.9232 0.6820 0.8905 0.7103 0.8928 0.6800[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 03:10:29 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.578533
Plausibility completed in  0:09:20.761678
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5985, device='cuda:1')  +-  tensor(0.0710, device='cuda:1') (0.027)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.781 +- 0.160
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.871 +- 0.092
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.507111
Plausibility completed in  0:08:57.534825
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9054, device='cuda:1')  +-  tensor(0.0508, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.728 +- 0.255
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.947 +- 0.046
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:32:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 03:32:35 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:05 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:15 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:25 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:41 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:33:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9685
Train Loss: 0.1653
ID Validation ROC-AUC: 0.9224
ID Validation Loss: 0.2315
ID Test ROC-AUC: 0.9196
ID Test Loss: 0.2391
OOD Validation ROC-AUC: 0.6434
OOD Validation Loss: 0.3691
OOD Test ROC-AUC: 0.6778
OOD Test Loss: 0.5284

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8955
Train Loss: 0.2439
ID Validation ROC-AUC: 0.8855
ID Validation Loss: 0.2541
ID Test ROC-AUC: 0.8869
ID Test Loss: 0.2554
OOD Validation ROC-AUC: 0.6944
OOD Validation Loss: 0.2933
OOD Test ROC-AUC: 0.7180
OOD Test Loss: 0.4561

[0m[1;37mINFO[0m: [1mChartInfo 0.9196 0.6778 0.8869 0.7180 0.8855 0.6944[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 03:33:57 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.134860
Plausibility completed in  0:09:14.359427
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6109, device='cuda:1')  +-  tensor(0.0825, device='cuda:1') (0.032)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.673 +- 0.205
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.806 +- 0.122
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.937332
Plausibility completed in  0:08:56.520611
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9069, device='cuda:1')  +-  tensor(0.0532, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.628 +- 0.278
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.925 +- 0.056
Num considered samples: 11314

\FINISHED LBAPcore - CIGAvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.47064151 0.78715106] +- [0.02651289 0.02136481] (mean across ratios: 0.63 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.58396105 0.89676024] +- [0.0235099  0.01242229] (mean across ratios: 0.74 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99867951 0.99927258] +- [6.34544162e-05 5.36385507e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.8274465  0.93160526] +- [0.03219209 0.01017653] (mean across ratios: 0.88 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99807154 0.99808587] +- [9.39343514e-05 1.36150690e-04] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.70871389 0.65734483] +- [0.05419003 0.04691291] (mean across ratios: 0.68 +- 0.04)

Overall time of execution:  1:57:17.171359
DONE CIGA LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:56:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:56:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.9151
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8823
OOD Validation Loss: 0.6328
OOD Test ACCURACY: 0.8311
OOD Test Loss: 1.1309

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.9130
ID Test Loss: 0.4650
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6111
OOD Test ACCURACY: 0.8308
OOD Test Loss: 1.1121

[0m[1;37mINFO[0m: [1mChartInfo 0.9151 0.8311 0.9130 0.8308 0.9172 0.8837[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 03:56:17 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.422785
Plausibility completed in  0:00:16.490081
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0002, device='cuda:1')  +-  tensor(0.0006, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.430 +- 0.663
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.736 +- 0.310
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.326371
Plausibility completed in  0:00:16.308475
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0004, device='cuda:1')  +-  tensor(0.0011, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.379 +- 0.556
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.944 +- 0.118
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:57:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4149
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4712
OOD Validation ACCURACY: 0.8844
OOD Validation Loss: 0.6335
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.5522

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9206
ID Validation Loss: 0.4566
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5199
OOD Validation ACCURACY: 0.8857
OOD Validation Loss: 0.7013
OOD Test ACCURACY: 0.8256
OOD Test Loss: 1.5657

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.8226 0.9164 0.8256 0.9206 0.8857[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 03:57:10 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.314867
Plausibility completed in  0:00:16.439819
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2089, device='cuda:1')  +-  tensor(0.2996, device='cuda:1') (0.033)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.204 +- 0.696
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.628 +- 0.341
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.311480
Plausibility completed in  0:00:15.999397
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3226, device='cuda:1')  +-  tensor(0.4380, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 1.000 +- 0.019
Intervened Stability MCC for r=0.6 = 0.133 +- 0.509
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.889 +- 0.143
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:58:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.4089
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4793
OOD Validation ACCURACY: 0.8800
OOD Validation Loss: 0.6717
OOD Test ACCURACY: 0.8278
OOD Test Loss: 1.4934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0032
ID Validation ACCURACY: 0.9189
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9128
ID Test Loss: 0.3801
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.5452
OOD Test ACCURACY: 0.8331
OOD Test Loss: 1.2119

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.8278 0.9128 0.8331 0.9189 0.8837[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 03:58:01 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.163251
Plausibility completed in  0:00:16.381143
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1906, device='cuda:1')  +-  tensor(0.2649, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.954 +- 0.200
Intervened Stability MCC for r=0.3 = 0.561 +- 0.611
Original Stability F1 for r=0.3 = 0.974 +- 0.110
Intervened Stability F1 for r=0.3 = 0.792 +- 0.291
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.309762
Plausibility completed in  0:00:16.092757
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.4192, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.964 +- 0.173
Intervened Stability MCC for r=0.6 = 0.401 +- 0.545
Original Stability F1 for r=0.6 = 0.988 +- 0.057
Intervened Stability F1 for r=0.6 = 0.953 +- 0.106
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:58:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:52 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9225
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.9176
ID Test Loss: 0.4755
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.6167
OOD Test ACCURACY: 0.8206
OOD Test Loss: 1.3282

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9204
ID Validation Loss: 0.4402
ID Test ACCURACY: 0.9183
ID Test Loss: 0.5109
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6529
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.3708

[0m[1;37mINFO[0m: [1mChartInfo 0.9176 0.8206 0.9183 0.8255 0.9204 0.8846[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 03:58:53 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.152850
Plausibility completed in  0:00:16.258423
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1392, device='cuda:1')  +-  tensor(0.2133, device='cuda:1') (0.040)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.391 +- 0.674
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.314
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.298112
Plausibility completed in  0:00:15.960201
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2020, device='cuda:1')  +-  tensor(0.3036, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.222 +- 0.540
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.909 +- 0.138
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:59:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.4313
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4948
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.5415

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4301
ID Test ACCURACY: 0.9166
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8312
OOD Test Loss: 1.4830

[0m[1;37mINFO[0m: [1mChartInfo 0.9178 0.8338 0.9166 0.8312 0.9178 0.8847[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 03:59:44 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.350990
Plausibility completed in  0:00:16.347857
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0180, device='cuda:1')  +-  tensor(0.0619, device='cuda:1') (0.010)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.389 +- 0.696
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.716 +- 0.331
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.076103
Plausibility completed in  0:00:16.311198
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0316, device='cuda:1')  +-  tensor(0.1088, device='cuda:1') (0.009)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.287 +- 0.551
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.924 +- 0.129
Num considered samples: 1895

\FINISHED GOODSST2 - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.28659165 0.42958672] +- [0.21974039 0.31101357] (mean across ratios: 0.36 +- 0.19)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.11138941 0.17291781] +- [0.08674547 0.13508547] (mean across ratios: 0.14 +- 0.08)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99487607 0.99752835] +- [0.01024654 0.00485452] (mean across ratios: 1.00 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.7183238  0.92362173] +- [0.05295063 0.02310413] (mean across ratios: 0.82 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99076197 0.99265312] +- [0.01847606 0.01447488] (mean across ratios: 0.99 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.39492562 0.2842814 ] +- [0.11431029 0.09947539] (mean across ratios: 0.34 +- 0.08)

Overall time of execution:  0:04:21.302575
DONE LECI GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:00:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:00:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.9151
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8823
OOD Validation Loss: 0.6328
OOD Test ACCURACY: 0.8311
OOD Test Loss: 1.1309

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.9130
ID Test Loss: 0.4650
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6111
OOD Test ACCURACY: 0.8308
OOD Test Loss: 1.1121

[0m[1;37mINFO[0m: [1mChartInfo 0.9151 0.8311 0.9130 0.8308 0.9172 0.8837[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:00:51 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.627088
Plausibility completed in  0:00:17.014473
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0002, device='cuda:1')  +-  tensor(0.0006, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.430 +- 0.663
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.736 +- 0.310
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.530009
Plausibility completed in  0:00:16.486021
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0004, device='cuda:1')  +-  tensor(0.0011, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.379 +- 0.556
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.944 +- 0.118
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:01:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4149
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4712
OOD Validation ACCURACY: 0.8844
OOD Validation Loss: 0.6335
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.5522

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9206
ID Validation Loss: 0.4566
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5199
OOD Validation ACCURACY: 0.8857
OOD Validation Loss: 0.7013
OOD Test ACCURACY: 0.8256
OOD Test Loss: 1.5657

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.8226 0.9164 0.8256 0.9206 0.8857[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:01:44 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.565072
Plausibility completed in  0:00:16.790292
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2089, device='cuda:1')  +-  tensor(0.2996, device='cuda:1') (0.033)
Original Stability MCC for r=0.3 = 0.999 +- 0.023
Intervened Stability MCC for r=0.3 = 0.204 +- 0.696
Original Stability F1 for r=0.3 = 1.000 +- 0.011
Intervened Stability F1 for r=0.3 = 0.628 +- 0.341
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.538042
Plausibility completed in  0:00:16.559413
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3226, device='cuda:1')  +-  tensor(0.4380, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 1.000 +- 0.019
Intervened Stability MCC for r=0.6 = 0.133 +- 0.509
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.889 +- 0.143
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:02:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.4089
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4793
OOD Validation ACCURACY: 0.8800
OOD Validation Loss: 0.6717
OOD Test ACCURACY: 0.8278
OOD Test Loss: 1.4934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0032
ID Validation ACCURACY: 0.9189
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9128
ID Test Loss: 0.3801
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.5452
OOD Test ACCURACY: 0.8331
OOD Test Loss: 1.2119

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.8278 0.9128 0.8331 0.9189 0.8837[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:02:37 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.558210
Plausibility completed in  0:00:16.645263
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1909, device='cuda:1')  +-  tensor(0.2652, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.951 +- 0.209
Intervened Stability MCC for r=0.3 = 0.568 +- 0.609
Original Stability F1 for r=0.3 = 0.973 +- 0.115
Intervened Stability F1 for r=0.3 = 0.795 +- 0.291
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.303623
Plausibility completed in  0:00:16.576030
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3079, device='cuda:1')  +-  tensor(0.4191, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.963 +- 0.179
Intervened Stability MCC for r=0.6 = 0.400 +- 0.544
Original Stability F1 for r=0.6 = 0.987 +- 0.059
Intervened Stability F1 for r=0.6 = 0.953 +- 0.106
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:03:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:03:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:03:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9225
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.9176
ID Test Loss: 0.4755
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.6167
OOD Test ACCURACY: 0.8206
OOD Test Loss: 1.3282

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9204
ID Validation Loss: 0.4402
ID Test ACCURACY: 0.9183
ID Test Loss: 0.5109
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6529
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.3708

[0m[1;37mINFO[0m: [1mChartInfo 0.9176 0.8206 0.9183 0.8255 0.9204 0.8846[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:03:30 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.368377
Plausibility completed in  0:00:16.659569
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1392, device='cuda:1')  +-  tensor(0.2133, device='cuda:1') (0.040)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.391 +- 0.674
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.314
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.534716
Plausibility completed in  0:00:17.517972
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2020, device='cuda:1')  +-  tensor(0.3036, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.222 +- 0.540
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.909 +- 0.138
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:04:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.4313
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4948
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.5415

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4301
ID Test ACCURACY: 0.9166
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8312
OOD Test Loss: 1.4830

[0m[1;37mINFO[0m: [1mChartInfo 0.9178 0.8338 0.9166 0.8312 0.9178 0.8847[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:04:24 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.952105
Plausibility completed in  0:00:17.187568
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0180, device='cuda:1')  +-  tensor(0.0619, device='cuda:1') (0.010)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.389 +- 0.696
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.716 +- 0.331
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.888672
Plausibility completed in  0:00:17.441541
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0316, device='cuda:1')  +-  tensor(0.1088, device='cuda:1') (0.009)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.287 +- 0.551
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.924 +- 0.129
Num considered samples: 1895

\FINISHED GOODSST2 - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.28659165 0.42958672] +- [0.21974039 0.31101357] (mean across ratios: 0.36 +- 0.19)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.11143977 0.17289963] +- [0.08679151 0.13506728] (mean across ratios: 0.14 +- 0.08)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99449763 0.99745463] +- [0.01087197 0.00500194] (mean across ratios: 1.00 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71894015 0.92367499] +- [0.05383579 0.02317156] (mean across ratios: 0.82 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99003226 0.99241644] +- [0.01967271 0.01494821] (mean across ratios: 0.99 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.39633988 0.28418289] +- [0.11644494 0.09935997] (mean across ratios: 0.34 +- 0.08)

Overall time of execution:  0:04:34.141007
DONE LECI GOODSST2/length 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:05:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:05:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0025
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.5101
ID Test ACCURACY: 0.8987
ID Test Loss: 0.6337
OOD Validation ACCURACY: 0.8501
OOD Validation Loss: 1.2162
OOD Test ACCURACY: 0.7241
OOD Test Loss: 5.9794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0210
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3950
ID Test ACCURACY: 0.8921
ID Test Loss: 0.4835
OOD Validation ACCURACY: 0.8680
OOD Validation Loss: 0.6745
OOD Test ACCURACY: 0.7971
OOD Test Loss: 1.9556

[0m[1;37mINFO[0m: [1mChartInfo 0.8987 0.7241 0.8921 0.7971 0.9013 0.8680[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:05:39 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.529108
Plausibility completed in  0:00:16.558015
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1904, device='cuda:1')  +-  tensor(0.2638, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.143 +- 0.566
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.567 +- 0.309
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.403733
Plausibility completed in  0:00:16.121022
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3073, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.084 +- 0.414
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.874 +- 0.149
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:06:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.7707
ID Test ACCURACY: 0.9036
ID Test Loss: 0.8911
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.9645
OOD Test ACCURACY: 0.8288
OOD Test Loss: 1.5437

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9087
ID Validation Loss: 0.6769
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.8751
OOD Validation Loss: 0.7905
OOD Test ACCURACY: 0.8313
OOD Test Loss: 1.1097

[0m[1;37mINFO[0m: [1mChartInfo 0.9036 0.8288 0.9010 0.8313 0.9087 0.8751[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:06:32 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.384403
Plausibility completed in  0:00:16.661509
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.180 +- 0.561
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.591 +- 0.293
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.140831
Plausibility completed in  0:00:16.265330
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.119 +- 0.422
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.886 +- 0.141
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:07:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:07:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:07:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mChartInfo 0.9085 0.8129 0.9085 0.8129 0.9070 0.8698[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:07:24 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.411546
Plausibility completed in  0:00:16.444690
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.197 +- 0.550
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.592 +- 0.297
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.145846
Plausibility completed in  0:00:16.357426
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.119 +- 0.420
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.884 +- 0.141
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:08:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0001
ID Validation ACCURACY: 0.9147
ID Validation Loss: 0.6881
ID Test ACCURACY: 0.9072
ID Test Loss: 0.8292
OOD Validation ACCURACY: 0.8620
OOD Validation Loss: 1.4572
OOD Test ACCURACY: 0.8092
OOD Test Loss: 3.9476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9128
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9068
ID Test Loss: 0.8946
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 1.4169
OOD Test ACCURACY: 0.8193
OOD Test Loss: 3.6034

[0m[1;37mINFO[0m: [1mChartInfo 0.9072 0.8092 0.9068 0.8193 0.9128 0.8693[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:08:16 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.394965
Plausibility completed in  0:00:16.072688
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.087 +- 0.563
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.540 +- 0.307
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.350930
Plausibility completed in  0:00:16.035940
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4170, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.064 +- 0.407
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.870 +- 0.155
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:09:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:09:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.7434
ID Test ACCURACY: 0.9083
ID Test Loss: 0.7942
OOD Validation ACCURACY: 0.8622
OOD Validation Loss: 1.0214
OOD Test ACCURACY: 0.7831
OOD Test Loss: 1.9072

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9062
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9059
ID Test Loss: 0.8164
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 0.9364
OOD Test ACCURACY: 0.8087
OOD Test Loss: 1.4925

[0m[1;37mINFO[0m: [1mChartInfo 0.9083 0.7831 0.9059 0.8087 0.9062 0.8689[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:09:08 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.419038
Plausibility completed in  0:00:16.440623
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.171 +- 0.557
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.582 +- 0.294
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.365829
Plausibility completed in  0:00:16.384715
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.117 +- 0.427
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.881 +- 0.148
Num considered samples: 1895

\FINISHED GOODSST2 - GSATvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33941805 0.63096254] +- [0.0005286  0.00063554] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.19032106 0.30720393] +- [5.01977048e-05 2.83485769e-05] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999934] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.57458943 0.87898149] +- [0.01948705 0.0059836 ] (mean across ratios: 0.73 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15560809 0.10055974] +- [0.03854541 0.02260761] (mean across ratios: 0.13 +- 0.02)

Overall time of execution:  0:04:23.787363
DONE GSAT GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:10:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:10:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0025
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.5101
ID Test ACCURACY: 0.8987
ID Test Loss: 0.6337
OOD Validation ACCURACY: 0.8501
OOD Validation Loss: 1.2162
OOD Test ACCURACY: 0.7241
OOD Test Loss: 5.9794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0210
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3950
ID Test ACCURACY: 0.8921
ID Test Loss: 0.4835
OOD Validation ACCURACY: 0.8680
OOD Validation Loss: 0.6745
OOD Test ACCURACY: 0.7971
OOD Test Loss: 1.9556

[0m[1;37mINFO[0m: [1mChartInfo 0.8987 0.7241 0.8921 0.7971 0.9013 0.8680[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:10:14 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.566253
Plausibility completed in  0:00:16.585600
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1904, device='cuda:1')  +-  tensor(0.2638, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.143 +- 0.566
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.567 +- 0.309
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.211365
Plausibility completed in  0:00:16.425124
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3073, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.019
Intervened Stability MCC for r=0.6 = 0.084 +- 0.414
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.874 +- 0.149
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:11:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.7707
ID Test ACCURACY: 0.9036
ID Test Loss: 0.8911
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.9645
OOD Test ACCURACY: 0.8288
OOD Test Loss: 1.5437

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9087
ID Validation Loss: 0.6769
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.8751
OOD Validation Loss: 0.7905
OOD Test ACCURACY: 0.8313
OOD Test Loss: 1.1097

[0m[1;37mINFO[0m: [1mChartInfo 0.9036 0.8288 0.9010 0.8313 0.9087 0.8751[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:11:07 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.425012
Plausibility completed in  0:00:16.502092
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.180 +- 0.561
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.591 +- 0.293
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.185626
Plausibility completed in  0:00:16.323292
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.119 +- 0.422
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.886 +- 0.141
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:11:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mChartInfo 0.9085 0.8129 0.9085 0.8129 0.9070 0.8698[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:11:58 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.418275
Plausibility completed in  0:00:16.547548
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.197 +- 0.550
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.592 +- 0.297
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.173526
Plausibility completed in  0:00:16.421873
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.119 +- 0.420
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.884 +- 0.141
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:12:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0001
ID Validation ACCURACY: 0.9147
ID Validation Loss: 0.6881
ID Test ACCURACY: 0.9072
ID Test Loss: 0.8292
OOD Validation ACCURACY: 0.8620
OOD Validation Loss: 1.4572
OOD Test ACCURACY: 0.8092
OOD Test Loss: 3.9476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9128
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9068
ID Test Loss: 0.8946
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 1.4169
OOD Test ACCURACY: 0.8193
OOD Test Loss: 3.6034

[0m[1;37mINFO[0m: [1mChartInfo 0.9072 0.8092 0.9068 0.8193 0.9128 0.8693[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:12:49 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.429436
Plausibility completed in  0:00:16.389681
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.087 +- 0.563
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.540 +- 0.307
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.391802
Plausibility completed in  0:00:16.111570
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4170, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.064 +- 0.407
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.870 +- 0.155
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:13:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.7434
ID Test ACCURACY: 0.9083
ID Test Loss: 0.7942
OOD Validation ACCURACY: 0.8622
OOD Validation Loss: 1.0214
OOD Test ACCURACY: 0.7831
OOD Test Loss: 1.9072

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9062
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9059
ID Test Loss: 0.8164
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 0.9364
OOD Test ACCURACY: 0.8087
OOD Test Loss: 1.4925

[0m[1;37mINFO[0m: [1mChartInfo 0.9083 0.7831 0.9059 0.8087 0.9062 0.8689[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:13:41 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.266548
Plausibility completed in  0:00:16.489733
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.171 +- 0.557
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.582 +- 0.294
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.401935
Plausibility completed in  0:00:16.433535
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:1')  +-  tensor(0.4171, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.117 +- 0.427
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.881 +- 0.148
Num considered samples: 1895

\FINISHED GOODSST2 - GSATvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33941805 0.63096254] +- [0.0005286  0.00063554] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.19032106 0.30720393] +- [5.01977048e-05 2.83485769e-05] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99996417] +- [0.00000000e+00 7.03573227e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.57458943 0.87897855] +- [0.01948705 0.00598593] (mean across ratios: 0.73 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99991205] +- [0.         0.00017591] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15560809 0.10055447] +- [0.03854541 0.02261155] (mean across ratios: 0.13 +- 0.02)

Overall time of execution:  0:04:21.562834
DONE GSAT GOODSST2/length 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:14:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:14:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9479
Train Loss: 0.0807
ID Validation ACCURACY: 0.8570
ID Validation Loss: 0.6526
ID Test ACCURACY: 0.8504
ID Test Loss: 0.7123
OOD Validation ACCURACY: 0.8377
OOD Validation Loss: 0.8949
OOD Test ACCURACY: 0.7398
OOD Test Loss: 1.5170

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 71...
[0m[1;37mINFO[0m: [1mCheckpoint 71: 
-----------------------------------
Train ACCURACY: 0.9165
Train Loss: 0.1472
ID Validation ACCURACY: 0.8142
ID Validation Loss: 0.7736
ID Test ACCURACY: 0.8114
ID Test Loss: 0.8563
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7952
OOD Test ACCURACY: 0.8108
OOD Test Loss: 0.9714

[0m[1;37mINFO[0m: [1mChartInfo 0.8504 0.7398 0.8114 0.8108 0.8142 0.8439[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:14:49 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.486019
Plausibility completed in  0:00:16.258636
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2409, device='cuda:1')  +-  tensor(0.3439, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 0.997 +- 0.054
Intervened Stability MCC for r=0.3 = 0.812 +- 0.434
Original Stability F1 for r=0.3 = 0.998 +- 0.029
Intervened Stability F1 for r=0.3 = 0.912 +- 0.197
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.116854
Plausibility completed in  0:00:16.017104
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3257, device='cuda:1')  +-  tensor(0.4412, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.038
Intervened Stability MCC for r=0.6 = 0.495 +- 0.537
Original Stability F1 for r=0.6 = 1.000 +- 0.012
Intervened Stability F1 for r=0.6 = 0.970 +- 0.089
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:15:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0768
ID Validation ACCURACY: 0.8587
ID Validation Loss: 0.7200
ID Test ACCURACY: 0.8551
ID Test Loss: 0.8849
OOD Validation ACCURACY: 0.8472
OOD Validation Loss: 1.0741
OOD Test ACCURACY: 0.7967
OOD Test Loss: 1.3148

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0760
ID Validation ACCURACY: 0.8581
ID Validation Loss: 0.7569
ID Test ACCURACY: 0.8551
ID Test Loss: 0.9395
OOD Validation ACCURACY: 0.8551
OOD Validation Loss: 1.0513
OOD Test ACCURACY: 0.8051
OOD Test Loss: 1.2667

[0m[1;37mINFO[0m: [1mChartInfo 0.8551 0.7967 0.8551 0.8051 0.8581 0.8551[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:15:41 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.341192
Plausibility completed in  0:00:16.102211
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2483, device='cuda:1')  +-  tensor(0.3503, device='cuda:1') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.816 +- 0.430
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.915 +- 0.194
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.091808
Plausibility completed in  0:00:15.912203
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3283, device='cuda:1')  +-  tensor(0.4436, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.509 +- 0.532
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.974 +- 0.083
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:16:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:16:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.9479
Train Loss: 0.0798
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.6948
ID Test ACCURACY: 0.8576
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.8474
OOD Validation Loss: 1.0437
OOD Test ACCURACY: 0.8045
OOD Test Loss: 1.1397

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9461
Train Loss: 0.0840
ID Validation ACCURACY: 0.8459
ID Validation Loss: 0.7816
ID Test ACCURACY: 0.8498
ID Test Loss: 0.8524
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.9137
OOD Test ACCURACY: 0.8097
OOD Test Loss: 1.0383

[0m[1;37mINFO[0m: [1mChartInfo 0.8576 0.8045 0.8498 0.8097 0.8459 0.8581[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:16:32 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.369017
Plausibility completed in  0:00:16.095469
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2653, device='cuda:1')  +-  tensor(0.3816, device='cuda:1') (0.026)
Original Stability MCC for r=0.3 = 0.829 +- 0.405
Intervened Stability MCC for r=0.3 = 0.692 +- 0.526
Original Stability F1 for r=0.3 = 0.905 +- 0.224
Intervened Stability F1 for r=0.3 = 0.861 +- 0.235
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.315900
Plausibility completed in  0:00:15.781643
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3308, device='cuda:1')  +-  tensor(0.4511, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.902 +- 0.302
Intervened Stability MCC for r=0.6 = 0.442 +- 0.536
Original Stability F1 for r=0.6 = 0.972 +- 0.086
Intervened Stability F1 for r=0.6 = 0.963 +- 0.093
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:17:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:17:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.9483
Train Loss: 0.0792
ID Validation ACCURACY: 0.8604
ID Validation Loss: 0.6685
ID Test ACCURACY: 0.8570
ID Test Loss: 0.7609
OOD Validation ACCURACY: 0.8537
OOD Validation Loss: 0.9443
OOD Test ACCURACY: 0.8069
OOD Test Loss: 1.0629

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9462
Train Loss: 0.0915
ID Validation ACCURACY: 0.8478
ID Validation Loss: 0.6421
ID Test ACCURACY: 0.8480
ID Test Loss: 0.7499
OOD Validation ACCURACY: 0.8555
OOD Validation Loss: 0.7389
OOD Test ACCURACY: 0.8109
OOD Test Loss: 0.7657

[0m[1;37mINFO[0m: [1mChartInfo 0.8570 0.8069 0.8480 0.8109 0.8478 0.8555[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:17:23 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:04.201559
Plausibility completed in  0:00:15.984916
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2572, device='cuda:1')  +-  tensor(0.3696, device='cuda:1') (0.025)
Original Stability MCC for r=0.3 = 0.800 +- 0.428
Intervened Stability MCC for r=0.3 = 0.672 +- 0.531
Original Stability F1 for r=0.3 = 0.891 +- 0.230
Intervened Stability F1 for r=0.3 = 0.852 +- 0.238
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.308447
Plausibility completed in  0:00:15.957929
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3291, device='cuda:1')  +-  tensor(0.4475, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.887 +- 0.317
Intervened Stability MCC for r=0.6 = 0.453 +- 0.532
Original Stability F1 for r=0.6 = 0.969 +- 0.087
Intervened Stability F1 for r=0.6 = 0.966 +- 0.088
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:18:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:18:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9443
Train Loss: 0.0872
ID Validation ACCURACY: 0.8447
ID Validation Loss: 0.7583
ID Test ACCURACY: 0.8393
ID Test Loss: 0.8682
OOD Validation ACCURACY: 0.7661
OOD Validation Loss: 1.6477
OOD Test ACCURACY: 0.6583
OOD Test Loss: 3.1226

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9332
Train Loss: 0.1117
ID Validation ACCURACY: 0.8306
ID Validation Loss: 0.6694
ID Test ACCURACY: 0.8312
ID Test Loss: 0.7076
OOD Validation ACCURACY: 0.8233
OOD Validation Loss: 0.9547
OOD Test ACCURACY: 0.7755
OOD Test Loss: 1.3760

[0m[1;37mINFO[0m: [1mChartInfo 0.8393 0.6583 0.8312 0.7755 0.8306 0.8233[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:18:15 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.385318
Plausibility completed in  0:00:16.085617
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2222, device='cuda:1')  +-  tensor(0.3377, device='cuda:1') (0.027)
Original Stability MCC for r=0.3 = 0.660 +- 0.539
Intervened Stability MCC for r=0.3 = 0.562 +- 0.591
Original Stability F1 for r=0.3 = 0.815 +- 0.290
Intervened Stability F1 for r=0.3 = 0.807 +- 0.261
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.111345
Plausibility completed in  0:00:16.078547
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3012, device='cuda:1')  +-  tensor(0.4314, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.720 +- 0.481
Intervened Stability MCC for r=0.6 = 0.380 +- 0.524
Original Stability F1 for r=0.6 = 0.926 +- 0.130
Intervened Stability F1 for r=0.6 = 0.956 +- 0.094
Num considered samples: 1895

\FINISHED GOODSST2 - CIGAvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.56257191 0.76085423] +- [0.04927908 0.05239369] (mean across ratios: 0.66 +- 0.04)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.24678245 0.32301483] +- [0.01478042 0.01101626] (mean across ratios: 0.28 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.92173722 0.97345362] +- [0.07015238 0.02702702] (mean across ratios: 0.95 +- 0.04)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.86938754 0.96585886] +- [0.04026353 0.0063092 ] (mean across ratios: 0.92 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.8572687  0.90146298] +- [0.12863564 0.1021976 ] (mean across ratios: 0.88 +- 0.08)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.71078387 0.45564635] +- [0.09522848 0.04533454] (mean across ratios: 0.58 +- 0.05)

Overall time of execution:  0:04:20.556063
DONE CIGA GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:19:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:19:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9479
Train Loss: 0.0807
ID Validation ACCURACY: 0.8570
ID Validation Loss: 0.6526
ID Test ACCURACY: 0.8504
ID Test Loss: 0.7123
OOD Validation ACCURACY: 0.8377
OOD Validation Loss: 0.8949
OOD Test ACCURACY: 0.7398
OOD Test Loss: 1.5170

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 71...
[0m[1;37mINFO[0m: [1mCheckpoint 71: 
-----------------------------------
Train ACCURACY: 0.9165
Train Loss: 0.1472
ID Validation ACCURACY: 0.8142
ID Validation Loss: 0.7736
ID Test ACCURACY: 0.8114
ID Test Loss: 0.8563
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7952
OOD Test ACCURACY: 0.8108
OOD Test Loss: 0.9714

[0m[1;37mINFO[0m: [1mChartInfo 0.8504 0.7398 0.8114 0.8108 0.8142 0.8439[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:19:20 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.564960
Plausibility completed in  0:00:16.267752
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2409, device='cuda:1')  +-  tensor(0.3439, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 0.997 +- 0.054
Intervened Stability MCC for r=0.3 = 0.812 +- 0.434
Original Stability F1 for r=0.3 = 0.998 +- 0.029
Intervened Stability F1 for r=0.3 = 0.912 +- 0.197
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.188835
Plausibility completed in  0:00:16.096134
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3257, device='cuda:1')  +-  tensor(0.4412, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.038
Intervened Stability MCC for r=0.6 = 0.495 +- 0.537
Original Stability F1 for r=0.6 = 1.000 +- 0.012
Intervened Stability F1 for r=0.6 = 0.970 +- 0.089
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:20:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0768
ID Validation ACCURACY: 0.8587
ID Validation Loss: 0.7200
ID Test ACCURACY: 0.8551
ID Test Loss: 0.8849
OOD Validation ACCURACY: 0.8472
OOD Validation Loss: 1.0741
OOD Test ACCURACY: 0.7967
OOD Test Loss: 1.3148

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0760
ID Validation ACCURACY: 0.8581
ID Validation Loss: 0.7569
ID Test ACCURACY: 0.8551
ID Test Loss: 0.9395
OOD Validation ACCURACY: 0.8551
OOD Validation Loss: 1.0513
OOD Test ACCURACY: 0.8051
OOD Test Loss: 1.2667

[0m[1;37mINFO[0m: [1mChartInfo 0.8551 0.7967 0.8551 0.8051 0.8581 0.8551[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:20:12 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.403509
Plausibility completed in  0:00:16.154656
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2483, device='cuda:1')  +-  tensor(0.3503, device='cuda:1') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.816 +- 0.430
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.915 +- 0.194
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.174408
Plausibility completed in  0:00:15.979605
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3283, device='cuda:1')  +-  tensor(0.4436, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.509 +- 0.532
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.974 +- 0.083
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:21:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.9479
Train Loss: 0.0798
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.6948
ID Test ACCURACY: 0.8576
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.8474
OOD Validation Loss: 1.0437
OOD Test ACCURACY: 0.8045
OOD Test Loss: 1.1397

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9461
Train Loss: 0.0840
ID Validation ACCURACY: 0.8459
ID Validation Loss: 0.7816
ID Test ACCURACY: 0.8498
ID Test Loss: 0.8524
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.9137
OOD Test ACCURACY: 0.8097
OOD Test Loss: 1.0383

[0m[1;37mINFO[0m: [1mChartInfo 0.8576 0.8045 0.8498 0.8097 0.8459 0.8581[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:21:03 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.424283
Plausibility completed in  0:00:16.171752
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2653, device='cuda:1')  +-  tensor(0.3816, device='cuda:1') (0.026)
Original Stability MCC for r=0.3 = 0.829 +- 0.405
Intervened Stability MCC for r=0.3 = 0.692 +- 0.526
Original Stability F1 for r=0.3 = 0.905 +- 0.224
Intervened Stability F1 for r=0.3 = 0.861 +- 0.235
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.386409
Plausibility completed in  0:00:15.825301
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3308, device='cuda:1')  +-  tensor(0.4511, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.902 +- 0.302
Intervened Stability MCC for r=0.6 = 0.442 +- 0.536
Original Stability F1 for r=0.6 = 0.972 +- 0.086
Intervened Stability F1 for r=0.6 = 0.963 +- 0.093
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:21:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:21:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.9483
Train Loss: 0.0792
ID Validation ACCURACY: 0.8604
ID Validation Loss: 0.6685
ID Test ACCURACY: 0.8570
ID Test Loss: 0.7609
OOD Validation ACCURACY: 0.8537
OOD Validation Loss: 0.9443
OOD Test ACCURACY: 0.8069
OOD Test Loss: 1.0629

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9462
Train Loss: 0.0915
ID Validation ACCURACY: 0.8478
ID Validation Loss: 0.6421
ID Test ACCURACY: 0.8480
ID Test Loss: 0.7499
OOD Validation ACCURACY: 0.8555
OOD Validation Loss: 0.7389
OOD Test ACCURACY: 0.8109
OOD Test Loss: 0.7657

[0m[1;37mINFO[0m: [1mChartInfo 0.8570 0.8069 0.8480 0.8109 0.8478 0.8555[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:21:54 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.464560
Plausibility completed in  0:00:16.133150
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2572, device='cuda:1')  +-  tensor(0.3696, device='cuda:1') (0.025)
Original Stability MCC for r=0.3 = 0.800 +- 0.428
Intervened Stability MCC for r=0.3 = 0.672 +- 0.531
Original Stability F1 for r=0.3 = 0.891 +- 0.230
Intervened Stability F1 for r=0.3 = 0.852 +- 0.238
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.376325
Plausibility completed in  0:00:16.049765
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3291, device='cuda:1')  +-  tensor(0.4475, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.887 +- 0.317
Intervened Stability MCC for r=0.6 = 0.453 +- 0.532
Original Stability F1 for r=0.6 = 0.969 +- 0.087
Intervened Stability F1 for r=0.6 = 0.966 +- 0.088
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:22:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9443
Train Loss: 0.0872
ID Validation ACCURACY: 0.8447
ID Validation Loss: 0.7583
ID Test ACCURACY: 0.8393
ID Test Loss: 0.8682
OOD Validation ACCURACY: 0.7661
OOD Validation Loss: 1.6477
OOD Test ACCURACY: 0.6583
OOD Test Loss: 3.1226

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9332
Train Loss: 0.1117
ID Validation ACCURACY: 0.8306
ID Validation Loss: 0.6694
ID Test ACCURACY: 0.8312
ID Test Loss: 0.7076
OOD Validation ACCURACY: 0.8233
OOD Validation Loss: 0.9547
OOD Test ACCURACY: 0.7755
OOD Test Loss: 1.3760

[0m[1;37mINFO[0m: [1mChartInfo 0.8393 0.6583 0.8312 0.7755 0.8306 0.8233[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 04:22:45 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.481932
Plausibility completed in  0:00:16.163051
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2222, device='cuda:1')  +-  tensor(0.3377, device='cuda:1') (0.027)
Original Stability MCC for r=0.3 = 0.660 +- 0.539
Intervened Stability MCC for r=0.3 = 0.562 +- 0.591
Original Stability F1 for r=0.3 = 0.815 +- 0.290
Intervened Stability F1 for r=0.3 = 0.807 +- 0.261
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.152523
Plausibility completed in  0:00:16.264425
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3012, device='cuda:1')  +-  tensor(0.4314, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.720 +- 0.481
Intervened Stability MCC for r=0.6 = 0.380 +- 0.524
Original Stability F1 for r=0.6 = 0.926 +- 0.130
Intervened Stability F1 for r=0.6 = 0.956 +- 0.094
Num considered samples: 1895

\FINISHED GOODSST2 - CIGAvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.56257192 0.76085423] +- [0.04927896 0.05239369] (mean across ratios: 0.66 +- 0.04)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.24678245 0.32301483] +- [0.01478042 0.01101626] (mean across ratios: 0.28 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.92173722 0.97345362] +- [0.07015238 0.02702702] (mean across ratios: 0.95 +- 0.04)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.86938754 0.96585886] +- [0.04026353 0.0063092 ] (mean across ratios: 0.92 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.8572687  0.90146298] +- [0.12863564 0.1021976 ] (mean across ratios: 0.88 +- 0.08)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.71078387 0.45564635] +- [0.09522848 0.04533454] (mean across ratios: 0.58 +- 0.05)

Overall time of execution:  0:04:18.897346
DONE CIGA GOODSST2/length 0.10
DONE all :)
