nohup: ignoring input
Time to evaluate models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5235
ID Validation ACCURACY: 0.8683
ID Validation Loss: 0.5030
ID Test ACCURACY: 0.8607
ID Test Loss: 0.5282
OOD Validation ACCURACY: 0.8537
OOD Validation Loss: 0.6475
OOD Test ACCURACY: 0.5690
OOD Test Loss: 1.2550

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.8449
Train Loss: 0.5037
ID Validation ACCURACY: 0.8490
ID Validation Loss: 0.4950
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5158
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.5724
OOD Test ACCURACY: 0.8553
OOD Test Loss: 0.5144

[0m[1;37mINFO[0m: [1mChartInfo 0.8607 0.5690 0.8447 0.8553 0.8490 0.8813[0mId_val ACCURACY: 0.8683Id_val Loss: 0.5030
Id_test ACCURACY: 0.8607Id_test Loss: 0.5282
Test ACCURACY: 0.5690Test Loss: 1.2551


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.4062
ID Test ACCURACY: 0.9043
ID Test Loss: 0.4406
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.4153
OOD Test ACCURACY: 0.9043
OOD Test Loss: 0.4070

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8882
Train Loss: 0.4551
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4382
ID Test ACCURACY: 0.8887
ID Test Loss: 0.4541
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4551
OOD Test ACCURACY: 0.9143
OOD Test Loss: 0.3807

[0m[1;37mINFO[0m: [1mChartInfo 0.9043 0.9043 0.8887 0.9143 0.8927 0.9283[0mId_val ACCURACY: 0.9113Id_val Loss: 0.4062
Id_test ACCURACY: 0.9043Id_test Loss: 0.4406
Test ACCURACY: 0.9043Test Loss: 0.4070


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.8349
Train Loss: 0.5629
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.5385
ID Test ACCURACY: 0.8290
ID Test Loss: 0.5847
OOD Validation ACCURACY: 0.7613
OOD Validation Loss: 0.7380
OOD Test ACCURACY: 0.7983
OOD Test Loss: 0.5704

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.8374
Train Loss: 0.5193
ID Validation ACCURACY: 0.8337
ID Validation Loss: 0.5058
ID Test ACCURACY: 0.8260
ID Test Loss: 0.5460
OOD Validation ACCURACY: 0.8300
OOD Validation Loss: 0.6757
OOD Test ACCURACY: 0.8513
OOD Test Loss: 0.4627

[0m[1;37mINFO[0m: [1mChartInfo 0.8290 0.7983 0.8260 0.8513 0.8337 0.8300[0mId_val ACCURACY: 0.8423Id_val Loss: 0.5387
Id_test ACCURACY: 0.8293Id_test Loss: 0.5848
Test ACCURACY: 0.7983Test Loss: 0.5704


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8396
Train Loss: 0.5054
ID Validation ACCURACY: 0.8567
ID Validation Loss: 0.4677
ID Test ACCURACY: 0.8283
ID Test Loss: 0.5320
OOD Validation ACCURACY: 0.7540
OOD Validation Loss: 0.7147
OOD Test ACCURACY: 0.8567
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8396
Train Loss: 0.5054
ID Validation ACCURACY: 0.8567
ID Validation Loss: 0.4677
ID Test ACCURACY: 0.8283
ID Test Loss: 0.5320
OOD Validation ACCURACY: 0.7540
OOD Validation Loss: 0.7147
OOD Test ACCURACY: 0.8567
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mChartInfo 0.8283 0.8567 0.8283 0.8567 0.8567 0.7540[0mId_val ACCURACY: 0.8567Id_val Loss: 0.4677
Id_test ACCURACY: 0.8283Id_test Loss: 0.5319
Test ACCURACY: 0.8567Test Loss: 0.4681


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.8734
Train Loss: 0.4599
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.4475
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4786
OOD Validation ACCURACY: 0.8663
OOD Validation Loss: 0.5284
OOD Test ACCURACY: 0.8430
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.8522
Train Loss: 0.4709
ID Validation ACCURACY: 0.8573
ID Validation Loss: 0.4632
ID Test ACCURACY: 0.8450
ID Test Loss: 0.4949
OOD Validation ACCURACY: 0.9020
OOD Validation Loss: 0.5173
OOD Test ACCURACY: 0.8550
OOD Test Loss: 0.5385

[0m[1;37mINFO[0m: [1mChartInfo 0.8727 0.8430 0.8450 0.8550 0.8573 0.9020[0mId_val ACCURACY: 0.8810Id_val Loss: 0.4475
Id_test ACCURACY: 0.8727Id_test Loss: 0.4786
Test ACCURACY: 0.8430Test Loss: 0.5743


Final accuracies: 
ID_VAL     = 0.872 +- 0.023
ID_TEST    = 0.859 +- 0.029
TEST       = 0.794 +- 0.118

Final losses: 
ID_VAL     = 0.4726 +- 0.0455
ID_TEST    = 0.5128 +- 0.0493
TEST       = 0.6550 +- 0.3067
Diff id_val-test  = 0.1824 
DONE EVAL LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8721
ID Validation Loss: 0.5525
ID Test ACCURACY: 0.8738
ID Test Loss: 0.6177
OOD Validation ACCURACY: 0.8730
OOD Validation Loss: 0.7070
OOD Test ACCURACY: 0.8114
OOD Test Loss: 1.1250

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8698
ID Validation Loss: 0.5684
ID Test ACCURACY: 0.8749
ID Test Loss: 0.6247
OOD Validation ACCURACY: 0.8748
OOD Validation Loss: 0.7016
OOD Test ACCURACY: 0.8157
OOD Test Loss: 1.0466

[0m[1;37mINFO[0m: [1mChartInfo 0.8738 0.8114 0.8749 0.8157 0.8698 0.8748[0mId_val ACCURACY: 0.8721Id_val Loss: 0.5525
Id_test ACCURACY: 0.8738Id_test Loss: 0.6177
Test ACCURACY: 0.8114Test Loss: 1.1252


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:16:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:16:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.9485
Train Loss: 0.0766
ID Validation ACCURACY: 0.8749
ID Validation Loss: 0.5049
ID Test ACCURACY: 0.8668
ID Test Loss: 0.5615
OOD Validation ACCURACY: 0.8653
OOD Validation Loss: 0.6072
OOD Test ACCURACY: 0.7872
OOD Test Loss: 0.9617

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0757
ID Validation ACCURACY: 0.8723
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8719
ID Test Loss: 0.6128
OOD Validation ACCURACY: 0.8778
OOD Validation Loss: 0.6058
OOD Test ACCURACY: 0.8173
OOD Test Loss: 0.8048

[0m[1;37mINFO[0m: [1mChartInfo 0.8668 0.7872 0.8719 0.8173 0.8723 0.8778[0mId_val ACCURACY: 0.8749Id_val Loss: 0.5049
Id_test ACCURACY: 0.8668Id_test Loss: 0.5616
Test ACCURACY: 0.7872Test Loss: 0.9619


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:17:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8755
ID Validation Loss: 0.5193
ID Test ACCURACY: 0.8710
ID Test Loss: 0.6143
OOD Validation ACCURACY: 0.8741
OOD Validation Loss: 0.6579
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8713
ID Validation Loss: 0.4845
ID Test ACCURACY: 0.8713
ID Test Loss: 0.5534
OOD Validation ACCURACY: 0.8785
OOD Validation Loss: 0.6028
OOD Test ACCURACY: 0.8218
OOD Test Loss: 0.7450

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.7991 0.8713 0.8218 0.8713 0.8785[0mId_val ACCURACY: 0.8757Id_val Loss: 0.5193
Id_test ACCURACY: 0.8710Id_test Loss: 0.6142
Test ACCURACY: 0.7991Test Loss: 1.0164


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:17:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4723
OOD Validation ACCURACY: 0.8786
OOD Validation Loss: 0.5089
OOD Test ACCURACY: 0.8355
OOD Test Loss: 0.5859

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4723
OOD Validation ACCURACY: 0.8786
OOD Validation Loss: 0.5089
OOD Test ACCURACY: 0.8355
OOD Test Loss: 0.5859

[0m[1;37mINFO[0m: [1mChartInfo 0.8727 0.8355 0.8727 0.8355 0.8764 0.8786[0mId_val ACCURACY: 0.8764Id_val Loss: 0.4270
Id_test ACCURACY: 0.8725Id_test Loss: 0.4723
Test ACCURACY: 0.8355Test Loss: 0.5859


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:17:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0764
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4746
ID Test ACCURACY: 0.8687
ID Test Loss: 0.5282
OOD Validation ACCURACY: 0.8716
OOD Validation Loss: 0.5888
OOD Test ACCURACY: 0.8079
OOD Test Loss: 0.8214

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0760
ID Validation ACCURACY: 0.8732
ID Validation Loss: 0.4817
ID Test ACCURACY: 0.8685
ID Test Loss: 0.5451
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.5826
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.6909

[0m[1;37mINFO[0m: [1mChartInfo 0.8687 0.8079 0.8685 0.8277 0.8732 0.8787[0mId_val ACCURACY: 0.8761Id_val Loss: 0.4746
Id_test ACCURACY: 0.8687Id_test Loss: 0.5282
Test ACCURACY: 0.8079Test Loss: 0.8214


Final accuracies: 
ID_VAL     = 0.875 +- 0.002
ID_TEST    = 0.871 +- 0.003
TEST       = 0.808 +- 0.016

Final losses: 
ID_VAL     = 0.4957 +- 0.0425
ID_TEST    = 0.5588 +- 0.0547
TEST       = 0.9022 +- 0.1860
Diff id_val-test  = 0.4065 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE EVAL LECI GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:17:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:17:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9169
Train Loss: 0.2213
ID Validation ROC-AUC: 0.8917
ID Validation Loss: 0.2544
ID Test ROC-AUC: 0.8970
ID Test Loss: 0.2524
OOD Validation ROC-AUC: 0.6382
OOD Validation Loss: 0.3929
OOD Test ROC-AUC: 0.6940
OOD Test Loss: 0.5070

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.8609
Train Loss: 0.2974
ID Validation ROC-AUC: 0.8471
ID Validation Loss: 0.3106
ID Test ROC-AUC: 0.8565
ID Test Loss: 0.3081
OOD Validation ROC-AUC: 0.6770
OOD Validation Loss: 0.3063
OOD Test ROC-AUC: 0.6903
OOD Test Loss: 0.5439

[0m[1;37mINFO[0m: [1mChartInfo 0.8970 0.6940 0.8565 0.6903 0.8471 0.6770[0mId_val ROC-AUC: 0.7275Id_val Loss: 0.6532
Id_test ROC-AUC: 0.7408Id_test Loss: 0.6593
Test ROC-AUC: 0.6020Test Loss: 0.9540


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:18:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ROC-AUC: 0.9177
Train Loss: 0.2213
ID Validation ROC-AUC: 0.8918
ID Validation Loss: 0.2573
ID Test ROC-AUC: 0.8984
ID Test Loss: 0.2518
OOD Validation ROC-AUC: 0.6468
OOD Validation Loss: 0.3762
OOD Test ROC-AUC: 0.6919
OOD Test Loss: 0.5107

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ROC-AUC: 0.8920
Train Loss: 0.2449
ID Validation ROC-AUC: 0.8753
ID Validation Loss: 0.2636
ID Test ROC-AUC: 0.8793
ID Test Loss: 0.2613
OOD Validation ROC-AUC: 0.6705
OOD Validation Loss: 0.3458
OOD Test ROC-AUC: 0.7046
OOD Test Loss: 0.4816

[0m[1;37mINFO[0m: [1mChartInfo 0.8984 0.6919 0.8793 0.7046 0.8753 0.6705[0mId_val ROC-AUC: 0.7624Id_val Loss: 0.7284
Id_test ROC-AUC: 0.7677Id_test Loss: 0.7418
Test ROC-AUC: 0.6058Test Loss: 1.0769


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:18:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ROC-AUC: 0.9167
Train Loss: 0.2199
ID Validation ROC-AUC: 0.8927
ID Validation Loss: 0.2531
ID Test ROC-AUC: 0.8965
ID Test Loss: 0.2508
OOD Validation ROC-AUC: 0.6401
OOD Validation Loss: 0.3915
OOD Test ROC-AUC: 0.6865
OOD Test Loss: 0.5100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ROC-AUC: 0.8702
Train Loss: 0.2826
ID Validation ROC-AUC: 0.8547
ID Validation Loss: 0.2953
ID Test ROC-AUC: 0.8658
ID Test Loss: 0.2920
OOD Validation ROC-AUC: 0.6717
OOD Validation Loss: 0.3020
OOD Test ROC-AUC: 0.6881
OOD Test Loss: 0.5174

[0m[1;37mINFO[0m: [1mChartInfo 0.8965 0.6865 0.8658 0.6881 0.8547 0.6717[0mId_val ROC-AUC: 0.6455Id_val Loss: 0.4862
Id_test ROC-AUC: 0.6510Id_test Loss: 0.4927
Test ROC-AUC: 0.5448Test Loss: 0.7004


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:18:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9170
Train Loss: 0.2226
ID Validation ROC-AUC: 0.8917
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8960
ID Test Loss: 0.2545
OOD Validation ROC-AUC: 0.6425
OOD Validation Loss: 0.4071
OOD Test ROC-AUC: 0.6986
OOD Test Loss: 0.5143

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ROC-AUC: 0.8702
Train Loss: 0.2691
ID Validation ROC-AUC: 0.8562
ID Validation Loss: 0.2805
ID Test ROC-AUC: 0.8672
ID Test Loss: 0.2773
OOD Validation ROC-AUC: 0.6673
OOD Validation Loss: 0.3080
OOD Test ROC-AUC: 0.6889
OOD Test Loss: 0.4959

[0m[1;37mINFO[0m: [1mChartInfo 0.8960 0.6986 0.8672 0.6889 0.8562 0.6673[0mId_val ROC-AUC: 0.7347Id_val Loss: 0.6142
Id_test ROC-AUC: 0.7401Id_test Loss: 0.6266
Test ROC-AUC: 0.6122Test Loss: 0.9019


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 14:18:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 02:18:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ROC-AUC: 0.9165
Train Loss: 0.2206
ID Validation ROC-AUC: 0.8913
ID Validation Loss: 0.2538
ID Test ROC-AUC: 0.8969
ID Test Loss: 0.2504
OOD Validation ROC-AUC: 0.6290
OOD Validation Loss: 0.3879
OOD Test ROC-AUC: 0.6928
OOD Test Loss: 0.5115

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ROC-AUC: 0.8628
Train Loss: 0.2911
ID Validation ROC-AUC: 0.8493
ID Validation Loss: 0.3012
ID Test ROC-AUC: 0.8611
ID Test Loss: 0.2996
OOD Validation ROC-AUC: 0.6659
OOD Validation Loss: 0.3055
OOD Test ROC-AUC: 0.6840
OOD Test Loss: 0.5249

[0m[1;37mINFO[0m: [1mChartInfo 0.8969 0.6928 0.8611 0.6840 0.8493 0.6659[0mId_val ROC-AUC: 0.7627Id_val Loss: 0.6470
Id_test ROC-AUC: 0.7648Id_test Loss: 0.6572
Test ROC-AUC: 0.6009Test Loss: 0.9682


Final accuracies: 
ID_VAL     = 0.727 +- 0.043
ID_TEST    = 0.733 +- 0.043
TEST       = 0.593 +- 0.024

Final losses: 
ID_VAL     = 0.6258 +- 0.0792
ID_TEST    = 0.6355 +- 0.0810
TEST       = 0.9203 +- 0.1238
Diff id_val-test  = 0.2945 
DONE EVAL LECI LBAPcore/assay
DONE all :)
