nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 1649269

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 14:43:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 02:43:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.097
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.110
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.110


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.001
SUFF_SIMPLE for r=0.6 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.6 all KL = 0.019 +- 0.078 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.6 all L1 = 0.144 +- 0.037 (in-sample avg dev_std = 0.071)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.001
SUFF_SIMPLE for r=0.5 class 1.0 = 0.143 +- 0.078 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.5 all KL = 0.019 +- 0.078 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.5 all L1 = 0.143 +- 0.037 (in-sample avg dev_std = 0.060)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.583
SUFF_SIMPLE for r=0.6 class 1.0 = 0.774 +- 0.436 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.6 all KL = 0.73 +- 0.436 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.6 all L1 = 0.774 +- 0.370 (in-sample avg dev_std = 0.172)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.58
SUFF_SIMPLE for r=0.5 class 1.0 = 0.773 +- 0.437 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.5 all KL = 0.731 +- 0.437 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.5 all L1 = 0.773 +- 0.371 (in-sample avg dev_std = 0.163)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.338
NEC for r=0.6 class 1.0 = 0.583 +- 0.429 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all KL = 0.687 +- 0.429 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all L1 = 0.583 +- 0.381 (in-sample avg dev_std = 0.114)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.094
NEC for r=0.5 class 1.0 = 0.788 +- 0.238 (in-sample avg dev_std = 0.240)
NEC for r=0.5 all KL = 0.92 +- 0.238 (in-sample avg dev_std = 0.240)
NEC for r=0.5 all L1 = 0.788 +- 0.214 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09688808664259928
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.023
NEC for r=0.4 class 1.0 = 0.85 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all KL = 0.98 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all L1 = 0.85 +- 0.039 (in-sample avg dev_std = 0.290)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09688808664259928
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.023
NEC for r=0.3 class 1.0 = 0.85 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.3 all KL = 0.98 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.3 all L1 = 0.85 +- 0.039 (in-sample avg dev_std = 0.290)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.076
NEC for r=0.6 class 1.0 = 0.595 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.659 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.595 +- 0.359 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.036
NEC for r=0.5 class 1.0 = 0.626 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.695 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.626 +- 0.347 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.724
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.808
NEC for r=0.6 class 1.0 = 0.063 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.075 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.063 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.797
NEC for r=0.5 class 1.0 = 0.095 +- 0.302 (in-sample avg dev_std = 0.020)
NEC for r=0.5 all KL = 0.113 +- 0.302 (in-sample avg dev_std = 0.020)
NEC for r=0.5 all L1 = 0.095 +- 0.256 (in-sample avg dev_std = 0.020)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11026742301458671
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.653
NEC for r=0.4 class 1.0 = 0.165 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all KL = 0.2 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all L1 = 0.165 +- 0.325 (in-sample avg dev_std = 0.212)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11026742301458671
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.653
NEC for r=0.3 class 1.0 = 0.165 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all KL = 0.2 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all L1 = 0.165 +- 0.325 (in-sample avg dev_std = 0.212)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 14:47:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 02:47:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.145
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.107
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.103
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.155
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.121
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.117
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.117


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.094
SUFF_SIMPLE for r=0.6 class 1.0 = 0.215 +- 0.280 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.092 +- 0.280 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.215 +- 0.244 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10736823104693141
len(reference) = 98
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.5 =  0.898
SUFF_SIMPLE for r=0.5 class 1.0 = 0.893 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.849 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.893 +- 0.247 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.008
SUFF_SIMPLE for r=0.6 class 1.0 = 0.557 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.557 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.595
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013078174603174605
len(reference) = 158
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.5 =  0.335
SUFF_SIMPLE for r=0.5 class 1.0 = 0.724 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.726 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.724 +- 0.306 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.803
SUFF_SIMPLE for r=0.6 class 1.0 = 0.903 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.884 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.903 +- 0.261 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.881
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.12139262560777957
len(reference) = 1149
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.845
SUFF_SIMPLE for r=0.5 class 1.0 = 0.958 +- 0.179 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.955 +- 0.179 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.958 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.023
NEC for r=0.6 class 1.0 = 0.856 +- 0.018 (in-sample avg dev_std = 0.289)
NEC for r=0.6 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.289)
NEC for r=0.6 all L1 = 0.856 +- 0.017 (in-sample avg dev_std = 0.289)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10736823104693141
len(reference) = 277
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.5 =  0.036
NEC for r=0.5 class 1.0 = 0.852 +- 0.018 (in-sample avg dev_std = 0.353)
NEC for r=0.5 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.353)
NEC for r=0.5 all L1 = 0.852 +- 0.025 (in-sample avg dev_std = 0.353)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10349097472924189
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.035
NEC for r=0.4 class 1.0 = 0.853 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.4 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.4 all L1 = 0.853 +- 0.022 (in-sample avg dev_std = 0.352)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10349097472924189
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.035
NEC for r=0.3 class 1.0 = 0.853 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all L1 = 0.853 +- 0.022 (in-sample avg dev_std = 0.352)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.465
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013078174603174605
len(reference) = 2520
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.465
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013076587301587303
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013076587301587303
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.654
NEC for r=0.6 class 1.0 = 0.177 +- 0.403 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all KL = 0.215 +- 0.403 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all L1 = 0.177 +- 0.335 (in-sample avg dev_std = 0.203)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.846
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.12139262560777957
len(reference) = 2468
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.658
NEC for r=0.5 class 1.0 = 0.174 +- 0.402 (in-sample avg dev_std = 0.204)
NEC for r=0.5 all KL = 0.214 +- 0.402 (in-sample avg dev_std = 0.204)
NEC for r=0.5 all L1 = 0.174 +- 0.331 (in-sample avg dev_std = 0.204)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.846
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11721029173419774
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.657
NEC for r=0.4 class 1.0 = 0.174 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all KL = 0.211 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all L1 = 0.174 +- 0.333 (in-sample avg dev_std = 0.200)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.846
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11721029173419774
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.657
NEC for r=0.3 class 1.0 = 0.174 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.211 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.174 +- 0.333 (in-sample avg dev_std = 0.200)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 14:51:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 02:51:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.092
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.105


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.6 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.008)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.5 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.008)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.001
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all L1 = 0.143 +- 0.035 (in-sample avg dev_std = 0.060)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.59
SUFF_SIMPLE for r=0.6 class 1.0 = 0.789 +- 0.424 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all KL = 0.748 +- 0.424 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all L1 = 0.789 +- 0.358 (in-sample avg dev_std = 0.168)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.59
SUFF_SIMPLE for r=0.5 class 1.0 = 0.789 +- 0.424 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.5 all KL = 0.748 +- 0.424 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.5 all L1 = 0.789 +- 0.358 (in-sample avg dev_std = 0.168)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.587
SUFF_SIMPLE for r=0.4 class 1.0 = 0.788 +- 0.424 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 all KL = 0.751 +- 0.424 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 all L1 = 0.788 +- 0.360 (in-sample avg dev_std = 0.153)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.29
NEC for r=0.6 class 1.0 = 0.638 +- 0.388 (in-sample avg dev_std = 0.133)
NEC for r=0.6 all KL = 0.752 +- 0.388 (in-sample avg dev_std = 0.133)
NEC for r=0.6 all L1 = 0.638 +- 0.341 (in-sample avg dev_std = 0.133)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.29
NEC for r=0.5 class 1.0 = 0.638 +- 0.388 (in-sample avg dev_std = 0.133)
NEC for r=0.5 all KL = 0.752 +- 0.388 (in-sample avg dev_std = 0.133)
NEC for r=0.5 all L1 = 0.638 +- 0.341 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.078
NEC for r=0.4 class 1.0 = 0.803 +- 0.220 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all KL = 0.928 +- 0.220 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all L1 = 0.803 +- 0.190 (in-sample avg dev_std = 0.200)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.996
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09193862815884478
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.021
NEC for r=0.3 class 1.0 = 0.85 +- 0.071 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.978 +- 0.071 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.85 +- 0.037 (in-sample avg dev_std = 0.265)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.041
NEC for r=0.6 class 1.0 = 0.6 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.64 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.6 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.041
NEC for r=0.5 class 1.0 = 0.6 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.64 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.6 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.01
NEC for r=0.4 class 1.0 = 0.625 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.669 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.625 +- 0.331 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012926190476190475
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.629 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.672 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.629 +- 0.330 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.795
NEC for r=0.6 class 1.0 = 0.075 +- 0.267 (in-sample avg dev_std = 0.006)
NEC for r=0.6 all KL = 0.088 +- 0.267 (in-sample avg dev_std = 0.006)
NEC for r=0.6 all L1 = 0.075 +- 0.231 (in-sample avg dev_std = 0.006)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.815
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.795
NEC for r=0.5 class 1.0 = 0.075 +- 0.267 (in-sample avg dev_std = 0.006)
NEC for r=0.5 all KL = 0.088 +- 0.267 (in-sample avg dev_std = 0.006)
NEC for r=0.5 all L1 = 0.075 +- 0.231 (in-sample avg dev_std = 0.006)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.815
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.798
NEC for r=0.4 class 1.0 = 0.1 +- 0.307 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all KL = 0.118 +- 0.307 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all L1 = 0.1 +- 0.267 (in-sample avg dev_std = 0.023)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10485737439222043
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.66
NEC for r=0.3 class 1.0 = 0.148 +- 0.375 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.179 +- 0.375 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.148 +- 0.310 (in-sample avg dev_std = 0.194)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 14:55:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 02:55:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.087
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.099


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.001
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.6 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.060)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.001
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.5 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.060)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.042)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.588
SUFF_SIMPLE for r=0.6 class 1.0 = 0.78 +- 0.428 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.6 all KL = 0.739 +- 0.428 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.6 all L1 = 0.78 +- 0.363 (in-sample avg dev_std = 0.164)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.825
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.588
SUFF_SIMPLE for r=0.5 class 1.0 = 0.78 +- 0.428 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.5 all KL = 0.739 +- 0.428 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.5 all L1 = 0.78 +- 0.363 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.587
SUFF_SIMPLE for r=0.4 class 1.0 = 0.779 +- 0.428 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.428 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.365 (in-sample avg dev_std = 0.166)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.317
NEC for r=0.6 class 1.0 = 0.604 +- 0.411 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all KL = 0.708 +- 0.411 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all L1 = 0.604 +- 0.365 (in-sample avg dev_std = 0.124)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.317
NEC for r=0.5 class 1.0 = 0.604 +- 0.411 (in-sample avg dev_std = 0.124)
NEC for r=0.5 all KL = 0.708 +- 0.411 (in-sample avg dev_std = 0.124)
NEC for r=0.5 all L1 = 0.604 +- 0.365 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.09
NEC for r=0.4 class 1.0 = 0.792 +- 0.219 (in-sample avg dev_std = 0.235)
NEC for r=0.4 all KL = 0.924 +- 0.219 (in-sample avg dev_std = 0.235)
NEC for r=0.4 all L1 = 0.792 +- 0.201 (in-sample avg dev_std = 0.235)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.08690974729241878
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.024
NEC for r=0.3 class 1.0 = 0.847 +- 0.081 (in-sample avg dev_std = 0.282)
NEC for r=0.3 all KL = 0.974 +- 0.081 (in-sample avg dev_std = 0.282)
NEC for r=0.3 all L1 = 0.847 +- 0.042 (in-sample avg dev_std = 0.282)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.015
NEC for r=0.6 class 1.0 = 0.254 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.25 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.254 +- 0.345 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.015
NEC for r=0.5 class 1.0 = 0.254 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.25 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.254 +- 0.345 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.004
NEC for r=0.4 class 1.0 = 0.262 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.259 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.262 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.254
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012841269841269841
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.261 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.257 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.261 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.795
NEC for r=0.6 class 1.0 = 0.075 +- 0.264 (in-sample avg dev_std = 0.003)
NEC for r=0.6 all KL = 0.086 +- 0.264 (in-sample avg dev_std = 0.003)
NEC for r=0.6 all L1 = 0.075 +- 0.229 (in-sample avg dev_std = 0.003)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.822
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.795
NEC for r=0.5 class 1.0 = 0.075 +- 0.264 (in-sample avg dev_std = 0.003)
NEC for r=0.5 all KL = 0.086 +- 0.264 (in-sample avg dev_std = 0.003)
NEC for r=0.5 all L1 = 0.075 +- 0.229 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.822
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.794
NEC for r=0.4 class 1.0 = 0.098 +- 0.302 (in-sample avg dev_std = 0.016)
NEC for r=0.4 all KL = 0.112 +- 0.302 (in-sample avg dev_std = 0.016)
NEC for r=0.4 all L1 = 0.098 +- 0.264 (in-sample avg dev_std = 0.016)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.822
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09927066450567261
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 1.0 = 0.157 +- 0.381 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.188 +- 0.381 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.157 +- 0.317 (in-sample avg dev_std = 0.193)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 14:59:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 02:59:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.042)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.589
SUFF_SIMPLE for r=0.6 class 1.0 = 0.784 +- 0.429 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.6 all KL = 0.741 +- 0.429 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.6 all L1 = 0.784 +- 0.364 (in-sample avg dev_std = 0.165)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.589
SUFF_SIMPLE for r=0.5 class 1.0 = 0.784 +- 0.429 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.5 all KL = 0.741 +- 0.429 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.5 all L1 = 0.784 +- 0.364 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF_SIMPLE for r=0.4 class 1.0 = 0.782 +- 0.431 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all KL = 0.742 +- 0.431 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all L1 = 0.782 +- 0.366 (in-sample avg dev_std = 0.168)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.322
NEC for r=0.6 class 1.0 = 0.595 +- 0.414 (in-sample avg dev_std = 0.150)
NEC for r=0.6 all KL = 0.704 +- 0.414 (in-sample avg dev_std = 0.150)
NEC for r=0.6 all L1 = 0.595 +- 0.370 (in-sample avg dev_std = 0.150)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.322
NEC for r=0.5 class 1.0 = 0.595 +- 0.414 (in-sample avg dev_std = 0.150)
NEC for r=0.5 all KL = 0.704 +- 0.414 (in-sample avg dev_std = 0.150)
NEC for r=0.5 all L1 = 0.595 +- 0.370 (in-sample avg dev_std = 0.150)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.105
NEC for r=0.4 class 1.0 = 0.781 +- 0.234 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all KL = 0.918 +- 0.234 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all L1 = 0.781 +- 0.216 (in-sample avg dev_std = 0.262)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.989
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09388086642599279
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.03
NEC for r=0.3 class 1.0 = 0.845 +- 0.085 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all KL = 0.976 +- 0.085 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all L1 = 0.845 +- 0.049 (in-sample avg dev_std = 0.328)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.038
NEC for r=0.6 class 1.0 = 0.485 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.51 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.485 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.038
NEC for r=0.5 class 1.0 = 0.485 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.51 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.485 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.008
NEC for r=0.4 class 1.0 = 0.507 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.536 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.507 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012959126984126983
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.507 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.536 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.507 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.808
NEC for r=0.6 class 1.0 = 0.06 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.071 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.06 +- 0.202 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.826
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.808
NEC for r=0.5 class 1.0 = 0.06 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.071 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.06 +- 0.202 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.826
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.799
NEC for r=0.4 class 1.0 = 0.088 +- 0.289 (in-sample avg dev_std = 0.015)
NEC for r=0.4 all KL = 0.101 +- 0.289 (in-sample avg dev_std = 0.015)
NEC for r=0.4 all L1 = 0.088 +- 0.250 (in-sample avg dev_std = 0.015)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10702552674230147
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.66
NEC for r=0.3 class 1.0 = 0.153 +- 0.381 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all KL = 0.187 +- 0.381 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all L1 = 0.153 +- 0.317 (in-sample avg dev_std = 0.197)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:03:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:03:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.141 +- 0.046 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.6 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.6 all L1 = 0.141 +- 0.017 (in-sample avg dev_std = 0.037)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.141 +- 0.046 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.5 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.5 all L1 = 0.141 +- 0.017 (in-sample avg dev_std = 0.037)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.14 +- 0.046 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all L1 = 0.14 +- 0.017 (in-sample avg dev_std = 0.010)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.585
SUFF_SIMPLE for r=0.6 class 1.0 = 0.772 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all KL = 0.731 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all L1 = 0.772 +- 0.367 (in-sample avg dev_std = 0.168)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.585
SUFF_SIMPLE for r=0.5 class 1.0 = 0.772 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.5 all KL = 0.731 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.5 all L1 = 0.772 +- 0.367 (in-sample avg dev_std = 0.168)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.584
SUFF_SIMPLE for r=0.4 class 1.0 = 0.772 +- 0.431 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all KL = 0.734 +- 0.431 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all L1 = 0.772 +- 0.368 (in-sample avg dev_std = 0.154)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.355
NEC for r=0.6 class 1.0 = 0.585 +- 0.419 (in-sample avg dev_std = 0.142)
NEC for r=0.6 all KL = 0.686 +- 0.419 (in-sample avg dev_std = 0.142)
NEC for r=0.6 all L1 = 0.585 +- 0.371 (in-sample avg dev_std = 0.142)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.355
NEC for r=0.5 class 1.0 = 0.585 +- 0.419 (in-sample avg dev_std = 0.142)
NEC for r=0.5 all KL = 0.686 +- 0.419 (in-sample avg dev_std = 0.142)
NEC for r=0.5 all L1 = 0.585 +- 0.371 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.1
NEC for r=0.4 class 1.0 = 0.787 +- 0.224 (in-sample avg dev_std = 0.247)
NEC for r=0.4 all KL = 0.923 +- 0.224 (in-sample avg dev_std = 0.247)
NEC for r=0.4 all L1 = 0.787 +- 0.212 (in-sample avg dev_std = 0.247)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09389891696750903
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.028
NEC for r=0.3 class 1.0 = 0.851 +- 0.046 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all KL = 0.983 +- 0.046 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all L1 = 0.851 +- 0.024 (in-sample avg dev_std = 0.310)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.027
NEC for r=0.6 class 1.0 = 0.401 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.395 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.401 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.027
NEC for r=0.5 class 1.0 = 0.401 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.395 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.401 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.004
NEC for r=0.4 class 1.0 = 0.417 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.416 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012961904761904763
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.415 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.81
NEC for r=0.6 class 1.0 = 0.071 +- 0.246 (in-sample avg dev_std = 0.002)
NEC for r=0.6 all KL = 0.08 +- 0.246 (in-sample avg dev_std = 0.002)
NEC for r=0.6 all L1 = 0.071 +- 0.211 (in-sample avg dev_std = 0.002)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.831
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.81
NEC for r=0.5 class 1.0 = 0.071 +- 0.246 (in-sample avg dev_std = 0.002)
NEC for r=0.5 all KL = 0.08 +- 0.246 (in-sample avg dev_std = 0.002)
NEC for r=0.5 all L1 = 0.071 +- 0.211 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.799
NEC for r=0.4 class 1.0 = 0.098 +- 0.294 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all KL = 0.112 +- 0.294 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all L1 = 0.098 +- 0.256 (in-sample avg dev_std = 0.023)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10701701782820097
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.656
NEC for r=0.3 class 1.0 = 0.165 +- 0.384 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.197 +- 0.384 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.165 +- 0.323 (in-sample avg dev_std = 0.194)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:06:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:06:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.6 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.042)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.5 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.042)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.042)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.3 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.3 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.593
SUFF_SIMPLE for r=0.6 class 1.0 = 0.792 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 all KL = 0.749 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 all L1 = 0.792 +- 0.356 (in-sample avg dev_std = 0.158)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.817
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.593
SUFF_SIMPLE for r=0.5 class 1.0 = 0.792 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.5 all KL = 0.749 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.5 all L1 = 0.792 +- 0.356 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.817
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.593
SUFF_SIMPLE for r=0.4 class 1.0 = 0.792 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.4 all KL = 0.749 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.4 all L1 = 0.792 +- 0.356 (in-sample avg dev_std = 0.158)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.3 =  0.593
SUFF_SIMPLE for r=0.3 class 1.0 = 0.792 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.3 all KL = 0.749 +- 0.423 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.3 all L1 = 0.792 +- 0.356 (in-sample avg dev_std = 0.158)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.31
NEC for r=0.6 class 1.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.6 all KL = 0.728 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.6 all L1 = 0.616 +- 0.363 (in-sample avg dev_std = 0.155)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.31
NEC for r=0.5 class 1.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.5 all KL = 0.728 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.5 all L1 = 0.616 +- 0.363 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.31
NEC for r=0.4 class 1.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.4 all KL = 0.728 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.4 all L1 = 0.616 +- 0.363 (in-sample avg dev_std = 0.155)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.3 =  0.31
NEC for r=0.3 class 1.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.728 +- 0.409 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.616 +- 0.363 (in-sample avg dev_std = 0.155)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.097
NEC for r=0.6 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.097
NEC for r=0.5 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.097
NEC for r=0.4 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.6 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.6 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.013)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.814
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.793
NEC for r=0.5 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.5 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.5 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.013)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.814
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.793
NEC for r=0.4 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.4 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.4 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.013)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.3 =  0.793
NEC for r=0.3 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.3 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.013)
NEC for r=0.3 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.013)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:10:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:10:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.139 +- 0.034 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.6 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.6 all L1 = 0.139 +- 0.012 (in-sample avg dev_std = 0.027)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.139 +- 0.034 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.5 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.5 all L1 = 0.139 +- 0.012 (in-sample avg dev_std = 0.027)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.139 +- 0.034 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.4 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.4 all L1 = 0.139 +- 0.012 (in-sample avg dev_std = 0.027)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.588
SUFF_SIMPLE for r=0.6 class 1.0 = 0.76 +- 0.443 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.6 all KL = 0.711 +- 0.443 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.6 all L1 = 0.76 +- 0.375 (in-sample avg dev_std = 0.164)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.855
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.588
SUFF_SIMPLE for r=0.5 class 1.0 = 0.76 +- 0.443 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.5 all KL = 0.711 +- 0.443 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.5 all L1 = 0.76 +- 0.375 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.855
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.588
SUFF_SIMPLE for r=0.4 class 1.0 = 0.76 +- 0.443 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 all KL = 0.711 +- 0.443 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 all L1 = 0.76 +- 0.375 (in-sample avg dev_std = 0.164)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.356
NEC for r=0.6 class 1.0 = 0.568 +- 0.447 (in-sample avg dev_std = 0.147)
NEC for r=0.6 all KL = 0.673 +- 0.447 (in-sample avg dev_std = 0.147)
NEC for r=0.6 all L1 = 0.568 +- 0.393 (in-sample avg dev_std = 0.147)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.356
NEC for r=0.5 class 1.0 = 0.568 +- 0.447 (in-sample avg dev_std = 0.147)
NEC for r=0.5 all KL = 0.673 +- 0.447 (in-sample avg dev_std = 0.147)
NEC for r=0.5 all L1 = 0.568 +- 0.393 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.356
NEC for r=0.4 class 1.0 = 0.568 +- 0.447 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all KL = 0.673 +- 0.447 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all L1 = 0.568 +- 0.393 (in-sample avg dev_std = 0.147)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0951768953068592
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.038
NEC for r=0.3 class 1.0 = 0.85 +- 0.035 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all KL = 0.991 +- 0.035 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all L1 = 0.85 +- 0.024 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.01
NEC for r=0.6 class 1.0 = 0.158 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.152 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.158 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.01
NEC for r=0.5 class 1.0 = 0.158 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.152 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.158 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.01
NEC for r=0.4 class 1.0 = 0.158 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.152 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.158 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012976587301587305
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.161 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.155 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.161 +- 0.297 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.817
NEC for r=0.6 class 1.0 = 0.068 +- 0.251 (in-sample avg dev_std = 0.004)
NEC for r=0.6 all KL = 0.079 +- 0.251 (in-sample avg dev_std = 0.004)
NEC for r=0.6 all L1 = 0.068 +- 0.217 (in-sample avg dev_std = 0.004)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.851
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.817
NEC for r=0.5 class 1.0 = 0.068 +- 0.251 (in-sample avg dev_std = 0.004)
NEC for r=0.5 all KL = 0.079 +- 0.251 (in-sample avg dev_std = 0.004)
NEC for r=0.5 all L1 = 0.068 +- 0.217 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.851
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.817
NEC for r=0.4 class 1.0 = 0.068 +- 0.251 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all KL = 0.079 +- 0.251 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all L1 = 0.068 +- 0.217 (in-sample avg dev_std = 0.004)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.851
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10844165316045382
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.658
NEC for r=0.3 class 1.0 = 0.178 +- 0.402 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.214 +- 0.402 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.178 +- 0.337 (in-sample avg dev_std = 0.195)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:14:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:14:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.145
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.145
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.105
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.101
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.155
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.155
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.119
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.115


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.083
SUFF_SIMPLE for r=0.6 class 1.0 = 0.206 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.082 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.206 +- 0.228 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.083
SUFF_SIMPLE for r=0.5 class 1.0 = 0.206 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.082 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.206 +- 0.228 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1054187725631769
len(reference) = 98
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.4 =  0.867
SUFF_SIMPLE for r=0.4 class 1.0 = 0.861 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.818 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.861 +- 0.277 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.004
SUFF_SIMPLE for r=0.6 class 1.0 = 0.874 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.877 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.874 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.004
SUFF_SIMPLE for r=0.5 class 1.0 = 0.874 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.877 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.874 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.152
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013048809523809525
len(reference) = 158
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.4 =  0.063
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.892 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.797
SUFF_SIMPLE for r=0.6 class 1.0 = 0.907 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.894 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.907 +- 0.257 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.838
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.5 =  0.797
SUFF_SIMPLE for r=0.5 class 1.0 = 0.907 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.894 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.907 +- 0.257 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.866
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11942625607779578
len(reference) = 1149
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.4 =  0.833
SUFF_SIMPLE for r=0.4 class 1.0 = 0.958 +- 0.192 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.949 +- 0.192 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.958 +- 0.156 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.026
NEC for r=0.6 class 1.0 = 0.855 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all L1 = 0.855 +- 0.017 (in-sample avg dev_std = 0.312)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.026
NEC for r=0.5 class 1.0 = 0.855 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.5 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.5 all L1 = 0.855 +- 0.017 (in-sample avg dev_std = 0.312)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1054187725631769
len(reference) = 277
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.4 =  0.036
NEC for r=0.4 class 1.0 = 0.851 +- 0.021 (in-sample avg dev_std = 0.363)
NEC for r=0.4 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.363)
NEC for r=0.4 all L1 = 0.851 +- 0.023 (in-sample avg dev_std = 0.363)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10110108303249099
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.027
NEC for r=0.3 class 1.0 = 0.854 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.854 +- 0.020 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.113
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013048809523809525
len(reference) = 2520
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0130484126984127
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.651
NEC for r=0.6 class 1.0 = 0.169 +- 0.395 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all KL = 0.205 +- 0.395 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all L1 = 0.169 +- 0.329 (in-sample avg dev_std = 0.199)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.5 =  0.651
NEC for r=0.5 class 1.0 = 0.169 +- 0.395 (in-sample avg dev_std = 0.199)
NEC for r=0.5 all KL = 0.205 +- 0.395 (in-sample avg dev_std = 0.199)
NEC for r=0.5 all L1 = 0.169 +- 0.329 (in-sample avg dev_std = 0.199)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11942625607779578
len(reference) = 2468
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.4 =  0.657
NEC for r=0.4 class 1.0 = 0.164 +- 0.393 (in-sample avg dev_std = 0.206)
NEC for r=0.4 all KL = 0.204 +- 0.393 (in-sample avg dev_std = 0.206)
NEC for r=0.4 all L1 = 0.164 +- 0.323 (in-sample avg dev_std = 0.206)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11474027552674232
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.658
NEC for r=0.3 class 1.0 = 0.164 +- 0.393 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all KL = 0.201 +- 0.393 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all L1 = 0.164 +- 0.323 (in-sample avg dev_std = 0.211)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:18:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:18:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.6 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.6 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.009)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.5 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.5 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.009)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.4 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.042)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.586
SUFF_SIMPLE for r=0.6 class 1.0 = 0.784 +- 0.425 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.6 all KL = 0.746 +- 0.425 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.6 all L1 = 0.784 +- 0.362 (in-sample avg dev_std = 0.160)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.82
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.586
SUFF_SIMPLE for r=0.5 class 1.0 = 0.784 +- 0.425 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.5 all KL = 0.746 +- 0.425 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.5 all L1 = 0.784 +- 0.362 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.82
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.585
SUFF_SIMPLE for r=0.4 class 1.0 = 0.782 +- 0.428 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all KL = 0.745 +- 0.428 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all L1 = 0.782 +- 0.363 (in-sample avg dev_std = 0.165)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.333
NEC for r=0.6 class 1.0 = 0.595 +- 0.414 (in-sample avg dev_std = 0.118)
NEC for r=0.6 all KL = 0.707 +- 0.414 (in-sample avg dev_std = 0.118)
NEC for r=0.6 all L1 = 0.595 +- 0.371 (in-sample avg dev_std = 0.118)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.333
NEC for r=0.5 class 1.0 = 0.595 +- 0.414 (in-sample avg dev_std = 0.118)
NEC for r=0.5 all KL = 0.707 +- 0.414 (in-sample avg dev_std = 0.118)
NEC for r=0.5 all L1 = 0.595 +- 0.371 (in-sample avg dev_std = 0.118)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.089
NEC for r=0.4 class 1.0 = 0.796 +- 0.217 (in-sample avg dev_std = 0.240)
NEC for r=0.4 all KL = 0.933 +- 0.217 (in-sample avg dev_std = 0.240)
NEC for r=0.4 all L1 = 0.796 +- 0.198 (in-sample avg dev_std = 0.240)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0936750902527076
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.028
NEC for r=0.3 class 1.0 = 0.849 +- 0.071 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.982 +- 0.071 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.849 +- 0.040 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.007
NEC for r=0.6 class 1.0 = 0.106 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.104 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.106 +- 0.253 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.007
NEC for r=0.5 class 1.0 = 0.106 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.104 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.106 +- 0.253 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.002
NEC for r=0.4 class 1.0 = 0.11 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.109 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012958730158730157
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.795
NEC for r=0.6 class 1.0 = 0.075 +- 0.263 (in-sample avg dev_std = 0.001)
NEC for r=0.6 all KL = 0.085 +- 0.263 (in-sample avg dev_std = 0.001)
NEC for r=0.6 all L1 = 0.075 +- 0.228 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.816
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.795
NEC for r=0.5 class 1.0 = 0.075 +- 0.263 (in-sample avg dev_std = 0.001)
NEC for r=0.5 all KL = 0.085 +- 0.263 (in-sample avg dev_std = 0.001)
NEC for r=0.5 all L1 = 0.075 +- 0.228 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.796
NEC for r=0.4 class 1.0 = 0.1 +- 0.306 (in-sample avg dev_std = 0.018)
NEC for r=0.4 all KL = 0.116 +- 0.306 (in-sample avg dev_std = 0.018)
NEC for r=0.4 all L1 = 0.1 +- 0.265 (in-sample avg dev_std = 0.018)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10676337115072931
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.657
NEC for r=0.3 class 1.0 = 0.154 +- 0.379 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.186 +- 0.379 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.154 +- 0.314 (in-sample avg dev_std = 0.200)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.019, 0.019, 1.0, 1.0], 'all_L1': [0.144, 0.143, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.092, 0.849, 1.0, 1.0], 'all_L1': [0.215, 0.893, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.021, 1.0], 'all_L1': [0.143, 0.143, 0.143, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.026, 0.026, 1.0], 'all_L1': [0.145, 0.145, 0.145, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.024, 1.0], 'all_L1': [0.145, 0.145, 0.145, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.016, 0.016, 1.0], 'all_L1': [0.141, 0.141, 0.14, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.021, 0.021], 'all_L1': [0.144, 0.144, 0.144, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.009, 1.0], 'all_L1': [0.139, 0.139, 0.139, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.082, 0.818, 1.0], 'all_L1': [0.206, 0.206, 0.861, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.017, 0.017, 1.0], 'all_L1': [0.142, 0.142, 0.142, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.687, 0.92, 0.98, 0.98], 'all_L1': [0.583, 0.788, 0.85, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.996, 0.996, 0.996], 'all_L1': [0.856, 0.852, 0.853, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.752, 0.752, 0.928, 0.978], 'all_L1': [0.638, 0.638, 0.803, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.708, 0.924, 0.974], 'all_L1': [0.604, 0.604, 0.792, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.704, 0.918, 0.976], 'all_L1': [0.595, 0.595, 0.781, 0.845]}), defaultdict(<class 'list'>, {'all_KL': [0.686, 0.686, 0.923, 0.983], 'all_L1': [0.585, 0.585, 0.787, 0.851]}), defaultdict(<class 'list'>, {'all_KL': [0.728, 0.728, 0.728, 0.728], 'all_L1': [0.616, 0.616, 0.616, 0.616]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.673, 0.673, 0.991], 'all_L1': [0.568, 0.568, 0.568, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.994, 0.994, 0.994], 'all_L1': [0.855, 0.855, 0.851, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.707, 0.933, 0.982], 'all_L1': [0.595, 0.595, 0.796, 0.849]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.284, 0.284, 1.0, 1.0], 'all_L1': [0.349, 0.349, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.726, 1.0, 1.0], 'all_L1': [0.557, 0.724, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.328, 0.328, 1.0], 'all_L1': [0.371, 0.371, 0.371, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.743, 0.743, 1.0], 'all_L1': [0.739, 0.739, 0.739, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.464, 0.464, 1.0], 'all_L1': [0.493, 0.493, 0.493, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.585, 1.0], 'all_L1': [0.583, 0.583, 0.583, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.027, 0.027, 0.027], 'all_L1': [0.151, 0.151, 0.151, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 0.845, 1.0], 'all_L1': [0.839, 0.839, 0.839, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.877, 0.904, 1.0], 'all_L1': [0.874, 0.874, 0.892, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.892, 0.892, 1.0], 'all_L1': [0.89, 0.89, 0.89, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.659, 0.695, 0.716, 0.716], 'all_L1': [0.595, 0.626, 0.651, 0.651]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.463, 0.463, 0.463], 'all_L1': [0.441, 0.441, 0.441, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.64, 0.64, 0.669, 0.672], 'all_L1': [0.6, 0.6, 0.625, 0.629]}), defaultdict(<class 'list'>, {'all_KL': [0.25, 0.25, 0.259, 0.257], 'all_L1': [0.254, 0.254, 0.262, 0.261]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.51, 0.536, 0.536], 'all_L1': [0.485, 0.485, 0.507, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.395, 0.416, 0.415], 'all_L1': [0.401, 0.401, 0.417, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.896, 0.896, 0.896, 0.896], 'all_L1': [0.77, 0.77, 0.77, 0.77]}), defaultdict(<class 'list'>, {'all_KL': [0.152, 0.152, 0.152, 0.155], 'all_L1': [0.158, 0.158, 0.158, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.118, 0.118, 0.118], 'all_L1': [0.122, 0.122, 0.122, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.104, 0.109, 0.108], 'all_L1': [0.106, 0.106, 0.11, 0.11]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.73, 0.731, 1.0, 1.0], 'all_L1': [0.774, 0.773, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.955, 1.0, 1.0], 'all_L1': [0.903, 0.958, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.748, 0.748, 0.751, 1.0], 'all_L1': [0.789, 0.789, 0.788, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.739, 0.739, 0.743, 1.0], 'all_L1': [0.78, 0.78, 0.779, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.741, 0.742, 1.0], 'all_L1': [0.784, 0.784, 0.782, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.731, 0.731, 0.734, 1.0], 'all_L1': [0.772, 0.772, 0.772, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.749, 0.749, 0.749], 'all_L1': [0.792, 0.792, 0.792, 0.792]}), defaultdict(<class 'list'>, {'all_KL': [0.711, 0.711, 0.711, 1.0], 'all_L1': [0.76, 0.76, 0.76, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.894, 0.894, 0.949, 1.0], 'all_L1': [0.907, 0.907, 0.958, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.746, 0.745, 1.0], 'all_L1': [0.784, 0.784, 0.782, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.075, 0.113, 0.2, 0.2], 'all_L1': [0.063, 0.095, 0.165, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.215, 0.214, 0.211, 0.211], 'all_L1': [0.177, 0.174, 0.174, 0.174]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.088, 0.118, 0.179], 'all_L1': [0.075, 0.075, 0.1, 0.148]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.086, 0.112, 0.188], 'all_L1': [0.075, 0.075, 0.098, 0.157]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.071, 0.101, 0.187], 'all_L1': [0.06, 0.06, 0.088, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.08, 0.08, 0.112, 0.197], 'all_L1': [0.071, 0.071, 0.098, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.079], 'all_L1': [0.068, 0.068, 0.068, 0.068]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.214], 'all_L1': [0.068, 0.068, 0.068, 0.178]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.205, 0.204, 0.201], 'all_L1': [0.169, 0.169, 0.164, 0.164]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.085, 0.116, 0.186], 'all_L1': [0.075, 0.075, 0.1, 0.154]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.156 +- 0.027, 0.224 +- 0.224, 0.386 +- 0.373, 0.914 +- 0.257
suff_simple class all_KL  =  0.033 +- 0.028, 0.108 +- 0.248, 0.295 +- 0.424, 0.902 +- 0.294
[[0.0013537906343117356, 0.0009025270701386034, -1.0, -1.0], [0.09386281669139862, 0.8979591727256775, -1.0, -1.0], [0.0, 0.0, 0.0009025270701386034, -1.0], [0.0009025270701386034, 0.0009025270701386034, 0.0004512635350693017, -1.0], [0.0, 0.0, 0.0004512635350693017, -1.0], [0.0004512635350693017, 0.0004512635350693017, 0.0, -1.0], [0.0004512635350693017, 0.0004512635350693017, 0.0004512635350693017, 0.0004512635350693017], [0.0004512635350693017, 0.0004512635350693017, 0.0004512635350693017, -1.0], [0.08303248882293701, 0.08303248882293701, 0.8673469424247742, -1.0], [0.0, 0.0, 0.0004512635350693017, -1.0]]
[[0.019, 0.019, 1.0, 1.0], [0.092, 0.849, 1.0, 1.0], [0.021, 0.021, 0.021, 1.0], [0.026, 0.026, 0.026, 1.0], [0.024, 0.024, 0.024, 1.0], [0.016, 0.016, 0.016, 1.0], [0.021, 0.021, 0.021, 0.021], [0.009, 0.009, 0.009, 1.0], [0.082, 0.082, 0.818, 1.0], [0.017, 0.017, 0.017, 1.0]]
suff_simple_acc_int  =  0.018 +- 0.035, 0.098 +- 0.268, -0.113 +- 0.512, -0.900 +- 0.300
nec class all_L1  =  0.649 +- 0.105, 0.670 +- 0.109, 0.770 +- 0.093, 0.826 +- 0.070
nec class all_KL  =  0.763 +- 0.118, 0.787 +- 0.123, 0.900 +- 0.104, 0.958 +- 0.077
[[0.33754512667655945, 0.0943140760064125, 0.023465704172849655, 0.023465704172849655], [0.02301444113254547, 0.035649821162223816, 0.03474729135632515, 0.03474729135632515], [0.29016244411468506, 0.29016244411468506, 0.07806859165430069, 0.020758122205734253], [0.3172382712364197, 0.3172382712364197, 0.08980144560337067, 0.02391696721315384], [0.3222021758556366, 0.3222021758556366, 0.10514440387487411, 0.03023465722799301], [0.35469314455986023, 0.35469314455986023, 0.10018050670623779, 0.02752707526087761], [0.31046929955482483, 0.31046929955482483, 0.31046929955482483, 0.31046929955482483], [0.3555956780910492, 0.3555956780910492, 0.3555956780910492, 0.03835739940404892], [0.026173284277319908, 0.026173284277319908, 0.036101084202528, 0.027075812220573425], [0.333032488822937, 0.333032488822937, 0.08935017883777618, 0.027978340163826942]]
[[0.687, 0.92, 0.98, 0.98], [0.996, 0.996, 0.996, 0.996], [0.752, 0.752, 0.928, 0.978], [0.708, 0.708, 0.924, 0.974], [0.704, 0.704, 0.918, 0.976], [0.686, 0.686, 0.923, 0.983], [0.728, 0.728, 0.728, 0.728], [0.673, 0.673, 0.673, 0.991], [0.994, 0.994, 0.994, 0.994], [0.707, 0.707, 0.933, 0.982]]
nec_acc_int  =  0.267 +- 0.123, 0.244 +- 0.128, 0.122 +- 0.109, 0.056 +- 0.085

Eval split val
suff_simple class all_L1  =  0.585 +- 0.237, 0.601 +- 0.241, 0.696 +- 0.272, 0.915 +- 0.255
suff_simple class all_KL  =  0.558 +- 0.274, 0.577 +- 0.278, 0.679 +- 0.306, 0.903 +- 0.292
[[0.0, 0.0, -1.0, -1.0], [0.0075396825559437275, 0.33544304966926575, -1.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, -1.0], [0.004365079570561647, 0.004365079570561647, 0.06329113990068436, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.284, 0.284, 1.0, 1.0], [0.533, 0.726, 1.0, 1.0], [0.328, 0.328, 0.328, 1.0], [0.743, 0.743, 0.743, 1.0], [0.464, 0.464, 0.464, 1.0], [0.585, 0.585, 0.585, 1.0], [0.027, 0.027, 0.027, 0.027], [0.845, 0.845, 0.845, 1.0], [0.877, 0.877, 0.904, 1.0], [0.892, 0.892, 0.892, 1.0]]
suff_simple_acc_int  =  0.001 +- 0.002, 0.034 +- 0.100, -0.194 +- 0.404, -0.900 +- 0.300
nec class all_L1  =  0.393 +- 0.216, 0.396 +- 0.219, 0.406 +- 0.224, 0.407 +- 0.224
nec class all_KL  =  0.419 +- 0.252, 0.422 +- 0.256, 0.433 +- 0.260, 0.434 +- 0.260
[[0.07619047909975052, 0.0357142873108387, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0], [0.04087301716208458, 0.04087301716208458, 0.009523809887468815, 0.0], [0.014682539738714695, 0.014682539738714695, 0.003968254197388887, 0.0], [0.03849206492304802, 0.03849206492304802, 0.008333333767950535, 0.0], [0.02658730186522007, 0.02658730186522007, 0.004365079570561647, 0.0], [0.09682539850473404, 0.09682539850473404, 0.09682539850473404, 0.09682539850473404], [0.009523809887468815, 0.009523809887468815, 0.009523809887468815, 0.0], [0.0, 0.0, 0.0, 0.0], [0.0071428571827709675, 0.0071428571827709675, 0.0015873016091063619, 0.0]]
[[0.659, 0.695, 0.716, 0.716], [0.463, 0.463, 0.463, 0.463], [0.64, 0.64, 0.669, 0.672], [0.25, 0.25, 0.259, 0.257], [0.51, 0.51, 0.536, 0.536], [0.395, 0.395, 0.416, 0.415], [0.896, 0.896, 0.896, 0.896], [0.152, 0.152, 0.152, 0.155], [0.118, 0.118, 0.118, 0.118], [0.104, 0.104, 0.109, 0.108]]
nec_acc_int  =  0.031 +- 0.031, 0.027 +- 0.028, 0.013 +- 0.028, 0.010 +- 0.029

Eval split test
suff_simple class all_L1  =  0.804 +- 0.051, 0.810 +- 0.063, 0.841 +- 0.096, 0.979 +- 0.062
suff_simple class all_KL  =  0.767 +- 0.062, 0.775 +- 0.077, 0.812 +- 0.113, 0.975 +- 0.075
[[0.5826719403266907, 0.5804843306541443, -1.0, -1.0], [0.8034188151359558, 0.845082700252533, -1.0, -1.0], [0.5899979472160339, 0.5899979472160339, 0.587352454662323, -1.0], [0.5880647301673889, 0.5880647301673889, 0.5869454741477966, -1.0], [0.5885226130485535, 0.5885226130485535, 0.5860806107521057, -1.0], [0.5847069621086121, 0.5847069621086121, 0.5839946866035461, -1.0], [0.5931522250175476, 0.5931522250175476, 0.5931522250175476, 0.5931522250175476], [0.5882682204246521, 0.5882682204246521, 0.5882682204246521, -1.0], [0.7973138093948364, 0.7973138093948364, 0.8328981995582581, -1.0], [0.5864875912666321, 0.5864875912666321, 0.585063099861145, -1.0]]
[[0.73, 0.731, 1.0, 1.0], [0.884, 0.955, 1.0, 1.0], [0.748, 0.748, 0.751, 1.0], [0.739, 0.739, 0.743, 1.0], [0.741, 0.741, 0.742, 1.0], [0.731, 0.731, 0.734, 1.0], [0.749, 0.749, 0.749, 0.749], [0.711, 0.711, 0.711, 1.0], [0.894, 0.894, 0.949, 1.0], [0.746, 0.746, 0.745, 1.0]]
suff_simple_acc_int  =  0.630 +- 0.085, 0.634 +- 0.094, 0.294 +- 0.651, -0.841 +- 0.478
nec class all_L1  =  0.090 +- 0.042, 0.093 +- 0.040, 0.112 +- 0.038, 0.153 +- 0.030
nec class all_KL  =  0.106 +- 0.052, 0.110 +- 0.051, 0.133 +- 0.049, 0.184 +- 0.037
[[0.8083468675613403, 0.7972548604011536, 0.6534643173217773, 0.6534643173217773], [0.6535149812698364, 0.6578707695007324, 0.6566551923751831, 0.6566551923751831], [0.7953808903694153, 0.7953808903694153, 0.7982171773910522, 0.6600992679595947], [0.7949756979942322, 0.7949756979942322, 0.794165313243866, 0.6592888832092285], [0.8075364828109741, 0.8075364828109741, 0.7989262342453003, 0.6599473357200623], [0.8103727698326111, 0.8103727698326111, 0.798875629901886, 0.65625], [0.7934055924415588, 0.7934055924415588, 0.7934055924415588, 0.7934055924415588], [0.8172609210014343, 0.8172609210014343, 0.8172609210014343, 0.6579720377922058], [0.650526762008667, 0.650526762008667, 0.6565032601356506, 0.6575668454170227], [0.7945705056190491, 0.7945705056190491, 0.7956340909004211, 0.6568071246147156]]
[[0.075, 0.113, 0.2, 0.2], [0.215, 0.214, 0.211, 0.211], [0.088, 0.088, 0.118, 0.179], [0.086, 0.086, 0.112, 0.188], [0.071, 0.071, 0.101, 0.187], [0.08, 0.08, 0.112, 0.197], [0.079, 0.079, 0.079, 0.079], [0.079, 0.079, 0.079, 0.214], [0.205, 0.205, 0.204, 0.201], [0.085, 0.085, 0.116, 0.186]]
nec_acc_int  =  0.773 +- 0.061, 0.772 +- 0.059, 0.756 +- 0.066, 0.671 +- 0.041


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.403 +- 0.066, 0.447 +- 0.151, 0.578 +- 0.217, 0.870 +- 0.163
Faith. Armon (L1)= 		  =  0.252 +- 0.043, 0.306 +- 0.191, 0.436 +- 0.303, 0.850 +- 0.206
Faith. GMean (L1)= 	  =  0.319 +- 0.053, 0.368 +- 0.173, 0.496 +- 0.266, 0.859 +- 0.187
Faith. Aritm (KL)= 		  =  0.398 +- 0.072, 0.448 +- 0.169, 0.597 +- 0.245, 0.930 +- 0.185
Faith. Armon (KL)= 		  =  0.062 +- 0.050, 0.137 +- 0.262, 0.315 +- 0.424, 0.897 +- 0.285
Faith. GMean (KL)= 	  =  0.151 +- 0.073, 0.214 +- 0.241, 0.378 +- 0.384, 0.905 +- 0.260

Eval split val
Faith. Aritm (L1)= 		  =  0.489 +- 0.012, 0.499 +- 0.030, 0.551 +- 0.114, 0.661 +- 0.116
Faith. Armon (L1)= 		  =  0.365 +- 0.116, 0.372 +- 0.123, 0.417 +- 0.182, 0.479 +- 0.222
Faith. GMean (L1)= 	  =  0.417 +- 0.070, 0.425 +- 0.081, 0.473 +- 0.150, 0.556 +- 0.181
Faith. Aritm (KL)= 		  =  0.488 +- 0.012, 0.500 +- 0.033, 0.556 +- 0.123, 0.668 +- 0.125
Faith. Armon (KL)= 		  =  0.336 +- 0.144, 0.344 +- 0.153, 0.399 +- 0.220, 0.469 +- 0.264
Faith. GMean (KL)= 	  =  0.393 +- 0.102, 0.402 +- 0.114, 0.458 +- 0.185, 0.545 +- 0.222

Eval split test
Faith. Aritm (L1)= 		  =  0.447 +- 0.046, 0.451 +- 0.051, 0.477 +- 0.066, 0.566 +- 0.046
Faith. Armon (L1)= 		  =  0.160 +- 0.066, 0.165 +- 0.064, 0.197 +- 0.062, 0.263 +- 0.048
Faith. GMean (L1)= 	  =  0.265 +- 0.066, 0.271 +- 0.066, 0.305 +- 0.069, 0.385 +- 0.052
Faith. Aritm (KL)= 		  =  0.437 +- 0.057, 0.442 +- 0.063, 0.473 +- 0.080, 0.580 +- 0.055
Faith. Armon (KL)= 		  =  0.184 +- 0.078, 0.190 +- 0.078, 0.227 +- 0.076, 0.309 +- 0.057
Faith. GMean (KL)= 	  =  0.281 +- 0.076, 0.288 +- 0.078, 0.327 +- 0.082, 0.422 +- 0.061
Computed for split load_split = id



Completed in  0:38:50.572318  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:22:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:22:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.085
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.045
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.112
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03961371841155234
len(reference) = 277
Effective ratio: 0.076 +- 0.081
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.143 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.019 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.143 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08488808664259928
len(reference) = 277
Effective ratio: 0.308 +- 0.200
Model Accuracy over intervened graphs for r=0.5 =  0.007
SUFF_SIMPLE for r=0.5 class 1.0 = 0.149 +- 0.114 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.114 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.149 +- 0.082 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.010654761904761905
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04489303079416532
len(reference) = 2457
Effective ratio: 0.067 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.585
SUFF_SIMPLE for r=0.6 class 1.0 = 0.775 +- 0.436 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.6 all KL = 0.734 +- 0.436 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.6 all L1 = 0.775 +- 0.370 (in-sample avg dev_std = 0.173)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08630672609400324
len(reference) = 2457
Effective ratio: 0.305 +- 0.172
Model Accuracy over intervened graphs for r=0.5 =  0.592
SUFF_SIMPLE for r=0.5 class 1.0 = 0.776 +- 0.435 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.5 all KL = 0.736 +- 0.435 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.5 all L1 = 0.776 +- 0.370 (in-sample avg dev_std = 0.164)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03961371841155234
len(reference) = 277
Effective ratio: 0.076 +- 0.081
Model Accuracy over intervened graphs for r=0.6 =  0.366
NEC for r=0.6 class 1.0 = 0.568 +- 0.418 (in-sample avg dev_std = 0.066)
NEC for r=0.6 all KL = 0.685 +- 0.418 (in-sample avg dev_std = 0.066)
NEC for r=0.6 all L1 = 0.568 +- 0.378 (in-sample avg dev_std = 0.066)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08488808664259928
len(reference) = 277
Effective ratio: 0.308 +- 0.200
Model Accuracy over intervened graphs for r=0.5 =  0.024
NEC for r=0.5 class 1.0 = 0.848 +- 0.078 (in-sample avg dev_std = 0.280)
NEC for r=0.5 all KL = 0.98 +- 0.078 (in-sample avg dev_std = 0.280)
NEC for r=0.5 all L1 = 0.848 +- 0.045 (in-sample avg dev_std = 0.280)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.098028880866426
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.023
NEC for r=0.4 class 1.0 = 0.85 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all KL = 0.98 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all L1 = 0.85 +- 0.039 (in-sample avg dev_std = 0.290)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.098028880866426
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.023
NEC for r=0.3 class 1.0 = 0.85 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.3 all KL = 0.98 +- 0.078 (in-sample avg dev_std = 0.290)
NEC for r=0.3 all L1 = 0.85 +- 0.039 (in-sample avg dev_std = 0.290)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 1.0 = 0.553 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.613 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.553 +- 0.370 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.010654761904761905
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.5 =  0.001
NEC for r=0.5 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.715 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01302142857142857
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.724
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.01302142857142857
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04489303079416532
len(reference) = 2468
Effective ratio: 0.067 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.769
NEC for r=0.6 class 1.0 = 0.071 +- 0.258 (in-sample avg dev_std = 0.028)
NEC for r=0.6 all KL = 0.079 +- 0.258 (in-sample avg dev_std = 0.028)
NEC for r=0.6 all L1 = 0.071 +- 0.228 (in-sample avg dev_std = 0.028)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08630672609400324
len(reference) = 2468
Effective ratio: 0.305 +- 0.172
Model Accuracy over intervened graphs for r=0.5 =  0.658
NEC for r=0.5 class 1.0 = 0.16 +- 0.383 (in-sample avg dev_std = 0.144)
NEC for r=0.5 all KL = 0.188 +- 0.383 (in-sample avg dev_std = 0.144)
NEC for r=0.5 all L1 = 0.16 +- 0.326 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11157050243111831
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.653
NEC for r=0.4 class 1.0 = 0.165 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all KL = 0.2 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all L1 = 0.165 +- 0.325 (in-sample avg dev_std = 0.212)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11157050243111831
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.653
NEC for r=0.3 class 1.0 = 0.165 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all KL = 0.2 +- 0.393 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all L1 = 0.165 +- 0.325 (in-sample avg dev_std = 0.212)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:26:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:26:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.074
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.096
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.088
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.111
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.112
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07409747292418772
len(reference) = 277
Effective ratio: 0.692 +- 0.205
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.137 +- 0.019 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.6 all KL = 0.004 +- 0.019 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.6 all L1 = 0.137 +- 0.012 (in-sample avg dev_std = 0.013)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0964404332129964
len(reference) = 49
Effective ratio: 0.989 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.633
SUFF_SIMPLE for r=0.5 class 1.0 = 0.673 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.599 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.673 +- 0.402 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01303015873015873
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.559 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.537 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.559 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.75
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013011904761904761
len(reference) = 20
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.5 =  0.5
SUFF_SIMPLE for r=0.5 class 1.0 = 0.699 +- 0.335 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.661 +- 0.335 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.699 +- 0.307 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08844854132901134
len(reference) = 2457
Effective ratio: 0.701 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.627
SUFF_SIMPLE for r=0.6 class 1.0 = 0.8 +- 0.415 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.6 all KL = 0.769 +- 0.415 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.6 all L1 = 0.8 +- 0.358 (in-sample avg dev_std = 0.060)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1106908427876823
len(reference) = 455
Effective ratio: 0.992 +- 0.029
Model Accuracy over intervened graphs for r=0.5 =  0.725
SUFF_SIMPLE for r=0.5 class 1.0 = 0.885 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.876 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.885 +- 0.275 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07409747292418772
len(reference) = 277
Effective ratio: 0.692 +- 0.205
Model Accuracy over intervened graphs for r=0.6 =  0.053
NEC for r=0.6 class 1.0 = 0.834 +- 0.144 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all KL = 0.975 +- 0.144 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all L1 = 0.834 +- 0.126 (in-sample avg dev_std = 0.334)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0964404332129964
len(reference) = 277
Effective ratio: 0.989 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.034
NEC for r=0.5 class 1.0 = 0.853 +- 0.018 (in-sample avg dev_std = 0.345)
NEC for r=0.5 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.345)
NEC for r=0.5 all L1 = 0.853 +- 0.024 (in-sample avg dev_std = 0.345)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09767148014440433
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.035
NEC for r=0.4 class 1.0 = 0.853 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.4 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.4 all L1 = 0.853 +- 0.022 (in-sample avg dev_std = 0.352)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09767148014440433
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.035
NEC for r=0.3 class 1.0 = 0.853 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all KL = 0.996 +- 0.018 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all L1 = 0.853 +- 0.022 (in-sample avg dev_std = 0.352)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01303015873015873
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.465
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013011904761904761
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.465
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08844854132901134
len(reference) = 2468
Effective ratio: 0.701 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.661
NEC for r=0.6 class 1.0 = 0.174 +- 0.401 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.212 +- 0.401 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.174 +- 0.333 (in-sample avg dev_std = 0.191)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.846
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1106908427876823
len(reference) = 2468
Effective ratio: 0.992 +- 0.029
Model Accuracy over intervened graphs for r=0.5 =  0.657
NEC for r=0.5 class 1.0 = 0.174 +- 0.400 (in-sample avg dev_std = 0.197)
NEC for r=0.5 all KL = 0.211 +- 0.400 (in-sample avg dev_std = 0.197)
NEC for r=0.5 all L1 = 0.174 +- 0.333 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.846
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11153525121555916
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.657
NEC for r=0.4 class 1.0 = 0.174 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all KL = 0.211 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all L1 = 0.174 +- 0.333 (in-sample avg dev_std = 0.200)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.846
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11153525121555916
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.657
NEC for r=0.3 class 1.0 = 0.174 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.211 +- 0.401 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.174 +- 0.333 (in-sample avg dev_std = 0.200)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:30:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:30:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.035
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.035
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.045
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.045
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.002)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08002527075812275
len(reference) = 276
Effective ratio: 0.309 +- 0.207
Model Accuracy over intervened graphs for r=0.4 =  0.014
SUFF_SIMPLE for r=0.4 class 1.0 = 0.155 +- 0.131 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.035 +- 0.131 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.155 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010820634920634922
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04499635332252836
len(reference) = 2457
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.6 =  0.591
SUFF_SIMPLE for r=0.6 class 1.0 = 0.791 +- 0.422 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.6 all KL = 0.755 +- 0.422 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.6 all L1 = 0.791 +- 0.359 (in-sample avg dev_std = 0.160)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04499635332252836
len(reference) = 2457
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.5 =  0.591
SUFF_SIMPLE for r=0.5 class 1.0 = 0.791 +- 0.422 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.5 all KL = 0.755 +- 0.422 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.5 all L1 = 0.791 +- 0.359 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08502552674230146
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.593
SUFF_SIMPLE for r=0.4 class 1.0 = 0.791 +- 0.423 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all KL = 0.754 +- 0.423 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all L1 = 0.791 +- 0.358 (in-sample avg dev_std = 0.154)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.6 =  0.275
NEC for r=0.6 class 1.0 = 0.634 +- 0.367 (in-sample avg dev_std = 0.098)
NEC for r=0.6 all KL = 0.761 +- 0.367 (in-sample avg dev_std = 0.098)
NEC for r=0.6 all L1 = 0.634 +- 0.327 (in-sample avg dev_std = 0.098)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.5 =  0.275
NEC for r=0.5 class 1.0 = 0.634 +- 0.367 (in-sample avg dev_std = 0.098)
NEC for r=0.5 all KL = 0.761 +- 0.367 (in-sample avg dev_std = 0.098)
NEC for r=0.5 all L1 = 0.634 +- 0.327 (in-sample avg dev_std = 0.098)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08002527075812275
len(reference) = 277
Effective ratio: 0.309 +- 0.207
Model Accuracy over intervened graphs for r=0.4 =  0.023
NEC for r=0.4 class 1.0 = 0.849 +- 0.072 (in-sample avg dev_std = 0.259)
NEC for r=0.4 all KL = 0.978 +- 0.072 (in-sample avg dev_std = 0.259)
NEC for r=0.4 all L1 = 0.849 +- 0.040 (in-sample avg dev_std = 0.259)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.996
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09773646209386282
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.021
NEC for r=0.3 class 1.0 = 0.85 +- 0.071 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.978 +- 0.071 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.85 +- 0.037 (in-sample avg dev_std = 0.265)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.111
NEC for r=0.6 class 1.0 = 0.546 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.585 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.546 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.111
NEC for r=0.5 class 1.0 = 0.546 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.585 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.546 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010820634920634922
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.629 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.672 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.629 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.629 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.672 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.629 +- 0.330 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04499635332252836
len(reference) = 2468
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.6 =  0.768
NEC for r=0.6 class 1.0 = 0.061 +- 0.237 (in-sample avg dev_std = 0.019)
NEC for r=0.6 all KL = 0.068 +- 0.237 (in-sample avg dev_std = 0.019)
NEC for r=0.6 all L1 = 0.061 +- 0.207 (in-sample avg dev_std = 0.019)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.815
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04499635332252836
len(reference) = 2468
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.5 =  0.768
NEC for r=0.5 class 1.0 = 0.061 +- 0.237 (in-sample avg dev_std = 0.019)
NEC for r=0.5 all KL = 0.068 +- 0.237 (in-sample avg dev_std = 0.019)
NEC for r=0.5 all L1 = 0.061 +- 0.207 (in-sample avg dev_std = 0.019)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.815
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08502552674230146
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 1.0 = 0.142 +- 0.364 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all KL = 0.167 +- 0.364 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all L1 = 0.142 +- 0.308 (in-sample avg dev_std = 0.135)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11146920583468395
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.66
NEC for r=0.3 class 1.0 = 0.148 +- 0.375 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.179 +- 0.375 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.148 +- 0.310 (in-sample avg dev_std = 0.194)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:34:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:34:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.041
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.056
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.010
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.051
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.041072202166064976
len(reference) = 277
Effective ratio: 0.076 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.043841155234657044
len(reference) = 277
Effective ratio: 0.078 +- 0.088
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.5 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.015)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05643321299638989
len(reference) = 277
Effective ratio: 0.112 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.004
SUFF_SIMPLE for r=0.4 class 1.0 = 0.148 +- 0.100 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 all KL = 0.029 +- 0.100 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 all L1 = 0.148 +- 0.064 (in-sample avg dev_std = 0.005)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009807142857142856
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0509242301458671
len(reference) = 2457
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.59
SUFF_SIMPLE for r=0.6 class 1.0 = 0.782 +- 0.427 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.6 all KL = 0.745 +- 0.427 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.6 all L1 = 0.782 +- 0.363 (in-sample avg dev_std = 0.159)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.825
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.05116247974068071
len(reference) = 2457
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.589
SUFF_SIMPLE for r=0.5 class 1.0 = 0.782 +- 0.427 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.5 all KL = 0.745 +- 0.427 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.5 all L1 = 0.782 +- 0.363 (in-sample avg dev_std = 0.161)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06221839546191248
len(reference) = 2457
Effective ratio: 0.090 +- 0.132
Model Accuracy over intervened graphs for r=0.4 =  0.589
SUFF_SIMPLE for r=0.4 class 1.0 = 0.781 +- 0.428 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.428 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all L1 = 0.781 +- 0.364 (in-sample avg dev_std = 0.160)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.041072202166064976
len(reference) = 277
Effective ratio: 0.076 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.332
NEC for r=0.6 class 1.0 = 0.6 +- 0.401 (in-sample avg dev_std = 0.140)
NEC for r=0.6 all KL = 0.715 +- 0.401 (in-sample avg dev_std = 0.140)
NEC for r=0.6 all L1 = 0.6 +- 0.357 (in-sample avg dev_std = 0.140)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.043841155234657044
len(reference) = 277
Effective ratio: 0.078 +- 0.088
Model Accuracy over intervened graphs for r=0.5 =  0.314
NEC for r=0.5 class 1.0 = 0.615 +- 0.393 (in-sample avg dev_std = 0.102)
NEC for r=0.5 all KL = 0.73 +- 0.393 (in-sample avg dev_std = 0.102)
NEC for r=0.5 all L1 = 0.615 +- 0.352 (in-sample avg dev_std = 0.102)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05643321299638989
len(reference) = 277
Effective ratio: 0.112 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.199
NEC for r=0.4 class 1.0 = 0.708 +- 0.325 (in-sample avg dev_std = 0.109)
NEC for r=0.4 all KL = 0.832 +- 0.325 (in-sample avg dev_std = 0.109)
NEC for r=0.4 all L1 = 0.708 +- 0.294 (in-sample avg dev_std = 0.109)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09742238267148014
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.024
NEC for r=0.3 class 1.0 = 0.847 +- 0.081 (in-sample avg dev_std = 0.282)
NEC for r=0.3 all KL = 0.974 +- 0.081 (in-sample avg dev_std = 0.282)
NEC for r=0.3 all L1 = 0.847 +- 0.042 (in-sample avg dev_std = 0.282)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.02
NEC for r=0.6 class 1.0 = 0.245 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.241 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.245 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.02
NEC for r=0.5 class 1.0 = 0.245 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.241 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.245 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009807142857142856
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.018
NEC for r=0.4 class 1.0 = 0.248 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.243 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.248 +- 0.339 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.254
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013030555555555557
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.261 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.257 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.261 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0509242301458671
len(reference) = 2468
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 1.0 = 0.068 +- 0.247 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all KL = 0.074 +- 0.247 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all L1 = 0.068 +- 0.218 (in-sample avg dev_std = 0.025)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.822
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.05116247974068071
len(reference) = 2468
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.773
NEC for r=0.5 class 1.0 = 0.069 +- 0.248 (in-sample avg dev_std = 0.025)
NEC for r=0.5 all KL = 0.075 +- 0.248 (in-sample avg dev_std = 0.025)
NEC for r=0.5 all L1 = 0.069 +- 0.219 (in-sample avg dev_std = 0.025)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.822
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06221839546191248
len(reference) = 2468
Effective ratio: 0.090 +- 0.132
Model Accuracy over intervened graphs for r=0.4 =  0.749
NEC for r=0.4 class 1.0 = 0.086 +- 0.282 (in-sample avg dev_std = 0.030)
NEC for r=0.4 all KL = 0.097 +- 0.282 (in-sample avg dev_std = 0.030)
NEC for r=0.4 all L1 = 0.086 +- 0.246 (in-sample avg dev_std = 0.030)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.822
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11131604538087521
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 1.0 = 0.157 +- 0.381 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.188 +- 0.381 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.157 +- 0.317 (in-sample avg dev_std = 0.193)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:38:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:38:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.047
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.057
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.044
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.042)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.5 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.042)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05664259927797833
len(reference) = 277
Effective ratio: 0.102 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.001
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.4 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.039)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008219444444444444
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0440064829821718
len(reference) = 2457
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.6 =  0.591
SUFF_SIMPLE for r=0.6 class 1.0 = 0.786 +- 0.429 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.746 +- 0.429 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.786 +- 0.363 (in-sample avg dev_std = 0.169)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0440064829821718
len(reference) = 2457
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.591
SUFF_SIMPLE for r=0.5 class 1.0 = 0.786 +- 0.429 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.5 all KL = 0.746 +- 0.429 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.5 all L1 = 0.786 +- 0.363 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.048196110210696926
len(reference) = 2457
Effective ratio: 0.074 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.591
SUFF_SIMPLE for r=0.4 class 1.0 = 0.786 +- 0.429 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all KL = 0.745 +- 0.429 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all L1 = 0.786 +- 0.363 (in-sample avg dev_std = 0.165)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.6 =  0.292
NEC for r=0.6 class 1.0 = 0.629 +- 0.385 (in-sample avg dev_std = 0.120)
NEC for r=0.6 all KL = 0.751 +- 0.385 (in-sample avg dev_std = 0.120)
NEC for r=0.6 all L1 = 0.629 +- 0.347 (in-sample avg dev_std = 0.120)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.5 =  0.292
NEC for r=0.5 class 1.0 = 0.629 +- 0.385 (in-sample avg dev_std = 0.120)
NEC for r=0.5 all KL = 0.751 +- 0.385 (in-sample avg dev_std = 0.120)
NEC for r=0.5 all L1 = 0.629 +- 0.347 (in-sample avg dev_std = 0.120)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05664259927797833
len(reference) = 277
Effective ratio: 0.102 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.21
NEC for r=0.4 class 1.0 = 0.694 +- 0.338 (in-sample avg dev_std = 0.080)
NEC for r=0.4 all KL = 0.818 +- 0.338 (in-sample avg dev_std = 0.080)
NEC for r=0.4 all L1 = 0.694 +- 0.310 (in-sample avg dev_std = 0.080)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.989
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0982490974729242
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.03
NEC for r=0.3 class 1.0 = 0.845 +- 0.085 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all KL = 0.976 +- 0.085 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all L1 = 0.845 +- 0.049 (in-sample avg dev_std = 0.328)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.066
NEC for r=0.6 class 1.0 = 0.456 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.485 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.456 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.066
NEC for r=0.5 class 1.0 = 0.456 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.485 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.456 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008219444444444444
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.065
NEC for r=0.4 class 1.0 = 0.457 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.485 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.457 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015079365079367
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.507 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.536 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.507 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0440064829821718
len(reference) = 2468
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 1.0 = 0.066 +- 0.251 (in-sample avg dev_std = 0.014)
NEC for r=0.6 all KL = 0.075 +- 0.251 (in-sample avg dev_std = 0.014)
NEC for r=0.6 all L1 = 0.066 +- 0.220 (in-sample avg dev_std = 0.014)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.826
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0440064829821718
len(reference) = 2468
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.774
NEC for r=0.5 class 1.0 = 0.066 +- 0.251 (in-sample avg dev_std = 0.014)
NEC for r=0.5 all KL = 0.075 +- 0.251 (in-sample avg dev_std = 0.014)
NEC for r=0.5 all L1 = 0.066 +- 0.220 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.826
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.048196110210696926
len(reference) = 2468
Effective ratio: 0.074 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.765
NEC for r=0.4 class 1.0 = 0.072 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.084 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.072 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11143314424635334
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.66
NEC for r=0.3 class 1.0 = 0.153 +- 0.381 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all KL = 0.187 +- 0.381 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all L1 = 0.153 +- 0.317 (in-sample avg dev_std = 0.197)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:42:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:42:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.040
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.084
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.047
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.001
SUFF_SIMPLE for r=0.6 class 1.0 = 0.141 +- 0.046 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.6 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.6 all L1 = 0.141 +- 0.017 (in-sample avg dev_std = 0.058)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.001
SUFF_SIMPLE for r=0.5 class 1.0 = 0.141 +- 0.046 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.5 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.5 all L1 = 0.141 +- 0.017 (in-sample avg dev_std = 0.058)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08403971119133574
len(reference) = 277
Effective ratio: 0.310 +- 0.206
Model Accuracy over intervened graphs for r=0.4 =  0.011
SUFF_SIMPLE for r=0.4 class 1.0 = 0.149 +- 0.107 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.026 +- 0.107 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.149 +- 0.085 (in-sample avg dev_std = 0.001)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010527777777777778
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04677836304700163
len(reference) = 2457
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.6 =  0.587
SUFF_SIMPLE for r=0.6 class 1.0 = 0.774 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all KL = 0.737 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all L1 = 0.774 +- 0.367 (in-sample avg dev_std = 0.168)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04677836304700163
len(reference) = 2457
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.587
SUFF_SIMPLE for r=0.5 class 1.0 = 0.774 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.5 all KL = 0.737 +- 0.430 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.5 all L1 = 0.774 +- 0.367 (in-sample avg dev_std = 0.168)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08463330632090761
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.589
SUFF_SIMPLE for r=0.4 class 1.0 = 0.773 +- 0.430 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all KL = 0.736 +- 0.430 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all L1 = 0.773 +- 0.368 (in-sample avg dev_std = 0.160)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 1.0 = 0.58 +- 0.396 (in-sample avg dev_std = 0.110)
NEC for r=0.6 all KL = 0.704 +- 0.396 (in-sample avg dev_std = 0.110)
NEC for r=0.6 all L1 = 0.58 +- 0.351 (in-sample avg dev_std = 0.110)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.379
NEC for r=0.5 class 1.0 = 0.58 +- 0.396 (in-sample avg dev_std = 0.110)
NEC for r=0.5 all KL = 0.704 +- 0.396 (in-sample avg dev_std = 0.110)
NEC for r=0.5 all L1 = 0.58 +- 0.351 (in-sample avg dev_std = 0.110)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08403971119133574
len(reference) = 277
Effective ratio: 0.310 +- 0.206
Model Accuracy over intervened graphs for r=0.4 =  0.031
NEC for r=0.4 class 1.0 = 0.847 +- 0.046 (in-sample avg dev_std = 0.294)
NEC for r=0.4 all KL = 0.983 +- 0.046 (in-sample avg dev_std = 0.294)
NEC for r=0.4 all L1 = 0.847 +- 0.047 (in-sample avg dev_std = 0.294)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09811191335740072
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.028
NEC for r=0.3 class 1.0 = 0.851 +- 0.046 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all KL = 0.983 +- 0.046 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all L1 = 0.851 +- 0.024 (in-sample avg dev_std = 0.310)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.056
NEC for r=0.6 class 1.0 = 0.375 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.367 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.375 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.056
NEC for r=0.5 class 1.0 = 0.375 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.367 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.375 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010527777777777778
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.415 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013009920634920636
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.415 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04677836304700163
len(reference) = 2468
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.6 =  0.771
NEC for r=0.6 class 1.0 = 0.071 +- 0.247 (in-sample avg dev_std = 0.026)
NEC for r=0.6 all KL = 0.077 +- 0.247 (in-sample avg dev_std = 0.026)
NEC for r=0.6 all L1 = 0.071 +- 0.222 (in-sample avg dev_std = 0.026)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.831
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04677836304700163
len(reference) = 2468
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.771
NEC for r=0.5 class 1.0 = 0.071 +- 0.247 (in-sample avg dev_std = 0.026)
NEC for r=0.5 all KL = 0.077 +- 0.247 (in-sample avg dev_std = 0.026)
NEC for r=0.5 all L1 = 0.071 +- 0.222 (in-sample avg dev_std = 0.026)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08463330632090761
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 1.0 = 0.156 +- 0.373 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all KL = 0.181 +- 0.373 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all L1 = 0.156 +- 0.319 (in-sample avg dev_std = 0.135)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11163006482982171
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.656
NEC for r=0.3 class 1.0 = 0.165 +- 0.384 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.197 +- 0.384 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.165 +- 0.323 (in-sample avg dev_std = 0.194)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:46:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:46:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.042
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.042
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.042
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.009
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.048
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.048


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.3 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.3 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.6 =  0.594
SUFF_SIMPLE for r=0.6 class 1.0 = 0.794 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.6 all KL = 0.757 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.6 all L1 = 0.794 +- 0.357 (in-sample avg dev_std = 0.156)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.817
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.5 =  0.594
SUFF_SIMPLE for r=0.5 class 1.0 = 0.794 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.5 all KL = 0.757 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.5 all L1 = 0.794 +- 0.357 (in-sample avg dev_std = 0.156)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.817
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.594
SUFF_SIMPLE for r=0.4 class 1.0 = 0.794 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all KL = 0.757 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all L1 = 0.794 +- 0.357 (in-sample avg dev_std = 0.156)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.3 =  0.594
SUFF_SIMPLE for r=0.3 class 1.0 = 0.794 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.3 all KL = 0.757 +- 0.421 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.3 all L1 = 0.794 +- 0.357 (in-sample avg dev_std = 0.156)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.6 =  0.319
NEC for r=0.6 class 1.0 = 0.591 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.6 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.6 all L1 = 0.591 +- 0.373 (in-sample avg dev_std = 0.055)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.5 =  0.319
NEC for r=0.5 class 1.0 = 0.591 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.5 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.5 all L1 = 0.591 +- 0.373 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.4 =  0.319
NEC for r=0.4 class 1.0 = 0.591 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.4 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.4 all L1 = 0.591 +- 0.373 (in-sample avg dev_std = 0.055)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.3 =  0.319
NEC for r=0.3 class 1.0 = 0.591 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.3 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.055)
NEC for r=0.3 all L1 = 0.591 +- 0.373 (in-sample avg dev_std = 0.055)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.242
NEC for r=0.6 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.242
NEC for r=0.5 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.4 =  0.242
NEC for r=0.4 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.3 =  0.242
NEC for r=0.3 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.6 =  0.767
NEC for r=0.6 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.6 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.6 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.023)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.814
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.5 =  0.767
NEC for r=0.5 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.5 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.5 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.023)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.814
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.767
NEC for r=0.4 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.023)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.3 =  0.767
NEC for r=0.3 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.3 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.023)
NEC for r=0.3 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.023)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:50:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:50:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.043
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.043
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.043
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.046
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.046
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.138 +- 0.034 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.6 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.6 all L1 = 0.138 +- 0.011 (in-sample avg dev_std = 0.043)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.138 +- 0.034 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.5 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.5 all L1 = 0.138 +- 0.011 (in-sample avg dev_std = 0.043)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.138 +- 0.034 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 all L1 = 0.138 +- 0.011 (in-sample avg dev_std = 0.043)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.6 =  0.589
SUFF_SIMPLE for r=0.6 class 1.0 = 0.761 +- 0.443 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.719 +- 0.443 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.761 +- 0.377 (in-sample avg dev_std = 0.169)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.855
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.589
SUFF_SIMPLE for r=0.5 class 1.0 = 0.761 +- 0.443 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.5 all KL = 0.719 +- 0.443 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.5 all L1 = 0.761 +- 0.377 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.855
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.589
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.443 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.4 all KL = 0.719 +- 0.443 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.4 all L1 = 0.761 +- 0.377 (in-sample avg dev_std = 0.169)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.372
NEC for r=0.6 class 1.0 = 0.571 +- 0.424 (in-sample avg dev_std = 0.092)
NEC for r=0.6 all KL = 0.694 +- 0.424 (in-sample avg dev_std = 0.092)
NEC for r=0.6 all L1 = 0.571 +- 0.378 (in-sample avg dev_std = 0.092)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.5 =  0.372
NEC for r=0.5 class 1.0 = 0.571 +- 0.424 (in-sample avg dev_std = 0.092)
NEC for r=0.5 all KL = 0.694 +- 0.424 (in-sample avg dev_std = 0.092)
NEC for r=0.5 all L1 = 0.571 +- 0.378 (in-sample avg dev_std = 0.092)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.4 =  0.372
NEC for r=0.4 class 1.0 = 0.571 +- 0.424 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all KL = 0.694 +- 0.424 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all L1 = 0.571 +- 0.378 (in-sample avg dev_std = 0.092)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09797111913357401
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.038
NEC for r=0.3 class 1.0 = 0.85 +- 0.035 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all KL = 0.991 +- 0.035 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all L1 = 0.85 +- 0.024 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.012
NEC for r=0.6 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.147 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.155 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.012
NEC for r=0.5 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.147 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.155 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.012
NEC for r=0.4 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.147 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.155 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013014682539682538
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.161 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.155 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.161 +- 0.297 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 1.0 = 0.09 +- 0.292 (in-sample avg dev_std = 0.023)
NEC for r=0.6 all KL = 0.102 +- 0.292 (in-sample avg dev_std = 0.023)
NEC for r=0.6 all L1 = 0.09 +- 0.255 (in-sample avg dev_std = 0.023)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.851
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.774
NEC for r=0.5 class 1.0 = 0.09 +- 0.292 (in-sample avg dev_std = 0.023)
NEC for r=0.5 all KL = 0.102 +- 0.292 (in-sample avg dev_std = 0.023)
NEC for r=0.5 all L1 = 0.09 +- 0.255 (in-sample avg dev_std = 0.023)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.851
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.774
NEC for r=0.4 class 1.0 = 0.09 +- 0.292 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all KL = 0.102 +- 0.292 (in-sample avg dev_std = 0.023)
NEC for r=0.4 all L1 = 0.09 +- 0.255 (in-sample avg dev_std = 0.023)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.851
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11157820097244732
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.658
NEC for r=0.3 class 1.0 = 0.178 +- 0.402 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.214 +- 0.402 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.178 +- 0.337 (in-sample avg dev_std = 0.195)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:54:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:54:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.081
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.081
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.086
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.111
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.6 =  0.004
SUFF_SIMPLE for r=0.6 class 1.0 = 0.14 +- 0.061 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.6 all KL = 0.009 +- 0.061 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.6 all L1 = 0.14 +- 0.049 (in-sample avg dev_std = 0.041)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.5 =  0.004
SUFF_SIMPLE for r=0.5 class 1.0 = 0.14 +- 0.061 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.5 all KL = 0.009 +- 0.061 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.5 all L1 = 0.14 +- 0.049 (in-sample avg dev_std = 0.041)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0980649819494585
len(reference) = 6
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.833
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.628 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.761 +- 0.346 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.882 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.878 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.882 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.878 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013015873015873017
len(reference) = 1
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- nan (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- nan (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- nan (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08550769854132902
len(reference) = 2457
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.623
SUFF_SIMPLE for r=0.6 class 1.0 = 0.808 +- 0.406 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.6 all KL = 0.78 +- 0.406 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.6 all L1 = 0.808 +- 0.352 (in-sample avg dev_std = 0.073)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.838
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08550769854132902
len(reference) = 2457
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.623
SUFF_SIMPLE for r=0.5 class 1.0 = 0.808 +- 0.406 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.5 all KL = 0.78 +- 0.406 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.5 all L1 = 0.808 +- 0.352 (in-sample avg dev_std = 0.073)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.647
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11143233387358184
len(reference) = 34
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.471
SUFF_SIMPLE for r=0.4 class 1.0 = 0.756 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.756 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.6 =  0.054
NEC for r=0.6 class 1.0 = 0.834 +- 0.146 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.972 +- 0.146 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.834 +- 0.127 (in-sample avg dev_std = 0.330)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.5 =  0.054
NEC for r=0.5 class 1.0 = 0.834 +- 0.146 (in-sample avg dev_std = 0.330)
NEC for r=0.5 all KL = 0.972 +- 0.146 (in-sample avg dev_std = 0.330)
NEC for r=0.5 all L1 = 0.834 +- 0.127 (in-sample avg dev_std = 0.330)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0980649819494585
len(reference) = 277
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.023
NEC for r=0.4 class 1.0 = 0.856 +- 0.021 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all L1 = 0.856 +- 0.018 (in-sample avg dev_std = 0.290)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09794945848375451
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.027
NEC for r=0.3 class 1.0 = 0.854 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.854 +- 0.020 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.113
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08550769854132902
len(reference) = 2468
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.663
NEC for r=0.6 class 1.0 = 0.164 +- 0.390 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all KL = 0.198 +- 0.390 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all L1 = 0.164 +- 0.325 (in-sample avg dev_std = 0.205)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08550769854132902
len(reference) = 2468
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.663
NEC for r=0.5 class 1.0 = 0.164 +- 0.390 (in-sample avg dev_std = 0.205)
NEC for r=0.5 all KL = 0.198 +- 0.390 (in-sample avg dev_std = 0.205)
NEC for r=0.5 all L1 = 0.164 +- 0.325 (in-sample avg dev_std = 0.205)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11143233387358184
len(reference) = 2468
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.656
NEC for r=0.4 class 1.0 = 0.164 +- 0.392 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all KL = 0.201 +- 0.392 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all L1 = 0.164 +- 0.325 (in-sample avg dev_std = 0.207)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11149716369529984
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.658
NEC for r=0.3 class 1.0 = 0.164 +- 0.393 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all KL = 0.201 +- 0.393 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all L1 = 0.164 +- 0.323 (in-sample avg dev_std = 0.211)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 15:58:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 03:58:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
/home/azzolin/sedignn/global_local_sedignn/GOOD/kernel/pipelines/basic_pipeline.py:1153: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1808.)
  print(f"{metric.upper()} for r={ratio} class {c} = {scores[c][-1]} +- {aggr['KL'].std():.3f} (in-sample avg dev_std = {(aggr_std**2).mean().sqrt():.3f})")
/home/azzolin/sedignn/global_local_sedignn/GOOD/kernel/pipelines/basic_pipeline.py:1156: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1808.)
  print(f"{metric.upper()} for r={ratio} all {m} = {scores[f'all_{m}'][-1]} +- {aggr[f'{m}'].std():.3f} (in-sample avg dev_std = {(aggr_std**2).mean().sqrt():.3f})")
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.037
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.037
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.049
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0862346570397112
len(reference) = 277
Effective ratio: 0.307 +- 0.203
Model Accuracy over intervened graphs for r=0.4 =  0.025
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.167 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.042 +- 0.167 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.164 +- 0.138 (in-sample avg dev_std = 0.001)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010383333333333333
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048649108589951376
len(reference) = 2457
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.6 =  0.588
SUFF_SIMPLE for r=0.6 class 1.0 = 0.784 +- 0.427 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 all KL = 0.747 +- 0.427 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 all L1 = 0.784 +- 0.361 (in-sample avg dev_std = 0.171)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.82
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.048649108589951376
len(reference) = 2457
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.5 =  0.588
SUFF_SIMPLE for r=0.5 class 1.0 = 0.784 +- 0.427 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.5 all KL = 0.747 +- 0.427 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.5 all L1 = 0.784 +- 0.361 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.82
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08621636952998378
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.591
SUFF_SIMPLE for r=0.4 class 1.0 = 0.785 +- 0.425 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all KL = 0.749 +- 0.425 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all L1 = 0.785 +- 0.361 (in-sample avg dev_std = 0.157)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.6 =  0.352
NEC for r=0.6 class 1.0 = 0.594 +- 0.400 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all KL = 0.724 +- 0.400 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all L1 = 0.594 +- 0.358 (in-sample avg dev_std = 0.083)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.5 =  0.352
NEC for r=0.5 class 1.0 = 0.594 +- 0.400 (in-sample avg dev_std = 0.083)
NEC for r=0.5 all KL = 0.724 +- 0.400 (in-sample avg dev_std = 0.083)
NEC for r=0.5 all L1 = 0.594 +- 0.358 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0862346570397112
len(reference) = 277
Effective ratio: 0.307 +- 0.203
Model Accuracy over intervened graphs for r=0.4 =  0.023
NEC for r=0.4 class 1.0 = 0.85 +- 0.070 (in-sample avg dev_std = 0.250)
NEC for r=0.4 all KL = 0.982 +- 0.070 (in-sample avg dev_std = 0.250)
NEC for r=0.4 all L1 = 0.85 +- 0.046 (in-sample avg dev_std = 0.250)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09812996389891697
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.028
NEC for r=0.3 class 1.0 = 0.849 +- 0.071 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.982 +- 0.071 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.849 +- 0.040 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.012
NEC for r=0.6 class 1.0 = 0.102 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.1 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.102 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.012
NEC for r=0.5 class 1.0 = 0.102 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.1 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.102 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010383333333333333
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013016269841269842
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048649108589951376
len(reference) = 2468
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.6 =  0.765
NEC for r=0.6 class 1.0 = 0.068 +- 0.246 (in-sample avg dev_std = 0.021)
NEC for r=0.6 all KL = 0.074 +- 0.246 (in-sample avg dev_std = 0.021)
NEC for r=0.6 all L1 = 0.068 +- 0.218 (in-sample avg dev_std = 0.021)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.816
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.048649108589951376
len(reference) = 2468
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.5 =  0.765
NEC for r=0.5 class 1.0 = 0.068 +- 0.246 (in-sample avg dev_std = 0.021)
NEC for r=0.5 all KL = 0.074 +- 0.246 (in-sample avg dev_std = 0.021)
NEC for r=0.5 all L1 = 0.068 +- 0.218 (in-sample avg dev_std = 0.021)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08621636952998378
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.664
NEC for r=0.4 class 1.0 = 0.147 +- 0.367 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all KL = 0.171 +- 0.367 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all L1 = 0.147 +- 0.312 (in-sample avg dev_std = 0.136)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11164181523500812
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.657
NEC for r=0.3 class 1.0 = 0.154 +- 0.379 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.186 +- 0.379 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.154 +- 0.314 (in-sample avg dev_std = 0.200)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.019, 0.027, 1.0, 1.0], 'all_L1': [0.143, 0.149, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.599, 1.0, 1.0], 'all_L1': [0.137, 0.673, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.035, 1.0], 'all_L1': [0.143, 0.143, 0.155, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.026, 0.029, 1.0], 'all_L1': [0.145, 0.145, 0.148, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.024, 1.0], 'all_L1': [0.145, 0.145, 0.145, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.016, 0.026, 1.0], 'all_L1': [0.141, 0.141, 0.149, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.021, 0.021], 'all_L1': [0.144, 0.144, 0.144, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.009, 1.0], 'all_L1': [0.138, 0.138, 0.138, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.628, 1.0], 'all_L1': [0.14, 0.14, 0.761, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.017, 0.042, 1.0], 'all_L1': [0.142, 0.142, 0.164, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.685, 0.98, 0.98, 0.98], 'all_L1': [0.568, 0.848, 0.85, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.975, 0.996, 0.996, 0.996], 'all_L1': [0.834, 0.853, 0.853, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.761, 0.978, 0.978], 'all_L1': [0.634, 0.634, 0.849, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.715, 0.73, 0.832, 0.974], 'all_L1': [0.6, 0.615, 0.708, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.751, 0.751, 0.818, 0.976], 'all_L1': [0.629, 0.629, 0.694, 0.845]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.704, 0.983, 0.983], 'all_L1': [0.58, 0.58, 0.847, 0.851]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.703, 0.703, 0.703], 'all_L1': [0.591, 0.591, 0.591, 0.591]}), defaultdict(<class 'list'>, {'all_KL': [0.694, 0.694, 0.694, 0.991], 'all_L1': [0.571, 0.571, 0.571, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.972, 0.972, 0.994, 0.994], 'all_L1': [0.834, 0.834, 0.856, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.724, 0.724, 0.982, 0.982], 'all_L1': [0.594, 0.594, 0.85, 0.849]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.284, 0.284, 1.0, 1.0], 'all_L1': [0.349, 0.349, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.661, 1.0, 1.0], 'all_L1': [0.559, 0.699, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.328, 0.328, 1.0], 'all_L1': [0.371, 0.371, 0.371, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.743, 0.743, 1.0], 'all_L1': [0.739, 0.739, 0.739, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.464, 0.464, 1.0], 'all_L1': [0.493, 0.493, 0.493, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.585, 1.0], 'all_L1': [0.583, 0.583, 0.583, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.027, 0.027, 0.027], 'all_L1': [0.151, 0.151, 0.151, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 0.845, 1.0], 'all_L1': [0.839, 0.839, 0.839, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.882, 1.0, 1.0], 'all_L1': [0.878, 0.878, 1.0, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.892, 0.892, 1.0], 'all_L1': [0.89, 0.89, 0.89, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.613, 0.715, 0.716, 0.716], 'all_L1': [0.553, 0.651, 0.651, 0.651]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.463, 0.463, 0.463], 'all_L1': [0.441, 0.441, 0.441, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.672, 0.672], 'all_L1': [0.546, 0.546, 0.629, 0.629]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.241, 0.243, 0.257], 'all_L1': [0.245, 0.245, 0.248, 0.261]}), defaultdict(<class 'list'>, {'all_KL': [0.485, 0.485, 0.485, 0.536], 'all_L1': [0.456, 0.456, 0.457, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.367, 0.367, 0.415, 0.415], 'all_L1': [0.375, 0.375, 0.417, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.765, 0.765, 0.765], 'all_L1': [0.653, 0.653, 0.653, 0.653]}), defaultdict(<class 'list'>, {'all_KL': [0.147, 0.147, 0.147, 0.155], 'all_L1': [0.155, 0.155, 0.155, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.118, 0.118, 0.118], 'all_L1': [0.122, 0.122, 0.122, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.1, 0.108, 0.108], 'all_L1': [0.102, 0.102, 0.11, 0.11]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.734, 0.736, 1.0, 1.0], 'all_L1': [0.775, 0.776, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.769, 0.876, 1.0, 1.0], 'all_L1': [0.8, 0.885, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.755, 0.755, 0.754, 1.0], 'all_L1': [0.791, 0.791, 0.791, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.745, 0.744, 1.0], 'all_L1': [0.782, 0.782, 0.781, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.746, 0.745, 1.0], 'all_L1': [0.786, 0.786, 0.786, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.737, 0.737, 0.736, 1.0], 'all_L1': [0.774, 0.774, 0.773, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.757, 0.757, 0.757, 0.757], 'all_L1': [0.794, 0.794, 0.794, 0.794]}), defaultdict(<class 'list'>, {'all_KL': [0.719, 0.719, 0.719, 1.0], 'all_L1': [0.761, 0.761, 0.761, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.78, 0.78, 0.744, 1.0], 'all_L1': [0.808, 0.808, 0.756, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.749, 1.0], 'all_L1': [0.784, 0.784, 0.785, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.079, 0.188, 0.2, 0.2], 'all_L1': [0.071, 0.16, 0.165, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.211, 0.211, 0.211], 'all_L1': [0.174, 0.174, 0.174, 0.174]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.068, 0.167, 0.179], 'all_L1': [0.061, 0.061, 0.142, 0.148]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.075, 0.097, 0.188], 'all_L1': [0.068, 0.069, 0.086, 0.157]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.075, 0.084, 0.187], 'all_L1': [0.066, 0.066, 0.072, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.077, 0.181, 0.197], 'all_L1': [0.071, 0.071, 0.156, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.07, 0.07, 0.07], 'all_L1': [0.063, 0.063, 0.063, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.102, 0.102, 0.102, 0.214], 'all_L1': [0.09, 0.09, 0.09, 0.178]}), defaultdict(<class 'list'>, {'all_KL': [0.198, 0.198, 0.201, 0.201], 'all_L1': [0.164, 0.164, 0.164, 0.164]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.074, 0.171, 0.186], 'all_L1': [0.068, 0.068, 0.147, 0.154]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.142 +- 0.003, 0.196 +- 0.159, 0.380 +- 0.359, 0.914 +- 0.257
suff_simple class all_KL  =  0.017 +- 0.007, 0.077 +- 0.174, 0.281 +- 0.401, 0.902 +- 0.294
[[0.0, 0.007220216561108828, -1.0, -1.0], [0.0, 0.6326530575752258, -1.0, -1.0], [0.0, 0.0, 0.014492753893136978, -1.0], [0.0, 0.0, 0.003610108280554414, -1.0], [0.0004512635350693017, 0.0004512635350693017, 0.0009025270701386034, -1.0], [0.0009025270701386034, 0.0009025270701386034, 0.010830325074493885, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0004512635350693017, 0.0004512635350693017, 0.0004512635350693017, -1.0], [0.004061372019350529, 0.004061372019350529, 0.8333333134651184, -1.0], [0.0, 0.0, 0.02527075819671154, -1.0]]
[[0.019, 0.027, 1.0, 1.0], [0.004, 0.599, 1.0, 1.0], [0.021, 0.021, 0.035, 1.0], [0.026, 0.026, 0.029, 1.0], [0.024, 0.024, 0.024, 1.0], [0.016, 0.016, 0.026, 1.0], [0.021, 0.021, 0.021, 0.021], [0.009, 0.009, 0.009, 1.0], [0.009, 0.009, 0.628, 1.0], [0.017, 0.017, 0.042, 1.0]]
suff_simple_acc_int  =  0.001 +- 0.001, 0.065 +- 0.189, -0.111 +- 0.507, -0.900 +- 0.300
nec class all_L1  =  0.643 +- 0.097, 0.675 +- 0.113, 0.767 +- 0.110, 0.824 +- 0.078
nec class all_KL  =  0.768 +- 0.105, 0.802 +- 0.120, 0.896 +- 0.117, 0.956 +- 0.085
[[0.3659747242927551, 0.024368230253458023, 0.023465704172849655, 0.023465704172849655], [0.05324909836053848, 0.034296028316020966, 0.03474729135632515, 0.03474729135632515], [0.2748194932937622, 0.2748194932937622, 0.022563176229596138, 0.020758122205734253], [0.33212995529174805, 0.3140794336795807, 0.19945847988128662, 0.02391696721315384], [0.2915162444114685, 0.2915162444114685, 0.20983754098415375, 0.03023465722799301], [0.37906137108802795, 0.37906137108802795, 0.03113718330860138, 0.02752707526087761], [0.3185920715332031, 0.3185920715332031, 0.3185920715332031, 0.3185920715332031], [0.371841162443161, 0.371841162443161, 0.371841162443161, 0.03835739940404892], [0.05415162444114685, 0.05415162444114685, 0.02301444113254547, 0.027075812220573425], [0.3524368107318878, 0.3524368107318878, 0.022563176229596138, 0.027978340163826942]]
[[0.685, 0.98, 0.98, 0.98], [0.975, 0.996, 0.996, 0.996], [0.761, 0.761, 0.978, 0.978], [0.715, 0.73, 0.832, 0.974], [0.751, 0.751, 0.818, 0.976], [0.704, 0.704, 0.983, 0.983], [0.703, 0.703, 0.703, 0.703], [0.694, 0.694, 0.694, 0.991], [0.972, 0.972, 0.994, 0.994], [0.724, 0.724, 0.982, 0.982]]
nec_acc_int  =  0.279 +- 0.117, 0.242 +- 0.137, 0.126 +- 0.130, 0.057 +- 0.087

Eval split val
suff_simple class all_L1  =  0.585 +- 0.238, 0.599 +- 0.240, 0.707 +- 0.282, 0.915 +- 0.255
suff_simple class all_KL  =  0.559 +- 0.274, 0.571 +- 0.276, 0.688 +- 0.314, 0.903 +- 0.292
[[0.0, 0.0, -1.0, -1.0], [0.00039682540227659047, 0.5, -1.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.284, 0.284, 1.0, 1.0], [0.537, 0.661, 1.0, 1.0], [0.328, 0.328, 0.328, 1.0], [0.743, 0.743, 0.743, 1.0], [0.464, 0.464, 0.464, 1.0], [0.585, 0.585, 0.585, 1.0], [0.027, 0.027, 0.027, 0.027], [0.845, 0.845, 0.845, 1.0], [0.882, 0.882, 1.0, 1.0], [0.892, 0.892, 0.892, 1.0]]
suff_simple_acc_int  =  0.000 +- 0.000, 0.050 +- 0.150, -0.200 +- 0.400, -0.900 +- 0.300
nec class all_L1  =  0.365 +- 0.188, 0.375 +- 0.199, 0.388 +- 0.207, 0.395 +- 0.207
nec class all_KL  =  0.388 +- 0.220, 0.399 +- 0.232, 0.413 +- 0.239, 0.420 +- 0.239
[[0.12261904776096344, 0.0007936508045531809, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0], [0.1111111119389534, 0.1111111119389534, 0.0, 0.0], [0.02023809589445591, 0.02023809589445591, 0.01785714365541935, 0.0], [0.06626984477043152, 0.06626984477043152, 0.065476194024086, 0.0], [0.05595238134264946, 0.05595238134264946, 0.0, 0.0], [0.24166665971279144, 0.24166665971279144, 0.24166665971279144, 0.24166665971279144], [0.011904762126505375, 0.011904762126505375, 0.011904762126505375, 0.0], [0.0, 0.0, 0.0, 0.0], [0.012301587499678135, 0.012301587499678135, 0.0, 0.0]]
[[0.613, 0.715, 0.716, 0.716], [0.463, 0.463, 0.463, 0.463], [0.585, 0.585, 0.672, 0.672], [0.241, 0.241, 0.243, 0.257], [0.485, 0.485, 0.485, 0.536], [0.367, 0.367, 0.415, 0.415], [0.765, 0.765, 0.765, 0.765], [0.147, 0.147, 0.147, 0.155], [0.118, 0.118, 0.118, 0.118], [0.1, 0.1, 0.108, 0.108]]
nec_acc_int  =  0.064 +- 0.073, 0.052 +- 0.072, 0.034 +- 0.072, 0.024 +- 0.072

Eval split test
suff_simple class all_L1  =  0.786 +- 0.013, 0.794 +- 0.033, 0.823 +- 0.089, 0.979 +- 0.062
suff_simple class all_KL  =  0.749 +- 0.017, 0.760 +- 0.042, 0.795 +- 0.103, 0.976 +- 0.073
[[0.5853174328804016, 0.5915242433547974, -1.0, -1.0], [0.6269841194152832, 0.7252747416496277, -1.0, -1.0], [0.5905575752258301, 0.5905575752258301, 0.5931522250175476, -1.0], [0.5895909667015076, 0.5892348289489746, 0.5887261033058167, -1.0], [0.5907102227210999, 0.5907102227210999, 0.5907102227210999, -1.0], [0.5872507095336914, 0.5872507095336914, 0.5886243581771851, -1.0], [0.5935083627700806, 0.5935083627700806, 0.5935083627700806, 0.5935083627700806], [0.5889804363250732, 0.5889804363250732, 0.5889804363250732, -1.0], [0.6229649782180786, 0.6229649782180786, 0.47058823704719543, -1.0], [0.5883190631866455, 0.5883190631866455, 0.5909646153450012, -1.0]]
[[0.734, 0.736, 1.0, 1.0], [0.769, 0.876, 1.0, 1.0], [0.755, 0.755, 0.754, 1.0], [0.745, 0.745, 0.744, 1.0], [0.746, 0.746, 0.745, 1.0], [0.737, 0.737, 0.736, 1.0], [0.757, 0.757, 0.757, 0.757], [0.719, 0.719, 0.719, 1.0], [0.78, 0.78, 0.744, 1.0], [0.747, 0.747, 0.749, 1.0]]
suff_simple_acc_int  =  0.596 +- 0.014, 0.607 +- 0.041, 0.261 +- 0.631, -0.841 +- 0.478
nec class all_L1  =  0.090 +- 0.040, 0.099 +- 0.045, 0.126 +- 0.041, 0.152 +- 0.031
nec class all_KL  =  0.103 +- 0.052, 0.114 +- 0.057, 0.148 +- 0.051, 0.183 +- 0.039
[[0.7694995999336243, 0.6579213738441467, 0.6534643173217773, 0.6534643173217773], [0.6606563925743103, 0.656959056854248, 0.6566551923751831, 0.6566551923751831], [0.7675243020057678, 0.7675243020057678, 0.6657719016075134, 0.6600992679595947], [0.7741085886955261, 0.7732982039451599, 0.7488350868225098, 0.6592888832092285], [0.7739566564559937, 0.7739566564559937, 0.7653970718383789, 0.6599473357200623], [0.7714242339134216, 0.7714242339134216, 0.6656705737113953, 0.65625], [0.7671697735786438, 0.7671697735786438, 0.7671697735786438, 0.7671697735786438], [0.7742605209350586, 0.7742605209350586, 0.7742605209350586, 0.6579720377922058], [0.6630368828773499, 0.6630368828773499, 0.6559967398643494, 0.6575668454170227], [0.7648399472236633, 0.7648399472236633, 0.6642017960548401, 0.6568071246147156]]
[[0.079, 0.188, 0.2, 0.2], [0.212, 0.211, 0.211, 0.211], [0.068, 0.068, 0.167, 0.179], [0.074, 0.075, 0.097, 0.188], [0.075, 0.075, 0.084, 0.187], [0.077, 0.077, 0.181, 0.197], [0.07, 0.07, 0.07, 0.07], [0.102, 0.102, 0.102, 0.214], [0.198, 0.198, 0.201, 0.201], [0.074, 0.074, 0.171, 0.186]]
nec_acc_int  =  0.749 +- 0.044, 0.737 +- 0.051, 0.702 +- 0.051, 0.669 +- 0.033


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.393 +- 0.048, 0.435 +- 0.120, 0.574 +- 0.213, 0.869 +- 0.167
Faith. Armon (L1)= 		  =  0.232 +- 0.005, 0.286 +- 0.156, 0.437 +- 0.293, 0.850 +- 0.206
Faith. GMean (L1)= 	  =  0.301 +- 0.020, 0.351 +- 0.138, 0.496 +- 0.258, 0.859 +- 0.189
Faith. Aritm (KL)= 		  =  0.392 +- 0.050, 0.439 +- 0.130, 0.589 +- 0.236, 0.929 +- 0.189
Faith. Armon (KL)= 		  =  0.032 +- 0.013, 0.108 +- 0.214, 0.312 +- 0.402, 0.897 +- 0.285
Faith. GMean (KL)= 	  =  0.108 +- 0.023, 0.184 +- 0.197, 0.382 +- 0.361, 0.905 +- 0.261

Eval split val
Faith. Aritm (L1)= 		  =  0.475 +- 0.029, 0.487 +- 0.040, 0.547 +- 0.121, 0.655 +- 0.127
Faith. Armon (L1)= 		  =  0.357 +- 0.113, 0.364 +- 0.121, 0.412 +- 0.182, 0.479 +- 0.223
Faith. GMean (L1)= 	  =  0.406 +- 0.069, 0.415 +- 0.081, 0.469 +- 0.151, 0.553 +- 0.185
Faith. Aritm (KL)= 		  =  0.474 +- 0.031, 0.485 +- 0.039, 0.551 +- 0.131, 0.662 +- 0.137
Faith. Armon (KL)= 		  =  0.329 +- 0.140, 0.335 +- 0.147, 0.394 +- 0.219, 0.469 +- 0.264
Faith. GMean (KL)= 	  =  0.383 +- 0.101, 0.392 +- 0.110, 0.454 +- 0.186, 0.544 +- 0.224

Eval split test
Faith. Aritm (L1)= 		  =  0.438 +- 0.025, 0.446 +- 0.035, 0.474 +- 0.057, 0.566 +- 0.046
Faith. Armon (L1)= 		  =  0.158 +- 0.062, 0.172 +- 0.069, 0.216 +- 0.064, 0.263 +- 0.050
Faith. GMean (L1)= 	  =  0.260 +- 0.055, 0.274 +- 0.064, 0.318 +- 0.065, 0.384 +- 0.055
Faith. Aritm (KL)= 		  =  0.426 +- 0.032, 0.437 +- 0.044, 0.472 +- 0.069, 0.580 +- 0.056
Faith. Armon (KL)= 		  =  0.177 +- 0.075, 0.193 +- 0.084, 0.247 +- 0.077, 0.308 +- 0.062
Faith. GMean (KL)= 	  =  0.271 +- 0.065, 0.287 +- 0.075, 0.339 +- 0.077, 0.421 +- 0.065
Computed for split load_split = id



Completed in  0:39:31.916278  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:02:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:02:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.097
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.110
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.110


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.143 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.019 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.143 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.143 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.019 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.143 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.475
SUFF_SIMPLE for r=0.6 class 1.0 = 0.682 +- 0.476 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all KL = 0.626 +- 0.476 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all L1 = 0.682 +- 0.408 (in-sample avg dev_std = 0.148)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.476
SUFF_SIMPLE for r=0.5 class 1.0 = 0.683 +- 0.477 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.5 all KL = 0.629 +- 0.477 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.5 all L1 = 0.683 +- 0.409 (in-sample avg dev_std = 0.157)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.332
NEC for r=0.6 class 1.0 = 0.585 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.682 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.585 +- 0.384 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.087
NEC for r=0.5 class 1.0 = 0.784 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.898 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.784 +- 0.238 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09688808664259928
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.857 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all KL = 0.981 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.050)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09688808664259928
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.857 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.3 all KL = 0.981 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.3 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.050)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.076
NEC for r=0.6 class 1.0 = 0.595 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.659 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.595 +- 0.359 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.036
NEC for r=0.5 class 1.0 = 0.626 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.695 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.626 +- 0.347 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.724
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.808
NEC for r=0.6 class 1.0 = 0.063 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.075 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.063 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.797
NEC for r=0.5 class 1.0 = 0.095 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.112 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.095 +- 0.256 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11026742301458671
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.582
NEC for r=0.4 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all KL = 0.264 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all L1 = 0.224 +- 0.369 (in-sample avg dev_std = 0.174)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11026742301458671
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.582
NEC for r=0.3 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all KL = 0.264 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all L1 = 0.224 +- 0.369 (in-sample avg dev_std = 0.174)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:06:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:06:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.145
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.107
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.103
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.155
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.121
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.117
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.117


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.094
SUFF_SIMPLE for r=0.6 class 1.0 = 0.215 +- 0.280 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.092 +- 0.280 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.215 +- 0.244 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10736823104693141
len(reference) = 98
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.5 =  0.898
SUFF_SIMPLE for r=0.5 class 1.0 = 0.893 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.849 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.893 +- 0.247 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.008
SUFF_SIMPLE for r=0.6 class 1.0 = 0.557 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.557 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.595
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013078174603174605
len(reference) = 158
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.5 =  0.335
SUFF_SIMPLE for r=0.5 class 1.0 = 0.724 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.726 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.724 +- 0.306 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.803
SUFF_SIMPLE for r=0.6 class 1.0 = 0.903 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.884 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.903 +- 0.261 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.881
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.12139262560777957
len(reference) = 1149
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.845
SUFF_SIMPLE for r=0.5 class 1.0 = 0.958 +- 0.179 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.955 +- 0.179 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.958 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.004)
NEC for r=0.6 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.004)
NEC for r=0.6 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.004)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10736823104693141
len(reference) = 277
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.048)
NEC for r=0.5 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.048)
NEC for r=0.5 all L1 = 0.863 +- 0.007 (in-sample avg dev_std = 0.048)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10349097472924189
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.4 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.4 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.060)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10349097472924189
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.465
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013078174603174605
len(reference) = 2520
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.465
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013076587301587303
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013076587301587303
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.583
NEC for r=0.6 class 1.0 = 0.236 +- 0.442 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all KL = 0.279 +- 0.442 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all L1 = 0.236 +- 0.375 (in-sample avg dev_std = 0.162)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.846
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.12139262560777957
len(reference) = 2468
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.587
NEC for r=0.5 class 1.0 = 0.233 +- 0.441 (in-sample avg dev_std = 0.170)
NEC for r=0.5 all KL = 0.28 +- 0.441 (in-sample avg dev_std = 0.170)
NEC for r=0.5 all L1 = 0.233 +- 0.372 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.846
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11721029173419774
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.586
NEC for r=0.4 class 1.0 = 0.233 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all KL = 0.275 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all L1 = 0.233 +- 0.374 (in-sample avg dev_std = 0.167)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.846
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11721029173419774
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.586
NEC for r=0.3 class 1.0 = 0.233 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all KL = 0.275 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all L1 = 0.233 +- 0.374 (in-sample avg dev_std = 0.167)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:10:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:10:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.092
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.105


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.144 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.144 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.144 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.144 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.481
SUFF_SIMPLE for r=0.6 class 1.0 = 0.697 +- 0.470 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all KL = 0.645 +- 0.470 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all L1 = 0.697 +- 0.402 (in-sample avg dev_std = 0.146)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.481
SUFF_SIMPLE for r=0.5 class 1.0 = 0.697 +- 0.470 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all KL = 0.645 +- 0.470 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all L1 = 0.697 +- 0.402 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.481
SUFF_SIMPLE for r=0.4 class 1.0 = 0.697 +- 0.472 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all KL = 0.645 +- 0.472 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all L1 = 0.697 +- 0.402 (in-sample avg dev_std = 0.145)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.285
NEC for r=0.6 class 1.0 = 0.637 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.746 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.637 +- 0.344 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.285
NEC for r=0.5 class 1.0 = 0.637 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.746 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.637 +- 0.344 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.076
NEC for r=0.4 class 1.0 = 0.797 +- 0.250 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.913 +- 0.250 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.797 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.996
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09193862815884478
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.857 +- 0.071 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all KL = 0.979 +- 0.071 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all L1 = 0.857 +- 0.035 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.041
NEC for r=0.6 class 1.0 = 0.6 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.64 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.6 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.041
NEC for r=0.5 class 1.0 = 0.6 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.64 +- 0.407 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.6 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.01
NEC for r=0.4 class 1.0 = 0.625 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.669 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.625 +- 0.331 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012926190476190475
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.629 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.672 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.629 +- 0.330 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.795
NEC for r=0.6 class 1.0 = 0.075 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.088 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.075 +- 0.231 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.815
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.795
NEC for r=0.5 class 1.0 = 0.075 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.088 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.075 +- 0.231 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.815
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.798
NEC for r=0.4 class 1.0 = 0.1 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.117 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.1 +- 0.267 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10485737439222043
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.588
NEC for r=0.3 class 1.0 = 0.208 +- 0.422 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.245 +- 0.422 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.208 +- 0.358 (in-sample avg dev_std = 0.161)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:13:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:13:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.087
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.099


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.481
SUFF_SIMPLE for r=0.6 class 1.0 = 0.688 +- 0.472 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.6 all KL = 0.635 +- 0.472 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.6 all L1 = 0.688 +- 0.404 (in-sample avg dev_std = 0.153)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.825
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.481
SUFF_SIMPLE for r=0.5 class 1.0 = 0.688 +- 0.472 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.5 all KL = 0.635 +- 0.472 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.5 all L1 = 0.688 +- 0.404 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.481
SUFF_SIMPLE for r=0.4 class 1.0 = 0.689 +- 0.473 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 all KL = 0.638 +- 0.473 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 all L1 = 0.689 +- 0.404 (in-sample avg dev_std = 0.148)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.318
NEC for r=0.6 class 1.0 = 0.603 +- 0.415 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.701 +- 0.415 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.603 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.318
NEC for r=0.5 class 1.0 = 0.603 +- 0.415 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.701 +- 0.415 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.603 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.076
NEC for r=0.4 class 1.0 = 0.793 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.905 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.793 +- 0.219 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.08690974729241878
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.855 +- 0.081 (in-sample avg dev_std = 0.012)
NEC for r=0.3 all KL = 0.974 +- 0.081 (in-sample avg dev_std = 0.012)
NEC for r=0.3 all L1 = 0.855 +- 0.038 (in-sample avg dev_std = 0.012)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.015
NEC for r=0.6 class 1.0 = 0.254 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.25 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.254 +- 0.345 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.015
NEC for r=0.5 class 1.0 = 0.254 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.25 +- 0.373 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.254 +- 0.345 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.004
NEC for r=0.4 class 1.0 = 0.262 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.259 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.262 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.254
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012841269841269841
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.261 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.257 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.261 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.795
NEC for r=0.6 class 1.0 = 0.075 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.086 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.075 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.822
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.795
NEC for r=0.5 class 1.0 = 0.075 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.086 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.075 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.822
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.794
NEC for r=0.4 class 1.0 = 0.098 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.113 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.098 +- 0.264 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.822
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09927066450567261
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 1.0 = 0.218 +- 0.427 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all KL = 0.255 +- 0.427 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all L1 = 0.218 +- 0.363 (in-sample avg dev_std = 0.164)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:17:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:17:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.481
SUFF_SIMPLE for r=0.6 class 1.0 = 0.691 +- 0.473 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all KL = 0.636 +- 0.473 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all L1 = 0.691 +- 0.405 (in-sample avg dev_std = 0.146)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.481
SUFF_SIMPLE for r=0.5 class 1.0 = 0.691 +- 0.473 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all KL = 0.636 +- 0.473 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all L1 = 0.691 +- 0.405 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.48
SUFF_SIMPLE for r=0.4 class 1.0 = 0.691 +- 0.474 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.474 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all L1 = 0.691 +- 0.406 (in-sample avg dev_std = 0.149)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.314
NEC for r=0.6 class 1.0 = 0.598 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.696 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.598 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.314
NEC for r=0.5 class 1.0 = 0.598 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.696 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.598 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.094
NEC for r=0.4 class 1.0 = 0.777 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.886 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.777 +- 0.247 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.989
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09388086642599279
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.855 +- 0.085 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all KL = 0.976 +- 0.085 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all L1 = 0.855 +- 0.046 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.038
NEC for r=0.6 class 1.0 = 0.485 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.51 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.485 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.038
NEC for r=0.5 class 1.0 = 0.485 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.51 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.485 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.008
NEC for r=0.4 class 1.0 = 0.507 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.536 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.507 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012959126984126983
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.507 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.536 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.507 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.808
NEC for r=0.6 class 1.0 = 0.06 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.071 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.06 +- 0.202 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.826
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.808
NEC for r=0.5 class 1.0 = 0.06 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.071 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.06 +- 0.202 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.826
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.799
NEC for r=0.4 class 1.0 = 0.088 +- 0.289 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.101 +- 0.289 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.088 +- 0.250 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10702552674230147
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 1.0 = 0.214 +- 0.428 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all KL = 0.254 +- 0.428 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all L1 = 0.214 +- 0.363 (in-sample avg dev_std = 0.168)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:21:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:21:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.141 +- 0.046 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 all L1 = 0.141 +- 0.017 (in-sample avg dev_std = 0.011)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.141 +- 0.046 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.5 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.5 all L1 = 0.141 +- 0.017 (in-sample avg dev_std = 0.011)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.14 +- 0.046 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.14 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.477
SUFF_SIMPLE for r=0.6 class 1.0 = 0.68 +- 0.472 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.6 all KL = 0.627 +- 0.472 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.6 all L1 = 0.68 +- 0.405 (in-sample avg dev_std = 0.149)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.477
SUFF_SIMPLE for r=0.5 class 1.0 = 0.68 +- 0.472 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.5 all KL = 0.627 +- 0.472 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.5 all L1 = 0.68 +- 0.405 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.477
SUFF_SIMPLE for r=0.4 class 1.0 = 0.68 +- 0.473 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all KL = 0.628 +- 0.473 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all L1 = 0.68 +- 0.406 (in-sample avg dev_std = 0.149)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.347
NEC for r=0.6 class 1.0 = 0.588 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.68 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.588 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.347
NEC for r=0.5 class 1.0 = 0.588 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.68 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.588 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.09
NEC for r=0.4 class 1.0 = 0.785 +- 0.272 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.9 +- 0.272 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.785 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09389891696750903
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.859 +- 0.046 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all KL = 0.984 +- 0.046 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all L1 = 0.859 +- 0.017 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.027
NEC for r=0.6 class 1.0 = 0.401 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.395 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.401 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.027
NEC for r=0.5 class 1.0 = 0.401 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.395 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.401 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.004
NEC for r=0.4 class 1.0 = 0.417 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.416 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012961904761904763
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.415 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.81
NEC for r=0.6 class 1.0 = 0.071 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.08 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.071 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.831
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.81
NEC for r=0.5 class 1.0 = 0.071 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.08 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.071 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.799
NEC for r=0.4 class 1.0 = 0.098 +- 0.294 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.112 +- 0.294 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.098 +- 0.256 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10701701782820097
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 1.0 = 0.225 +- 0.429 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all KL = 0.263 +- 0.429 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all L1 = 0.225 +- 0.366 (in-sample avg dev_std = 0.171)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:25:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:25:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.041 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.041 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.041 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.145 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.145 +- 0.041 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.486
SUFF_SIMPLE for r=0.6 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all KL = 0.643 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all L1 = 0.7 +- 0.400 (in-sample avg dev_std = 0.148)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.817
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.486
SUFF_SIMPLE for r=0.5 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.5 all KL = 0.643 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.5 all L1 = 0.7 +- 0.400 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.817
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 all KL = 0.643 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 all L1 = 0.7 +- 0.400 (in-sample avg dev_std = 0.148)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.3 =  0.486
SUFF_SIMPLE for r=0.3 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.3 all KL = 0.643 +- 0.470 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.3 all L1 = 0.7 +- 0.400 (in-sample avg dev_std = 0.148)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.307
NEC for r=0.6 class 1.0 = 0.614 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.718 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.614 +- 0.369 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.307
NEC for r=0.5 class 1.0 = 0.614 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.718 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.614 +- 0.369 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.307
NEC for r=0.4 class 1.0 = 0.614 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.718 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.614 +- 0.369 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.3 =  0.307
NEC for r=0.3 class 1.0 = 0.614 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.718 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.614 +- 0.369 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.097
NEC for r=0.6 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.097
NEC for r=0.5 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.097
NEC for r=0.4 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 1.0 = 0.77 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.896 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.77 +- 0.249 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.814
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.793
NEC for r=0.5 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.814
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.793
NEC for r=0.4 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.3 =  0.793
NEC for r=0.3 class 1.0 = 0.068 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.068 +- 0.220 (in-sample avg dev_std = 0.000)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:29:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:29:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.14 +- 0.034 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.14 +- 0.012 (in-sample avg dev_std = 0.004)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.14 +- 0.034 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.5 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.5 all L1 = 0.14 +- 0.012 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.14 +- 0.034 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all L1 = 0.14 +- 0.012 (in-sample avg dev_std = 0.004)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.48
SUFF_SIMPLE for r=0.6 class 1.0 = 0.668 +- 0.479 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 all KL = 0.606 +- 0.479 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 all L1 = 0.668 +- 0.410 (in-sample avg dev_std = 0.155)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.855
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.48
SUFF_SIMPLE for r=0.5 class 1.0 = 0.668 +- 0.479 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.5 all KL = 0.606 +- 0.479 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.5 all L1 = 0.668 +- 0.410 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.855
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.48
SUFF_SIMPLE for r=0.4 class 1.0 = 0.668 +- 0.479 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all KL = 0.606 +- 0.479 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all L1 = 0.668 +- 0.410 (in-sample avg dev_std = 0.155)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.35
NEC for r=0.6 class 1.0 = 0.567 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.662 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.567 +- 0.398 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.35
NEC for r=0.5 class 1.0 = 0.567 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.662 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.567 +- 0.398 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.35
NEC for r=0.4 class 1.0 = 0.567 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.662 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.567 +- 0.398 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0951768953068592
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.862 +- 0.034 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all KL = 0.991 +- 0.034 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all L1 = 0.862 +- 0.011 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.01
NEC for r=0.6 class 1.0 = 0.158 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.152 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.158 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.01
NEC for r=0.5 class 1.0 = 0.158 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.152 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.158 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.01
NEC for r=0.4 class 1.0 = 0.158 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.152 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.158 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012976587301587305
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.161 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.155 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.161 +- 0.297 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.817
NEC for r=0.6 class 1.0 = 0.068 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.079 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.068 +- 0.217 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.851
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.817
NEC for r=0.5 class 1.0 = 0.068 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.079 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.068 +- 0.217 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.851
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.817
NEC for r=0.4 class 1.0 = 0.068 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.079 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.068 +- 0.217 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.851
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10844165316045382
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 1.0 = 0.237 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.3 all KL = 0.28 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.3 all L1 = 0.237 +- 0.376 (in-sample avg dev_std = 0.163)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:33:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:33:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.145
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.145
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.105
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.101
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.155
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.155
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.119
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.115


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.083
SUFF_SIMPLE for r=0.6 class 1.0 = 0.206 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.082 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.206 +- 0.228 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.083
SUFF_SIMPLE for r=0.5 class 1.0 = 0.206 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.082 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.206 +- 0.228 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1054187725631769
len(reference) = 98
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.4 =  0.867
SUFF_SIMPLE for r=0.4 class 1.0 = 0.861 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.818 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.861 +- 0.277 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.004
SUFF_SIMPLE for r=0.6 class 1.0 = 0.874 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.877 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.874 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.004
SUFF_SIMPLE for r=0.5 class 1.0 = 0.874 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.877 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.874 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.152
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013048809523809525
len(reference) = 158
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.4 =  0.063
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.892 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.797
SUFF_SIMPLE for r=0.6 class 1.0 = 0.907 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.894 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.907 +- 0.257 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.838
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.5 =  0.797
SUFF_SIMPLE for r=0.5 class 1.0 = 0.907 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.894 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.907 +- 0.257 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.866
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11942625607779578
len(reference) = 1149
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.4 =  0.833
SUFF_SIMPLE for r=0.4 class 1.0 = 0.958 +- 0.192 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.949 +- 0.192 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.958 +- 0.156 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.863 +- 0.021 (in-sample avg dev_std = 0.043)
NEC for r=0.6 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.043)
NEC for r=0.6 all L1 = 0.863 +- 0.007 (in-sample avg dev_std = 0.043)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.863 +- 0.021 (in-sample avg dev_std = 0.043)
NEC for r=0.5 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.043)
NEC for r=0.5 all L1 = 0.863 +- 0.007 (in-sample avg dev_std = 0.043)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1054187725631769
len(reference) = 277
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.863 +- 0.021 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all L1 = 0.863 +- 0.007 (in-sample avg dev_std = 0.028)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10110108303249099
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.863 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all L1 = 0.863 +- 0.007 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.113
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013048809523809525
len(reference) = 2520
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0130484126984127
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.58
NEC for r=0.6 class 1.0 = 0.227 +- 0.436 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all KL = 0.269 +- 0.436 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all L1 = 0.227 +- 0.370 (in-sample avg dev_std = 0.170)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.5 =  0.58
NEC for r=0.5 class 1.0 = 0.227 +- 0.436 (in-sample avg dev_std = 0.170)
NEC for r=0.5 all KL = 0.269 +- 0.436 (in-sample avg dev_std = 0.170)
NEC for r=0.5 all L1 = 0.227 +- 0.370 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11942625607779578
len(reference) = 2468
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.4 =  0.585
NEC for r=0.4 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all KL = 0.268 +- 0.434 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all L1 = 0.224 +- 0.367 (in-sample avg dev_std = 0.170)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11474027552674232
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.584
NEC for r=0.3 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.173)
NEC for r=0.3 all KL = 0.264 +- 0.434 (in-sample avg dev_std = 0.173)
NEC for r=0.3 all L1 = 0.224 +- 0.368 (in-sample avg dev_std = 0.173)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:37:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:37:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.479
SUFF_SIMPLE for r=0.6 class 1.0 = 0.691 +- 0.471 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.6 all KL = 0.639 +- 0.471 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.6 all L1 = 0.691 +- 0.403 (in-sample avg dev_std = 0.153)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.82
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.479
SUFF_SIMPLE for r=0.5 class 1.0 = 0.691 +- 0.471 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.5 all KL = 0.639 +- 0.471 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.5 all L1 = 0.691 +- 0.403 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.82
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.478
SUFF_SIMPLE for r=0.4 class 1.0 = 0.691 +- 0.472 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 all KL = 0.641 +- 0.472 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 all L1 = 0.691 +- 0.404 (in-sample avg dev_std = 0.147)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 1.0 = 0.596 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.596 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.329
NEC for r=0.5 class 1.0 = 0.596 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.596 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.083
NEC for r=0.4 class 1.0 = 0.793 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.912 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.793 +- 0.222 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0936750902527076
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.857 +- 0.071 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all KL = 0.983 +- 0.071 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.007
NEC for r=0.6 class 1.0 = 0.106 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.104 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.106 +- 0.253 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.007
NEC for r=0.5 class 1.0 = 0.106 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.104 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.106 +- 0.253 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.002
NEC for r=0.4 class 1.0 = 0.11 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.109 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012958730158730157
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.795
NEC for r=0.6 class 1.0 = 0.075 +- 0.263 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.085 +- 0.263 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.075 +- 0.228 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.816
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.795
NEC for r=0.5 class 1.0 = 0.075 +- 0.263 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.085 +- 0.263 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.075 +- 0.228 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.795
NEC for r=0.4 class 1.0 = 0.1 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.116 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.1 +- 0.266 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10676337115072931
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 1.0 = 0.214 +- 0.425 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all KL = 0.251 +- 0.425 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all L1 = 0.214 +- 0.361 (in-sample avg dev_std = 0.167)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.019, 0.019, 1.0, 1.0], 'all_L1': [0.143, 0.143, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.092, 0.849, 1.0, 1.0], 'all_L1': [0.215, 0.893, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.021, 1.0], 'all_L1': [0.144, 0.144, 0.143, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.026, 0.026, 1.0], 'all_L1': [0.145, 0.145, 0.145, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.024, 1.0], 'all_L1': [0.145, 0.145, 0.145, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.016, 0.016, 1.0], 'all_L1': [0.141, 0.141, 0.14, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.021, 0.021], 'all_L1': [0.145, 0.145, 0.145, 0.145]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.009, 1.0], 'all_L1': [0.14, 0.14, 0.14, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.082, 0.818, 1.0], 'all_L1': [0.206, 0.206, 0.861, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.017, 0.017, 1.0], 'all_L1': [0.142, 0.142, 0.142, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.682, 0.898, 0.981, 0.981], 'all_L1': [0.585, 0.784, 0.857, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.996, 0.996, 0.996], 'all_L1': [0.863, 0.863, 0.863, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.746, 0.913, 0.979], 'all_L1': [0.637, 0.637, 0.797, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.701, 0.701, 0.905, 0.974], 'all_L1': [0.603, 0.603, 0.793, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.696, 0.886, 0.976], 'all_L1': [0.598, 0.598, 0.777, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.68, 0.9, 0.984], 'all_L1': [0.588, 0.588, 0.785, 0.859]}), defaultdict(<class 'list'>, {'all_KL': [0.718, 0.718, 0.718, 0.718], 'all_L1': [0.614, 0.614, 0.614, 0.614]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.662, 0.662, 0.991], 'all_L1': [0.567, 0.567, 0.567, 0.862]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.994, 0.994, 0.994], 'all_L1': [0.863, 0.863, 0.863, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.703, 0.912, 0.983], 'all_L1': [0.596, 0.596, 0.793, 0.857]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.284, 0.284, 1.0, 1.0], 'all_L1': [0.349, 0.349, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.726, 1.0, 1.0], 'all_L1': [0.557, 0.724, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.328, 0.328, 1.0], 'all_L1': [0.371, 0.371, 0.371, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.743, 0.743, 1.0], 'all_L1': [0.739, 0.739, 0.739, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.464, 0.464, 1.0], 'all_L1': [0.493, 0.493, 0.493, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.585, 1.0], 'all_L1': [0.583, 0.583, 0.583, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.027, 0.027, 0.027], 'all_L1': [0.151, 0.151, 0.151, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 0.845, 1.0], 'all_L1': [0.839, 0.839, 0.839, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.877, 0.904, 1.0], 'all_L1': [0.874, 0.874, 0.892, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.892, 0.892, 1.0], 'all_L1': [0.89, 0.89, 0.89, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.659, 0.695, 0.716, 0.716], 'all_L1': [0.595, 0.626, 0.651, 0.651]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.463, 0.463, 0.463], 'all_L1': [0.441, 0.441, 0.441, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.64, 0.64, 0.669, 0.672], 'all_L1': [0.6, 0.6, 0.625, 0.629]}), defaultdict(<class 'list'>, {'all_KL': [0.25, 0.25, 0.259, 0.257], 'all_L1': [0.254, 0.254, 0.262, 0.261]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.51, 0.536, 0.536], 'all_L1': [0.485, 0.485, 0.507, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.395, 0.416, 0.415], 'all_L1': [0.401, 0.401, 0.417, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.896, 0.896, 0.896, 0.896], 'all_L1': [0.77, 0.77, 0.77, 0.77]}), defaultdict(<class 'list'>, {'all_KL': [0.152, 0.152, 0.152, 0.155], 'all_L1': [0.158, 0.158, 0.158, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.118, 0.118, 0.118], 'all_L1': [0.122, 0.122, 0.122, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.104, 0.109, 0.108], 'all_L1': [0.106, 0.106, 0.11, 0.11]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.626, 0.629, 1.0, 1.0], 'all_L1': [0.682, 0.683, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.955, 1.0, 1.0], 'all_L1': [0.903, 0.958, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.645, 0.645, 0.645, 1.0], 'all_L1': [0.697, 0.697, 0.697, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.635, 0.635, 0.638, 1.0], 'all_L1': [0.688, 0.688, 0.689, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.636, 0.639, 1.0], 'all_L1': [0.691, 0.691, 0.691, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.627, 0.627, 0.628, 1.0], 'all_L1': [0.68, 0.68, 0.68, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.643, 0.643, 0.643], 'all_L1': [0.7, 0.7, 0.7, 0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.606, 0.606, 0.606, 1.0], 'all_L1': [0.668, 0.668, 0.668, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.894, 0.894, 0.949, 1.0], 'all_L1': [0.907, 0.907, 0.958, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.641, 1.0], 'all_L1': [0.691, 0.691, 0.691, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.075, 0.112, 0.264, 0.264], 'all_L1': [0.063, 0.095, 0.224, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.28, 0.275, 0.275], 'all_L1': [0.236, 0.233, 0.233, 0.233]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.088, 0.117, 0.245], 'all_L1': [0.075, 0.075, 0.1, 0.208]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.086, 0.113, 0.255], 'all_L1': [0.075, 0.075, 0.098, 0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.071, 0.101, 0.254], 'all_L1': [0.06, 0.06, 0.088, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.08, 0.08, 0.112, 0.263], 'all_L1': [0.071, 0.071, 0.098, 0.225]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.079], 'all_L1': [0.068, 0.068, 0.068, 0.068]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.28], 'all_L1': [0.068, 0.068, 0.068, 0.237]}), defaultdict(<class 'list'>, {'all_KL': [0.269, 0.269, 0.268, 0.264], 'all_L1': [0.227, 0.227, 0.224, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.085, 0.116, 0.251], 'all_L1': [0.075, 0.075, 0.1, 0.214]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.157 +- 0.027, 0.224 +- 0.224, 0.386 +- 0.373, 0.914 +- 0.256
suff_simple class all_KL  =  0.033 +- 0.028, 0.108 +- 0.248, 0.295 +- 0.424, 0.902 +- 0.294
[[0.0, 0.0, -1.0, -1.0], [0.09386281669139862, 0.8979591727256775, -1.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, -1.0], [0.08303248882293701, 0.08303248882293701, 0.8673469424247742, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.019, 0.019, 1.0, 1.0], [0.092, 0.849, 1.0, 1.0], [0.021, 0.021, 0.021, 1.0], [0.026, 0.026, 0.026, 1.0], [0.024, 0.024, 0.024, 1.0], [0.016, 0.016, 0.016, 1.0], [0.021, 0.021, 0.021, 0.021], [0.009, 0.009, 0.009, 1.0], [0.082, 0.082, 0.818, 1.0], [0.017, 0.017, 0.017, 1.0]]
suff_simple_acc_int  =  0.018 +- 0.035, 0.098 +- 0.268, -0.113 +- 0.512, -0.900 +- 0.300
nec class all_L1  =  0.651 +- 0.107, 0.671 +- 0.111, 0.771 +- 0.096, 0.834 +- 0.073
nec class all_KL  =  0.758 +- 0.121, 0.779 +- 0.124, 0.887 +- 0.106, 0.958 +- 0.080
[[0.33212995529174805, 0.08664260059595108, 0.0009025270701386034, 0.0009025270701386034], [0.0, 0.0004512635350693017, 0.0009025270701386034, 0.0009025270701386034], [0.2851985692977905, 0.2851985692977905, 0.07581227272748947, 0.0004512635350693017], [0.31768953800201416, 0.31768953800201416, 0.07581227272748947, 0.0], [0.3140794336795807, 0.3140794336795807, 0.09386281669139862, 0.0009025270701386034], [0.3465704023838043, 0.3465704023838043, 0.09025270491838455, 0.0004512635350693017], [0.30685919523239136, 0.30685919523239136, 0.30685919523239136, 0.30685919523239136], [0.3501805067062378, 0.3501805067062378, 0.3501805067062378, 0.0004512635350693017], [0.0004512635350693017, 0.0004512635350693017, 0.0004512635350693017, 0.0004512635350693017], [0.3285198509693146, 0.3285198509693146, 0.08303248882293701, 0.0013537906343117356]]
[[0.682, 0.898, 0.981, 0.981], [0.996, 0.996, 0.996, 0.996], [0.746, 0.746, 0.913, 0.979], [0.701, 0.701, 0.905, 0.974], [0.696, 0.696, 0.886, 0.976], [0.68, 0.68, 0.9, 0.984], [0.718, 0.718, 0.718, 0.718], [0.662, 0.662, 0.662, 0.991], [0.994, 0.994, 0.994, 0.994], [0.703, 0.703, 0.912, 0.983]]
nec_acc_int  =  0.258 +- 0.130, 0.234 +- 0.137, 0.108 +- 0.117, 0.031 +- 0.092

Eval split val
suff_simple class all_L1  =  0.585 +- 0.237, 0.601 +- 0.241, 0.696 +- 0.272, 0.915 +- 0.255
suff_simple class all_KL  =  0.558 +- 0.274, 0.577 +- 0.278, 0.679 +- 0.306, 0.903 +- 0.292
[[0.0, 0.0, -1.0, -1.0], [0.0075396825559437275, 0.33544304966926575, -1.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, -1.0], [0.004365079570561647, 0.004365079570561647, 0.06329113990068436, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.284, 0.284, 1.0, 1.0], [0.533, 0.726, 1.0, 1.0], [0.328, 0.328, 0.328, 1.0], [0.743, 0.743, 0.743, 1.0], [0.464, 0.464, 0.464, 1.0], [0.585, 0.585, 0.585, 1.0], [0.027, 0.027, 0.027, 0.027], [0.845, 0.845, 0.845, 1.0], [0.877, 0.877, 0.904, 1.0], [0.892, 0.892, 0.892, 1.0]]
suff_simple_acc_int  =  0.001 +- 0.002, 0.034 +- 0.100, -0.194 +- 0.404, -0.900 +- 0.300
nec class all_L1  =  0.393 +- 0.216, 0.396 +- 0.219, 0.406 +- 0.224, 0.407 +- 0.224
nec class all_KL  =  0.419 +- 0.252, 0.422 +- 0.256, 0.433 +- 0.260, 0.434 +- 0.260
[[0.07619047909975052, 0.0357142873108387, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0], [0.04087301716208458, 0.04087301716208458, 0.009523809887468815, 0.0], [0.014682539738714695, 0.014682539738714695, 0.003968254197388887, 0.0], [0.03849206492304802, 0.03849206492304802, 0.008333333767950535, 0.0], [0.02658730186522007, 0.02658730186522007, 0.004365079570561647, 0.0], [0.09682539850473404, 0.09682539850473404, 0.09682539850473404, 0.09682539850473404], [0.009523809887468815, 0.009523809887468815, 0.009523809887468815, 0.0], [0.0, 0.0, 0.0, 0.0], [0.0071428571827709675, 0.0071428571827709675, 0.0015873016091063619, 0.0]]
[[0.659, 0.695, 0.716, 0.716], [0.463, 0.463, 0.463, 0.463], [0.64, 0.64, 0.669, 0.672], [0.25, 0.25, 0.259, 0.257], [0.51, 0.51, 0.536, 0.536], [0.395, 0.395, 0.416, 0.415], [0.896, 0.896, 0.896, 0.896], [0.152, 0.152, 0.152, 0.155], [0.118, 0.118, 0.118, 0.118], [0.104, 0.104, 0.109, 0.108]]
nec_acc_int  =  0.031 +- 0.031, 0.027 +- 0.028, 0.013 +- 0.028, 0.010 +- 0.029

Eval split test
suff_simple class all_L1  =  0.731 +- 0.088, 0.736 +- 0.099, 0.777 +- 0.137, 0.970 +- 0.090
suff_simple class all_KL  =  0.683 +- 0.103, 0.691 +- 0.118, 0.739 +- 0.161, 0.964 +- 0.107
[[0.47547823190689087, 0.47578346729278564, -1.0, -1.0], [0.8034188151359558, 0.845082700252533, -1.0, -1.0], [0.4813288450241089, 0.4813288450241089, 0.4811762273311615, -1.0], [0.4810236096382141, 0.4810236096382141, 0.4812270998954773, -1.0], [0.48051485419273376, 0.48051485419273376, 0.4801587164402008, -1.0], [0.4772588610649109, 0.4772588610649109, 0.47675010561943054, -1.0], [0.485805869102478, 0.485805869102478, 0.485805869102478, 0.485805869102478], [0.4801587164402008, 0.4801587164402008, 0.4801587164402008, -1.0], [0.7973138093948364, 0.7973138093948364, 0.8328981995582581, -1.0], [0.47868335247039795, 0.47868335247039795, 0.4781745970249176, -1.0]]
[[0.626, 0.629, 1.0, 1.0], [0.884, 0.955, 1.0, 1.0], [0.645, 0.645, 0.645, 1.0], [0.635, 0.635, 0.638, 1.0], [0.636, 0.636, 0.639, 1.0], [0.627, 0.627, 0.628, 1.0], [0.643, 0.643, 0.643, 0.643], [0.606, 0.606, 0.606, 1.0], [0.894, 0.894, 0.949, 1.0], [0.639, 0.639, 0.641, 1.0]]
suff_simple_acc_int  =  0.544 +- 0.128, 0.548 +- 0.137, 0.220 +- 0.619, -0.851 +- 0.446
nec class all_L1  =  0.102 +- 0.065, 0.105 +- 0.063, 0.130 +- 0.064, 0.207 +- 0.047
nec class all_KL  =  0.119 +- 0.078, 0.123 +- 0.077, 0.152 +- 0.077, 0.243 +- 0.056
[[0.8083468675613403, 0.7965964078903198, 0.5817463397979736, 0.5817463397979736], [0.5831645131111145, 0.5868111848831177, 0.5858995318412781, 0.5858995318412781], [0.7953808903694153, 0.7953808903694153, 0.7982171773910522, 0.5877735018730164], [0.7949756979942322, 0.7949756979942322, 0.794165313243866, 0.5868111848831177], [0.8075364828109741, 0.8075364828109741, 0.7990275621414185, 0.5874696373939514], [0.8103727698326111, 0.8103727698326111, 0.7990275621414185, 0.5853424072265625], [0.7933549284934998, 0.7933549284934998, 0.7933549284934998, 0.7933549284934998], [0.8172609210014343, 0.8172609210014343, 0.8172609210014343, 0.5871150493621826], [0.5804294943809509, 0.5804294943809509, 0.5850384831428528, 0.5842787623405457], [0.7945705056190491, 0.7945705056190491, 0.7949756979942322, 0.5852410793304443]]
[[0.075, 0.112, 0.264, 0.264], [0.279, 0.28, 0.275, 0.275], [0.088, 0.088, 0.117, 0.245], [0.086, 0.086, 0.113, 0.255], [0.071, 0.071, 0.101, 0.254], [0.08, 0.08, 0.112, 0.263], [0.079, 0.079, 0.079, 0.079], [0.079, 0.079, 0.079, 0.28], [0.269, 0.269, 0.268, 0.264], [0.085, 0.085, 0.116, 0.251]]
nec_acc_int  =  0.759 +- 0.089, 0.758 +- 0.087, 0.735 +- 0.099, 0.607 +- 0.062


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.404 +- 0.067, 0.448 +- 0.153, 0.578 +- 0.219, 0.874 +- 0.165
Faith. Armon (L1)= 		  =  0.252 +- 0.043, 0.307 +- 0.193, 0.438 +- 0.305, 0.855 +- 0.207
Faith. GMean (L1)= 	  =  0.319 +- 0.054, 0.369 +- 0.174, 0.498 +- 0.268, 0.864 +- 0.188
Faith. Aritm (KL)= 		  =  0.395 +- 0.074, 0.444 +- 0.170, 0.591 +- 0.249, 0.930 +- 0.187
Faith. Armon (KL)= 		  =  0.062 +- 0.050, 0.137 +- 0.262, 0.315 +- 0.425, 0.897 +- 0.285
Faith. GMean (KL)= 	  =  0.151 +- 0.074, 0.214 +- 0.241, 0.377 +- 0.385, 0.905 +- 0.261

Eval split val
Faith. Aritm (L1)= 		  =  0.489 +- 0.012, 0.499 +- 0.030, 0.551 +- 0.114, 0.661 +- 0.116
Faith. Armon (L1)= 		  =  0.365 +- 0.116, 0.372 +- 0.123, 0.417 +- 0.182, 0.479 +- 0.222
Faith. GMean (L1)= 	  =  0.417 +- 0.070, 0.425 +- 0.081, 0.473 +- 0.150, 0.556 +- 0.181
Faith. Aritm (KL)= 		  =  0.488 +- 0.012, 0.500 +- 0.033, 0.556 +- 0.123, 0.668 +- 0.125
Faith. Armon (KL)= 		  =  0.336 +- 0.144, 0.344 +- 0.153, 0.399 +- 0.220, 0.469 +- 0.264
Faith. GMean (KL)= 	  =  0.393 +- 0.102, 0.402 +- 0.114, 0.458 +- 0.185, 0.545 +- 0.222

Eval split test
Faith. Aritm (L1)= 		  =  0.416 +- 0.076, 0.420 +- 0.081, 0.454 +- 0.100, 0.588 +- 0.068
Faith. Armon (L1)= 		  =  0.175 +- 0.097, 0.180 +- 0.096, 0.220 +- 0.099, 0.339 +- 0.073
Faith. GMean (L1)= 	  =  0.266 +- 0.096, 0.272 +- 0.097, 0.314 +- 0.105, 0.446 +- 0.076
Faith. Aritm (KL)= 		  =  0.401 +- 0.090, 0.407 +- 0.097, 0.446 +- 0.119, 0.604 +- 0.081
Faith. Armon (KL)= 		  =  0.198 +- 0.111, 0.204 +- 0.111, 0.250 +- 0.115, 0.387 +- 0.083
Faith. GMean (KL)= 	  =  0.279 +- 0.108, 0.286 +- 0.110, 0.332 +- 0.121, 0.482 +- 0.086
Computed for split load_split = id



Completed in  0:39:38.129209  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:41:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:41:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.085
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.045
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.112
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03961371841155234
len(reference) = 277
Effective ratio: 0.076 +- 0.081
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.143 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.019 +- 0.078 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.143 +- 0.037 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08488808664259928
len(reference) = 277
Effective ratio: 0.308 +- 0.200
Model Accuracy over intervened graphs for r=0.5 =  0.007
SUFF_SIMPLE for r=0.5 class 1.0 = 0.149 +- 0.114 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.114 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.149 +- 0.082 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.010654761904761905
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04489303079416532
len(reference) = 2457
Effective ratio: 0.067 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.478
SUFF_SIMPLE for r=0.6 class 1.0 = 0.683 +- 0.477 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all KL = 0.63 +- 0.477 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all L1 = 0.683 +- 0.409 (in-sample avg dev_std = 0.148)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08630672609400324
len(reference) = 2457
Effective ratio: 0.305 +- 0.172
Model Accuracy over intervened graphs for r=0.5 =  0.483
SUFF_SIMPLE for r=0.5 class 1.0 = 0.682 +- 0.478 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.5 all KL = 0.63 +- 0.478 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.5 all L1 = 0.682 +- 0.409 (in-sample avg dev_std = 0.149)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03961371841155234
len(reference) = 277
Effective ratio: 0.076 +- 0.081
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 1.0 = 0.568 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.685 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.568 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08488808664259928
len(reference) = 277
Effective ratio: 0.308 +- 0.200
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.857 +- 0.078 (in-sample avg dev_std = 0.041)
NEC for r=0.5 all KL = 0.981 +- 0.078 (in-sample avg dev_std = 0.041)
NEC for r=0.5 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.041)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.098028880866426
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.857 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all KL = 0.981 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.050)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.098028880866426
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.857 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.3 all KL = 0.981 +- 0.078 (in-sample avg dev_std = 0.050)
NEC for r=0.3 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.050)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 1.0 = 0.553 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.613 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.553 +- 0.370 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.010654761904761905
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.5 =  0.001
NEC for r=0.5 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.715 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01302142857142857
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.724
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.01302142857142857
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.716 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.651 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04489303079416532
len(reference) = 2468
Effective ratio: 0.067 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.768
NEC for r=0.6 class 1.0 = 0.072 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.08 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.072 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08630672609400324
len(reference) = 2468
Effective ratio: 0.305 +- 0.172
Model Accuracy over intervened graphs for r=0.5 =  0.619
NEC for r=0.5 class 1.0 = 0.191 +- 0.408 (in-sample avg dev_std = 0.074)
NEC for r=0.5 all KL = 0.221 +- 0.408 (in-sample avg dev_std = 0.074)
NEC for r=0.5 all L1 = 0.191 +- 0.351 (in-sample avg dev_std = 0.074)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11157050243111831
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.582
NEC for r=0.4 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all KL = 0.264 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all L1 = 0.224 +- 0.369 (in-sample avg dev_std = 0.174)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11157050243111831
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.582
NEC for r=0.3 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all KL = 0.264 +- 0.434 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all L1 = 0.224 +- 0.369 (in-sample avg dev_std = 0.174)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:45:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:45:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.074
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.096
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.088
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.111
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.112
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07409747292418772
len(reference) = 277
Effective ratio: 0.692 +- 0.205
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.137 +- 0.019 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.004 +- 0.019 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.137 +- 0.012 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0964404332129964
len(reference) = 49
Effective ratio: 0.989 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.633
SUFF_SIMPLE for r=0.5 class 1.0 = 0.673 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.599 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.673 +- 0.402 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01303015873015873
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.559 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.537 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.559 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.75
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013011904761904761
len(reference) = 20
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.5 =  0.5
SUFF_SIMPLE for r=0.5 class 1.0 = 0.699 +- 0.335 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.661 +- 0.335 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.699 +- 0.307 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08844854132901134
len(reference) = 2457
Effective ratio: 0.701 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.618
SUFF_SIMPLE for r=0.6 class 1.0 = 0.793 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.762 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.793 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1106908427876823
len(reference) = 455
Effective ratio: 0.992 +- 0.029
Model Accuracy over intervened graphs for r=0.5 =  0.725
SUFF_SIMPLE for r=0.5 class 1.0 = 0.885 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.876 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.885 +- 0.275 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07409747292418772
len(reference) = 277
Effective ratio: 0.692 +- 0.205
Model Accuracy over intervened graphs for r=0.6 =  0.022
NEC for r=0.6 class 1.0 = 0.845 +- 0.144 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.975 +- 0.144 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.845 +- 0.125 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0964404332129964
len(reference) = 277
Effective ratio: 0.989 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.001
NEC for r=0.5 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.055)
NEC for r=0.5 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.055)
NEC for r=0.5 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09767148014440433
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.4 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.4 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.060)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09767148014440433
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.863 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all KL = 0.996 +- 0.017 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01303015873015873
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.465
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013011904761904761
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.465
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.441 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.463 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.441 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08844854132901134
len(reference) = 2468
Effective ratio: 0.701 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.588
NEC for r=0.6 class 1.0 = 0.234 +- 0.440 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all KL = 0.275 +- 0.440 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all L1 = 0.234 +- 0.375 (in-sample avg dev_std = 0.154)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.846
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1106908427876823
len(reference) = 2468
Effective ratio: 0.992 +- 0.029
Model Accuracy over intervened graphs for r=0.5 =  0.584
NEC for r=0.5 class 1.0 = 0.234 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.5 all KL = 0.276 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.5 all L1 = 0.234 +- 0.375 (in-sample avg dev_std = 0.163)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.846
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11153525121555916
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.586
NEC for r=0.4 class 1.0 = 0.233 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all KL = 0.275 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all L1 = 0.233 +- 0.374 (in-sample avg dev_std = 0.167)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.846
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11153525121555916
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.586
NEC for r=0.3 class 1.0 = 0.233 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all KL = 0.275 +- 0.440 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all L1 = 0.233 +- 0.374 (in-sample avg dev_std = 0.167)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:50:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:50:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.035
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.035
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.045
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.045
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.143 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08002527075812275
len(reference) = 276
Effective ratio: 0.309 +- 0.207
Model Accuracy over intervened graphs for r=0.4 =  0.014
SUFF_SIMPLE for r=0.4 class 1.0 = 0.155 +- 0.131 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.035 +- 0.131 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.155 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010820634920634922
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04499635332252836
len(reference) = 2457
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.6 =  0.483
SUFF_SIMPLE for r=0.6 class 1.0 = 0.699 +- 0.471 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.6 all KL = 0.649 +- 0.471 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.6 all L1 = 0.699 +- 0.402 (in-sample avg dev_std = 0.140)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04499635332252836
len(reference) = 2457
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.5 =  0.483
SUFF_SIMPLE for r=0.5 class 1.0 = 0.699 +- 0.471 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.5 all KL = 0.649 +- 0.471 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.5 all L1 = 0.699 +- 0.402 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08502552674230146
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.485
SUFF_SIMPLE for r=0.4 class 1.0 = 0.699 +- 0.470 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all KL = 0.65 +- 0.470 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all L1 = 0.699 +- 0.402 (in-sample avg dev_std = 0.137)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.6 =  0.271
NEC for r=0.6 class 1.0 = 0.636 +- 0.367 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.761 +- 0.367 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.636 +- 0.328 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.5 =  0.271
NEC for r=0.5 class 1.0 = 0.636 +- 0.367 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.761 +- 0.367 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.636 +- 0.328 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08002527075812275
len(reference) = 277
Effective ratio: 0.309 +- 0.207
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.857 +- 0.071 (in-sample avg dev_std = 0.018)
NEC for r=0.4 all KL = 0.979 +- 0.071 (in-sample avg dev_std = 0.018)
NEC for r=0.4 all L1 = 0.857 +- 0.034 (in-sample avg dev_std = 0.018)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.996
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09773646209386282
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.857 +- 0.071 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all KL = 0.979 +- 0.071 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all L1 = 0.857 +- 0.035 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.111
NEC for r=0.6 class 1.0 = 0.546 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.585 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.546 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.111
NEC for r=0.5 class 1.0 = 0.546 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.585 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.546 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010820634920634922
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.629 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.672 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.629 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.629 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.672 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.629 +- 0.330 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04499635332252836
len(reference) = 2468
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.6 =  0.767
NEC for r=0.6 class 1.0 = 0.062 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.068 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.062 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.815
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04499635332252836
len(reference) = 2468
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.5 =  0.767
NEC for r=0.5 class 1.0 = 0.062 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.068 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.062 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.815
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08502552674230146
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.629
NEC for r=0.4 class 1.0 = 0.172 +- 0.390 (in-sample avg dev_std = 0.053)
NEC for r=0.4 all KL = 0.197 +- 0.390 (in-sample avg dev_std = 0.053)
NEC for r=0.4 all L1 = 0.172 +- 0.336 (in-sample avg dev_std = 0.053)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11146920583468395
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.588
NEC for r=0.3 class 1.0 = 0.208 +- 0.422 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.245 +- 0.422 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.208 +- 0.358 (in-sample avg dev_std = 0.161)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:54:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:54:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.041
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.056
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.010
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.051
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.041072202166064976
len(reference) = 277
Effective ratio: 0.076 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.043841155234657044
len(reference) = 277
Effective ratio: 0.078 +- 0.088
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.026 +- 0.081 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.038 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05643321299638989
len(reference) = 277
Effective ratio: 0.112 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.004
SUFF_SIMPLE for r=0.4 class 1.0 = 0.148 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.029 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.148 +- 0.064 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009807142857142856
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0509242301458671
len(reference) = 2457
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.48
SUFF_SIMPLE for r=0.6 class 1.0 = 0.688 +- 0.473 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.6 all KL = 0.638 +- 0.473 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.6 all L1 = 0.688 +- 0.405 (in-sample avg dev_std = 0.141)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.825
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.05116247974068071
len(reference) = 2457
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.481
SUFF_SIMPLE for r=0.5 class 1.0 = 0.689 +- 0.472 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.5 all KL = 0.639 +- 0.472 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.5 all L1 = 0.689 +- 0.405 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06221839546191248
len(reference) = 2457
Effective ratio: 0.090 +- 0.132
Model Accuracy over intervened graphs for r=0.4 =  0.482
SUFF_SIMPLE for r=0.4 class 1.0 = 0.689 +- 0.472 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all KL = 0.64 +- 0.472 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all L1 = 0.689 +- 0.405 (in-sample avg dev_std = 0.145)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.041072202166064976
len(reference) = 277
Effective ratio: 0.076 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.325
NEC for r=0.6 class 1.0 = 0.603 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.715 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.603 +- 0.359 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.043841155234657044
len(reference) = 277
Effective ratio: 0.078 +- 0.088
Model Accuracy over intervened graphs for r=0.5 =  0.31
NEC for r=0.5 class 1.0 = 0.616 +- 0.393 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.73 +- 0.393 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.616 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05643321299638989
len(reference) = 277
Effective ratio: 0.112 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.195
NEC for r=0.4 class 1.0 = 0.71 +- 0.325 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.832 +- 0.325 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.71 +- 0.294 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09742238267148014
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.855 +- 0.081 (in-sample avg dev_std = 0.012)
NEC for r=0.3 all KL = 0.974 +- 0.081 (in-sample avg dev_std = 0.012)
NEC for r=0.3 all L1 = 0.855 +- 0.038 (in-sample avg dev_std = 0.012)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.02
NEC for r=0.6 class 1.0 = 0.245 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.241 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.245 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.02
NEC for r=0.5 class 1.0 = 0.245 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.241 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.245 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009807142857142856
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.018
NEC for r=0.4 class 1.0 = 0.248 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.243 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.248 +- 0.339 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.254
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013030555555555557
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.261 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.257 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.261 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0509242301458671
len(reference) = 2468
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.773
NEC for r=0.6 class 1.0 = 0.069 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.074 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.069 +- 0.219 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.822
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.05116247974068071
len(reference) = 2468
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.772
NEC for r=0.5 class 1.0 = 0.069 +- 0.249 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.075 +- 0.249 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.069 +- 0.220 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.822
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06221839546191248
len(reference) = 2468
Effective ratio: 0.090 +- 0.132
Model Accuracy over intervened graphs for r=0.4 =  0.748
NEC for r=0.4 class 1.0 = 0.087 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.097 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.087 +- 0.247 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.822
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11131604538087521
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 1.0 = 0.218 +- 0.427 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all KL = 0.255 +- 0.427 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all L1 = 0.218 +- 0.363 (in-sample avg dev_std = 0.164)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 16:58:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 04:58:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.047
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.057
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.044
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05664259927797833
len(reference) = 277
Effective ratio: 0.102 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.145 +- 0.046 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008219444444444444
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0440064829821718
len(reference) = 2457
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.6 =  0.482
SUFF_SIMPLE for r=0.6 class 1.0 = 0.693 +- 0.474 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all KL = 0.642 +- 0.474 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all L1 = 0.693 +- 0.406 (in-sample avg dev_std = 0.146)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0440064829821718
len(reference) = 2457
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.482
SUFF_SIMPLE for r=0.5 class 1.0 = 0.693 +- 0.474 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all KL = 0.642 +- 0.474 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all L1 = 0.693 +- 0.406 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.048196110210696926
len(reference) = 2457
Effective ratio: 0.074 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.483
SUFF_SIMPLE for r=0.4 class 1.0 = 0.693 +- 0.473 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.4 all KL = 0.642 +- 0.473 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.4 all L1 = 0.693 +- 0.406 (in-sample avg dev_std = 0.150)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.6 =  0.289
NEC for r=0.6 class 1.0 = 0.63 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.749 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.63 +- 0.349 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.5 =  0.289
NEC for r=0.5 class 1.0 = 0.63 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.749 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.63 +- 0.349 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05664259927797833
len(reference) = 277
Effective ratio: 0.102 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.209
NEC for r=0.4 class 1.0 = 0.694 +- 0.340 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.816 +- 0.340 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.694 +- 0.311 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.989
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0982490974729242
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.855 +- 0.085 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all KL = 0.976 +- 0.085 (in-sample avg dev_std = 0.060)
NEC for r=0.3 all L1 = 0.855 +- 0.046 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.066
NEC for r=0.6 class 1.0 = 0.456 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.485 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.456 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.066
NEC for r=0.5 class 1.0 = 0.456 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.485 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.456 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008219444444444444
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.065
NEC for r=0.4 class 1.0 = 0.457 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.485 +- 0.434 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.457 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015079365079367
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.507 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.536 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.507 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0440064829821718
len(reference) = 2468
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 1.0 = 0.067 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.076 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.067 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.826
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0440064829821718
len(reference) = 2468
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.774
NEC for r=0.5 class 1.0 = 0.067 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.076 +- 0.251 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.067 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.826
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.048196110210696926
len(reference) = 2468
Effective ratio: 0.074 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.765
NEC for r=0.4 class 1.0 = 0.073 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.084 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.073 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11143314424635334
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 1.0 = 0.214 +- 0.428 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all KL = 0.254 +- 0.428 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all L1 = 0.214 +- 0.363 (in-sample avg dev_std = 0.168)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:02:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:02:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.040
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.084
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.047
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.14 +- 0.046 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all L1 = 0.14 +- 0.017 (in-sample avg dev_std = 0.003)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.14 +- 0.046 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all KL = 0.016 +- 0.046 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all L1 = 0.14 +- 0.017 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08403971119133574
len(reference) = 277
Effective ratio: 0.310 +- 0.206
Model Accuracy over intervened graphs for r=0.4 =  0.011
SUFF_SIMPLE for r=0.4 class 1.0 = 0.149 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.026 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.149 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010527777777777778
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04677836304700163
len(reference) = 2457
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.6 =  0.478
SUFF_SIMPLE for r=0.6 class 1.0 = 0.68 +- 0.473 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.6 all KL = 0.631 +- 0.473 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.6 all L1 = 0.68 +- 0.407 (in-sample avg dev_std = 0.140)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04677836304700163
len(reference) = 2457
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.478
SUFF_SIMPLE for r=0.5 class 1.0 = 0.68 +- 0.473 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.5 all KL = 0.631 +- 0.473 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.5 all L1 = 0.68 +- 0.407 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08463330632090761
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.481
SUFF_SIMPLE for r=0.4 class 1.0 = 0.682 +- 0.472 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all KL = 0.633 +- 0.472 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all L1 = 0.682 +- 0.407 (in-sample avg dev_std = 0.128)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.375
NEC for r=0.6 class 1.0 = 0.581 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.704 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.581 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.375
NEC for r=0.5 class 1.0 = 0.581 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.704 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.581 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08403971119133574
len(reference) = 277
Effective ratio: 0.310 +- 0.206
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.86 +- 0.046 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all KL = 0.984 +- 0.046 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all L1 = 0.86 +- 0.017 (in-sample avg dev_std = 0.002)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09811191335740072
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.859 +- 0.046 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all KL = 0.984 +- 0.046 (in-sample avg dev_std = 0.042)
NEC for r=0.3 all L1 = 0.859 +- 0.017 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.056
NEC for r=0.6 class 1.0 = 0.375 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.367 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.375 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.056
NEC for r=0.5 class 1.0 = 0.375 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.367 +- 0.392 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.375 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010527777777777778
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.415 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013009920634920636
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.415 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.417 +- 0.368 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04677836304700163
len(reference) = 2468
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.6 =  0.77
NEC for r=0.6 class 1.0 = 0.072 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.078 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.072 +- 0.224 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.831
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04677836304700163
len(reference) = 2468
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.77
NEC for r=0.5 class 1.0 = 0.072 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.078 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.072 +- 0.224 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08463330632090761
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 1.0 = 0.191 +- 0.401 (in-sample avg dev_std = 0.060)
NEC for r=0.4 all KL = 0.217 +- 0.401 (in-sample avg dev_std = 0.060)
NEC for r=0.4 all L1 = 0.191 +- 0.348 (in-sample avg dev_std = 0.060)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11163006482982171
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 1.0 = 0.225 +- 0.429 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all KL = 0.263 +- 0.429 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all L1 = 0.225 +- 0.366 (in-sample avg dev_std = 0.171)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:06:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:06:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.042
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.042
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.042
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.009
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.048
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.048


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.144 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.3 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.3 all L1 = 0.144 +- 0.041 (in-sample avg dev_std = 0.003)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.6 =  0.485
SUFF_SIMPLE for r=0.6 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.6 all KL = 0.651 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.6 all L1 = 0.7 +- 0.402 (in-sample avg dev_std = 0.141)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.817
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.5 =  0.485
SUFF_SIMPLE for r=0.5 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.5 all KL = 0.651 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.5 all L1 = 0.7 +- 0.402 (in-sample avg dev_std = 0.141)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.817
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.485
SUFF_SIMPLE for r=0.4 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.4 all KL = 0.651 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.4 all L1 = 0.7 +- 0.402 (in-sample avg dev_std = 0.141)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.3 =  0.485
SUFF_SIMPLE for r=0.3 class 1.0 = 0.7 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.3 all KL = 0.651 +- 0.470 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.3 all L1 = 0.7 +- 0.402 (in-sample avg dev_std = 0.141)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.6 =  0.318
NEC for r=0.6 class 1.0 = 0.592 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.592 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.5 =  0.318
NEC for r=0.5 class 1.0 = 0.592 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.592 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.4 =  0.318
NEC for r=0.4 class 1.0 = 0.592 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.592 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.3 =  0.318
NEC for r=0.3 class 1.0 = 0.592 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.703 +- 0.418 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.592 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.242
NEC for r=0.6 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.242
NEC for r=0.5 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.4 =  0.242
NEC for r=0.4 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.3 =  0.242
NEC for r=0.3 class 1.0 = 0.653 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.765 +- 0.398 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.653 +- 0.352 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.6 =  0.767
NEC for r=0.6 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.814
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.5 =  0.767
NEC for r=0.5 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.814
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.767
NEC for r=0.4 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.3 =  0.767
NEC for r=0.3 class 1.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.000)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:10:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:10:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.043
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.043
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.043
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.046
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.046
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.138 +- 0.034 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.138 +- 0.011 (in-sample avg dev_std = 0.002)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.138 +- 0.034 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all L1 = 0.138 +- 0.011 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.138 +- 0.034 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.4 all KL = 0.009 +- 0.034 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.4 all L1 = 0.138 +- 0.011 (in-sample avg dev_std = 0.002)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.6 =  0.48
SUFF_SIMPLE for r=0.6 class 1.0 = 0.669 +- 0.481 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all KL = 0.614 +- 0.481 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all L1 = 0.669 +- 0.413 (in-sample avg dev_std = 0.146)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.855
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.48
SUFF_SIMPLE for r=0.5 class 1.0 = 0.669 +- 0.481 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all KL = 0.614 +- 0.481 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.5 all L1 = 0.669 +- 0.413 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.855
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.48
SUFF_SIMPLE for r=0.4 class 1.0 = 0.669 +- 0.481 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.4 all KL = 0.614 +- 0.481 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.4 all L1 = 0.669 +- 0.413 (in-sample avg dev_std = 0.146)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.368
NEC for r=0.6 class 1.0 = 0.572 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.694 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.572 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.5 =  0.368
NEC for r=0.5 class 1.0 = 0.572 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.694 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.572 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.4 =  0.368
NEC for r=0.4 class 1.0 = 0.572 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.694 +- 0.424 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.572 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09797111913357401
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.862 +- 0.034 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all KL = 0.991 +- 0.034 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all L1 = 0.862 +- 0.011 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.012
NEC for r=0.6 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.147 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.155 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.012
NEC for r=0.5 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.147 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.155 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.012
NEC for r=0.4 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.147 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.155 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013014682539682538
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.161 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.155 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.161 +- 0.297 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 1.0 = 0.09 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.102 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.09 +- 0.256 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.851
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.774
NEC for r=0.5 class 1.0 = 0.09 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.102 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.09 +- 0.256 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.851
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.774
NEC for r=0.4 class 1.0 = 0.09 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.102 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.09 +- 0.256 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.851
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11157820097244732
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 1.0 = 0.237 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.3 all KL = 0.28 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.3 all L1 = 0.237 +- 0.376 (in-sample avg dev_std = 0.163)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:14:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:14:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.081
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.081
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.086
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.111
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.6 =  0.004
SUFF_SIMPLE for r=0.6 class 1.0 = 0.14 +- 0.061 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.009 +- 0.061 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.14 +- 0.049 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.5 =  0.004
SUFF_SIMPLE for r=0.5 class 1.0 = 0.14 +- 0.061 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.009 +- 0.061 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.14 +- 0.049 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0980649819494585
len(reference) = 6
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.833
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.628 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.761 +- 0.346 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.882 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.878 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.882 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.878 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013015873015873017
len(reference) = 1
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- nan (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- nan (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- nan (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08550769854132902
len(reference) = 2457
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.615
SUFF_SIMPLE for r=0.6 class 1.0 = 0.802 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.774 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.802 +- 0.358 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.838
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08550769854132902
len(reference) = 2457
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.615
SUFF_SIMPLE for r=0.5 class 1.0 = 0.802 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.774 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.802 +- 0.358 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.647
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11143233387358184
len(reference) = 34
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.471
SUFF_SIMPLE for r=0.4 class 1.0 = 0.756 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.756 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.6 =  0.022
NEC for r=0.6 class 1.0 = 0.844 +- 0.146 (in-sample avg dev_std = 0.046)
NEC for r=0.6 all KL = 0.972 +- 0.146 (in-sample avg dev_std = 0.046)
NEC for r=0.6 all L1 = 0.844 +- 0.126 (in-sample avg dev_std = 0.046)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.5 =  0.022
NEC for r=0.5 class 1.0 = 0.844 +- 0.146 (in-sample avg dev_std = 0.046)
NEC for r=0.5 all KL = 0.972 +- 0.146 (in-sample avg dev_std = 0.046)
NEC for r=0.5 all L1 = 0.844 +- 0.126 (in-sample avg dev_std = 0.046)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0980649819494585
len(reference) = 277
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.863 +- 0.021 (in-sample avg dev_std = 0.019)
NEC for r=0.4 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.019)
NEC for r=0.4 all L1 = 0.863 +- 0.006 (in-sample avg dev_std = 0.019)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09794945848375451
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.863 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all KL = 0.994 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all L1 = 0.863 +- 0.007 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.5 =  0.0
NEC for r=0.5 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.113
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.122 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.122 +- 0.268 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08550769854132902
len(reference) = 2468
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.591
NEC for r=0.6 class 1.0 = 0.223 +- 0.432 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.262 +- 0.432 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.223 +- 0.368 (in-sample avg dev_std = 0.166)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08550769854132902
len(reference) = 2468
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.591
NEC for r=0.5 class 1.0 = 0.223 +- 0.432 (in-sample avg dev_std = 0.166)
NEC for r=0.5 all KL = 0.262 +- 0.432 (in-sample avg dev_std = 0.166)
NEC for r=0.5 all L1 = 0.223 +- 0.368 (in-sample avg dev_std = 0.166)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11143233387358184
len(reference) = 2468
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.585
NEC for r=0.4 class 1.0 = 0.223 +- 0.433 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all KL = 0.265 +- 0.433 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all L1 = 0.223 +- 0.368 (in-sample avg dev_std = 0.171)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11149716369529984
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.584
NEC for r=0.3 class 1.0 = 0.224 +- 0.434 (in-sample avg dev_std = 0.173)
NEC for r=0.3 all KL = 0.264 +- 0.434 (in-sample avg dev_std = 0.173)
NEC for r=0.3 all L1 = 0.224 +- 0.368 (in-sample avg dev_std = 0.173)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:18:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:18:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
/home/azzolin/sedignn/global_local_sedignn/GOOD/kernel/pipelines/basic_pipeline.py:1153: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1808.)
  print(f"{metric.upper()} for r={ratio} class {c} = {scores[c][-1]} +- {aggr['KL'].std():.3f} (in-sample avg dev_std = {(aggr_std**2).mean().sqrt():.3f})")
/home/azzolin/sedignn/global_local_sedignn/GOOD/kernel/pipelines/basic_pipeline.py:1156: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1808.)
  print(f"{metric.upper()} for r={ratio} all {m} = {scores[f'all_{m}'][-1]} +- {aggr[f'{m}'].std():.3f} (in-sample avg dev_std = {(aggr_std**2).mean().sqrt():.3f})")
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.037
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.037
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.049
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.142 +- 0.071 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.017 +- 0.071 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.142 +- 0.037 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0862346570397112
len(reference) = 277
Effective ratio: 0.307 +- 0.203
Model Accuracy over intervened graphs for r=0.4 =  0.025
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.167 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.042 +- 0.167 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.164 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010383333333333333
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048649108589951376
len(reference) = 2457
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.6 =  0.479
SUFF_SIMPLE for r=0.6 class 1.0 = 0.691 +- 0.472 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.6 all KL = 0.642 +- 0.472 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.6 all L1 = 0.691 +- 0.404 (in-sample avg dev_std = 0.141)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.82
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.048649108589951376
len(reference) = 2457
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.5 =  0.479
SUFF_SIMPLE for r=0.5 class 1.0 = 0.691 +- 0.472 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.5 all KL = 0.642 +- 0.472 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.5 all L1 = 0.691 +- 0.404 (in-sample avg dev_std = 0.141)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.82
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08621636952998378
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.482
SUFF_SIMPLE for r=0.4 class 1.0 = 0.692 +- 0.471 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all KL = 0.642 +- 0.471 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all L1 = 0.692 +- 0.404 (in-sample avg dev_std = 0.136)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.6 =  0.35
NEC for r=0.6 class 1.0 = 0.595 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.724 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.595 +- 0.358 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.5 =  0.35
NEC for r=0.5 class 1.0 = 0.595 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.724 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.595 +- 0.358 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0862346570397112
len(reference) = 277
Effective ratio: 0.307 +- 0.203
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.857 +- 0.071 (in-sample avg dev_std = 0.070)
NEC for r=0.4 all KL = 0.983 +- 0.071 (in-sample avg dev_std = 0.070)
NEC for r=0.4 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.070)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09812996389891697
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.001
NEC for r=0.3 class 1.0 = 0.857 +- 0.071 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all KL = 0.983 +- 0.071 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all L1 = 0.857 +- 0.037 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.012
NEC for r=0.6 class 1.0 = 0.102 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.1 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.102 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.012
NEC for r=0.5 class 1.0 = 0.102 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.1 +- 0.262 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.102 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010383333333333333
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013016269841269842
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.0
NEC for r=0.3 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.3 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048649108589951376
len(reference) = 2468
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 1.0 = 0.068 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.074 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.068 +- 0.219 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.816
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.048649108589951376
len(reference) = 2468
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.5 =  0.764
NEC for r=0.5 class 1.0 = 0.068 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all KL = 0.074 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.5 all L1 = 0.068 +- 0.219 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08621636952998378
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 1.0 = 0.18 +- 0.394 (in-sample avg dev_std = 0.054)
NEC for r=0.4 all KL = 0.204 +- 0.394 (in-sample avg dev_std = 0.054)
NEC for r=0.4 all L1 = 0.18 +- 0.342 (in-sample avg dev_std = 0.054)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11164181523500812
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 1.0 = 0.214 +- 0.425 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all KL = 0.251 +- 0.425 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all L1 = 0.214 +- 0.361 (in-sample avg dev_std = 0.167)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.019, 0.027, 1.0, 1.0], 'all_L1': [0.143, 0.149, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.599, 1.0, 1.0], 'all_L1': [0.137, 0.673, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.035, 1.0], 'all_L1': [0.143, 0.143, 0.155, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.026, 0.029, 1.0], 'all_L1': [0.145, 0.145, 0.148, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.024, 1.0], 'all_L1': [0.145, 0.145, 0.145, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.016, 0.026, 1.0], 'all_L1': [0.14, 0.14, 0.149, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.021, 0.021], 'all_L1': [0.144, 0.144, 0.144, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.009, 1.0], 'all_L1': [0.138, 0.138, 0.138, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.628, 1.0], 'all_L1': [0.14, 0.14, 0.761, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.017, 0.042, 1.0], 'all_L1': [0.142, 0.142, 0.164, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.685, 0.981, 0.981, 0.981], 'all_L1': [0.568, 0.857, 0.857, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.975, 0.996, 0.996, 0.996], 'all_L1': [0.845, 0.863, 0.863, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.761, 0.979, 0.979], 'all_L1': [0.636, 0.636, 0.857, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.715, 0.73, 0.832, 0.974], 'all_L1': [0.603, 0.616, 0.71, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.749, 0.816, 0.976], 'all_L1': [0.63, 0.63, 0.694, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.704, 0.984, 0.984], 'all_L1': [0.581, 0.581, 0.86, 0.859]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.703, 0.703, 0.703], 'all_L1': [0.592, 0.592, 0.592, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.694, 0.694, 0.694, 0.991], 'all_L1': [0.572, 0.572, 0.572, 0.862]}), defaultdict(<class 'list'>, {'all_KL': [0.972, 0.972, 0.994, 0.994], 'all_L1': [0.844, 0.844, 0.863, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.724, 0.724, 0.983, 0.983], 'all_L1': [0.595, 0.595, 0.857, 0.857]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.284, 0.284, 1.0, 1.0], 'all_L1': [0.349, 0.349, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.661, 1.0, 1.0], 'all_L1': [0.559, 0.699, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.328, 0.328, 1.0], 'all_L1': [0.371, 0.371, 0.371, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.743, 0.743, 1.0], 'all_L1': [0.739, 0.739, 0.739, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.464, 0.464, 1.0], 'all_L1': [0.493, 0.493, 0.493, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.585, 1.0], 'all_L1': [0.583, 0.583, 0.583, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.027, 0.027, 0.027], 'all_L1': [0.151, 0.151, 0.151, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 0.845, 1.0], 'all_L1': [0.839, 0.839, 0.839, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.882, 1.0, 1.0], 'all_L1': [0.878, 0.878, 1.0, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.892, 0.892, 1.0], 'all_L1': [0.89, 0.89, 0.89, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.613, 0.715, 0.716, 0.716], 'all_L1': [0.553, 0.651, 0.651, 0.651]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.463, 0.463, 0.463], 'all_L1': [0.441, 0.441, 0.441, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.672, 0.672], 'all_L1': [0.546, 0.546, 0.629, 0.629]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.241, 0.243, 0.257], 'all_L1': [0.245, 0.245, 0.248, 0.261]}), defaultdict(<class 'list'>, {'all_KL': [0.485, 0.485, 0.485, 0.536], 'all_L1': [0.456, 0.456, 0.457, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.367, 0.367, 0.415, 0.415], 'all_L1': [0.375, 0.375, 0.417, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.765, 0.765, 0.765], 'all_L1': [0.653, 0.653, 0.653, 0.653]}), defaultdict(<class 'list'>, {'all_KL': [0.147, 0.147, 0.147, 0.155], 'all_L1': [0.155, 0.155, 0.155, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.118, 0.118, 0.118], 'all_L1': [0.122, 0.122, 0.122, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.1, 0.108, 0.108], 'all_L1': [0.102, 0.102, 0.11, 0.11]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.63, 0.63, 1.0, 1.0], 'all_L1': [0.683, 0.682, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.762, 0.876, 1.0, 1.0], 'all_L1': [0.793, 0.885, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.649, 0.649, 0.65, 1.0], 'all_L1': [0.699, 0.699, 0.699, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.638, 0.639, 0.64, 1.0], 'all_L1': [0.688, 0.689, 0.689, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.642, 0.642, 0.642, 1.0], 'all_L1': [0.693, 0.693, 0.693, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.631, 0.633, 1.0], 'all_L1': [0.68, 0.68, 0.682, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.651, 0.651, 0.651, 0.651], 'all_L1': [0.7, 0.7, 0.7, 0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.614, 0.614, 0.614, 1.0], 'all_L1': [0.669, 0.669, 0.669, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.774, 0.774, 0.744, 1.0], 'all_L1': [0.802, 0.802, 0.756, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.642, 0.642, 0.642, 1.0], 'all_L1': [0.691, 0.691, 0.692, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.08, 0.221, 0.264, 0.264], 'all_L1': [0.072, 0.191, 0.224, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.276, 0.275, 0.275], 'all_L1': [0.234, 0.234, 0.233, 0.233]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.068, 0.197, 0.245], 'all_L1': [0.062, 0.062, 0.172, 0.208]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.075, 0.097, 0.255], 'all_L1': [0.069, 0.069, 0.087, 0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.076, 0.084, 0.254], 'all_L1': [0.067, 0.067, 0.073, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.078, 0.217, 0.263], 'all_L1': [0.072, 0.072, 0.191, 0.225]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.07, 0.07, 0.07], 'all_L1': [0.063, 0.063, 0.063, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.102, 0.102, 0.102, 0.28], 'all_L1': [0.09, 0.09, 0.09, 0.237]}), defaultdict(<class 'list'>, {'all_KL': [0.262, 0.262, 0.265, 0.264], 'all_L1': [0.223, 0.223, 0.223, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.074, 0.204, 0.251], 'all_L1': [0.068, 0.068, 0.18, 0.214]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.142 +- 0.003, 0.196 +- 0.159, 0.380 +- 0.359, 0.914 +- 0.257
suff_simple class all_KL  =  0.017 +- 0.007, 0.077 +- 0.174, 0.281 +- 0.401, 0.902 +- 0.294
[[0.0, 0.007220216561108828, -1.0, -1.0], [0.0, 0.6326530575752258, -1.0, -1.0], [0.0, 0.0, 0.014492753893136978, -1.0], [0.0, 0.0, 0.003610108280554414, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.010830325074493885, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, -1.0], [0.003610108280554414, 0.003610108280554414, 0.8333333134651184, -1.0], [0.0, 0.0, 0.02527075819671154, -1.0]]
[[0.019, 0.027, 1.0, 1.0], [0.004, 0.599, 1.0, 1.0], [0.021, 0.021, 0.035, 1.0], [0.026, 0.026, 0.029, 1.0], [0.024, 0.024, 0.024, 1.0], [0.016, 0.016, 0.026, 1.0], [0.021, 0.021, 0.021, 0.021], [0.009, 0.009, 0.009, 1.0], [0.009, 0.009, 0.628, 1.0], [0.017, 0.017, 0.042, 1.0]]
suff_simple_acc_int  =  0.000 +- 0.001, 0.064 +- 0.189, -0.111 +- 0.507, -0.900 +- 0.300
nec class all_L1  =  0.647 +- 0.101, 0.679 +- 0.117, 0.773 +- 0.113, 0.832 +- 0.080
nec class all_KL  =  0.768 +- 0.105, 0.801 +- 0.121, 0.896 +- 0.117, 0.956 +- 0.085
[[0.3646209239959717, 0.0004512635350693017, 0.0009025270701386034, 0.0009025270701386034], [0.02166065014898777, 0.0009025270701386034, 0.0009025270701386034, 0.0009025270701386034], [0.27075812220573425, 0.27075812220573425, 0.0, 0.0004512635350693017], [0.3249097466468811, 0.31046929955482483, 0.19494584202766418, 0.0], [0.288808673620224, 0.288808673620224, 0.20938627421855927, 0.0009025270701386034], [0.3754512667655945, 0.3754512667655945, 0.0, 0.0004512635350693017], [0.31768953800201416, 0.31768953800201416, 0.31768953800201416, 0.31768953800201416], [0.36823105812072754, 0.36823105812072754, 0.36823105812072754, 0.0004512635350693017], [0.022111913189291954, 0.022111913189291954, 0.0, 0.0004512635350693017], [0.3501805067062378, 0.3501805067062378, 0.0013537906343117356, 0.0013537906343117356]]
[[0.685, 0.981, 0.981, 0.981], [0.975, 0.996, 0.996, 0.996], [0.761, 0.761, 0.979, 0.979], [0.715, 0.73, 0.832, 0.974], [0.749, 0.749, 0.816, 0.976], [0.704, 0.704, 0.984, 0.984], [0.703, 0.703, 0.703, 0.703], [0.694, 0.694, 0.694, 0.991], [0.972, 0.972, 0.994, 0.994], [0.724, 0.724, 0.983, 0.983]]
nec_acc_int  =  0.270 +- 0.128, 0.231 +- 0.149, 0.109 +- 0.141, 0.032 +- 0.095

Eval split val
suff_simple class all_L1  =  0.585 +- 0.238, 0.599 +- 0.240, 0.707 +- 0.282, 0.915 +- 0.255
suff_simple class all_KL  =  0.559 +- 0.274, 0.571 +- 0.276, 0.688 +- 0.314, 0.903 +- 0.292
[[0.0, 0.0, -1.0, -1.0], [0.00039682540227659047, 0.5, -1.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.284, 0.284, 1.0, 1.0], [0.537, 0.661, 1.0, 1.0], [0.328, 0.328, 0.328, 1.0], [0.743, 0.743, 0.743, 1.0], [0.464, 0.464, 0.464, 1.0], [0.585, 0.585, 0.585, 1.0], [0.027, 0.027, 0.027, 0.027], [0.845, 0.845, 0.845, 1.0], [0.882, 0.882, 1.0, 1.0], [0.892, 0.892, 0.892, 1.0]]
suff_simple_acc_int  =  0.000 +- 0.000, 0.050 +- 0.150, -0.200 +- 0.400, -0.900 +- 0.300
nec class all_L1  =  0.365 +- 0.188, 0.375 +- 0.199, 0.388 +- 0.207, 0.395 +- 0.207
nec class all_KL  =  0.388 +- 0.220, 0.399 +- 0.232, 0.413 +- 0.239, 0.420 +- 0.239
[[0.12261904776096344, 0.0007936508045531809, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0], [0.1111111119389534, 0.1111111119389534, 0.0, 0.0], [0.02023809589445591, 0.02023809589445591, 0.01785714365541935, 0.0], [0.06626984477043152, 0.06626984477043152, 0.065476194024086, 0.0], [0.05595238134264946, 0.05595238134264946, 0.0, 0.0], [0.24166665971279144, 0.24166665971279144, 0.24166665971279144, 0.24166665971279144], [0.011904762126505375, 0.011904762126505375, 0.011904762126505375, 0.0], [0.0, 0.0, 0.0, 0.0], [0.012301587499678135, 0.012301587499678135, 0.0, 0.0]]
[[0.613, 0.715, 0.716, 0.716], [0.463, 0.463, 0.463, 0.463], [0.585, 0.585, 0.672, 0.672], [0.241, 0.241, 0.243, 0.257], [0.485, 0.485, 0.485, 0.536], [0.367, 0.367, 0.415, 0.415], [0.765, 0.765, 0.765, 0.765], [0.147, 0.147, 0.147, 0.155], [0.118, 0.118, 0.118, 0.118], [0.1, 0.1, 0.108, 0.108]]
nec_acc_int  =  0.064 +- 0.073, 0.052 +- 0.072, 0.034 +- 0.072, 0.024 +- 0.072

Eval split test
suff_simple class all_L1  =  0.710 +- 0.045, 0.719 +- 0.066, 0.758 +- 0.123, 0.970 +- 0.090
suff_simple class all_KL  =  0.663 +- 0.053, 0.675 +- 0.079, 0.722 +- 0.143, 0.965 +- 0.105
[[0.47771671414375305, 0.48270249366760254, -1.0, -1.0], [0.6178266406059265, 0.7252747416496277, -1.0, -1.0], [0.4829568564891815, 0.4829568564891815, 0.4853479862213135, -1.0], [0.4802604913711548, 0.4812270998954773, 0.48158323764801025, -1.0], [0.4822954833507538, 0.4822954833507538, 0.48280423879623413, -1.0], [0.47761496901512146, 0.47761496901512146, 0.4810236096382141, -1.0], [0.48463574051856995, 0.48463574051856995, 0.48463574051856995, 0.48463574051856995], [0.4801587164402008, 0.4801587164402008, 0.4801587164402008, -1.0], [0.6145706176757812, 0.6145706176757812, 0.47058823704719543, -1.0], [0.4789886176586151, 0.4789886176586151, 0.4821428656578064, -1.0]]
[[0.63, 0.63, 1.0, 1.0], [0.762, 0.876, 1.0, 1.0], [0.649, 0.649, 0.65, 1.0], [0.638, 0.639, 0.64, 1.0], [0.642, 0.642, 0.642, 1.0], [0.631, 0.631, 0.633, 1.0], [0.651, 0.651, 0.651, 0.651], [0.614, 0.614, 0.614, 1.0], [0.774, 0.774, 0.744, 1.0], [0.642, 0.642, 0.642, 1.0]]
suff_simple_acc_int  =  0.508 +- 0.054, 0.519 +- 0.079, 0.185 +- 0.592, -0.852 +- 0.445
nec class all_L1  =  0.102 +- 0.064, 0.114 +- 0.068, 0.154 +- 0.065, 0.206 +- 0.048
nec class all_KL  =  0.116 +- 0.077, 0.130 +- 0.082, 0.178 +- 0.077, 0.242 +- 0.058
[[0.7682333588600159, 0.6193273663520813, 0.5817463397979736, 0.5817463397979736], [0.5881786942481995, 0.5843294262886047, 0.5858995318412781, 0.5858995318412781], [0.7670178413391113, 0.7670178413391113, 0.6286466717720032, 0.5877735018730164], [0.7730956077575684, 0.7722852230072021, 0.7479740977287292, 0.5868111848831177], [0.7735008001327515, 0.7735008001327515, 0.7649918794631958, 0.5874696373939514], [0.7702593207359314, 0.7702593207359314, 0.6227208375930786, 0.5853424072265625], [0.7670178413391113, 0.7670178413391113, 0.7670178413391113, 0.7670178413391113], [0.7735008001327515, 0.7735008001327515, 0.7735008001327515, 0.5871150493621826], [0.5914201736450195, 0.5914201736450195, 0.5852917432785034, 0.5842787623405457], [0.7641814947128296, 0.7641814947128296, 0.6229234337806702, 0.5852410793304443]]
[[0.08, 0.221, 0.264, 0.264], [0.275, 0.276, 0.275, 0.275], [0.068, 0.068, 0.197, 0.245], [0.074, 0.075, 0.097, 0.255], [0.076, 0.076, 0.084, 0.254], [0.078, 0.078, 0.217, 0.263], [0.07, 0.07, 0.07, 0.07], [0.102, 0.102, 0.102, 0.28], [0.262, 0.262, 0.265, 0.264], [0.074, 0.074, 0.204, 0.251]]
nec_acc_int  =  0.734 +- 0.072, 0.718 +- 0.079, 0.668 +- 0.080, 0.604 +- 0.054


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.394 +- 0.050, 0.437 +- 0.121, 0.576 +- 0.214, 0.873 +- 0.168
Faith. Armon (L1)= 		  =  0.232 +- 0.005, 0.286 +- 0.157, 0.439 +- 0.295, 0.855 +- 0.208
Faith. GMean (L1)= 	  =  0.302 +- 0.021, 0.351 +- 0.139, 0.498 +- 0.259, 0.863 +- 0.190
Faith. Aritm (KL)= 		  =  0.392 +- 0.050, 0.439 +- 0.130, 0.589 +- 0.236, 0.929 +- 0.189
Faith. Armon (KL)= 		  =  0.032 +- 0.013, 0.108 +- 0.214, 0.312 +- 0.402, 0.897 +- 0.285
Faith. GMean (KL)= 	  =  0.108 +- 0.023, 0.184 +- 0.197, 0.382 +- 0.361, 0.905 +- 0.261

Eval split val
Faith. Aritm (L1)= 		  =  0.475 +- 0.029, 0.487 +- 0.040, 0.547 +- 0.121, 0.655 +- 0.127
Faith. Armon (L1)= 		  =  0.357 +- 0.113, 0.364 +- 0.121, 0.412 +- 0.182, 0.479 +- 0.223
Faith. GMean (L1)= 	  =  0.406 +- 0.069, 0.415 +- 0.081, 0.469 +- 0.151, 0.553 +- 0.185
Faith. Aritm (KL)= 		  =  0.474 +- 0.031, 0.485 +- 0.039, 0.551 +- 0.131, 0.662 +- 0.137
Faith. Armon (KL)= 		  =  0.329 +- 0.140, 0.335 +- 0.147, 0.394 +- 0.219, 0.469 +- 0.264
Faith. GMean (KL)= 	  =  0.383 +- 0.101, 0.392 +- 0.110, 0.454 +- 0.186, 0.544 +- 0.224

Eval split test
Faith. Aritm (L1)= 		  =  0.406 +- 0.054, 0.416 +- 0.063, 0.456 +- 0.086, 0.588 +- 0.069
Faith. Armon (L1)= 		  =  0.173 +- 0.092, 0.191 +- 0.099, 0.251 +- 0.096, 0.338 +- 0.075
Faith. GMean (L1)= 	  =  0.261 +- 0.083, 0.277 +- 0.092, 0.335 +- 0.096, 0.445 +- 0.079
Faith. Aritm (KL)= 		  =  0.390 +- 0.064, 0.403 +- 0.076, 0.450 +- 0.102, 0.604 +- 0.081
Faith. Armon (KL)= 		  =  0.190 +- 0.105, 0.210 +- 0.113, 0.279 +- 0.110, 0.385 +- 0.087
Faith. GMean (KL)= 	  =  0.268 +- 0.093, 0.287 +- 0.103, 0.352 +- 0.109, 0.481 +- 0.090
Computed for split load_split = id



Completed in  0:40:54.648772  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.1 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:22:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:22:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.097
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.110
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.110


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.104
SUFF_SIMPLE for r=0.6 class 1.0 = 0.184 +- 0.076 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.076 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.6 all L1 = 0.184 +- 0.074 (in-sample avg dev_std = 0.525)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.072
SUFF_SIMPLE for r=0.5 class 1.0 = 0.17 +- 0.077 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.077 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.5 all L1 = 0.17 +- 0.054 (in-sample avg dev_std = 0.459)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.019)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.5 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.5 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.026)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.717
SUFF_SIMPLE for r=0.6 class 1.0 = 0.882 +- 0.355 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.6 all KL = 0.842 +- 0.355 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.6 all L1 = 0.882 +- 0.273 (in-sample avg dev_std = 0.251)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.712
SUFF_SIMPLE for r=0.5 class 1.0 = 0.88 +- 0.355 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.5 all KL = 0.844 +- 0.355 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.5 all L1 = 0.88 +- 0.278 (in-sample avg dev_std = 0.240)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.703
NEC for r=0.6 class 1.0 = 0.294 +- 0.419 (in-sample avg dev_std = 0.244)
NEC for r=0.6 all KL = 0.391 +- 0.419 (in-sample avg dev_std = 0.244)
NEC for r=0.6 all L1 = 0.294 +- 0.347 (in-sample avg dev_std = 0.244)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.708
NEC for r=0.5 class 1.0 = 0.305 +- 0.407 (in-sample avg dev_std = 0.284)
NEC for r=0.5 all KL = 0.428 +- 0.407 (in-sample avg dev_std = 0.284)
NEC for r=0.5 all L1 = 0.305 +- 0.335 (in-sample avg dev_std = 0.284)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09688808664259928
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 1.0 = 0.414 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all KL = 0.665 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all L1 = 0.414 +- 0.301 (in-sample avg dev_std = 0.549)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09688808664259928
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 1.0 = 0.414 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all KL = 0.665 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all L1 = 0.414 +- 0.301 (in-sample avg dev_std = 0.549)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.083
NEC for r=0.6 class 1.0 = 0.591 +- 0.423 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all KL = 0.659 +- 0.423 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all L1 = 0.591 +- 0.358 (in-sample avg dev_std = 0.116)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.043
NEC for r=0.5 class 1.0 = 0.623 +- 0.411 (in-sample avg dev_std = 0.122)
NEC for r=0.5 all KL = 0.695 +- 0.411 (in-sample avg dev_std = 0.122)
NEC for r=0.5 all L1 = 0.623 +- 0.346 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.019
NEC for r=0.4 class 1.0 = 0.645 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all KL = 0.716 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all L1 = 0.645 +- 0.332 (in-sample avg dev_std = 0.231)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.724
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.019
NEC for r=0.3 class 1.0 = 0.645 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.716 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.645 +- 0.332 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.816
NEC for r=0.6 class 1.0 = 0.056 +- 0.237 (in-sample avg dev_std = 0.109)
NEC for r=0.6 all KL = 0.071 +- 0.237 (in-sample avg dev_std = 0.109)
NEC for r=0.6 all L1 = 0.056 +- 0.189 (in-sample avg dev_std = 0.109)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.821
NEC for r=0.5 class 1.0 = 0.07 +- 0.271 (in-sample avg dev_std = 0.149)
NEC for r=0.5 all KL = 0.09 +- 0.271 (in-sample avg dev_std = 0.149)
NEC for r=0.5 all L1 = 0.07 +- 0.213 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11026742301458671
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.751
NEC for r=0.4 class 1.0 = 0.098 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all KL = 0.158 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all L1 = 0.098 +- 0.238 (in-sample avg dev_std = 0.273)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11026742301458671
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.751
NEC for r=0.3 class 1.0 = 0.098 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.158 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.098 +- 0.238 (in-sample avg dev_std = 0.273)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:26:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:26:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.145
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.107
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.103
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.155
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.121
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.117
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.117


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.323
SUFF_SIMPLE for r=0.6 class 1.0 = 0.338 +- 0.219 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.6 all KL = 0.087 +- 0.219 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.6 all L1 = 0.338 +- 0.263 (in-sample avg dev_std = 0.475)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10736823104693141
len(reference) = 98
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.5 =  0.898
SUFF_SIMPLE for r=0.5 class 1.0 = 0.892 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.847 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.892 +- 0.247 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.008
SUFF_SIMPLE for r=0.6 class 1.0 = 0.557 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.557 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.595
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013078174603174605
len(reference) = 158
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.5 =  0.335
SUFF_SIMPLE for r=0.5 class 1.0 = 0.724 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.726 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.724 +- 0.306 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.818
SUFF_SIMPLE for r=0.6 class 1.0 = 0.916 +- 0.291 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.6 all KL = 0.895 +- 0.291 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.6 all L1 = 0.916 +- 0.241 (in-sample avg dev_std = 0.100)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.881
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.12139262560777957
len(reference) = 1149
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.845
SUFF_SIMPLE for r=0.5 class 1.0 = 0.958 +- 0.179 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.955 +- 0.179 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.958 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.732
NEC for r=0.6 class 1.0 = 0.342 +- 0.391 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all KL = 0.615 +- 0.391 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all L1 = 0.342 +- 0.283 (in-sample avg dev_std = 0.586)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10736823104693141
len(reference) = 277
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.5 =  0.769
NEC for r=0.5 class 1.0 = 0.308 +- 0.394 (in-sample avg dev_std = 0.565)
NEC for r=0.5 all KL = 0.584 +- 0.394 (in-sample avg dev_std = 0.565)
NEC for r=0.5 all L1 = 0.308 +- 0.265 (in-sample avg dev_std = 0.565)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10349097472924189
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.777
NEC for r=0.4 class 1.0 = 0.297 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all KL = 0.565 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all L1 = 0.297 +- 0.271 (in-sample avg dev_std = 0.542)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10349097472924189
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.777
NEC for r=0.3 class 1.0 = 0.297 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.3 all KL = 0.565 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.3 all L1 = 0.297 +- 0.271 (in-sample avg dev_std = 0.542)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.013
NEC for r=0.6 class 1.0 = 0.443 +- 0.441 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.47 +- 0.441 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.443 +- 0.384 (in-sample avg dev_std = 0.191)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.465
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013078174603174605
len(reference) = 2520
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.5 =  0.01
NEC for r=0.5 class 1.0 = 0.442 +- 0.442 (in-sample avg dev_std = 0.171)
NEC for r=0.5 all KL = 0.468 +- 0.442 (in-sample avg dev_std = 0.171)
NEC for r=0.5 all L1 = 0.442 +- 0.385 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.465
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013076587301587303
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.011
NEC for r=0.4 class 1.0 = 0.442 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all KL = 0.468 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all L1 = 0.442 +- 0.385 (in-sample avg dev_std = 0.177)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013076587301587303
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.011
NEC for r=0.3 class 1.0 = 0.442 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all KL = 0.468 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all L1 = 0.442 +- 0.385 (in-sample avg dev_std = 0.177)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.748
NEC for r=0.6 class 1.0 = 0.106 +- 0.351 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.157 +- 0.351 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.106 +- 0.254 (in-sample avg dev_std = 0.259)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.846
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.12139262560777957
len(reference) = 2468
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.753
NEC for r=0.5 class 1.0 = 0.106 +- 0.355 (in-sample avg dev_std = 0.270)
NEC for r=0.5 all KL = 0.163 +- 0.355 (in-sample avg dev_std = 0.270)
NEC for r=0.5 all L1 = 0.106 +- 0.251 (in-sample avg dev_std = 0.270)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.846
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11721029173419774
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.755
NEC for r=0.4 class 1.0 = 0.106 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all KL = 0.163 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all L1 = 0.106 +- 0.250 (in-sample avg dev_std = 0.273)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.846
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11721029173419774
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.755
NEC for r=0.3 class 1.0 = 0.106 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.163 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.106 +- 0.250 (in-sample avg dev_std = 0.273)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:31:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:31:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.092
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.105


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.083
SUFF_SIMPLE for r=0.6 class 1.0 = 0.177 +- 0.073 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.073 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.6 all L1 = 0.177 +- 0.057 (in-sample avg dev_std = 0.494)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.083
SUFF_SIMPLE for r=0.5 class 1.0 = 0.177 +- 0.073 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.5 all KL = 0.024 +- 0.073 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.5 all L1 = 0.177 +- 0.057 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.066
SUFF_SIMPLE for r=0.4 class 1.0 = 0.169 +- 0.073 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.4 all KL = 0.024 +- 0.073 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.4 all L1 = 0.169 +- 0.047 (in-sample avg dev_std = 0.455)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.002)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.003)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF_SIMPLE for r=0.6 class 1.0 = 0.898 +- 0.329 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.6 all KL = 0.865 +- 0.329 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.6 all L1 = 0.898 +- 0.254 (in-sample avg dev_std = 0.233)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.722
SUFF_SIMPLE for r=0.5 class 1.0 = 0.898 +- 0.329 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.5 all KL = 0.865 +- 0.329 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.5 all L1 = 0.898 +- 0.254 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.717
SUFF_SIMPLE for r=0.4 class 1.0 = 0.895 +- 0.331 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 all KL = 0.865 +- 0.331 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 all L1 = 0.895 +- 0.259 (in-sample avg dev_std = 0.231)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.672
NEC for r=0.6 class 1.0 = 0.338 +- 0.400 (in-sample avg dev_std = 0.198)
NEC for r=0.6 all KL = 0.439 +- 0.400 (in-sample avg dev_std = 0.198)
NEC for r=0.6 all L1 = 0.338 +- 0.343 (in-sample avg dev_std = 0.198)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.672
NEC for r=0.5 class 1.0 = 0.338 +- 0.400 (in-sample avg dev_std = 0.198)
NEC for r=0.5 all KL = 0.439 +- 0.400 (in-sample avg dev_std = 0.198)
NEC for r=0.5 all L1 = 0.338 +- 0.343 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.689
NEC for r=0.4 class 1.0 = 0.336 +- 0.378 (in-sample avg dev_std = 0.251)
NEC for r=0.4 all KL = 0.452 +- 0.378 (in-sample avg dev_std = 0.251)
NEC for r=0.4 all L1 = 0.336 +- 0.327 (in-sample avg dev_std = 0.251)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.996
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09193862815884478
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.627
NEC for r=0.3 class 1.0 = 0.424 +- 0.332 (in-sample avg dev_std = 0.543)
NEC for r=0.3 all KL = 0.649 +- 0.332 (in-sample avg dev_std = 0.543)
NEC for r=0.3 all L1 = 0.424 +- 0.283 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.043
NEC for r=0.6 class 1.0 = 0.601 +- 0.406 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all KL = 0.642 +- 0.406 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all L1 = 0.601 +- 0.338 (in-sample avg dev_std = 0.084)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.043
NEC for r=0.5 class 1.0 = 0.601 +- 0.406 (in-sample avg dev_std = 0.084)
NEC for r=0.5 all KL = 0.642 +- 0.406 (in-sample avg dev_std = 0.084)
NEC for r=0.5 all L1 = 0.601 +- 0.338 (in-sample avg dev_std = 0.084)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.012
NEC for r=0.4 class 1.0 = 0.624 +- 0.400 (in-sample avg dev_std = 0.084)
NEC for r=0.4 all KL = 0.67 +- 0.400 (in-sample avg dev_std = 0.084)
NEC for r=0.4 all L1 = 0.624 +- 0.329 (in-sample avg dev_std = 0.084)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012926190476190475
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.008
NEC for r=0.3 class 1.0 = 0.627 +- 0.400 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.671 +- 0.400 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.627 +- 0.328 (in-sample avg dev_std = 0.162)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.804
NEC for r=0.6 class 1.0 = 0.068 +- 0.256 (in-sample avg dev_std = 0.106)
NEC for r=0.6 all KL = 0.083 +- 0.256 (in-sample avg dev_std = 0.106)
NEC for r=0.6 all L1 = 0.068 +- 0.215 (in-sample avg dev_std = 0.106)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.815
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.804
NEC for r=0.5 class 1.0 = 0.068 +- 0.256 (in-sample avg dev_std = 0.106)
NEC for r=0.5 all KL = 0.083 +- 0.256 (in-sample avg dev_std = 0.106)
NEC for r=0.5 all L1 = 0.068 +- 0.215 (in-sample avg dev_std = 0.106)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.815
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.822
NEC for r=0.4 class 1.0 = 0.076 +- 0.275 (in-sample avg dev_std = 0.152)
NEC for r=0.4 all KL = 0.096 +- 0.275 (in-sample avg dev_std = 0.152)
NEC for r=0.4 all L1 = 0.076 +- 0.226 (in-sample avg dev_std = 0.152)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10485737439222043
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.752
NEC for r=0.3 class 1.0 = 0.083 +- 0.319 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.131 +- 0.319 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.083 +- 0.216 (in-sample avg dev_std = 0.252)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:35:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:35:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.087
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.099


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.088
SUFF_SIMPLE for r=0.6 class 1.0 = 0.178 +- 0.080 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 all KL = 0.028 +- 0.080 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 all L1 = 0.178 +- 0.058 (in-sample avg dev_std = 0.503)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.088
SUFF_SIMPLE for r=0.5 class 1.0 = 0.178 +- 0.080 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.5 all KL = 0.028 +- 0.080 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.5 all L1 = 0.178 +- 0.058 (in-sample avg dev_std = 0.503)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.083
SUFF_SIMPLE for r=0.4 class 1.0 = 0.175 +- 0.083 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.4 all KL = 0.028 +- 0.083 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.4 all L1 = 0.175 +- 0.057 (in-sample avg dev_std = 0.485)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF_SIMPLE for r=0.6 class 1.0 = 0.889 +- 0.338 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.6 all KL = 0.856 +- 0.338 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.6 all L1 = 0.889 +- 0.264 (in-sample avg dev_std = 0.242)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.825
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.722
SUFF_SIMPLE for r=0.5 class 1.0 = 0.889 +- 0.338 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.5 all KL = 0.856 +- 0.338 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.5 all L1 = 0.889 +- 0.264 (in-sample avg dev_std = 0.242)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.716
SUFF_SIMPLE for r=0.4 class 1.0 = 0.886 +- 0.340 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.4 all KL = 0.856 +- 0.340 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.4 all L1 = 0.886 +- 0.270 (in-sample avg dev_std = 0.228)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.664
NEC for r=0.6 class 1.0 = 0.336 +- 0.412 (in-sample avg dev_std = 0.224)
NEC for r=0.6 all KL = 0.429 +- 0.412 (in-sample avg dev_std = 0.224)
NEC for r=0.6 all L1 = 0.336 +- 0.354 (in-sample avg dev_std = 0.224)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.664
NEC for r=0.5 class 1.0 = 0.336 +- 0.412 (in-sample avg dev_std = 0.224)
NEC for r=0.5 all KL = 0.429 +- 0.412 (in-sample avg dev_std = 0.224)
NEC for r=0.5 all L1 = 0.336 +- 0.354 (in-sample avg dev_std = 0.224)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.665
NEC for r=0.4 class 1.0 = 0.34 +- 0.394 (in-sample avg dev_std = 0.276)
NEC for r=0.4 all KL = 0.457 +- 0.394 (in-sample avg dev_std = 0.276)
NEC for r=0.4 all L1 = 0.34 +- 0.341 (in-sample avg dev_std = 0.276)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.08690974729241878
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.604
NEC for r=0.3 class 1.0 = 0.432 +- 0.337 (in-sample avg dev_std = 0.521)
NEC for r=0.3 all KL = 0.67 +- 0.337 (in-sample avg dev_std = 0.521)
NEC for r=0.3 all L1 = 0.432 +- 0.299 (in-sample avg dev_std = 0.521)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.015
NEC for r=0.6 class 1.0 = 0.255 +- 0.374 (in-sample avg dev_std = 0.052)
NEC for r=0.6 all KL = 0.252 +- 0.374 (in-sample avg dev_std = 0.052)
NEC for r=0.6 all L1 = 0.255 +- 0.344 (in-sample avg dev_std = 0.052)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.015
NEC for r=0.5 class 1.0 = 0.255 +- 0.374 (in-sample avg dev_std = 0.052)
NEC for r=0.5 all KL = 0.252 +- 0.374 (in-sample avg dev_std = 0.052)
NEC for r=0.5 all L1 = 0.255 +- 0.344 (in-sample avg dev_std = 0.052)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.005
NEC for r=0.4 class 1.0 = 0.262 +- 0.382 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.259 +- 0.382 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.262 +- 0.350 (in-sample avg dev_std = 0.045)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.254
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012841269841269841
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.004
NEC for r=0.3 class 1.0 = 0.26 +- 0.380 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all KL = 0.258 +- 0.380 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all L1 = 0.26 +- 0.349 (in-sample avg dev_std = 0.099)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.804
NEC for r=0.6 class 1.0 = 0.067 +- 0.254 (in-sample avg dev_std = 0.098)
NEC for r=0.6 all KL = 0.08 +- 0.254 (in-sample avg dev_std = 0.098)
NEC for r=0.6 all L1 = 0.067 +- 0.213 (in-sample avg dev_std = 0.098)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.822
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.804
NEC for r=0.5 class 1.0 = 0.067 +- 0.254 (in-sample avg dev_std = 0.098)
NEC for r=0.5 all KL = 0.08 +- 0.254 (in-sample avg dev_std = 0.098)
NEC for r=0.5 all L1 = 0.067 +- 0.213 (in-sample avg dev_std = 0.098)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.822
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 1.0 = 0.074 +- 0.271 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all KL = 0.092 +- 0.271 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all L1 = 0.074 +- 0.224 (in-sample avg dev_std = 0.150)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.822
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09927066450567261
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.753
NEC for r=0.3 class 1.0 = 0.091 +- 0.325 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all KL = 0.138 +- 0.325 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all L1 = 0.091 +- 0.229 (in-sample avg dev_std = 0.255)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:39:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:39:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.083
SUFF_SIMPLE for r=0.6 class 1.0 = 0.175 +- 0.086 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.6 all KL = 0.026 +- 0.086 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.6 all L1 = 0.175 +- 0.063 (in-sample avg dev_std = 0.475)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.083
SUFF_SIMPLE for r=0.5 class 1.0 = 0.175 +- 0.086 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.5 all KL = 0.026 +- 0.086 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.5 all L1 = 0.175 +- 0.063 (in-sample avg dev_std = 0.475)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.071
SUFF_SIMPLE for r=0.4 class 1.0 = 0.171 +- 0.085 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.4 all KL = 0.026 +- 0.085 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.4 all L1 = 0.171 +- 0.066 (in-sample avg dev_std = 0.452)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.005)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.5 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.5 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.005)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.001)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF_SIMPLE for r=0.6 class 1.0 = 0.891 +- 0.342 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 all KL = 0.855 +- 0.342 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 all L1 = 0.891 +- 0.265 (in-sample avg dev_std = 0.241)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.721
SUFF_SIMPLE for r=0.5 class 1.0 = 0.891 +- 0.342 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all KL = 0.855 +- 0.342 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all L1 = 0.891 +- 0.265 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.717
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.342 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all KL = 0.856 +- 0.342 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.268 (in-sample avg dev_std = 0.236)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.676
NEC for r=0.6 class 1.0 = 0.31 +- 0.416 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all KL = 0.405 +- 0.416 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all L1 = 0.31 +- 0.355 (in-sample avg dev_std = 0.231)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.676
NEC for r=0.5 class 1.0 = 0.31 +- 0.416 (in-sample avg dev_std = 0.231)
NEC for r=0.5 all KL = 0.405 +- 0.416 (in-sample avg dev_std = 0.231)
NEC for r=0.5 all L1 = 0.31 +- 0.355 (in-sample avg dev_std = 0.231)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.677
NEC for r=0.4 class 1.0 = 0.328 +- 0.404 (in-sample avg dev_std = 0.283)
NEC for r=0.4 all KL = 0.45 +- 0.404 (in-sample avg dev_std = 0.283)
NEC for r=0.4 all L1 = 0.328 +- 0.346 (in-sample avg dev_std = 0.283)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.989
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09388086642599279
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.602
NEC for r=0.3 class 1.0 = 0.438 +- 0.351 (in-sample avg dev_std = 0.534)
NEC for r=0.3 all KL = 0.687 +- 0.351 (in-sample avg dev_std = 0.534)
NEC for r=0.3 all L1 = 0.438 +- 0.300 (in-sample avg dev_std = 0.534)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.04
NEC for r=0.6 class 1.0 = 0.486 +- 0.439 (in-sample avg dev_std = 0.079)
NEC for r=0.6 all KL = 0.512 +- 0.439 (in-sample avg dev_std = 0.079)
NEC for r=0.6 all L1 = 0.486 +- 0.378 (in-sample avg dev_std = 0.079)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.04
NEC for r=0.5 class 1.0 = 0.486 +- 0.439 (in-sample avg dev_std = 0.079)
NEC for r=0.5 all KL = 0.512 +- 0.439 (in-sample avg dev_std = 0.079)
NEC for r=0.5 all L1 = 0.486 +- 0.378 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.011
NEC for r=0.4 class 1.0 = 0.509 +- 0.441 (in-sample avg dev_std = 0.082)
NEC for r=0.4 all KL = 0.539 +- 0.441 (in-sample avg dev_std = 0.082)
NEC for r=0.4 all L1 = 0.509 +- 0.378 (in-sample avg dev_std = 0.082)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012959126984126983
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.015
NEC for r=0.3 class 1.0 = 0.51 +- 0.433 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all KL = 0.546 +- 0.433 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all L1 = 0.51 +- 0.372 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.816
NEC for r=0.6 class 1.0 = 0.054 +- 0.234 (in-sample avg dev_std = 0.101)
NEC for r=0.6 all KL = 0.069 +- 0.234 (in-sample avg dev_std = 0.101)
NEC for r=0.6 all L1 = 0.054 +- 0.185 (in-sample avg dev_std = 0.101)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.826
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.816
NEC for r=0.5 class 1.0 = 0.054 +- 0.234 (in-sample avg dev_std = 0.101)
NEC for r=0.5 all KL = 0.069 +- 0.234 (in-sample avg dev_std = 0.101)
NEC for r=0.5 all L1 = 0.054 +- 0.185 (in-sample avg dev_std = 0.101)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.826
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.823
NEC for r=0.4 class 1.0 = 0.066 +- 0.261 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.084 +- 0.261 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.066 +- 0.208 (in-sample avg dev_std = 0.151)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10702552674230147
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.75
NEC for r=0.3 class 1.0 = 0.093 +- 0.342 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all KL = 0.153 +- 0.342 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all L1 = 0.093 +- 0.232 (in-sample avg dev_std = 0.268)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:43:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:43:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.132
SUFF_SIMPLE for r=0.6 class 1.0 = 0.198 +- 0.047 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all KL = 0.02 +- 0.047 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all L1 = 0.198 +- 0.074 (in-sample avg dev_std = 0.536)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.132
SUFF_SIMPLE for r=0.5 class 1.0 = 0.198 +- 0.047 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.5 all KL = 0.02 +- 0.047 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.5 all L1 = 0.198 +- 0.074 (in-sample avg dev_std = 0.536)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.116
SUFF_SIMPLE for r=0.4 class 1.0 = 0.191 +- 0.048 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.4 all KL = 0.021 +- 0.048 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.4 all L1 = 0.191 +- 0.071 (in-sample avg dev_std = 0.501)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.6 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.009)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.5 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.5 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.009)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.003)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.719
SUFF_SIMPLE for r=0.6 class 1.0 = 0.882 +- 0.343 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.6 all KL = 0.848 +- 0.343 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.6 all L1 = 0.882 +- 0.271 (in-sample avg dev_std = 0.240)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.719
SUFF_SIMPLE for r=0.5 class 1.0 = 0.882 +- 0.343 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.5 all KL = 0.848 +- 0.343 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.5 all L1 = 0.882 +- 0.271 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.715
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.347 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 all KL = 0.844 +- 0.347 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 all L1 = 0.878 +- 0.276 (in-sample avg dev_std = 0.239)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.789
NEC for r=0.6 class 1.0 = 0.251 +- 0.355 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all KL = 0.308 +- 0.355 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all L1 = 0.251 +- 0.302 (in-sample avg dev_std = 0.211)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.789
NEC for r=0.5 class 1.0 = 0.251 +- 0.355 (in-sample avg dev_std = 0.211)
NEC for r=0.5 all KL = 0.308 +- 0.355 (in-sample avg dev_std = 0.211)
NEC for r=0.5 all L1 = 0.251 +- 0.302 (in-sample avg dev_std = 0.211)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.801
NEC for r=0.4 class 1.0 = 0.25 +- 0.341 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all KL = 0.316 +- 0.341 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all L1 = 0.25 +- 0.292 (in-sample avg dev_std = 0.219)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09389891696750903
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.739
NEC for r=0.3 class 1.0 = 0.338 +- 0.339 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all KL = 0.512 +- 0.339 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all L1 = 0.338 +- 0.267 (in-sample avg dev_std = 0.497)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.029
NEC for r=0.6 class 1.0 = 0.401 +- 0.407 (in-sample avg dev_std = 0.057)
NEC for r=0.6 all KL = 0.396 +- 0.407 (in-sample avg dev_std = 0.057)
NEC for r=0.6 all L1 = 0.401 +- 0.362 (in-sample avg dev_std = 0.057)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.029
NEC for r=0.5 class 1.0 = 0.401 +- 0.407 (in-sample avg dev_std = 0.057)
NEC for r=0.5 all KL = 0.396 +- 0.407 (in-sample avg dev_std = 0.057)
NEC for r=0.5 all L1 = 0.401 +- 0.362 (in-sample avg dev_std = 0.057)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.007
NEC for r=0.4 class 1.0 = 0.418 +- 0.416 (in-sample avg dev_std = 0.065)
NEC for r=0.4 all KL = 0.417 +- 0.416 (in-sample avg dev_std = 0.065)
NEC for r=0.4 all L1 = 0.418 +- 0.367 (in-sample avg dev_std = 0.065)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012961904761904763
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.009
NEC for r=0.3 class 1.0 = 0.417 +- 0.414 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.417 +- 0.414 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.417 +- 0.365 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.818
NEC for r=0.6 class 1.0 = 0.064 +- 0.238 (in-sample avg dev_std = 0.103)
NEC for r=0.6 all KL = 0.077 +- 0.238 (in-sample avg dev_std = 0.103)
NEC for r=0.6 all L1 = 0.064 +- 0.195 (in-sample avg dev_std = 0.103)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.831
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.818
NEC for r=0.5 class 1.0 = 0.064 +- 0.238 (in-sample avg dev_std = 0.103)
NEC for r=0.5 all KL = 0.077 +- 0.238 (in-sample avg dev_std = 0.103)
NEC for r=0.5 all L1 = 0.064 +- 0.195 (in-sample avg dev_std = 0.103)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.823
NEC for r=0.4 class 1.0 = 0.075 +- 0.262 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.091 +- 0.262 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.075 +- 0.216 (in-sample avg dev_std = 0.144)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10701701782820097
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.751
NEC for r=0.3 class 1.0 = 0.098 +- 0.331 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all KL = 0.146 +- 0.331 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all L1 = 0.098 +- 0.236 (in-sample avg dev_std = 0.255)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:46:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:46:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.096
SUFF_SIMPLE for r=0.6 class 1.0 = 0.181 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.6 all KL = 0.023 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.6 all L1 = 0.181 +- 0.075 (in-sample avg dev_std = 0.498)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.096
SUFF_SIMPLE for r=0.5 class 1.0 = 0.181 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.5 all KL = 0.023 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.5 all L1 = 0.181 +- 0.075 (in-sample avg dev_std = 0.498)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.096
SUFF_SIMPLE for r=0.4 class 1.0 = 0.181 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 all KL = 0.023 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 all L1 = 0.181 +- 0.075 (in-sample avg dev_std = 0.498)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.3 =  0.096
SUFF_SIMPLE for r=0.3 class 1.0 = 0.181 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.3 all KL = 0.023 +- 0.080 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.3 all L1 = 0.181 +- 0.075 (in-sample avg dev_std = 0.498)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.020)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.5 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.020)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.020)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.3 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.3 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.020)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF_SIMPLE for r=0.6 class 1.0 = 0.9 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.6 all KL = 0.869 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.6 all L1 = 0.9 +- 0.252 (in-sample avg dev_std = 0.229)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.817
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.724
SUFF_SIMPLE for r=0.5 class 1.0 = 0.9 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.5 all KL = 0.869 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.5 all L1 = 0.9 +- 0.252 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.817
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.724
SUFF_SIMPLE for r=0.4 class 1.0 = 0.9 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all KL = 0.869 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.252 (in-sample avg dev_std = 0.229)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.3 =  0.724
SUFF_SIMPLE for r=0.3 class 1.0 = 0.9 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.3 all KL = 0.869 +- 0.326 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.3 all L1 = 0.9 +- 0.252 (in-sample avg dev_std = 0.229)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.688
NEC for r=0.6 class 1.0 = 0.292 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.6 all KL = 0.373 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.6 all L1 = 0.292 +- 0.360 (in-sample avg dev_std = 0.197)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.688
NEC for r=0.5 class 1.0 = 0.292 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.5 all KL = 0.373 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.5 all L1 = 0.292 +- 0.360 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.688
NEC for r=0.4 class 1.0 = 0.292 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.4 all KL = 0.373 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.4 all L1 = 0.292 +- 0.360 (in-sample avg dev_std = 0.197)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.3 =  0.688
NEC for r=0.3 class 1.0 = 0.292 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all KL = 0.373 +- 0.424 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all L1 = 0.292 +- 0.360 (in-sample avg dev_std = 0.197)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.105
NEC for r=0.6 class 1.0 = 0.767 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.6 all KL = 0.899 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.6 all L1 = 0.767 +- 0.247 (in-sample avg dev_std = 0.135)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.105
NEC for r=0.5 class 1.0 = 0.767 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.5 all KL = 0.899 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.5 all L1 = 0.767 +- 0.247 (in-sample avg dev_std = 0.135)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.105
NEC for r=0.4 class 1.0 = 0.767 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all KL = 0.899 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all L1 = 0.767 +- 0.247 (in-sample avg dev_std = 0.135)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 1.0 = 0.767 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all KL = 0.899 +- 0.278 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all L1 = 0.767 +- 0.247 (in-sample avg dev_std = 0.135)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.802
NEC for r=0.6 class 1.0 = 0.062 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all KL = 0.076 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all L1 = 0.062 +- 0.205 (in-sample avg dev_std = 0.105)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.814
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.802
NEC for r=0.5 class 1.0 = 0.062 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.5 all KL = 0.076 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.5 all L1 = 0.062 +- 0.205 (in-sample avg dev_std = 0.105)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.814
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.802
NEC for r=0.4 class 1.0 = 0.062 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.4 all KL = 0.076 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.4 all L1 = 0.062 +- 0.205 (in-sample avg dev_std = 0.105)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.3 =  0.802
NEC for r=0.3 class 1.0 = 0.062 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.3 all KL = 0.076 +- 0.250 (in-sample avg dev_std = 0.105)
NEC for r=0.3 all L1 = 0.062 +- 0.205 (in-sample avg dev_std = 0.105)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:50:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:50:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.124
SUFF_SIMPLE for r=0.6 class 1.0 = 0.192 +- 0.035 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.6 all KL = 0.01 +- 0.035 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.6 all L1 = 0.192 +- 0.085 (in-sample avg dev_std = 0.541)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.124
SUFF_SIMPLE for r=0.5 class 1.0 = 0.192 +- 0.035 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.5 all KL = 0.01 +- 0.035 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.5 all L1 = 0.192 +- 0.085 (in-sample avg dev_std = 0.541)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.124
SUFF_SIMPLE for r=0.4 class 1.0 = 0.192 +- 0.035 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.4 all KL = 0.01 +- 0.035 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.4 all L1 = 0.192 +- 0.085 (in-sample avg dev_std = 0.541)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.011)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.5 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.011)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.011)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF_SIMPLE for r=0.6 class 1.0 = 0.87 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.6 all KL = 0.83 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.6 all L1 = 0.87 +- 0.287 (in-sample avg dev_std = 0.253)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.855
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.724
SUFF_SIMPLE for r=0.5 class 1.0 = 0.87 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.5 all KL = 0.83 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.5 all L1 = 0.87 +- 0.287 (in-sample avg dev_std = 0.253)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.855
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.724
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.4 all L1 = 0.87 +- 0.287 (in-sample avg dev_std = 0.253)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.791
NEC for r=0.6 class 1.0 = 0.235 +- 0.398 (in-sample avg dev_std = 0.215)
NEC for r=0.6 all KL = 0.325 +- 0.398 (in-sample avg dev_std = 0.215)
NEC for r=0.6 all L1 = 0.235 +- 0.313 (in-sample avg dev_std = 0.215)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.791
NEC for r=0.5 class 1.0 = 0.235 +- 0.398 (in-sample avg dev_std = 0.215)
NEC for r=0.5 all KL = 0.325 +- 0.398 (in-sample avg dev_std = 0.215)
NEC for r=0.5 all L1 = 0.235 +- 0.313 (in-sample avg dev_std = 0.215)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.4 =  0.791
NEC for r=0.4 class 1.0 = 0.235 +- 0.398 (in-sample avg dev_std = 0.215)
NEC for r=0.4 all KL = 0.325 +- 0.398 (in-sample avg dev_std = 0.215)
NEC for r=0.4 all L1 = 0.235 +- 0.313 (in-sample avg dev_std = 0.215)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0951768953068592
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.723
NEC for r=0.3 class 1.0 = 0.343 +- 0.381 (in-sample avg dev_std = 0.524)
NEC for r=0.3 all KL = 0.609 +- 0.381 (in-sample avg dev_std = 0.524)
NEC for r=0.3 all L1 = 0.343 +- 0.285 (in-sample avg dev_std = 0.524)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.011
NEC for r=0.6 class 1.0 = 0.159 +- 0.311 (in-sample avg dev_std = 0.064)
NEC for r=0.6 all KL = 0.155 +- 0.311 (in-sample avg dev_std = 0.064)
NEC for r=0.6 all L1 = 0.159 +- 0.292 (in-sample avg dev_std = 0.064)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.011
NEC for r=0.5 class 1.0 = 0.159 +- 0.311 (in-sample avg dev_std = 0.064)
NEC for r=0.5 all KL = 0.155 +- 0.311 (in-sample avg dev_std = 0.064)
NEC for r=0.5 all L1 = 0.159 +- 0.292 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.4 =  0.011
NEC for r=0.4 class 1.0 = 0.159 +- 0.311 (in-sample avg dev_std = 0.064)
NEC for r=0.4 all KL = 0.155 +- 0.311 (in-sample avg dev_std = 0.064)
NEC for r=0.4 all L1 = 0.159 +- 0.292 (in-sample avg dev_std = 0.064)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012976587301587305
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.006
NEC for r=0.3 class 1.0 = 0.162 +- 0.314 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.159 +- 0.314 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.162 +- 0.294 (in-sample avg dev_std = 0.114)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.826
NEC for r=0.6 class 1.0 = 0.06 +- 0.240 (in-sample avg dev_std = 0.107)
NEC for r=0.6 all KL = 0.074 +- 0.240 (in-sample avg dev_std = 0.107)
NEC for r=0.6 all L1 = 0.06 +- 0.199 (in-sample avg dev_std = 0.107)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.851
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.826
NEC for r=0.5 class 1.0 = 0.06 +- 0.240 (in-sample avg dev_std = 0.107)
NEC for r=0.5 all KL = 0.074 +- 0.240 (in-sample avg dev_std = 0.107)
NEC for r=0.5 all L1 = 0.06 +- 0.199 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.851
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.826
NEC for r=0.4 class 1.0 = 0.06 +- 0.240 (in-sample avg dev_std = 0.107)
NEC for r=0.4 all KL = 0.074 +- 0.240 (in-sample avg dev_std = 0.107)
NEC for r=0.4 all L1 = 0.06 +- 0.199 (in-sample avg dev_std = 0.107)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.851
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10844165316045382
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.756
NEC for r=0.3 class 1.0 = 0.109 +- 0.357 (in-sample avg dev_std = 0.270)
NEC for r=0.3 all KL = 0.167 +- 0.357 (in-sample avg dev_std = 0.270)
NEC for r=0.3 all L1 = 0.109 +- 0.255 (in-sample avg dev_std = 0.270)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:54:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:54:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.145
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.145
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.105
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.101
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.155
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.155
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.119
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.115


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.241
SUFF_SIMPLE for r=0.6 class 1.0 = 0.277 +- 0.170 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.6 all KL = 0.057 +- 0.170 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.6 all L1 = 0.277 +- 0.218 (in-sample avg dev_std = 0.502)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.241
SUFF_SIMPLE for r=0.5 class 1.0 = 0.277 +- 0.170 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.5 all KL = 0.057 +- 0.170 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.5 all L1 = 0.277 +- 0.218 (in-sample avg dev_std = 0.502)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1054187725631769
len(reference) = 98
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.4 =  0.867
SUFF_SIMPLE for r=0.4 class 1.0 = 0.859 +- 0.341 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.4 all KL = 0.815 +- 0.341 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.4 all L1 = 0.859 +- 0.279 (in-sample avg dev_std = 0.027)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.004
SUFF_SIMPLE for r=0.6 class 1.0 = 0.874 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.877 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.874 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.004
SUFF_SIMPLE for r=0.5 class 1.0 = 0.874 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.877 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.874 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.152
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013048809523809525
len(reference) = 158
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.4 =  0.063
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.892 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF_SIMPLE for r=0.6 class 1.0 = 0.919 +- 0.282 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 all KL = 0.903 +- 0.282 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 all L1 = 0.919 +- 0.235 (in-sample avg dev_std = 0.103)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.838
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15451215559157214
len(reference) = 2457
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.5 =  0.814
SUFF_SIMPLE for r=0.5 class 1.0 = 0.919 +- 0.282 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.5 all KL = 0.903 +- 0.282 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.5 all L1 = 0.919 +- 0.235 (in-sample avg dev_std = 0.103)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.866
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11942625607779578
len(reference) = 1149
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.4 =  0.833
SUFF_SIMPLE for r=0.4 class 1.0 = 0.958 +- 0.192 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.949 +- 0.192 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.958 +- 0.156 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.6 =  0.633
NEC for r=0.6 class 1.0 = 0.426 +- 0.355 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all KL = 0.702 +- 0.355 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all L1 = 0.426 +- 0.299 (in-sample avg dev_std = 0.586)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1451552346570397
len(reference) = 277
Effective ratio: 0.821 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.633
NEC for r=0.5 class 1.0 = 0.426 +- 0.355 (in-sample avg dev_std = 0.586)
NEC for r=0.5 all KL = 0.702 +- 0.355 (in-sample avg dev_std = 0.586)
NEC for r=0.5 all L1 = 0.426 +- 0.299 (in-sample avg dev_std = 0.586)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1054187725631769
len(reference) = 277
Effective ratio: 0.984 +- 0.040
Model Accuracy over intervened graphs for r=0.4 =  0.654
NEC for r=0.4 class 1.0 = 0.398 +- 0.374 (in-sample avg dev_std = 0.568)
NEC for r=0.4 all KL = 0.665 +- 0.374 (in-sample avg dev_std = 0.568)
NEC for r=0.4 all L1 = 0.398 +- 0.299 (in-sample avg dev_std = 0.568)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10110108303249099
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 1.0 = 0.395 +- 0.371 (in-sample avg dev_std = 0.559)
NEC for r=0.3 all KL = 0.665 +- 0.371 (in-sample avg dev_std = 0.559)
NEC for r=0.3 all L1 = 0.395 +- 0.300 (in-sample avg dev_std = 0.559)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.6 =  0.004
NEC for r=0.6 class 1.0 = 0.125 +- 0.287 (in-sample avg dev_std = 0.110)
NEC for r=0.6 all KL = 0.127 +- 0.287 (in-sample avg dev_std = 0.110)
NEC for r=0.6 all L1 = 0.125 +- 0.266 (in-sample avg dev_std = 0.110)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013446428571428573
len(reference) = 2520
Effective ratio: 0.969 +- 0.020
Model Accuracy over intervened graphs for r=0.5 =  0.004
NEC for r=0.5 class 1.0 = 0.125 +- 0.287 (in-sample avg dev_std = 0.110)
NEC for r=0.5 all KL = 0.127 +- 0.287 (in-sample avg dev_std = 0.110)
NEC for r=0.5 all L1 = 0.125 +- 0.266 (in-sample avg dev_std = 0.110)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.113
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013048809523809525
len(reference) = 2520
Effective ratio: 1.000 +- 0.001
Model Accuracy over intervened graphs for r=0.4 =  0.004
NEC for r=0.4 class 1.0 = 0.124 +- 0.286 (in-sample avg dev_std = 0.102)
NEC for r=0.4 all KL = 0.124 +- 0.286 (in-sample avg dev_std = 0.102)
NEC for r=0.4 all L1 = 0.124 +- 0.266 (in-sample avg dev_std = 0.102)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0130484126984127
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.004
NEC for r=0.3 class 1.0 = 0.126 +- 0.287 (in-sample avg dev_std = 0.107)
NEC for r=0.3 all KL = 0.128 +- 0.287 (in-sample avg dev_std = 0.107)
NEC for r=0.3 all L1 = 0.126 +- 0.267 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.6 =  0.743
NEC for r=0.6 class 1.0 = 0.098 +- 0.335 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all KL = 0.142 +- 0.335 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all L1 = 0.098 +- 0.245 (in-sample avg dev_std = 0.254)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15451215559157214
len(reference) = 2468
Effective ratio: 0.831 +- 0.106
Model Accuracy over intervened graphs for r=0.5 =  0.743
NEC for r=0.5 class 1.0 = 0.098 +- 0.335 (in-sample avg dev_std = 0.254)
NEC for r=0.5 all KL = 0.142 +- 0.335 (in-sample avg dev_std = 0.254)
NEC for r=0.5 all L1 = 0.098 +- 0.245 (in-sample avg dev_std = 0.254)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11942625607779578
len(reference) = 2468
Effective ratio: 0.987 +- 0.036
Model Accuracy over intervened graphs for r=0.4 =  0.75
NEC for r=0.4 class 1.0 = 0.097 +- 0.342 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all KL = 0.15 +- 0.342 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all L1 = 0.097 +- 0.239 (in-sample avg dev_std = 0.262)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11474027552674232
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.751
NEC for r=0.3 class 1.0 = 0.1 +- 0.350 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all KL = 0.16 +- 0.350 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all L1 = 0.1 +- 0.240 (in-sample avg dev_std = 0.280)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 17:59:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 05:59:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.000
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.003
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.003
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.003
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.107


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.094
SUFF_SIMPLE for r=0.6 class 1.0 = 0.18 +- 0.071 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.6 all KL = 0.019 +- 0.071 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.6 all L1 = 0.18 +- 0.065 (in-sample avg dev_std = 0.504)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.094
SUFF_SIMPLE for r=0.5 class 1.0 = 0.18 +- 0.071 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.5 all KL = 0.019 +- 0.071 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.5 all L1 = 0.18 +- 0.065 (in-sample avg dev_std = 0.504)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.086
SUFF_SIMPLE for r=0.4 class 1.0 = 0.176 +- 0.073 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all KL = 0.02 +- 0.073 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all L1 = 0.176 +- 0.061 (in-sample avg dev_std = 0.474)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF_SIMPLE for r=0.6 class 1.0 = 0.893 +- 0.334 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all KL = 0.861 +- 0.334 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all L1 = 0.893 +- 0.258 (in-sample avg dev_std = 0.247)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.82
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.722
SUFF_SIMPLE for r=0.5 class 1.0 = 0.893 +- 0.334 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.5 all KL = 0.861 +- 0.334 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.5 all L1 = 0.893 +- 0.258 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.82
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2457
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.715
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.338 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all KL = 0.858 +- 0.338 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.265 (in-sample avg dev_std = 0.237)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.723
NEC for r=0.6 class 1.0 = 0.289 +- 0.411 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all KL = 0.387 +- 0.411 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all L1 = 0.289 +- 0.340 (in-sample avg dev_std = 0.228)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 277
Effective ratio: 0.094 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.723
NEC for r=0.5 class 1.0 = 0.289 +- 0.411 (in-sample avg dev_std = 0.228)
NEC for r=0.5 all KL = 0.387 +- 0.411 (in-sample avg dev_std = 0.228)
NEC for r=0.5 all L1 = 0.289 +- 0.340 (in-sample avg dev_std = 0.228)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 277
Effective ratio: 0.179 +- 0.137
Model Accuracy over intervened graphs for r=0.4 =  0.729
NEC for r=0.4 class 1.0 = 0.289 +- 0.398 (in-sample avg dev_std = 0.241)
NEC for r=0.4 all KL = 0.402 +- 0.398 (in-sample avg dev_std = 0.241)
NEC for r=0.4 all L1 = 0.289 +- 0.332 (in-sample avg dev_std = 0.241)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0936750902527076
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 1.0 = 0.397 +- 0.350 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all KL = 0.662 +- 0.350 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all L1 = 0.397 +- 0.283 (in-sample avg dev_std = 0.564)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.007
NEC for r=0.6 class 1.0 = 0.106 +- 0.271 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all KL = 0.105 +- 0.271 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all L1 = 0.106 +- 0.253 (in-sample avg dev_std = 0.034)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0
len(reference) = 2520
Effective ratio: 0.027 +- 0.019
Model Accuracy over intervened graphs for r=0.5 =  0.007
NEC for r=0.5 class 1.0 = 0.106 +- 0.271 (in-sample avg dev_std = 0.034)
NEC for r=0.5 all KL = 0.105 +- 0.271 (in-sample avg dev_std = 0.034)
NEC for r=0.5 all L1 = 0.106 +- 0.253 (in-sample avg dev_std = 0.034)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 2520
Effective ratio: 0.031 +- 0.020
Model Accuracy over intervened graphs for r=0.4 =  0.002
NEC for r=0.4 class 1.0 = 0.11 +- 0.279 (in-sample avg dev_std = 0.037)
NEC for r=0.4 all KL = 0.109 +- 0.279 (in-sample avg dev_std = 0.037)
NEC for r=0.4 all L1 = 0.11 +- 0.260 (in-sample avg dev_std = 0.037)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.012958730158730157
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.002
NEC for r=0.3 class 1.0 = 0.11 +- 0.278 (in-sample avg dev_std = 0.073)
NEC for r=0.3 all KL = 0.11 +- 0.278 (in-sample avg dev_std = 0.073)
NEC for r=0.3 all L1 = 0.11 +- 0.259 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.6 =  0.803
NEC for r=0.6 class 1.0 = 0.067 +- 0.253 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all KL = 0.079 +- 0.253 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all L1 = 0.067 +- 0.212 (in-sample avg dev_std = 0.105)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.816
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.095 +- 0.111
Model Accuracy over intervened graphs for r=0.5 =  0.803
NEC for r=0.5 class 1.0 = 0.067 +- 0.253 (in-sample avg dev_std = 0.105)
NEC for r=0.5 all KL = 0.079 +- 0.253 (in-sample avg dev_std = 0.105)
NEC for r=0.5 all L1 = 0.067 +- 0.212 (in-sample avg dev_std = 0.105)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.003121150729335494
len(reference) = 2468
Effective ratio: 0.174 +- 0.119
Model Accuracy over intervened graphs for r=0.4 =  0.819
NEC for r=0.4 class 1.0 = 0.076 +- 0.273 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.092 +- 0.273 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.076 +- 0.226 (in-sample avg dev_std = 0.151)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.10676337115072931
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.75
NEC for r=0.3 class 1.0 = 0.086 +- 0.321 (in-sample avg dev_std = 0.250)
NEC for r=0.3 all KL = 0.132 +- 0.321 (in-sample avg dev_std = 0.250)
NEC for r=0.3 all L1 = 0.086 +- 0.222 (in-sample avg dev_std = 0.250)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 1.0, 1.0], 'all_L1': [0.184, 0.17, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.847, 1.0, 1.0], 'all_L1': [0.338, 0.892, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.024, 1.0], 'all_L1': [0.177, 0.177, 0.169, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.028, 0.028, 1.0], 'all_L1': [0.178, 0.178, 0.175, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.026, 0.026, 1.0], 'all_L1': [0.175, 0.175, 0.171, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.02, 0.021, 1.0], 'all_L1': [0.198, 0.198, 0.191, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.023, 0.023, 0.023], 'all_L1': [0.181, 0.181, 0.181, 0.181]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.01, 0.01, 1.0], 'all_L1': [0.192, 0.192, 0.192, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.057, 0.815, 1.0], 'all_L1': [0.277, 0.277, 0.859, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.019, 0.019, 0.02, 1.0], 'all_L1': [0.18, 0.18, 0.176, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.391, 0.428, 0.665, 0.665], 'all_L1': [0.294, 0.305, 0.414, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.615, 0.584, 0.565, 0.565], 'all_L1': [0.342, 0.308, 0.297, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.439, 0.452, 0.649], 'all_L1': [0.338, 0.338, 0.336, 0.424]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.429, 0.457, 0.67], 'all_L1': [0.336, 0.336, 0.34, 0.432]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.405, 0.45, 0.687], 'all_L1': [0.31, 0.31, 0.328, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.308, 0.308, 0.316, 0.512], 'all_L1': [0.251, 0.251, 0.25, 0.338]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.373, 0.373, 0.373], 'all_L1': [0.292, 0.292, 0.292, 0.292]}), defaultdict(<class 'list'>, {'all_KL': [0.325, 0.325, 0.325, 0.609], 'all_L1': [0.235, 0.235, 0.235, 0.343]}), defaultdict(<class 'list'>, {'all_KL': [0.702, 0.702, 0.665, 0.665], 'all_L1': [0.426, 0.426, 0.398, 0.395]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.387, 0.402, 0.662], 'all_L1': [0.289, 0.289, 0.289, 0.397]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.284, 0.284, 1.0, 1.0], 'all_L1': [0.349, 0.349, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.726, 1.0, 1.0], 'all_L1': [0.557, 0.724, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.328, 0.328, 1.0], 'all_L1': [0.371, 0.371, 0.371, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.743, 0.743, 1.0], 'all_L1': [0.739, 0.739, 0.739, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.464, 0.464, 1.0], 'all_L1': [0.493, 0.493, 0.493, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.585, 1.0], 'all_L1': [0.583, 0.583, 0.583, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.027, 0.027, 0.027], 'all_L1': [0.151, 0.151, 0.151, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 0.845, 1.0], 'all_L1': [0.839, 0.839, 0.839, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.877, 0.904, 1.0], 'all_L1': [0.874, 0.874, 0.892, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.892, 0.892, 1.0], 'all_L1': [0.89, 0.89, 0.89, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.659, 0.695, 0.716, 0.716], 'all_L1': [0.591, 0.623, 0.645, 0.645]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.468, 0.468, 0.468], 'all_L1': [0.443, 0.442, 0.442, 0.442]}), defaultdict(<class 'list'>, {'all_KL': [0.642, 0.642, 0.67, 0.671], 'all_L1': [0.601, 0.601, 0.624, 0.627]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.252, 0.259, 0.258], 'all_L1': [0.255, 0.255, 0.262, 0.26]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.512, 0.539, 0.546], 'all_L1': [0.486, 0.486, 0.509, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.396, 0.417, 0.417], 'all_L1': [0.401, 0.401, 0.418, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.899, 0.899, 0.899], 'all_L1': [0.767, 0.767, 0.767, 0.767]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.155, 0.155, 0.159], 'all_L1': [0.159, 0.159, 0.159, 0.162]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.127, 0.124, 0.128], 'all_L1': [0.125, 0.125, 0.124, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.105, 0.105, 0.109, 0.11], 'all_L1': [0.106, 0.106, 0.11, 0.11]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.842, 0.844, 1.0, 1.0], 'all_L1': [0.882, 0.88, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.895, 0.955, 1.0, 1.0], 'all_L1': [0.916, 0.958, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.865, 0.865, 0.865, 1.0], 'all_L1': [0.898, 0.898, 0.895, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.856, 0.856, 1.0], 'all_L1': [0.889, 0.889, 0.886, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.855, 0.855, 0.856, 1.0], 'all_L1': [0.891, 0.891, 0.889, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.848, 0.848, 0.844, 1.0], 'all_L1': [0.882, 0.882, 0.878, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.869, 0.869, 0.869, 0.869], 'all_L1': [0.9, 0.9, 0.9, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.83, 0.83, 1.0], 'all_L1': [0.87, 0.87, 0.87, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.903, 0.903, 0.949, 1.0], 'all_L1': [0.919, 0.919, 0.958, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.861, 0.861, 0.858, 1.0], 'all_L1': [0.893, 0.893, 0.889, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.071, 0.09, 0.158, 0.158], 'all_L1': [0.056, 0.07, 0.098, 0.098]}), defaultdict(<class 'list'>, {'all_KL': [0.157, 0.163, 0.163, 0.163], 'all_L1': [0.106, 0.106, 0.106, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.083, 0.096, 0.131], 'all_L1': [0.068, 0.068, 0.076, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.08, 0.08, 0.092, 0.138], 'all_L1': [0.067, 0.067, 0.074, 0.091]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.069, 0.084, 0.153], 'all_L1': [0.054, 0.054, 0.066, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.077, 0.091, 0.146], 'all_L1': [0.064, 0.064, 0.075, 0.098]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.076, 0.076, 0.076], 'all_L1': [0.062, 0.062, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.074, 0.074, 0.167], 'all_L1': [0.06, 0.06, 0.06, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.142, 0.15, 0.16], 'all_L1': [0.098, 0.098, 0.097, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.092, 0.132], 'all_L1': [0.067, 0.067, 0.076, 0.086]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.208 +- 0.052, 0.262 +- 0.212, 0.411 +- 0.356, 0.918 +- 0.246
suff_simple class all_KL  =  0.032 +- 0.022, 0.107 +- 0.247, 0.297 +- 0.423, 0.902 +- 0.293
[[0.10424187779426575, 0.072202168405056, -1.0, -1.0], [0.3231046795845032, 0.8979591727256775, -1.0, -1.0], [0.0834837555885315, 0.0834837555885315, 0.06588447839021683, -1.0], [0.08799639344215393, 0.08799639344215393, 0.0834837555885315, -1.0], [0.08258122950792313, 0.08258122950792313, 0.07129964232444763, -1.0], [0.13176895678043365, 0.13176895678043365, 0.11552346497774124, -1.0], [0.09611913561820984, 0.09611913561820984, 0.09611913561820984, 0.09611913561820984], [0.12364620715379715, 0.12364620715379715, 0.12364620715379715, -1.0], [0.24052347242832184, 0.24052347242832184, 0.8673469424247742, -1.0], [0.09386281669139862, 0.09386281669139862, 0.0861913338303566, -1.0]]
[[0.021, 0.021, 1.0, 1.0], [0.087, 0.847, 1.0, 1.0], [0.024, 0.024, 0.024, 1.0], [0.028, 0.028, 0.028, 1.0], [0.026, 0.026, 0.026, 1.0], [0.02, 0.02, 0.021, 1.0], [0.023, 0.023, 0.023, 0.023], [0.01, 0.01, 0.01, 1.0], [0.057, 0.057, 0.815, 1.0], [0.019, 0.019, 0.02, 1.0]]
suff_simple_acc_int  =  0.137 +- 0.076, 0.191 +- 0.240, -0.049 +- 0.528, -0.890 +- 0.329
nec class all_L1  =  0.311 +- 0.051, 0.309 +- 0.050, 0.318 +- 0.055, 0.377 +- 0.052
nec class all_KL  =  0.437 +- 0.119, 0.438 +- 0.113, 0.467 +- 0.120, 0.606 +- 0.093
[[0.7030686140060425, 0.7084837555885315, 0.6254512667655945, 0.6254512667655945], [0.7319494485855103, 0.7689530849456787, 0.7770758271217346, 0.7770758271217346], [0.6719313859939575, 0.6719313859939575, 0.6890794038772583, 0.6268050670623779], [0.6638086438179016, 0.6638086438179016, 0.6651624441146851, 0.6037906408309937], [0.6764440536499023, 0.6764440536499023, 0.6768953204154968, 0.6015343070030212], [0.7892599105834961, 0.7892599105834961, 0.8005415201187134, 0.7387183904647827], [0.6877256035804749, 0.6877256035804749, 0.6877256035804749, 0.6877256035804749], [0.7906137108802795, 0.7906137108802795, 0.7906137108802795, 0.7229241728782654], [0.6331227421760559, 0.6331227421760559, 0.6538808941841125, 0.6588447690010071], [0.7233754396438599, 0.7233754396438599, 0.7292418479919434, 0.6588447690010071]]
[[0.391, 0.428, 0.665, 0.665], [0.615, 0.584, 0.565, 0.565], [0.439, 0.439, 0.452, 0.649], [0.429, 0.429, 0.457, 0.67], [0.405, 0.405, 0.45, 0.687], [0.308, 0.308, 0.316, 0.512], [0.373, 0.373, 0.373, 0.373], [0.325, 0.325, 0.325, 0.609], [0.702, 0.702, 0.665, 0.665], [0.387, 0.387, 0.402, 0.662]]
nec_acc_int  =  0.707 +- 0.050, 0.711 +- 0.052, 0.710 +- 0.058, 0.670 +- 0.057

Eval split val
suff_simple class all_L1  =  0.585 +- 0.237, 0.601 +- 0.241, 0.696 +- 0.272, 0.915 +- 0.255
suff_simple class all_KL  =  0.558 +- 0.274, 0.577 +- 0.278, 0.679 +- 0.306, 0.903 +- 0.292
[[9.920635056914762e-05, 0.00019841270113829523, -1.0, -1.0], [0.0075396825559437275, 0.33544304966926575, -1.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [4.960317528457381e-05, 4.960317528457381e-05, 0.0, -1.0], [9.920635056914762e-05, 9.920635056914762e-05, 9.920635056914762e-05, 9.920635056914762e-05], [4.960317528457381e-05, 4.960317528457381e-05, 4.960317528457381e-05, -1.0], [0.004365079570561647, 0.004365079570561647, 0.06329113990068436, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.284, 0.284, 1.0, 1.0], [0.533, 0.726, 1.0, 1.0], [0.328, 0.328, 0.328, 1.0], [0.743, 0.743, 0.743, 1.0], [0.464, 0.464, 0.464, 1.0], [0.585, 0.585, 0.585, 1.0], [0.027, 0.027, 0.027, 0.027], [0.845, 0.845, 0.845, 1.0], [0.877, 0.877, 0.904, 1.0], [0.892, 0.892, 0.892, 1.0]]
suff_simple_acc_int  =  0.001 +- 0.002, 0.034 +- 0.100, -0.194 +- 0.404, -0.900 +- 0.300
nec class all_L1  =  0.393 +- 0.215, 0.396 +- 0.218, 0.406 +- 0.223, 0.407 +- 0.223
nec class all_KL  =  0.422 +- 0.251, 0.425 +- 0.255, 0.436 +- 0.260, 0.437 +- 0.259
[[0.0833333358168602, 0.04305555671453476, 0.01850198395550251, 0.01850198395550251], [0.01294642873108387, 0.010119047947227955, 0.01086309552192688, 0.01086309552192688], [0.042658731341362, 0.042658731341362, 0.01215277798473835, 0.007837302051484585], [0.015376984141767025, 0.015376984141767025, 0.004861111287027597, 0.0037698412779718637], [0.0396825410425663, 0.0396825410425663, 0.01056547649204731, 0.01493055559694767], [0.02876984141767025, 0.02876984141767025, 0.0067956349812448025, 0.00897817499935627], [0.10451389104127884, 0.10451389104127884, 0.10451389104127884, 0.10451389104127884], [0.01076388917863369, 0.01076388917863369, 0.01076388917863369, 0.0056051588617265224], [0.004365079570561647, 0.004365079570561647, 0.003918651025742292, 0.004265873227268457], [0.0071428571827709675, 0.0071428571827709675, 0.0016865079523995519, 0.0020833334419876337]]
[[0.659, 0.695, 0.716, 0.716], [0.47, 0.468, 0.468, 0.468], [0.642, 0.642, 0.67, 0.671], [0.252, 0.252, 0.259, 0.258], [0.512, 0.512, 0.539, 0.546], [0.396, 0.396, 0.417, 0.417], [0.899, 0.899, 0.899, 0.899], [0.155, 0.155, 0.155, 0.159], [0.127, 0.127, 0.124, 0.128], [0.105, 0.105, 0.109, 0.11]]
nec_acc_int  =  0.035 +- 0.032, 0.031 +- 0.029, 0.018 +- 0.029, 0.018 +- 0.029

Eval split test
suff_simple class all_L1  =  0.894 +- 0.014, 0.898 +- 0.024, 0.916 +- 0.047, 0.990 +- 0.030
suff_simple class all_KL  =  0.862 +- 0.021, 0.869 +- 0.034, 0.893 +- 0.061, 0.987 +- 0.039
[[0.7171856164932251, 0.7124541997909546, -1.0, -1.0], [0.8180708289146423, 0.845082700252533, -1.0, -1.0], [0.721764326095581, 0.721764326095581, 0.716625988483429, -1.0], [0.7218152284622192, 0.7218152284622192, 0.7162189483642578, -1.0], [0.7209503650665283, 0.7209503650665283, 0.716625988483429, -1.0], [0.7189153432846069, 0.7189153432846069, 0.7152014374732971, -1.0], [0.7237993478775024, 0.7237993478775024, 0.7237993478775024, 0.7237993478775024], [0.7239519953727722, 0.7239519953727722, 0.7239519953727722, -1.0], [0.813746452331543, 0.813746452331543, 0.8328981995582581, -1.0], [0.7217134833335876, 0.7217134833335876, 0.7145909667015076, -1.0]]
[[0.842, 0.844, 1.0, 1.0], [0.895, 0.955, 1.0, 1.0], [0.865, 0.865, 0.865, 1.0], [0.856, 0.856, 0.856, 1.0], [0.855, 0.855, 0.856, 1.0], [0.848, 0.848, 0.844, 1.0], [0.869, 0.869, 0.869, 0.869], [0.83, 0.83, 0.83, 1.0], [0.903, 0.903, 0.949, 1.0], [0.861, 0.861, 0.858, 1.0]]
suff_simple_acc_int  =  0.740 +- 0.038, 0.742 +- 0.044, 0.386 +- 0.694, -0.828 +- 0.517
nec class all_L1  =  0.070 +- 0.017, 0.072 +- 0.016, 0.079 +- 0.015, 0.093 +- 0.013
nec class all_KL  =  0.091 +- 0.030, 0.093 +- 0.030, 0.108 +- 0.033, 0.142 +- 0.025
[[0.8160454034805298, 0.8213127851486206, 0.7506077885627747, 0.7506077885627747], [0.7482272982597351, 0.7526843547821045, 0.7554193735122681, 0.7554193735122681], [0.8036365509033203, 0.8036365509033203, 0.8219712376594543, 0.7517727017402649], [0.804295003414154, 0.804295003414154, 0.820046603679657, 0.752836287021637], [0.8157414793968201, 0.8157414793968201, 0.8229842185974121, 0.750354528427124], [0.8183245658874512, 0.8183245658874512, 0.8225283622741699, 0.7512155771255493], [0.8021677732467651, 0.8021677732467651, 0.8021677732467651, 0.8021677732467651], [0.8262763619422913, 0.8262763619422913, 0.8262763619422913, 0.7555206418037415], [0.7426053285598755, 0.7426053285598755, 0.7501012682914734, 0.7509116530418396], [0.8030794262886047, 0.8030794262886047, 0.8188816905021667, 0.7502532601356506]]
[[0.071, 0.09, 0.158, 0.158], [0.157, 0.163, 0.163, 0.163], [0.083, 0.083, 0.096, 0.131], [0.08, 0.08, 0.092, 0.138], [0.069, 0.069, 0.084, 0.153], [0.077, 0.077, 0.091, 0.146], [0.076, 0.076, 0.076, 0.076], [0.074, 0.074, 0.074, 0.167], [0.142, 0.142, 0.15, 0.16], [0.079, 0.079, 0.092, 0.132]]
nec_acc_int  =  0.798 +- 0.027, 0.799 +- 0.027, 0.799 +- 0.031, 0.757 +- 0.015


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.260 +- 0.045, 0.285 +- 0.111, 0.365 +- 0.196, 0.648 +- 0.139
Faith. Armon (L1)= 		  =  0.247 +- 0.046, 0.258 +- 0.075, 0.314 +- 0.144, 0.523 +- 0.110
Faith. GMean (L1)= 	  =  0.253 +- 0.045, 0.271 +- 0.091, 0.338 +- 0.167, 0.581 +- 0.123
Faith. Aritm (KL)= 		  =  0.234 +- 0.069, 0.273 +- 0.158, 0.382 +- 0.266, 0.754 +- 0.187
Faith. Armon (KL)= 		  =  0.058 +- 0.038, 0.112 +- 0.194, 0.254 +- 0.326, 0.700 +- 0.223
Faith. GMean (KL)= 	  =  0.115 +- 0.053, 0.163 +- 0.184, 0.295 +- 0.310, 0.724 +- 0.213

Eval split val
Faith. Aritm (L1)= 		  =  0.489 +- 0.013, 0.499 +- 0.030, 0.551 +- 0.113, 0.661 +- 0.115
Faith. Armon (L1)= 		  =  0.366 +- 0.115, 0.373 +- 0.123, 0.417 +- 0.181, 0.480 +- 0.221
Faith. GMean (L1)= 	  =  0.417 +- 0.070, 0.425 +- 0.081, 0.473 +- 0.149, 0.556 +- 0.180
Faith. Aritm (KL)= 		  =  0.490 +- 0.013, 0.501 +- 0.034, 0.557 +- 0.123, 0.670 +- 0.125
Faith. Armon (KL)= 		  =  0.339 +- 0.143, 0.347 +- 0.152, 0.401 +- 0.219, 0.473 +- 0.263
Faith. GMean (KL)= 	  =  0.395 +- 0.102, 0.404 +- 0.113, 0.460 +- 0.185, 0.549 +- 0.221

Eval split test
Faith. Aritm (L1)= 		  =  0.482 +- 0.015, 0.485 +- 0.019, 0.498 +- 0.031, 0.541 +- 0.020
Faith. Armon (L1)= 		  =  0.130 +- 0.028, 0.132 +- 0.027, 0.145 +- 0.026, 0.169 +- 0.022
Faith. GMean (L1)= 	  =  0.249 +- 0.030, 0.252 +- 0.030, 0.268 +- 0.032, 0.302 +- 0.025
Faith. Aritm (KL)= 		  =  0.477 +- 0.025, 0.481 +- 0.032, 0.500 +- 0.047, 0.565 +- 0.031
Faith. Armon (KL)= 		  =  0.163 +- 0.047, 0.167 +- 0.049, 0.191 +- 0.054, 0.248 +- 0.041
Faith. GMean (KL)= 	  =  0.277 +- 0.045, 0.282 +- 0.049, 0.308 +- 0.057, 0.374 +- 0.042
Computed for split load_split = id



Completed in  0:40:21.668080  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:03:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:03:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.085
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.045
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.112
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03961371841155234
len(reference) = 277
Effective ratio: 0.076 +- 0.081
Model Accuracy over intervened graphs for r=0.6 =  0.105
SUFF_SIMPLE for r=0.6 class 1.0 = 0.185 +- 0.079 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.6 all KL = 0.022 +- 0.079 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.6 all L1 = 0.185 +- 0.075 (in-sample avg dev_std = 0.520)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08488808664259928
len(reference) = 277
Effective ratio: 0.308 +- 0.200
Model Accuracy over intervened graphs for r=0.5 =  0.096
SUFF_SIMPLE for r=0.5 class 1.0 = 0.182 +- 0.078 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.078 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.5 all L1 = 0.182 +- 0.067 (in-sample avg dev_std = 0.521)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.026)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.010654761904761905
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.349 +- 0.404 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.5 all KL = 0.284 +- 0.404 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.5 all L1 = 0.349 +- 0.336 (in-sample avg dev_std = 0.027)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04489303079416532
len(reference) = 2457
Effective ratio: 0.067 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF_SIMPLE for r=0.6 class 1.0 = 0.885 +- 0.352 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.352 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all L1 = 0.885 +- 0.270 (in-sample avg dev_std = 0.249)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08630672609400324
len(reference) = 2457
Effective ratio: 0.305 +- 0.172
Model Accuracy over intervened graphs for r=0.5 =  0.726
SUFF_SIMPLE for r=0.5 class 1.0 = 0.885 +- 0.353 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.353 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.5 all L1 = 0.885 +- 0.271 (in-sample avg dev_std = 0.244)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03961371841155234
len(reference) = 277
Effective ratio: 0.076 +- 0.081
Model Accuracy over intervened graphs for r=0.6 =  0.623
NEC for r=0.6 class 1.0 = 0.386 +- 0.425 (in-sample avg dev_std = 0.348)
NEC for r=0.6 all KL = 0.529 +- 0.425 (in-sample avg dev_std = 0.348)
NEC for r=0.6 all L1 = 0.386 +- 0.353 (in-sample avg dev_std = 0.348)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08488808664259928
len(reference) = 277
Effective ratio: 0.308 +- 0.200
Model Accuracy over intervened graphs for r=0.5 =  0.63
NEC for r=0.5 class 1.0 = 0.413 +- 0.356 (in-sample avg dev_std = 0.535)
NEC for r=0.5 all KL = 0.673 +- 0.356 (in-sample avg dev_std = 0.535)
NEC for r=0.5 all L1 = 0.413 +- 0.297 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.098028880866426
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 1.0 = 0.414 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all KL = 0.665 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all L1 = 0.414 +- 0.301 (in-sample avg dev_std = 0.549)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.098028880866426
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 1.0 = 0.414 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all KL = 0.665 +- 0.370 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all L1 = 0.414 +- 0.301 (in-sample avg dev_std = 0.549)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.724
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.131
NEC for r=0.6 class 1.0 = 0.55 +- 0.431 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all KL = 0.614 +- 0.431 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all L1 = 0.55 +- 0.368 (in-sample avg dev_std = 0.137)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.724
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.010654761904761905
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.5 =  0.016
NEC for r=0.5 class 1.0 = 0.645 +- 0.403 (in-sample avg dev_std = 0.181)
NEC for r=0.5 all KL = 0.714 +- 0.403 (in-sample avg dev_std = 0.181)
NEC for r=0.5 all L1 = 0.645 +- 0.334 (in-sample avg dev_std = 0.181)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01302142857142857
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.019
NEC for r=0.4 class 1.0 = 0.645 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all KL = 0.716 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all L1 = 0.645 +- 0.332 (in-sample avg dev_std = 0.231)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.724
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.01302142857142857
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.019
NEC for r=0.3 class 1.0 = 0.645 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.716 +- 0.402 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.645 +- 0.332 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04489303079416532
len(reference) = 2468
Effective ratio: 0.067 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.779
NEC for r=0.6 class 1.0 = 0.064 +- 0.248 (in-sample avg dev_std = 0.072)
NEC for r=0.6 all KL = 0.074 +- 0.248 (in-sample avg dev_std = 0.072)
NEC for r=0.6 all L1 = 0.064 +- 0.214 (in-sample avg dev_std = 0.072)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08630672609400324
len(reference) = 2468
Effective ratio: 0.305 +- 0.172
Model Accuracy over intervened graphs for r=0.5 =  0.75
NEC for r=0.5 class 1.0 = 0.095 +- 0.334 (in-sample avg dev_std = 0.247)
NEC for r=0.5 all KL = 0.141 +- 0.334 (in-sample avg dev_std = 0.247)
NEC for r=0.5 all L1 = 0.095 +- 0.240 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11157050243111831
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.751
NEC for r=0.4 class 1.0 = 0.098 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all KL = 0.158 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all L1 = 0.098 +- 0.238 (in-sample avg dev_std = 0.273)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11157050243111831
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.751
NEC for r=0.3 class 1.0 = 0.098 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.158 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.098 +- 0.238 (in-sample avg dev_std = 0.273)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:07:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:07:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.074
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.096
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.088
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.111
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.112
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07409747292418772
len(reference) = 277
Effective ratio: 0.692 +- 0.205
Model Accuracy over intervened graphs for r=0.6 =  0.202
SUFF_SIMPLE for r=0.6 class 1.0 = 0.231 +- 0.024 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 all KL = 0.008 +- 0.024 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 all L1 = 0.231 +- 0.133 (in-sample avg dev_std = 0.577)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0964404332129964
len(reference) = 49
Effective ratio: 0.989 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.633
SUFF_SIMPLE for r=0.5 class 1.0 = 0.673 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.599 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.673 +- 0.402 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01303015873015873
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.559 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.537 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.559 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.75
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013011904761904761
len(reference) = 20
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.5 =  0.5
SUFF_SIMPLE for r=0.5 class 1.0 = 0.699 +- 0.335 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.661 +- 0.335 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.699 +- 0.307 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08844854132901134
len(reference) = 2457
Effective ratio: 0.701 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF_SIMPLE for r=0.6 class 1.0 = 0.876 +- 0.357 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.6 all KL = 0.842 +- 0.357 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.6 all L1 = 0.876 +- 0.284 (in-sample avg dev_std = 0.234)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1106908427876823
len(reference) = 455
Effective ratio: 0.992 +- 0.029
Model Accuracy over intervened graphs for r=0.5 =  0.725
SUFF_SIMPLE for r=0.5 class 1.0 = 0.885 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.876 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.885 +- 0.275 (in-sample avg dev_std = 0.000)


ratio=0.4



Too few intervened samples, skipping weight=0.4


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07409747292418772
len(reference) = 277
Effective ratio: 0.692 +- 0.205
Model Accuracy over intervened graphs for r=0.6 =  0.788
NEC for r=0.6 class 1.0 = 0.279 +- 0.405 (in-sample avg dev_std = 0.511)
NEC for r=0.6 all KL = 0.527 +- 0.405 (in-sample avg dev_std = 0.511)
NEC for r=0.6 all L1 = 0.279 +- 0.272 (in-sample avg dev_std = 0.511)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0964404332129964
len(reference) = 277
Effective ratio: 0.989 +- 0.036
Model Accuracy over intervened graphs for r=0.5 =  0.785
NEC for r=0.5 class 1.0 = 0.291 +- 0.396 (in-sample avg dev_std = 0.549)
NEC for r=0.5 all KL = 0.559 +- 0.396 (in-sample avg dev_std = 0.549)
NEC for r=0.5 all L1 = 0.291 +- 0.265 (in-sample avg dev_std = 0.549)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09767148014440433
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.777
NEC for r=0.4 class 1.0 = 0.297 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all KL = 0.565 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all L1 = 0.297 +- 0.271 (in-sample avg dev_std = 0.542)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09767148014440433
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.777
NEC for r=0.3 class 1.0 = 0.297 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.3 all KL = 0.565 +- 0.398 (in-sample avg dev_std = 0.542)
NEC for r=0.3 all L1 = 0.297 +- 0.271 (in-sample avg dev_std = 0.542)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.465
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01303015873015873
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.009
NEC for r=0.6 class 1.0 = 0.441 +- 0.443 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all KL = 0.467 +- 0.443 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all L1 = 0.441 +- 0.386 (in-sample avg dev_std = 0.160)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.465
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013011904761904761
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.5 =  0.01
NEC for r=0.5 class 1.0 = 0.442 +- 0.442 (in-sample avg dev_std = 0.176)
NEC for r=0.5 all KL = 0.469 +- 0.442 (in-sample avg dev_std = 0.176)
NEC for r=0.5 all L1 = 0.442 +- 0.385 (in-sample avg dev_std = 0.176)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.465
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.011
NEC for r=0.4 class 1.0 = 0.442 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all KL = 0.468 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all L1 = 0.442 +- 0.385 (in-sample avg dev_std = 0.177)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013012301587301586
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.011
NEC for r=0.3 class 1.0 = 0.442 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all KL = 0.468 +- 0.441 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all L1 = 0.442 +- 0.385 (in-sample avg dev_std = 0.177)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08844854132901134
len(reference) = 2468
Effective ratio: 0.701 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.756
NEC for r=0.6 class 1.0 = 0.105 +- 0.349 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all KL = 0.157 +- 0.349 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all L1 = 0.105 +- 0.252 (in-sample avg dev_std = 0.255)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.846
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1106908427876823
len(reference) = 2468
Effective ratio: 0.992 +- 0.029
Model Accuracy over intervened graphs for r=0.5 =  0.755
NEC for r=0.5 class 1.0 = 0.106 +- 0.354 (in-sample avg dev_std = 0.271)
NEC for r=0.5 all KL = 0.162 +- 0.354 (in-sample avg dev_std = 0.271)
NEC for r=0.5 all L1 = 0.106 +- 0.251 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.846
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11153525121555916
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.755
NEC for r=0.4 class 1.0 = 0.106 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all KL = 0.163 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all L1 = 0.106 +- 0.250 (in-sample avg dev_std = 0.273)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.846
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11153525121555916
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.755
NEC for r=0.3 class 1.0 = 0.106 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.163 +- 0.352 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.106 +- 0.250 (in-sample avg dev_std = 0.273)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:11:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:11:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.035
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.035
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.045
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.045
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.6 =  0.088
SUFF_SIMPLE for r=0.6 class 1.0 = 0.177 +- 0.073 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.073 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.6 all L1 = 0.177 +- 0.054 (in-sample avg dev_std = 0.507)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.5 =  0.088
SUFF_SIMPLE for r=0.5 class 1.0 = 0.177 +- 0.073 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.5 all KL = 0.024 +- 0.073 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.5 all L1 = 0.177 +- 0.054 (in-sample avg dev_std = 0.507)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08002527075812275
len(reference) = 276
Effective ratio: 0.309 +- 0.207
Model Accuracy over intervened graphs for r=0.4 =  0.089
SUFF_SIMPLE for r=0.4 class 1.0 = 0.185 +- 0.132 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 all KL = 0.037 +- 0.132 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 all L1 = 0.185 +- 0.110 (in-sample avg dev_std = 0.465)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.008)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.5 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.5 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.008)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010820634920634922
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.400 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all KL = 0.328 +- 0.400 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all L1 = 0.371 +- 0.330 (in-sample avg dev_std = 0.011)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04499635332252836
len(reference) = 2457
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF_SIMPLE for r=0.6 class 1.0 = 0.9 +- 0.329 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.6 all KL = 0.866 +- 0.329 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.6 all L1 = 0.9 +- 0.251 (in-sample avg dev_std = 0.235)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.818
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04499635332252836
len(reference) = 2457
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.5 =  0.724
SUFF_SIMPLE for r=0.5 class 1.0 = 0.9 +- 0.329 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.5 all KL = 0.866 +- 0.329 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.5 all L1 = 0.9 +- 0.251 (in-sample avg dev_std = 0.235)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08502552674230146
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.728
SUFF_SIMPLE for r=0.4 class 1.0 = 0.902 +- 0.323 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all KL = 0.872 +- 0.323 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.249 (in-sample avg dev_std = 0.223)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.6 =  0.621
NEC for r=0.6 class 1.0 = 0.389 +- 0.396 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all KL = 0.526 +- 0.396 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all L1 = 0.389 +- 0.329 (in-sample avg dev_std = 0.334)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.996
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03538267148014441
len(reference) = 277
Effective ratio: 0.072 +- 0.074
Model Accuracy over intervened graphs for r=0.5 =  0.621
NEC for r=0.5 class 1.0 = 0.389 +- 0.396 (in-sample avg dev_std = 0.334)
NEC for r=0.5 all KL = 0.526 +- 0.396 (in-sample avg dev_std = 0.334)
NEC for r=0.5 all L1 = 0.389 +- 0.329 (in-sample avg dev_std = 0.334)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08002527075812275
len(reference) = 277
Effective ratio: 0.309 +- 0.207
Model Accuracy over intervened graphs for r=0.4 =  0.651
NEC for r=0.4 class 1.0 = 0.408 +- 0.340 (in-sample avg dev_std = 0.507)
NEC for r=0.4 all KL = 0.618 +- 0.340 (in-sample avg dev_std = 0.507)
NEC for r=0.4 all L1 = 0.408 +- 0.285 (in-sample avg dev_std = 0.507)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.996
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09773646209386282
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.627
NEC for r=0.3 class 1.0 = 0.424 +- 0.332 (in-sample avg dev_std = 0.543)
NEC for r=0.3 all KL = 0.649 +- 0.332 (in-sample avg dev_std = 0.543)
NEC for r=0.3 all L1 = 0.424 +- 0.283 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.115
NEC for r=0.6 class 1.0 = 0.544 +- 0.411 (in-sample avg dev_std = 0.094)
NEC for r=0.6 all KL = 0.584 +- 0.411 (in-sample avg dev_std = 0.094)
NEC for r=0.6 all L1 = 0.544 +- 0.350 (in-sample avg dev_std = 0.094)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.679
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008223412698412699
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.115
NEC for r=0.5 class 1.0 = 0.544 +- 0.411 (in-sample avg dev_std = 0.094)
NEC for r=0.5 all KL = 0.584 +- 0.411 (in-sample avg dev_std = 0.094)
NEC for r=0.5 all L1 = 0.544 +- 0.350 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010820634920634922
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.007
NEC for r=0.4 class 1.0 = 0.626 +- 0.400 (in-sample avg dev_std = 0.131)
NEC for r=0.4 all KL = 0.671 +- 0.400 (in-sample avg dev_std = 0.131)
NEC for r=0.4 all L1 = 0.626 +- 0.329 (in-sample avg dev_std = 0.131)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.008
NEC for r=0.3 class 1.0 = 0.627 +- 0.400 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.671 +- 0.400 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.627 +- 0.328 (in-sample avg dev_std = 0.162)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04499635332252836
len(reference) = 2468
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.6 =  0.773
NEC for r=0.6 class 1.0 = 0.058 +- 0.234 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all KL = 0.067 +- 0.234 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all L1 = 0.058 +- 0.199 (in-sample avg dev_std = 0.071)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.815
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04499635332252836
len(reference) = 2468
Effective ratio: 0.063 +- 0.113
Model Accuracy over intervened graphs for r=0.5 =  0.773
NEC for r=0.5 class 1.0 = 0.058 +- 0.234 (in-sample avg dev_std = 0.071)
NEC for r=0.5 all KL = 0.067 +- 0.234 (in-sample avg dev_std = 0.071)
NEC for r=0.5 all L1 = 0.058 +- 0.199 (in-sample avg dev_std = 0.071)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.815
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08502552674230146
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.751
NEC for r=0.4 class 1.0 = 0.081 +- 0.305 (in-sample avg dev_std = 0.230)
NEC for r=0.4 all KL = 0.117 +- 0.305 (in-sample avg dev_std = 0.230)
NEC for r=0.4 all L1 = 0.081 +- 0.219 (in-sample avg dev_std = 0.230)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11146920583468395
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.752
NEC for r=0.3 class 1.0 = 0.083 +- 0.319 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.131 +- 0.319 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.083 +- 0.216 (in-sample avg dev_std = 0.252)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:15:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:15:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.041
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.056
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.010
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.051
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.041072202166064976
len(reference) = 277
Effective ratio: 0.076 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.092
SUFF_SIMPLE for r=0.6 class 1.0 = 0.18 +- 0.083 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.6 all KL = 0.028 +- 0.083 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.6 all L1 = 0.18 +- 0.061 (in-sample avg dev_std = 0.510)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.043841155234657044
len(reference) = 277
Effective ratio: 0.078 +- 0.088
Model Accuracy over intervened graphs for r=0.5 =  0.102
SUFF_SIMPLE for r=0.5 class 1.0 = 0.184 +- 0.083 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.5 all KL = 0.028 +- 0.083 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.5 all L1 = 0.184 +- 0.070 (in-sample avg dev_std = 0.525)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05643321299638989
len(reference) = 277
Effective ratio: 0.112 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.09
SUFF_SIMPLE for r=0.4 class 1.0 = 0.18 +- 0.080 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.4 all KL = 0.028 +- 0.080 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.4 all L1 = 0.18 +- 0.072 (in-sample avg dev_std = 0.493)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009807142857142856
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.381 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.381 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all L1 = 0.739 +- 0.351 (in-sample avg dev_std = 0.010)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0509242301458671
len(reference) = 2457
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF_SIMPLE for r=0.6 class 1.0 = 0.892 +- 0.336 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.6 all KL = 0.858 +- 0.336 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.6 all L1 = 0.892 +- 0.260 (in-sample avg dev_std = 0.237)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.825
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.05116247974068071
len(reference) = 2457
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.723
SUFF_SIMPLE for r=0.5 class 1.0 = 0.891 +- 0.336 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.5 all KL = 0.858 +- 0.336 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.5 all L1 = 0.891 +- 0.262 (in-sample avg dev_std = 0.235)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06221839546191248
len(reference) = 2457
Effective ratio: 0.090 +- 0.132
Model Accuracy over intervened graphs for r=0.4 =  0.723
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.339 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all KL = 0.855 +- 0.339 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.262 (in-sample avg dev_std = 0.237)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.041072202166064976
len(reference) = 277
Effective ratio: 0.076 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.6
NEC for r=0.6 class 1.0 = 0.398 +- 0.416 (in-sample avg dev_std = 0.347)
NEC for r=0.6 all KL = 0.538 +- 0.416 (in-sample avg dev_std = 0.347)
NEC for r=0.6 all L1 = 0.398 +- 0.349 (in-sample avg dev_std = 0.347)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.043841155234657044
len(reference) = 277
Effective ratio: 0.078 +- 0.088
Model Accuracy over intervened graphs for r=0.5 =  0.596
NEC for r=0.5 class 1.0 = 0.408 +- 0.414 (in-sample avg dev_std = 0.364)
NEC for r=0.5 all KL = 0.555 +- 0.414 (in-sample avg dev_std = 0.364)
NEC for r=0.5 all L1 = 0.408 +- 0.347 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05643321299638989
len(reference) = 277
Effective ratio: 0.112 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.589
NEC for r=0.4 class 1.0 = 0.425 +- 0.393 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all KL = 0.6 +- 0.393 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all L1 = 0.425 +- 0.329 (in-sample avg dev_std = 0.454)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09742238267148014
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.604
NEC for r=0.3 class 1.0 = 0.432 +- 0.337 (in-sample avg dev_std = 0.521)
NEC for r=0.3 all KL = 0.67 +- 0.337 (in-sample avg dev_std = 0.521)
NEC for r=0.3 all L1 = 0.432 +- 0.299 (in-sample avg dev_std = 0.521)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.023
NEC for r=0.6 class 1.0 = 0.245 +- 0.366 (in-sample avg dev_std = 0.068)
NEC for r=0.6 all KL = 0.242 +- 0.366 (in-sample avg dev_std = 0.068)
NEC for r=0.6 all L1 = 0.245 +- 0.336 (in-sample avg dev_std = 0.068)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.254
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.009845238095238096
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.023
NEC for r=0.5 class 1.0 = 0.245 +- 0.366 (in-sample avg dev_std = 0.068)
NEC for r=0.5 all KL = 0.242 +- 0.366 (in-sample avg dev_std = 0.068)
NEC for r=0.5 all L1 = 0.245 +- 0.336 (in-sample avg dev_std = 0.068)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.254
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009807142857142856
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.02
NEC for r=0.4 class 1.0 = 0.247 +- 0.368 (in-sample avg dev_std = 0.063)
NEC for r=0.4 all KL = 0.244 +- 0.368 (in-sample avg dev_std = 0.063)
NEC for r=0.4 all L1 = 0.247 +- 0.338 (in-sample avg dev_std = 0.063)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.254
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013030555555555557
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.004
NEC for r=0.3 class 1.0 = 0.26 +- 0.380 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all KL = 0.258 +- 0.380 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all L1 = 0.26 +- 0.349 (in-sample avg dev_std = 0.099)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0509242301458671
len(reference) = 2468
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.6 =  0.781
NEC for r=0.6 class 1.0 = 0.063 +- 0.241 (in-sample avg dev_std = 0.070)
NEC for r=0.6 all KL = 0.071 +- 0.241 (in-sample avg dev_std = 0.070)
NEC for r=0.6 all L1 = 0.063 +- 0.208 (in-sample avg dev_std = 0.070)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.822
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.05116247974068071
len(reference) = 2468
Effective ratio: 0.066 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.78
NEC for r=0.5 class 1.0 = 0.064 +- 0.243 (in-sample avg dev_std = 0.072)
NEC for r=0.5 all KL = 0.072 +- 0.243 (in-sample avg dev_std = 0.072)
NEC for r=0.5 all L1 = 0.064 +- 0.210 (in-sample avg dev_std = 0.072)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.822
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06221839546191248
len(reference) = 2468
Effective ratio: 0.090 +- 0.132
Model Accuracy over intervened graphs for r=0.4 =  0.765
NEC for r=0.4 class 1.0 = 0.076 +- 0.274 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.092 +- 0.274 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.076 +- 0.226 (in-sample avg dev_std = 0.140)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.822
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11131604538087521
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.753
NEC for r=0.3 class 1.0 = 0.091 +- 0.325 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all KL = 0.138 +- 0.325 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all L1 = 0.091 +- 0.229 (in-sample avg dev_std = 0.255)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:19:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:19:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.047
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.057
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.044
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.6 =  0.097
SUFF_SIMPLE for r=0.6 class 1.0 = 0.182 +- 0.086 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.6 all KL = 0.026 +- 0.086 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.6 all L1 = 0.182 +- 0.072 (in-sample avg dev_std = 0.505)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.5 =  0.097
SUFF_SIMPLE for r=0.5 class 1.0 = 0.182 +- 0.086 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.5 all KL = 0.026 +- 0.086 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.5 all L1 = 0.182 +- 0.072 (in-sample avg dev_std = 0.505)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05664259927797833
len(reference) = 277
Effective ratio: 0.102 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.093
SUFF_SIMPLE for r=0.4 class 1.0 = 0.18 +- 0.086 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.4 all KL = 0.026 +- 0.086 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.4 all L1 = 0.18 +- 0.070 (in-sample avg dev_std = 0.509)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.020)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.5 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.5 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.020)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008219444444444444
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.442 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.493 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0440064829821718
len(reference) = 2457
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF_SIMPLE for r=0.6 class 1.0 = 0.892 +- 0.340 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.6 all KL = 0.856 +- 0.340 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.6 all L1 = 0.892 +- 0.263 (in-sample avg dev_std = 0.240)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.83
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0440064829821718
len(reference) = 2457
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.722
SUFF_SIMPLE for r=0.5 class 1.0 = 0.892 +- 0.340 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.5 all KL = 0.856 +- 0.340 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.5 all L1 = 0.892 +- 0.263 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.83
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.048196110210696926
len(reference) = 2457
Effective ratio: 0.074 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.725
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.340 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 all KL = 0.857 +- 0.340 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 all L1 = 0.894 +- 0.260 (in-sample avg dev_std = 0.238)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.6 =  0.594
NEC for r=0.6 class 1.0 = 0.415 +- 0.404 (in-sample avg dev_std = 0.369)
NEC for r=0.6 all KL = 0.579 +- 0.404 (in-sample avg dev_std = 0.369)
NEC for r=0.6 all L1 = 0.415 +- 0.346 (in-sample avg dev_std = 0.369)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.989
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04724548736462094
len(reference) = 277
Effective ratio: 0.081 +- 0.094
Model Accuracy over intervened graphs for r=0.5 =  0.594
NEC for r=0.5 class 1.0 = 0.415 +- 0.404 (in-sample avg dev_std = 0.369)
NEC for r=0.5 all KL = 0.579 +- 0.404 (in-sample avg dev_std = 0.369)
NEC for r=0.5 all L1 = 0.415 +- 0.346 (in-sample avg dev_std = 0.369)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05664259927797833
len(reference) = 277
Effective ratio: 0.102 +- 0.111
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 1.0 = 0.418 +- 0.380 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all KL = 0.623 +- 0.380 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all L1 = 0.418 +- 0.327 (in-sample avg dev_std = 0.433)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.989
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0982490974729242
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.602
NEC for r=0.3 class 1.0 = 0.438 +- 0.351 (in-sample avg dev_std = 0.534)
NEC for r=0.3 all KL = 0.687 +- 0.351 (in-sample avg dev_std = 0.534)
NEC for r=0.3 all L1 = 0.438 +- 0.300 (in-sample avg dev_std = 0.534)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.074
NEC for r=0.6 class 1.0 = 0.457 +- 0.432 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all KL = 0.487 +- 0.432 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all L1 = 0.457 +- 0.373 (in-sample avg dev_std = 0.124)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.54
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008148809523809523
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.074
NEC for r=0.5 class 1.0 = 0.457 +- 0.432 (in-sample avg dev_std = 0.124)
NEC for r=0.5 all KL = 0.487 +- 0.432 (in-sample avg dev_std = 0.124)
NEC for r=0.5 all L1 = 0.457 +- 0.373 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.54
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008219444444444444
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.073
NEC for r=0.4 class 1.0 = 0.457 +- 0.432 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all KL = 0.488 +- 0.432 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all L1 = 0.457 +- 0.373 (in-sample avg dev_std = 0.122)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015079365079367
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.015
NEC for r=0.3 class 1.0 = 0.51 +- 0.433 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all KL = 0.546 +- 0.433 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all L1 = 0.51 +- 0.372 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0440064829821718
len(reference) = 2468
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.6 =  0.781
NEC for r=0.6 class 1.0 = 0.063 +- 0.250 (in-sample avg dev_std = 0.081)
NEC for r=0.6 all KL = 0.075 +- 0.250 (in-sample avg dev_std = 0.081)
NEC for r=0.6 all L1 = 0.063 +- 0.211 (in-sample avg dev_std = 0.081)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.826
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0440064829821718
len(reference) = 2468
Effective ratio: 0.065 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.781
NEC for r=0.5 class 1.0 = 0.063 +- 0.250 (in-sample avg dev_std = 0.081)
NEC for r=0.5 all KL = 0.075 +- 0.250 (in-sample avg dev_std = 0.081)
NEC for r=0.5 all L1 = 0.063 +- 0.211 (in-sample avg dev_std = 0.081)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.826
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.048196110210696926
len(reference) = 2468
Effective ratio: 0.074 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.774
NEC for r=0.4 class 1.0 = 0.068 +- 0.262 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all KL = 0.083 +- 0.262 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all L1 = 0.068 +- 0.219 (in-sample avg dev_std = 0.113)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11143314424635334
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.75
NEC for r=0.3 class 1.0 = 0.093 +- 0.342 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all KL = 0.153 +- 0.342 (in-sample avg dev_std = 0.268)
NEC for r=0.3 all L1 = 0.093 +- 0.232 (in-sample avg dev_std = 0.268)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:23:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:23:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.040
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.084
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.047
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.136
SUFF_SIMPLE for r=0.6 class 1.0 = 0.201 +- 0.048 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.6 all KL = 0.021 +- 0.048 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.6 all L1 = 0.201 +- 0.083 (in-sample avg dev_std = 0.531)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.136
SUFF_SIMPLE for r=0.5 class 1.0 = 0.201 +- 0.048 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.5 all KL = 0.021 +- 0.048 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.5 all L1 = 0.201 +- 0.083 (in-sample avg dev_std = 0.531)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08403971119133574
len(reference) = 277
Effective ratio: 0.310 +- 0.206
Model Accuracy over intervened graphs for r=0.4 =  0.134
SUFF_SIMPLE for r=0.4 class 1.0 = 0.204 +- 0.107 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all KL = 0.031 +- 0.107 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all L1 = 0.204 +- 0.109 (in-sample avg dev_std = 0.507)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.002)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.5 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010527777777777778
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.585 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04677836304700163
len(reference) = 2457
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF_SIMPLE for r=0.6 class 1.0 = 0.882 +- 0.343 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.6 all KL = 0.848 +- 0.343 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.6 all L1 = 0.882 +- 0.271 (in-sample avg dev_std = 0.242)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04677836304700163
len(reference) = 2457
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.721
SUFF_SIMPLE for r=0.5 class 1.0 = 0.882 +- 0.343 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.5 all KL = 0.848 +- 0.343 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.5 all L1 = 0.882 +- 0.271 (in-sample avg dev_std = 0.242)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08463330632090761
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.724
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.341 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all KL = 0.851 +- 0.341 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all L1 = 0.884 +- 0.269 (in-sample avg dev_std = 0.225)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.6 =  0.722
NEC for r=0.6 class 1.0 = 0.317 +- 0.385 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.415 +- 0.385 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.317 +- 0.318 (in-sample avg dev_std = 0.330)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.039985559566787
len(reference) = 277
Effective ratio: 0.074 +- 0.080
Model Accuracy over intervened graphs for r=0.5 =  0.722
NEC for r=0.5 class 1.0 = 0.317 +- 0.385 (in-sample avg dev_std = 0.330)
NEC for r=0.5 all KL = 0.415 +- 0.385 (in-sample avg dev_std = 0.330)
NEC for r=0.5 all L1 = 0.317 +- 0.318 (in-sample avg dev_std = 0.330)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08403971119133574
len(reference) = 277
Effective ratio: 0.310 +- 0.206
Model Accuracy over intervened graphs for r=0.4 =  0.733
NEC for r=0.4 class 1.0 = 0.341 +- 0.348 (in-sample avg dev_std = 0.504)
NEC for r=0.4 all KL = 0.51 +- 0.348 (in-sample avg dev_std = 0.504)
NEC for r=0.4 all L1 = 0.341 +- 0.271 (in-sample avg dev_std = 0.504)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09811191335740072
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.739
NEC for r=0.3 class 1.0 = 0.338 +- 0.339 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all KL = 0.512 +- 0.339 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all L1 = 0.338 +- 0.267 (in-sample avg dev_std = 0.497)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.061
NEC for r=0.6 class 1.0 = 0.374 +- 0.391 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all KL = 0.367 +- 0.391 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all L1 = 0.374 +- 0.351 (in-sample avg dev_std = 0.083)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.41
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008149603174603174
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.061
NEC for r=0.5 class 1.0 = 0.374 +- 0.391 (in-sample avg dev_std = 0.083)
NEC for r=0.5 all KL = 0.367 +- 0.391 (in-sample avg dev_std = 0.083)
NEC for r=0.5 all L1 = 0.374 +- 0.351 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.41
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010527777777777778
len(reference) = 2520
Effective ratio: 0.060 +- 0.038
Model Accuracy over intervened graphs for r=0.4 =  0.009
NEC for r=0.4 class 1.0 = 0.415 +- 0.415 (in-sample avg dev_std = 0.124)
NEC for r=0.4 all KL = 0.415 +- 0.415 (in-sample avg dev_std = 0.124)
NEC for r=0.4 all L1 = 0.415 +- 0.366 (in-sample avg dev_std = 0.124)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013009920634920636
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.009
NEC for r=0.3 class 1.0 = 0.417 +- 0.414 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.417 +- 0.414 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.417 +- 0.365 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04677836304700163
len(reference) = 2468
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.6 =  0.778
NEC for r=0.6 class 1.0 = 0.067 +- 0.240 (in-sample avg dev_std = 0.061)
NEC for r=0.6 all KL = 0.074 +- 0.240 (in-sample avg dev_std = 0.061)
NEC for r=0.6 all L1 = 0.067 +- 0.214 (in-sample avg dev_std = 0.061)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.831
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04677836304700163
len(reference) = 2468
Effective ratio: 0.065 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.778
NEC for r=0.5 class 1.0 = 0.067 +- 0.240 (in-sample avg dev_std = 0.061)
NEC for r=0.5 all KL = 0.074 +- 0.240 (in-sample avg dev_std = 0.061)
NEC for r=0.5 all L1 = 0.067 +- 0.214 (in-sample avg dev_std = 0.061)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08463330632090761
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.752
NEC for r=0.4 class 1.0 = 0.096 +- 0.320 (in-sample avg dev_std = 0.244)
NEC for r=0.4 all KL = 0.135 +- 0.320 (in-sample avg dev_std = 0.244)
NEC for r=0.4 all L1 = 0.096 +- 0.238 (in-sample avg dev_std = 0.244)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11163006482982171
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.751
NEC for r=0.3 class 1.0 = 0.098 +- 0.331 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all KL = 0.146 +- 0.331 (in-sample avg dev_std = 0.255)
NEC for r=0.3 all L1 = 0.098 +- 0.236 (in-sample avg dev_std = 0.255)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:27:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:27:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.042
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.042
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.042
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.009
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.048
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.048


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.6 =  0.091
SUFF_SIMPLE for r=0.6 class 1.0 = 0.179 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.6 all KL = 0.023 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.6 all L1 = 0.179 +- 0.064 (in-sample avg dev_std = 0.510)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.5 =  0.091
SUFF_SIMPLE for r=0.5 class 1.0 = 0.179 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.5 all KL = 0.023 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.5 all L1 = 0.179 +- 0.064 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.4 =  0.091
SUFF_SIMPLE for r=0.4 class 1.0 = 0.179 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.4 all KL = 0.023 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.4 all L1 = 0.179 +- 0.064 (in-sample avg dev_std = 0.510)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.3 =  0.091
SUFF_SIMPLE for r=0.3 class 1.0 = 0.179 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.3 all KL = 0.023 +- 0.078 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.3 all L1 = 0.179 +- 0.064 (in-sample avg dev_std = 0.510)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.025)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.5 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.025)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.4 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.4 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.025)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.3 =  0.0
SUFF_SIMPLE for r=0.3 class 1.0 = 0.151 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.3 all KL = 0.027 +- 0.128 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.3 all L1 = 0.151 +- 0.091 (in-sample avg dev_std = 0.025)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF_SIMPLE for r=0.6 class 1.0 = 0.902 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.6 all KL = 0.872 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.6 all L1 = 0.902 +- 0.251 (in-sample avg dev_std = 0.219)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.817
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.5 =  0.725
SUFF_SIMPLE for r=0.5 class 1.0 = 0.902 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.5 all KL = 0.872 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.5 all L1 = 0.902 +- 0.251 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.817
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.725
SUFF_SIMPLE for r=0.4 class 1.0 = 0.902 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all KL = 0.872 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.251 (in-sample avg dev_std = 0.219)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0478581847649919
len(reference) = 2457
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.3 =  0.725
SUFF_SIMPLE for r=0.3 class 1.0 = 0.902 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.3 all KL = 0.872 +- 0.323 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.3 all L1 = 0.902 +- 0.251 (in-sample avg dev_std = 0.219)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.6 =  0.639
NEC for r=0.6 class 1.0 = 0.359 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.6 all KL = 0.502 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.6 all L1 = 0.359 +- 0.356 (in-sample avg dev_std = 0.324)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.5 =  0.639
NEC for r=0.5 class 1.0 = 0.359 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.5 all KL = 0.502 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.5 all L1 = 0.359 +- 0.356 (in-sample avg dev_std = 0.324)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.4 =  0.639
NEC for r=0.4 class 1.0 = 0.359 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.4 all KL = 0.502 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.4 all L1 = 0.359 +- 0.356 (in-sample avg dev_std = 0.324)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.04183393501805054
len(reference) = 277
Effective ratio: 0.077 +- 0.085
Model Accuracy over intervened graphs for r=0.3 =  0.639
NEC for r=0.3 class 1.0 = 0.359 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.3 all KL = 0.502 +- 0.431 (in-sample avg dev_std = 0.324)
NEC for r=0.3 all L1 = 0.359 +- 0.356 (in-sample avg dev_std = 0.324)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.978
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.6 =  0.254
NEC for r=0.6 class 1.0 = 0.647 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.764 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.647 +- 0.351 (in-sample avg dev_std = 0.169)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.978
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.5 =  0.254
NEC for r=0.5 class 1.0 = 0.647 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.5 all KL = 0.764 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.5 all L1 = 0.647 +- 0.351 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.4 =  0.254
NEC for r=0.4 class 1.0 = 0.647 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all KL = 0.764 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all L1 = 0.647 +- 0.351 (in-sample avg dev_std = 0.169)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.978
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.00896031746031746
len(reference) = 2520
Effective ratio: 0.034 +- 0.028
Model Accuracy over intervened graphs for r=0.3 =  0.254
NEC for r=0.3 class 1.0 = 0.647 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.3 all KL = 0.764 +- 0.399 (in-sample avg dev_std = 0.169)
NEC for r=0.3 all L1 = 0.647 +- 0.351 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.6 =  0.776
NEC for r=0.6 class 1.0 = 0.058 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.6 all KL = 0.067 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.6 all L1 = 0.058 +- 0.200 (in-sample avg dev_std = 0.080)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.814
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.5 =  0.776
NEC for r=0.5 class 1.0 = 0.058 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.5 all KL = 0.067 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.5 all L1 = 0.058 +- 0.200 (in-sample avg dev_std = 0.080)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.814
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.4 =  0.776
NEC for r=0.4 class 1.0 = 0.058 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.4 all KL = 0.067 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.4 all L1 = 0.058 +- 0.200 (in-sample avg dev_std = 0.080)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0478581847649919
len(reference) = 2468
Effective ratio: 0.066 +- 0.116
Model Accuracy over intervened graphs for r=0.3 =  0.776
NEC for r=0.3 class 1.0 = 0.058 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.3 all KL = 0.067 +- 0.236 (in-sample avg dev_std = 0.080)
NEC for r=0.3 all L1 = 0.058 +- 0.200 (in-sample avg dev_std = 0.080)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:31:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:31:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.043
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.043
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.043
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.046
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.046
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.167
SUFF_SIMPLE for r=0.6 class 1.0 = 0.212 +- 0.055 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.6 all KL = 0.015 +- 0.055 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.6 all L1 = 0.212 +- 0.109 (in-sample avg dev_std = 0.595)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.5 =  0.167
SUFF_SIMPLE for r=0.5 class 1.0 = 0.212 +- 0.055 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.5 all KL = 0.015 +- 0.055 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.5 all L1 = 0.212 +- 0.109 (in-sample avg dev_std = 0.595)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.4 =  0.167
SUFF_SIMPLE for r=0.4 class 1.0 = 0.212 +- 0.055 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.4 all KL = 0.015 +- 0.055 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.4 all L1 = 0.212 +- 0.109 (in-sample avg dev_std = 0.595)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.001)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.315 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.315 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.297 (in-sample avg dev_std = 0.001)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.6 =  0.726
SUFF_SIMPLE for r=0.6 class 1.0 = 0.873 +- 0.363 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.6 all KL = 0.833 +- 0.363 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.6 all L1 = 0.873 +- 0.285 (in-sample avg dev_std = 0.245)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.855
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.726
SUFF_SIMPLE for r=0.5 class 1.0 = 0.873 +- 0.363 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.5 all KL = 0.833 +- 0.363 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.5 all L1 = 0.873 +- 0.285 (in-sample avg dev_std = 0.245)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.855
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04607293354943274
len(reference) = 2457
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.726
SUFF_SIMPLE for r=0.4 class 1.0 = 0.873 +- 0.363 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all KL = 0.833 +- 0.363 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all L1 = 0.873 +- 0.285 (in-sample avg dev_std = 0.245)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.6 =  0.699
NEC for r=0.6 class 1.0 = 0.324 +- 0.431 (in-sample avg dev_std = 0.371)
NEC for r=0.6 all KL = 0.472 +- 0.431 (in-sample avg dev_std = 0.371)
NEC for r=0.6 all L1 = 0.324 +- 0.334 (in-sample avg dev_std = 0.371)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.5 =  0.699
NEC for r=0.5 class 1.0 = 0.324 +- 0.431 (in-sample avg dev_std = 0.371)
NEC for r=0.5 all KL = 0.472 +- 0.431 (in-sample avg dev_std = 0.371)
NEC for r=0.5 all L1 = 0.324 +- 0.334 (in-sample avg dev_std = 0.371)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.042505415162454874
len(reference) = 277
Effective ratio: 0.077 +- 0.086
Model Accuracy over intervened graphs for r=0.4 =  0.699
NEC for r=0.4 class 1.0 = 0.324 +- 0.431 (in-sample avg dev_std = 0.371)
NEC for r=0.4 all KL = 0.472 +- 0.431 (in-sample avg dev_std = 0.371)
NEC for r=0.4 all L1 = 0.324 +- 0.334 (in-sample avg dev_std = 0.371)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09797111913357401
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.723
NEC for r=0.3 class 1.0 = 0.343 +- 0.381 (in-sample avg dev_std = 0.524)
NEC for r=0.3 all KL = 0.609 +- 0.381 (in-sample avg dev_std = 0.524)
NEC for r=0.3 all L1 = 0.343 +- 0.285 (in-sample avg dev_std = 0.524)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.015
NEC for r=0.6 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all KL = 0.15 +- 0.303 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all L1 = 0.155 +- 0.286 (in-sample avg dev_std = 0.075)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.15
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.015
NEC for r=0.5 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.075)
NEC for r=0.5 all KL = 0.15 +- 0.303 (in-sample avg dev_std = 0.075)
NEC for r=0.5 all L1 = 0.155 +- 0.286 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.15
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.008249603174603175
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.4 =  0.015
NEC for r=0.4 class 1.0 = 0.155 +- 0.303 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all KL = 0.15 +- 0.303 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all L1 = 0.155 +- 0.286 (in-sample avg dev_std = 0.075)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013014682539682538
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.006
NEC for r=0.3 class 1.0 = 0.162 +- 0.314 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.159 +- 0.314 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.162 +- 0.294 (in-sample avg dev_std = 0.114)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.6 =  0.783
NEC for r=0.6 class 1.0 = 0.085 +- 0.288 (in-sample avg dev_std = 0.090)
NEC for r=0.6 all KL = 0.1 +- 0.288 (in-sample avg dev_std = 0.090)
NEC for r=0.6 all L1 = 0.085 +- 0.245 (in-sample avg dev_std = 0.090)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.851
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.783
NEC for r=0.5 class 1.0 = 0.085 +- 0.288 (in-sample avg dev_std = 0.090)
NEC for r=0.5 all KL = 0.1 +- 0.288 (in-sample avg dev_std = 0.090)
NEC for r=0.5 all L1 = 0.085 +- 0.245 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.851
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04607293354943274
len(reference) = 2468
Effective ratio: 0.065 +- 0.118
Model Accuracy over intervened graphs for r=0.4 =  0.783
NEC for r=0.4 class 1.0 = 0.085 +- 0.288 (in-sample avg dev_std = 0.090)
NEC for r=0.4 all KL = 0.1 +- 0.288 (in-sample avg dev_std = 0.090)
NEC for r=0.4 all L1 = 0.085 +- 0.245 (in-sample avg dev_std = 0.090)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.851
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11157820097244732
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.756
NEC for r=0.3 class 1.0 = 0.109 +- 0.357 (in-sample avg dev_std = 0.270)
NEC for r=0.3 all KL = 0.167 +- 0.357 (in-sample avg dev_std = 0.270)
NEC for r=0.3 all L1 = 0.109 +- 0.255 (in-sample avg dev_std = 0.270)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:34:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:34:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.081
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.081
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.098
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.086
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.111
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.111


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.6 =  0.128
SUFF_SIMPLE for r=0.6 class 1.0 = 0.192 +- 0.046 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.6 all KL = 0.011 +- 0.046 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.6 all L1 = 0.192 +- 0.093 (in-sample avg dev_std = 0.548)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.5 =  0.128
SUFF_SIMPLE for r=0.5 class 1.0 = 0.192 +- 0.046 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.5 all KL = 0.011 +- 0.046 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.5 all L1 = 0.192 +- 0.093 (in-sample avg dev_std = 0.548)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0980649819494585
len(reference) = 6
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.833
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.628 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.761 +- 0.346 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.882 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.878 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.882 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.878 +- 0.268 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013015873015873017
len(reference) = 1
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- nan (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- nan (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- nan (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08550769854132902
len(reference) = 2457
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF_SIMPLE for r=0.6 class 1.0 = 0.885 +- 0.346 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.6 all KL = 0.85 +- 0.346 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.6 all L1 = 0.885 +- 0.272 (in-sample avg dev_std = 0.230)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.838
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08550769854132902
len(reference) = 2457
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.724
SUFF_SIMPLE for r=0.5 class 1.0 = 0.885 +- 0.346 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.5 all KL = 0.85 +- 0.346 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.5 all L1 = 0.885 +- 0.272 (in-sample avg dev_std = 0.230)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.647
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11143233387358184
len(reference) = 34
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.471
SUFF_SIMPLE for r=0.4 class 1.0 = 0.756 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.420 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.756 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.6 =  0.674
NEC for r=0.6 class 1.0 = 0.39 +- 0.362 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all KL = 0.675 +- 0.362 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all L1 = 0.39 +- 0.291 (in-sample avg dev_std = 0.579)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08085198555956678
len(reference) = 277
Effective ratio: 0.694 +- 0.199
Model Accuracy over intervened graphs for r=0.5 =  0.674
NEC for r=0.5 class 1.0 = 0.39 +- 0.362 (in-sample avg dev_std = 0.579)
NEC for r=0.5 all KL = 0.675 +- 0.362 (in-sample avg dev_std = 0.579)
NEC for r=0.5 all L1 = 0.39 +- 0.291 (in-sample avg dev_std = 0.579)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0980649819494585
len(reference) = 277
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.658
NEC for r=0.4 class 1.0 = 0.393 +- 0.369 (in-sample avg dev_std = 0.564)
NEC for r=0.4 all KL = 0.664 +- 0.369 (in-sample avg dev_std = 0.564)
NEC for r=0.4 all L1 = 0.393 +- 0.301 (in-sample avg dev_std = 0.564)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  1.0
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09794945848375451
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 1.0 = 0.395 +- 0.371 (in-sample avg dev_std = 0.559)
NEC for r=0.3 all KL = 0.665 +- 0.371 (in-sample avg dev_std = 0.559)
NEC for r=0.3 all L1 = 0.395 +- 0.300 (in-sample avg dev_std = 0.559)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.113
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.005
NEC for r=0.6 class 1.0 = 0.126 +- 0.286 (in-sample avg dev_std = 0.108)
NEC for r=0.6 all KL = 0.126 +- 0.286 (in-sample avg dev_std = 0.108)
NEC for r=0.6 all L1 = 0.126 +- 0.267 (in-sample avg dev_std = 0.108)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.113
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.013079761904761905
len(reference) = 2520
Effective ratio: 0.940 +- 0.038
Model Accuracy over intervened graphs for r=0.5 =  0.005
NEC for r=0.5 class 1.0 = 0.126 +- 0.286 (in-sample avg dev_std = 0.108)
NEC for r=0.5 all KL = 0.126 +- 0.286 (in-sample avg dev_std = 0.108)
NEC for r=0.5 all L1 = 0.126 +- 0.267 (in-sample avg dev_std = 0.108)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.113
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.004
NEC for r=0.4 class 1.0 = 0.126 +- 0.287 (in-sample avg dev_std = 0.104)
NEC for r=0.4 all KL = 0.127 +- 0.287 (in-sample avg dev_std = 0.104)
NEC for r=0.4 all L1 = 0.126 +- 0.267 (in-sample avg dev_std = 0.104)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013015873015873017
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.004
NEC for r=0.3 class 1.0 = 0.126 +- 0.287 (in-sample avg dev_std = 0.107)
NEC for r=0.3 all KL = 0.128 +- 0.287 (in-sample avg dev_std = 0.107)
NEC for r=0.3 all L1 = 0.126 +- 0.267 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08550769854132902
len(reference) = 2468
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.755
NEC for r=0.6 class 1.0 = 0.096 +- 0.337 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all KL = 0.145 +- 0.337 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all L1 = 0.096 +- 0.240 (in-sample avg dev_std = 0.257)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.834
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08550769854132902
len(reference) = 2468
Effective ratio: 0.699 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.755
NEC for r=0.5 class 1.0 = 0.096 +- 0.337 (in-sample avg dev_std = 0.257)
NEC for r=0.5 all KL = 0.145 +- 0.337 (in-sample avg dev_std = 0.257)
NEC for r=0.5 all L1 = 0.096 +- 0.240 (in-sample avg dev_std = 0.257)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.834
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11143233387358184
len(reference) = 2468
Effective ratio: 0.999 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.752
NEC for r=0.4 class 1.0 = 0.099 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all KL = 0.158 +- 0.348 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all L1 = 0.099 +- 0.239 (in-sample avg dev_std = 0.273)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11149716369529984
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.751
NEC for r=0.3 class 1.0 = 0.1 +- 0.350 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all KL = 0.16 +- 0.350 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all L1 = 0.1 +- 0.240 (in-sample avg dev_std = 0.280)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 18:39:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 06:39:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
/home/azzolin/sedignn/global_local_sedignn/GOOD/kernel/pipelines/basic_pipeline.py:1153: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1808.)
  print(f"{metric.upper()} for r={ratio} class {c} = {scores[c][-1]} +- {aggr['KL'].std():.3f} (in-sample avg dev_std = {(aggr_std**2).mean().sqrt():.3f})")
/home/azzolin/sedignn/global_local_sedignn/GOOD/kernel/pipelines/basic_pipeline.py:1156: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1808.)
  print(f"{metric.upper()} for r={ratio} all {m} = {scores[f'all_{m}'][-1]} +- {aggr[f'{m}'].std():.3f} (in-sample avg dev_std = {(aggr_std**2).mean().sqrt():.3f})")
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.037
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.037
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.008
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.008
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.049
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.112


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.6 =  0.111
SUFF_SIMPLE for r=0.6 class 1.0 = 0.188 +- 0.072 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.6 all KL = 0.02 +- 0.072 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.6 all L1 = 0.188 +- 0.072 (in-sample avg dev_std = 0.537)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.5 =  0.111
SUFF_SIMPLE for r=0.5 class 1.0 = 0.188 +- 0.072 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.5 all KL = 0.02 +- 0.072 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.5 all L1 = 0.188 +- 0.072 (in-sample avg dev_std = 0.537)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0862346570397112
len(reference) = 277
Effective ratio: 0.307 +- 0.203
Model Accuracy over intervened graphs for r=0.4 =  0.116
SUFF_SIMPLE for r=0.4 class 1.0 = 0.2 +- 0.158 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.4 all KL = 0.041 +- 0.158 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.4 all L1 = 0.2 +- 0.137 (in-sample avg dev_std = 0.490)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010383333333333333
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.277 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.260 (in-sample avg dev_std = 0.000)


ratio=0.3



Too few intervened samples, skipping weight=0.3



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048649108589951376
len(reference) = 2457
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.6 =  0.723
SUFF_SIMPLE for r=0.6 class 1.0 = 0.893 +- 0.336 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 all KL = 0.858 +- 0.336 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 all L1 = 0.893 +- 0.257 (in-sample avg dev_std = 0.241)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.82
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.048649108589951376
len(reference) = 2457
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.5 =  0.723
SUFF_SIMPLE for r=0.5 class 1.0 = 0.893 +- 0.336 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all KL = 0.858 +- 0.336 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all L1 = 0.893 +- 0.257 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.82
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08621636952998378
len(reference) = 2457
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.723
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.334 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all KL = 0.86 +- 0.334 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all L1 = 0.894 +- 0.259 (in-sample avg dev_std = 0.219)


ratio=0.3



Too few intervened samples, skipping weight=0.3


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 1.0 = 0.352 +- 0.420 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.487 +- 0.420 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.352 +- 0.341 (in-sample avg dev_std = 0.339)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.993
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.03711913357400722
len(reference) = 277
Effective ratio: 0.068 +- 0.071
Model Accuracy over intervened graphs for r=0.5 =  0.671
NEC for r=0.5 class 1.0 = 0.352 +- 0.420 (in-sample avg dev_std = 0.339)
NEC for r=0.5 all KL = 0.487 +- 0.420 (in-sample avg dev_std = 0.339)
NEC for r=0.5 all L1 = 0.352 +- 0.341 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0862346570397112
len(reference) = 277
Effective ratio: 0.307 +- 0.203
Model Accuracy over intervened graphs for r=0.4 =  0.674
NEC for r=0.4 class 1.0 = 0.379 +- 0.372 (in-sample avg dev_std = 0.516)
NEC for r=0.4 all KL = 0.608 +- 0.372 (in-sample avg dev_std = 0.516)
NEC for r=0.4 all L1 = 0.379 +- 0.299 (in-sample avg dev_std = 0.516)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.993
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.09812996389891697
len(reference) = 277
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 1.0 = 0.397 +- 0.350 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all KL = 0.662 +- 0.350 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all L1 = 0.397 +- 0.283 (in-sample avg dev_std = 0.564)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.6 =  0.013
NEC for r=0.6 class 1.0 = 0.102 +- 0.262 (in-sample avg dev_std = 0.037)
NEC for r=0.6 all KL = 0.1 +- 0.262 (in-sample avg dev_std = 0.037)
NEC for r=0.6 all L1 = 0.102 +- 0.245 (in-sample avg dev_std = 0.037)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.105
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.008020634920634921
len(reference) = 2520
Effective ratio: 0.033 +- 0.027
Model Accuracy over intervened graphs for r=0.5 =  0.013
NEC for r=0.5 class 1.0 = 0.102 +- 0.262 (in-sample avg dev_std = 0.037)
NEC for r=0.5 all KL = 0.1 +- 0.262 (in-sample avg dev_std = 0.037)
NEC for r=0.5 all L1 = 0.102 +- 0.245 (in-sample avg dev_std = 0.037)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.105
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010383333333333333
len(reference) = 2520
Effective ratio: 0.060 +- 0.039
Model Accuracy over intervened graphs for r=0.4 =  0.002
NEC for r=0.4 class 1.0 = 0.11 +- 0.277 (in-sample avg dev_std = 0.065)
NEC for r=0.4 all KL = 0.109 +- 0.277 (in-sample avg dev_std = 0.065)
NEC for r=0.4 all L1 = 0.11 +- 0.259 (in-sample avg dev_std = 0.065)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.013016269841269842
len(reference) = 2520
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.002
NEC for r=0.3 class 1.0 = 0.11 +- 0.278 (in-sample avg dev_std = 0.073)
NEC for r=0.3 all KL = 0.11 +- 0.278 (in-sample avg dev_std = 0.073)
NEC for r=0.3 all L1 = 0.11 +- 0.259 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048649108589951376
len(reference) = 2468
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 1.0 = 0.062 +- 0.238 (in-sample avg dev_std = 0.077)
NEC for r=0.6 all KL = 0.07 +- 0.238 (in-sample avg dev_std = 0.077)
NEC for r=0.6 all L1 = 0.062 +- 0.206 (in-sample avg dev_std = 0.077)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.816
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.048649108589951376
len(reference) = 2468
Effective ratio: 0.065 +- 0.114
Model Accuracy over intervened graphs for r=0.5 =  0.774
NEC for r=0.5 class 1.0 = 0.062 +- 0.238 (in-sample avg dev_std = 0.077)
NEC for r=0.5 all KL = 0.07 +- 0.238 (in-sample avg dev_std = 0.077)
NEC for r=0.5 all L1 = 0.062 +- 0.206 (in-sample avg dev_std = 0.077)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08621636952998378
len(reference) = 2468
Effective ratio: 0.305 +- 0.171
Model Accuracy over intervened graphs for r=0.4 =  0.752
NEC for r=0.4 class 1.0 = 0.086 +- 0.314 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all KL = 0.125 +- 0.314 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all L1 = 0.086 +- 0.224 (in-sample avg dev_std = 0.243)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.11164181523500812
len(reference) = 2468
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.75
NEC for r=0.3 class 1.0 = 0.086 +- 0.321 (in-sample avg dev_std = 0.250)
NEC for r=0.3 all KL = 0.132 +- 0.321 (in-sample avg dev_std = 0.250)
NEC for r=0.3 all L1 = 0.086 +- 0.222 (in-sample avg dev_std = 0.250)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.022, 0.021, 1.0, 1.0], 'all_L1': [0.185, 0.182, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.599, 1.0, 1.0], 'all_L1': [0.231, 0.673, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.037, 1.0], 'all_L1': [0.177, 0.177, 0.185, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.028, 0.028, 1.0], 'all_L1': [0.18, 0.184, 0.18, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.026, 0.026, 1.0], 'all_L1': [0.182, 0.182, 0.18, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.021, 0.031, 1.0], 'all_L1': [0.201, 0.201, 0.204, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.023, 0.023, 0.023], 'all_L1': [0.179, 0.179, 0.179, 0.179]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.015, 0.015, 1.0], 'all_L1': [0.212, 0.212, 0.212, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.011, 0.628, 1.0], 'all_L1': [0.192, 0.192, 0.761, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.02, 0.041, 1.0], 'all_L1': [0.188, 0.188, 0.2, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.529, 0.673, 0.665, 0.665], 'all_L1': [0.386, 0.413, 0.414, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.527, 0.559, 0.565, 0.565], 'all_L1': [0.279, 0.291, 0.297, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.526, 0.618, 0.649], 'all_L1': [0.389, 0.389, 0.408, 0.424]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.555, 0.6, 0.67], 'all_L1': [0.398, 0.408, 0.425, 0.432]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.579, 0.623, 0.687], 'all_L1': [0.415, 0.415, 0.418, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.415, 0.415, 0.51, 0.512], 'all_L1': [0.317, 0.317, 0.341, 0.338]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.502, 0.502, 0.502], 'all_L1': [0.359, 0.359, 0.359, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.472, 0.472, 0.609], 'all_L1': [0.324, 0.324, 0.324, 0.343]}), defaultdict(<class 'list'>, {'all_KL': [0.675, 0.675, 0.664, 0.665], 'all_L1': [0.39, 0.39, 0.393, 0.395]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.487, 0.608, 0.662], 'all_L1': [0.352, 0.352, 0.379, 0.397]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.284, 0.284, 1.0, 1.0], 'all_L1': [0.349, 0.349, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.661, 1.0, 1.0], 'all_L1': [0.559, 0.699, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.328, 0.328, 1.0], 'all_L1': [0.371, 0.371, 0.371, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.743, 0.743, 1.0], 'all_L1': [0.739, 0.739, 0.739, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.464, 0.464, 1.0], 'all_L1': [0.493, 0.493, 0.493, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.585, 0.585, 1.0], 'all_L1': [0.583, 0.583, 0.583, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.027, 0.027, 0.027], 'all_L1': [0.151, 0.151, 0.151, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 0.845, 1.0], 'all_L1': [0.839, 0.839, 0.839, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.882, 1.0, 1.0], 'all_L1': [0.878, 0.878, 1.0, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.892, 0.892, 1.0], 'all_L1': [0.89, 0.89, 0.89, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.614, 0.714, 0.716, 0.716], 'all_L1': [0.55, 0.645, 0.645, 0.645]}), defaultdict(<class 'list'>, {'all_KL': [0.467, 0.469, 0.468, 0.468], 'all_L1': [0.441, 0.442, 0.442, 0.442]}), defaultdict(<class 'list'>, {'all_KL': [0.584, 0.584, 0.671, 0.671], 'all_L1': [0.544, 0.544, 0.626, 0.627]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.244, 0.258], 'all_L1': [0.245, 0.245, 0.247, 0.26]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.487, 0.488, 0.546], 'all_L1': [0.457, 0.457, 0.457, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.367, 0.367, 0.415, 0.417], 'all_L1': [0.374, 0.374, 0.415, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.764, 0.764, 0.764], 'all_L1': [0.647, 0.647, 0.647, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.15, 0.15, 0.15, 0.159], 'all_L1': [0.155, 0.155, 0.155, 0.162]}), defaultdict(<class 'list'>, {'all_KL': [0.126, 0.126, 0.127, 0.128], 'all_L1': [0.126, 0.126, 0.126, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.1, 0.109, 0.11], 'all_L1': [0.102, 0.102, 0.11, 0.11]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.845, 0.845, 1.0, 1.0], 'all_L1': [0.885, 0.885, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.876, 1.0, 1.0], 'all_L1': [0.876, 0.885, 1.0, 1.0], 1.0: [1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.866, 0.866, 0.872, 1.0], 'all_L1': [0.9, 0.9, 0.902, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.858, 0.855, 1.0], 'all_L1': [0.892, 0.891, 0.89, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.856, 0.857, 1.0], 'all_L1': [0.892, 0.892, 0.894, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.848, 0.848, 0.851, 1.0], 'all_L1': [0.882, 0.882, 0.884, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.872, 0.872, 0.872], 'all_L1': [0.902, 0.902, 0.902, 0.902]}), defaultdict(<class 'list'>, {'all_KL': [0.833, 0.833, 0.833, 1.0], 'all_L1': [0.873, 0.873, 0.873, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.85, 0.85, 0.744, 1.0], 'all_L1': [0.885, 0.885, 0.756, 1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.858, 0.86, 1.0], 'all_L1': [0.893, 0.893, 0.894, 1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.074, 0.141, 0.158, 0.158], 'all_L1': [0.064, 0.095, 0.098, 0.098]}), defaultdict(<class 'list'>, {'all_KL': [0.157, 0.162, 0.163, 0.163], 'all_L1': [0.105, 0.106, 0.106, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.067, 0.117, 0.131], 'all_L1': [0.058, 0.058, 0.081, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.072, 0.092, 0.138], 'all_L1': [0.063, 0.064, 0.076, 0.091]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.075, 0.083, 0.153], 'all_L1': [0.063, 0.063, 0.068, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.074, 0.135, 0.146], 'all_L1': [0.067, 0.067, 0.096, 0.098]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.067, 0.067, 0.067], 'all_L1': [0.058, 0.058, 0.058, 0.058]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.1, 0.1, 0.167], 'all_L1': [0.085, 0.085, 0.085, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.145, 0.145, 0.158, 0.16], 'all_L1': [0.096, 0.096, 0.099, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.07, 0.125, 0.132], 'all_L1': [0.062, 0.062, 0.086, 0.086]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.193 +- 0.016, 0.237 +- 0.146, 0.410 +- 0.340, 0.918 +- 0.246
suff_simple class all_KL  =  0.020 +- 0.006, 0.079 +- 0.173, 0.283 +- 0.400, 0.902 +- 0.293
[[0.10514440387487411, 0.09611913561820984, -1.0, -1.0], [0.20171479880809784, 0.6326530575752258, -1.0, -1.0], [0.08844765275716782, 0.08844765275716782, 0.08922101557254791, -1.0], [0.09205776453018188, 0.10153429955244064, 0.08980144560337067, -1.0], [0.09657039493322372, 0.09657039493322372, 0.09341154992580414, -1.0], [0.1358303278684616, 0.1358303278684616, 0.1335740089416504, -1.0], [0.09070397168397903, 0.09070397168397903, 0.09070397168397903, 0.09070397168397903], [0.1665162444114685, 0.1665162444114685, 0.1665162444114685, -1.0], [0.128158837556839, 0.128158837556839, 0.8333333134651184, -1.0], [0.11146209388971329, 0.11146209388971329, 0.11642599105834961, -1.0]]
[[0.022, 0.021, 1.0, 1.0], [0.008, 0.599, 1.0, 1.0], [0.024, 0.024, 0.037, 1.0], [0.028, 0.028, 0.028, 1.0], [0.026, 0.026, 0.026, 1.0], [0.021, 0.021, 0.031, 1.0], [0.023, 0.023, 0.023, 0.023], [0.015, 0.015, 0.015, 1.0], [0.011, 0.011, 0.628, 1.0], [0.02, 0.02, 0.041, 1.0]]
suff_simple_acc_int  =  0.122 +- 0.036, 0.165 +- 0.158, -0.039 +- 0.526, -0.891 +- 0.327
nec class all_L1  =  0.361 +- 0.041, 0.366 +- 0.042, 0.376 +- 0.042, 0.384 +- 0.045
nec class all_KL  =  0.525 +- 0.065, 0.544 +- 0.079, 0.583 +- 0.064, 0.619 +- 0.065
[[0.6231949329376221, 0.6299638748168945, 0.6254512667655945, 0.6254512667655945], [0.7883573770523071, 0.784747302532196, 0.7770758271217346, 0.7770758271217346], [0.6209385991096497, 0.6209385991096497, 0.6507220268249512, 0.6268050670623779], [0.5997292399406433, 0.5961191058158875, 0.5888988971710205, 0.6037906408309937], [0.5943140983581543, 0.5943140983581543, 0.6037906408309937, 0.6015343070030212], [0.7224729061126709, 0.7224729061126709, 0.7328519821166992, 0.7387183904647827], [0.6394404172897339, 0.6394404172897339, 0.6394404172897339, 0.6394404172897339], [0.6994584798812866, 0.6994584798812866, 0.6994584798812866, 0.7229241728782654], [0.6741877198219299, 0.6741877198219299, 0.6579422354698181, 0.6588447690010071], [0.6710288524627686, 0.6710288524627686, 0.6737364530563354, 0.6588447690010071]]
[[0.529, 0.673, 0.665, 0.665], [0.527, 0.559, 0.565, 0.565], [0.526, 0.526, 0.618, 0.649], [0.538, 0.555, 0.6, 0.67], [0.579, 0.579, 0.623, 0.687], [0.415, 0.415, 0.51, 0.512], [0.502, 0.502, 0.502, 0.502], [0.472, 0.472, 0.472, 0.609], [0.675, 0.675, 0.664, 0.665], [0.487, 0.487, 0.608, 0.662]]
nec_acc_int  =  0.663 +- 0.058, 0.663 +- 0.057, 0.665 +- 0.055, 0.665 +- 0.057

Eval split val
suff_simple class all_L1  =  0.585 +- 0.238, 0.599 +- 0.240, 0.707 +- 0.282, 0.915 +- 0.255
suff_simple class all_KL  =  0.559 +- 0.274, 0.571 +- 0.276, 0.688 +- 0.314, 0.903 +- 0.292
[[0.00014880952949170023, 0.00019841270113829523, -1.0, -1.0], [0.00039682540227659047, 0.5, -1.0, -1.0], [4.960317528457381e-05, 4.960317528457381e-05, 4.960317528457381e-05, -1.0], [0.0, 0.0, 4.960317528457381e-05, -1.0], [9.920635056914762e-05, 9.920635056914762e-05, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.00019841270113829523, 0.00019841270113829523, 0.00019841270113829523, 0.00019841270113829523], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0], [0.0, 0.0, 0.0, -1.0]]
[[0.284, 0.284, 1.0, 1.0], [0.537, 0.661, 1.0, 1.0], [0.328, 0.328, 0.328, 1.0], [0.743, 0.743, 0.743, 1.0], [0.464, 0.464, 0.464, 1.0], [0.585, 0.585, 0.585, 1.0], [0.027, 0.027, 0.027, 0.027], [0.845, 0.845, 0.845, 1.0], [0.882, 0.882, 1.0, 1.0], [0.892, 0.892, 0.892, 1.0]]
suff_simple_acc_int  =  0.000 +- 0.000, 0.050 +- 0.150, -0.200 +- 0.400, -0.900 +- 0.300
nec class all_L1  =  0.364 +- 0.186, 0.374 +- 0.197, 0.387 +- 0.205, 0.395 +- 0.205
nec class all_KL  =  0.390 +- 0.218, 0.400 +- 0.230, 0.415 +- 0.237, 0.424 +- 0.237
[[0.13090278208255768, 0.01617063581943512, 0.01850198395550251, 0.01850198395550251], [0.0086805559694767, 0.01026785746216774, 0.01086309552192688, 0.01086309552192688], [0.11537698656320572, 0.11537698656320572, 0.0068948413245379925, 0.007837302051484585], [0.02261904813349247, 0.02261904813349247, 0.02003968320786953, 0.0037698412779718637], [0.07420635223388672, 0.07420635223388672, 0.07301587611436844, 0.01493055559694767], [0.06121031567454338, 0.06121031567454338, 0.008630952797830105, 0.00897817499935627], [0.2541666626930237, 0.2541666626930237, 0.2541666626930237, 0.2541666626930237], [0.01493055559694767, 0.01493055559694767, 0.01493055559694767, 0.0056051588617265224], [0.004662698600441217, 0.004662698600441217, 0.004216270055621862, 0.004265873227268457], [0.01304563507437706, 0.01304563507437706, 0.0018353174673393369, 0.0020833334419876337]]
[[0.614, 0.714, 0.716, 0.716], [0.467, 0.469, 0.468, 0.468], [0.584, 0.584, 0.671, 0.671], [0.242, 0.242, 0.244, 0.258], [0.487, 0.487, 0.488, 0.546], [0.367, 0.367, 0.415, 0.417], [0.764, 0.764, 0.764, 0.764], [0.15, 0.15, 0.15, 0.159], [0.126, 0.126, 0.127, 0.128], [0.1, 0.1, 0.109, 0.11]]
nec_acc_int  =  0.070 +- 0.075, 0.059 +- 0.074, 0.041 +- 0.074, 0.033 +- 0.074

Eval split test
suff_simple class all_L1  =  0.888 +- 0.009, 0.889 +- 0.008, 0.900 +- 0.065, 0.990 +- 0.029
suff_simple class all_KL  =  0.853 +- 0.011, 0.856 +- 0.012, 0.874 +- 0.072, 0.987 +- 0.038
[[0.7212046980857849, 0.7259869575500488, -1.0, -1.0], [0.7251729965209961, 0.7252747416496277, -1.0, -1.0], [0.724257230758667, 0.724257230758667, 0.727818489074707, -1.0], [0.7246133685112, 0.7229344844818115, 0.7229344844818115, -1.0], [0.7221713662147522, 0.7221713662147522, 0.7246133685112, -1.0], [0.7212556004524231, 0.7212556004524231, 0.7238502502441406, -1.0], [0.7248168587684631, 0.7248168587684631, 0.7248168587684631, 0.7248168587684631], [0.726037859916687, 0.726037859916687, 0.726037859916687, -1.0], [0.7237993478775024, 0.7237993478775024, 0.47058823704719543, -1.0], [0.7225274443626404, 0.7225274443626404, 0.7232906222343445, -1.0]]
[[0.845, 0.845, 1.0, 1.0], [0.842, 0.876, 1.0, 1.0], [0.866, 0.866, 0.872, 1.0], [0.858, 0.858, 0.855, 1.0], [0.856, 0.856, 0.857, 1.0], [0.848, 0.848, 0.851, 1.0], [0.872, 0.872, 0.872, 0.872], [0.833, 0.833, 0.833, 1.0], [0.85, 0.85, 0.744, 1.0], [0.858, 0.858, 0.86, 1.0]]
suff_simple_acc_int  =  0.724 +- 0.002, 0.724 +- 0.002, 0.354 +- 0.681, -0.828 +- 0.517
nec class all_L1  =  0.072 +- 0.016, 0.075 +- 0.017, 0.085 +- 0.014, 0.092 +- 0.014
nec class all_KL  =  0.090 +- 0.032, 0.097 +- 0.036, 0.120 +- 0.032, 0.142 +- 0.028
[[0.7791734337806702, 0.7499493360519409, 0.7506077885627747, 0.7506077885627747], [0.7560271620750427, 0.7549635171890259, 0.7554193735122681, 0.7554193735122681], [0.7728424072265625, 0.7728424072265625, 0.7513168454170227, 0.7517727017402649], [0.780895471572876, 0.7802370190620422, 0.7651438117027283, 0.752836287021637], [0.7807435393333435, 0.7807435393333435, 0.7742605209350586, 0.750354528427124], [0.7775526642799377, 0.7775526642799377, 0.7522791624069214, 0.7512155771255493], [0.7762864828109741, 0.7762864828109741, 0.7762864828109741, 0.7762864828109741], [0.7829213738441467, 0.7829213738441467, 0.7829213738441467, 0.7555206418037415], [0.755014181137085, 0.755014181137085, 0.7516713738441467, 0.7509116530418396], [0.7739059925079346, 0.7739059925079346, 0.7515194416046143, 0.7502532601356506]]
[[0.074, 0.141, 0.158, 0.158], [0.157, 0.162, 0.163, 0.163], [0.067, 0.067, 0.117, 0.131], [0.071, 0.072, 0.092, 0.138], [0.075, 0.075, 0.083, 0.153], [0.074, 0.074, 0.135, 0.146], [0.067, 0.067, 0.067, 0.067], [0.1, 0.1, 0.1, 0.167], [0.145, 0.145, 0.158, 0.16], [0.07, 0.07, 0.125, 0.132]]
nec_acc_int  =  0.774 +- 0.009, 0.770 +- 0.012, 0.761 +- 0.012, 0.755 +- 0.007


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.277 +- 0.014, 0.301 +- 0.062, 0.393 +- 0.167, 0.651 +- 0.129
Faith. Armon (L1)= 		  =  0.249 +- 0.006, 0.265 +- 0.047, 0.333 +- 0.126, 0.524 +- 0.106
Faith. GMean (L1)= 	  =  0.262 +- 0.008, 0.283 +- 0.054, 0.362 +- 0.144, 0.584 +- 0.116
Faith. Aritm (KL)= 		  =  0.272 +- 0.032, 0.312 +- 0.097, 0.433 +- 0.216, 0.760 +- 0.168
Faith. Armon (KL)= 		  =  0.038 +- 0.012, 0.094 +- 0.162, 0.255 +- 0.308, 0.700 +- 0.222
Faith. GMean (KL)= 	  =  0.100 +- 0.017, 0.153 +- 0.143, 0.310 +- 0.283, 0.725 +- 0.209

Eval split val
Faith. Aritm (L1)= 		  =  0.475 +- 0.031, 0.486 +- 0.040, 0.547 +- 0.121, 0.655 +- 0.127
Faith. Armon (L1)= 		  =  0.357 +- 0.112, 0.364 +- 0.120, 0.412 +- 0.180, 0.479 +- 0.221
Faith. GMean (L1)= 	  =  0.406 +- 0.069, 0.415 +- 0.080, 0.468 +- 0.150, 0.553 +- 0.184
Faith. Aritm (KL)= 		  =  0.474 +- 0.032, 0.486 +- 0.040, 0.552 +- 0.131, 0.663 +- 0.137
Faith. Armon (KL)= 		  =  0.331 +- 0.140, 0.337 +- 0.147, 0.397 +- 0.218, 0.473 +- 0.263
Faith. GMean (KL)= 	  =  0.385 +- 0.101, 0.394 +- 0.110, 0.456 +- 0.186, 0.547 +- 0.223

Eval split test
Faith. Aritm (L1)= 		  =  0.480 +- 0.005, 0.482 +- 0.007, 0.492 +- 0.034, 0.541 +- 0.021
Faith. Armon (L1)= 		  =  0.133 +- 0.027, 0.138 +- 0.029, 0.155 +- 0.024, 0.168 +- 0.024
Faith. GMean (L1)= 	  =  0.251 +- 0.026, 0.257 +- 0.028, 0.276 +- 0.027, 0.301 +- 0.027
Faith. Aritm (KL)= 		  =  0.471 +- 0.014, 0.477 +- 0.018, 0.497 +- 0.044, 0.564 +- 0.032
Faith. Armon (KL)= 		  =  0.161 +- 0.050, 0.173 +- 0.056, 0.209 +- 0.051, 0.247 +- 0.045
Faith. GMean (KL)= 	  =  0.273 +- 0.044, 0.284 +- 0.050, 0.321 +- 0.050, 0.372 +- 0.046
Computed for split load_split = id



Completed in  0:39:36.981530  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.01 RANDOM
DONE all :)
