nohup: ignoring input
Time to compute metrics!
The PID of this script is: 961078
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 08:56:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 08:56:32 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 08:57:07 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 08:57:19 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 08:57:29 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 08:57:45 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 08:58:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 08:58:03 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 08:58:09 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.763
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.721
SUFF++ for r=0.3 class 0.0 = 0.754 +- 0.125 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 class 1.0 = 0.824 +- 0.125 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all KL = 0.89 +- 0.125 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.148 (in-sample avg dev_std = 0.255)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.859
SUFF++ for r=0.6 class 0.0 = 0.734 +- 0.111 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.6 class 1.0 = 0.937 +- 0.111 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.6 all KL = 0.943 +- 0.111 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.6 all L1 = 0.913 +- 0.141 (in-sample avg dev_std = 0.165)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.905
SUFF++ for r=0.9 class 0.0 = 0.82 +- 0.054 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.975 +- 0.054 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.98 +- 0.054 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.097 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.632
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.606
SUFF++ for r=0.3 class 0.0 = 0.746 +- 0.132 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 1.0 = 0.779 +- 0.132 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all KL = 0.869 +- 0.132 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all L1 = 0.773 +- 0.144 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.709
SUFF++ for r=0.6 class 0.0 = 0.753 +- 0.121 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 class 1.0 = 0.873 +- 0.121 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all KL = 0.913 +- 0.121 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.165 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.745
SUFF++ for r=0.9 class 0.0 = 0.85 +- 0.076 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.9 class 1.0 = 0.942 +- 0.076 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.9 all KL = 0.964 +- 0.076 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.9 all L1 = 0.927 +- 0.119 (in-sample avg dev_std = 0.137)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.763
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.705
NEC for r=0.3 class 0.0 = 0.377 +- 0.199 (in-sample avg dev_std = 0.288)
NEC for r=0.3 class 1.0 = 0.257 +- 0.199 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all KL = 0.206 +- 0.199 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all L1 = 0.271 +- 0.189 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.858
NEC for r=0.6 class 0.0 = 0.318 +- 0.131 (in-sample avg dev_std = 0.177)
NEC for r=0.6 class 1.0 = 0.074 +- 0.131 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all KL = 0.076 +- 0.131 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all L1 = 0.103 +- 0.156 (in-sample avg dev_std = 0.177)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.876
NEC for r=0.9 class 0.0 = 0.259 +- 0.103 (in-sample avg dev_std = 0.144)
NEC for r=0.9 class 1.0 = 0.036 +- 0.103 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all KL = 0.04 +- 0.103 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all L1 = 0.062 +- 0.133 (in-sample avg dev_std = 0.144)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.881
NEC for r=1.0 class 0.0 = 0.268 +- 0.104 (in-sample avg dev_std = 0.150)
NEC for r=1.0 class 1.0 = 0.033 +- 0.104 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all KL = 0.039 +- 0.104 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all L1 = 0.06 +- 0.133 (in-sample avg dev_std = 0.150)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.632
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0.0 = 0.364 +- 0.203 (in-sample avg dev_std = 0.305)
NEC for r=0.3 class 1.0 = 0.322 +- 0.203 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all KL = 0.23 +- 0.203 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all L1 = 0.329 +- 0.189 (in-sample avg dev_std = 0.305)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.719
NEC for r=0.6 class 0.0 = 0.271 +- 0.143 (in-sample avg dev_std = 0.219)
NEC for r=0.6 class 1.0 = 0.149 +- 0.143 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all KL = 0.112 +- 0.143 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all L1 = 0.169 +- 0.180 (in-sample avg dev_std = 0.219)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.742
NEC for r=0.9 class 0.0 = 0.187 +- 0.098 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1.0 = 0.076 +- 0.098 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.054 +- 0.098 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.094 +- 0.143 (in-sample avg dev_std = 0.163)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.773
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.746
NEC for r=1.0 class 0.0 = 0.188 +- 0.104 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.075 +- 0.104 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.053 +- 0.104 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.094 +- 0.149 (in-sample avg dev_std = 0.159)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:01:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:01:39 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:02:11 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:02:21 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:02:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:02:46 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:03:05 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:03:09 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.702
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.601
SUFF++ for r=0.3 class 0.0 = 0.77 +- 0.135 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 class 1.0 = 0.776 +- 0.135 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all KL = 0.865 +- 0.135 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.120 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.822
SUFF++ for r=0.6 class 0.0 = 0.787 +- 0.123 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.6 class 1.0 = 0.894 +- 0.123 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.6 all KL = 0.92 +- 0.123 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.138 (in-sample avg dev_std = 0.178)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.921
SUFF++ for r=0.9 class 0.0 = 0.894 +- 0.034 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 class 1.0 = 0.983 +- 0.034 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 all KL = 0.991 +- 0.034 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 all L1 = 0.973 +- 0.062 (in-sample avg dev_std = 0.087)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.599
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.574
SUFF++ for r=0.3 class 0.0 = 0.774 +- 0.116 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.3 class 1.0 = 0.776 +- 0.116 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.3 all KL = 0.884 +- 0.116 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.110 (in-sample avg dev_std = 0.260)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.685
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.662
SUFF++ for r=0.6 class 0.0 = 0.798 +- 0.121 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 class 1.0 = 0.849 +- 0.121 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 all KL = 0.909 +- 0.121 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 all L1 = 0.84 +- 0.137 (in-sample avg dev_std = 0.208)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.749
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.744
SUFF++ for r=0.9 class 0.0 = 0.908 +- 0.050 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 1.0 = 0.953 +- 0.050 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all KL = 0.981 +- 0.050 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.084 (in-sample avg dev_std = 0.125)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.685
NEC for r=0.3 class 0.0 = 0.213 +- 0.099 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 1.0 = 0.183 +- 0.099 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all KL = 0.087 +- 0.099 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all L1 = 0.187 +- 0.126 (in-sample avg dev_std = 0.213)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.842
NEC for r=0.6 class 0.0 = 0.224 +- 0.099 (in-sample avg dev_std = 0.181)
NEC for r=0.6 class 1.0 = 0.087 +- 0.099 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all KL = 0.058 +- 0.099 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all L1 = 0.103 +- 0.130 (in-sample avg dev_std = 0.181)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.894
NEC for r=0.9 class 0.0 = 0.281 +- 0.117 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 1.0 = 0.05 +- 0.117 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all KL = 0.053 +- 0.117 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all L1 = 0.077 +- 0.137 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.896
NEC for r=1.0 class 0.0 = 0.297 +- 0.120 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1.0 = 0.045 +- 0.120 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.052 +- 0.120 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.075 +- 0.141 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0.0 = 0.211 +- 0.115 (in-sample avg dev_std = 0.230)
NEC for r=0.3 class 1.0 = 0.212 +- 0.115 (in-sample avg dev_std = 0.230)
NEC for r=0.3 all KL = 0.099 +- 0.115 (in-sample avg dev_std = 0.230)
NEC for r=0.3 all L1 = 0.212 +- 0.122 (in-sample avg dev_std = 0.230)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.685
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.666
NEC for r=0.6 class 0.0 = 0.2 +- 0.118 (in-sample avg dev_std = 0.218)
NEC for r=0.6 class 1.0 = 0.143 +- 0.118 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all KL = 0.083 +- 0.118 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all L1 = 0.153 +- 0.141 (in-sample avg dev_std = 0.218)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.749
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.723
NEC for r=0.9 class 0.0 = 0.24 +- 0.124 (in-sample avg dev_std = 0.203)
NEC for r=0.9 class 1.0 = 0.112 +- 0.124 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all KL = 0.078 +- 0.124 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all L1 = 0.133 +- 0.164 (in-sample avg dev_std = 0.203)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.753
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.729
NEC for r=1.0 class 0.0 = 0.234 +- 0.134 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1.0 = 0.111 +- 0.134 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.082 +- 0.134 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.132 +- 0.170 (in-sample avg dev_std = 0.205)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:06:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:06:29 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:10 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:20 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:36 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:07:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:07:52 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:07:57 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.725
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.68
SUFF++ for r=0.3 class 0.0 = 0.776 +- 0.092 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 1.0 = 0.808 +- 0.092 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all KL = 0.913 +- 0.092 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all L1 = 0.804 +- 0.119 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.903
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.847
SUFF++ for r=0.6 class 0.0 = 0.721 +- 0.086 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.6 class 1.0 = 0.917 +- 0.086 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.6 all KL = 0.943 +- 0.086 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.134 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.908
SUFF++ for r=0.9 class 0.0 = 0.8 +- 0.050 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 class 1.0 = 0.969 +- 0.050 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all KL = 0.98 +- 0.050 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all L1 = 0.95 +- 0.100 (in-sample avg dev_std = 0.111)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.588
SUFF++ for r=0.3 class 0.0 = 0.782 +- 0.094 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 class 1.0 = 0.787 +- 0.094 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all KL = 0.904 +- 0.094 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all L1 = 0.786 +- 0.112 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.694
SUFF++ for r=0.6 class 0.0 = 0.757 +- 0.083 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 class 1.0 = 0.855 +- 0.083 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all KL = 0.925 +- 0.083 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all L1 = 0.839 +- 0.143 (in-sample avg dev_std = 0.195)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.752
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0.0 = 0.841 +- 0.054 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.054 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all KL = 0.968 +- 0.054 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all L1 = 0.917 +- 0.112 (in-sample avg dev_std = 0.129)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.725
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.702
NEC for r=0.3 class 0.0 = 0.308 +- 0.157 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1.0 = 0.289 +- 0.157 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.165 +- 0.157 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.291 +- 0.154 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.903
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.857
NEC for r=0.6 class 0.0 = 0.284 +- 0.107 (in-sample avg dev_std = 0.161)
NEC for r=0.6 class 1.0 = 0.096 +- 0.107 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all KL = 0.072 +- 0.107 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all L1 = 0.118 +- 0.139 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.89
NEC for r=0.9 class 0.0 = 0.233 +- 0.080 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.042 +- 0.080 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.035 +- 0.080 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.064 +- 0.113 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.9
NEC for r=1.0 class 0.0 = 0.219 +- 0.070 (in-sample avg dev_std = 0.117)
NEC for r=1.0 class 1.0 = 0.035 +- 0.070 (in-sample avg dev_std = 0.117)
NEC for r=1.0 all KL = 0.03 +- 0.070 (in-sample avg dev_std = 0.117)
NEC for r=1.0 all L1 = 0.056 +- 0.107 (in-sample avg dev_std = 0.117)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.608
NEC for r=0.3 class 0.0 = 0.284 +- 0.156 (in-sample avg dev_std = 0.265)
NEC for r=0.3 class 1.0 = 0.304 +- 0.156 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.159 +- 0.156 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.301 +- 0.149 (in-sample avg dev_std = 0.265)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.703
NEC for r=0.6 class 0.0 = 0.238 +- 0.097 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 1.0 = 0.153 +- 0.097 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.081 +- 0.097 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.167 +- 0.142 (in-sample avg dev_std = 0.191)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.752
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.714
NEC for r=0.9 class 0.0 = 0.186 +- 0.074 (in-sample avg dev_std = 0.142)
NEC for r=0.9 class 1.0 = 0.088 +- 0.074 (in-sample avg dev_std = 0.142)
NEC for r=0.9 all KL = 0.048 +- 0.074 (in-sample avg dev_std = 0.142)
NEC for r=0.9 all L1 = 0.104 +- 0.123 (in-sample avg dev_std = 0.142)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.751
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.715
NEC for r=1.0 class 0.0 = 0.165 +- 0.072 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1.0 = 0.08 +- 0.072 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.042 +- 0.072 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.094 +- 0.121 (in-sample avg dev_std = 0.142)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:11:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:11:41 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:12:13 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:12:26 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:12:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:12:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:13:07 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:13:11 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.704
SUFF++ for r=0.3 class 0.0 = 0.804 +- 0.082 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 1.0 = 0.791 +- 0.082 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 all KL = 0.914 +- 0.082 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 all L1 = 0.792 +- 0.102 (in-sample avg dev_std = 0.252)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.843
SUFF++ for r=0.6 class 0.0 = 0.755 +- 0.082 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 class 1.0 = 0.899 +- 0.082 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all KL = 0.941 +- 0.082 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all L1 = 0.882 +- 0.128 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.898
SUFF++ for r=0.9 class 0.0 = 0.829 +- 0.052 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 class 1.0 = 0.963 +- 0.052 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 all KL = 0.977 +- 0.052 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.093 (in-sample avg dev_std = 0.122)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.581
SUFF++ for r=0.3 class 0.0 = 0.792 +- 0.091 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 1.0 = 0.774 +- 0.091 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all KL = 0.91 +- 0.091 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all L1 = 0.777 +- 0.105 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.692
SUFF++ for r=0.6 class 0.0 = 0.772 +- 0.084 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.838 +- 0.084 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.92 +- 0.084 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.827 +- 0.138 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.726
SUFF++ for r=0.9 class 0.0 = 0.869 +- 0.062 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.062 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all KL = 0.964 +- 0.062 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all L1 = 0.915 +- 0.105 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.705
NEC for r=0.3 class 0.0 = 0.279 +- 0.143 (in-sample avg dev_std = 0.273)
NEC for r=0.3 class 1.0 = 0.306 +- 0.143 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.155 +- 0.143 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.303 +- 0.138 (in-sample avg dev_std = 0.273)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.849
NEC for r=0.6 class 0.0 = 0.25 +- 0.125 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 1.0 = 0.13 +- 0.125 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all KL = 0.092 +- 0.125 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all L1 = 0.144 +- 0.138 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.234 +- 0.088 (in-sample avg dev_std = 0.138)
NEC for r=0.9 class 1.0 = 0.058 +- 0.088 (in-sample avg dev_std = 0.138)
NEC for r=0.9 all KL = 0.048 +- 0.088 (in-sample avg dev_std = 0.138)
NEC for r=0.9 all L1 = 0.078 +- 0.119 (in-sample avg dev_std = 0.138)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.88
NEC for r=1.0 class 0.0 = 0.221 +- 0.089 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 1.0 = 0.05 +- 0.089 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all KL = 0.042 +- 0.089 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all L1 = 0.07 +- 0.114 (in-sample avg dev_std = 0.139)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 0.0 = 0.289 +- 0.130 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1.0 = 0.3 +- 0.130 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.139 +- 0.130 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.299 +- 0.135 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.691
NEC for r=0.6 class 0.0 = 0.262 +- 0.127 (in-sample avg dev_std = 0.232)
NEC for r=0.6 class 1.0 = 0.205 +- 0.127 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all KL = 0.119 +- 0.127 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all L1 = 0.214 +- 0.148 (in-sample avg dev_std = 0.232)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.721
NEC for r=0.9 class 0.0 = 0.202 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=0.9 class 1.0 = 0.119 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all KL = 0.075 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all L1 = 0.133 +- 0.136 (in-sample avg dev_std = 0.176)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.743
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0.0 = 0.201 +- 0.105 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 1.0 = 0.106 +- 0.105 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all KL = 0.064 +- 0.105 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all L1 = 0.122 +- 0.140 (in-sample avg dev_std = 0.175)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:16:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:16:24 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:16:54 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:13 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:29 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:17:45 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:17:49 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
SUFF++ for r=0.3 class 0.0 = 0.765 +- 0.111 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 class 1.0 = 0.74 +- 0.111 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 all KL = 0.868 +- 0.111 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 all L1 = 0.743 +- 0.118 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.826
SUFF++ for r=0.6 class 0.0 = 0.718 +- 0.121 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 class 1.0 = 0.872 +- 0.121 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 all KL = 0.911 +- 0.121 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 all L1 = 0.855 +- 0.143 (in-sample avg dev_std = 0.216)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.916
SUFF++ for r=0.9 class 0.0 = 0.83 +- 0.059 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.059 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all KL = 0.976 +- 0.059 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.094 (in-sample avg dev_std = 0.116)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.556
SUFF++ for r=0.3 class 0.0 = 0.743 +- 0.106 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 1.0 = 0.745 +- 0.106 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all KL = 0.875 +- 0.106 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all L1 = 0.744 +- 0.113 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.698
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.662
SUFF++ for r=0.6 class 0.0 = 0.753 +- 0.108 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.803 +- 0.108 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.892 +- 0.108 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.795 +- 0.144 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.717
SUFF++ for r=0.9 class 0.0 = 0.873 +- 0.068 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 class 1.0 = 0.916 +- 0.068 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all KL = 0.963 +- 0.068 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.110 (in-sample avg dev_std = 0.136)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0.0 = 0.304 +- 0.188 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1.0 = 0.364 +- 0.188 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.221 +- 0.188 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.357 +- 0.156 (in-sample avg dev_std = 0.320)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.845
NEC for r=0.6 class 0.0 = 0.268 +- 0.141 (in-sample avg dev_std = 0.214)
NEC for r=0.6 class 1.0 = 0.156 +- 0.141 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all KL = 0.113 +- 0.141 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all L1 = 0.169 +- 0.153 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.899
NEC for r=0.9 class 0.0 = 0.215 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.065 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.056 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.082 +- 0.115 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.902
NEC for r=1.0 class 0.0 = 0.22 +- 0.098 (in-sample avg dev_std = 0.140)
NEC for r=1.0 class 1.0 = 0.055 +- 0.098 (in-sample avg dev_std = 0.140)
NEC for r=1.0 all KL = 0.048 +- 0.098 (in-sample avg dev_std = 0.140)
NEC for r=1.0 all L1 = 0.075 +- 0.113 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.574
NEC for r=0.3 class 0.0 = 0.321 +- 0.164 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 1.0 = 0.336 +- 0.164 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all KL = 0.187 +- 0.164 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all L1 = 0.334 +- 0.148 (in-sample avg dev_std = 0.306)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.698
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.657
NEC for r=0.6 class 0.0 = 0.28 +- 0.141 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 1.0 = 0.224 +- 0.141 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all KL = 0.135 +- 0.141 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all L1 = 0.233 +- 0.151 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.693
NEC for r=0.9 class 0.0 = 0.197 +- 0.122 (in-sample avg dev_std = 0.185)
NEC for r=0.9 class 1.0 = 0.134 +- 0.122 (in-sample avg dev_std = 0.185)
NEC for r=0.9 all KL = 0.083 +- 0.122 (in-sample avg dev_std = 0.185)
NEC for r=0.9 all L1 = 0.144 +- 0.134 (in-sample avg dev_std = 0.185)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.747
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0.0 = 0.202 +- 0.116 (in-sample avg dev_std = 0.181)
NEC for r=1.0 class 1.0 = 0.121 +- 0.116 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all KL = 0.073 +- 0.116 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all L1 = 0.135 +- 0.144 (in-sample avg dev_std = 0.181)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.89, 0.943, 0.98, 1.0], 'all_L1': [0.816, 0.913, 0.957, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.865, 0.92, 0.991, 1.0], 'all_L1': [0.776, 0.881, 0.973, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.913, 0.943, 0.98, 1.0], 'all_L1': [0.804, 0.894, 0.95, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.914, 0.941, 0.977, 1.0], 'all_L1': [0.792, 0.882, 0.948, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.911, 0.976, 1.0], 'all_L1': [0.743, 0.855, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.206, 0.076, 0.04, 0.039], 'all_L1': [0.271, 0.103, 0.062, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.058, 0.053, 0.052], 'all_L1': [0.187, 0.103, 0.077, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.072, 0.035, 0.03], 'all_L1': [0.291, 0.118, 0.064, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.092, 0.048, 0.042], 'all_L1': [0.303, 0.144, 0.078, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.221, 0.113, 0.056, 0.048], 'all_L1': [0.357, 0.169, 0.082, 0.075]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.869, 0.913, 0.964, 1.0], 'all_L1': [0.773, 0.853, 0.927, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.909, 0.981, 1.0], 'all_L1': [0.776, 0.84, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.925, 0.968, 1.0], 'all_L1': [0.786, 0.839, 0.917, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.91, 0.92, 0.964, 1.0], 'all_L1': [0.777, 0.827, 0.915, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.875, 0.892, 0.963, 1.0], 'all_L1': [0.744, 0.795, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.23, 0.112, 0.054, 0.053], 'all_L1': [0.329, 0.169, 0.094, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.099, 0.083, 0.078, 0.082], 'all_L1': [0.212, 0.153, 0.133, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.159, 0.081, 0.048, 0.042], 'all_L1': [0.301, 0.167, 0.104, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.139, 0.119, 0.075, 0.064], 'all_L1': [0.299, 0.214, 0.133, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.135, 0.083, 0.073], 'all_L1': [0.334, 0.233, 0.144, 0.135]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.786 +- 0.025, 0.885 +- 0.019, 0.955 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.890 +- 0.021, 0.932 +- 0.013, 0.981 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.673 +- 0.042, 0.839 +- 0.014, 0.910 +- 0.008
nec class all_L1  =  0.282 +- 0.055, 0.127 +- 0.026, 0.073 +- 0.008, 0.067 +- 0.008
nec class all_KL  =  0.167 +- 0.047, 0.082 +- 0.019, 0.046 +- 0.008, 0.042 +- 0.008
nec_acc_int  =  0.698 +- 0.008, 0.850 +- 0.006, 0.888 +- 0.009, 0.892 +- 0.009

Eval split test
suff++ class all_L1  =  0.771 +- 0.014, 0.831 +- 0.020, 0.923 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.888 +- 0.016, 0.912 +- 0.011, 0.968 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.581 +- 0.017, 0.684 +- 0.019, 0.731 +- 0.011
nec class all_L1  =  0.295 +- 0.044, 0.187 +- 0.031, 0.122 +- 0.019, 0.115 +- 0.018
nec class all_KL  =  0.163 +- 0.044, 0.106 +- 0.021, 0.068 +- 0.014, 0.063 +- 0.014
nec_acc_int  =  0.599 +- 0.018, 0.687 +- 0.023, 0.718 +- 0.016, 0.723 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.534 +- 0.026, 0.506 +- 0.008, 0.514 +- 0.006, 0.534 +- 0.004
Faith. Armon (L1)= 		  =  0.411 +- 0.060, 0.222 +- 0.038, 0.135 +- 0.014, 0.126 +- 0.014
Faith. GMean (L1)= 	  =  0.468 +- 0.046, 0.334 +- 0.030, 0.263 +- 0.015, 0.259 +- 0.015
Faith. Aritm (KL)= 		  =  0.528 +- 0.027, 0.507 +- 0.009, 0.514 +- 0.005, 0.521 +- 0.004
Faith. Armon (KL)= 		  =  0.278 +- 0.068, 0.150 +- 0.031, 0.088 +- 0.014, 0.081 +- 0.014
Faith. GMean (KL)= 	  =  0.381 +- 0.058, 0.275 +- 0.031, 0.213 +- 0.018, 0.205 +- 0.019

Eval split test
Faith. Aritm (L1)= 		  =  0.533 +- 0.020, 0.509 +- 0.008, 0.522 +- 0.011, 0.558 +- 0.009
Faith. Armon (L1)= 		  =  0.425 +- 0.047, 0.304 +- 0.039, 0.214 +- 0.030, 0.206 +- 0.029
Faith. GMean (L1)= 	  =  0.475 +- 0.036, 0.393 +- 0.028, 0.334 +- 0.027, 0.339 +- 0.027
Faith. Aritm (KL)= 		  =  0.526 +- 0.019, 0.509 +- 0.008, 0.518 +- 0.008, 0.531 +- 0.007
Faith. Armon (KL)= 		  =  0.272 +- 0.062, 0.189 +- 0.034, 0.126 +- 0.024, 0.118 +- 0.025
Faith. GMean (KL)= 	  =  0.376 +- 0.050, 0.309 +- 0.030, 0.254 +- 0.027, 0.249 +- 0.029
Computed for split load_split = id



Completed in  0:24:43.429534  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:21:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:21:27 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:21:58 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:18 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:34 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:22:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1420
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2255
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2246
OOD Validation ROC-AUC: 0.6374
OOD Validation Loss: 0.4787
OOD Test ROC-AUC: 0.6853
OOD Test Loss: 0.5698

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9140
Train Loss: 0.2226
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2385
ID Test ROC-AUC: 0.9039
ID Test Loss: 0.2385
OOD Validation ROC-AUC: 0.6822
OOD Validation Loss: 0.3129
OOD Test ROC-AUC: 0.7143
OOD Test Loss: 0.4523

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6853 0.9039 0.7143 0.9010 0.6822[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:22:51 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:22:56 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.727
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.296 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 class 1.0 = 0.892 +- 0.296 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all KL = 0.75 +- 0.296 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all L1 = 0.871 +- 0.171 (in-sample avg dev_std = 0.333)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.781
SUFF++ for r=0.6 class 0.0 = 0.768 +- 0.205 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 1.0 = 0.941 +- 0.205 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all KL = 0.868 +- 0.205 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all L1 = 0.921 +- 0.138 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0.0 = 0.728 +- 0.132 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 class 1.0 = 0.944 +- 0.132 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all KL = 0.941 +- 0.132 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.137 (in-sample avg dev_std = 0.160)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.592
SUFF++ for r=0.3 class 0.0 = 0.759 +- 0.290 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.3 class 1.0 = 0.82 +- 0.290 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.3 all KL = 0.711 +- 0.290 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.3 all L1 = 0.81 +- 0.202 (in-sample avg dev_std = 0.374)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.682
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.659
SUFF++ for r=0.6 class 0.0 = 0.829 +- 0.216 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 class 1.0 = 0.892 +- 0.216 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 all KL = 0.834 +- 0.216 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.158 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.673
SUFF++ for r=0.9 class 0.0 = 0.77 +- 0.138 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 class 1.0 = 0.879 +- 0.138 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all KL = 0.918 +- 0.138 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.160 (in-sample avg dev_std = 0.203)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.734
NEC for r=0.3 class 0.0 = 0.358 +- 0.314 (in-sample avg dev_std = 0.311)
NEC for r=0.3 class 1.0 = 0.113 +- 0.314 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.236 +- 0.314 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.142 +- 0.206 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.803
NEC for r=0.6 class 0.0 = 0.277 +- 0.222 (in-sample avg dev_std = 0.226)
NEC for r=0.6 class 1.0 = 0.064 +- 0.222 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all KL = 0.144 +- 0.222 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all L1 = 0.089 +- 0.150 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.82
NEC for r=0.9 class 0.0 = 0.385 +- 0.170 (in-sample avg dev_std = 0.208)
NEC for r=0.9 class 1.0 = 0.085 +- 0.170 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all KL = 0.113 +- 0.170 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all L1 = 0.12 +- 0.170 (in-sample avg dev_std = 0.208)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.827
NEC for r=1.0 class 0.0 = 0.381 +- 0.157 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1.0 = 0.093 +- 0.157 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.108 +- 0.157 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.127 +- 0.166 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.602
NEC for r=0.3 class 0.0 = 0.258 +- 0.309 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 1.0 = 0.189 +- 0.309 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all KL = 0.287 +- 0.309 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all L1 = 0.2 +- 0.229 (in-sample avg dev_std = 0.335)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.682
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.203 +- 0.237 (in-sample avg dev_std = 0.268)
NEC for r=0.6 class 1.0 = 0.124 +- 0.237 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all KL = 0.193 +- 0.237 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all L1 = 0.137 +- 0.172 (in-sample avg dev_std = 0.268)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0.0 = 0.301 +- 0.172 (in-sample avg dev_std = 0.261)
NEC for r=0.9 class 1.0 = 0.174 +- 0.172 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all KL = 0.152 +- 0.172 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all L1 = 0.195 +- 0.177 (in-sample avg dev_std = 0.261)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.736
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.671
NEC for r=1.0 class 0.0 = 0.332 +- 0.171 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 1.0 = 0.194 +- 0.171 (in-sample avg dev_std = 0.289)
NEC for r=1.0 all KL = 0.155 +- 0.171 (in-sample avg dev_std = 0.289)
NEC for r=1.0 all L1 = 0.217 +- 0.183 (in-sample avg dev_std = 0.289)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:26:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:26:25 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:26:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:05 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:32 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:27:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1412
ID Validation ROC-AUC: 0.9211
ID Validation Loss: 0.2263
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2237
OOD Validation ROC-AUC: 0.6449
OOD Validation Loss: 0.4664
OOD Test ROC-AUC: 0.6906
OOD Test Loss: 0.5564

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9194
Train Loss: 0.2142
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2357
ID Test ROC-AUC: 0.9053
ID Test Loss: 0.2328
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.3224
OOD Test ROC-AUC: 0.7183
OOD Test Loss: 0.4429

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6906 0.9053 0.7183 0.9010 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:27:49 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:27:53 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.719
SUFF++ for r=0.3 class 0.0 = 0.682 +- 0.298 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 1.0 = 0.871 +- 0.298 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 all KL = 0.726 +- 0.298 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 all L1 = 0.849 +- 0.188 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.805
SUFF++ for r=0.6 class 0.0 = 0.734 +- 0.235 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 class 1.0 = 0.937 +- 0.235 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 all KL = 0.835 +- 0.235 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 all L1 = 0.913 +- 0.131 (in-sample avg dev_std = 0.240)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.857
SUFF++ for r=0.9 class 0.0 = 0.688 +- 0.170 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.170 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 all KL = 0.913 +- 0.170 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.149 (in-sample avg dev_std = 0.179)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.591
SUFF++ for r=0.3 class 0.0 = 0.731 +- 0.291 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1.0 = 0.795 +- 0.291 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.688 +- 0.291 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.785 +- 0.213 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0.0 = 0.808 +- 0.230 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 1.0 = 0.888 +- 0.230 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all KL = 0.814 +- 0.230 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all L1 = 0.875 +- 0.152 (in-sample avg dev_std = 0.274)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.693
SUFF++ for r=0.9 class 0.0 = 0.748 +- 0.172 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.9 class 1.0 = 0.858 +- 0.172 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.9 all KL = 0.882 +- 0.172 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.9 all L1 = 0.839 +- 0.165 (in-sample avg dev_std = 0.220)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.737
NEC for r=0.3 class 0.0 = 0.348 +- 0.303 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 1.0 = 0.117 +- 0.303 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all KL = 0.224 +- 0.303 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all L1 = 0.144 +- 0.218 (in-sample avg dev_std = 0.274)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.824
NEC for r=0.6 class 0.0 = 0.285 +- 0.228 (in-sample avg dev_std = 0.222)
NEC for r=0.6 class 1.0 = 0.057 +- 0.228 (in-sample avg dev_std = 0.222)
NEC for r=0.6 all KL = 0.141 +- 0.228 (in-sample avg dev_std = 0.222)
NEC for r=0.6 all L1 = 0.084 +- 0.143 (in-sample avg dev_std = 0.222)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.848
NEC for r=0.9 class 0.0 = 0.373 +- 0.175 (in-sample avg dev_std = 0.221)
NEC for r=0.9 class 1.0 = 0.086 +- 0.175 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all KL = 0.123 +- 0.175 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all L1 = 0.12 +- 0.158 (in-sample avg dev_std = 0.221)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.837
NEC for r=1.0 class 0.0 = 0.398 +- 0.176 (in-sample avg dev_std = 0.238)
NEC for r=1.0 class 1.0 = 0.103 +- 0.176 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all KL = 0.131 +- 0.176 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all L1 = 0.137 +- 0.168 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
NEC for r=0.3 class 0.0 = 0.28 +- 0.318 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 1.0 = 0.206 +- 0.318 (in-sample avg dev_std = 0.336)
NEC for r=0.3 all KL = 0.298 +- 0.318 (in-sample avg dev_std = 0.336)
NEC for r=0.3 all L1 = 0.219 +- 0.247 (in-sample avg dev_std = 0.336)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.643
NEC for r=0.6 class 0.0 = 0.198 +- 0.234 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 1.0 = 0.118 +- 0.234 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all KL = 0.18 +- 0.234 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all L1 = 0.132 +- 0.167 (in-sample avg dev_std = 0.265)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0.0 = 0.288 +- 0.178 (in-sample avg dev_std = 0.267)
NEC for r=0.9 class 1.0 = 0.176 +- 0.178 (in-sample avg dev_std = 0.267)
NEC for r=0.9 all KL = 0.162 +- 0.178 (in-sample avg dev_std = 0.267)
NEC for r=0.9 all L1 = 0.194 +- 0.177 (in-sample avg dev_std = 0.267)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.734
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.667
NEC for r=1.0 class 0.0 = 0.315 +- 0.162 (in-sample avg dev_std = 0.281)
NEC for r=1.0 class 1.0 = 0.198 +- 0.162 (in-sample avg dev_std = 0.281)
NEC for r=1.0 all KL = 0.152 +- 0.162 (in-sample avg dev_std = 0.281)
NEC for r=1.0 all L1 = 0.218 +- 0.178 (in-sample avg dev_std = 0.281)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:31:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:31:17 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:31:49 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:00 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:12 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ROC-AUC: 0.9700
Train Loss: 0.1384
ID Validation ROC-AUC: 0.9239
ID Validation Loss: 0.2236
ID Test ROC-AUC: 0.9258
ID Test Loss: 0.2238
OOD Validation ROC-AUC: 0.6361
OOD Validation Loss: 0.4564
OOD Test ROC-AUC: 0.6863
OOD Test Loss: 0.5633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9076
Train Loss: 0.2268
ID Validation ROC-AUC: 0.8921
ID Validation Loss: 0.2443
ID Test ROC-AUC: 0.8980
ID Test Loss: 0.2413
OOD Validation ROC-AUC: 0.6868
OOD Validation Loss: 0.3111
OOD Test ROC-AUC: 0.7174
OOD Test Loss: 0.4442

[0m[1;37mINFO[0m: [1mChartInfo 0.9258 0.6863 0.8980 0.7174 0.8921 0.6868[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:32:47 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:32:52 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.768
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.731
SUFF++ for r=0.3 class 0.0 = 0.767 +- 0.279 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 class 1.0 = 0.919 +- 0.279 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 all KL = 0.785 +- 0.279 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 all L1 = 0.902 +- 0.149 (in-sample avg dev_std = 0.290)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.778
SUFF++ for r=0.6 class 0.0 = 0.78 +- 0.193 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 class 1.0 = 0.951 +- 0.193 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all KL = 0.874 +- 0.193 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all L1 = 0.931 +- 0.119 (in-sample avg dev_std = 0.206)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0.0 = 0.722 +- 0.143 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1.0 = 0.944 +- 0.143 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.93 +- 0.143 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.918 +- 0.136 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.615
SUFF++ for r=0.3 class 0.0 = 0.785 +- 0.289 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 class 1.0 = 0.862 +- 0.289 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all KL = 0.733 +- 0.289 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all L1 = 0.849 +- 0.174 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.639
SUFF++ for r=0.6 class 0.0 = 0.837 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 class 1.0 = 0.905 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all KL = 0.837 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all L1 = 0.893 +- 0.149 (in-sample avg dev_std = 0.243)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.726
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.684
SUFF++ for r=0.9 class 0.0 = 0.77 +- 0.144 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 1.0 = 0.878 +- 0.144 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all KL = 0.909 +- 0.144 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.164 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.768
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.727
NEC for r=0.3 class 0.0 = 0.276 +- 0.275 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 1.0 = 0.068 +- 0.275 (in-sample avg dev_std = 0.243)
NEC for r=0.3 all KL = 0.17 +- 0.275 (in-sample avg dev_std = 0.243)
NEC for r=0.3 all L1 = 0.092 +- 0.169 (in-sample avg dev_std = 0.243)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.798
NEC for r=0.6 class 0.0 = 0.245 +- 0.209 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 1.0 = 0.053 +- 0.209 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all KL = 0.13 +- 0.209 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all L1 = 0.076 +- 0.137 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.833
NEC for r=0.9 class 0.0 = 0.361 +- 0.155 (in-sample avg dev_std = 0.201)
NEC for r=0.9 class 1.0 = 0.074 +- 0.155 (in-sample avg dev_std = 0.201)
NEC for r=0.9 all KL = 0.108 +- 0.155 (in-sample avg dev_std = 0.201)
NEC for r=0.9 all L1 = 0.107 +- 0.155 (in-sample avg dev_std = 0.201)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.822
NEC for r=1.0 class 0.0 = 0.377 +- 0.149 (in-sample avg dev_std = 0.214)
NEC for r=1.0 class 1.0 = 0.087 +- 0.149 (in-sample avg dev_std = 0.214)
NEC for r=1.0 all KL = 0.103 +- 0.149 (in-sample avg dev_std = 0.214)
NEC for r=1.0 all L1 = 0.121 +- 0.164 (in-sample avg dev_std = 0.214)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0.0 = 0.236 +- 0.314 (in-sample avg dev_std = 0.313)
NEC for r=0.3 class 1.0 = 0.139 +- 0.314 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all KL = 0.263 +- 0.314 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all L1 = 0.155 +- 0.200 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.632
NEC for r=0.6 class 0.0 = 0.192 +- 0.238 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1.0 = 0.107 +- 0.238 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.185 +- 0.238 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.121 +- 0.163 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.726
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.667
NEC for r=0.9 class 0.0 = 0.289 +- 0.164 (in-sample avg dev_std = 0.250)
NEC for r=0.9 class 1.0 = 0.161 +- 0.164 (in-sample avg dev_std = 0.250)
NEC for r=0.9 all KL = 0.146 +- 0.164 (in-sample avg dev_std = 0.250)
NEC for r=0.9 all L1 = 0.183 +- 0.177 (in-sample avg dev_std = 0.250)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.729
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.665
NEC for r=1.0 class 0.0 = 0.33 +- 0.168 (in-sample avg dev_std = 0.271)
NEC for r=1.0 class 1.0 = 0.192 +- 0.168 (in-sample avg dev_std = 0.271)
NEC for r=1.0 all KL = 0.148 +- 0.168 (in-sample avg dev_std = 0.271)
NEC for r=1.0 all L1 = 0.215 +- 0.191 (in-sample avg dev_std = 0.271)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:36:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:36:11 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:36:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:36:53 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:03 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:19 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ROC-AUC: 0.9701
Train Loss: 0.1379
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9249
ID Test Loss: 0.2294
OOD Validation ROC-AUC: 0.6427
OOD Validation Loss: 0.4806
OOD Test ROC-AUC: 0.6915
OOD Test Loss: 0.5778

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ROC-AUC: 0.9368
Train Loss: 0.1927
ID Validation ROC-AUC: 0.9098
ID Validation Loss: 0.2281
ID Test ROC-AUC: 0.9159
ID Test Loss: 0.2220
OOD Validation ROC-AUC: 0.6858
OOD Validation Loss: 0.3482
OOD Test ROC-AUC: 0.7149
OOD Test Loss: 0.4585

[0m[1;37mINFO[0m: [1mChartInfo 0.9249 0.6915 0.9159 0.7149 0.9098 0.6858[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:37:34 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:37:39 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.749
SUFF++ for r=0.3 class 0.0 = 0.747 +- 0.247 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.3 class 1.0 = 0.926 +- 0.247 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.3 all KL = 0.825 +- 0.247 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.3 all L1 = 0.905 +- 0.150 (in-sample avg dev_std = 0.258)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.775 +- 0.158 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 class 1.0 = 0.964 +- 0.158 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 all KL = 0.92 +- 0.158 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 all L1 = 0.942 +- 0.122 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.912
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0.0 = 0.723 +- 0.138 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 1.0 = 0.949 +- 0.138 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all KL = 0.937 +- 0.138 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.139 (in-sample avg dev_std = 0.174)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0.0 = 0.807 +- 0.256 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 1.0 = 0.866 +- 0.256 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all KL = 0.778 +- 0.256 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all L1 = 0.856 +- 0.168 (in-sample avg dev_std = 0.324)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.674
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.653
SUFF++ for r=0.6 class 0.0 = 0.84 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 class 1.0 = 0.915 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all KL = 0.887 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all L1 = 0.903 +- 0.146 (in-sample avg dev_std = 0.201)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.721
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.677
SUFF++ for r=0.9 class 0.0 = 0.772 +- 0.149 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 class 1.0 = 0.879 +- 0.149 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 all KL = 0.911 +- 0.149 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.161 (in-sample avg dev_std = 0.209)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0.0 = 0.317 +- 0.268 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 1.0 = 0.079 +- 0.268 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all KL = 0.176 +- 0.268 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all L1 = 0.107 +- 0.183 (in-sample avg dev_std = 0.240)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.817
NEC for r=0.6 class 0.0 = 0.271 +- 0.194 (in-sample avg dev_std = 0.186)
NEC for r=0.6 class 1.0 = 0.047 +- 0.194 (in-sample avg dev_std = 0.186)
NEC for r=0.6 all KL = 0.113 +- 0.194 (in-sample avg dev_std = 0.186)
NEC for r=0.6 all L1 = 0.073 +- 0.139 (in-sample avg dev_std = 0.186)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.912
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.823
NEC for r=0.9 class 0.0 = 0.379 +- 0.171 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 1.0 = 0.073 +- 0.171 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all KL = 0.111 +- 0.171 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all L1 = 0.108 +- 0.164 (in-sample avg dev_std = 0.197)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.831
NEC for r=1.0 class 0.0 = 0.398 +- 0.172 (in-sample avg dev_std = 0.225)
NEC for r=1.0 class 1.0 = 0.083 +- 0.172 (in-sample avg dev_std = 0.225)
NEC for r=1.0 all KL = 0.108 +- 0.172 (in-sample avg dev_std = 0.225)
NEC for r=1.0 all L1 = 0.119 +- 0.173 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.61
NEC for r=0.3 class 0.0 = 0.246 +- 0.293 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1.0 = 0.151 +- 0.293 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.245 +- 0.293 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.167 +- 0.205 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.674
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0.0 = 0.211 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=0.6 class 1.0 = 0.104 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all KL = 0.152 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all L1 = 0.122 +- 0.167 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.721
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.674
NEC for r=0.9 class 0.0 = 0.272 +- 0.160 (in-sample avg dev_std = 0.245)
NEC for r=0.9 class 1.0 = 0.151 +- 0.160 (in-sample avg dev_std = 0.245)
NEC for r=0.9 all KL = 0.131 +- 0.160 (in-sample avg dev_std = 0.245)
NEC for r=0.9 all L1 = 0.171 +- 0.174 (in-sample avg dev_std = 0.245)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.741
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.667
NEC for r=1.0 class 0.0 = 0.318 +- 0.174 (in-sample avg dev_std = 0.273)
NEC for r=1.0 class 1.0 = 0.179 +- 0.174 (in-sample avg dev_std = 0.273)
NEC for r=1.0 all KL = 0.145 +- 0.174 (in-sample avg dev_std = 0.273)
NEC for r=1.0 all L1 = 0.202 +- 0.193 (in-sample avg dev_std = 0.273)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:41:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:41:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:41:39 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:41:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:41:59 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9611
Train Loss: 0.1567
ID Validation ROC-AUC: 0.9233
ID Validation Loss: 0.2180
ID Test ROC-AUC: 0.9240
ID Test Loss: 0.2206
OOD Validation ROC-AUC: 0.6334
OOD Validation Loss: 0.4667
OOD Test ROC-AUC: 0.6879
OOD Test Loss: 0.5492

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9251
Train Loss: 0.2093
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.2367
ID Test ROC-AUC: 0.9102
ID Test Loss: 0.2300
OOD Validation ROC-AUC: 0.6806
OOD Validation Loss: 0.3241
OOD Test ROC-AUC: 0.7074
OOD Test Loss: 0.4616

[0m[1;37mINFO[0m: [1mChartInfo 0.9240 0.6879 0.9102 0.7074 0.9033 0.6806[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:42:31 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:42:35 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.73
SUFF++ for r=0.3 class 0.0 = 0.645 +- 0.288 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1.0 = 0.838 +- 0.288 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.68 +- 0.288 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.178 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.875
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.796
SUFF++ for r=0.6 class 0.0 = 0.727 +- 0.213 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.914 +- 0.213 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.826 +- 0.213 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.892 +- 0.140 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.87
SUFF++ for r=0.9 class 0.0 = 0.731 +- 0.157 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1.0 = 0.921 +- 0.157 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.915 +- 0.157 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.147 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
SUFF++ for r=0.3 class 0.0 = 0.725 +- 0.273 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 1.0 = 0.764 +- 0.273 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all KL = 0.65 +- 0.273 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all L1 = 0.757 +- 0.187 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.657
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
SUFF++ for r=0.6 class 0.0 = 0.818 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 1.0 = 0.863 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all KL = 0.817 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all L1 = 0.856 +- 0.151 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.648
SUFF++ for r=0.9 class 0.0 = 0.765 +- 0.139 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 1.0 = 0.863 +- 0.139 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all KL = 0.903 +- 0.139 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all L1 = 0.847 +- 0.155 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.76
NEC for r=0.3 class 0.0 = 0.375 +- 0.272 (in-sample avg dev_std = 0.281)
NEC for r=0.3 class 1.0 = 0.116 +- 0.272 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all KL = 0.203 +- 0.272 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all L1 = 0.146 +- 0.207 (in-sample avg dev_std = 0.281)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.875
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.312 +- 0.207 (in-sample avg dev_std = 0.221)
NEC for r=0.6 class 1.0 = 0.078 +- 0.207 (in-sample avg dev_std = 0.221)
NEC for r=0.6 all KL = 0.145 +- 0.207 (in-sample avg dev_std = 0.221)
NEC for r=0.6 all L1 = 0.105 +- 0.158 (in-sample avg dev_std = 0.221)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.845
NEC for r=0.9 class 0.0 = 0.357 +- 0.151 (in-sample avg dev_std = 0.208)
NEC for r=0.9 class 1.0 = 0.094 +- 0.151 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all KL = 0.115 +- 0.151 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all L1 = 0.125 +- 0.156 (in-sample avg dev_std = 0.208)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0.0 = 0.358 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1.0 = 0.104 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.108 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.133 +- 0.156 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.604
NEC for r=0.3 class 0.0 = 0.279 +- 0.288 (in-sample avg dev_std = 0.318)
NEC for r=0.3 class 1.0 = 0.201 +- 0.288 (in-sample avg dev_std = 0.318)
NEC for r=0.3 all KL = 0.266 +- 0.288 (in-sample avg dev_std = 0.318)
NEC for r=0.3 all L1 = 0.214 +- 0.228 (in-sample avg dev_std = 0.318)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.657
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.649
NEC for r=0.6 class 0.0 = 0.234 +- 0.205 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 1.0 = 0.137 +- 0.205 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all KL = 0.181 +- 0.205 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all L1 = 0.153 +- 0.170 (in-sample avg dev_std = 0.266)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0.0 = 0.298 +- 0.164 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 1.0 = 0.176 +- 0.164 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all KL = 0.144 +- 0.164 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all L1 = 0.196 +- 0.172 (in-sample avg dev_std = 0.256)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.663
NEC for r=1.0 class 0.0 = 0.306 +- 0.153 (in-sample avg dev_std = 0.267)
NEC for r=1.0 class 1.0 = 0.193 +- 0.153 (in-sample avg dev_std = 0.267)
NEC for r=1.0 all KL = 0.136 +- 0.153 (in-sample avg dev_std = 0.267)
NEC for r=1.0 all L1 = 0.212 +- 0.173 (in-sample avg dev_std = 0.267)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.75, 0.868, 0.941, 1.0], 'all_L1': [0.871, 0.921, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.726, 0.835, 0.913, 1.0], 'all_L1': [0.849, 0.913, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.785, 0.874, 0.93, 1.0], 'all_L1': [0.902, 0.931, 0.918, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.825, 0.92, 0.937, 1.0], 'all_L1': [0.905, 0.942, 0.923, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.826, 0.915, 1.0], 'all_L1': [0.816, 0.892, 0.899, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.236, 0.144, 0.113, 0.108], 'all_L1': [0.142, 0.089, 0.12, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.141, 0.123, 0.131], 'all_L1': [0.144, 0.084, 0.12, 0.137]}), defaultdict(<class 'list'>, {'all_KL': [0.17, 0.13, 0.108, 0.103], 'all_L1': [0.092, 0.076, 0.107, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.176, 0.113, 0.111, 0.108], 'all_L1': [0.107, 0.073, 0.108, 0.119]}), defaultdict(<class 'list'>, {'all_KL': [0.203, 0.145, 0.115, 0.108], 'all_L1': [0.146, 0.105, 0.125, 0.133]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.711, 0.834, 0.918, 1.0], 'all_L1': [0.81, 0.881, 0.861, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.688, 0.814, 0.882, 1.0], 'all_L1': [0.785, 0.875, 0.839, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.733, 0.837, 0.909, 1.0], 'all_L1': [0.849, 0.893, 0.86, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.778, 0.887, 0.911, 1.0], 'all_L1': [0.856, 0.903, 0.861, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.65, 0.817, 0.903, 1.0], 'all_L1': [0.757, 0.856, 0.847, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.287, 0.193, 0.152, 0.155], 'all_L1': [0.2, 0.137, 0.195, 0.217]}), defaultdict(<class 'list'>, {'all_KL': [0.298, 0.18, 0.162, 0.152], 'all_L1': [0.219, 0.132, 0.194, 0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.185, 0.146, 0.148], 'all_L1': [0.155, 0.121, 0.183, 0.215]}), defaultdict(<class 'list'>, {'all_KL': [0.245, 0.152, 0.131, 0.145], 'all_L1': [0.167, 0.122, 0.171, 0.202]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.181, 0.144, 0.136], 'all_L1': [0.214, 0.153, 0.196, 0.212]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.869 +- 0.033, 0.920 +- 0.017, 0.912 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.753 +- 0.050, 0.865 +- 0.033, 0.927 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.731 +- 0.010, 0.795 +- 0.014, 0.860 +- 0.006
nec class all_L1  =  0.126 +- 0.022, 0.085 +- 0.011, 0.116 +- 0.007, 0.127 +- 0.007
nec class all_KL  =  0.202 +- 0.026, 0.135 +- 0.012, 0.114 +- 0.005, 0.112 +- 0.010
nec_acc_int  =  0.740 +- 0.011, 0.811 +- 0.009, 0.834 +- 0.011, 0.832 +- 0.007

Eval split test
suff++ class all_L1  =  0.811 +- 0.038, 0.882 +- 0.016, 0.854 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.712 +- 0.043, 0.838 +- 0.026, 0.905 +- 0.012, 1.000 +- 0.000
suff++_acc_int  =  0.593 +- 0.012, 0.637 +- 0.019, 0.675 +- 0.015
nec class all_L1  =  0.191 +- 0.026, 0.133 +- 0.012, 0.188 +- 0.010, 0.213 +- 0.006
nec class all_KL  =  0.272 +- 0.019, 0.178 +- 0.014, 0.147 +- 0.010, 0.147 +- 0.007
nec_acc_int  =  0.597 +- 0.011, 0.646 +- 0.008, 0.665 +- 0.008, 0.667 +- 0.003


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.497 +- 0.009, 0.503 +- 0.004, 0.514 +- 0.003, 0.564 +- 0.003
Faith. Armon (L1)= 		  =  0.219 +- 0.034, 0.156 +- 0.019, 0.206 +- 0.011, 0.226 +- 0.011
Faith. GMean (L1)= 	  =  0.329 +- 0.025, 0.280 +- 0.016, 0.325 +- 0.009, 0.357 +- 0.010
Faith. Aritm (KL)= 		  =  0.478 +- 0.020, 0.500 +- 0.012, 0.521 +- 0.004, 0.556 +- 0.005
Faith. Armon (KL)= 		  =  0.317 +- 0.030, 0.233 +- 0.017, 0.203 +- 0.008, 0.201 +- 0.016
Faith. GMean (KL)= 	  =  0.388 +- 0.021, 0.340 +- 0.010, 0.325 +- 0.006, 0.334 +- 0.014

Eval split test
Faith. Aritm (L1)= 		  =  0.501 +- 0.009, 0.507 +- 0.003, 0.521 +- 0.004, 0.606 +- 0.003
Faith. Armon (L1)= 		  =  0.308 +- 0.031, 0.231 +- 0.017, 0.308 +- 0.013, 0.351 +- 0.008
Faith. GMean (L1)= 	  =  0.392 +- 0.019, 0.342 +- 0.012, 0.400 +- 0.009, 0.461 +- 0.006
Faith. Aritm (KL)= 		  =  0.492 +- 0.018, 0.508 +- 0.009, 0.526 +- 0.005, 0.574 +- 0.003
Faith. Armon (KL)= 		  =  0.392 +- 0.017, 0.293 +- 0.018, 0.253 +- 0.015, 0.257 +- 0.010
Faith. GMean (KL)= 	  =  0.439 +- 0.013, 0.386 +- 0.011, 0.364 +- 0.011, 0.384 +- 0.009
Computed for split load_split = id



Completed in  0:24:33.841018  for LECIGIN LBAPcore/assay



DONE LECI LBAPcore/assay LA
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:46:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:46:13 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:46:49 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:46:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:47:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ROC-AUC: 0.9727
Train Loss: 0.1378
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2674
ID Test ROC-AUC: 0.9280
ID Test Loss: 0.2650
OOD Validation ROC-AUC: 0.6550
OOD Validation Loss: 0.4948
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.6679

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ROC-AUC: 0.9313
Train Loss: 0.2369
ID Validation ROC-AUC: 0.9115
ID Validation Loss: 0.2655
ID Test ROC-AUC: 0.9145
ID Test Loss: 0.2678
OOD Validation ROC-AUC: 0.7016
OOD Validation Loss: 0.3203
OOD Test ROC-AUC: 0.7225
OOD Test Loss: 0.5195

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.7073 0.9145 0.7225 0.9115 0.7016[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:47:42 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:47:47 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.71
SUFF++ for r=0.3 class 0.0 = 0.653 +- 0.193 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.3 class 1.0 = 0.762 +- 0.193 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.3 all KL = 0.798 +- 0.193 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.3 all L1 = 0.749 +- 0.184 (in-sample avg dev_std = 0.380)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.852
SUFF++ for r=0.6 class 0.0 = 0.667 +- 0.140 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.924 +- 0.140 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.922 +- 0.140 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.166 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.905
SUFF++ for r=0.9 class 0.0 = 0.746 +- 0.096 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 class 1.0 = 0.965 +- 0.096 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all KL = 0.964 +- 0.096 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.131 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.595
SUFF++ for r=0.3 class 0.0 = 0.675 +- 0.186 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 1.0 = 0.715 +- 0.186 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all KL = 0.77 +- 0.186 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all L1 = 0.709 +- 0.170 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.679
SUFF++ for r=0.6 class 0.0 = 0.744 +- 0.152 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.863 +- 0.152 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.891 +- 0.152 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.843 +- 0.183 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
SUFF++ for r=0.9 class 0.0 = 0.797 +- 0.122 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 class 1.0 = 0.911 +- 0.122 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 all KL = 0.937 +- 0.122 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.163 (in-sample avg dev_std = 0.173)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.717
NEC for r=0.3 class 0.0 = 0.372 +- 0.252 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1.0 = 0.319 +- 0.252 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.298 +- 0.252 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.325 +- 0.212 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.856
NEC for r=0.6 class 0.0 = 0.351 +- 0.171 (in-sample avg dev_std = 0.209)
NEC for r=0.6 class 1.0 = 0.091 +- 0.171 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all KL = 0.103 +- 0.171 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all L1 = 0.121 +- 0.179 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.886
NEC for r=0.9 class 0.0 = 0.288 +- 0.126 (in-sample avg dev_std = 0.165)
NEC for r=0.9 class 1.0 = 0.048 +- 0.126 (in-sample avg dev_std = 0.165)
NEC for r=0.9 all KL = 0.053 +- 0.126 (in-sample avg dev_std = 0.165)
NEC for r=0.9 all L1 = 0.076 +- 0.151 (in-sample avg dev_std = 0.165)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.887
NEC for r=1.0 class 0.0 = 0.294 +- 0.124 (in-sample avg dev_std = 0.180)
NEC for r=1.0 class 1.0 = 0.045 +- 0.124 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all KL = 0.051 +- 0.124 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all L1 = 0.074 +- 0.148 (in-sample avg dev_std = 0.180)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.612
NEC for r=0.3 class 0.0 = 0.389 +- 0.255 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 1.0 = 0.37 +- 0.255 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all KL = 0.32 +- 0.255 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all L1 = 0.373 +- 0.199 (in-sample avg dev_std = 0.410)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.685
NEC for r=0.6 class 0.0 = 0.271 +- 0.188 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1.0 = 0.173 +- 0.188 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.153 +- 0.188 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.189 +- 0.197 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.712
NEC for r=0.9 class 0.0 = 0.232 +- 0.135 (in-sample avg dev_std = 0.195)
NEC for r=0.9 class 1.0 = 0.104 +- 0.135 (in-sample avg dev_std = 0.195)
NEC for r=0.9 all KL = 0.083 +- 0.135 (in-sample avg dev_std = 0.195)
NEC for r=0.9 all L1 = 0.126 +- 0.169 (in-sample avg dev_std = 0.195)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.739
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.728
NEC for r=1.0 class 0.0 = 0.225 +- 0.133 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 1.0 = 0.107 +- 0.133 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all KL = 0.078 +- 0.133 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all L1 = 0.126 +- 0.170 (in-sample avg dev_std = 0.195)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:51:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:51:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:51:39 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:51:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:17 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:52:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9651
Train Loss: 0.1565
ID Validation ROC-AUC: 0.9232
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9247
ID Test Loss: 0.2522
OOD Validation ROC-AUC: 0.6738
OOD Validation Loss: 0.4349
OOD Test ROC-AUC: 0.7050
OOD Test Loss: 0.6209

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9095
Train Loss: 0.2555
ID Validation ROC-AUC: 0.8966
ID Validation Loss: 0.2709
ID Test ROC-AUC: 0.8993
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6989
OOD Validation Loss: 0.3054
OOD Test ROC-AUC: 0.7302
OOD Test Loss: 0.4911

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.7050 0.8993 0.7302 0.8966 0.6989[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:52:33 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:52:37 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.673
SUFF++ for r=0.3 class 0.0 = 0.694 +- 0.148 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 class 1.0 = 0.745 +- 0.148 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all KL = 0.824 +- 0.148 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all L1 = 0.739 +- 0.133 (in-sample avg dev_std = 0.327)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.813
SUFF++ for r=0.6 class 0.0 = 0.689 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 1.0 = 0.891 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 all KL = 0.901 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 all L1 = 0.867 +- 0.161 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.894
SUFF++ for r=0.9 class 0.0 = 0.8 +- 0.091 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1.0 = 0.96 +- 0.091 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.966 +- 0.091 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.942 +- 0.112 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.130 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.3 class 1.0 = 0.717 +- 0.130 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.3 all KL = 0.829 +- 0.130 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.3 all L1 = 0.717 +- 0.125 (in-sample avg dev_std = 0.341)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.687
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.665
SUFF++ for r=0.6 class 0.0 = 0.731 +- 0.137 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 1.0 = 0.811 +- 0.137 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all KL = 0.868 +- 0.137 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all L1 = 0.798 +- 0.169 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0.0 = 0.853 +- 0.102 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 class 1.0 = 0.915 +- 0.102 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 all KL = 0.947 +- 0.102 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 all L1 = 0.904 +- 0.130 (in-sample avg dev_std = 0.147)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
NEC for r=0.3 class 0.0 = 0.313 +- 0.208 (in-sample avg dev_std = 0.328)
NEC for r=0.3 class 1.0 = 0.321 +- 0.208 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all KL = 0.241 +- 0.208 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all L1 = 0.32 +- 0.151 (in-sample avg dev_std = 0.328)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.821
NEC for r=0.6 class 0.0 = 0.277 +- 0.179 (in-sample avg dev_std = 0.226)
NEC for r=0.6 class 1.0 = 0.136 +- 0.179 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all KL = 0.132 +- 0.179 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all L1 = 0.152 +- 0.166 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.23 +- 0.106 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.053 +- 0.106 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.054 +- 0.106 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.074 +- 0.124 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.919
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.888
NEC for r=1.0 class 0.0 = 0.237 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=1.0 class 1.0 = 0.05 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all KL = 0.045 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all L1 = 0.072 +- 0.128 (in-sample avg dev_std = 0.145)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 0.0 = 0.343 +- 0.191 (in-sample avg dev_std = 0.316)
NEC for r=0.3 class 1.0 = 0.336 +- 0.191 (in-sample avg dev_std = 0.316)
NEC for r=0.3 all KL = 0.219 +- 0.191 (in-sample avg dev_std = 0.316)
NEC for r=0.3 all L1 = 0.337 +- 0.149 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.687
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.665
NEC for r=0.6 class 0.0 = 0.26 +- 0.161 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 1.0 = 0.207 +- 0.161 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all KL = 0.149 +- 0.161 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all L1 = 0.216 +- 0.164 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.696
NEC for r=0.9 class 0.0 = 0.186 +- 0.124 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.115 +- 0.124 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.086 +- 0.124 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.127 +- 0.147 (in-sample avg dev_std = 0.194)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.723
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.707
NEC for r=1.0 class 0.0 = 0.195 +- 0.106 (in-sample avg dev_std = 0.179)
NEC for r=1.0 class 1.0 = 0.102 +- 0.106 (in-sample avg dev_std = 0.179)
NEC for r=1.0 all KL = 0.068 +- 0.106 (in-sample avg dev_std = 0.179)
NEC for r=1.0 all L1 = 0.117 +- 0.143 (in-sample avg dev_std = 0.179)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 09:56:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 09:56:01 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 09:56:32 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 09:56:42 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 09:56:52 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:08 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 09:57:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9599
Train Loss: 0.1725
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9238
ID Test Loss: 0.2502
OOD Validation ROC-AUC: 0.6637
OOD Validation Loss: 0.3933
OOD Test ROC-AUC: 0.7126
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9060
Train Loss: 0.2554
ID Validation ROC-AUC: 0.8940
ID Validation Loss: 0.2686
ID Test ROC-AUC: 0.8978
ID Test Loss: 0.2703
OOD Validation ROC-AUC: 0.6978
OOD Validation Loss: 0.2989
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.4799

[0m[1;37mINFO[0m: [1mChartInfo 0.9238 0.7126 0.8978 0.7280 0.8940 0.6978[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 09:57:24 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 09:57:28 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.714
SUFF++ for r=0.3 class 0.0 = 0.705 +- 0.126 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.3 class 1.0 = 0.803 +- 0.126 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.3 all KL = 0.877 +- 0.126 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.3 all L1 = 0.792 +- 0.144 (in-sample avg dev_std = 0.278)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.856
SUFF++ for r=0.6 class 0.0 = 0.728 +- 0.093 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 class 1.0 = 0.929 +- 0.093 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 all KL = 0.944 +- 0.093 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 all L1 = 0.906 +- 0.135 (in-sample avg dev_std = 0.160)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.903
SUFF++ for r=0.9 class 0.0 = 0.793 +- 0.061 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.061 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all KL = 0.976 +- 0.061 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.104 (in-sample avg dev_std = 0.099)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.648
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
SUFF++ for r=0.3 class 0.0 = 0.73 +- 0.110 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.3 class 1.0 = 0.762 +- 0.110 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.3 all KL = 0.87 +- 0.110 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.3 all L1 = 0.757 +- 0.138 (in-sample avg dev_std = 0.295)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0.0 = 0.767 +- 0.090 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 class 1.0 = 0.867 +- 0.090 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all KL = 0.924 +- 0.090 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all L1 = 0.85 +- 0.150 (in-sample avg dev_std = 0.201)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.737
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.716
SUFF++ for r=0.9 class 0.0 = 0.84 +- 0.076 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.9 class 1.0 = 0.923 +- 0.076 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.9 all KL = 0.96 +- 0.076 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.121 (in-sample avg dev_std = 0.133)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0.0 = 0.344 +- 0.186 (in-sample avg dev_std = 0.285)
NEC for r=0.3 class 1.0 = 0.276 +- 0.186 (in-sample avg dev_std = 0.285)
NEC for r=0.3 all KL = 0.199 +- 0.186 (in-sample avg dev_std = 0.285)
NEC for r=0.3 all L1 = 0.284 +- 0.178 (in-sample avg dev_std = 0.285)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.85
NEC for r=0.6 class 0.0 = 0.281 +- 0.118 (in-sample avg dev_std = 0.159)
NEC for r=0.6 class 1.0 = 0.085 +- 0.118 (in-sample avg dev_std = 0.159)
NEC for r=0.6 all KL = 0.073 +- 0.118 (in-sample avg dev_std = 0.159)
NEC for r=0.6 all L1 = 0.108 +- 0.142 (in-sample avg dev_std = 0.159)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.892
NEC for r=0.9 class 0.0 = 0.224 +- 0.081 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.043 +- 0.081 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.037 +- 0.081 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.064 +- 0.115 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.894
NEC for r=1.0 class 0.0 = 0.229 +- 0.079 (in-sample avg dev_std = 0.124)
NEC for r=1.0 class 1.0 = 0.037 +- 0.079 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all KL = 0.032 +- 0.079 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all L1 = 0.06 +- 0.113 (in-sample avg dev_std = 0.124)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.648
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.609
NEC for r=0.3 class 0.0 = 0.326 +- 0.169 (in-sample avg dev_std = 0.296)
NEC for r=0.3 class 1.0 = 0.31 +- 0.169 (in-sample avg dev_std = 0.296)
NEC for r=0.3 all KL = 0.195 +- 0.169 (in-sample avg dev_std = 0.296)
NEC for r=0.3 all L1 = 0.313 +- 0.167 (in-sample avg dev_std = 0.296)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.695
NEC for r=0.6 class 0.0 = 0.266 +- 0.123 (in-sample avg dev_std = 0.213)
NEC for r=0.6 class 1.0 = 0.158 +- 0.123 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all KL = 0.104 +- 0.123 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all L1 = 0.176 +- 0.165 (in-sample avg dev_std = 0.213)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.737
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.711
NEC for r=0.9 class 0.0 = 0.183 +- 0.083 (in-sample avg dev_std = 0.151)
NEC for r=0.9 class 1.0 = 0.096 +- 0.083 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all KL = 0.056 +- 0.083 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all L1 = 0.11 +- 0.129 (in-sample avg dev_std = 0.151)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.747
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.717
NEC for r=1.0 class 0.0 = 0.181 +- 0.078 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1.0 = 0.087 +- 0.078 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.047 +- 0.078 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.103 +- 0.130 (in-sample avg dev_std = 0.142)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 10:00:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 10:00:47 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 10:01:21 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 10:01:31 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 10:01:42 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 10:01:58 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1544
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2444
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2478
OOD Validation ROC-AUC: 0.6793
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.7158
OOD Test Loss: 0.5602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ROC-AUC: 0.9510
Train Loss: 0.1952
ID Validation ROC-AUC: 0.9178
ID Validation Loss: 0.2653
ID Test ROC-AUC: 0.9200
ID Test Loss: 0.2655
OOD Validation ROC-AUC: 0.6963
OOD Validation Loss: 0.3695
OOD Test ROC-AUC: 0.7235
OOD Test Loss: 0.5689

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7158 0.9200 0.7235 0.9178 0.6963[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 10:02:14 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 10:02:19 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.781
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.725
SUFF++ for r=0.3 class 0.0 = 0.726 +- 0.115 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 class 1.0 = 0.804 +- 0.115 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 all KL = 0.883 +- 0.115 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 all L1 = 0.795 +- 0.141 (in-sample avg dev_std = 0.269)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.858
SUFF++ for r=0.6 class 0.0 = 0.705 +- 0.107 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 class 1.0 = 0.927 +- 0.107 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all KL = 0.936 +- 0.107 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all L1 = 0.901 +- 0.143 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.903
SUFF++ for r=0.9 class 0.0 = 0.826 +- 0.070 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 1.0 = 0.969 +- 0.070 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all KL = 0.977 +- 0.070 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all L1 = 0.952 +- 0.100 (in-sample avg dev_std = 0.102)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.62
SUFF++ for r=0.3 class 0.0 = 0.748 +- 0.107 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 1.0 = 0.764 +- 0.107 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all KL = 0.878 +- 0.107 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all L1 = 0.761 +- 0.135 (in-sample avg dev_std = 0.282)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.737
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.705
SUFF++ for r=0.6 class 0.0 = 0.753 +- 0.114 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.6 class 1.0 = 0.856 +- 0.114 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.6 all KL = 0.907 +- 0.114 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.6 all L1 = 0.839 +- 0.162 (in-sample avg dev_std = 0.221)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.743
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0.0 = 0.846 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all KL = 0.959 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all L1 = 0.911 +- 0.124 (in-sample avg dev_std = 0.141)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.781
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.748
NEC for r=0.3 class 0.0 = 0.331 +- 0.172 (in-sample avg dev_std = 0.260)
NEC for r=0.3 class 1.0 = 0.261 +- 0.172 (in-sample avg dev_std = 0.260)
NEC for r=0.3 all KL = 0.18 +- 0.172 (in-sample avg dev_std = 0.260)
NEC for r=0.3 all L1 = 0.269 +- 0.171 (in-sample avg dev_std = 0.260)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.865
NEC for r=0.6 class 0.0 = 0.293 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.085 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.08 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.109 +- 0.146 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.894
NEC for r=0.9 class 0.0 = 0.256 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1.0 = 0.043 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.044 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.068 +- 0.126 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.888
NEC for r=1.0 class 0.0 = 0.245 +- 0.097 (in-sample avg dev_std = 0.143)
NEC for r=1.0 class 1.0 = 0.043 +- 0.097 (in-sample avg dev_std = 0.143)
NEC for r=1.0 all KL = 0.04 +- 0.097 (in-sample avg dev_std = 0.143)
NEC for r=1.0 all L1 = 0.067 +- 0.126 (in-sample avg dev_std = 0.143)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.64
NEC for r=0.3 class 0.0 = 0.324 +- 0.165 (in-sample avg dev_std = 0.273)
NEC for r=0.3 class 1.0 = 0.299 +- 0.165 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.181 +- 0.165 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.304 +- 0.164 (in-sample avg dev_std = 0.273)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.737
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
NEC for r=0.6 class 0.0 = 0.265 +- 0.151 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 1.0 = 0.179 +- 0.151 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all KL = 0.131 +- 0.151 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all L1 = 0.193 +- 0.171 (in-sample avg dev_std = 0.236)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.743
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.731
NEC for r=0.9 class 0.0 = 0.19 +- 0.100 (in-sample avg dev_std = 0.167)
NEC for r=0.9 class 1.0 = 0.098 +- 0.100 (in-sample avg dev_std = 0.167)
NEC for r=0.9 all KL = 0.065 +- 0.100 (in-sample avg dev_std = 0.167)
NEC for r=0.9 all L1 = 0.114 +- 0.140 (in-sample avg dev_std = 0.167)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.753
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.723
NEC for r=1.0 class 0.0 = 0.212 +- 0.104 (in-sample avg dev_std = 0.174)
NEC for r=1.0 class 1.0 = 0.099 +- 0.104 (in-sample avg dev_std = 0.174)
NEC for r=1.0 all KL = 0.064 +- 0.104 (in-sample avg dev_std = 0.174)
NEC for r=1.0 all L1 = 0.118 +- 0.145 (in-sample avg dev_std = 0.174)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 10:05:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 10:05:36 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:07 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:16 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:27 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9712
Train Loss: 0.1682
ID Validation ROC-AUC: 0.9235
ID Validation Loss: 0.3171
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.3191
OOD Validation ROC-AUC: 0.6651
OOD Validation Loss: 0.5310
OOD Test ROC-AUC: 0.7146
OOD Test Loss: 0.7641

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9105
Train Loss: 0.2495
ID Validation ROC-AUC: 0.8984
ID Validation Loss: 0.2622
ID Test ROC-AUC: 0.9001
ID Test Loss: 0.2660
OOD Validation ROC-AUC: 0.7015
OOD Validation Loss: 0.2936
OOD Test ROC-AUC: 0.7252
OOD Test Loss: 0.4753

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7146 0.9001 0.7252 0.8984 0.7015[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/23/2024 10:06:58 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/23/2024 10:07:02 AM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.733
SUFF++ for r=0.3 class 0.0 = 0.66 +- 0.165 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.3 class 1.0 = 0.766 +- 0.165 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.3 all KL = 0.812 +- 0.165 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.170 (in-sample avg dev_std = 0.353)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.859
SUFF++ for r=0.6 class 0.0 = 0.696 +- 0.140 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.6 class 1.0 = 0.935 +- 0.140 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.6 all KL = 0.927 +- 0.140 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.6 all L1 = 0.908 +- 0.157 (in-sample avg dev_std = 0.203)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.9
SUFF++ for r=0.9 class 0.0 = 0.8 +- 0.085 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 1.0 = 0.973 +- 0.085 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all KL = 0.973 +- 0.085 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all L1 = 0.953 +- 0.113 (in-sample avg dev_std = 0.123)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.627
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.604
SUFF++ for r=0.3 class 0.0 = 0.675 +- 0.191 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 1.0 = 0.723 +- 0.191 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all KL = 0.778 +- 0.191 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all L1 = 0.715 +- 0.169 (in-sample avg dev_std = 0.392)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.689
SUFF++ for r=0.6 class 0.0 = 0.769 +- 0.154 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 class 1.0 = 0.882 +- 0.154 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all KL = 0.897 +- 0.154 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all L1 = 0.863 +- 0.174 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.723
SUFF++ for r=0.9 class 0.0 = 0.858 +- 0.115 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.115 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all KL = 0.956 +- 0.115 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all L1 = 0.925 +- 0.139 (in-sample avg dev_std = 0.146)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0.0 = 0.41 +- 0.240 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 1.0 = 0.335 +- 0.240 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all KL = 0.313 +- 0.240 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all L1 = 0.344 +- 0.194 (in-sample avg dev_std = 0.394)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.856
NEC for r=0.6 class 0.0 = 0.319 +- 0.187 (in-sample avg dev_std = 0.214)
NEC for r=0.6 class 1.0 = 0.088 +- 0.187 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all KL = 0.113 +- 0.187 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all L1 = 0.115 +- 0.171 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.897
NEC for r=0.9 class 0.0 = 0.251 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1.0 = 0.039 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.05 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.064 +- 0.135 (in-sample avg dev_std = 0.163)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.927
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.896
NEC for r=1.0 class 0.0 = 0.258 +- 0.110 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.039 +- 0.110 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.044 +- 0.110 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.064 +- 0.136 (in-sample avg dev_std = 0.159)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.627
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.58
NEC for r=0.3 class 0.0 = 0.393 +- 0.253 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1.0 = 0.376 +- 0.253 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.333 +- 0.253 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.378 +- 0.189 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 0.0 = 0.268 +- 0.198 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 1.0 = 0.165 +- 0.198 (in-sample avg dev_std = 0.278)
NEC for r=0.6 all KL = 0.163 +- 0.198 (in-sample avg dev_std = 0.278)
NEC for r=0.6 all L1 = 0.182 +- 0.193 (in-sample avg dev_std = 0.278)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.703
NEC for r=0.9 class 0.0 = 0.188 +- 0.143 (in-sample avg dev_std = 0.179)
NEC for r=0.9 class 1.0 = 0.085 +- 0.143 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all KL = 0.074 +- 0.143 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all L1 = 0.102 +- 0.164 (in-sample avg dev_std = 0.179)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.747
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.719
NEC for r=1.0 class 0.0 = 0.199 +- 0.139 (in-sample avg dev_std = 0.188)
NEC for r=1.0 class 1.0 = 0.085 +- 0.139 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all KL = 0.071 +- 0.139 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all L1 = 0.104 +- 0.167 (in-sample avg dev_std = 0.188)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.798, 0.922, 0.964, 1.0], 'all_L1': [0.749, 0.894, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.824, 0.901, 0.966, 1.0], 'all_L1': [0.739, 0.867, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.944, 0.976, 1.0], 'all_L1': [0.792, 0.906, 0.948, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.936, 0.977, 1.0], 'all_L1': [0.795, 0.901, 0.952, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.812, 0.927, 0.973, 1.0], 'all_L1': [0.754, 0.908, 0.953, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.298, 0.103, 0.053, 0.051], 'all_L1': [0.325, 0.121, 0.076, 0.074]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.132, 0.054, 0.045], 'all_L1': [0.32, 0.152, 0.074, 0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.199, 0.073, 0.037, 0.032], 'all_L1': [0.284, 0.108, 0.064, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.08, 0.044, 0.04], 'all_L1': [0.269, 0.109, 0.068, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.113, 0.05, 0.044], 'all_L1': [0.344, 0.115, 0.064, 0.064]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.77, 0.891, 0.937, 1.0], 'all_L1': [0.709, 0.843, 0.892, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.829, 0.868, 0.947, 1.0], 'all_L1': [0.717, 0.798, 0.904, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.924, 0.96, 1.0], 'all_L1': [0.757, 0.85, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.878, 0.907, 0.959, 1.0], 'all_L1': [0.761, 0.839, 0.911, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.778, 0.897, 0.956, 1.0], 'all_L1': [0.715, 0.863, 0.925, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.32, 0.153, 0.083, 0.078], 'all_L1': [0.373, 0.189, 0.126, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.219, 0.149, 0.086, 0.068], 'all_L1': [0.337, 0.216, 0.127, 0.117]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.104, 0.056, 0.047], 'all_L1': [0.313, 0.176, 0.11, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.181, 0.131, 0.065, 0.064], 'all_L1': [0.304, 0.193, 0.114, 0.118]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.163, 0.074, 0.071], 'all_L1': [0.378, 0.182, 0.102, 0.104]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.766 +- 0.023, 0.895 +- 0.015, 0.947 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.839 +- 0.035, 0.926 +- 0.015, 0.971 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.711 +- 0.021, 0.847 +- 0.017, 0.901 +- 0.004
nec class all_L1  =  0.308 +- 0.028, 0.121 +- 0.016, 0.069 +- 0.005, 0.067 +- 0.005
nec class all_KL  =  0.246 +- 0.053, 0.100 +- 0.022, 0.048 +- 0.006, 0.042 +- 0.006
nec_acc_int  =  0.712 +- 0.032, 0.850 +- 0.015, 0.890 +- 0.006, 0.891 +- 0.003

Eval split test
suff++ class all_L1  =  0.732 +- 0.022, 0.839 +- 0.022, 0.908 +- 0.011, 1.000 +- 0.000
suff++ class all_KL  =  0.825 +- 0.045, 0.897 +- 0.018, 0.952 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.597 +- 0.021, 0.685 +- 0.013, 0.710 +- 0.016
nec class all_L1  =  0.341 +- 0.030, 0.191 +- 0.014, 0.116 +- 0.010, 0.114 +- 0.009
nec class all_KL  =  0.250 +- 0.064, 0.140 +- 0.021, 0.073 +- 0.011, 0.066 +- 0.010
nec_acc_int  =  0.605 +- 0.022, 0.684 +- 0.015, 0.711 +- 0.012, 0.719 +- 0.007


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.537 +- 0.007, 0.508 +- 0.002, 0.508 +- 0.001, 0.534 +- 0.003
Faith. Armon (L1)= 		  =  0.438 +- 0.025, 0.213 +- 0.024, 0.129 +- 0.009, 0.126 +- 0.009
Faith. GMean (L1)= 	  =  0.485 +- 0.016, 0.328 +- 0.018, 0.256 +- 0.009, 0.259 +- 0.010
Faith. Aritm (KL)= 		  =  0.543 +- 0.012, 0.513 +- 0.005, 0.509 +- 0.002, 0.521 +- 0.003
Faith. Armon (KL)= 		  =  0.376 +- 0.060, 0.180 +- 0.035, 0.091 +- 0.012, 0.081 +- 0.012
Faith. GMean (KL)= 	  =  0.451 +- 0.040, 0.303 +- 0.031, 0.214 +- 0.014, 0.205 +- 0.016

Eval split test
Faith. Aritm (L1)= 		  =  0.536 +- 0.007, 0.515 +- 0.005, 0.512 +- 0.002, 0.557 +- 0.004
Faith. Armon (L1)= 		  =  0.464 +- 0.024, 0.311 +- 0.016, 0.205 +- 0.015, 0.204 +- 0.014
Faith. GMean (L1)= 	  =  0.499 +- 0.015, 0.400 +- 0.009, 0.324 +- 0.012, 0.337 +- 0.013
Faith. Aritm (KL)= 		  =  0.537 +- 0.011, 0.519 +- 0.007, 0.512 +- 0.003, 0.533 +- 0.005
Faith. Armon (KL)= 		  =  0.377 +- 0.069, 0.241 +- 0.031, 0.135 +- 0.019, 0.123 +- 0.018
Faith. GMean (KL)= 	  =  0.448 +- 0.045, 0.353 +- 0.025, 0.262 +- 0.020, 0.255 +- 0.021
Computed for split load_split = id



Completed in  0:24:12.496968  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay ER
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 23 10:10:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/23/2024 10:10:38 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/23/2024 10:11:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/23/2024 10:11:21 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/23/2024 10:11:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/23/2024 10:11:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/23/2024 10:12:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;31mERROR[0m: 09/23/2024 10:12:05 AM - utils.py - line 52 : [1mCheckpoint not found at /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/checkpoints/round1/LBAPcore_assay_covariate/repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean/0.0001lr_0.0001wd/LECI_1.0_1_0_0.1_90_0.1_True/best.ckpt
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 1020, in goodtg
    main()
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 815, in main
    evaluate_metric(args)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 575, in evaluate_metric
    pipeline.load_task(load_param=True, load_split=load_split)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1595, in load_task
    test_score, test_loss = self.config_model('test', load_param=load_param, load_split=load_split)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1626, in config_model
    print(f'#E#Checkpoint not found at {os.path.abspath(self.config.test_ckpt)}')
