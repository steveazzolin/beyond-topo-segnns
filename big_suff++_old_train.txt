nohup: ignoring input

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:45:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 07:45:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:12 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:46:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.704
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.751
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.751


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  0.7041225
Model XAI WIoU of binarized graphs for r=0.3 =  0.65337125
len(reference) = 788
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.481 +- 0.283 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.3 class 1 = 0.497 +- 0.283 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.3 class 2 = 0.479 +- 0.283 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.3 all KL = 0.417 +- 0.283 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.3 all L1 = 0.486 +- 0.166 (in-sample avg dev_std = 0.572)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.6025575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7408125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.726
SUFF++ for r=0.6 class 0 = 0.634 +- 0.259 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 1 = 0.639 +- 0.259 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 2 = 0.649 +- 0.259 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all KL = 0.627 +- 0.259 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all L1 = 0.64 +- 0.183 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.47385
Model XAI WIoU of binarized graphs for r=0.9 =  0.7513137499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF++ for r=0.9 class 0 = 0.836 +- 0.171 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 1 = 0.81 +- 0.171 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 2 = 0.83 +- 0.171 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all KL = 0.875 +- 0.171 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.175 (in-sample avg dev_std = 0.248)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  0.7041225
Model XAI WIoU of binarized graphs for r=0.3 =  0.65337125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.374
NEC for r=0.3 class 0 = 0.576 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 1 = 0.527 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 2 = 0.604 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all KL = 0.617 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all L1 = 0.568 +- 0.177 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.6025575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7408125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.484
NEC for r=0.6 class 0 = 0.539 +- 0.286 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 1 = 0.488 +- 0.286 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 2 = 0.634 +- 0.286 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all KL = 0.591 +- 0.286 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all L1 = 0.553 +- 0.166 (in-sample avg dev_std = 0.537)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.47385
Model XAI WIoU of binarized graphs for r=0.9 =  0.7513137499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.567
NEC for r=0.9 class 0 = 0.479 +- 0.280 (in-sample avg dev_std = 0.572)
NEC for r=0.9 class 1 = 0.464 +- 0.280 (in-sample avg dev_std = 0.572)
NEC for r=0.9 class 2 = 0.571 +- 0.280 (in-sample avg dev_std = 0.572)
NEC for r=0.9 all KL = 0.525 +- 0.280 (in-sample avg dev_std = 0.572)
NEC for r=0.9 all L1 = 0.504 +- 0.156 (in-sample avg dev_std = 0.572)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.75131
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.568
NEC for r=1.0 class 0 = 0.476 +- 0.281 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 1 = 0.466 +- 0.281 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 2 = 0.574 +- 0.281 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all KL = 0.524 +- 0.281 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all L1 = 0.505 +- 0.155 (in-sample avg dev_std = 0.569)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:47:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 07:47:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:48:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.685
WIoU for r=0.3 = 0.627
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.736
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.736
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.736


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.633
Model XAI F1 of binarized graphs for r=0.3 =  0.6850462500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6268900000000001
len(reference) = 788
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.454
SUFF++ for r=0.3 class 0 = 0.498 +- 0.260 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 class 1 = 0.467 +- 0.260 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 class 2 = 0.424 +- 0.260 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 all KL = 0.41 +- 0.260 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 all L1 = 0.463 +- 0.144 (in-sample avg dev_std = 0.596)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.868
Model XAI F1 of binarized graphs for r=0.6 =  0.6077325
Model XAI WIoU of binarized graphs for r=0.6 =  0.73566375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.729
SUFF++ for r=0.6 class 0 = 0.647 +- 0.259 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 1 = 0.688 +- 0.259 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 2 = 0.58 +- 0.259 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all KL = 0.648 +- 0.259 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all L1 = 0.639 +- 0.175 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.4731
Model XAI WIoU of binarized graphs for r=0.9 =  0.7362737500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.83
SUFF++ for r=0.9 class 0 = 0.783 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 1 = 0.783 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 2 = 0.762 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all KL = 0.842 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.179 (in-sample avg dev_std = 0.282)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.625
Model XAI F1 of binarized graphs for r=0.3 =  0.6850462500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6268900000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.568 +- 0.277 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 1 = 0.5 +- 0.277 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 2 = 0.651 +- 0.277 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all KL = 0.604 +- 0.277 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all L1 = 0.572 +- 0.157 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.868
Model XAI F1 of binarized graphs for r=0.6 =  0.6077325
Model XAI WIoU of binarized graphs for r=0.6 =  0.73566375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.458
NEC for r=0.6 class 0 = 0.576 +- 0.298 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 1 = 0.448 +- 0.298 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 2 = 0.646 +- 0.298 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all KL = 0.569 +- 0.298 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all L1 = 0.555 +- 0.171 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.4731
Model XAI WIoU of binarized graphs for r=0.9 =  0.7362737500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.54
NEC for r=0.9 class 0 = 0.523 +- 0.299 (in-sample avg dev_std = 0.515)
NEC for r=0.9 class 1 = 0.424 +- 0.299 (in-sample avg dev_std = 0.515)
NEC for r=0.9 class 2 = 0.586 +- 0.299 (in-sample avg dev_std = 0.515)
NEC for r=0.9 all KL = 0.508 +- 0.299 (in-sample avg dev_std = 0.515)
NEC for r=0.9 all L1 = 0.51 +- 0.168 (in-sample avg dev_std = 0.515)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7363187500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.545
NEC for r=1.0 class 0 = 0.506 +- 0.300 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 1 = 0.414 +- 0.300 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 2 = 0.58 +- 0.300 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all KL = 0.497 +- 0.300 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all L1 = 0.499 +- 0.173 (in-sample avg dev_std = 0.521)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:49:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 07:49:46 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:04 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:06 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:50:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:50:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.723
WIoU for r=0.3 = 0.703
F1 for r=0.6 = 0.619
WIoU for r=0.6 = 0.779
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.777
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.777


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  0.7228249999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.7027787499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.477
SUFF++ for r=0.3 class 0 = 0.495 +- 0.281 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 class 1 = 0.532 +- 0.281 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 class 2 = 0.466 +- 0.281 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 all KL = 0.404 +- 0.281 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 all L1 = 0.498 +- 0.173 (in-sample avg dev_std = 0.604)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.6190862500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.77856875
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0 = 0.532 +- 0.289 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 1 = 0.734 +- 0.289 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 2 = 0.589 +- 0.289 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 all KL = 0.574 +- 0.289 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 all L1 = 0.62 +- 0.209 (in-sample avg dev_std = 0.493)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.47354875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7769125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.823
SUFF++ for r=0.9 class 0 = 0.661 +- 0.238 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 class 1 = 0.78 +- 0.238 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 class 2 = 0.818 +- 0.238 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 all KL = 0.802 +- 0.238 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 all L1 = 0.754 +- 0.213 (in-sample avg dev_std = 0.292)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  0.7228249999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.7027787499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.388
NEC for r=0.3 class 0 = 0.594 +- 0.281 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 1 = 0.556 +- 0.281 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 2 = 0.631 +- 0.281 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all KL = 0.663 +- 0.281 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all L1 = 0.593 +- 0.148 (in-sample avg dev_std = 0.468)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.6190862500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.77856875
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.479
NEC for r=0.6 class 0 = 0.569 +- 0.287 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 1 = 0.524 +- 0.287 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 2 = 0.611 +- 0.287 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all KL = 0.624 +- 0.287 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all L1 = 0.568 +- 0.160 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.47354875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7769125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.544
NEC for r=0.9 class 0 = 0.542 +- 0.281 (in-sample avg dev_std = 0.547)
NEC for r=0.9 class 1 = 0.492 +- 0.281 (in-sample avg dev_std = 0.547)
NEC for r=0.9 class 2 = 0.526 +- 0.281 (in-sample avg dev_std = 0.547)
NEC for r=0.9 all KL = 0.557 +- 0.281 (in-sample avg dev_std = 0.547)
NEC for r=0.9 all L1 = 0.52 +- 0.155 (in-sample avg dev_std = 0.547)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7769125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.55
NEC for r=1.0 class 0 = 0.534 +- 0.278 (in-sample avg dev_std = 0.548)
NEC for r=1.0 class 1 = 0.505 +- 0.278 (in-sample avg dev_std = 0.548)
NEC for r=1.0 class 2 = 0.518 +- 0.278 (in-sample avg dev_std = 0.548)
NEC for r=1.0 all KL = 0.559 +- 0.278 (in-sample avg dev_std = 0.548)
NEC for r=1.0 all L1 = 0.519 +- 0.156 (in-sample avg dev_std = 0.548)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:51:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 07:51:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 07:51:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 07:51:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 07:51:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 07:51:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:52:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.739
WIoU for r=0.3 = 0.726
F1 for r=0.6 = 0.611
WIoU for r=0.6 = 0.817
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.811
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.811


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.721
Model XAI F1 of binarized graphs for r=0.3 =  0.73858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7263024999999999
len(reference) = 798
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0 = 0.536 +- 0.290 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 class 1 = 0.525 +- 0.290 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 class 2 = 0.489 +- 0.290 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 all KL = 0.405 +- 0.290 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 all L1 = 0.517 +- 0.177 (in-sample avg dev_std = 0.601)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  0.61144375
Model XAI WIoU of binarized graphs for r=0.6 =  0.817065
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.76
SUFF++ for r=0.6 class 0 = 0.611 +- 0.279 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 1 = 0.68 +- 0.279 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 2 = 0.676 +- 0.279 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all KL = 0.644 +- 0.279 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all L1 = 0.656 +- 0.189 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.47349374999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.810585
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF++ for r=0.9 class 0 = 0.764 +- 0.207 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 1 = 0.795 +- 0.207 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 2 = 0.851 +- 0.207 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all KL = 0.846 +- 0.207 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all L1 = 0.803 +- 0.168 (in-sample avg dev_std = 0.301)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.719
Model XAI F1 of binarized graphs for r=0.3 =  0.73858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7263024999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.39
NEC for r=0.3 class 0 = 0.606 +- 0.285 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 1 = 0.537 +- 0.285 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 2 = 0.663 +- 0.285 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all KL = 0.692 +- 0.285 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all L1 = 0.601 +- 0.150 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  0.61144375
Model XAI WIoU of binarized graphs for r=0.6 =  0.817065
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.483
NEC for r=0.6 class 0 = 0.553 +- 0.302 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 1 = 0.492 +- 0.302 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 2 = 0.642 +- 0.302 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all KL = 0.594 +- 0.302 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all L1 = 0.562 +- 0.164 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.47349374999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.810585
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.565
NEC for r=0.9 class 0 = 0.506 +- 0.294 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 1 = 0.451 +- 0.294 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 2 = 0.558 +- 0.294 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all KL = 0.519 +- 0.294 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all L1 = 0.504 +- 0.167 (in-sample avg dev_std = 0.535)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.921
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.810585
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.501 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=1.0 class 1 = 0.444 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=1.0 class 2 = 0.544 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=1.0 all KL = 0.512 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=1.0 all L1 = 0.495 +- 0.170 (in-sample avg dev_std = 0.541)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:53:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:44 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:49 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:53:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.724
WIoU for r=0.3 = 0.691
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.785
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.784
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.783


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  0.7237649999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.69148875
len(reference) = 797
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.439
SUFF++ for r=0.3 class 0 = 0.479 +- 0.268 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 1 = 0.493 +- 0.268 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 2 = 0.427 +- 0.268 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all KL = 0.4 +- 0.268 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all L1 = 0.467 +- 0.150 (in-sample avg dev_std = 0.594)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.613355
Model XAI WIoU of binarized graphs for r=0.6 =  0.7850575000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.732
SUFF++ for r=0.6 class 0 = 0.591 +- 0.284 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.7 +- 0.284 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.618 +- 0.284 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.603 +- 0.284 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.637 +- 0.200 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.47385
Model XAI WIoU of binarized graphs for r=0.9 =  0.783575
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.744 +- 0.204 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 1 = 0.78 +- 0.204 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 2 = 0.809 +- 0.204 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all KL = 0.834 +- 0.204 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all L1 = 0.778 +- 0.190 (in-sample avg dev_std = 0.286)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  0.7237649999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.69148875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.614 +- 0.283 (in-sample avg dev_std = 0.478)
NEC for r=0.3 class 1 = 0.578 +- 0.283 (in-sample avg dev_std = 0.478)
NEC for r=0.3 class 2 = 0.636 +- 0.283 (in-sample avg dev_std = 0.478)
NEC for r=0.3 all KL = 0.661 +- 0.283 (in-sample avg dev_std = 0.478)
NEC for r=0.3 all L1 = 0.609 +- 0.154 (in-sample avg dev_std = 0.478)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.613355
Model XAI WIoU of binarized graphs for r=0.6 =  0.7850575000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.471
NEC for r=0.6 class 0 = 0.543 +- 0.285 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 1 = 0.576 +- 0.285 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 2 = 0.605 +- 0.285 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all KL = 0.633 +- 0.285 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all L1 = 0.575 +- 0.156 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.47385
Model XAI WIoU of binarized graphs for r=0.9 =  0.783575
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.539
NEC for r=0.9 class 0 = 0.485 +- 0.273 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 1 = 0.534 +- 0.273 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 2 = 0.539 +- 0.273 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all KL = 0.551 +- 0.273 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all L1 = 0.519 +- 0.155 (in-sample avg dev_std = 0.539)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7828750000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.546
NEC for r=1.0 class 0 = 0.477 +- 0.272 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 1 = 0.536 +- 0.272 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 2 = 0.532 +- 0.272 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all KL = 0.548 +- 0.272 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all L1 = 0.515 +- 0.153 (in-sample avg dev_std = 0.547)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.417, 0.627, 0.875, 1.0], 'all_L1': [0.486, 0.64, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.648, 0.842, 1.0], 'all_L1': [0.463, 0.639, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.574, 0.802, 1.0], 'all_L1': [0.498, 0.62, 0.754, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.644, 0.846, 1.0], 'all_L1': [0.517, 0.656, 0.803, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.603, 0.834, 1.0], 'all_L1': [0.467, 0.637, 0.778, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.617, 0.591, 0.525, 0.524], 'all_L1': [0.568, 0.553, 0.504, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.569, 0.508, 0.497], 'all_L1': [0.572, 0.555, 0.51, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.624, 0.557, 0.559], 'all_L1': [0.593, 0.568, 0.52, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.692, 0.594, 0.519, 0.512], 'all_L1': [0.601, 0.562, 0.504, 0.495]}), defaultdict(<class 'list'>, {'all_KL': [0.661, 0.633, 0.551, 0.548], 'all_L1': [0.609, 0.575, 0.519, 0.515]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.486 +- 0.020, 0.638 +- 0.011, 0.787 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.407 +- 0.006, 0.619 +- 0.028, 0.840 +- 0.023, 1.000 +- 0.000
suff++_acc_int  =  0.468 +- 0.032, 0.733 +- 0.015, 0.849 +- 0.020
nec class all_L1  =  0.589 +- 0.016, 0.563 +- 0.008, 0.511 +- 0.007, 0.507 +- 0.009
nec class all_KL  =  0.647 +- 0.032, 0.602 +- 0.023, 0.532 +- 0.019, 0.528 +- 0.023
nec_acc_int  =  0.371 +- 0.017, 0.475 +- 0.010, 0.551 +- 0.012, 0.557 +- 0.012


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.537 +- 0.014, 0.600 +- 0.006, 0.649 +- 0.009, 0.753 +- 0.005
Faith. Armon (L1)= 		  =  0.532 +- 0.015, 0.598 +- 0.006, 0.620 +- 0.004, 0.672 +- 0.008
Faith. GMean (L1)= 	  =  0.535 +- 0.015, 0.599 +- 0.006, 0.634 +- 0.006, 0.712 +- 0.006
Faith. Aritm (KL)= 		  =  0.527 +- 0.014, 0.611 +- 0.007, 0.686 +- 0.009, 0.764 +- 0.011
Faith. Armon (KL)= 		  =  0.500 +- 0.007, 0.610 +- 0.008, 0.651 +- 0.011, 0.691 +- 0.020
Faith. GMean (KL)= 	  =  0.513 +- 0.011, 0.610 +- 0.007, 0.668 +- 0.009, 0.726 +- 0.016
Computed for split load_split = id



Completed in  0:09:27.535292  for LECIGIN GOODMotif/basis



DONE LECI GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:55:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:55:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.706
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.627
WIoU for r=0.6 = 0.746
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.738
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.738


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.526
Model XAI F1 of binarized graphs for r=0.3 =  0.7055750000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.65595125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
SUFF++ for r=0.3 class 0 = 0.556 +- 0.287 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 class 1 = 0.56 +- 0.287 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 class 2 = 0.535 +- 0.287 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 all KL = 0.514 +- 0.287 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 all L1 = 0.55 +- 0.191 (in-sample avg dev_std = 0.526)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.6268050000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.74612875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.751
SUFF++ for r=0.6 class 0 = 0.699 +- 0.265 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 1 = 0.639 +- 0.265 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 2 = 0.661 +- 0.265 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all KL = 0.691 +- 0.265 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all L1 = 0.666 +- 0.211 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  0.482235
Model XAI WIoU of binarized graphs for r=0.9 =  0.7379025
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.825
SUFF++ for r=0.9 class 0 = 0.807 +- 0.181 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 1 = 0.732 +- 0.181 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 2 = 0.806 +- 0.181 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all KL = 0.866 +- 0.181 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all L1 = 0.782 +- 0.191 (in-sample avg dev_std = 0.236)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.526
Model XAI F1 of binarized graphs for r=0.3 =  0.7055750000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.65595125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.372
NEC for r=0.3 class 0 = 0.576 +- 0.285 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 1 = 0.507 +- 0.285 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 2 = 0.565 +- 0.285 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all KL = 0.576 +- 0.285 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all L1 = 0.549 +- 0.169 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.6268050000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.74612875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.492
NEC for r=0.6 class 0 = 0.589 +- 0.323 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 1 = 0.429 +- 0.323 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 2 = 0.598 +- 0.323 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all KL = 0.55 +- 0.323 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all L1 = 0.538 +- 0.184 (in-sample avg dev_std = 0.474)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  0.482235
Model XAI WIoU of binarized graphs for r=0.9 =  0.7379025
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.583
NEC for r=0.9 class 0 = 0.505 +- 0.306 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 1 = 0.402 +- 0.306 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 2 = 0.522 +- 0.306 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all KL = 0.467 +- 0.306 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all L1 = 0.476 +- 0.175 (in-sample avg dev_std = 0.501)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.7378762499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.583
NEC for r=1.0 class 0 = 0.505 +- 0.309 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 1 = 0.398 +- 0.309 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 2 = 0.521 +- 0.309 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all KL = 0.464 +- 0.309 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all L1 = 0.475 +- 0.175 (in-sample avg dev_std = 0.501)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:57:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:57:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.732
WIoU for r=0.3 = 0.700
F1 for r=0.6 = 0.627
WIoU for r=0.6 = 0.772
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.770
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.770


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.7318600000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.69971125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.51
SUFF++ for r=0.3 class 0 = 0.493 +- 0.263 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 class 1 = 0.637 +- 0.263 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 class 2 = 0.511 +- 0.263 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 all KL = 0.491 +- 0.263 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 all L1 = 0.548 +- 0.160 (in-sample avg dev_std = 0.528)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.885
Model XAI F1 of binarized graphs for r=0.6 =  0.627055
Model XAI WIoU of binarized graphs for r=0.6 =  0.772235
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.731
SUFF++ for r=0.6 class 0 = 0.64 +- 0.260 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 1 = 0.645 +- 0.260 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 2 = 0.66 +- 0.260 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all KL = 0.639 +- 0.260 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all L1 = 0.648 +- 0.188 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.482235
Model XAI WIoU of binarized graphs for r=0.9 =  0.7697787500000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0 = 0.801 +- 0.185 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 1 = 0.799 +- 0.185 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 2 = 0.795 +- 0.185 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all KL = 0.86 +- 0.185 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.182 (in-sample avg dev_std = 0.273)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.7318600000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.69971125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.583 +- 0.278 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.506 +- 0.278 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.565 +- 0.278 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.601 +- 0.278 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.551 +- 0.146 (in-sample avg dev_std = 0.403)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.885
Model XAI F1 of binarized graphs for r=0.6 =  0.627055
Model XAI WIoU of binarized graphs for r=0.6 =  0.772235
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.447
NEC for r=0.6 class 0 = 0.576 +- 0.310 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 1 = 0.519 +- 0.310 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 2 = 0.603 +- 0.310 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all KL = 0.603 +- 0.310 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all L1 = 0.566 +- 0.164 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.482235
Model XAI WIoU of binarized graphs for r=0.9 =  0.7697787500000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.53
NEC for r=0.9 class 0 = 0.499 +- 0.285 (in-sample avg dev_std = 0.490)
NEC for r=0.9 class 1 = 0.475 +- 0.285 (in-sample avg dev_std = 0.490)
NEC for r=0.9 class 2 = 0.554 +- 0.285 (in-sample avg dev_std = 0.490)
NEC for r=0.9 all KL = 0.507 +- 0.285 (in-sample avg dev_std = 0.490)
NEC for r=0.9 all L1 = 0.509 +- 0.164 (in-sample avg dev_std = 0.490)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.7697575000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.537
NEC for r=1.0 class 0 = 0.502 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=1.0 class 1 = 0.486 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=1.0 class 2 = 0.543 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=1.0 all KL = 0.509 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=1.0 all L1 = 0.51 +- 0.160 (in-sample avg dev_std = 0.496)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 19:58:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 07:58:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.663
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.610
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.707
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.707


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.516
Model XAI F1 of binarized graphs for r=0.3 =  0.6627199999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5893349999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.413
SUFF++ for r=0.3 class 0 = 0.492 +- 0.261 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 1 = 0.549 +- 0.261 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 2 = 0.471 +- 0.261 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all KL = 0.452 +- 0.261 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all L1 = 0.504 +- 0.160 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.848
Model XAI F1 of binarized graphs for r=0.6 =  0.6102075
Model XAI WIoU of binarized graphs for r=0.6 =  0.6925625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.73
SUFF++ for r=0.6 class 0 = 0.626 +- 0.286 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 class 1 = 0.651 +- 0.286 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 class 2 = 0.676 +- 0.286 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 all KL = 0.609 +- 0.286 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 all L1 = 0.651 +- 0.207 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.482235
Model XAI WIoU of binarized graphs for r=0.9 =  0.7067475000000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0 = 0.791 +- 0.202 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.784 +- 0.202 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.819 +- 0.202 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.835 +- 0.202 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.181 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  0.6627199999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5893349999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.597 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 class 1 = 0.517 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 class 2 = 0.562 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 all KL = 0.597 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 all L1 = 0.559 +- 0.165 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.848
Model XAI F1 of binarized graphs for r=0.6 =  0.6102075
Model XAI WIoU of binarized graphs for r=0.6 =  0.6925625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.451
NEC for r=0.6 class 0 = 0.573 +- 0.284 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 1 = 0.51 +- 0.284 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 2 = 0.62 +- 0.284 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all KL = 0.623 +- 0.284 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all L1 = 0.567 +- 0.169 (in-sample avg dev_std = 0.525)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.482235
Model XAI WIoU of binarized graphs for r=0.9 =  0.7067475000000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.527
NEC for r=0.9 class 0 = 0.529 +- 0.300 (in-sample avg dev_std = 0.563)
NEC for r=0.9 class 1 = 0.485 +- 0.300 (in-sample avg dev_std = 0.563)
NEC for r=0.9 class 2 = 0.575 +- 0.300 (in-sample avg dev_std = 0.563)
NEC for r=0.9 all KL = 0.569 +- 0.300 (in-sample avg dev_std = 0.563)
NEC for r=0.9 all L1 = 0.53 +- 0.175 (in-sample avg dev_std = 0.563)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.70674625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.554
NEC for r=1.0 class 0 = 0.519 +- 0.291 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 1 = 0.472 +- 0.291 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 2 = 0.555 +- 0.291 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all KL = 0.551 +- 0.291 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all L1 = 0.515 +- 0.167 (in-sample avg dev_std = 0.565)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:00:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:00:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.743
WIoU for r=0.3 = 0.843
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.909
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.914
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.914


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.649
Model XAI F1 of binarized graphs for r=0.3 =  0.7428224999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.84283375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.51
SUFF++ for r=0.3 class 0 = 0.515 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1 = 0.661 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 2 = 0.542 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.582 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.573 +- 0.166 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.613445
Model XAI WIoU of binarized graphs for r=0.6 =  0.9089087499999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.745
SUFF++ for r=0.6 class 0 = 0.629 +- 0.196 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 class 1 = 0.745 +- 0.196 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 class 2 = 0.764 +- 0.196 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 all KL = 0.796 +- 0.196 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 all L1 = 0.713 +- 0.174 (in-sample avg dev_std = 0.312)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  0.4815350000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.9135324999999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.845
SUFF++ for r=0.9 class 0 = 0.825 +- 0.108 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.108 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 class 2 = 0.891 +- 0.108 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 all KL = 0.932 +- 0.108 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.139 (in-sample avg dev_std = 0.190)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.65
Model XAI F1 of binarized graphs for r=0.3 =  0.7428224999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.84283375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.36
NEC for r=0.3 class 0 = 0.471 +- 0.339 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 1 = 0.447 +- 0.339 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 2 = 0.573 +- 0.339 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all KL = 0.482 +- 0.339 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all L1 = 0.497 +- 0.178 (in-sample avg dev_std = 0.385)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.613445
Model XAI WIoU of binarized graphs for r=0.6 =  0.9089087499999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.463
NEC for r=0.6 class 0 = 0.44 +- 0.307 (in-sample avg dev_std = 0.440)
NEC for r=0.6 class 1 = 0.43 +- 0.307 (in-sample avg dev_std = 0.440)
NEC for r=0.6 class 2 = 0.589 +- 0.307 (in-sample avg dev_std = 0.440)
NEC for r=0.6 all KL = 0.437 +- 0.307 (in-sample avg dev_std = 0.440)
NEC for r=0.6 all L1 = 0.486 +- 0.174 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  0.4815350000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.9135324999999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.544
NEC for r=0.9 class 0 = 0.387 +- 0.300 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 1 = 0.376 +- 0.300 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 2 = 0.527 +- 0.300 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all KL = 0.356 +- 0.300 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all L1 = 0.43 +- 0.176 (in-sample avg dev_std = 0.450)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.885
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.9135324999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.385 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=1.0 class 1 = 0.371 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=1.0 class 2 = 0.514 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=1.0 all KL = 0.351 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=1.0 all L1 = 0.423 +- 0.173 (in-sample avg dev_std = 0.452)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:01:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:01:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.705
WIoU for r=0.3 = 0.655
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.724
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.718
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.718


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.57
Model XAI F1 of binarized graphs for r=0.3 =  0.7050399999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6546474999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.534
SUFF++ for r=0.3 class 0 = 0.47 +- 0.292 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 1 = 0.554 +- 0.292 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 2 = 0.475 +- 0.292 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all KL = 0.364 +- 0.292 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all L1 = 0.5 +- 0.183 (in-sample avg dev_std = 0.614)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.61284375
Model XAI WIoU of binarized graphs for r=0.6 =  0.72398375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0 = 0.6 +- 0.304 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.694 +- 0.304 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.712 +- 0.304 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.628 +- 0.304 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.669 +- 0.222 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.481895
Model XAI WIoU of binarized graphs for r=0.9 =  0.71830125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0 = 0.748 +- 0.231 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1 = 0.802 +- 0.231 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.231 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.841 +- 0.231 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.803 +- 0.204 (in-sample avg dev_std = 0.278)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  0.7050399999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6546474999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.396
NEC for r=0.3 class 0 = 0.593 +- 0.303 (in-sample avg dev_std = 0.566)
NEC for r=0.3 class 1 = 0.511 +- 0.303 (in-sample avg dev_std = 0.566)
NEC for r=0.3 class 2 = 0.67 +- 0.303 (in-sample avg dev_std = 0.566)
NEC for r=0.3 all KL = 0.7 +- 0.303 (in-sample avg dev_std = 0.566)
NEC for r=0.3 all L1 = 0.591 +- 0.169 (in-sample avg dev_std = 0.566)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.61284375
Model XAI WIoU of binarized graphs for r=0.6 =  0.72398375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.498
NEC for r=0.6 class 0 = 0.505 +- 0.326 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 1 = 0.463 +- 0.326 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 2 = 0.631 +- 0.326 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all KL = 0.612 +- 0.326 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all L1 = 0.533 +- 0.179 (in-sample avg dev_std = 0.550)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.481895
Model XAI WIoU of binarized graphs for r=0.9 =  0.71830125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.564
NEC for r=0.9 class 0 = 0.462 +- 0.317 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 1 = 0.435 +- 0.317 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 2 = 0.562 +- 0.317 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all KL = 0.528 +- 0.317 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all L1 = 0.486 +- 0.173 (in-sample avg dev_std = 0.560)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.7180312499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.582
NEC for r=1.0 class 0 = 0.451 +- 0.313 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 1 = 0.432 +- 0.313 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 2 = 0.541 +- 0.313 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all KL = 0.519 +- 0.313 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all L1 = 0.475 +- 0.171 (in-sample avg dev_std = 0.562)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.514, 0.691, 0.866, 1.0], 'all_L1': [0.55, 0.666, 0.782, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.639, 0.86, 1.0], 'all_L1': [0.548, 0.648, 0.799, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.452, 0.609, 0.835, 1.0], 'all_L1': [0.504, 0.651, 0.798, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.796, 0.932, 1.0], 'all_L1': [0.573, 0.713, 0.852, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.628, 0.841, 1.0], 'all_L1': [0.5, 0.669, 0.803, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.576, 0.55, 0.467, 0.464], 'all_L1': [0.549, 0.538, 0.476, 0.475]}), defaultdict(<class 'list'>, {'all_KL': [0.601, 0.603, 0.507, 0.509], 'all_L1': [0.551, 0.566, 0.509, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.623, 0.569, 0.551], 'all_L1': [0.559, 0.567, 0.53, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.437, 0.356, 0.351], 'all_L1': [0.497, 0.486, 0.43, 0.423]}), defaultdict(<class 'list'>, {'all_KL': [0.7, 0.612, 0.528, 0.519], 'all_L1': [0.591, 0.533, 0.486, 0.475]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.535 +- 0.028, 0.669 +- 0.023, 0.807 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.481 +- 0.072, 0.673 +- 0.067, 0.867 +- 0.035, 1.000 +- 0.000
suff++_acc_int  =  0.497 +- 0.043, 0.743 +- 0.010, 0.837 +- 0.008
nec class all_L1  =  0.549 +- 0.030, 0.538 +- 0.030, 0.486 +- 0.034, 0.480 +- 0.033
nec class all_KL  =  0.591 +- 0.069, 0.565 +- 0.069, 0.485 +- 0.073, 0.479 +- 0.070
nec_acc_int  =  0.367 +- 0.018, 0.470 +- 0.021, 0.550 +- 0.021, 0.562 +- 0.018


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.542 +- 0.008, 0.604 +- 0.004, 0.646 +- 0.012, 0.740 +- 0.016
Faith. Armon (L1)= 		  =  0.541 +- 0.008, 0.595 +- 0.010, 0.606 +- 0.023, 0.648 +- 0.031
Faith. GMean (L1)= 	  =  0.541 +- 0.008, 0.600 +- 0.007, 0.626 +- 0.017, 0.692 +- 0.024
Faith. Aritm (KL)= 		  =  0.536 +- 0.008, 0.619 +- 0.002, 0.676 +- 0.020, 0.739 +- 0.035
Faith. Armon (KL)= 		  =  0.521 +- 0.023, 0.607 +- 0.021, 0.617 +- 0.056, 0.644 +- 0.067
Faith. GMean (KL)= 	  =  0.528 +- 0.015, 0.613 +- 0.012, 0.646 +- 0.039, 0.690 +- 0.053
Computed for split load_split = id



Completed in  0:07:18.237801  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:03:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 08:03:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:03:59 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:01 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:03 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:04:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.511
WIoU for r=0.3 = 0.390
F1 for r=0.6 = 0.584
WIoU for r=0.6 = 0.473
F1 for r=0.9 = 0.535
WIoU for r=0.9 = 0.442
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.425


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.378
Model XAI F1 of binarized graphs for r=0.3 =  0.51052875
Model XAI WIoU of binarized graphs for r=0.3 =  0.39008875000000004
len(reference) = 770
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.359
SUFF++ for r=0.3 class 0 = 0.74 +- 0.141 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 1 = 0.804 +- 0.141 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 2 = 0.768 +- 0.141 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 all KL = 0.889 +- 0.141 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 all L1 = 0.771 +- 0.142 (in-sample avg dev_std = 0.270)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.5843550000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.472815
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.507
SUFF++ for r=0.6 class 0 = 0.725 +- 0.231 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 1 = 0.86 +- 0.231 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 2 = 0.742 +- 0.231 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all KL = 0.819 +- 0.231 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all L1 = 0.776 +- 0.204 (in-sample avg dev_std = 0.371)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.804
Model XAI F1 of binarized graphs for r=0.9 =  0.5351312500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.44183000000000006
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.79
SUFF++ for r=0.9 class 0 = 0.802 +- 0.200 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.200 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 2 = 0.825 +- 0.200 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all KL = 0.877 +- 0.200 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all L1 = 0.824 +- 0.217 (in-sample avg dev_std = 0.240)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.38
Model XAI F1 of binarized graphs for r=0.3 =  0.51052875
Model XAI WIoU of binarized graphs for r=0.3 =  0.39008875000000004
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.285 +- 0.191 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1 = 0.203 +- 0.191 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 2 = 0.247 +- 0.191 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.126 +- 0.191 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.245 +- 0.183 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.5843550000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.472815
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.426
NEC for r=0.6 class 0 = 0.44 +- 0.286 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 1 = 0.246 +- 0.286 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 2 = 0.458 +- 0.286 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all KL = 0.35 +- 0.286 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all L1 = 0.38 +- 0.238 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.804
Model XAI F1 of binarized graphs for r=0.9 =  0.5351312500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.44183000000000006
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.499
NEC for r=0.9 class 0 = 0.61 +- 0.283 (in-sample avg dev_std = 0.550)
NEC for r=0.9 class 1 = 0.349 +- 0.283 (in-sample avg dev_std = 0.550)
NEC for r=0.9 class 2 = 0.603 +- 0.283 (in-sample avg dev_std = 0.550)
NEC for r=0.9 all KL = 0.525 +- 0.283 (in-sample avg dev_std = 0.550)
NEC for r=0.9 all L1 = 0.52 +- 0.212 (in-sample avg dev_std = 0.550)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.865
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.42487250000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.572 +- 0.297 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 1 = 0.327 +- 0.297 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 2 = 0.567 +- 0.297 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all KL = 0.502 +- 0.297 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all L1 = 0.488 +- 0.217 (in-sample avg dev_std = 0.570)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:05:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 08:05:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:05:59 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:08 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:06:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.509
WIoU for r=0.3 = 0.389
F1 for r=0.6 = 0.582
WIoU for r=0.6 = 0.472
F1 for r=0.9 = 0.532
WIoU for r=0.9 = 0.446
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.432


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.384
Model XAI F1 of binarized graphs for r=0.3 =  0.5089975
Model XAI WIoU of binarized graphs for r=0.3 =  0.38880625
len(reference) = 748
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.356
SUFF++ for r=0.3 class 0 = 0.775 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 1 = 0.829 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 2 = 0.788 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all KL = 0.906 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.139 (in-sample avg dev_std = 0.247)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.564
Model XAI F1 of binarized graphs for r=0.6 =  0.5821424999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4719175
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.516
SUFF++ for r=0.6 class 0 = 0.659 +- 0.258 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 1 = 0.796 +- 0.258 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 2 = 0.702 +- 0.258 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all KL = 0.745 +- 0.258 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all L1 = 0.719 +- 0.205 (in-sample avg dev_std = 0.463)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.776
Model XAI F1 of binarized graphs for r=0.9 =  0.53219375
Model XAI WIoU of binarized graphs for r=0.9 =  0.44612999999999997
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.77
SUFF++ for r=0.9 class 0 = 0.831 +- 0.213 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 1 = 0.866 +- 0.213 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 2 = 0.836 +- 0.213 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all KL = 0.871 +- 0.213 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.199 (in-sample avg dev_std = 0.284)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.384
Model XAI F1 of binarized graphs for r=0.3 =  0.5089975
Model XAI WIoU of binarized graphs for r=0.3 =  0.38880625
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.234 +- 0.194 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 1 = 0.174 +- 0.194 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 2 = 0.227 +- 0.194 (in-sample avg dev_std = 0.184)
NEC for r=0.3 all KL = 0.105 +- 0.194 (in-sample avg dev_std = 0.184)
NEC for r=0.3 all L1 = 0.211 +- 0.177 (in-sample avg dev_std = 0.184)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.564
Model XAI F1 of binarized graphs for r=0.6 =  0.5821424999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4719175
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.466 +- 0.317 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 1 = 0.302 +- 0.317 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 2 = 0.472 +- 0.317 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all KL = 0.389 +- 0.317 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all L1 = 0.412 +- 0.237 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.776
Model XAI F1 of binarized graphs for r=0.9 =  0.53219375
Model XAI WIoU of binarized graphs for r=0.9 =  0.44612999999999997
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.494
NEC for r=0.9 class 0 = 0.586 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 1 = 0.353 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 2 = 0.592 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all KL = 0.552 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all L1 = 0.509 +- 0.207 (in-sample avg dev_std = 0.600)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.873
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.43152749999999995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.518
NEC for r=1.0 class 0 = 0.592 +- 0.306 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 1 = 0.348 +- 0.306 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 2 = 0.579 +- 0.306 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all KL = 0.549 +- 0.306 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all L1 = 0.505 +- 0.220 (in-sample avg dev_std = 0.606)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:07:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 08:07:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:07:53 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:07:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:07:58 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:08:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.600
WIoU for r=0.3 = 0.490
F1 for r=0.6 = 0.625
WIoU for r=0.6 = 0.596
F1 for r=0.9 = 0.528
WIoU for r=0.9 = 0.598
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.599


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.407
Model XAI F1 of binarized graphs for r=0.3 =  0.60016875
Model XAI WIoU of binarized graphs for r=0.3 =  0.48961124999999994
len(reference) = 769
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.377
SUFF++ for r=0.3 class 0 = 0.827 +- 0.226 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 class 1 = 0.93 +- 0.226 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 class 2 = 0.828 +- 0.226 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 all KL = 0.887 +- 0.226 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 all L1 = 0.863 +- 0.196 (in-sample avg dev_std = 0.290)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.671
Model XAI F1 of binarized graphs for r=0.6 =  0.6245625
Model XAI WIoU of binarized graphs for r=0.6 =  0.5960025
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.632
SUFF++ for r=0.6 class 0 = 0.748 +- 0.237 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.843 +- 0.237 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.237 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.795 +- 0.237 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.782 +- 0.209 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  0.5284375
Model XAI WIoU of binarized graphs for r=0.9 =  0.598425
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.779
SUFF++ for r=0.9 class 0 = 0.864 +- 0.193 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 1 = 0.887 +- 0.193 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 2 = 0.898 +- 0.193 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all KL = 0.898 +- 0.193 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all L1 = 0.883 +- 0.182 (in-sample avg dev_std = 0.280)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.401
Model XAI F1 of binarized graphs for r=0.3 =  0.60016875
Model XAI WIoU of binarized graphs for r=0.3 =  0.48961124999999994
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.198 +- 0.258 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1 = 0.113 +- 0.258 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 2 = 0.192 +- 0.258 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.122 +- 0.258 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.167 +- 0.232 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.671
Model XAI F1 of binarized graphs for r=0.6 =  0.6245625
Model XAI WIoU of binarized graphs for r=0.6 =  0.5960025
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.402
NEC for r=0.6 class 0 = 0.532 +- 0.366 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 1 = 0.249 +- 0.366 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 2 = 0.523 +- 0.366 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all KL = 0.444 +- 0.366 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all L1 = 0.433 +- 0.287 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  0.5284375
Model XAI WIoU of binarized graphs for r=0.9 =  0.598425
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.482
NEC for r=0.9 class 0 = 0.629 +- 0.333 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 1 = 0.284 +- 0.333 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 2 = 0.594 +- 0.333 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all KL = 0.559 +- 0.333 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all L1 = 0.501 +- 0.260 (in-sample avg dev_std = 0.609)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.5987187500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.528
NEC for r=1.0 class 0 = 0.625 +- 0.334 (in-sample avg dev_std = 0.642)
NEC for r=1.0 class 1 = 0.256 +- 0.334 (in-sample avg dev_std = 0.642)
NEC for r=1.0 class 2 = 0.59 +- 0.334 (in-sample avg dev_std = 0.642)
NEC for r=1.0 all KL = 0.568 +- 0.334 (in-sample avg dev_std = 0.642)
NEC for r=1.0 all L1 = 0.489 +- 0.265 (in-sample avg dev_std = 0.642)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:09:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 08:09:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:09:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:09:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:09:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:09:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:10:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.422
WIoU for r=0.3 = 0.366
F1 for r=0.6 = 0.424
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.415
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.417


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.457
Model XAI F1 of binarized graphs for r=0.3 =  0.42203
Model XAI WIoU of binarized graphs for r=0.3 =  0.36602250000000003
len(reference) = 792
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.417
SUFF++ for r=0.3 class 0 = 0.63 +- 0.305 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 1 = 0.762 +- 0.305 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 2 = 0.74 +- 0.305 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all KL = 0.705 +- 0.305 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all L1 = 0.711 +- 0.267 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.582
Model XAI F1 of binarized graphs for r=0.6 =  0.42350875000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.37442125000000004
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.457
SUFF++ for r=0.6 class 0 = 0.393 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 1 = 0.591 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 2 = 0.546 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all KL = 0.517 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all L1 = 0.511 +- 0.230 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.47186124999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.41535249999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.707
SUFF++ for r=0.9 class 0 = 0.628 +- 0.302 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.9 class 1 = 0.726 +- 0.302 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.9 class 2 = 0.721 +- 0.302 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.9 all KL = 0.679 +- 0.302 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.9 all L1 = 0.692 +- 0.254 (in-sample avg dev_std = 0.510)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.455
Model XAI F1 of binarized graphs for r=0.3 =  0.42203
Model XAI WIoU of binarized graphs for r=0.3 =  0.36602250000000003
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.352
NEC for r=0.3 class 0 = 0.439 +- 0.361 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 1 = 0.237 +- 0.361 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 2 = 0.36 +- 0.361 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all KL = 0.353 +- 0.361 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all L1 = 0.344 +- 0.313 (in-sample avg dev_std = 0.372)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.582
Model XAI F1 of binarized graphs for r=0.6 =  0.42350875000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.37442125000000004
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.409
NEC for r=0.6 class 0 = 0.624 +- 0.312 (in-sample avg dev_std = 0.517)
NEC for r=0.6 class 1 = 0.369 +- 0.312 (in-sample avg dev_std = 0.517)
NEC for r=0.6 class 2 = 0.585 +- 0.312 (in-sample avg dev_std = 0.517)
NEC for r=0.6 all KL = 0.526 +- 0.312 (in-sample avg dev_std = 0.517)
NEC for r=0.6 all L1 = 0.525 +- 0.248 (in-sample avg dev_std = 0.517)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.47186124999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.41535249999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.506
NEC for r=0.9 class 0 = 0.63 +- 0.318 (in-sample avg dev_std = 0.635)
NEC for r=0.9 class 1 = 0.277 +- 0.318 (in-sample avg dev_std = 0.635)
NEC for r=0.9 class 2 = 0.612 +- 0.318 (in-sample avg dev_std = 0.635)
NEC for r=0.9 all KL = 0.572 +- 0.318 (in-sample avg dev_std = 0.635)
NEC for r=0.9 all L1 = 0.505 +- 0.255 (in-sample avg dev_std = 0.635)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.41749749999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.537
NEC for r=1.0 class 0 = 0.593 +- 0.298 (in-sample avg dev_std = 0.676)
NEC for r=1.0 class 1 = 0.284 +- 0.298 (in-sample avg dev_std = 0.676)
NEC for r=1.0 class 2 = 0.595 +- 0.298 (in-sample avg dev_std = 0.676)
NEC for r=1.0 all KL = 0.572 +- 0.298 (in-sample avg dev_std = 0.676)
NEC for r=1.0 all L1 = 0.489 +- 0.235 (in-sample avg dev_std = 0.676)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:11:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:11:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.326
WIoU for r=0.3 = 0.250
F1 for r=0.6 = 0.415
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.503
WIoU for r=0.9 = 0.395
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.399


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.315
Model XAI F1 of binarized graphs for r=0.3 =  0.32562624999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.25022999999999995
len(reference) = 783
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF++ for r=0.3 class 0 = 0.72 +- 0.158 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.3 class 1 = 0.776 +- 0.158 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.3 class 2 = 0.778 +- 0.158 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.3 all KL = 0.865 +- 0.158 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.3 all L1 = 0.758 +- 0.146 (in-sample avg dev_std = 0.308)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.37
Model XAI F1 of binarized graphs for r=0.6 =  0.4154375
Model XAI WIoU of binarized graphs for r=0.6 =  0.3130325
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.385
SUFF++ for r=0.6 class 0 = 0.547 +- 0.260 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 1 = 0.619 +- 0.260 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 2 = 0.581 +- 0.260 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all KL = 0.631 +- 0.260 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all L1 = 0.583 +- 0.194 (in-sample avg dev_std = 0.515)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.5028975
Model XAI WIoU of binarized graphs for r=0.9 =  0.39516999999999997
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.631
SUFF++ for r=0.9 class 0 = 0.588 +- 0.290 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.9 class 1 = 0.777 +- 0.290 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.9 class 2 = 0.611 +- 0.290 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.9 all KL = 0.675 +- 0.290 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.9 all L1 = 0.66 +- 0.263 (in-sample avg dev_std = 0.469)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.311
Model XAI F1 of binarized graphs for r=0.3 =  0.32562624999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.25022999999999995
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.307
NEC for r=0.3 class 0 = 0.258 +- 0.180 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 1 = 0.213 +- 0.180 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 2 = 0.215 +- 0.180 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all KL = 0.117 +- 0.180 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all L1 = 0.229 +- 0.185 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.369
Model XAI F1 of binarized graphs for r=0.6 =  0.4154375
Model XAI WIoU of binarized graphs for r=0.6 =  0.3130325
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.358
NEC for r=0.6 class 0 = 0.458 +- 0.293 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 1 = 0.397 +- 0.293 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 2 = 0.424 +- 0.293 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all KL = 0.372 +- 0.293 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all L1 = 0.426 +- 0.218 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.731
Model XAI F1 of binarized graphs for r=0.9 =  0.5028975
Model XAI WIoU of binarized graphs for r=0.9 =  0.39516999999999997
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.478
NEC for r=0.9 class 0 = 0.619 +- 0.310 (in-sample avg dev_std = 0.542)
NEC for r=0.9 class 1 = 0.285 +- 0.310 (in-sample avg dev_std = 0.542)
NEC for r=0.9 class 2 = 0.603 +- 0.310 (in-sample avg dev_std = 0.542)
NEC for r=0.9 all KL = 0.501 +- 0.310 (in-sample avg dev_std = 0.542)
NEC for r=0.9 all L1 = 0.501 +- 0.245 (in-sample avg dev_std = 0.542)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.892
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.39866875000000007
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0 = 0.591 +- 0.322 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 1 = 0.228 +- 0.322 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 2 = 0.605 +- 0.322 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all KL = 0.517 +- 0.322 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all L1 = 0.473 +- 0.247 (in-sample avg dev_std = 0.611)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.889, 0.819, 0.877, 1.0], 'all_L1': [0.771, 0.776, 0.824, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.906, 0.745, 0.871, 1.0], 'all_L1': [0.798, 0.719, 0.844, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.887, 0.795, 0.898, 1.0], 'all_L1': [0.863, 0.782, 0.883, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.705, 0.517, 0.679, 1.0], 'all_L1': [0.711, 0.511, 0.692, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.865, 0.631, 0.675, 1.0], 'all_L1': [0.758, 0.583, 0.66, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.126, 0.35, 0.525, 0.502], 'all_L1': [0.245, 0.38, 0.52, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.105, 0.389, 0.552, 0.549], 'all_L1': [0.211, 0.412, 0.509, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.122, 0.444, 0.559, 0.568], 'all_L1': [0.167, 0.433, 0.501, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.353, 0.526, 0.572, 0.572], 'all_L1': [0.344, 0.525, 0.505, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.117, 0.372, 0.501, 0.517], 'all_L1': [0.229, 0.426, 0.501, 0.473]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.780 +- 0.050, 0.674 +- 0.109, 0.781 +- 0.088, 1.000 +- 0.000
suff++ class all_KL  =  0.850 +- 0.074, 0.701 +- 0.113, 0.800 +- 0.101, 1.000 +- 0.000
suff++_acc_int  =  0.371 +- 0.025, 0.499 +- 0.081, 0.735 +- 0.060
nec class all_L1  =  0.239 +- 0.059, 0.435 +- 0.048, 0.507 +- 0.007, 0.489 +- 0.010
nec class all_KL  =  0.165 +- 0.094, 0.416 +- 0.063, 0.542 +- 0.026, 0.542 +- 0.028
nec_acc_int  =  0.340 +- 0.016, 0.400 +- 0.022, 0.492 +- 0.010, 0.532 +- 0.009


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.510 +- 0.011, 0.555 +- 0.038, 0.644 +- 0.045, 0.744 +- 0.005
Faith. Armon (L1)= 		  =  0.360 +- 0.060, 0.520 +- 0.021, 0.613 +- 0.030, 0.657 +- 0.009
Faith. GMean (L1)= 	  =  0.427 +- 0.038, 0.537 +- 0.028, 0.628 +- 0.037, 0.699 +- 0.007
Faith. Aritm (KL)= 		  =  0.507 +- 0.012, 0.559 +- 0.043, 0.671 +- 0.054, 0.771 +- 0.014
Faith. Armon (KL)= 		  =  0.260 +- 0.106, 0.512 +- 0.034, 0.644 +- 0.041, 0.702 +- 0.023
Faith. GMean (KL)= 	  =  0.358 +- 0.071, 0.535 +- 0.035, 0.657 +- 0.047, 0.736 +- 0.019
Computed for split load_split = id



Completed in  0:09:37.241303  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:13:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:13:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.9151
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8823
OOD Validation Loss: 0.6328
OOD Test ACCURACY: 0.8311
OOD Test Loss: 1.1309

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.9130
ID Test Loss: 0.4650
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6111
OOD Test ACCURACY: 0.8308
OOD Test Loss: 1.1121

[0m[1;37mINFO[0m: [1mChartInfo 0.9151 0.8311 0.9130 0.8308 0.9172 0.8837[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/13/2024 08:14:00 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.931
SUFF++ for r=0.6 class 0.0 = 0.859 +- 0.339 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 class 1.0 = 0.893 +- 0.339 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all KL = 0.703 +- 0.339 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all L1 = 0.879 +- 0.160 (in-sample avg dev_std = 0.423)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.997
SUFF++ for r=0.9 class 0.0 = 0.991 +- 0.076 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 1.0 = 0.999 +- 0.076 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all KL = 0.993 +- 0.076 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all L1 = 0.996 +- 0.045 (in-sample avg dev_std = 0.070)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.982
NEC for r=0.6 class 0.0 = 0.055 +- 0.186 (in-sample avg dev_std = 0.160)
NEC for r=0.6 class 1.0 = 0.022 +- 0.186 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all KL = 0.06 +- 0.186 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all L1 = 0.036 +- 0.116 (in-sample avg dev_std = 0.160)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.992
NEC for r=0.9 class 0.0 = 0.019 +- 0.107 (in-sample avg dev_std = 0.080)
NEC for r=0.9 class 1.0 = 0.001 +- 0.107 (in-sample avg dev_std = 0.080)
NEC for r=0.9 all KL = 0.014 +- 0.107 (in-sample avg dev_std = 0.080)
NEC for r=0.9 all L1 = 0.009 +- 0.072 (in-sample avg dev_std = 0.080)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.992
NEC for r=1.0 class 0.0 = 0.019 +- 0.107 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.001 +- 0.107 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.014 +- 0.107 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.009 +- 0.072 (in-sample avg dev_std = 0.080)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:14:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4149
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4712
OOD Validation ACCURACY: 0.8844
OOD Validation Loss: 0.6335
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.5522

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9206
ID Validation Loss: 0.4566
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5199
OOD Validation ACCURACY: 0.8857
OOD Validation Loss: 0.7013
OOD Test ACCURACY: 0.8256
OOD Test Loss: 1.5657

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.8226 0.9164 0.8256 0.9206 0.8857[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/13/2024 08:14:19 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.945
SUFF++ for r=0.6 class 0.0 = 0.855 +- 0.333 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 1.0 = 0.933 +- 0.333 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all KL = 0.742 +- 0.333 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all L1 = 0.9 +- 0.152 (in-sample avg dev_std = 0.376)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0.0 = 0.986 +- 0.077 (in-sample avg dev_std = 0.053)
SUFF++ for r=0.9 class 1.0 = 0.999 +- 0.077 (in-sample avg dev_std = 0.053)
SUFF++ for r=0.9 all KL = 0.992 +- 0.077 (in-sample avg dev_std = 0.053)
SUFF++ for r=0.9 all L1 = 0.994 +- 0.063 (in-sample avg dev_std = 0.053)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.988
NEC for r=0.6 class 0.0 = 0.031 +- 0.160 (in-sample avg dev_std = 0.123)
NEC for r=0.6 class 1.0 = 0.02 +- 0.160 (in-sample avg dev_std = 0.123)
NEC for r=0.6 all KL = 0.043 +- 0.160 (in-sample avg dev_std = 0.123)
NEC for r=0.6 all L1 = 0.025 +- 0.098 (in-sample avg dev_std = 0.123)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
NEC for r=0.9 class 0.0 = 0.016 +- 0.095 (in-sample avg dev_std = 0.084)
NEC for r=0.9 class 1.0 = 0.002 +- 0.095 (in-sample avg dev_std = 0.084)
NEC for r=0.9 all KL = 0.013 +- 0.095 (in-sample avg dev_std = 0.084)
NEC for r=0.9 all L1 = 0.008 +- 0.062 (in-sample avg dev_std = 0.084)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.995
NEC for r=1.0 class 0.0 = 0.016 +- 0.095 (in-sample avg dev_std = 0.084)
NEC for r=1.0 class 1.0 = 0.002 +- 0.095 (in-sample avg dev_std = 0.084)
NEC for r=1.0 all KL = 0.013 +- 0.095 (in-sample avg dev_std = 0.084)
NEC for r=1.0 all L1 = 0.008 +- 0.062 (in-sample avg dev_std = 0.084)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:14:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.4089
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4793
OOD Validation ACCURACY: 0.8800
OOD Validation Loss: 0.6717
OOD Test ACCURACY: 0.8278
OOD Test Loss: 1.4934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0032
ID Validation ACCURACY: 0.9189
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9128
ID Test Loss: 0.3801
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.5452
OOD Test ACCURACY: 0.8331
OOD Test Loss: 1.2119

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.8278 0.9128 0.8331 0.9189 0.8837[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/13/2024 08:14:38 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.95
SUFF++ for r=0.6 class 0.0 = 0.867 +- 0.324 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 1.0 = 0.939 +- 0.324 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all KL = 0.74 +- 0.324 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all L1 = 0.908 +- 0.131 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF++ for r=0.9 class 0.0 = 0.992 +- 0.056 (in-sample avg dev_std = 0.021)
SUFF++ for r=0.9 class 1.0 = 1.0 +- 0.056 (in-sample avg dev_std = 0.021)
SUFF++ for r=0.9 all KL = 0.994 +- 0.056 (in-sample avg dev_std = 0.021)
SUFF++ for r=0.9 all L1 = 0.997 +- 0.028 (in-sample avg dev_std = 0.021)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.997
NEC for r=0.6 class 0.0 = 0.021 +- 0.105 (in-sample avg dev_std = 0.051)
NEC for r=0.6 class 1.0 = 0.007 +- 0.105 (in-sample avg dev_std = 0.051)
NEC for r=0.6 all KL = 0.022 +- 0.105 (in-sample avg dev_std = 0.051)
NEC for r=0.6 all L1 = 0.013 +- 0.063 (in-sample avg dev_std = 0.051)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.998
NEC for r=0.9 class 0.0 = 0.012 +- 0.081 (in-sample avg dev_std = 0.057)
NEC for r=0.9 class 1.0 = 0.0 +- 0.081 (in-sample avg dev_std = 0.057)
NEC for r=0.9 all KL = 0.011 +- 0.081 (in-sample avg dev_std = 0.057)
NEC for r=0.9 all L1 = 0.005 +- 0.042 (in-sample avg dev_std = 0.057)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.998
NEC for r=1.0 class 0.0 = 0.012 +- 0.081 (in-sample avg dev_std = 0.057)
NEC for r=1.0 class 1.0 = 0.0 +- 0.081 (in-sample avg dev_std = 0.057)
NEC for r=1.0 all KL = 0.011 +- 0.081 (in-sample avg dev_std = 0.057)
NEC for r=1.0 all L1 = 0.005 +- 0.042 (in-sample avg dev_std = 0.057)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:14:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:14:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9225
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.9176
ID Test Loss: 0.4755
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.6167
OOD Test ACCURACY: 0.8206
OOD Test Loss: 1.3282

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9204
ID Validation Loss: 0.4402
ID Test ACCURACY: 0.9183
ID Test Loss: 0.5109
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6529
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.3708

[0m[1;37mINFO[0m: [1mChartInfo 0.9176 0.8206 0.9183 0.8255 0.9204 0.8846[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/13/2024 08:14:56 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.915
SUFF++ for r=0.6 class 0.0 = 0.817 +- 0.351 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 1.0 = 0.879 +- 0.351 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all KL = 0.639 +- 0.351 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all L1 = 0.852 +- 0.170 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.994
SUFF++ for r=0.9 class 0.0 = 0.988 +- 0.078 (in-sample avg dev_std = 0.001)
SUFF++ for r=0.9 class 1.0 = 0.998 +- 0.078 (in-sample avg dev_std = 0.001)
SUFF++ for r=0.9 all KL = 0.993 +- 0.078 (in-sample avg dev_std = 0.001)
SUFF++ for r=0.9 all L1 = 0.994 +- 0.060 (in-sample avg dev_std = 0.001)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.985
NEC for r=0.6 class 0.0 = 0.048 +- 0.163 (in-sample avg dev_std = 0.132)
NEC for r=0.6 class 1.0 = 0.021 +- 0.163 (in-sample avg dev_std = 0.132)
NEC for r=0.6 all KL = 0.051 +- 0.163 (in-sample avg dev_std = 0.132)
NEC for r=0.6 all L1 = 0.032 +- 0.112 (in-sample avg dev_std = 0.132)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.011 +- 0.088 (in-sample avg dev_std = 0.068)
NEC for r=0.9 class 1.0 = 0.002 +- 0.088 (in-sample avg dev_std = 0.068)
NEC for r=0.9 all KL = 0.011 +- 0.088 (in-sample avg dev_std = 0.068)
NEC for r=0.9 all L1 = 0.006 +- 0.047 (in-sample avg dev_std = 0.068)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.011 +- 0.088 (in-sample avg dev_std = 0.068)
NEC for r=1.0 class 1.0 = 0.002 +- 0.088 (in-sample avg dev_std = 0.068)
NEC for r=1.0 all KL = 0.011 +- 0.088 (in-sample avg dev_std = 0.068)
NEC for r=1.0 all L1 = 0.006 +- 0.047 (in-sample avg dev_std = 0.068)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:15:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:15:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.4313
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4948
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.5415

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4301
ID Test ACCURACY: 0.9166
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8312
OOD Test Loss: 1.4830

[0m[1;37mINFO[0m: [1mChartInfo 0.9178 0.8338 0.9166 0.8312 0.9178 0.8847[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/13/2024 08:15:15 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.938
SUFF++ for r=0.6 class 0.0 = 0.881 +- 0.364 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 1.0 = 0.894 +- 0.364 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all KL = 0.677 +- 0.364 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all L1 = 0.888 +- 0.144 (in-sample avg dev_std = 0.425)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0.0 = 0.989 +- 0.078 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.9 class 1.0 = 0.999 +- 0.078 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.9 all KL = 0.993 +- 0.078 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.9 all L1 = 0.995 +- 0.056 (in-sample avg dev_std = 0.041)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.994
NEC for r=0.6 class 0.0 = 0.019 +- 0.154 (in-sample avg dev_std = 0.087)
NEC for r=0.6 class 1.0 = 0.021 +- 0.154 (in-sample avg dev_std = 0.087)
NEC for r=0.6 all KL = 0.038 +- 0.154 (in-sample avg dev_std = 0.087)
NEC for r=0.6 all L1 = 0.02 +- 0.087 (in-sample avg dev_std = 0.087)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.012 +- 0.092 (in-sample avg dev_std = 0.076)
NEC for r=0.9 class 1.0 = 0.002 +- 0.092 (in-sample avg dev_std = 0.076)
NEC for r=0.9 all KL = 0.012 +- 0.092 (in-sample avg dev_std = 0.076)
NEC for r=0.9 all L1 = 0.006 +- 0.053 (in-sample avg dev_std = 0.076)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.012 +- 0.092 (in-sample avg dev_std = 0.076)
NEC for r=1.0 class 1.0 = 0.002 +- 0.092 (in-sample avg dev_std = 0.076)
NEC for r=1.0 all KL = 0.012 +- 0.092 (in-sample avg dev_std = 0.076)
NEC for r=1.0 all L1 = 0.006 +- 0.053 (in-sample avg dev_std = 0.076)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.703, 0.993, 1.0], 'all_L1': [0.879, 0.996, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.992, 1.0], 'all_L1': [0.9, 0.994, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.994, 1.0], 'all_L1': [0.908, 0.997, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.993, 1.0], 'all_L1': [0.852, 0.994, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.993, 1.0], 'all_L1': [0.888, 0.995, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.06, 0.014, 0.014], 'all_L1': [0.036, 0.009, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.043, 0.013, 0.013], 'all_L1': [0.025, 0.008, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.011, 0.011], 'all_L1': [0.013, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.051, 0.011, 0.011], 'all_L1': [0.032, 0.006, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.012, 0.012], 'all_L1': [0.02, 0.006, 0.006]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.885 +- 0.019, 0.995 +- 0.001, 1.000 +- 0.000
suff++ class all_KL  =  0.700 +- 0.039, 0.993 +- 0.001, 1.000 +- 0.000
suff++_acc_int  =  0.936 +- 0.012, 0.996 +- 0.002
nec class all_L1  =  0.025 +- 0.008, 0.007 +- 0.001, 0.007 +- 0.001
nec class all_KL  =  0.043 +- 0.013, 0.012 +- 0.001, 0.012 +- 0.001
nec_acc_int  =  0.989 +- 0.006, 0.996 +- 0.002, 0.996 +- 0.002


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.455 +- 0.007, 0.501 +- 0.001, 0.503 +- 0.001
Faith. Armon (L1)= 		  =  0.049 +- 0.016, 0.014 +- 0.003, 0.014 +- 0.003
Faith. GMean (L1)= 	  =  0.147 +- 0.024, 0.082 +- 0.009, 0.082 +- 0.009
Faith. Aritm (KL)= 		  =  0.371 +- 0.017, 0.503 +- 0.000, 0.506 +- 0.001
Faith. Armon (KL)= 		  =  0.080 +- 0.023, 0.024 +- 0.002, 0.024 +- 0.002
Faith. GMean (KL)= 	  =  0.171 +- 0.026, 0.110 +- 0.005, 0.110 +- 0.005
Computed for split load_split = id



Completed in  0:01:35.962387  for LECIvGIN GOODSST2/length



DONE LECI GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:16:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:10 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:13 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:14 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:16 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:16:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.9819
Train Loss: 0.0593
ID Validation ACCURACY: 0.6877
ID Validation Loss: 1.6620
ID Test ACCURACY: 0.6462
ID Test Loss: 1.7034
OOD Validation ACCURACY: 0.5798
OOD Validation Loss: 2.5076
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.8144

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ACCURACY: 0.7409
Train Loss: 0.6367
ID Validation ACCURACY: 0.6643
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7824
OOD Validation ACCURACY: 0.6213
OOD Validation Loss: 0.9502
OOD Test ACCURACY: 0.5765
OOD Test Loss: 1.1552

[0m[1;37mINFO[0m: [1mChartInfo 0.6462 0.5333 0.6841 0.5765 0.6643 0.6213[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.885
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.756
SUFF++ for r=0.3 class 0 = 0.551 +- 0.270 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 1 = 0.718 +- 0.270 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 2 = 0.751 +- 0.270 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all KL = 0.593 +- 0.270 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all L1 = 0.686 +- 0.197 (in-sample avg dev_std = 0.544)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.873
SUFF++ for r=0.6 class 0 = 0.711 +- 0.236 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 1 = 0.847 +- 0.236 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 2 = 0.894 +- 0.236 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all KL = 0.796 +- 0.236 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all L1 = 0.827 +- 0.177 (in-sample avg dev_std = 0.348)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.969
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.958
SUFF++ for r=0.9 class 0 = 0.902 +- 0.100 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 class 1 = 0.944 +- 0.100 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 class 2 = 0.979 +- 0.100 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 all KL = 0.963 +- 0.100 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 all L1 = 0.943 +- 0.105 (in-sample avg dev_std = 0.131)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.885
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.856
NEC for r=0.3 class 0 = 0.337 +- 0.239 (in-sample avg dev_std = 0.280)
NEC for r=0.3 class 1 = 0.172 +- 0.239 (in-sample avg dev_std = 0.280)
NEC for r=0.3 class 2 = 0.124 +- 0.239 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all KL = 0.181 +- 0.239 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all L1 = 0.199 +- 0.209 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.915
NEC for r=0.6 class 0 = 0.212 +- 0.174 (in-sample avg dev_std = 0.208)
NEC for r=0.6 class 1 = 0.108 +- 0.174 (in-sample avg dev_std = 0.208)
NEC for r=0.6 class 2 = 0.058 +- 0.174 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all KL = 0.1 +- 0.174 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all L1 = 0.12 +- 0.163 (in-sample avg dev_std = 0.208)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.969
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.962
NEC for r=0.9 class 0 = 0.129 +- 0.108 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1 = 0.063 +- 0.108 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 2 = 0.022 +- 0.108 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.045 +- 0.108 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.068 +- 0.117 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.98
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.972
NEC for r=1.0 class 0 = 0.094 +- 0.097 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 1 = 0.043 +- 0.097 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 2 = 0.018 +- 0.097 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all KL = 0.03 +- 0.097 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all L1 = 0.049 +- 0.097 (in-sample avg dev_std = 0.107)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:18:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:03 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:18:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.9873
Train Loss: 0.0557
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.2333
ID Test ACCURACY: 0.6751
ID Test Loss: 1.2914
OOD Validation ACCURACY: 0.6235
OOD Validation Loss: 1.5984
OOD Test ACCURACY: 0.5710
OOD Test Loss: 2.1738

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ACCURACY: 0.8039
Train Loss: 0.4968
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.7512
ID Test ACCURACY: 0.6931
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 0.9328
OOD Test ACCURACY: 0.5779
OOD Test Loss: 1.2430

[0m[1;37mINFO[0m: [1mChartInfo 0.6751 0.5710 0.6931 0.5779 0.6949 0.6476[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.893
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.775
SUFF++ for r=0.3 class 0 = 0.616 +- 0.221 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.689 +- 0.221 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.734 +- 0.221 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.661 +- 0.221 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.684 +- 0.166 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.942
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.892
SUFF++ for r=0.6 class 0 = 0.755 +- 0.199 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 1 = 0.825 +- 0.199 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 2 = 0.83 +- 0.199 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all KL = 0.796 +- 0.199 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all L1 = 0.81 +- 0.163 (in-sample avg dev_std = 0.348)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.974
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.963
SUFF++ for r=0.9 class 0 = 0.938 +- 0.071 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1 = 0.952 +- 0.071 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 2 = 0.94 +- 0.071 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.969 +- 0.071 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.089 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.893
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.87
NEC for r=0.3 class 0 = 0.248 +- 0.182 (in-sample avg dev_std = 0.233)
NEC for r=0.3 class 1 = 0.203 +- 0.182 (in-sample avg dev_std = 0.233)
NEC for r=0.3 class 2 = 0.159 +- 0.182 (in-sample avg dev_std = 0.233)
NEC for r=0.3 all KL = 0.141 +- 0.182 (in-sample avg dev_std = 0.233)
NEC for r=0.3 all L1 = 0.202 +- 0.183 (in-sample avg dev_std = 0.233)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.942
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.932
NEC for r=0.6 class 0 = 0.14 +- 0.144 (in-sample avg dev_std = 0.186)
NEC for r=0.6 class 1 = 0.112 +- 0.144 (in-sample avg dev_std = 0.186)
NEC for r=0.6 class 2 = 0.099 +- 0.144 (in-sample avg dev_std = 0.186)
NEC for r=0.6 all KL = 0.079 +- 0.144 (in-sample avg dev_std = 0.186)
NEC for r=0.6 all L1 = 0.115 +- 0.147 (in-sample avg dev_std = 0.186)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.974
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.967
NEC for r=0.9 class 0 = 0.07 +- 0.091 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1 = 0.048 +- 0.091 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 2 = 0.074 +- 0.091 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.036 +- 0.091 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.06 +- 0.105 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.982
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.965
NEC for r=1.0 class 0 = 0.07 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=1.0 class 1 = 0.037 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=1.0 class 2 = 0.063 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=1.0 all KL = 0.031 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=1.0 all L1 = 0.052 +- 0.102 (in-sample avg dev_std = 0.110)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:19:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:19:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9622
Train Loss: 0.1169
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.0059
ID Test ACCURACY: 0.6588
ID Test Loss: 1.1823
OOD Validation ACCURACY: 0.6319
OOD Validation Loss: 1.4492
OOD Test ACCURACY: 0.5635
OOD Test Loss: 2.1363

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8077
Train Loss: 0.4721
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.7735
ID Test ACCURACY: 0.6895
ID Test Loss: 0.8005
OOD Validation ACCURACY: 0.6420
OOD Validation Loss: 0.9580
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.2456

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5635 0.6895 0.5964 0.7004 0.6420[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.872
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.761
SUFF++ for r=0.3 class 0 = 0.658 +- 0.188 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 1 = 0.776 +- 0.188 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 2 = 0.607 +- 0.188 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all KL = 0.744 +- 0.188 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all L1 = 0.703 +- 0.161 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.913
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.852
SUFF++ for r=0.6 class 0 = 0.734 +- 0.181 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 1 = 0.871 +- 0.181 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 2 = 0.72 +- 0.181 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all KL = 0.825 +- 0.181 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all L1 = 0.798 +- 0.159 (in-sample avg dev_std = 0.338)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.955
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.936
SUFF++ for r=0.9 class 0 = 0.909 +- 0.070 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 class 1 = 0.957 +- 0.070 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 class 2 = 0.882 +- 0.070 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all KL = 0.965 +- 0.070 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all L1 = 0.926 +- 0.100 (in-sample avg dev_std = 0.136)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.872
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.851
NEC for r=0.3 class 0 = 0.242 +- 0.174 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.151 +- 0.174 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.286 +- 0.174 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.127 +- 0.174 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.208 +- 0.175 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.913
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.909
NEC for r=0.6 class 0 = 0.168 +- 0.114 (in-sample avg dev_std = 0.172)
NEC for r=0.6 class 1 = 0.085 +- 0.114 (in-sample avg dev_std = 0.172)
NEC for r=0.6 class 2 = 0.189 +- 0.114 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all KL = 0.073 +- 0.114 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all L1 = 0.132 +- 0.139 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.955
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.944
NEC for r=0.9 class 0 = 0.097 +- 0.074 (in-sample avg dev_std = 0.119)
NEC for r=0.9 class 1 = 0.048 +- 0.074 (in-sample avg dev_std = 0.119)
NEC for r=0.9 class 2 = 0.114 +- 0.074 (in-sample avg dev_std = 0.119)
NEC for r=0.9 all KL = 0.033 +- 0.074 (in-sample avg dev_std = 0.119)
NEC for r=0.9 all L1 = 0.077 +- 0.107 (in-sample avg dev_std = 0.119)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.952
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.946
NEC for r=1.0 class 0 = 0.082 +- 0.069 (in-sample avg dev_std = 0.106)
NEC for r=1.0 class 1 = 0.039 +- 0.069 (in-sample avg dev_std = 0.106)
NEC for r=1.0 class 2 = 0.096 +- 0.069 (in-sample avg dev_std = 0.106)
NEC for r=1.0 all KL = 0.028 +- 0.069 (in-sample avg dev_std = 0.106)
NEC for r=1.0 all L1 = 0.064 +- 0.099 (in-sample avg dev_std = 0.106)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:21:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:41 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:21:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.7076
ID Validation Loss: 2.3068
ID Test ACCURACY: 0.6697
ID Test Loss: 2.5476
OOD Validation ACCURACY: 0.6118
OOD Validation Loss: 2.8631
OOD Test ACCURACY: 0.5559
OOD Test Loss: 3.9096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.7730
Train Loss: 0.5461
ID Validation ACCURACY: 0.6877
ID Validation Loss: 0.7610
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7794
OOD Validation ACCURACY: 0.6431
OOD Validation Loss: 0.8959
OOD Test ACCURACY: 0.5944
OOD Test Loss: 1.0740

[0m[1;37mINFO[0m: [1mChartInfo 0.6697 0.5559 0.6841 0.5944 0.6877 0.6431[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.972
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.837
SUFF++ for r=0.3 class 0 = 0.702 +- 0.375 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 class 1 = 0.835 +- 0.375 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 class 2 = 0.631 +- 0.375 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 all KL = 0.425 +- 0.375 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 all L1 = 0.749 +- 0.200 (in-sample avg dev_std = 0.619)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.935
SUFF++ for r=0.6 class 0 = 0.84 +- 0.370 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 1 = 0.933 +- 0.370 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 2 = 0.821 +- 0.370 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all KL = 0.653 +- 0.370 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.149 (in-sample avg dev_std = 0.425)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.999
SUFF++ for r=0.9 class 0 = 0.993 +- 0.058 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.9 class 1 = 0.997 +- 0.058 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.9 class 2 = 0.998 +- 0.058 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.9 all KL = 0.99 +- 0.058 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.9 all L1 = 0.996 +- 0.023 (in-sample avg dev_std = 0.045)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.972
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.969
NEC for r=0.3 class 0 = 0.12 +- 0.231 (in-sample avg dev_std = 0.197)
NEC for r=0.3 class 1 = 0.032 +- 0.231 (in-sample avg dev_std = 0.197)
NEC for r=0.3 class 2 = 0.09 +- 0.231 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all KL = 0.099 +- 0.231 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all L1 = 0.068 +- 0.161 (in-sample avg dev_std = 0.197)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.993
NEC for r=0.6 class 0 = 0.035 +- 0.121 (in-sample avg dev_std = 0.089)
NEC for r=0.6 class 1 = 0.008 +- 0.121 (in-sample avg dev_std = 0.089)
NEC for r=0.6 class 2 = 0.013 +- 0.121 (in-sample avg dev_std = 0.089)
NEC for r=0.6 all KL = 0.032 +- 0.121 (in-sample avg dev_std = 0.089)
NEC for r=0.6 all L1 = 0.016 +- 0.068 (in-sample avg dev_std = 0.089)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.997
NEC for r=0.9 class 0 = 0.014 +- 0.071 (in-sample avg dev_std = 0.043)
NEC for r=0.9 class 1 = 0.002 +- 0.071 (in-sample avg dev_std = 0.043)
NEC for r=0.9 class 2 = 0.001 +- 0.071 (in-sample avg dev_std = 0.043)
NEC for r=0.9 all KL = 0.009 +- 0.071 (in-sample avg dev_std = 0.043)
NEC for r=0.9 all L1 = 0.005 +- 0.043 (in-sample avg dev_std = 0.043)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.998
NEC for r=1.0 class 0 = 0.012 +- 0.069 (in-sample avg dev_std = 0.038)
NEC for r=1.0 class 1 = 0.001 +- 0.069 (in-sample avg dev_std = 0.038)
NEC for r=1.0 class 2 = 0.001 +- 0.069 (in-sample avg dev_std = 0.038)
NEC for r=1.0 all KL = 0.008 +- 0.069 (in-sample avg dev_std = 0.038)
NEC for r=1.0 all L1 = 0.004 +- 0.036 (in-sample avg dev_std = 0.038)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:23:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:30 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:32 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:34 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:23:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0094
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.7565
ID Test ACCURACY: 0.6643
ID Test Loss: 2.0819
OOD Validation ACCURACY: 0.6084
OOD Validation Loss: 2.4105
OOD Test ACCURACY: 0.5450
OOD Test Loss: 3.1833

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.2018
ID Validation ACCURACY: 0.6859
ID Validation Loss: 0.9593
ID Test ACCURACY: 0.6769
ID Test Loss: 1.0846
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 1.2904
OOD Test ACCURACY: 0.6026
OOD Test Loss: 1.8131

[0m[1;37mINFO[0m: [1mChartInfo 0.6643 0.5450 0.6769 0.6026 0.6859 0.6476[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.912
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.791
SUFF++ for r=0.3 class 0 = 0.694 +- 0.304 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 class 1 = 0.787 +- 0.304 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.304 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 all KL = 0.555 +- 0.304 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 all L1 = 0.708 +- 0.199 (in-sample avg dev_std = 0.557)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.981
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.899
SUFF++ for r=0.6 class 0 = 0.832 +- 0.303 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 1 = 0.899 +- 0.303 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 2 = 0.699 +- 0.303 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all KL = 0.693 +- 0.303 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all L1 = 0.83 +- 0.176 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.997
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.987
SUFF++ for r=0.9 class 0 = 0.984 +- 0.104 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 class 1 = 0.99 +- 0.104 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 class 2 = 0.913 +- 0.104 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 all KL = 0.957 +- 0.104 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 all L1 = 0.968 +- 0.079 (in-sample avg dev_std = 0.134)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.912
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.902
NEC for r=0.3 class 0 = 0.165 +- 0.248 (in-sample avg dev_std = 0.256)
NEC for r=0.3 class 1 = 0.112 +- 0.248 (in-sample avg dev_std = 0.256)
NEC for r=0.3 class 2 = 0.266 +- 0.248 (in-sample avg dev_std = 0.256)
NEC for r=0.3 all KL = 0.166 +- 0.248 (in-sample avg dev_std = 0.256)
NEC for r=0.3 all L1 = 0.165 +- 0.215 (in-sample avg dev_std = 0.256)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.981
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.967
NEC for r=0.6 class 0 = 0.061 +- 0.173 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 1 = 0.039 +- 0.173 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 2 = 0.132 +- 0.173 (in-sample avg dev_std = 0.168)
NEC for r=0.6 all KL = 0.073 +- 0.173 (in-sample avg dev_std = 0.168)
NEC for r=0.6 all L1 = 0.069 +- 0.140 (in-sample avg dev_std = 0.168)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.997
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.993
NEC for r=0.9 class 0 = 0.019 +- 0.099 (in-sample avg dev_std = 0.086)
NEC for r=0.9 class 1 = 0.009 +- 0.099 (in-sample avg dev_std = 0.086)
NEC for r=0.9 class 2 = 0.052 +- 0.099 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all KL = 0.026 +- 0.099 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all L1 = 0.023 +- 0.076 (in-sample avg dev_std = 0.086)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.997
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.994
NEC for r=1.0 class 0 = 0.017 +- 0.089 (in-sample avg dev_std = 0.081)
NEC for r=1.0 class 1 = 0.005 +- 0.089 (in-sample avg dev_std = 0.081)
NEC for r=1.0 class 2 = 0.034 +- 0.089 (in-sample avg dev_std = 0.081)
NEC for r=1.0 all KL = 0.019 +- 0.089 (in-sample avg dev_std = 0.081)
NEC for r=1.0 all L1 = 0.016 +- 0.064 (in-sample avg dev_std = 0.081)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.593, 0.796, 0.963, 1.0], 'all_L1': [0.686, 0.827, 0.943, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.661, 0.796, 0.969, 1.0], 'all_L1': [0.684, 0.81, 0.945, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.825, 0.965, 1.0], 'all_L1': [0.703, 0.798, 0.926, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.425, 0.653, 0.99, 1.0], 'all_L1': [0.749, 0.881, 0.996, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.693, 0.957, 1.0], 'all_L1': [0.708, 0.83, 0.968, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.181, 0.1, 0.045, 0.03], 'all_L1': [0.199, 0.12, 0.068, 0.049]}), defaultdict(<class 'list'>, {'all_KL': [0.141, 0.079, 0.036, 0.031], 'all_L1': [0.202, 0.115, 0.06, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.073, 0.033, 0.028], 'all_L1': [0.208, 0.132, 0.077, 0.064]}), defaultdict(<class 'list'>, {'all_KL': [0.099, 0.032, 0.009, 0.008], 'all_L1': [0.068, 0.016, 0.005, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.166, 0.073, 0.026, 0.019], 'all_L1': [0.165, 0.069, 0.023, 0.016]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.706 +- 0.023, 0.829 +- 0.028, 0.956 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.596 +- 0.107, 0.753 +- 0.067, 0.969 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.784 +- 0.029, 0.890 +- 0.028, 0.969 +- 0.022
nec class all_L1  =  0.168 +- 0.052, 0.090 +- 0.043, 0.047 +- 0.028, 0.037 +- 0.023
nec class all_KL  =  0.143 +- 0.029, 0.071 +- 0.022, 0.030 +- 0.012, 0.023 +- 0.009
nec_acc_int  =  0.890 +- 0.044, 0.943 +- 0.032, 0.972 +- 0.020, 0.975 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.437 +- 0.016, 0.460 +- 0.010, 0.501 +- 0.003, 0.518 +- 0.011
Faith. Armon (L1)= 		  =  0.267 +- 0.073, 0.159 +- 0.072, 0.087 +- 0.051, 0.070 +- 0.043
Faith. GMean (L1)= 	  =  0.338 +- 0.058, 0.261 +- 0.077, 0.196 +- 0.075, 0.178 +- 0.072
Faith. Aritm (KL)= 		  =  0.369 +- 0.059, 0.412 +- 0.042, 0.499 +- 0.004, 0.512 +- 0.004
Faith. Armon (KL)= 		  =  0.229 +- 0.040, 0.130 +- 0.038, 0.058 +- 0.023, 0.045 +- 0.017
Faith. GMean (KL)= 	  =  0.290 +- 0.043, 0.230 +- 0.046, 0.165 +- 0.039, 0.149 +- 0.033
Computed for split load_split = id



Completed in  0:09:08.672363  for LECIvGIN GOODTwitter/length



DONE LECI GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:25:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/13/2024 08:25:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:25:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:03 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:26:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9716
Train Loss: 0.0653
ID Validation ROC-AUC: 0.8412
ID Validation Loss: 0.1394
ID Test ROC-AUC: 0.7964
ID Test Loss: 0.1371
OOD Validation ROC-AUC: 0.7570
OOD Validation Loss: 0.1376
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0930

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.8810
Train Loss: 0.1019
ID Validation ROC-AUC: 0.8118
ID Validation Loss: 0.1338
ID Test ROC-AUC: 0.8103
ID Test Loss: 0.1133
OOD Validation ROC-AUC: 0.7797
OOD Validation Loss: 0.1199
OOD Test ROC-AUC: 0.7043
OOD Test Loss: 0.0856

[0m[1;37mINFO[0m: [1mChartInfo 0.7964 0.7331 0.8103 0.7043 0.8118 0.7797[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/13/2024 08:26:12 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.682
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.624
SUFF++ for r=0.3 class 0.0 = 0.973 +- 0.096 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.3 class 1.0 = 0.915 +- 0.096 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.3 all KL = 0.957 +- 0.096 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.3 all L1 = 0.944 +- 0.109 (in-sample avg dev_std = 0.150)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.827
SUFF++ for r=0.6 class 0.0 = 0.954 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 class 1.0 = 0.8 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 all KL = 0.924 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 all L1 = 0.877 +- 0.156 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.96
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 798
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.947
SUFF++ for r=0.9 class 0.0 = 0.976 +- 0.082 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 1.0 = 0.897 +- 0.082 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all KL = 0.972 +- 0.082 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all L1 = 0.937 +- 0.105 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.682
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
NEC for r=0.3 class 0.0 = 0.03 +- 0.075 (in-sample avg dev_std = 0.109)
NEC for r=0.3 class 1.0 = 0.084 +- 0.075 (in-sample avg dev_std = 0.109)
NEC for r=0.3 all KL = 0.034 +- 0.075 (in-sample avg dev_std = 0.109)
NEC for r=0.3 all L1 = 0.057 +- 0.108 (in-sample avg dev_std = 0.109)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.846
NEC for r=0.6 class 0.0 = 0.044 +- 0.136 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 1.0 = 0.209 +- 0.136 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all KL = 0.072 +- 0.136 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all L1 = 0.126 +- 0.162 (in-sample avg dev_std = 0.189)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.96
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.933
NEC for r=0.9 class 0.0 = 0.039 +- 0.150 (in-sample avg dev_std = 0.220)
NEC for r=0.9 class 1.0 = 0.212 +- 0.150 (in-sample avg dev_std = 0.220)
NEC for r=0.9 all KL = 0.08 +- 0.150 (in-sample avg dev_std = 0.220)
NEC for r=0.9 all L1 = 0.126 +- 0.160 (in-sample avg dev_std = 0.220)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.972
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.945
NEC for r=1.0 class 0.0 = 0.033 +- 0.143 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 1.0 = 0.197 +- 0.143 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all KL = 0.075 +- 0.143 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all L1 = 0.115 +- 0.148 (in-sample avg dev_std = 0.210)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:27:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/13/2024 08:27:54 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:27:58 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:28:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9881
Train Loss: 0.0502
ID Validation ROC-AUC: 0.8421
ID Validation Loss: 0.1583
ID Test ROC-AUC: 0.7976
ID Test Loss: 0.1471
OOD Validation ROC-AUC: 0.7386
OOD Validation Loss: 0.1672
OOD Test ROC-AUC: 0.7071
OOD Test Loss: 0.1073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.0938
ID Validation ROC-AUC: 0.8079
ID Validation Loss: 0.1347
ID Test ROC-AUC: 0.7889
ID Test Loss: 0.1161
OOD Validation ROC-AUC: 0.7802
OOD Validation Loss: 0.1159
OOD Test ROC-AUC: 0.6996
OOD Test Loss: 0.0890

[0m[1;37mINFO[0m: [1mChartInfo 0.7976 0.7071 0.7889 0.6996 0.8079 0.7802[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/13/2024 08:28:10 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.646
SUFF++ for r=0.3 class 0.0 = 0.978 +- 0.083 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.3 class 1.0 = 0.912 +- 0.083 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.3 all KL = 0.963 +- 0.083 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.3 all L1 = 0.945 +- 0.106 (in-sample avg dev_std = 0.141)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.919
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.867
SUFF++ for r=0.6 class 0.0 = 0.95 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 1.0 = 0.773 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 all KL = 0.909 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 all L1 = 0.861 +- 0.167 (in-sample avg dev_std = 0.224)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.98
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 798
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.968
SUFF++ for r=0.9 class 0.0 = 0.978 +- 0.083 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 1.0 = 0.892 +- 0.083 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all KL = 0.97 +- 0.083 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all L1 = 0.935 +- 0.106 (in-sample avg dev_std = 0.125)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.665
NEC for r=0.3 class 0.0 = 0.031 +- 0.087 (in-sample avg dev_std = 0.118)
NEC for r=0.3 class 1.0 = 0.095 +- 0.087 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all KL = 0.041 +- 0.087 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all L1 = 0.063 +- 0.109 (in-sample avg dev_std = 0.118)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.919
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.875
NEC for r=0.6 class 0.0 = 0.046 +- 0.160 (in-sample avg dev_std = 0.232)
NEC for r=0.6 class 1.0 = 0.245 +- 0.160 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all KL = 0.095 +- 0.160 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all L1 = 0.146 +- 0.177 (in-sample avg dev_std = 0.232)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.98
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.952
NEC for r=0.9 class 0.0 = 0.039 +- 0.177 (in-sample avg dev_std = 0.253)
NEC for r=0.9 class 1.0 = 0.232 +- 0.177 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all KL = 0.1 +- 0.177 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all L1 = 0.136 +- 0.167 (in-sample avg dev_std = 0.253)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.986
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.96
NEC for r=1.0 class 0.0 = 0.036 +- 0.179 (in-sample avg dev_std = 0.250)
NEC for r=1.0 class 1.0 = 0.235 +- 0.179 (in-sample avg dev_std = 0.250)
NEC for r=1.0 all KL = 0.103 +- 0.179 (in-sample avg dev_std = 0.250)
NEC for r=1.0 all L1 = 0.136 +- 0.172 (in-sample avg dev_std = 0.250)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:29:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/13/2024 08:29:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:29:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:29:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:30:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9869
Train Loss: 0.0538
ID Validation ROC-AUC: 0.8431
ID Validation Loss: 0.1490
ID Test ROC-AUC: 0.8115
ID Test Loss: 0.1338
OOD Validation ROC-AUC: 0.7762
OOD Validation Loss: 0.1394
OOD Test ROC-AUC: 0.7383
OOD Test Loss: 0.0997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9764
Train Loss: 0.0628
ID Validation ROC-AUC: 0.8350
ID Validation Loss: 0.1429
ID Test ROC-AUC: 0.8089
ID Test Loss: 0.1287
OOD Validation ROC-AUC: 0.7881
OOD Validation Loss: 0.1266
OOD Test ROC-AUC: 0.7471
OOD Test Loss: 0.0945

[0m[1;37mINFO[0m: [1mChartInfo 0.8115 0.7383 0.8089 0.7471 0.8350 0.7881[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/13/2024 08:30:07 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.666
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.612
SUFF++ for r=0.3 class 0.0 = 0.964 +- 0.134 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.3 class 1.0 = 0.886 +- 0.134 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.3 all KL = 0.93 +- 0.134 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.3 all L1 = 0.925 +- 0.125 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.851
SUFF++ for r=0.6 class 0.0 = 0.926 +- 0.157 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 class 1.0 = 0.772 +- 0.157 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 all KL = 0.892 +- 0.157 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 all L1 = 0.849 +- 0.166 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.975
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 798
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.962
SUFF++ for r=0.9 class 0.0 = 0.965 +- 0.084 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 1.0 = 0.912 +- 0.084 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all KL = 0.971 +- 0.084 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.098 (in-sample avg dev_std = 0.125)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.666
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.638
NEC for r=0.3 class 0.0 = 0.04 +- 0.108 (in-sample avg dev_std = 0.135)
NEC for r=0.3 class 1.0 = 0.104 +- 0.108 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all KL = 0.053 +- 0.108 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all L1 = 0.072 +- 0.118 (in-sample avg dev_std = 0.135)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.87
NEC for r=0.6 class 0.0 = 0.061 +- 0.163 (in-sample avg dev_std = 0.232)
NEC for r=0.6 class 1.0 = 0.242 +- 0.163 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all KL = 0.098 +- 0.163 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all L1 = 0.152 +- 0.174 (in-sample avg dev_std = 0.232)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.975
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.952
NEC for r=0.9 class 0.0 = 0.053 +- 0.156 (in-sample avg dev_std = 0.219)
NEC for r=0.9 class 1.0 = 0.195 +- 0.156 (in-sample avg dev_std = 0.219)
NEC for r=0.9 all KL = 0.086 +- 0.156 (in-sample avg dev_std = 0.219)
NEC for r=0.9 all L1 = 0.124 +- 0.149 (in-sample avg dev_std = 0.219)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.982
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.956
NEC for r=1.0 class 0.0 = 0.05 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=1.0 class 1.0 = 0.195 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=1.0 all KL = 0.087 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=1.0 all L1 = 0.123 +- 0.151 (in-sample avg dev_std = 0.218)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:31:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/13/2024 08:31:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:31:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:31:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:01 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:32:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ROC-AUC: 0.9788
Train Loss: 0.0657
ID Validation ROC-AUC: 0.8378
ID Validation Loss: 0.1396
ID Test ROC-AUC: 0.8109
ID Test Loss: 0.1227
OOD Validation ROC-AUC: 0.7665
OOD Validation Loss: 0.1310
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9723
Train Loss: 0.0782
ID Validation ROC-AUC: 0.8167
ID Validation Loss: 0.1530
ID Test ROC-AUC: 0.8037
ID Test Loss: 0.1332
OOD Validation ROC-AUC: 0.7875
OOD Validation Loss: 0.1295
OOD Test ROC-AUC: 0.6782
OOD Test Loss: 0.1101

[0m[1;37mINFO[0m: [1mChartInfo 0.8109 0.7331 0.8037 0.6782 0.8167 0.7875[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/13/2024 08:32:05 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.676
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.613
SUFF++ for r=0.3 class 0.0 = 0.978 +- 0.070 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 class 1.0 = 0.928 +- 0.070 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 all KL = 0.969 +- 0.070 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 all L1 = 0.953 +- 0.087 (in-sample avg dev_std = 0.124)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.844
SUFF++ for r=0.6 class 0.0 = 0.964 +- 0.089 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 1.0 = 0.83 +- 0.089 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 all KL = 0.949 +- 0.089 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.127 (in-sample avg dev_std = 0.155)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.968
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 798
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.955
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.082 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 class 1.0 = 0.883 +- 0.082 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all KL = 0.973 +- 0.082 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all L1 = 0.932 +- 0.109 (in-sample avg dev_std = 0.126)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.676
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.622
NEC for r=0.3 class 0.0 = 0.021 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 1.0 = 0.067 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.3 all KL = 0.021 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.3 all L1 = 0.044 +- 0.086 (in-sample avg dev_std = 0.083)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.861
NEC for r=0.6 class 0.0 = 0.03 +- 0.119 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 1.0 = 0.205 +- 0.119 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all KL = 0.062 +- 0.119 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all L1 = 0.118 +- 0.156 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.968
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.938
NEC for r=0.9 class 0.0 = 0.031 +- 0.158 (in-sample avg dev_std = 0.222)
NEC for r=0.9 class 1.0 = 0.244 +- 0.158 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all KL = 0.085 +- 0.158 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all L1 = 0.137 +- 0.174 (in-sample avg dev_std = 0.222)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.975
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.946
NEC for r=1.0 class 0.0 = 0.029 +- 0.157 (in-sample avg dev_std = 0.226)
NEC for r=1.0 class 1.0 = 0.242 +- 0.157 (in-sample avg dev_std = 0.226)
NEC for r=1.0 all KL = 0.089 +- 0.157 (in-sample avg dev_std = 0.226)
NEC for r=1.0 all L1 = 0.135 +- 0.168 (in-sample avg dev_std = 0.226)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:33:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/13/2024 08:33:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:33:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:33:54 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:33:58 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:34:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ROC-AUC: 0.9928
Train Loss: 0.0421
ID Validation ROC-AUC: 0.8460
ID Validation Loss: 0.1580
ID Test ROC-AUC: 0.8091
ID Test Loss: 0.1489
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.1650
OOD Test ROC-AUC: 0.7077
OOD Test Loss: 0.1190

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ROC-AUC: 0.9781
Train Loss: 0.0600
ID Validation ROC-AUC: 0.8358
ID Validation Loss: 0.1409
ID Test ROC-AUC: 0.8118
ID Test Loss: 0.1303
OOD Validation ROC-AUC: 0.7903
OOD Validation Loss: 0.1230
OOD Test ROC-AUC: 0.7362
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mChartInfo 0.8091 0.7077 0.8118 0.7362 0.8358 0.7903[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/13/2024 08:34:03 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.562
SUFF++ for r=0.3 class 0.0 = 0.974 +- 0.128 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.3 class 1.0 = 0.926 +- 0.128 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.3 all KL = 0.952 +- 0.128 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.3 all L1 = 0.95 +- 0.112 (in-sample avg dev_std = 0.166)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.833
SUFF++ for r=0.6 class 0.0 = 0.946 +- 0.178 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.6 class 1.0 = 0.764 +- 0.178 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.6 all KL = 0.886 +- 0.178 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.6 all L1 = 0.855 +- 0.184 (in-sample avg dev_std = 0.238)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.985
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 798
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.977
SUFF++ for r=0.9 class 0.0 = 0.976 +- 0.117 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 class 1.0 = 0.885 +- 0.117 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all KL = 0.96 +- 0.117 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.116 (in-sample avg dev_std = 0.160)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.597
NEC for r=0.3 class 0.0 = 0.026 +- 0.094 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 1.0 = 0.069 +- 0.094 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.036 +- 0.094 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.048 +- 0.105 (in-sample avg dev_std = 0.114)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.864
NEC for r=0.6 class 0.0 = 0.045 +- 0.181 (in-sample avg dev_std = 0.249)
NEC for r=0.6 class 1.0 = 0.251 +- 0.181 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all KL = 0.109 +- 0.181 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all L1 = 0.148 +- 0.184 (in-sample avg dev_std = 0.249)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.985
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.957
NEC for r=0.9 class 0.0 = 0.044 +- 0.210 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 1.0 = 0.252 +- 0.210 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all KL = 0.131 +- 0.210 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all L1 = 0.148 +- 0.181 (in-sample avg dev_std = 0.280)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.989
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.968
NEC for r=1.0 class 0.0 = 0.039 +- 0.204 (in-sample avg dev_std = 0.270)
NEC for r=1.0 class 1.0 = 0.236 +- 0.204 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all KL = 0.122 +- 0.204 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all L1 = 0.138 +- 0.181 (in-sample avg dev_std = 0.270)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.957, 0.924, 0.972, 1.0], 'all_L1': [0.944, 0.877, 0.937, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.909, 0.97, 1.0], 'all_L1': [0.945, 0.861, 0.935, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.93, 0.892, 0.971, 1.0], 'all_L1': [0.925, 0.849, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.969, 0.949, 0.973, 1.0], 'all_L1': [0.953, 0.897, 0.932, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.952, 0.886, 0.96, 1.0], 'all_L1': [0.95, 0.855, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.034, 0.072, 0.08, 0.075], 'all_L1': [0.057, 0.126, 0.126, 0.115]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.095, 0.1, 0.103], 'all_L1': [0.063, 0.146, 0.136, 0.136]}), defaultdict(<class 'list'>, {'all_KL': [0.053, 0.098, 0.086, 0.087], 'all_L1': [0.072, 0.152, 0.124, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.062, 0.085, 0.089], 'all_L1': [0.044, 0.118, 0.137, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.109, 0.131, 0.122], 'all_L1': [0.048, 0.148, 0.148, 0.138]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.943 +- 0.010, 0.868 +- 0.017, 0.935 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.954 +- 0.013, 0.912 +- 0.023, 0.969 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.611 +- 0.028, 0.844 +- 0.014, 0.962 +- 0.010
nec class all_L1  =  0.057 +- 0.010, 0.138 +- 0.013, 0.134 +- 0.009, 0.129 +- 0.009
nec class all_KL  =  0.037 +- 0.010, 0.087 +- 0.017, 0.096 +- 0.019, 0.095 +- 0.016
nec_acc_int  =  0.630 +- 0.022, 0.863 +- 0.010, 0.946 +- 0.009, 0.955 +- 0.009


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.500 +- 0.002, 0.503 +- 0.002, 0.534 +- 0.003, 0.565 +- 0.004
Faith. Armon (L1)= 		  =  0.107 +- 0.018, 0.238 +- 0.020, 0.235 +- 0.013, 0.229 +- 0.014
Faith. GMean (L1)= 	  =  0.230 +- 0.019, 0.345 +- 0.014, 0.354 +- 0.011, 0.360 +- 0.013
Faith. Aritm (KL)= 		  =  0.496 +- 0.003, 0.500 +- 0.004, 0.533 +- 0.007, 0.548 +- 0.008
Faith. Armon (KL)= 		  =  0.071 +- 0.019, 0.159 +- 0.029, 0.175 +- 0.030, 0.173 +- 0.027
Faith. GMean (KL)= 	  =  0.186 +- 0.026, 0.280 +- 0.026, 0.304 +- 0.027, 0.307 +- 0.026
Computed for split load_split = id



Completed in  0:09:50.320154  for LECIvGIN GOODHIV/scaffold



DONE LECI GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:36:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/13/2024 08:36:23 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:37:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:37:13 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:37:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:37:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:38:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/13/2024 08:38:05 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.663
SUFF++ for r=0.3 class 0.0 = 0.703 +- 0.145 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.3 class 1.0 = 0.666 +- 0.145 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.3 all KL = 0.816 +- 0.145 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.3 all L1 = 0.67 +- 0.130 (in-sample avg dev_std = 0.330)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.707 +- 0.161 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 1.0 = 0.789 +- 0.161 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all KL = 0.851 +- 0.161 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all L1 = 0.78 +- 0.188 (in-sample avg dev_std = 0.303)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.925
SUFF++ for r=0.9 class 0.0 = 0.827 +- 0.100 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 1.0 = 0.931 +- 0.100 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all KL = 0.953 +- 0.100 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.135 (in-sample avg dev_std = 0.182)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.652
NEC for r=0.3 class 0.0 = 0.289 +- 0.133 (in-sample avg dev_std = 0.260)
NEC for r=0.3 class 1.0 = 0.279 +- 0.133 (in-sample avg dev_std = 0.260)
NEC for r=0.3 all KL = 0.133 +- 0.133 (in-sample avg dev_std = 0.260)
NEC for r=0.3 all L1 = 0.28 +- 0.139 (in-sample avg dev_std = 0.260)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.805
NEC for r=0.6 class 0.0 = 0.238 +- 0.150 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 1.0 = 0.189 +- 0.150 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all KL = 0.125 +- 0.150 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all L1 = 0.195 +- 0.167 (in-sample avg dev_std = 0.265)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.857
NEC for r=0.9 class 0.0 = 0.329 +- 0.186 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 1.0 = 0.115 +- 0.186 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all KL = 0.12 +- 0.186 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all L1 = 0.14 +- 0.182 (in-sample avg dev_std = 0.274)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.961
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.88
NEC for r=1.0 class 0.0 = 0.332 +- 0.201 (in-sample avg dev_std = 0.291)
NEC for r=1.0 class 1.0 = 0.101 +- 0.201 (in-sample avg dev_std = 0.291)
NEC for r=1.0 all KL = 0.12 +- 0.201 (in-sample avg dev_std = 0.291)
NEC for r=1.0 all L1 = 0.128 +- 0.181 (in-sample avg dev_std = 0.291)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:40:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/13/2024 08:40:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:40:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:40:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:06 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/13/2024 08:41:49 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.658
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 788
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0.0 = 0.792 +- 0.103 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 1.0 = 0.772 +- 0.103 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all KL = 0.904 +- 0.103 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all L1 = 0.774 +- 0.099 (in-sample avg dev_std = 0.247)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0.0 = 0.807 +- 0.157 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.6 class 1.0 = 0.795 +- 0.157 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.6 all KL = 0.871 +- 0.157 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.6 all L1 = 0.797 +- 0.146 (in-sample avg dev_std = 0.248)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.947
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.934
SUFF++ for r=0.9 class 0.0 = 0.908 +- 0.048 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1.0 = 0.956 +- 0.048 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.981 +- 0.048 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.95 +- 0.073 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.658
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0.0 = 0.184 +- 0.084 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 1.0 = 0.207 +- 0.084 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all KL = 0.075 +- 0.084 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all L1 = 0.205 +- 0.109 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.808
NEC for r=0.6 class 0.0 = 0.2 +- 0.117 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 1.0 = 0.164 +- 0.117 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all KL = 0.09 +- 0.117 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all L1 = 0.168 +- 0.131 (in-sample avg dev_std = 0.236)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.947
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.883
NEC for r=0.9 class 0.0 = 0.268 +- 0.151 (in-sample avg dev_std = 0.239)
NEC for r=0.9 class 1.0 = 0.117 +- 0.151 (in-sample avg dev_std = 0.239)
NEC for r=0.9 all KL = 0.093 +- 0.151 (in-sample avg dev_std = 0.239)
NEC for r=0.9 all L1 = 0.134 +- 0.150 (in-sample avg dev_std = 0.239)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.961
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.884
NEC for r=1.0 class 0.0 = 0.324 +- 0.160 (in-sample avg dev_std = 0.255)
NEC for r=1.0 class 1.0 = 0.109 +- 0.160 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all KL = 0.1 +- 0.160 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all L1 = 0.134 +- 0.165 (in-sample avg dev_std = 0.255)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:43:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/13/2024 08:43:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:44:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:44:29 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:44:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:45:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:45:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/13/2024 08:45:21 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.708
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.645
SUFF++ for r=0.3 class 0.0 = 0.726 +- 0.086 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 class 1.0 = 0.718 +- 0.086 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 all KL = 0.881 +- 0.086 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 all L1 = 0.719 +- 0.101 (in-sample avg dev_std = 0.269)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.841
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.767
SUFF++ for r=0.6 class 0.0 = 0.699 +- 0.097 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.6 class 1.0 = 0.83 +- 0.097 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.6 all KL = 0.901 +- 0.097 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.6 all L1 = 0.815 +- 0.143 (in-sample avg dev_std = 0.238)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.895
SUFF++ for r=0.9 class 0.0 = 0.763 +- 0.069 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.9 class 1.0 = 0.923 +- 0.069 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.9 all KL = 0.959 +- 0.069 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.9 all L1 = 0.905 +- 0.118 (in-sample avg dev_std = 0.161)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.708
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.681
NEC for r=0.3 class 0.0 = 0.228 +- 0.084 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1.0 = 0.259 +- 0.084 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.093 +- 0.084 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.255 +- 0.116 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.841
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.809
NEC for r=0.6 class 0.0 = 0.217 +- 0.093 (in-sample avg dev_std = 0.176)
NEC for r=0.6 class 1.0 = 0.154 +- 0.093 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all KL = 0.074 +- 0.093 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all L1 = 0.161 +- 0.124 (in-sample avg dev_std = 0.176)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.868
NEC for r=0.9 class 0.0 = 0.251 +- 0.103 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.099 +- 0.103 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.063 +- 0.103 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.117 +- 0.132 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.95
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.891
NEC for r=1.0 class 0.0 = 0.264 +- 0.106 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 1.0 = 0.091 +- 0.106 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all KL = 0.061 +- 0.106 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all L1 = 0.111 +- 0.132 (in-sample avg dev_std = 0.175)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:47:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/13/2024 08:47:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:47:59 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:48:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:48:25 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:48:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:49:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/13/2024 08:49:05 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0.0 = 0.757 +- 0.068 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.3 class 1.0 = 0.752 +- 0.068 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.3 all KL = 0.919 +- 0.068 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.3 all L1 = 0.752 +- 0.086 (in-sample avg dev_std = 0.245)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.794
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.748
SUFF++ for r=0.6 class 0.0 = 0.747 +- 0.093 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 class 1.0 = 0.773 +- 0.093 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all KL = 0.896 +- 0.093 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all L1 = 0.77 +- 0.116 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.936
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.898
SUFF++ for r=0.9 class 0.0 = 0.801 +- 0.085 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 1.0 = 0.899 +- 0.085 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all KL = 0.95 +- 0.085 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all L1 = 0.888 +- 0.111 (in-sample avg dev_std = 0.178)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.592
NEC for r=0.3 class 0.0 = 0.201 +- 0.076 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1.0 = 0.223 +- 0.076 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.064 +- 0.076 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.22 +- 0.110 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.794
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.754
NEC for r=0.6 class 0.0 = 0.22 +- 0.103 (in-sample avg dev_std = 0.214)
NEC for r=0.6 class 1.0 = 0.232 +- 0.103 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all KL = 0.1 +- 0.103 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all L1 = 0.23 +- 0.119 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.936
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.875
NEC for r=0.9 class 0.0 = 0.208 +- 0.123 (in-sample avg dev_std = 0.209)
NEC for r=0.9 class 1.0 = 0.145 +- 0.123 (in-sample avg dev_std = 0.209)
NEC for r=0.9 all KL = 0.085 +- 0.123 (in-sample avg dev_std = 0.209)
NEC for r=0.9 all L1 = 0.152 +- 0.129 (in-sample avg dev_std = 0.209)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.953
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.887
NEC for r=1.0 class 0.0 = 0.21 +- 0.119 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1.0 = 0.117 +- 0.119 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.075 +- 0.119 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.128 +- 0.126 (in-sample avg dev_std = 0.205)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:51:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/13/2024 08:51:09 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/13/2024 08:51:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/13/2024 08:51:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:52:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/13/2024 08:52:50 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.612
SUFF++ for r=0.3 class 0.0 = 0.747 +- 0.068 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 1.0 = 0.752 +- 0.068 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all KL = 0.917 +- 0.068 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all L1 = 0.752 +- 0.087 (in-sample avg dev_std = 0.246)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
SUFF++ for r=0.6 class 0.0 = 0.716 +- 0.136 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 1.0 = 0.732 +- 0.136 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 all KL = 0.852 +- 0.136 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 all L1 = 0.73 +- 0.114 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.922
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.889
SUFF++ for r=0.9 class 0.0 = 0.83 +- 0.118 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 1.0 = 0.873 +- 0.118 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all KL = 0.93 +- 0.118 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all L1 = 0.868 +- 0.118 (in-sample avg dev_std = 0.186)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.62
NEC for r=0.3 class 0.0 = 0.257 +- 0.079 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1.0 = 0.243 +- 0.079 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.078 +- 0.079 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.245 +- 0.111 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.742
NEC for r=0.6 class 0.0 = 0.273 +- 0.148 (in-sample avg dev_std = 0.271)
NEC for r=0.6 class 1.0 = 0.272 +- 0.148 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all KL = 0.148 +- 0.148 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all L1 = 0.272 +- 0.131 (in-sample avg dev_std = 0.271)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.922
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.848
NEC for r=0.9 class 0.0 = 0.222 +- 0.163 (in-sample avg dev_std = 0.271)
NEC for r=0.9 class 1.0 = 0.207 +- 0.163 (in-sample avg dev_std = 0.271)
NEC for r=0.9 all KL = 0.143 +- 0.163 (in-sample avg dev_std = 0.271)
NEC for r=0.9 all L1 = 0.209 +- 0.140 (in-sample avg dev_std = 0.271)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.949
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.872
NEC for r=1.0 class 0.0 = 0.221 +- 0.179 (in-sample avg dev_std = 0.251)
NEC for r=1.0 class 1.0 = 0.169 +- 0.179 (in-sample avg dev_std = 0.251)
NEC for r=1.0 all KL = 0.127 +- 0.179 (in-sample avg dev_std = 0.251)
NEC for r=1.0 all L1 = 0.175 +- 0.140 (in-sample avg dev_std = 0.251)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.816, 0.851, 0.953, 1.0], 'all_L1': [0.67, 0.78, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.871, 0.981, 1.0], 'all_L1': [0.774, 0.797, 0.95, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.901, 0.959, 1.0], 'all_L1': [0.719, 0.815, 0.905, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.896, 0.95, 1.0], 'all_L1': [0.752, 0.77, 0.888, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.917, 0.852, 0.93, 1.0], 'all_L1': [0.752, 0.73, 0.868, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.133, 0.125, 0.12, 0.12], 'all_L1': [0.28, 0.195, 0.14, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.09, 0.093, 0.1], 'all_L1': [0.205, 0.168, 0.134, 0.134]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.074, 0.063, 0.061], 'all_L1': [0.255, 0.161, 0.117, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.064, 0.1, 0.085, 0.075], 'all_L1': [0.22, 0.23, 0.152, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.148, 0.143, 0.127], 'all_L1': [0.245, 0.272, 0.209, 0.175]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.733 +- 0.036, 0.778 +- 0.029, 0.906 +- 0.028, 1.000 +- 0.000
suff++ class all_KL  =  0.887 +- 0.038, 0.874 +- 0.021, 0.955 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.621 +- 0.029, 0.762 +- 0.036, 0.908 +- 0.018
nec class all_L1  =  0.241 +- 0.026, 0.205 +- 0.041, 0.150 +- 0.031, 0.135 +- 0.021
nec class all_KL  =  0.089 +- 0.024, 0.107 +- 0.026, 0.101 +- 0.028, 0.097 +- 0.025
nec_acc_int  =  0.634 +- 0.030, 0.783 +- 0.030, 0.866 +- 0.013, 0.883 +- 0.006


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.487 +- 0.008, 0.492 +- 0.007, 0.528 +- 0.012, 0.568 +- 0.011
Faith. Armon (L1)= 		  =  0.361 +- 0.025, 0.322 +- 0.048, 0.256 +- 0.044, 0.238 +- 0.033
Faith. GMean (L1)= 	  =  0.419 +- 0.014, 0.397 +- 0.032, 0.367 +- 0.033, 0.367 +- 0.028
Faith. Aritm (KL)= 		  =  0.488 +- 0.008, 0.491 +- 0.007, 0.528 +- 0.011, 0.548 +- 0.013
Faith. Armon (KL)= 		  =  0.160 +- 0.038, 0.190 +- 0.041, 0.181 +- 0.045, 0.175 +- 0.042
Faith. GMean (KL)= 	  =  0.277 +- 0.030, 0.304 +- 0.034, 0.307 +- 0.041, 0.308 +- 0.042
Computed for split load_split = id



Completed in  0:18:25.961256  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 20:55:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 08:55:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.621 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 1 = 0.571 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 2 = 0.58 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 3 = 0.627 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 4 = 0.597 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 5 = 0.603 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 6 = 0.59 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 7 = 0.601 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 8 = 0.594 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 9 = 0.608 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all KL = 0.736 +- 0.147 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all L1 = 0.599 +- 0.110 (in-sample avg dev_std = 0.246)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.244
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.182
SUFF++ for r=0.6 class 0 = 0.417 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1 = 0.375 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 2 = 0.35 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 3 = 0.393 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 4 = 0.387 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 5 = 0.403 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 6 = 0.436 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 7 = 0.396 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 8 = 0.406 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 9 = 0.418 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.358 +- 0.217 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.398 +- 0.126 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.775
SUFF++ for r=0.9 class 0 = 0.908 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 1 = 0.909 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 2 = 0.796 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 3 = 0.816 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 4 = 0.792 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 5 = 0.751 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 6 = 0.849 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 7 = 0.847 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 8 = 0.832 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 9 = 0.793 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all KL = 0.848 +- 0.227 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.204 (in-sample avg dev_std = 0.250)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
NEC for r=0.3 class 0 = 0.39 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 1 = 0.402 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 2 = 0.41 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 3 = 0.377 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 4 = 0.399 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 5 = 0.384 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 6 = 0.406 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 7 = 0.403 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 8 = 0.403 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 9 = 0.401 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 all KL = 0.236 +- 0.154 (in-sample avg dev_std = 0.222)
NEC for r=0.3 all L1 = 0.398 +- 0.118 (in-sample avg dev_std = 0.222)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.244
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.207
NEC for r=0.6 class 0 = 0.474 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 1 = 0.418 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 2 = 0.477 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 3 = 0.481 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 4 = 0.522 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 5 = 0.492 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 6 = 0.506 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 7 = 0.505 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 8 = 0.51 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 9 = 0.484 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 all KL = 0.429 +- 0.191 (in-sample avg dev_std = 0.321)
NEC for r=0.6 all L1 = 0.486 +- 0.141 (in-sample avg dev_std = 0.321)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.659
NEC for r=0.9 class 0 = 0.286 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 1 = 0.17 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 2 = 0.346 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 3 = 0.435 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 4 = 0.44 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 5 = 0.493 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 6 = 0.387 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 7 = 0.38 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 8 = 0.312 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 9 = 0.436 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 all KL = 0.499 +- 0.303 (in-sample avg dev_std = 0.422)
NEC for r=0.9 all L1 = 0.365 +- 0.246 (in-sample avg dev_std = 0.422)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.104 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 1 = 0.047 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 2 = 0.277 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 3 = 0.309 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 4 = 0.211 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 5 = 0.285 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 6 = 0.231 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 7 = 0.2 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 8 = 0.189 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 9 = 0.32 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 all KL = 0.339 +- 0.322 (in-sample avg dev_std = 0.373)
NEC for r=1.0 all L1 = 0.215 +- 0.232 (in-sample avg dev_std = 0.373)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 21:03:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:03:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.557 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 1 = 0.536 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 2 = 0.584 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 3 = 0.579 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 4 = 0.558 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 5 = 0.572 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 6 = 0.564 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 7 = 0.553 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 8 = 0.577 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 9 = 0.546 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 all KL = 0.677 +- 0.124 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 all L1 = 0.562 +- 0.080 (in-sample avg dev_std = 0.304)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.234
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.195
SUFF++ for r=0.6 class 0 = 0.485 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 1 = 0.532 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 2 = 0.452 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 3 = 0.437 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 4 = 0.414 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 5 = 0.451 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 6 = 0.444 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 7 = 0.488 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 8 = 0.432 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 9 = 0.415 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 all KL = 0.477 +- 0.218 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 all L1 = 0.456 +- 0.144 (in-sample avg dev_std = 0.278)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.78
SUFF++ for r=0.9 class 0 = 0.897 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 1 = 0.942 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 2 = 0.811 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 3 = 0.758 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 4 = 0.816 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 5 = 0.77 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 6 = 0.812 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 7 = 0.817 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 8 = 0.776 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 9 = 0.74 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all KL = 0.813 +- 0.250 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.205 (in-sample avg dev_std = 0.276)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
NEC for r=0.3 class 0 = 0.358 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1 = 0.37 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 2 = 0.349 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 3 = 0.324 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 4 = 0.335 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 5 = 0.315 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 6 = 0.369 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 7 = 0.363 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 8 = 0.347 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 9 = 0.345 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.172 +- 0.117 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.348 +- 0.105 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.234
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.215
NEC for r=0.6 class 0 = 0.431 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 1 = 0.379 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 2 = 0.453 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 3 = 0.492 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 4 = 0.515 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 5 = 0.467 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 6 = 0.494 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 7 = 0.453 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 8 = 0.515 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 9 = 0.52 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all KL = 0.395 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all L1 = 0.471 +- 0.134 (in-sample avg dev_std = 0.287)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.659
NEC for r=0.9 class 0 = 0.29 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.092 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.349 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.515 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.385 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.454 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.407 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.395 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.451 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.474 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.528 +- 0.312 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.377 +- 0.253 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.951
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.86
NEC for r=1.0 class 0 = 0.082 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 1 = 0.029 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 2 = 0.217 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 3 = 0.294 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 4 = 0.199 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 5 = 0.245 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 6 = 0.28 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 7 = 0.21 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 8 = 0.274 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 9 = 0.329 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 all KL = 0.351 +- 0.336 (in-sample avg dev_std = 0.368)
NEC for r=1.0 all L1 = 0.213 +- 0.232 (in-sample avg dev_std = 0.368)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 21:12:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:12:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:12:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.448 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 1 = 0.365 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 2 = 0.468 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 3 = 0.457 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 4 = 0.439 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 5 = 0.459 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 6 = 0.435 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 7 = 0.437 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 8 = 0.457 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 9 = 0.437 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all KL = 0.492 +- 0.189 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all L1 = 0.439 +- 0.096 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.266
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.173
SUFF++ for r=0.6 class 0 = 0.275 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 1 = 0.508 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 2 = 0.33 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 3 = 0.336 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 4 = 0.346 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 5 = 0.321 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 6 = 0.335 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 7 = 0.334 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 8 = 0.319 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 9 = 0.338 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all KL = 0.18 +- 0.174 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all L1 = 0.347 +- 0.128 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.717
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.269
SUFF++ for r=0.9 class 0 = 0.235 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 2 = 0.281 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 3 = 0.271 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 4 = 0.249 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 5 = 0.257 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 6 = 0.267 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 7 = 0.238 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 8 = 0.294 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 class 9 = 0.225 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 all KL = 0.143 +- 0.319 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.9 all L1 = 0.337 +- 0.253 (in-sample avg dev_std = 0.501)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
NEC for r=0.3 class 0 = 0.571 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 1 = 0.551 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 2 = 0.523 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 3 = 0.504 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 4 = 0.524 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 5 = 0.509 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 6 = 0.545 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 7 = 0.519 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 8 = 0.546 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 9 = 0.528 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all KL = 0.426 +- 0.210 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all L1 = 0.532 +- 0.122 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.266
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.176
NEC for r=0.6 class 0 = 0.709 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 1 = 0.511 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 2 = 0.689 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 3 = 0.668 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 4 = 0.652 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 5 = 0.663 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 6 = 0.663 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 7 = 0.644 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 8 = 0.657 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 9 = 0.641 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 all KL = 0.753 +- 0.223 (in-sample avg dev_std = 0.347)
NEC for r=0.6 all L1 = 0.648 +- 0.148 (in-sample avg dev_std = 0.347)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.717
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.557
NEC for r=0.9 class 0 = 0.527 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 1 = 0.049 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 2 = 0.408 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 3 = 0.493 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 4 = 0.594 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 5 = 0.551 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 6 = 0.605 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 7 = 0.542 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 8 = 0.437 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 9 = 0.684 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 all KL = 0.615 +- 0.315 (in-sample avg dev_std = 0.449)
NEC for r=0.9 all L1 = 0.483 +- 0.255 (in-sample avg dev_std = 0.449)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.836
NEC for r=1.0 class 0 = 0.124 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 1 = 0.024 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 2 = 0.275 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 3 = 0.259 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 4 = 0.208 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 5 = 0.267 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 6 = 0.308 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 7 = 0.277 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 8 = 0.223 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 9 = 0.326 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 all KL = 0.385 +- 0.352 (in-sample avg dev_std = 0.403)
NEC for r=1.0 all L1 = 0.226 +- 0.243 (in-sample avg dev_std = 0.403)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 21:21:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:21:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.533 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 1 = 0.526 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 2 = 0.539 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 3 = 0.564 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 4 = 0.543 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 5 = 0.522 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 6 = 0.549 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 7 = 0.521 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 8 = 0.538 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 9 = 0.518 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 all KL = 0.619 +- 0.157 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 all L1 = 0.535 +- 0.103 (in-sample avg dev_std = 0.334)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.224
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.162
SUFF++ for r=0.6 class 0 = 0.377 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 1 = 0.372 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 2 = 0.394 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 3 = 0.385 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 4 = 0.404 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 5 = 0.391 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 6 = 0.366 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 7 = 0.403 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 8 = 0.381 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 9 = 0.386 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all KL = 0.329 +- 0.211 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all L1 = 0.386 +- 0.133 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.768
SUFF++ for r=0.9 class 0 = 0.912 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 1 = 0.971 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 2 = 0.763 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 3 = 0.809 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 4 = 0.86 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 5 = 0.755 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 6 = 0.813 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 7 = 0.805 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 8 = 0.798 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 9 = 0.804 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 all KL = 0.844 +- 0.225 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.208 (in-sample avg dev_std = 0.242)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.381 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 1 = 0.371 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 2 = 0.384 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 3 = 0.367 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 4 = 0.371 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 5 = 0.397 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 6 = 0.371 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 7 = 0.395 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 8 = 0.401 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 9 = 0.407 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all KL = 0.225 +- 0.147 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all L1 = 0.384 +- 0.124 (in-sample avg dev_std = 0.217)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.224
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.192
NEC for r=0.6 class 0 = 0.49 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 1 = 0.378 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 2 = 0.492 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 3 = 0.528 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 4 = 0.514 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 5 = 0.518 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 6 = 0.532 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 7 = 0.522 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 8 = 0.514 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 9 = 0.532 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 all KL = 0.47 +- 0.231 (in-sample avg dev_std = 0.323)
NEC for r=0.6 all L1 = 0.5 +- 0.179 (in-sample avg dev_std = 0.323)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.651
NEC for r=0.9 class 0 = 0.285 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 1 = 0.07 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 2 = 0.432 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 3 = 0.435 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 4 = 0.33 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 5 = 0.488 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 6 = 0.439 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 7 = 0.415 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 8 = 0.385 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 class 9 = 0.455 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 all KL = 0.524 +- 0.331 (in-sample avg dev_std = 0.441)
NEC for r=0.9 all L1 = 0.369 +- 0.267 (in-sample avg dev_std = 0.441)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.94
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0 = 0.112 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 1 = 0.021 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 2 = 0.312 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 3 = 0.262 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 4 = 0.163 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 5 = 0.273 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 6 = 0.244 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 7 = 0.195 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 8 = 0.227 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 9 = 0.291 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all KL = 0.345 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all L1 = 0.207 +- 0.238 (in-sample avg dev_std = 0.371)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Apr 13 21:29:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/13/2024 09:29:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.094
SUFF++ for r=0.3 class 0 = 0.483 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 1 = 0.468 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 2 = 0.484 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 3 = 0.495 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 4 = 0.441 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 5 = 0.43 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 6 = 0.48 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 7 = 0.451 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 8 = 0.474 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 9 = 0.45 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all KL = 0.465 +- 0.226 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all L1 = 0.466 +- 0.135 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.166
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.142
SUFF++ for r=0.6 class 0 = 0.414 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 1 = 0.43 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 2 = 0.442 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 3 = 0.461 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 4 = 0.493 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 5 = 0.402 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 6 = 0.474 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 7 = 0.369 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 8 = 0.577 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 9 = 0.487 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all KL = 0.307 +- 0.289 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all L1 = 0.454 +- 0.226 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.821
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.764
SUFF++ for r=0.9 class 0 = 0.903 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 1 = 0.92 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 2 = 0.763 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 3 = 0.673 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 4 = 0.878 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 5 = 0.768 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 6 = 0.768 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 7 = 0.847 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 8 = 0.802 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 9 = 0.75 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all KL = 0.801 +- 0.263 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all L1 = 0.809 +- 0.223 (in-sample avg dev_std = 0.296)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.408 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.471 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.448 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 3 = 0.44 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 4 = 0.486 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 5 = 0.451 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 6 = 0.484 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 7 = 0.452 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 8 = 0.456 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 9 = 0.473 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.366 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.457 +- 0.153 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.166
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.134
NEC for r=0.6 class 0 = 0.457 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 1 = 0.507 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 2 = 0.414 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 3 = 0.427 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 4 = 0.376 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 5 = 0.469 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 6 = 0.402 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 7 = 0.489 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 8 = 0.379 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 9 = 0.433 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all KL = 0.468 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all L1 = 0.436 +- 0.252 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.821
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.605
NEC for r=0.9 class 0 = 0.24 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 1 = 0.231 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 2 = 0.489 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 3 = 0.667 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 4 = 0.352 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 5 = 0.527 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 6 = 0.449 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 7 = 0.358 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 8 = 0.348 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 9 = 0.486 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 all KL = 0.591 +- 0.331 (in-sample avg dev_std = 0.468)
NEC for r=0.9 all L1 = 0.412 +- 0.270 (in-sample avg dev_std = 0.468)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.951
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0 = 0.14 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 1 = 0.032 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 2 = 0.289 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 3 = 0.447 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 4 = 0.154 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 5 = 0.268 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 6 = 0.277 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 7 = 0.204 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 8 = 0.237 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 9 = 0.332 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 all KL = 0.405 +- 0.361 (in-sample avg dev_std = 0.409)
NEC for r=1.0 all L1 = 0.236 +- 0.249 (in-sample avg dev_std = 0.409)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.736, 0.358, 0.848, 1.0], 'all_L1': [0.599, 0.398, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.477, 0.813, 1.0], 'all_L1': [0.562, 0.456, 0.816, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.492, 0.18, 0.143, 1.0], 'all_L1': [0.439, 0.347, 0.337, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.329, 0.844, 1.0], 'all_L1': [0.535, 0.386, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.465, 0.307, 0.801, 1.0], 'all_L1': [0.466, 0.454, 0.809, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.236, 0.429, 0.499, 0.339], 'all_L1': [0.398, 0.486, 0.365, 0.215]}), defaultdict(<class 'list'>, {'all_KL': [0.172, 0.395, 0.528, 0.351], 'all_L1': [0.348, 0.471, 0.377, 0.213]}), defaultdict(<class 'list'>, {'all_KL': [0.426, 0.753, 0.615, 0.385], 'all_L1': [0.532, 0.648, 0.483, 0.226]}), defaultdict(<class 'list'>, {'all_KL': [0.225, 0.47, 0.524, 0.345], 'all_L1': [0.384, 0.5, 0.369, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.366, 0.468, 0.591, 0.405], 'all_L1': [0.457, 0.436, 0.412, 0.236]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.520 +- 0.060, 0.408 +- 0.042, 0.725 +- 0.194, 1.000 +- 0.000
suff++ class all_KL  =  0.598 +- 0.105, 0.330 +- 0.095, 0.690 +- 0.274, 1.000 +- 0.000
suff++_acc_int  =  0.104 +- 0.006, 0.171 +- 0.018, 0.671 +- 0.201
nec class all_L1  =  0.424 +- 0.065, 0.508 +- 0.073, 0.401 +- 0.044, 0.219 +- 0.010
nec class all_KL  =  0.285 +- 0.095, 0.503 +- 0.128, 0.551 +- 0.044, 0.365 +- 0.026
nec_acc_int  =  0.107 +- 0.006, 0.185 +- 0.029, 0.626 +- 0.040, 0.844 +- 0.011


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.472 +- 0.017, 0.458 +- 0.021, 0.563 +- 0.077, 0.610 +- 0.005
Faith. Armon (L1)= 		  =  0.460 +- 0.019, 0.447 +- 0.010, 0.495 +- 0.051, 0.360 +- 0.014
Faith. GMean (L1)= 	  =  0.466 +- 0.018, 0.452 +- 0.014, 0.528 +- 0.063, 0.468 +- 0.011
Faith. Aritm (KL)= 		  =  0.441 +- 0.027, 0.417 +- 0.030, 0.621 +- 0.121, 0.683 +- 0.013
Faith. Armon (KL)= 		  =  0.366 +- 0.063, 0.374 +- 0.046, 0.565 +- 0.168, 0.534 +- 0.027
Faith. GMean (KL)= 	  =  0.400 +- 0.040, 0.393 +- 0.022, 0.591 +- 0.148, 0.604 +- 0.021
Computed for split load_split = id



Completed in  0:42:40.518644  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color
DONE all :)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:41:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:47 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:41:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3178
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3259
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3250
OOD Validation ACCURACY: 0.8527
OOD Validation Loss: 0.5111
OOD Test ACCURACY: 0.6287
OOD Test Loss: 1.1683

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9295
Train Loss: 0.3278
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3391
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3296
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3661
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.3356

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.6287 0.9287 0.5353 0.9277 0.9320[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.693
WIoU for r=0.3 = 0.570
F1 for r=0.6 = 0.582
WIoU for r=0.6 = 0.459
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.344
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.323


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  0.6928637499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.569835
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.415
SUFF++ for r=0.3 class 0 = 0.417 +- 0.279 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 class 1 = 0.54 +- 0.279 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 class 2 = 0.581 +- 0.279 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 all KL = 0.472 +- 0.279 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 all L1 = 0.514 +- 0.192 (in-sample avg dev_std = 0.514)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.716
Model XAI F1 of binarized graphs for r=0.6 =  0.58150375
Model XAI WIoU of binarized graphs for r=0.6 =  0.45930374999999996
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0 = 0.415 +- 0.277 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 class 1 = 0.534 +- 0.277 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 class 2 = 0.658 +- 0.277 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 all KL = 0.508 +- 0.277 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 all L1 = 0.536 +- 0.205 (in-sample avg dev_std = 0.525)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.46745375
Model XAI WIoU of binarized graphs for r=0.9 =  0.3441862500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.862
SUFF++ for r=0.9 class 0 = 0.667 +- 0.170 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 1 = 0.792 +- 0.170 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 2 = 0.87 +- 0.170 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all KL = 0.84 +- 0.170 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all L1 = 0.777 +- 0.161 (in-sample avg dev_std = 0.262)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  0.6928637499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.569835
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.313
NEC for r=0.3 class 0 = 0.657 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 1 = 0.53 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 2 = 0.503 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all KL = 0.607 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all L1 = 0.563 +- 0.212 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.721
Model XAI F1 of binarized graphs for r=0.6 =  0.58150375
Model XAI WIoU of binarized graphs for r=0.6 =  0.45930374999999996
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.367
NEC for r=0.6 class 0 = 0.589 +- 0.250 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 1 = 0.62 +- 0.250 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 2 = 0.598 +- 0.250 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all KL = 0.671 +- 0.250 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all L1 = 0.602 +- 0.157 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.46745375
Model XAI WIoU of binarized graphs for r=0.9 =  0.3441862500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.477
NEC for r=0.9 class 0 = 0.626 +- 0.213 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 1 = 0.565 +- 0.213 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 2 = 0.562 +- 0.213 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all KL = 0.665 +- 0.213 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all L1 = 0.584 +- 0.145 (in-sample avg dev_std = 0.621)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.946
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32323375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.522
NEC for r=1.0 class 0 = 0.566 +- 0.239 (in-sample avg dev_std = 0.660)
NEC for r=1.0 class 1 = 0.516 +- 0.239 (in-sample avg dev_std = 0.660)
NEC for r=1.0 class 2 = 0.589 +- 0.239 (in-sample avg dev_std = 0.660)
NEC for r=1.0 all KL = 0.635 +- 0.239 (in-sample avg dev_std = 0.660)
NEC for r=1.0 all L1 = 0.556 +- 0.169 (in-sample avg dev_std = 0.660)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:43:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:16 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:18 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:20 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:43:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.713
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.485
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.351
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.326


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.502
Model XAI F1 of binarized graphs for r=0.3 =  0.71297875
Model XAI WIoU of binarized graphs for r=0.3 =  0.59048875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.453
SUFF++ for r=0.3 class 0 = 0.433 +- 0.259 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 1 = 0.527 +- 0.259 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.259 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 all KL = 0.539 +- 0.259 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 all L1 = 0.512 +- 0.156 (in-sample avg dev_std = 0.469)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.60287375
Model XAI WIoU of binarized graphs for r=0.6 =  0.48491375000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.648
SUFF++ for r=0.6 class 0 = 0.445 +- 0.273 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.6 class 1 = 0.679 +- 0.273 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.6 class 2 = 0.683 +- 0.273 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.6 all KL = 0.622 +- 0.273 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.6 all L1 = 0.604 +- 0.203 (in-sample avg dev_std = 0.442)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.47247249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.35066875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.651 +- 0.187 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.811 +- 0.187 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.882 +- 0.187 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.846 +- 0.187 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.782 +- 0.174 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  0.71297875
Model XAI WIoU of binarized graphs for r=0.3 =  0.59048875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.325
NEC for r=0.3 class 0 = 0.618 +- 0.276 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 1 = 0.51 +- 0.276 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 2 = 0.597 +- 0.276 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all KL = 0.552 +- 0.276 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all L1 = 0.574 +- 0.146 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.716
Model XAI F1 of binarized graphs for r=0.6 =  0.60287375
Model XAI WIoU of binarized graphs for r=0.6 =  0.48491375000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.406
NEC for r=0.6 class 0 = 0.629 +- 0.270 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.531 +- 0.270 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.598 +- 0.270 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.612 +- 0.270 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.585 +- 0.158 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.47247249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.35066875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.639 +- 0.228 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 1 = 0.483 +- 0.228 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 2 = 0.552 +- 0.228 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all KL = 0.605 +- 0.228 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all L1 = 0.557 +- 0.155 (in-sample avg dev_std = 0.589)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.947
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32611624999999994
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0 = 0.585 +- 0.235 (in-sample avg dev_std = 0.602)
NEC for r=1.0 class 1 = 0.439 +- 0.235 (in-sample avg dev_std = 0.602)
NEC for r=1.0 class 2 = 0.568 +- 0.235 (in-sample avg dev_std = 0.602)
NEC for r=1.0 all KL = 0.564 +- 0.235 (in-sample avg dev_std = 0.602)
NEC for r=1.0 all L1 = 0.529 +- 0.170 (in-sample avg dev_std = 0.602)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:44:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:44:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.706
WIoU for r=0.3 = 0.580
F1 for r=0.6 = 0.605
WIoU for r=0.6 = 0.483
F1 for r=0.9 = 0.471
WIoU for r=0.9 = 0.346
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.323


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.514
Model XAI F1 of binarized graphs for r=0.3 =  0.70565
Model XAI WIoU of binarized graphs for r=0.3 =  0.58038625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.456
SUFF++ for r=0.3 class 0 = 0.433 +- 0.256 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.502 +- 0.256 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.532 +- 0.256 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.483 +- 0.256 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.489 +- 0.145 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.701
Model XAI F1 of binarized graphs for r=0.6 =  0.60473875
Model XAI WIoU of binarized graphs for r=0.6 =  0.48301625000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.646
SUFF++ for r=0.6 class 0 = 0.475 +- 0.268 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1 = 0.635 +- 0.268 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 2 = 0.622 +- 0.268 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.566 +- 0.268 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.579 +- 0.191 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.4714
Model XAI WIoU of binarized graphs for r=0.9 =  0.34649
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF++ for r=0.9 class 0 = 0.672 +- 0.189 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.189 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.189 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all KL = 0.848 +- 0.189 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all L1 = 0.794 +- 0.165 (in-sample avg dev_std = 0.275)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.515
Model XAI F1 of binarized graphs for r=0.3 =  0.70565
Model XAI WIoU of binarized graphs for r=0.3 =  0.58038625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.375
NEC for r=0.3 class 0 = 0.616 +- 0.269 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 1 = 0.526 +- 0.269 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 2 = 0.608 +- 0.269 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all KL = 0.582 +- 0.269 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all L1 = 0.582 +- 0.151 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.701
Model XAI F1 of binarized graphs for r=0.6 =  0.60473875
Model XAI WIoU of binarized graphs for r=0.6 =  0.48301625000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.578 +- 0.278 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 1 = 0.509 +- 0.278 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 2 = 0.647 +- 0.278 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all KL = 0.624 +- 0.278 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all L1 = 0.577 +- 0.172 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.933
Model XAI F1 of binarized graphs for r=0.9 =  0.4714
Model XAI WIoU of binarized graphs for r=0.9 =  0.34649
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.639 +- 0.223 (in-sample avg dev_std = 0.587)
NEC for r=0.9 class 1 = 0.491 +- 0.223 (in-sample avg dev_std = 0.587)
NEC for r=0.9 class 2 = 0.545 +- 0.223 (in-sample avg dev_std = 0.587)
NEC for r=0.9 all KL = 0.614 +- 0.223 (in-sample avg dev_std = 0.587)
NEC for r=0.9 all L1 = 0.557 +- 0.155 (in-sample avg dev_std = 0.587)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.949
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32264250000000005
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.558
NEC for r=1.0 class 0 = 0.592 +- 0.222 (in-sample avg dev_std = 0.631)
NEC for r=1.0 class 1 = 0.451 +- 0.222 (in-sample avg dev_std = 0.631)
NEC for r=1.0 class 2 = 0.579 +- 0.222 (in-sample avg dev_std = 0.631)
NEC for r=1.0 all KL = 0.598 +- 0.222 (in-sample avg dev_std = 0.631)
NEC for r=1.0 all L1 = 0.539 +- 0.164 (in-sample avg dev_std = 0.631)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:46:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:46:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.706
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.591
WIoU for r=0.6 = 0.472
F1 for r=0.9 = 0.465
WIoU for r=0.9 = 0.341
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.322


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.515
Model XAI F1 of binarized graphs for r=0.3 =  0.70613375
Model XAI WIoU of binarized graphs for r=0.3 =  0.5843487500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.465
SUFF++ for r=0.3 class 0 = 0.435 +- 0.270 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 class 1 = 0.505 +- 0.270 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 class 2 = 0.576 +- 0.270 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all KL = 0.51 +- 0.270 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.159 (in-sample avg dev_std = 0.482)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.654
Model XAI F1 of binarized graphs for r=0.6 =  0.59116875
Model XAI WIoU of binarized graphs for r=0.6 =  0.4724625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.674
SUFF++ for r=0.6 class 0 = 0.458 +- 0.284 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 1 = 0.684 +- 0.284 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 2 = 0.598 +- 0.284 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all KL = 0.59 +- 0.284 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all L1 = 0.582 +- 0.205 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.46504000000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.3409775
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.88
SUFF++ for r=0.9 class 0 = 0.671 +- 0.167 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 1 = 0.86 +- 0.167 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 2 = 0.818 +- 0.167 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all KL = 0.854 +- 0.167 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all L1 = 0.784 +- 0.157 (in-sample avg dev_std = 0.254)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.51
Model XAI F1 of binarized graphs for r=0.3 =  0.70613375
Model XAI WIoU of binarized graphs for r=0.3 =  0.5843487500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.593 +- 0.281 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 1 = 0.524 +- 0.281 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 2 = 0.611 +- 0.281 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all KL = 0.574 +- 0.281 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all L1 = 0.575 +- 0.153 (in-sample avg dev_std = 0.430)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.651
Model XAI F1 of binarized graphs for r=0.6 =  0.59116875
Model XAI WIoU of binarized graphs for r=0.6 =  0.4724625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.372
NEC for r=0.6 class 0 = 0.57 +- 0.265 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.552 +- 0.265 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.61 +- 0.265 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.622 +- 0.265 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.577 +- 0.166 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.46504000000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.3409775
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.503
NEC for r=0.9 class 0 = 0.626 +- 0.216 (in-sample avg dev_std = 0.605)
NEC for r=0.9 class 1 = 0.512 +- 0.216 (in-sample avg dev_std = 0.605)
NEC for r=0.9 class 2 = 0.561 +- 0.216 (in-sample avg dev_std = 0.605)
NEC for r=0.9 all KL = 0.633 +- 0.216 (in-sample avg dev_std = 0.605)
NEC for r=0.9 all L1 = 0.565 +- 0.157 (in-sample avg dev_std = 0.605)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.947
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.3218275
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0 = 0.58 +- 0.218 (in-sample avg dev_std = 0.648)
NEC for r=1.0 class 1 = 0.463 +- 0.218 (in-sample avg dev_std = 0.648)
NEC for r=1.0 class 2 = 0.57 +- 0.218 (in-sample avg dev_std = 0.648)
NEC for r=1.0 all KL = 0.606 +- 0.218 (in-sample avg dev_std = 0.648)
NEC for r=1.0 all L1 = 0.537 +- 0.164 (in-sample avg dev_std = 0.648)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:47:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:47:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:47:58 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:00 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:03 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:05 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:48:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.655
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.568
WIoU for r=0.6 = 0.447
F1 for r=0.9 = 0.453
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.321


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.555
Model XAI F1 of binarized graphs for r=0.3 =  0.65516875
Model XAI WIoU of binarized graphs for r=0.3 =  0.5311337500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.437
SUFF++ for r=0.3 class 0 = 0.442 +- 0.270 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1 = 0.554 +- 0.270 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 2 = 0.627 +- 0.270 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.551 +- 0.270 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.541 +- 0.175 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.5677599999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.44691250000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.624
SUFF++ for r=0.6 class 0 = 0.413 +- 0.271 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 1 = 0.605 +- 0.271 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 2 = 0.595 +- 0.271 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 all KL = 0.516 +- 0.271 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 all L1 = 0.539 +- 0.201 (in-sample avg dev_std = 0.493)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.45319000000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.3303075
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0 = 0.576 +- 0.191 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 1 = 0.804 +- 0.191 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 2 = 0.851 +- 0.191 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 all KL = 0.81 +- 0.191 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 all L1 = 0.745 +- 0.189 (in-sample avg dev_std = 0.302)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.65516875
Model XAI WIoU of binarized graphs for r=0.3 =  0.5311337500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.616 +- 0.278 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 1 = 0.521 +- 0.278 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 2 = 0.549 +- 0.278 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all KL = 0.563 +- 0.278 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all L1 = 0.561 +- 0.156 (in-sample avg dev_std = 0.416)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.656
Model XAI F1 of binarized graphs for r=0.6 =  0.5677599999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.44691250000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.349
NEC for r=0.6 class 0 = 0.58 +- 0.272 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.565 +- 0.272 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.628 +- 0.272 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.645 +- 0.272 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.591 +- 0.172 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.45319000000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.3303075
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.497
NEC for r=0.9 class 0 = 0.581 +- 0.233 (in-sample avg dev_std = 0.587)
NEC for r=0.9 class 1 = 0.547 +- 0.233 (in-sample avg dev_std = 0.587)
NEC for r=0.9 class 2 = 0.547 +- 0.233 (in-sample avg dev_std = 0.587)
NEC for r=0.9 all KL = 0.612 +- 0.233 (in-sample avg dev_std = 0.587)
NEC for r=0.9 all L1 = 0.558 +- 0.150 (in-sample avg dev_std = 0.587)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.947
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32089124999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.533
NEC for r=1.0 class 0 = 0.569 +- 0.232 (in-sample avg dev_std = 0.637)
NEC for r=1.0 class 1 = 0.495 +- 0.232 (in-sample avg dev_std = 0.637)
NEC for r=1.0 class 2 = 0.574 +- 0.232 (in-sample avg dev_std = 0.637)
NEC for r=1.0 all KL = 0.604 +- 0.232 (in-sample avg dev_std = 0.637)
NEC for r=1.0 all L1 = 0.545 +- 0.161 (in-sample avg dev_std = 0.637)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.472, 0.508, 0.84, 1.0], 'all_L1': [0.514, 0.536, 0.777, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.622, 0.846, 1.0], 'all_L1': [0.512, 0.604, 0.782, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.566, 0.848, 1.0], 'all_L1': [0.489, 0.579, 0.794, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.59, 0.854, 1.0], 'all_L1': [0.505, 0.582, 0.784, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.551, 0.516, 0.81, 1.0], 'all_L1': [0.541, 0.539, 0.745, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.607, 0.671, 0.665, 0.635], 'all_L1': [0.563, 0.602, 0.584, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.612, 0.605, 0.564], 'all_L1': [0.574, 0.585, 0.557, 0.529]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.624, 0.614, 0.598], 'all_L1': [0.582, 0.577, 0.557, 0.539]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.622, 0.633, 0.606], 'all_L1': [0.575, 0.577, 0.565, 0.537]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.645, 0.612, 0.604], 'all_L1': [0.561, 0.591, 0.558, 0.545]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.512 +- 0.017, 0.568 +- 0.026, 0.776 +- 0.017, 1.000 +- 0.000
suff++ class all_KL  =  0.511 +- 0.031, 0.560 +- 0.043, 0.840 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.445 +- 0.018, 0.640 +- 0.022, 0.857 +- 0.019
nec class all_L1  =  0.571 +- 0.008, 0.586 +- 0.009, 0.564 +- 0.010, 0.541 +- 0.009
nec class all_KL  =  0.576 +- 0.019, 0.635 +- 0.021, 0.626 +- 0.022, 0.601 +- 0.023
nec_acc_int  =  0.336 +- 0.021, 0.382 +- 0.026, 0.500 +- 0.013, 0.542 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.542 +- 0.005, 0.577 +- 0.010, 0.670 +- 0.010, 0.771 +- 0.004
Faith. Armon (L1)= 		  =  0.540 +- 0.006, 0.577 +- 0.011, 0.653 +- 0.009, 0.702 +- 0.008
Faith. GMean (L1)= 	  =  0.541 +- 0.006, 0.577 +- 0.010, 0.662 +- 0.010, 0.736 +- 0.006
Faith. Aritm (KL)= 		  =  0.543 +- 0.008, 0.598 +- 0.013, 0.733 +- 0.014, 0.801 +- 0.011
Faith. Armon (KL)= 		  =  0.540 +- 0.010, 0.594 +- 0.016, 0.717 +- 0.016, 0.751 +- 0.018
Faith. GMean (KL)= 	  =  0.542 +- 0.009, 0.596 +- 0.014, 0.725 +- 0.015, 0.775 +- 0.015
Computed for split load_split = id



Completed in  0:07:55.005304  for GSATGIN GOODMotif/basis



DONE GSAT GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:49:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:49:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.8933
Train Loss: 0.4689
ID Validation ACCURACY: 0.8867
ID Validation Loss: 0.4937
ID Test ACCURACY: 0.9010
ID Test Loss: 0.4439
OOD Validation ACCURACY: 0.6550
OOD Validation Loss: 1.5131
OOD Test ACCURACY: 0.3787
OOD Test Loss: 2.5757

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ACCURACY: 0.5774
Train Loss: 1.3209
ID Validation ACCURACY: 0.5740
ID Validation Loss: 1.3483
ID Test ACCURACY: 0.5860
ID Test Loss: 1.2983
OOD Validation ACCURACY: 0.9227
OOD Validation Loss: 0.4906
OOD Test ACCURACY: 0.3487
OOD Test Loss: 9.0129

[0m[1;37mINFO[0m: [1mChartInfo 0.9010 0.3787 0.5860 0.3487 0.5740 0.9227[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.6 = 0.554
WIoU for r=0.6 = 0.669


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  0.55354125
Model XAI WIoU of binarized graphs for r=0.6 =  0.6687150000000002
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.609
SUFF++ for r=0.6 class 0 = 0.385 +- 0.278 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.6 class 1 = 0.559 +- 0.278 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.6 class 2 = 0.61 +- 0.278 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.6 all KL = 0.474 +- 0.278 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.6 all L1 = 0.519 +- 0.206 (in-sample avg dev_std = 0.553)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  0.55354125
Model XAI WIoU of binarized graphs for r=0.6 =  0.6687150000000002
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.448
NEC for r=0.6 class 0 = 0.592 +- 0.260 (in-sample avg dev_std = 0.627)
NEC for r=0.6 class 1 = 0.562 +- 0.260 (in-sample avg dev_std = 0.627)
NEC for r=0.6 class 2 = 0.646 +- 0.260 (in-sample avg dev_std = 0.627)
NEC for r=0.6 all KL = 0.665 +- 0.260 (in-sample avg dev_std = 0.627)
NEC for r=0.6 all L1 = 0.6 +- 0.154 (in-sample avg dev_std = 0.627)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:50:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:50:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.8799
Train Loss: 0.4851
ID Validation ACCURACY: 0.8757
ID Validation Loss: 0.5174
ID Test ACCURACY: 0.8873
ID Test Loss: 0.4680
OOD Validation ACCURACY: 0.6670
OOD Validation Loss: 0.9447
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.0736

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ACCURACY: 0.8507
Train Loss: 0.4884
ID Validation ACCURACY: 0.8450
ID Validation Loss: 0.5152
ID Test ACCURACY: 0.8610
ID Test Loss: 0.4707
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4447
OOD Test ACCURACY: 0.3857
OOD Test Loss: 4.2847

[0m[1;37mINFO[0m: [1mChartInfo 0.8873 0.4367 0.8610 0.3857 0.8450 0.9313[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.6 = 0.582
WIoU for r=0.6 = 0.676


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  0.5823025
Model XAI WIoU of binarized graphs for r=0.6 =  0.6759175000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.64
SUFF++ for r=0.6 class 0 = 0.471 +- 0.304 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 1 = 0.631 +- 0.304 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 2 = 0.565 +- 0.304 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 all KL = 0.463 +- 0.304 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 all L1 = 0.557 +- 0.217 (in-sample avg dev_std = 0.574)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  0.5823025
Model XAI WIoU of binarized graphs for r=0.6 =  0.6759175000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.471
NEC for r=0.6 class 0 = 0.571 +- 0.272 (in-sample avg dev_std = 0.658)
NEC for r=0.6 class 1 = 0.543 +- 0.272 (in-sample avg dev_std = 0.658)
NEC for r=0.6 class 2 = 0.655 +- 0.272 (in-sample avg dev_std = 0.658)
NEC for r=0.6 all KL = 0.7 +- 0.272 (in-sample avg dev_std = 0.658)
NEC for r=0.6 all L1 = 0.589 +- 0.178 (in-sample avg dev_std = 0.658)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:51:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 05:51:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9108
Train Loss: 0.4126
ID Validation ACCURACY: 0.9080
ID Validation Loss: 0.4411
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4096
OOD Validation ACCURACY: 0.9047
OOD Validation Loss: 0.4491
OOD Test ACCURACY: 0.4210
OOD Test Loss: 3.6186

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8849
Train Loss: 0.5208
ID Validation ACCURACY: 0.8813
ID Validation Loss: 0.5566
ID Test ACCURACY: 0.8920
ID Test Loss: 0.5012
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4367
OOD Test ACCURACY: 0.3817
OOD Test Loss: 5.1552

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4210 0.8920 0.3817 0.8813 0.9313[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.646


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.934
Model XAI F1 of binarized graphs for r=0.6 =  0.56740875
Model XAI WIoU of binarized graphs for r=0.6 =  0.6459024999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.651
SUFF++ for r=0.6 class 0 = 0.425 +- 0.298 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.6 class 1 = 0.592 +- 0.298 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.6 class 2 = 0.678 +- 0.298 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.6 all KL = 0.467 +- 0.298 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.6 all L1 = 0.566 +- 0.230 (in-sample avg dev_std = 0.586)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.934
Model XAI F1 of binarized graphs for r=0.6 =  0.56740875
Model XAI WIoU of binarized graphs for r=0.6 =  0.6459024999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.462
NEC for r=0.6 class 0 = 0.618 +- 0.265 (in-sample avg dev_std = 0.656)
NEC for r=0.6 class 1 = 0.534 +- 0.265 (in-sample avg dev_std = 0.656)
NEC for r=0.6 class 2 = 0.64 +- 0.265 (in-sample avg dev_std = 0.656)
NEC for r=0.6 all KL = 0.7 +- 0.265 (in-sample avg dev_std = 0.656)
NEC for r=0.6 all L1 = 0.596 +- 0.166 (in-sample avg dev_std = 0.656)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:52:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:28 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4784
ID Validation ACCURACY: 0.8877
ID Validation Loss: 0.5235
ID Test ACCURACY: 0.9007
ID Test Loss: 0.4658
OOD Validation ACCURACY: 0.8657
OOD Validation Loss: 0.4939
OOD Test ACCURACY: 0.4123
OOD Test Loss: 4.0821

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.4968
Train Loss: 1.1639
ID Validation ACCURACY: 0.4947
ID Validation Loss: 1.2213
ID Test ACCURACY: 0.4953
ID Test Loss: 1.1575
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4981
OOD Test ACCURACY: 0.3283
OOD Test Loss: 9.9458

[0m[1;37mINFO[0m: [1mChartInfo 0.9007 0.4123 0.4953 0.3283 0.4947 0.9307[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.6 = 0.581
WIoU for r=0.6 = 0.687


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.5807887500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.68729375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.671
SUFF++ for r=0.6 class 0 = 0.406 +- 0.332 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.6 class 1 = 0.708 +- 0.332 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.6 class 2 = 0.679 +- 0.332 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.6 all KL = 0.478 +- 0.332 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.6 all L1 = 0.6 +- 0.259 (in-sample avg dev_std = 0.587)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.5807887500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.68729375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.436
NEC for r=0.6 class 0 = 0.659 +- 0.234 (in-sample avg dev_std = 0.704)
NEC for r=0.6 class 1 = 0.567 +- 0.234 (in-sample avg dev_std = 0.704)
NEC for r=0.6 class 2 = 0.656 +- 0.234 (in-sample avg dev_std = 0.704)
NEC for r=0.6 all KL = 0.797 +- 0.234 (in-sample avg dev_std = 0.704)
NEC for r=0.6 all L1 = 0.626 +- 0.162 (in-sample avg dev_std = 0.704)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:52:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 05:52:53 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:11 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 16...
[0m[1;37mINFO[0m: [1mCheckpoint 16: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4924
ID Validation ACCURACY: 0.8847
ID Validation Loss: 0.5324
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4691
OOD Validation ACCURACY: 0.7167
OOD Validation Loss: 1.3877
OOD Test ACCURACY: 0.3873
OOD Test Loss: 3.5672

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ACCURACY: 0.8089
Train Loss: 0.6907
ID Validation ACCURACY: 0.8030
ID Validation Loss: 0.7150
ID Test ACCURACY: 0.8183
ID Test Loss: 0.6665
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4273
OOD Test ACCURACY: 0.4333
OOD Test Loss: 4.3285

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3873 0.8183 0.4333 0.8030 0.9317[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.6 = 0.585
WIoU for r=0.6 = 0.657


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.5849975
Model XAI WIoU of binarized graphs for r=0.6 =  0.6572274999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.644
SUFF++ for r=0.6 class 0 = 0.396 +- 0.326 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 1 = 0.746 +- 0.326 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 2 = 0.645 +- 0.326 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 all KL = 0.517 +- 0.326 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 all L1 = 0.598 +- 0.260 (in-sample avg dev_std = 0.540)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.5849975
Model XAI WIoU of binarized graphs for r=0.6 =  0.6572274999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.438
NEC for r=0.6 class 0 = 0.623 +- 0.254 (in-sample avg dev_std = 0.692)
NEC for r=0.6 class 1 = 0.548 +- 0.254 (in-sample avg dev_std = 0.692)
NEC for r=0.6 class 2 = 0.674 +- 0.254 (in-sample avg dev_std = 0.692)
NEC for r=0.6 all KL = 0.742 +- 0.254 (in-sample avg dev_std = 0.692)
NEC for r=0.6 all L1 = 0.614 +- 0.169 (in-sample avg dev_std = 0.692)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.474], 'all_L1': [0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.463], 'all_L1': [0.557]}), defaultdict(<class 'list'>, {'all_KL': [0.467], 'all_L1': [0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.478], 'all_L1': [0.6]}), defaultdict(<class 'list'>, {'all_KL': [0.517], 'all_L1': [0.598]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.665], 'all_L1': [0.6]}), defaultdict(<class 'list'>, {'all_KL': [0.7], 'all_L1': [0.589]}), defaultdict(<class 'list'>, {'all_KL': [0.7], 'all_L1': [0.596]}), defaultdict(<class 'list'>, {'all_KL': [0.797], 'all_L1': [0.626]}), defaultdict(<class 'list'>, {'all_KL': [0.742], 'all_L1': [0.614]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.568 +- 0.030
suff++ class all_KL  =  0.480 +- 0.019
suff++_acc_int  =  0.643 +- 0.020
nec class all_L1  =  0.605 +- 0.013
nec class all_KL  =  0.721 +- 0.045
nec_acc_int  =  0.451 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.586 +- 0.020
Faith. Armon (L1)= 		  =  0.586 +- 0.021
Faith. GMean (L1)= 	  =  0.586 +- 0.021
Faith. Aritm (KL)= 		  =  0.600 +- 0.028
Faith. Armon (KL)= 		  =  0.576 +- 0.023
Faith. GMean (KL)= 	  =  0.588 +- 0.025
Computed for split load_split = id



Completed in  0:03:46.427863  for CIGAGIN GOODMotif/basis



DONE CIGA GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:53:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:53:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3252
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3127
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3421
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4181
OOD Test ACCURACY: 0.7947
OOD Test Loss: 0.8208

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.3388
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3254
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3540
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3738
OOD Test ACCURACY: 0.6353
OOD Test Loss: 1.7363

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7947 0.9243 0.6353 0.9317 0.9300[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.680
WIoU for r=0.3 = 0.558
F1 for r=0.6 = 0.572
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.463
WIoU for r=0.9 = 0.340
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.330


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.449
Model XAI F1 of binarized graphs for r=0.3 =  0.6801699999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5580787500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.449
SUFF++ for r=0.3 class 0 = 0.489 +- 0.269 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 1 = 0.577 +- 0.269 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 2 = 0.524 +- 0.269 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 all KL = 0.557 +- 0.269 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 all L1 = 0.53 +- 0.160 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.695
Model XAI F1 of binarized graphs for r=0.6 =  0.57180875
Model XAI WIoU of binarized graphs for r=0.6 =  0.453105
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.611
SUFF++ for r=0.6 class 0 = 0.446 +- 0.254 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 1 = 0.771 +- 0.254 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 2 = 0.65 +- 0.254 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all KL = 0.647 +- 0.254 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all L1 = 0.624 +- 0.216 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.46347125
Model XAI WIoU of binarized graphs for r=0.9 =  0.34010874999999996
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0 = 0.608 +- 0.186 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 1 = 0.852 +- 0.186 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 2 = 0.82 +- 0.186 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all KL = 0.827 +- 0.186 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.172 (in-sample avg dev_std = 0.321)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.449
Model XAI F1 of binarized graphs for r=0.3 =  0.6801699999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5580787500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.587 +- 0.300 (in-sample avg dev_std = 0.370)
NEC for r=0.3 class 1 = 0.467 +- 0.300 (in-sample avg dev_std = 0.370)
NEC for r=0.3 class 2 = 0.624 +- 0.300 (in-sample avg dev_std = 0.370)
NEC for r=0.3 all KL = 0.548 +- 0.300 (in-sample avg dev_std = 0.370)
NEC for r=0.3 all L1 = 0.559 +- 0.187 (in-sample avg dev_std = 0.370)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.694
Model XAI F1 of binarized graphs for r=0.6 =  0.57180875
Model XAI WIoU of binarized graphs for r=0.6 =  0.453105
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.582 +- 0.276 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 1 = 0.452 +- 0.276 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 2 = 0.653 +- 0.276 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all KL = 0.602 +- 0.276 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all L1 = 0.562 +- 0.184 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.46347125
Model XAI WIoU of binarized graphs for r=0.9 =  0.34010874999999996
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.612 +- 0.235 (in-sample avg dev_std = 0.555)
NEC for r=0.9 class 1 = 0.446 +- 0.235 (in-sample avg dev_std = 0.555)
NEC for r=0.9 class 2 = 0.595 +- 0.235 (in-sample avg dev_std = 0.555)
NEC for r=0.9 all KL = 0.577 +- 0.235 (in-sample avg dev_std = 0.555)
NEC for r=0.9 all L1 = 0.55 +- 0.164 (in-sample avg dev_std = 0.555)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.33045625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.55
NEC for r=1.0 class 0 = 0.562 +- 0.241 (in-sample avg dev_std = 0.598)
NEC for r=1.0 class 1 = 0.418 +- 0.241 (in-sample avg dev_std = 0.598)
NEC for r=1.0 class 2 = 0.565 +- 0.241 (in-sample avg dev_std = 0.598)
NEC for r=1.0 all KL = 0.548 +- 0.241 (in-sample avg dev_std = 0.598)
NEC for r=1.0 all L1 = 0.515 +- 0.176 (in-sample avg dev_std = 0.598)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:55:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:55:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3173
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3076
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3411
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 0.4798
OOD Test ACCURACY: 0.6430
OOD Test Loss: 0.9596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.9249
Train Loss: 0.3435
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3292
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3609
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3859
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.8691

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6430 0.9200 0.5833 0.9297 0.9273[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.722
WIoU for r=0.3 = 0.601
F1 for r=0.6 = 0.601
WIoU for r=0.6 = 0.481
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.359
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.334


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.7219525
Model XAI WIoU of binarized graphs for r=0.3 =  0.60076625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.454
SUFF++ for r=0.3 class 0 = 0.423 +- 0.275 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 1 = 0.486 +- 0.275 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 2 = 0.541 +- 0.275 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all KL = 0.503 +- 0.275 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all L1 = 0.483 +- 0.162 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.739
Model XAI F1 of binarized graphs for r=0.6 =  0.6005325
Model XAI WIoU of binarized graphs for r=0.6 =  0.48062625000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.657
SUFF++ for r=0.6 class 0 = 0.451 +- 0.260 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.685 +- 0.260 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.652 +- 0.260 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.603 +- 0.260 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.597 +- 0.193 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.4804925
Model XAI WIoU of binarized graphs for r=0.9 =  0.3590275
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.704 +- 0.201 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 1 = 0.807 +- 0.201 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 2 = 0.831 +- 0.201 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all KL = 0.843 +- 0.201 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all L1 = 0.781 +- 0.191 (in-sample avg dev_std = 0.276)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.474
Model XAI F1 of binarized graphs for r=0.3 =  0.7219525
Model XAI WIoU of binarized graphs for r=0.3 =  0.60076625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.655 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 1 = 0.568 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 2 = 0.617 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all KL = 0.611 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all L1 = 0.613 +- 0.151 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.735
Model XAI F1 of binarized graphs for r=0.6 =  0.6005325
Model XAI WIoU of binarized graphs for r=0.6 =  0.48062625000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.369
NEC for r=0.6 class 0 = 0.613 +- 0.297 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.457 +- 0.297 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.657 +- 0.297 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.603 +- 0.297 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.575 +- 0.199 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.4804925
Model XAI WIoU of binarized graphs for r=0.9 =  0.3590275
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.599 +- 0.251 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.488 +- 0.251 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.563 +- 0.251 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.578 +- 0.251 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.55 +- 0.159 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.3342
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0 = 0.554 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=1.0 class 1 = 0.438 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=1.0 class 2 = 0.555 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=1.0 all KL = 0.545 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=1.0 all L1 = 0.516 +- 0.172 (in-sample avg dev_std = 0.594)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:56:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:56:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3303
ID Validation ACCURACY: 0.9350
ID Validation Loss: 0.3133
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3501
OOD Validation ACCURACY: 0.8013
OOD Validation Loss: 0.5544
OOD Test ACCURACY: 0.7917
OOD Test Loss: 0.8351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9260
Train Loss: 0.3556
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3333
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3700
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4586
OOD Test ACCURACY: 0.6470
OOD Test Loss: 1.3751

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7917 0.9233 0.6470 0.9317 0.9260[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.662
WIoU for r=0.3 = 0.537
F1 for r=0.6 = 0.559
WIoU for r=0.6 = 0.437
F1 for r=0.9 = 0.469
WIoU for r=0.9 = 0.343
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.328


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.661515
Model XAI WIoU of binarized graphs for r=0.3 =  0.5367175000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.401 +- 0.245 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 1 = 0.506 +- 0.245 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 2 = 0.485 +- 0.245 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all KL = 0.451 +- 0.245 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all L1 = 0.465 +- 0.162 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.55908875
Model XAI WIoU of binarized graphs for r=0.6 =  0.43673125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.622
SUFF++ for r=0.6 class 0 = 0.453 +- 0.259 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1 = 0.672 +- 0.259 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 2 = 0.659 +- 0.259 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.595 +- 0.259 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.596 +- 0.187 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.46854
Model XAI WIoU of binarized graphs for r=0.9 =  0.34263125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.839
SUFF++ for r=0.9 class 0 = 0.663 +- 0.185 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 class 1 = 0.858 +- 0.185 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 class 2 = 0.824 +- 0.185 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 all KL = 0.841 +- 0.185 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 all L1 = 0.783 +- 0.172 (in-sample avg dev_std = 0.288)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.661515
Model XAI WIoU of binarized graphs for r=0.3 =  0.5367175000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.622 +- 0.247 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 1 = 0.531 +- 0.247 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 2 = 0.665 +- 0.247 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all KL = 0.628 +- 0.247 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all L1 = 0.606 +- 0.152 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.658
Model XAI F1 of binarized graphs for r=0.6 =  0.55908875
Model XAI WIoU of binarized graphs for r=0.6 =  0.43673125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.585 +- 0.289 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.434 +- 0.289 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.655 +- 0.289 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.599 +- 0.289 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.558 +- 0.190 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.46854
Model XAI WIoU of binarized graphs for r=0.9 =  0.34263125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.511
NEC for r=0.9 class 0 = 0.63 +- 0.221 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 1 = 0.451 +- 0.221 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 2 = 0.575 +- 0.221 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all KL = 0.616 +- 0.221 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all L1 = 0.551 +- 0.164 (in-sample avg dev_std = 0.585)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.32799375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.554
NEC for r=1.0 class 0 = 0.577 +- 0.246 (in-sample avg dev_std = 0.627)
NEC for r=1.0 class 1 = 0.397 +- 0.246 (in-sample avg dev_std = 0.627)
NEC for r=1.0 class 2 = 0.576 +- 0.246 (in-sample avg dev_std = 0.627)
NEC for r=1.0 all KL = 0.577 +- 0.246 (in-sample avg dev_std = 0.627)
NEC for r=1.0 all L1 = 0.516 +- 0.178 (in-sample avg dev_std = 0.627)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:57:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:57:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3118
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3016
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3358
OOD Validation ACCURACY: 0.8073
OOD Validation Loss: 0.5158
OOD Test ACCURACY: 0.7527
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9293
Train Loss: 0.3258
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3155
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3465
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4445
OOD Test ACCURACY: 0.5280
OOD Test Loss: 1.3857

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7527 0.9257 0.5280 0.9347 0.9260[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.717
WIoU for r=0.3 = 0.596
F1 for r=0.6 = 0.599
WIoU for r=0.6 = 0.477
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.357
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.333


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.717405
Model XAI WIoU of binarized graphs for r=0.3 =  0.5960949999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.478
SUFF++ for r=0.3 class 0 = 0.464 +- 0.254 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 1 = 0.619 +- 0.254 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 2 = 0.54 +- 0.254 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all KL = 0.575 +- 0.254 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all L1 = 0.541 +- 0.165 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.779
Model XAI F1 of binarized graphs for r=0.6 =  0.59869125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47710250000000004
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.676
SUFF++ for r=0.6 class 0 = 0.455 +- 0.249 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 1 = 0.719 +- 0.249 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 2 = 0.68 +- 0.249 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all KL = 0.674 +- 0.249 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all L1 = 0.619 +- 0.195 (in-sample avg dev_std = 0.397)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.47951625
Model XAI WIoU of binarized graphs for r=0.9 =  0.35691874999999995
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF++ for r=0.9 class 0 = 0.727 +- 0.176 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.844 +- 0.176 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.827 +- 0.176 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.868 +- 0.176 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.8 +- 0.163 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.474
Model XAI F1 of binarized graphs for r=0.3 =  0.717405
Model XAI WIoU of binarized graphs for r=0.3 =  0.5960949999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
NEC for r=0.3 class 0 = 0.61 +- 0.269 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.453 +- 0.269 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.575 +- 0.269 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.535 +- 0.269 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.545 +- 0.178 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  0.59869125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47710250000000004
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.459
NEC for r=0.6 class 0 = 0.648 +- 0.266 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 1 = 0.45 +- 0.266 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 2 = 0.623 +- 0.266 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all KL = 0.573 +- 0.266 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all L1 = 0.573 +- 0.165 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.47951625
Model XAI WIoU of binarized graphs for r=0.9 =  0.35691874999999995
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.61 +- 0.224 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.44 +- 0.224 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.573 +- 0.224 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.562 +- 0.224 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.541 +- 0.163 (in-sample avg dev_std = 0.566)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.33315125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.564 +- 0.248 (in-sample avg dev_std = 0.605)
NEC for r=1.0 class 1 = 0.398 +- 0.248 (in-sample avg dev_std = 0.605)
NEC for r=1.0 class 2 = 0.583 +- 0.248 (in-sample avg dev_std = 0.605)
NEC for r=1.0 all KL = 0.553 +- 0.248 (in-sample avg dev_std = 0.605)
NEC for r=1.0 all L1 = 0.515 +- 0.182 (in-sample avg dev_std = 0.605)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 17:59:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 05:59:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3216
ID Validation ACCURACY: 0.9353
ID Validation Loss: 0.3083
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3413
OOD Validation ACCURACY: 0.9157
OOD Validation Loss: 0.4277
OOD Test ACCURACY: 0.7673
OOD Test Loss: 0.8079

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3200
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3075
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3766
OOD Test ACCURACY: 0.7923
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7673 0.9250 0.7923 0.9337 0.9280[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.690
WIoU for r=0.3 = 0.568
F1 for r=0.6 = 0.576
WIoU for r=0.6 = 0.458
F1 for r=0.9 = 0.458
WIoU for r=0.9 = 0.335
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.329


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.44
Model XAI F1 of binarized graphs for r=0.3 =  0.69029
Model XAI WIoU of binarized graphs for r=0.3 =  0.56783625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.456
SUFF++ for r=0.3 class 0 = 0.479 +- 0.261 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 1 = 0.499 +- 0.261 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 2 = 0.552 +- 0.261 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all KL = 0.578 +- 0.261 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all L1 = 0.51 +- 0.160 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  0.57623125
Model XAI WIoU of binarized graphs for r=0.6 =  0.45824375000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.638
SUFF++ for r=0.6 class 0 = 0.481 +- 0.247 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.247 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 2 = 0.66 +- 0.247 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all KL = 0.648 +- 0.247 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all L1 = 0.611 +- 0.181 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.4584587500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.33526000000000006
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.858
SUFF++ for r=0.9 class 0 = 0.651 +- 0.181 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 class 1 = 0.834 +- 0.181 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 class 2 = 0.823 +- 0.181 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 all KL = 0.838 +- 0.181 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.153 (in-sample avg dev_std = 0.317)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.44
Model XAI F1 of binarized graphs for r=0.3 =  0.69029
Model XAI WIoU of binarized graphs for r=0.3 =  0.56783625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.303
NEC for r=0.3 class 0 = 0.602 +- 0.275 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.559 +- 0.275 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.584 +- 0.275 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.535 +- 0.275 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.581 +- 0.148 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  0.57623125
Model XAI WIoU of binarized graphs for r=0.6 =  0.45824375000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.582 +- 0.276 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 1 = 0.508 +- 0.276 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 2 = 0.653 +- 0.276 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all KL = 0.586 +- 0.276 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all L1 = 0.581 +- 0.164 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.4584587500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.33526000000000006
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.512
NEC for r=0.9 class 0 = 0.587 +- 0.213 (in-sample avg dev_std = 0.563)
NEC for r=0.9 class 1 = 0.474 +- 0.213 (in-sample avg dev_std = 0.563)
NEC for r=0.9 class 2 = 0.561 +- 0.213 (in-sample avg dev_std = 0.563)
NEC for r=0.9 all KL = 0.557 +- 0.213 (in-sample avg dev_std = 0.563)
NEC for r=0.9 all L1 = 0.54 +- 0.161 (in-sample avg dev_std = 0.563)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.32941875000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.537 +- 0.229 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 1 = 0.443 +- 0.229 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 2 = 0.564 +- 0.229 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all KL = 0.539 +- 0.229 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all L1 = 0.514 +- 0.170 (in-sample avg dev_std = 0.610)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.557, 0.647, 0.827, 1.0], 'all_L1': [0.53, 0.624, 0.761, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.503, 0.603, 0.843, 1.0], 'all_L1': [0.483, 0.597, 0.781, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.451, 0.595, 0.841, 1.0], 'all_L1': [0.465, 0.596, 0.783, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.575, 0.674, 0.868, 1.0], 'all_L1': [0.541, 0.619, 0.8, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.648, 0.838, 1.0], 'all_L1': [0.51, 0.611, 0.77, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.548, 0.602, 0.577, 0.548], 'all_L1': [0.559, 0.562, 0.55, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.611, 0.603, 0.578, 0.545], 'all_L1': [0.613, 0.575, 0.55, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.628, 0.599, 0.616, 0.577], 'all_L1': [0.606, 0.558, 0.551, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.535, 0.573, 0.562, 0.553], 'all_L1': [0.545, 0.573, 0.541, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.535, 0.586, 0.557, 0.539], 'all_L1': [0.581, 0.581, 0.54, 0.514]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.506 +- 0.028, 0.609 +- 0.011, 0.779 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.533 +- 0.049, 0.633 +- 0.030, 0.843 +- 0.013, 1.000 +- 0.000
suff++_acc_int  =  0.456 +- 0.012, 0.641 +- 0.024, 0.845 +- 0.016
nec class all_L1  =  0.581 +- 0.026, 0.570 +- 0.009, 0.546 +- 0.005, 0.515 +- 0.001
nec class all_KL  =  0.571 +- 0.040, 0.593 +- 0.012, 0.578 +- 0.021, 0.552 +- 0.013
nec_acc_int  =  0.327 +- 0.013, 0.396 +- 0.032, 0.513 +- 0.009, 0.548 +- 0.005


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.543 +- 0.004, 0.590 +- 0.007, 0.663 +- 0.006, 0.758 +- 0.000
Faith. Armon (L1)= 		  =  0.539 +- 0.007, 0.589 +- 0.007, 0.642 +- 0.005, 0.680 +- 0.001
Faith. GMean (L1)= 	  =  0.541 +- 0.005, 0.589 +- 0.007, 0.652 +- 0.005, 0.718 +- 0.001
Faith. Aritm (KL)= 		  =  0.552 +- 0.006, 0.613 +- 0.011, 0.711 +- 0.011, 0.776 +- 0.007
Faith. Armon (KL)= 		  =  0.548 +- 0.012, 0.612 +- 0.010, 0.686 +- 0.014, 0.712 +- 0.011
Faith. GMean (KL)= 	  =  0.550 +- 0.009, 0.612 +- 0.011, 0.698 +- 0.012, 0.743 +- 0.009
Computed for split load_split = id



Completed in  0:06:23.927868  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:00:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:00:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3767
ID Validation ACCURACY: 0.9243
ID Validation Loss: 0.3771
ID Test ACCURACY: 0.9193
ID Test Loss: 0.4310
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3978
OOD Test ACCURACY: 0.4087
OOD Test Loss: 27.1216

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3767
ID Validation ACCURACY: 0.9243
ID Validation Loss: 0.3771
ID Test ACCURACY: 0.9193
ID Test Loss: 0.4310
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3978
OOD Test ACCURACY: 0.4087
OOD Test Loss: 27.1216

[0m[1;37mINFO[0m: [1mChartInfo 0.9193 0.4087 0.9193 0.4087 0.9243 0.9260[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.8 = 0.517
WIoU for r=0.8 = 0.647


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.5167725
Model XAI WIoU of binarized graphs for r=0.8 =  0.6473637500000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.693
SUFF++ for r=0.8 class 0 = 0.474 +- 0.314 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.8 class 1 = 0.559 +- 0.314 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.8 class 2 = 0.874 +- 0.314 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.8 all KL = 0.6 +- 0.314 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.8 all L1 = 0.636 +- 0.254 (in-sample avg dev_std = 0.524)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.5167725
Model XAI WIoU of binarized graphs for r=0.8 =  0.6473637500000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.433
NEC for r=0.8 class 0 = 0.659 +- 0.231 (in-sample avg dev_std = 0.691)
NEC for r=0.8 class 1 = 0.613 +- 0.231 (in-sample avg dev_std = 0.691)
NEC for r=0.8 class 2 = 0.582 +- 0.231 (in-sample avg dev_std = 0.691)
NEC for r=0.8 all KL = 0.732 +- 0.231 (in-sample avg dev_std = 0.691)
NEC for r=0.8 all L1 = 0.618 +- 0.156 (in-sample avg dev_std = 0.691)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:01:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8638
Train Loss: 0.5776
ID Validation ACCURACY: 0.8760
ID Validation Loss: 0.5248
ID Test ACCURACY: 0.8623
ID Test Loss: 0.5892
OOD Validation ACCURACY: 0.8237
OOD Validation Loss: 0.5364
OOD Test ACCURACY: 0.6500
OOD Test Loss: 2.0536

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.8533
Train Loss: 0.5252
ID Validation ACCURACY: 0.8630
ID Validation Loss: 0.4912
ID Test ACCURACY: 0.8500
ID Test Loss: 0.5371
OOD Validation ACCURACY: 0.8757
OOD Validation Loss: 0.4826
OOD Test ACCURACY: 0.4940
OOD Test Loss: 5.1451

[0m[1;37mINFO[0m: [1mChartInfo 0.8623 0.6500 0.8500 0.4940 0.8630 0.8757[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.8 = 0.516
WIoU for r=0.8 = 0.716


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.858
Model XAI F1 of binarized graphs for r=0.8 =  0.5163899999999999
Model XAI WIoU of binarized graphs for r=0.8 =  0.7159762500000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.726
SUFF++ for r=0.8 class 0 = 0.613 +- 0.329 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.8 class 1 = 0.915 +- 0.329 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.8 class 2 = 0.636 +- 0.329 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.8 all KL = 0.699 +- 0.329 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.8 all L1 = 0.722 +- 0.261 (in-sample avg dev_std = 0.409)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.858
Model XAI F1 of binarized graphs for r=0.8 =  0.5163899999999999
Model XAI WIoU of binarized graphs for r=0.8 =  0.7159762500000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.445
NEC for r=0.8 class 0 = 0.597 +- 0.257 (in-sample avg dev_std = 0.722)
NEC for r=0.8 class 1 = 0.469 +- 0.257 (in-sample avg dev_std = 0.722)
NEC for r=0.8 class 2 = 0.663 +- 0.257 (in-sample avg dev_std = 0.722)
NEC for r=0.8 all KL = 0.722 +- 0.257 (in-sample avg dev_std = 0.722)
NEC for r=0.8 all L1 = 0.576 +- 0.196 (in-sample avg dev_std = 0.722)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:01:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:01:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.9147
Train Loss: 0.4936
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4879
ID Test ACCURACY: 0.9093
ID Test Loss: 0.5467
OOD Validation ACCURACY: 0.8387
OOD Validation Loss: 0.5746
OOD Test ACCURACY: 0.4087
OOD Test Loss: 32.4148

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.8200
Train Loss: 0.6115
ID Validation ACCURACY: 0.8157
ID Validation Loss: 0.6203
ID Test ACCURACY: 0.8157
ID Test Loss: 0.6734
OOD Validation ACCURACY: 0.8897
OOD Validation Loss: 0.4646
OOD Test ACCURACY: 0.3343
OOD Test Loss: 29.0064

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.4087 0.8157 0.3343 0.8157 0.8897[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.8 = 0.522
WIoU for r=0.8 = 0.502


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.52196
Model XAI WIoU of binarized graphs for r=0.8 =  0.5021825000000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.645
SUFF++ for r=0.8 class 0 = 0.461 +- 0.318 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.8 class 1 = 0.536 +- 0.318 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.8 class 2 = 0.895 +- 0.318 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.8 all KL = 0.609 +- 0.318 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.8 all L1 = 0.631 +- 0.266 (in-sample avg dev_std = 0.527)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.52196
Model XAI WIoU of binarized graphs for r=0.8 =  0.5021825000000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.474
NEC for r=0.8 class 0 = 0.653 +- 0.255 (in-sample avg dev_std = 0.710)
NEC for r=0.8 class 1 = 0.588 +- 0.255 (in-sample avg dev_std = 0.710)
NEC for r=0.8 class 2 = 0.551 +- 0.255 (in-sample avg dev_std = 0.710)
NEC for r=0.8 all KL = 0.764 +- 0.255 (in-sample avg dev_std = 0.710)
NEC for r=0.8 all L1 = 0.597 +- 0.182 (in-sample avg dev_std = 0.710)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:02:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.9185
Train Loss: 0.4761
ID Validation ACCURACY: 0.9243
ID Validation Loss: 0.4624
ID Test ACCURACY: 0.9137
ID Test Loss: 0.5178
OOD Validation ACCURACY: 0.8713
OOD Validation Loss: 0.5049
OOD Test ACCURACY: 0.4087
OOD Test Loss: 34.3607

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9192
Train Loss: 0.4721
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.4583
ID Test ACCURACY: 0.9157
ID Test Loss: 0.5307
OOD Validation ACCURACY: 0.9143
OOD Validation Loss: 0.4105
OOD Test ACCURACY: 0.4087
OOD Test Loss: 17.9440

[0m[1;37mINFO[0m: [1mChartInfo 0.9137 0.4087 0.9157 0.4087 0.9240 0.9143[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.8 = 0.524
WIoU for r=0.8 = 0.521


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.924
Model XAI F1 of binarized graphs for r=0.8 =  0.5236637500000001
Model XAI WIoU of binarized graphs for r=0.8 =  0.5206025
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.746
SUFF++ for r=0.8 class 0 = 0.56 +- 0.294 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.8 class 1 = 0.625 +- 0.294 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.8 class 2 = 0.867 +- 0.294 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.8 all KL = 0.66 +- 0.294 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.8 all L1 = 0.684 +- 0.245 (in-sample avg dev_std = 0.450)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.924
Model XAI F1 of binarized graphs for r=0.8 =  0.5236637500000001
Model XAI WIoU of binarized graphs for r=0.8 =  0.5206025
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.46
NEC for r=0.8 class 0 = 0.673 +- 0.235 (in-sample avg dev_std = 0.715)
NEC for r=0.8 class 1 = 0.559 +- 0.235 (in-sample avg dev_std = 0.715)
NEC for r=0.8 class 2 = 0.587 +- 0.235 (in-sample avg dev_std = 0.715)
NEC for r=0.8 all KL = 0.771 +- 0.235 (in-sample avg dev_std = 0.715)
NEC for r=0.8 all L1 = 0.606 +- 0.178 (in-sample avg dev_std = 0.715)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:02:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.8962
Train Loss: 0.4182
ID Validation ACCURACY: 0.9057
ID Validation Loss: 0.4121
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4527
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4390
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.0354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8330
Train Loss: 0.5186
ID Validation ACCURACY: 0.8323
ID Validation Loss: 0.5186
ID Test ACCURACY: 0.8267
ID Test Loss: 0.5417
OOD Validation ACCURACY: 0.9140
OOD Validation Loss: 0.4398
OOD Test ACCURACY: 0.4087
OOD Test Loss: 25.0431

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.4087 0.8267 0.4087 0.8323 0.9140[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.8 = 0.479
WIoU for r=0.8 = 0.654


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.47861000000000004
Model XAI WIoU of binarized graphs for r=0.8 =  0.6541075000000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.573
SUFF++ for r=0.8 class 0 = 0.344 +- 0.334 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.8 class 1 = 0.601 +- 0.334 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.8 class 2 = 0.592 +- 0.334 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.8 all KL = 0.475 +- 0.334 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.8 all L1 = 0.513 +- 0.259 (in-sample avg dev_std = 0.446)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.47861000000000004
Model XAI WIoU of binarized graphs for r=0.8 =  0.6541075000000001
len(reference) = 800
Effective ratio: 0.811 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.453
NEC for r=0.8 class 0 = 0.647 +- 0.238 (in-sample avg dev_std = 0.683)
NEC for r=0.8 class 1 = 0.582 +- 0.238 (in-sample avg dev_std = 0.683)
NEC for r=0.8 class 2 = 0.619 +- 0.238 (in-sample avg dev_std = 0.683)
NEC for r=0.8 all KL = 0.717 +- 0.238 (in-sample avg dev_std = 0.683)
NEC for r=0.8 all L1 = 0.616 +- 0.151 (in-sample avg dev_std = 0.683)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.6], 'all_L1': [0.636]}), defaultdict(<class 'list'>, {'all_KL': [0.699], 'all_L1': [0.722]}), defaultdict(<class 'list'>, {'all_KL': [0.609], 'all_L1': [0.631]}), defaultdict(<class 'list'>, {'all_KL': [0.66], 'all_L1': [0.684]}), defaultdict(<class 'list'>, {'all_KL': [0.475], 'all_L1': [0.513]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.732], 'all_L1': [0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.722], 'all_L1': [0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.764], 'all_L1': [0.597]}), defaultdict(<class 'list'>, {'all_KL': [0.771], 'all_L1': [0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.717], 'all_L1': [0.616]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.637 +- 0.070
suff++ class all_KL  =  0.609 +- 0.076
suff++_acc_int  =  0.677 +- 0.062
nec class all_L1  =  0.603 +- 0.015
nec class all_KL  =  0.741 +- 0.022
nec_acc_int  =  0.453 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.620 +- 0.030
Faith. Armon (L1)= 		  =  0.617 +- 0.030
Faith. GMean (L1)= 	  =  0.618 +- 0.030
Faith. Aritm (KL)= 		  =  0.675 +- 0.043
Faith. Armon (KL)= 		  =  0.666 +- 0.051
Faith. GMean (KL)= 	  =  0.670 +- 0.047
Computed for split load_split = id



Completed in  0:01:56.499601  for CIGAGIN GOODMotif2/basis



DONE CIGA GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:02:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:02:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:16 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:22 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:22 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:03:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.742
WIoU for r=0.3 = 0.631
F1 for r=0.6 = 0.657
WIoU for r=0.6 = 0.544
F1 for r=0.9 = 0.528
WIoU for r=0.9 = 0.411
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.392


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.466
Model XAI F1 of binarized graphs for r=0.3 =  0.7422624999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6310549999999999
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.417
SUFF++ for r=0.3 class 0 = 0.461 +- 0.304 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 class 1 = 0.585 +- 0.304 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.304 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 all KL = 0.535 +- 0.304 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 all L1 = 0.532 +- 0.172 (in-sample avg dev_std = 0.515)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  0.65731
Model XAI WIoU of binarized graphs for r=0.6 =  0.5440887499999999
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.71
SUFF++ for r=0.6 class 0 = 0.62 +- 0.271 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 1 = 0.64 +- 0.271 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 2 = 0.712 +- 0.271 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all KL = 0.672 +- 0.271 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all L1 = 0.657 +- 0.211 (in-sample avg dev_std = 0.426)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.5283262499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.4113200000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF++ for r=0.9 class 0 = 0.834 +- 0.168 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.168 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 2 = 0.887 +- 0.168 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.901 +- 0.168 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.151 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.7422624999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6310549999999999
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.578 +- 0.355 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 1 = 0.505 +- 0.355 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 2 = 0.559 +- 0.355 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all KL = 0.522 +- 0.355 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all L1 = 0.547 +- 0.218 (in-sample avg dev_std = 0.343)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.78
Model XAI F1 of binarized graphs for r=0.6 =  0.65731
Model XAI WIoU of binarized graphs for r=0.6 =  0.5440887499999999
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.607 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 1 = 0.553 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 2 = 0.67 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all KL = 0.655 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all L1 = 0.609 +- 0.160 (in-sample avg dev_std = 0.497)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.901
Model XAI F1 of binarized graphs for r=0.9 =  0.5283262499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.4113200000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.475
NEC for r=0.9 class 0 = 0.602 +- 0.243 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 1 = 0.503 +- 0.243 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 2 = 0.61 +- 0.243 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all KL = 0.619 +- 0.243 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all L1 = 0.571 +- 0.164 (in-sample avg dev_std = 0.573)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.39188750000000006
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.507
NEC for r=1.0 class 0 = 0.577 +- 0.244 (in-sample avg dev_std = 0.621)
NEC for r=1.0 class 1 = 0.471 +- 0.244 (in-sample avg dev_std = 0.621)
NEC for r=1.0 class 2 = 0.611 +- 0.244 (in-sample avg dev_std = 0.621)
NEC for r=1.0 all KL = 0.628 +- 0.244 (in-sample avg dev_std = 0.621)
NEC for r=1.0 all L1 = 0.553 +- 0.169 (in-sample avg dev_std = 0.621)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:04:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:04:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:04:48 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:04:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:04:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:04:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:05:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.732
WIoU for r=0.3 = 0.616
F1 for r=0.6 = 0.650
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.525
WIoU for r=0.9 = 0.400
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.384


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.501
Model XAI F1 of binarized graphs for r=0.3 =  0.73231875
Model XAI WIoU of binarized graphs for r=0.3 =  0.615705
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.437
SUFF++ for r=0.3 class 0 = 0.511 +- 0.276 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 1 = 0.591 +- 0.276 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 2 = 0.575 +- 0.276 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all KL = 0.591 +- 0.276 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all L1 = 0.559 +- 0.172 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.64960375
Model XAI WIoU of binarized graphs for r=0.6 =  0.5294
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.682
SUFF++ for r=0.6 class 0 = 0.604 +- 0.249 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.609 +- 0.249 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.706 +- 0.249 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.688 +- 0.249 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.64 +- 0.194 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  0.5249875
Model XAI WIoU of binarized graphs for r=0.9 =  0.4001075
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0 = 0.751 +- 0.159 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 1 = 0.804 +- 0.159 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 2 = 0.873 +- 0.159 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all KL = 0.879 +- 0.159 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all L1 = 0.81 +- 0.170 (in-sample avg dev_std = 0.245)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.499
Model XAI F1 of binarized graphs for r=0.3 =  0.73231875
Model XAI WIoU of binarized graphs for r=0.3 =  0.615705
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.566 +- 0.345 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 1 = 0.456 +- 0.345 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 2 = 0.55 +- 0.345 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all KL = 0.477 +- 0.345 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all L1 = 0.523 +- 0.233 (in-sample avg dev_std = 0.335)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.64960375
Model XAI WIoU of binarized graphs for r=0.6 =  0.5294
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.389
NEC for r=0.6 class 0 = 0.566 +- 0.278 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.523 +- 0.278 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.668 +- 0.278 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.581 +- 0.278 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.585 +- 0.167 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.5249875
Model XAI WIoU of binarized graphs for r=0.9 =  0.4001075
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.48
NEC for r=0.9 class 0 = 0.542 +- 0.254 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 1 = 0.522 +- 0.254 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 2 = 0.576 +- 0.254 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all KL = 0.551 +- 0.254 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all L1 = 0.547 +- 0.166 (in-sample avg dev_std = 0.551)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.383745
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.498
NEC for r=1.0 class 0 = 0.55 +- 0.256 (in-sample avg dev_std = 0.590)
NEC for r=1.0 class 1 = 0.491 +- 0.256 (in-sample avg dev_std = 0.590)
NEC for r=1.0 class 2 = 0.602 +- 0.256 (in-sample avg dev_std = 0.590)
NEC for r=1.0 all KL = 0.578 +- 0.256 (in-sample avg dev_std = 0.590)
NEC for r=1.0 all L1 = 0.547 +- 0.170 (in-sample avg dev_std = 0.590)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:06:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:12 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:28 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:06:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.739
WIoU for r=0.3 = 0.621
F1 for r=0.6 = 0.663
WIoU for r=0.6 = 0.548
F1 for r=0.9 = 0.532
WIoU for r=0.9 = 0.412
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.389


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.479
Model XAI F1 of binarized graphs for r=0.3 =  0.7387025
Model XAI WIoU of binarized graphs for r=0.3 =  0.62087125
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.419
SUFF++ for r=0.3 class 0 = 0.479 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 class 1 = 0.59 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 class 2 = 0.57 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 all KL = 0.579 +- 0.265 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 all L1 = 0.547 +- 0.187 (in-sample avg dev_std = 0.483)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  0.663425
Model XAI WIoU of binarized graphs for r=0.6 =  0.5475037500000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.714
SUFF++ for r=0.6 class 0 = 0.66 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 1 = 0.602 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 2 = 0.717 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all KL = 0.723 +- 0.237 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all L1 = 0.659 +- 0.199 (in-sample avg dev_std = 0.391)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.892
Model XAI F1 of binarized graphs for r=0.9 =  0.5322837499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.41223
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.86
SUFF++ for r=0.9 class 0 = 0.814 +- 0.155 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.817 +- 0.155 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.874 +- 0.155 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.902 +- 0.155 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.835 +- 0.155 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.479
Model XAI F1 of binarized graphs for r=0.3 =  0.7387025
Model XAI WIoU of binarized graphs for r=0.3 =  0.62087125
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.542 +- 0.313 (in-sample avg dev_std = 0.352)
NEC for r=0.3 class 1 = 0.484 +- 0.313 (in-sample avg dev_std = 0.352)
NEC for r=0.3 class 2 = 0.578 +- 0.313 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all KL = 0.49 +- 0.313 (in-sample avg dev_std = 0.352)
NEC for r=0.3 all L1 = 0.535 +- 0.213 (in-sample avg dev_std = 0.352)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.663425
Model XAI WIoU of binarized graphs for r=0.6 =  0.5475037500000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.389
NEC for r=0.6 class 0 = 0.545 +- 0.260 (in-sample avg dev_std = 0.457)
NEC for r=0.6 class 1 = 0.552 +- 0.260 (in-sample avg dev_std = 0.457)
NEC for r=0.6 class 2 = 0.641 +- 0.260 (in-sample avg dev_std = 0.457)
NEC for r=0.6 all KL = 0.57 +- 0.260 (in-sample avg dev_std = 0.457)
NEC for r=0.6 all L1 = 0.579 +- 0.159 (in-sample avg dev_std = 0.457)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.5322837499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.41223
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.468
NEC for r=0.9 class 0 = 0.539 +- 0.238 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 1 = 0.527 +- 0.238 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 2 = 0.58 +- 0.238 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all KL = 0.539 +- 0.238 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all L1 = 0.549 +- 0.164 (in-sample avg dev_std = 0.534)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.38868875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.486
NEC for r=1.0 class 0 = 0.534 +- 0.243 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 1 = 0.524 +- 0.243 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 2 = 0.583 +- 0.243 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all KL = 0.563 +- 0.243 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all L1 = 0.547 +- 0.169 (in-sample avg dev_std = 0.565)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:07:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:07:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:08 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:08:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.737
WIoU for r=0.3 = 0.622
F1 for r=0.6 = 0.648
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.528
WIoU for r=0.9 = 0.407
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.387


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.517
Model XAI F1 of binarized graphs for r=0.3 =  0.73677875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6218787499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.403
SUFF++ for r=0.3 class 0 = 0.504 +- 0.252 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 1 = 0.589 +- 0.252 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 2 = 0.555 +- 0.252 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 all KL = 0.601 +- 0.252 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 all L1 = 0.55 +- 0.152 (in-sample avg dev_std = 0.429)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  0.6481325
Model XAI WIoU of binarized graphs for r=0.6 =  0.5303925
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.673
SUFF++ for r=0.6 class 0 = 0.605 +- 0.231 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 1 = 0.595 +- 0.231 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 2 = 0.704 +- 0.231 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all KL = 0.693 +- 0.231 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all L1 = 0.635 +- 0.190 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.52823625
Model XAI WIoU of binarized graphs for r=0.9 =  0.40669875000000005
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0 = 0.815 +- 0.163 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1 = 0.833 +- 0.163 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 2 = 0.873 +- 0.163 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.9 +- 0.163 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.161 (in-sample avg dev_std = 0.219)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.517
Model XAI F1 of binarized graphs for r=0.3 =  0.73677875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6218787499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.308
NEC for r=0.3 class 0 = 0.57 +- 0.318 (in-sample avg dev_std = 0.299)
NEC for r=0.3 class 1 = 0.455 +- 0.318 (in-sample avg dev_std = 0.299)
NEC for r=0.3 class 2 = 0.564 +- 0.318 (in-sample avg dev_std = 0.299)
NEC for r=0.3 all KL = 0.485 +- 0.318 (in-sample avg dev_std = 0.299)
NEC for r=0.3 all L1 = 0.529 +- 0.195 (in-sample avg dev_std = 0.299)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.6481325
Model XAI WIoU of binarized graphs for r=0.6 =  0.5303925
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.39
NEC for r=0.6 class 0 = 0.609 +- 0.257 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.524 +- 0.257 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.629 +- 0.257 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.589 +- 0.257 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.587 +- 0.146 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.52823625
Model XAI WIoU of binarized graphs for r=0.9 =  0.40669875000000005
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.471
NEC for r=0.9 class 0 = 0.583 +- 0.236 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 1 = 0.511 +- 0.236 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 2 = 0.585 +- 0.236 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all KL = 0.564 +- 0.236 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all L1 = 0.559 +- 0.157 (in-sample avg dev_std = 0.525)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.38702125000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.492
NEC for r=1.0 class 0 = 0.582 +- 0.252 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 1 = 0.505 +- 0.252 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 2 = 0.591 +- 0.252 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all KL = 0.606 +- 0.252 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all L1 = 0.559 +- 0.168 (in-sample avg dev_std = 0.578)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:09:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:37 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:09:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.3 = 0.727
WIoU for r=0.3 = 0.612
F1 for r=0.6 = 0.653
WIoU for r=0.6 = 0.537
F1 for r=0.9 = 0.530
WIoU for r=0.9 = 0.408
F1 for r=1.0 = 0.506
WIoU for r=1.0 = 0.387


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.514
Model XAI F1 of binarized graphs for r=0.3 =  0.727355
Model XAI WIoU of binarized graphs for r=0.3 =  0.6115462500000001
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.423
SUFF++ for r=0.3 class 0 = 0.468 +- 0.274 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 class 1 = 0.529 +- 0.274 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 class 2 = 0.526 +- 0.274 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 all KL = 0.514 +- 0.274 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 all L1 = 0.508 +- 0.165 (in-sample avg dev_std = 0.537)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.735
Model XAI F1 of binarized graphs for r=0.6 =  0.65342
Model XAI WIoU of binarized graphs for r=0.6 =  0.53660375
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.664
SUFF++ for r=0.6 class 0 = 0.59 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 1 = 0.538 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 2 = 0.738 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all KL = 0.628 +- 0.288 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all L1 = 0.622 +- 0.234 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.52957875
Model XAI WIoU of binarized graphs for r=0.9 =  0.40780125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.811 +- 0.159 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.159 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 2 = 0.902 +- 0.159 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all KL = 0.9 +- 0.159 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.157 (in-sample avg dev_std = 0.215)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.514
Model XAI F1 of binarized graphs for r=0.3 =  0.727355
Model XAI WIoU of binarized graphs for r=0.3 =  0.6115462500000001
len(reference) = 800
Effective ratio: 0.314 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.595 +- 0.324 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 1 = 0.518 +- 0.324 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 2 = 0.609 +- 0.324 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all KL = 0.555 +- 0.324 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all L1 = 0.574 +- 0.205 (in-sample avg dev_std = 0.378)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.735
Model XAI F1 of binarized graphs for r=0.6 =  0.65342
Model XAI WIoU of binarized graphs for r=0.6 =  0.53660375
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.587 +- 0.279 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 1 = 0.553 +- 0.279 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 2 = 0.624 +- 0.279 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all KL = 0.638 +- 0.279 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all L1 = 0.588 +- 0.180 (in-sample avg dev_std = 0.496)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.876
Model XAI F1 of binarized graphs for r=0.9 =  0.52957875
Model XAI WIoU of binarized graphs for r=0.9 =  0.40780125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.472
NEC for r=0.9 class 0 = 0.567 +- 0.246 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 1 = 0.524 +- 0.246 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 2 = 0.578 +- 0.246 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all KL = 0.589 +- 0.246 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all L1 = 0.556 +- 0.162 (in-sample avg dev_std = 0.573)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.50582625
Model XAI WIoU of binarized graphs for r=1.0 =  0.38658374999999995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.502
NEC for r=1.0 class 0 = 0.569 +- 0.252 (in-sample avg dev_std = 0.605)
NEC for r=1.0 class 1 = 0.491 +- 0.252 (in-sample avg dev_std = 0.605)
NEC for r=1.0 class 2 = 0.596 +- 0.252 (in-sample avg dev_std = 0.605)
NEC for r=1.0 all KL = 0.607 +- 0.252 (in-sample avg dev_std = 0.605)
NEC for r=1.0 all L1 = 0.552 +- 0.171 (in-sample avg dev_std = 0.605)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.535, 0.672, 0.901, 1.0], 'all_L1': [0.532, 0.657, 0.857, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.591, 0.688, 0.879, 1.0], 'all_L1': [0.559, 0.64, 0.81, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.723, 0.902, 1.0], 'all_L1': [0.547, 0.659, 0.835, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.601, 0.693, 0.9, 1.0], 'all_L1': [0.55, 0.635, 0.84, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.514, 0.628, 0.9, 1.0], 'all_L1': [0.508, 0.622, 0.844, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.522, 0.655, 0.619, 0.628], 'all_L1': [0.547, 0.609, 0.571, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.477, 0.581, 0.551, 0.578], 'all_L1': [0.523, 0.585, 0.547, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.49, 0.57, 0.539, 0.563], 'all_L1': [0.535, 0.579, 0.549, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.485, 0.589, 0.564, 0.606], 'all_L1': [0.529, 0.587, 0.559, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.638, 0.589, 0.607], 'all_L1': [0.574, 0.588, 0.556, 0.552]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.539 +- 0.018, 0.643 +- 0.014, 0.837 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.564 +- 0.034, 0.681 +- 0.031, 0.896 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.420 +- 0.011, 0.689 +- 0.020, 0.855 +- 0.011
nec class all_L1  =  0.542 +- 0.018, 0.590 +- 0.010, 0.556 +- 0.009, 0.552 +- 0.004
nec class all_KL  =  0.506 +- 0.029, 0.607 +- 0.034, 0.572 +- 0.029, 0.596 +- 0.023
nec_acc_int  =  0.324 +- 0.008, 0.387 +- 0.003, 0.473 +- 0.004, 0.497 +- 0.007


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.540 +- 0.001, 0.616 +- 0.010, 0.697 +- 0.012, 0.776 +- 0.002
Faith. Armon (L1)= 		  =  0.540 +- 0.001, 0.615 +- 0.009, 0.668 +- 0.011, 0.711 +- 0.004
Faith. GMean (L1)= 	  =  0.540 +- 0.001, 0.615 +- 0.009, 0.683 +- 0.011, 0.743 +- 0.003
Faith. Aritm (KL)= 		  =  0.535 +- 0.005, 0.644 +- 0.011, 0.734 +- 0.016, 0.798 +- 0.012
Faith. Armon (KL)= 		  =  0.532 +- 0.003, 0.640 +- 0.012, 0.698 +- 0.022, 0.747 +- 0.018
Faith. GMean (KL)= 	  =  0.533 +- 0.004, 0.642 +- 0.011, 0.716 +- 0.019, 0.772 +- 0.015
Computed for split load_split = id



Completed in  0:08:04.949711  for GSATGIN GOODMotif/size



DONE GSAT GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:11:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:26 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:11:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.8 = 0.531
WIoU for r=0.8 = 0.550


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.887
Model XAI F1 of binarized graphs for r=0.8 =  0.53135625
Model XAI WIoU of binarized graphs for r=0.8 =  0.54966875
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.7
SUFF++ for r=0.8 class 0 = 0.564 +- 0.375 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.8 class 1 = 0.722 +- 0.375 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.8 class 2 = 0.771 +- 0.375 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.8 all KL = 0.625 +- 0.375 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.8 all L1 = 0.687 +- 0.280 (in-sample avg dev_std = 0.489)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.887
Model XAI F1 of binarized graphs for r=0.8 =  0.53135625
Model XAI WIoU of binarized graphs for r=0.8 =  0.54966875
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.441
NEC for r=0.8 class 0 = 0.595 +- 0.263 (in-sample avg dev_std = 0.674)
NEC for r=0.8 class 1 = 0.584 +- 0.263 (in-sample avg dev_std = 0.674)
NEC for r=0.8 class 2 = 0.615 +- 0.263 (in-sample avg dev_std = 0.674)
NEC for r=0.8 all KL = 0.75 +- 0.263 (in-sample avg dev_std = 0.674)
NEC for r=0.8 all L1 = 0.598 +- 0.183 (in-sample avg dev_std = 0.674)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:12:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:28 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:12:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.8 = 0.518
WIoU for r=0.8 = 0.525


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.875
Model XAI F1 of binarized graphs for r=0.8 =  0.5183450000000001
Model XAI WIoU of binarized graphs for r=0.8 =  0.5249675
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.672
SUFF++ for r=0.8 class 0 = 0.541 +- 0.385 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.8 class 1 = 0.697 +- 0.385 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.8 class 2 = 0.762 +- 0.385 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.8 all KL = 0.599 +- 0.385 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.8 all L1 = 0.667 +- 0.291 (in-sample avg dev_std = 0.460)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.875
Model XAI F1 of binarized graphs for r=0.8 =  0.5183450000000001
Model XAI WIoU of binarized graphs for r=0.8 =  0.5249675
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.448
NEC for r=0.8 class 0 = 0.601 +- 0.248 (in-sample avg dev_std = 0.686)
NEC for r=0.8 class 1 = 0.582 +- 0.248 (in-sample avg dev_std = 0.686)
NEC for r=0.8 class 2 = 0.606 +- 0.248 (in-sample avg dev_std = 0.686)
NEC for r=0.8 all KL = 0.759 +- 0.248 (in-sample avg dev_std = 0.686)
NEC for r=0.8 all L1 = 0.596 +- 0.172 (in-sample avg dev_std = 0.686)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:13:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.8 = 0.530
WIoU for r=0.8 = 0.533


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.887
Model XAI F1 of binarized graphs for r=0.8 =  0.5304725
Model XAI WIoU of binarized graphs for r=0.8 =  0.5327975
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF++ for r=0.8 class 0 = 0.569 +- 0.374 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.8 class 1 = 0.753 +- 0.374 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.8 class 2 = 0.799 +- 0.374 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.8 all KL = 0.64 +- 0.374 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.8 all L1 = 0.708 +- 0.290 (in-sample avg dev_std = 0.447)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.887
Model XAI F1 of binarized graphs for r=0.8 =  0.5304725
Model XAI WIoU of binarized graphs for r=0.8 =  0.5327975
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.452
NEC for r=0.8 class 0 = 0.598 +- 0.251 (in-sample avg dev_std = 0.709)
NEC for r=0.8 class 1 = 0.597 +- 0.251 (in-sample avg dev_std = 0.709)
NEC for r=0.8 class 2 = 0.609 +- 0.251 (in-sample avg dev_std = 0.709)
NEC for r=0.8 all KL = 0.788 +- 0.251 (in-sample avg dev_std = 0.709)
NEC for r=0.8 all L1 = 0.601 +- 0.191 (in-sample avg dev_std = 0.709)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:13:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:13:52 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:07 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:09 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.8 = 0.554
WIoU for r=0.8 = 0.591


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.859
Model XAI F1 of binarized graphs for r=0.8 =  0.55370125
Model XAI WIoU of binarized graphs for r=0.8 =  0.59143
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.733
SUFF++ for r=0.8 class 0 = 0.692 +- 0.301 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.8 class 1 = 0.583 +- 0.301 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.8 class 2 = 0.876 +- 0.301 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.8 all KL = 0.712 +- 0.301 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.8 all L1 = 0.717 +- 0.249 (in-sample avg dev_std = 0.389)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.859
Model XAI F1 of binarized graphs for r=0.8 =  0.55370125
Model XAI WIoU of binarized graphs for r=0.8 =  0.59143
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.424
NEC for r=0.8 class 0 = 0.617 +- 0.259 (in-sample avg dev_std = 0.620)
NEC for r=0.8 class 1 = 0.58 +- 0.259 (in-sample avg dev_std = 0.620)
NEC for r=0.8 class 2 = 0.604 +- 0.259 (in-sample avg dev_std = 0.620)
NEC for r=0.8 all KL = 0.701 +- 0.259 (in-sample avg dev_std = 0.620)
NEC for r=0.8 all L1 = 0.6 +- 0.163 (in-sample avg dev_std = 0.620)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:14:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:55 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:14:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
Label distribution from train: (tensor([0, 1, 2]), tensor([5912, 6084, 6004]))

Gold ratio (train) =  tensor(0.3628) +- tensor(0.1901)
F1 for r=0.8 = 0.571
WIoU for r=0.8 = 0.721


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.842
Model XAI F1 of binarized graphs for r=0.8 =  0.57102125
Model XAI WIoU of binarized graphs for r=0.8 =  0.7211875000000001
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.772
SUFF++ for r=0.8 class 0 = 0.763 +- 0.226 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.8 class 1 = 0.738 +- 0.226 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.8 class 2 = 0.842 +- 0.226 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.8 all KL = 0.834 +- 0.226 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.8 all L1 = 0.781 +- 0.207 (in-sample avg dev_std = 0.304)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.842
Model XAI F1 of binarized graphs for r=0.8 =  0.57102125
Model XAI WIoU of binarized graphs for r=0.8 =  0.7211875000000001
len(reference) = 800
Effective ratio: 0.813 +- 0.012
Model Accuracy over intervened graphs for r=0.8 =  0.451
NEC for r=0.8 class 0 = 0.647 +- 0.327 (in-sample avg dev_std = 0.530)
NEC for r=0.8 class 1 = 0.387 +- 0.327 (in-sample avg dev_std = 0.530)
NEC for r=0.8 class 2 = 0.613 +- 0.327 (in-sample avg dev_std = 0.530)
NEC for r=0.8 all KL = 0.592 +- 0.327 (in-sample avg dev_std = 0.530)
NEC for r=0.8 all L1 = 0.548 +- 0.231 (in-sample avg dev_std = 0.530)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.625], 'all_L1': [0.687]}), defaultdict(<class 'list'>, {'all_KL': [0.599], 'all_L1': [0.667]}), defaultdict(<class 'list'>, {'all_KL': [0.64], 'all_L1': [0.708]}), defaultdict(<class 'list'>, {'all_KL': [0.712], 'all_L1': [0.717]}), defaultdict(<class 'list'>, {'all_KL': [0.834], 'all_L1': [0.781]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.75], 'all_L1': [0.598]}), defaultdict(<class 'list'>, {'all_KL': [0.759], 'all_L1': [0.596]}), defaultdict(<class 'list'>, {'all_KL': [0.788], 'all_L1': [0.601]}), defaultdict(<class 'list'>, {'all_KL': [0.701], 'all_L1': [0.6]}), defaultdict(<class 'list'>, {'all_KL': [0.592], 'all_L1': [0.548]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.712 +- 0.039
suff++ class all_KL  =  0.682 +- 0.085
suff++_acc_int  =  0.715 +- 0.034
nec class all_L1  =  0.589 +- 0.020
nec class all_KL  =  0.718 +- 0.069
nec_acc_int  =  0.443 +- 0.010


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.650 +- 0.012
Faith. Armon (L1)= 		  =  0.643 +- 0.008
Faith. GMean (L1)= 	  =  0.647 +- 0.010
Faith. Aritm (KL)= 		  =  0.700 +- 0.014
Faith. Armon (KL)= 		  =  0.691 +- 0.014
Faith. GMean (KL)= 	  =  0.696 +- 0.014
Computed for split load_split = id



Completed in  0:04:01.265925  for CIGAGIN GOODMotif/size



DONE CIGA GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:15:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:15:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0025
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.5101
ID Test ACCURACY: 0.8987
ID Test Loss: 0.6337
OOD Validation ACCURACY: 0.8501
OOD Validation Loss: 1.2162
OOD Test ACCURACY: 0.7241
OOD Test Loss: 5.9794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0210
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3950
ID Test ACCURACY: 0.8921
ID Test Loss: 0.4835
OOD Validation ACCURACY: 0.8680
OOD Validation Loss: 0.6745
OOD Test ACCURACY: 0.7971
OOD Test Loss: 1.9556

[0m[1;37mINFO[0m: [1mChartInfo 0.8987 0.7241 0.8921 0.7971 0.9013 0.8680[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:15:57 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.963
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.85
SUFF++ for r=0.6 class 0.0 = 0.597 +- 0.337 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 1.0 = 0.961 +- 0.337 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 all KL = 0.689 +- 0.337 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 all L1 = 0.805 +- 0.221 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.997
SUFF++ for r=0.9 class 0.0 = 0.986 +- 0.099 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 class 1.0 = 0.991 +- 0.099 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 all KL = 0.984 +- 0.099 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 all L1 = 0.989 +- 0.064 (in-sample avg dev_std = 0.050)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.963
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.946
NEC for r=0.6 class 0.0 = 0.161 +- 0.168 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 1.0 = 0.011 +- 0.168 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all KL = 0.067 +- 0.168 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all L1 = 0.076 +- 0.163 (in-sample avg dev_std = 0.153)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.997
NEC for r=0.9 class 0.0 = 0.013 +- 0.106 (in-sample avg dev_std = 0.064)
NEC for r=0.9 class 1.0 = 0.01 +- 0.106 (in-sample avg dev_std = 0.064)
NEC for r=0.9 all KL = 0.019 +- 0.106 (in-sample avg dev_std = 0.064)
NEC for r=0.9 all L1 = 0.011 +- 0.059 (in-sample avg dev_std = 0.064)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.997
NEC for r=1.0 class 0.0 = 0.013 +- 0.110 (in-sample avg dev_std = 0.064)
NEC for r=1.0 class 1.0 = 0.01 +- 0.110 (in-sample avg dev_std = 0.064)
NEC for r=1.0 all KL = 0.02 +- 0.110 (in-sample avg dev_std = 0.064)
NEC for r=1.0 all L1 = 0.011 +- 0.059 (in-sample avg dev_std = 0.064)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:16:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.7707
ID Test ACCURACY: 0.9036
ID Test Loss: 0.8911
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.9645
OOD Test ACCURACY: 0.8288
OOD Test Loss: 1.5437

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9087
ID Validation Loss: 0.6769
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.8751
OOD Validation Loss: 0.7905
OOD Test ACCURACY: 0.8313
OOD Test Loss: 1.1097

[0m[1;37mINFO[0m: [1mChartInfo 0.9036 0.8288 0.9010 0.8313 0.9087 0.8751[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:16:15 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.887
SUFF++ for r=0.6 class 0.0 = 0.692 +- 0.424 (in-sample avg dev_std = 0.538)
SUFF++ for r=0.6 class 1.0 = 0.924 +- 0.424 (in-sample avg dev_std = 0.538)
SUFF++ for r=0.6 all KL = 0.557 +- 0.424 (in-sample avg dev_std = 0.538)
SUFF++ for r=0.6 all L1 = 0.825 +- 0.204 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF++ for r=0.9 class 0.0 = 1.0 +- 0.016 (in-sample avg dev_std = 0.002)
SUFF++ for r=0.9 class 1.0 = 1.0 +- 0.016 (in-sample avg dev_std = 0.002)
SUFF++ for r=0.9 all KL = 0.999 +- 0.016 (in-sample avg dev_std = 0.002)
SUFF++ for r=0.9 all L1 = 1.0 +- 0.002 (in-sample avg dev_std = 0.002)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.972
NEC for r=0.6 class 0.0 = 0.082 +- 0.217 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 1.0 = 0.008 +- 0.217 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all KL = 0.065 +- 0.217 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all L1 = 0.04 +- 0.140 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 0.0 = 0.001 +- 0.034 (in-sample avg dev_std = 0.004)
NEC for r=0.9 class 1.0 = 0.0 +- 0.034 (in-sample avg dev_std = 0.004)
NEC for r=0.9 all KL = 0.003 +- 0.034 (in-sample avg dev_std = 0.004)
NEC for r=0.9 all L1 = 0.001 +- 0.007 (in-sample avg dev_std = 0.004)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  1.0
NEC for r=1.0 class 0.0 = 0.001 +- 0.034 (in-sample avg dev_std = 0.004)
NEC for r=1.0 class 1.0 = 0.0 +- 0.034 (in-sample avg dev_std = 0.004)
NEC for r=1.0 all KL = 0.003 +- 0.034 (in-sample avg dev_std = 0.004)
NEC for r=1.0 all L1 = 0.001 +- 0.007 (in-sample avg dev_std = 0.004)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:16:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mChartInfo 0.9085 0.8129 0.9085 0.8129 0.9070 0.8698[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:16:31 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.919
SUFF++ for r=0.6 class 0.0 = 0.99 +- 0.388 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 1.0 = 0.793 +- 0.388 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all KL = 0.687 +- 0.388 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all L1 = 0.878 +- 0.172 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
SUFF++ for r=0.9 class 0.0 = 0.992 +- 0.112 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 1.0 = 0.99 +- 0.112 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all KL = 0.984 +- 0.112 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all L1 = 0.991 +- 0.069 (in-sample avg dev_std = 0.070)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.973
NEC for r=0.6 class 0.0 = 0.001 +- 0.177 (in-sample avg dev_std = 0.148)
NEC for r=0.6 class 1.0 = 0.058 +- 0.177 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all KL = 0.048 +- 0.177 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all L1 = 0.034 +- 0.123 (in-sample avg dev_std = 0.148)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.997
NEC for r=0.9 class 0.0 = 0.003 +- 0.082 (in-sample avg dev_std = 0.052)
NEC for r=0.9 class 1.0 = 0.009 +- 0.082 (in-sample avg dev_std = 0.052)
NEC for r=0.9 all KL = 0.011 +- 0.082 (in-sample avg dev_std = 0.052)
NEC for r=0.9 all L1 = 0.007 +- 0.057 (in-sample avg dev_std = 0.052)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.997
NEC for r=1.0 class 0.0 = 0.003 +- 0.079 (in-sample avg dev_std = 0.050)
NEC for r=1.0 class 1.0 = 0.009 +- 0.079 (in-sample avg dev_std = 0.050)
NEC for r=1.0 all KL = 0.01 +- 0.079 (in-sample avg dev_std = 0.050)
NEC for r=1.0 all L1 = 0.006 +- 0.056 (in-sample avg dev_std = 0.050)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:16:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:16:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0001
ID Validation ACCURACY: 0.9147
ID Validation Loss: 0.6881
ID Test ACCURACY: 0.9072
ID Test Loss: 0.8292
OOD Validation ACCURACY: 0.8620
OOD Validation Loss: 1.4572
OOD Test ACCURACY: 0.8092
OOD Test Loss: 3.9476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9128
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9068
ID Test Loss: 0.8946
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 1.4169
OOD Test ACCURACY: 0.8193
OOD Test Loss: 3.6034

[0m[1;37mINFO[0m: [1mChartInfo 0.9072 0.8092 0.9068 0.8193 0.9128 0.8693[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:16:47 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.888
SUFF++ for r=0.6 class 0.0 = 0.671 +- 0.423 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 class 1.0 = 0.98 +- 0.423 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 all KL = 0.654 +- 0.423 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 all L1 = 0.848 +- 0.213 (in-sample avg dev_std = 0.509)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0.0 = 0.998 +- 0.077 (in-sample avg dev_std = 0.028)
SUFF++ for r=0.9 class 1.0 = 0.993 +- 0.077 (in-sample avg dev_std = 0.028)
SUFF++ for r=0.9 all KL = 0.992 +- 0.077 (in-sample avg dev_std = 0.028)
SUFF++ for r=0.9 all L1 = 0.995 +- 0.055 (in-sample avg dev_std = 0.028)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.978
NEC for r=0.6 class 0.0 = 0.08 +- 0.206 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 1.0 = 0.002 +- 0.206 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all KL = 0.054 +- 0.206 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all L1 = 0.035 +- 0.137 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.998
NEC for r=0.9 class 0.0 = 0.008 +- 0.091 (in-sample avg dev_std = 0.042)
NEC for r=0.9 class 1.0 = 0.004 +- 0.091 (in-sample avg dev_std = 0.042)
NEC for r=0.9 all KL = 0.012 +- 0.091 (in-sample avg dev_std = 0.042)
NEC for r=0.9 all L1 = 0.006 +- 0.051 (in-sample avg dev_std = 0.042)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.998
NEC for r=1.0 class 0.0 = 0.008 +- 0.092 (in-sample avg dev_std = 0.049)
NEC for r=1.0 class 1.0 = 0.004 +- 0.092 (in-sample avg dev_std = 0.049)
NEC for r=1.0 all KL = 0.011 +- 0.092 (in-sample avg dev_std = 0.049)
NEC for r=1.0 all L1 = 0.006 +- 0.051 (in-sample avg dev_std = 0.049)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:17:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.7434
ID Test ACCURACY: 0.9083
ID Test Loss: 0.7942
OOD Validation ACCURACY: 0.8622
OOD Validation Loss: 1.0214
OOD Test ACCURACY: 0.7831
OOD Test Loss: 1.9072

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9062
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9059
ID Test Loss: 0.8164
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 0.9364
OOD Test ACCURACY: 0.8087
OOD Test Loss: 1.4925

[0m[1;37mINFO[0m: [1mChartInfo 0.9083 0.7831 0.9059 0.8087 0.9062 0.8689[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:17:04 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.941
SUFF++ for r=0.6 class 0.0 = 0.807 +- 0.374 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 1.0 = 0.975 +- 0.374 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all KL = 0.73 +- 0.374 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all L1 = 0.903 +- 0.157 (in-sample avg dev_std = 0.401)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.999
SUFF++ for r=0.9 class 0.0 = 0.992 +- 0.111 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 class 1.0 = 0.997 +- 0.111 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 all KL = 0.983 +- 0.111 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 all L1 = 0.995 +- 0.037 (in-sample avg dev_std = 0.069)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.988
NEC for r=0.6 class 0.0 = 0.059 +- 0.183 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 1.0 = 0.001 +- 0.183 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all KL = 0.042 +- 0.183 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all L1 = 0.026 +- 0.116 (in-sample avg dev_std = 0.153)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 0.0 = 0.006 +- 0.102 (in-sample avg dev_std = 0.047)
NEC for r=0.9 class 1.0 = 0.003 +- 0.102 (in-sample avg dev_std = 0.047)
NEC for r=0.9 all KL = 0.015 +- 0.102 (in-sample avg dev_std = 0.047)
NEC for r=0.9 all L1 = 0.005 +- 0.034 (in-sample avg dev_std = 0.047)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  1.0
NEC for r=1.0 class 0.0 = 0.006 +- 0.099 (in-sample avg dev_std = 0.047)
NEC for r=1.0 class 1.0 = 0.003 +- 0.099 (in-sample avg dev_std = 0.047)
NEC for r=1.0 all KL = 0.014 +- 0.099 (in-sample avg dev_std = 0.047)
NEC for r=1.0 all L1 = 0.004 +- 0.033 (in-sample avg dev_std = 0.047)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.689, 0.984, 1.0], 'all_L1': [0.805, 0.989, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.999, 1.0], 'all_L1': [0.825, 1.0, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.687, 0.984, 1.0], 'all_L1': [0.878, 0.991, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.992, 1.0], 'all_L1': [0.848, 0.995, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.73, 0.983, 1.0], 'all_L1': [0.903, 0.995, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.067, 0.019, 0.02], 'all_L1': [0.076, 0.011, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.065, 0.003, 0.003], 'all_L1': [0.04, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.048, 0.011, 0.01], 'all_L1': [0.034, 0.007, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.012, 0.011], 'all_L1': [0.035, 0.006, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.015, 0.014], 'all_L1': [0.026, 0.005, 0.004]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.852 +- 0.035, 0.994 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.663 +- 0.058, 0.988 +- 0.006, 1.000 +- 0.000
suff++_acc_int  =  0.897 +- 0.031, 0.997 +- 0.002
nec class all_L1  =  0.042 +- 0.017, 0.006 +- 0.003, 0.006 +- 0.003
nec class all_KL  =  0.055 +- 0.010, 0.012 +- 0.005, 0.012 +- 0.006
nec_acc_int  =  0.972 +- 0.014, 0.998 +- 0.001, 0.998 +- 0.001


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.447 +- 0.012, 0.500 +- 0.001, 0.503 +- 0.002
Faith. Armon (L1)= 		  =  0.080 +- 0.031, 0.012 +- 0.006, 0.011 +- 0.006
Faith. GMean (L1)= 	  =  0.185 +- 0.032, 0.073 +- 0.024, 0.071 +- 0.024
Faith. Aritm (KL)= 		  =  0.359 +- 0.026, 0.500 +- 0.002, 0.506 +- 0.003
Faith. Armon (KL)= 		  =  0.101 +- 0.016, 0.024 +- 0.010, 0.023 +- 0.011
Faith. GMean (KL)= 	  =  0.190 +- 0.014, 0.105 +- 0.028, 0.104 +- 0.028
Computed for split load_split = id



Completed in  0:01:25.700158  for GSATvGIN GOODSST2/length



DONE GSAT GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:17:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:17:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9479
Train Loss: 0.0807
ID Validation ACCURACY: 0.8570
ID Validation Loss: 0.6526
ID Test ACCURACY: 0.8504
ID Test Loss: 0.7123
OOD Validation ACCURACY: 0.8377
OOD Validation Loss: 0.8949
OOD Test ACCURACY: 0.7398
OOD Test Loss: 1.5170

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 71...
[0m[1;37mINFO[0m: [1mCheckpoint 71: 
-----------------------------------
Train ACCURACY: 0.9165
Train Loss: 0.1472
ID Validation ACCURACY: 0.8142
ID Validation Loss: 0.7736
ID Test ACCURACY: 0.8114
ID Test Loss: 0.8563
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7952
OOD Test ACCURACY: 0.8108
OOD Test Loss: 0.9714

[0m[1;37mINFO[0m: [1mChartInfo 0.8504 0.7398 0.8114 0.8108 0.8142 0.8439[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:17:51 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.957
SUFF++ for r=0.8 class 0.0 = 0.838 +- 0.256 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.8 class 1.0 = 0.989 +- 0.256 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.8 all KL = 0.841 +- 0.256 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.8 all L1 = 0.924 +- 0.137 (in-sample avg dev_std = 0.292)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.98
NEC for r=0.8 class 0.0 = 0.073 +- 0.163 (in-sample avg dev_std = 0.122)
NEC for r=0.8 class 1.0 = 0.012 +- 0.163 (in-sample avg dev_std = 0.122)
NEC for r=0.8 all KL = 0.054 +- 0.163 (in-sample avg dev_std = 0.122)
NEC for r=0.8 all L1 = 0.038 +- 0.121 (in-sample avg dev_std = 0.122)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:17:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0768
ID Validation ACCURACY: 0.8587
ID Validation Loss: 0.7200
ID Test ACCURACY: 0.8551
ID Test Loss: 0.8849
OOD Validation ACCURACY: 0.8472
OOD Validation Loss: 1.0741
OOD Test ACCURACY: 0.7967
OOD Test Loss: 1.3148

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0760
ID Validation ACCURACY: 0.8581
ID Validation Loss: 0.7569
ID Test ACCURACY: 0.8551
ID Test Loss: 0.9395
OOD Validation ACCURACY: 0.8551
OOD Validation Loss: 1.0513
OOD Test ACCURACY: 0.8051
OOD Test Loss: 1.2667

[0m[1;37mINFO[0m: [1mChartInfo 0.8551 0.7967 0.8551 0.8051 0.8581 0.8551[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:18:01 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.955
SUFF++ for r=0.8 class 0.0 = 0.999 +- 0.248 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.8 class 1.0 = 0.87 +- 0.248 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.8 all KL = 0.857 +- 0.248 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.8 all L1 = 0.925 +- 0.148 (in-sample avg dev_std = 0.267)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 0.0 = 0.0 +- 0.196 (in-sample avg dev_std = 0.176)
NEC for r=0.8 class 1.0 = 0.086 +- 0.196 (in-sample avg dev_std = 0.176)
NEC for r=0.8 all KL = 0.073 +- 0.196 (in-sample avg dev_std = 0.176)
NEC for r=0.8 all L1 = 0.049 +- 0.137 (in-sample avg dev_std = 0.176)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:18:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.9479
Train Loss: 0.0798
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.6948
ID Test ACCURACY: 0.8576
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.8474
OOD Validation Loss: 1.0437
OOD Test ACCURACY: 0.8045
OOD Test Loss: 1.1397

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9461
Train Loss: 0.0840
ID Validation ACCURACY: 0.8459
ID Validation Loss: 0.7816
ID Test ACCURACY: 0.8498
ID Test Loss: 0.8524
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.9137
OOD Test ACCURACY: 0.8097
OOD Test Loss: 1.0383

[0m[1;37mINFO[0m: [1mChartInfo 0.8576 0.8045 0.8498 0.8097 0.8459 0.8581[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:18:10 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF++ for r=0.8 class 0.0 = 0.992 +- 0.249 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.8 class 1.0 = 0.898 +- 0.249 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.8 all KL = 0.852 +- 0.249 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.8 all L1 = 0.938 +- 0.119 (in-sample avg dev_std = 0.256)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.979
NEC for r=0.8 class 0.0 = 0.003 +- 0.193 (in-sample avg dev_std = 0.147)
NEC for r=0.8 class 1.0 = 0.065 +- 0.193 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all KL = 0.064 +- 0.193 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all L1 = 0.038 +- 0.122 (in-sample avg dev_std = 0.147)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:18:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.9483
Train Loss: 0.0792
ID Validation ACCURACY: 0.8604
ID Validation Loss: 0.6685
ID Test ACCURACY: 0.8570
ID Test Loss: 0.7609
OOD Validation ACCURACY: 0.8537
OOD Validation Loss: 0.9443
OOD Test ACCURACY: 0.8069
OOD Test Loss: 1.0629

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9462
Train Loss: 0.0915
ID Validation ACCURACY: 0.8478
ID Validation Loss: 0.6421
ID Test ACCURACY: 0.8480
ID Test Loss: 0.7499
OOD Validation ACCURACY: 0.8555
OOD Validation Loss: 0.7389
OOD Test ACCURACY: 0.8109
OOD Test Loss: 0.7657

[0m[1;37mINFO[0m: [1mChartInfo 0.8570 0.8069 0.8480 0.8109 0.8478 0.8555[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:18:21 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.977
SUFF++ for r=0.8 class 0.0 = 0.991 +- 0.188 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.8 class 1.0 = 0.909 +- 0.188 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.8 all KL = 0.904 +- 0.188 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.8 all L1 = 0.944 +- 0.108 (in-sample avg dev_std = 0.220)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.985
NEC for r=0.8 class 0.0 = 0.005 +- 0.133 (in-sample avg dev_std = 0.103)
NEC for r=0.8 class 1.0 = 0.051 +- 0.133 (in-sample avg dev_std = 0.103)
NEC for r=0.8 all KL = 0.039 +- 0.133 (in-sample avg dev_std = 0.103)
NEC for r=0.8 all L1 = 0.032 +- 0.101 (in-sample avg dev_std = 0.103)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:18:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:18:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9443
Train Loss: 0.0872
ID Validation ACCURACY: 0.8447
ID Validation Loss: 0.7583
ID Test ACCURACY: 0.8393
ID Test Loss: 0.8682
OOD Validation ACCURACY: 0.7661
OOD Validation Loss: 1.6477
OOD Test ACCURACY: 0.6583
OOD Test Loss: 3.1226

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9332
Train Loss: 0.1117
ID Validation ACCURACY: 0.8306
ID Validation Loss: 0.6694
ID Test ACCURACY: 0.8312
ID Test Loss: 0.7076
OOD Validation ACCURACY: 0.8233
OOD Validation Loss: 0.9547
OOD Test ACCURACY: 0.7755
OOD Test Loss: 1.3760

[0m[1;37mINFO[0m: [1mChartInfo 0.8393 0.6583 0.8312 0.7755 0.8306 0.8233[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 04/14/2024 06:18:30 PM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.897
SUFF++ for r=0.8 class 0.0 = 0.687 +- 0.369 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.8 class 1.0 = 0.996 +- 0.369 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.8 all KL = 0.741 +- 0.369 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.8 all L1 = 0.864 +- 0.220 (in-sample avg dev_std = 0.406)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 273
Effective ratio: 0.812 +- 0.287
Model Accuracy over intervened graphs for r=0.8 =  0.946
NEC for r=0.8 class 0.0 = 0.163 +- 0.257 (in-sample avg dev_std = 0.198)
NEC for r=0.8 class 1.0 = 0.002 +- 0.257 (in-sample avg dev_std = 0.198)
NEC for r=0.8 all KL = 0.109 +- 0.257 (in-sample avg dev_std = 0.198)
NEC for r=0.8 all L1 = 0.071 +- 0.182 (in-sample avg dev_std = 0.198)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.841], 'all_L1': [0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.857], 'all_L1': [0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.852], 'all_L1': [0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.904], 'all_L1': [0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.741], 'all_L1': [0.864]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.054], 'all_L1': [0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.073], 'all_L1': [0.049]}), defaultdict(<class 'list'>, {'all_KL': [0.064], 'all_L1': [0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.039], 'all_L1': [0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.109], 'all_L1': [0.071]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.919 +- 0.029
suff++ class all_KL  =  0.839 +- 0.054
suff++_acc_int  =  0.952 +- 0.028
nec class all_L1  =  0.046 +- 0.014
nec class all_KL  =  0.068 +- 0.023
nec_acc_int  =  0.973 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.482 +- 0.008
Faith. Armon (L1)= 		  =  0.086 +- 0.025
Faith. GMean (L1)= 	  =  0.202 +- 0.026
Faith. Aritm (KL)= 		  =  0.453 +- 0.016
Faith. Armon (KL)= 		  =  0.124 +- 0.039
Faith. GMean (KL)= 	  =  0.234 +- 0.033
Computed for split load_split = id



Completed in  0:00:51.807773  for CIGAvGIN GOODSST2/length



DONE CIGA GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:19:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:19:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9965
Train Loss: 0.0177
ID Validation ACCURACY: 0.6931
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.6318
ID Test Loss: 1.8774
OOD Validation ACCURACY: 0.6011
OOD Validation Loss: 2.2998
OOD Test ACCURACY: 0.5319
OOD Test Loss: 3.2275

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.6715
ID Validation Loss: 2.2483
ID Test ACCURACY: 0.6498
ID Test Loss: 2.4645
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 2.6045
OOD Test ACCURACY: 0.5765
OOD Test Loss: 3.1984

[0m[1;37mINFO[0m: [1mChartInfo 0.6318 0.5319 0.6498 0.5765 0.6715 0.6353[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.751
SUFF++ for r=0.3 class 0 = 0.654 +- 0.303 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 1 = 0.834 +- 0.303 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 2 = 0.469 +- 0.303 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all KL = 0.569 +- 0.303 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all L1 = 0.695 +- 0.224 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.971
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.881
SUFF++ for r=0.6 class 0 = 0.856 +- 0.305 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 1 = 0.929 +- 0.305 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 2 = 0.616 +- 0.305 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all KL = 0.728 +- 0.305 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all L1 = 0.829 +- 0.199 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.992
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.983
SUFF++ for r=0.9 class 0 = 0.976 +- 0.109 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 1 = 0.973 +- 0.109 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 2 = 0.965 +- 0.109 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all KL = 0.967 +- 0.109 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all L1 = 0.971 +- 0.084 (in-sample avg dev_std = 0.125)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.851
NEC for r=0.3 class 0 = 0.216 +- 0.235 (in-sample avg dev_std = 0.275)
NEC for r=0.3 class 1 = 0.076 +- 0.235 (in-sample avg dev_std = 0.275)
NEC for r=0.3 class 2 = 0.303 +- 0.235 (in-sample avg dev_std = 0.275)
NEC for r=0.3 all KL = 0.159 +- 0.235 (in-sample avg dev_std = 0.275)
NEC for r=0.3 all L1 = 0.169 +- 0.214 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.971
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.938
NEC for r=0.6 class 0 = 0.09 +- 0.193 (in-sample avg dev_std = 0.212)
NEC for r=0.6 class 1 = 0.041 +- 0.193 (in-sample avg dev_std = 0.212)
NEC for r=0.6 class 2 = 0.179 +- 0.193 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all KL = 0.093 +- 0.193 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all L1 = 0.089 +- 0.163 (in-sample avg dev_std = 0.212)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.992
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.973
NEC for r=0.9 class 0 = 0.04 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 1 = 0.036 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 2 = 0.062 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all KL = 0.057 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all L1 = 0.044 +- 0.116 (in-sample avg dev_std = 0.166)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.996
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.979
NEC for r=1.0 class 0 = 0.031 +- 0.149 (in-sample avg dev_std = 0.144)
NEC for r=1.0 class 1 = 0.035 +- 0.149 (in-sample avg dev_std = 0.144)
NEC for r=1.0 class 2 = 0.044 +- 0.149 (in-sample avg dev_std = 0.144)
NEC for r=1.0 all KL = 0.051 +- 0.149 (in-sample avg dev_std = 0.144)
NEC for r=1.0 all L1 = 0.036 +- 0.102 (in-sample avg dev_std = 0.144)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:20:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:52 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:54 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:55 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:20:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5518 0.6715 0.5518 0.7004 0.6331[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.967
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.754
SUFF++ for r=0.3 class 0 = 0.564 +- 0.303 (in-sample avg dev_std = 0.748)
SUFF++ for r=0.3 class 1 = 0.743 +- 0.303 (in-sample avg dev_std = 0.748)
SUFF++ for r=0.3 class 2 = 0.51 +- 0.303 (in-sample avg dev_std = 0.748)
SUFF++ for r=0.3 all KL = 0.276 +- 0.303 (in-sample avg dev_std = 0.748)
SUFF++ for r=0.3 all L1 = 0.639 +- 0.206 (in-sample avg dev_std = 0.748)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.932
SUFF++ for r=0.6 class 0 = 0.902 +- 0.362 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1 = 0.94 +- 0.362 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 2 = 0.764 +- 0.362 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.703 +- 0.362 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.885 +- 0.165 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0 = 0.981 +- 0.114 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 class 1 = 0.994 +- 0.114 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 class 2 = 0.984 +- 0.114 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 all KL = 0.976 +- 0.114 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 all L1 = 0.988 +- 0.058 (in-sample avg dev_std = 0.100)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.967
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.961
NEC for r=0.3 class 0 = 0.167 +- 0.237 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 1 = 0.028 +- 0.237 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 2 = 0.121 +- 0.237 (in-sample avg dev_std = 0.226)
NEC for r=0.3 all KL = 0.113 +- 0.237 (in-sample avg dev_std = 0.226)
NEC for r=0.3 all L1 = 0.086 +- 0.176 (in-sample avg dev_std = 0.226)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.987
NEC for r=0.6 class 0 = 0.045 +- 0.185 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1 = 0.011 +- 0.185 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 2 = 0.04 +- 0.185 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.057 +- 0.185 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.027 +- 0.089 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.992
NEC for r=0.9 class 0 = 0.031 +- 0.149 (in-sample avg dev_std = 0.123)
NEC for r=0.9 class 1 = 0.006 +- 0.149 (in-sample avg dev_std = 0.123)
NEC for r=0.9 class 2 = 0.026 +- 0.149 (in-sample avg dev_std = 0.123)
NEC for r=0.9 all KL = 0.038 +- 0.149 (in-sample avg dev_std = 0.123)
NEC for r=0.9 all L1 = 0.017 +- 0.073 (in-sample avg dev_std = 0.123)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.99
NEC for r=1.0 class 0 = 0.035 +- 0.151 (in-sample avg dev_std = 0.124)
NEC for r=1.0 class 1 = 0.008 +- 0.151 (in-sample avg dev_std = 0.124)
NEC for r=1.0 class 2 = 0.028 +- 0.151 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all KL = 0.04 +- 0.151 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all L1 = 0.02 +- 0.081 (in-sample avg dev_std = 0.124)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:22:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:32 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:34 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:22:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0031
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.5079
ID Test ACCURACY: 0.6426
ID Test Loss: 1.8561
OOD Validation ACCURACY: 0.6101
OOD Validation Loss: 2.2219
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.4476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ACCURACY: 0.9981
Train Loss: 0.0050
ID Validation ACCURACY: 0.6733
ID Validation Loss: 1.7091
ID Test ACCURACY: 0.6552
ID Test Loss: 1.9976
OOD Validation ACCURACY: 0.6403
OOD Validation Loss: 2.0926
OOD Test ACCURACY: 0.5690
OOD Test Loss: 2.7705

[0m[1;37mINFO[0m: [1mChartInfo 0.6426 0.5333 0.6552 0.5690 0.6733 0.6403[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.951
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.779
SUFF++ for r=0.3 class 0 = 0.852 +- 0.322 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.3 class 1 = 0.709 +- 0.322 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.3 class 2 = 0.509 +- 0.322 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.3 all KL = 0.497 +- 0.322 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.3 all L1 = 0.691 +- 0.211 (in-sample avg dev_std = 0.629)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.919
SUFF++ for r=0.6 class 0 = 0.954 +- 0.302 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 1 = 0.896 +- 0.302 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 2 = 0.754 +- 0.302 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all KL = 0.765 +- 0.302 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all L1 = 0.872 +- 0.173 (in-sample avg dev_std = 0.386)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.99
SUFF++ for r=0.9 class 0 = 0.984 +- 0.139 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 class 1 = 0.981 +- 0.139 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 class 2 = 0.958 +- 0.139 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all KL = 0.964 +- 0.139 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all L1 = 0.976 +- 0.087 (in-sample avg dev_std = 0.141)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.951
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.921
NEC for r=0.3 class 0 = 0.108 +- 0.233 (in-sample avg dev_std = 0.246)
NEC for r=0.3 class 1 = 0.084 +- 0.233 (in-sample avg dev_std = 0.246)
NEC for r=0.3 class 2 = 0.218 +- 0.233 (in-sample avg dev_std = 0.246)
NEC for r=0.3 all KL = 0.136 +- 0.233 (in-sample avg dev_std = 0.246)
NEC for r=0.3 all L1 = 0.125 +- 0.187 (in-sample avg dev_std = 0.246)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.962
NEC for r=0.6 class 0 = 0.035 +- 0.198 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 1 = 0.055 +- 0.198 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 2 = 0.102 +- 0.198 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all KL = 0.085 +- 0.198 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all L1 = 0.063 +- 0.141 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.987
NEC for r=0.9 class 0 = 0.022 +- 0.151 (in-sample avg dev_std = 0.148)
NEC for r=0.9 class 1 = 0.028 +- 0.151 (in-sample avg dev_std = 0.148)
NEC for r=0.9 class 2 = 0.049 +- 0.151 (in-sample avg dev_std = 0.148)
NEC for r=0.9 all KL = 0.05 +- 0.151 (in-sample avg dev_std = 0.148)
NEC for r=0.9 all L1 = 0.032 +- 0.096 (in-sample avg dev_std = 0.148)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.989
NEC for r=1.0 class 0 = 0.026 +- 0.149 (in-sample avg dev_std = 0.135)
NEC for r=1.0 class 1 = 0.027 +- 0.149 (in-sample avg dev_std = 0.135)
NEC for r=1.0 class 2 = 0.036 +- 0.149 (in-sample avg dev_std = 0.135)
NEC for r=1.0 all KL = 0.047 +- 0.149 (in-sample avg dev_std = 0.135)
NEC for r=1.0 all L1 = 0.029 +- 0.091 (in-sample avg dev_std = 0.135)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:24:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:03 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:05 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:24:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0013
ID Validation ACCURACY: 0.7004
ID Validation Loss: 1.8103
ID Test ACCURACY: 0.6444
ID Test Loss: 2.1469
OOD Validation ACCURACY: 0.6280
OOD Validation Loss: 2.2065
OOD Test ACCURACY: 0.5436
OOD Test Loss: 2.9759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.1026
ID Test ACCURACY: 0.6101
ID Test Loss: 2.4334
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6554
OOD Test ACCURACY: 0.5642
OOD Test Loss: 3.4042

[0m[1;37mINFO[0m: [1mChartInfo 0.6444 0.5436 0.6101 0.5642 0.6877 0.6336[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.738
SUFF++ for r=0.3 class 0 = 0.485 +- 0.304 (in-sample avg dev_std = 0.675)
SUFF++ for r=0.3 class 1 = 0.787 +- 0.304 (in-sample avg dev_std = 0.675)
SUFF++ for r=0.3 class 2 = 0.545 +- 0.304 (in-sample avg dev_std = 0.675)
SUFF++ for r=0.3 all KL = 0.384 +- 0.304 (in-sample avg dev_std = 0.675)
SUFF++ for r=0.3 all L1 = 0.651 +- 0.209 (in-sample avg dev_std = 0.675)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.995
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.915
SUFF++ for r=0.6 class 0 = 0.783 +- 0.335 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 1 = 0.916 +- 0.335 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 2 = 0.809 +- 0.335 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all KL = 0.678 +- 0.335 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all L1 = 0.856 +- 0.172 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.993
SUFF++ for r=0.9 class 0 = 0.962 +- 0.130 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.9 class 1 = 0.992 +- 0.130 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.9 class 2 = 0.98 +- 0.130 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.9 all KL = 0.967 +- 0.130 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.9 all L1 = 0.982 +- 0.069 (in-sample avg dev_std = 0.119)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.906
NEC for r=0.3 class 0 = 0.314 +- 0.247 (in-sample avg dev_std = 0.265)
NEC for r=0.3 class 1 = 0.02 +- 0.247 (in-sample avg dev_std = 0.265)
NEC for r=0.3 class 2 = 0.188 +- 0.247 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.147 +- 0.247 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.135 +- 0.207 (in-sample avg dev_std = 0.265)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.995
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.976
NEC for r=0.6 class 0 = 0.132 +- 0.207 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 1 = 0.012 +- 0.207 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 2 = 0.062 +- 0.207 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.087 +- 0.207 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.054 +- 0.129 (in-sample avg dev_std = 0.191)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.986
NEC for r=0.9 class 0 = 0.053 +- 0.163 (in-sample avg dev_std = 0.141)
NEC for r=0.9 class 1 = 0.01 +- 0.163 (in-sample avg dev_std = 0.141)
NEC for r=0.9 class 2 = 0.031 +- 0.163 (in-sample avg dev_std = 0.141)
NEC for r=0.9 all KL = 0.048 +- 0.163 (in-sample avg dev_std = 0.141)
NEC for r=0.9 all L1 = 0.026 +- 0.096 (in-sample avg dev_std = 0.141)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.99
NEC for r=1.0 class 0 = 0.046 +- 0.142 (in-sample avg dev_std = 0.121)
NEC for r=1.0 class 1 = 0.009 +- 0.142 (in-sample avg dev_std = 0.121)
NEC for r=1.0 class 2 = 0.019 +- 0.142 (in-sample avg dev_std = 0.121)
NEC for r=1.0 all KL = 0.04 +- 0.142 (in-sample avg dev_std = 0.121)
NEC for r=1.0 all L1 = 0.021 +- 0.080 (in-sample avg dev_std = 0.121)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:25:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:34 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:25:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 5...
[0m[1;37mINFO[0m: [1mCheckpoint 5: 
-----------------------------------
Train ACCURACY: 0.9208
Train Loss: 0.2372
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.8254
ID Test ACCURACY: 0.6480
ID Test Loss: 0.9897
OOD Validation ACCURACY: 0.6174
OOD Validation Loss: 1.2560
OOD Test ACCURACY: 0.5669
OOD Test Loss: 1.6424

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6823
ID Validation Loss: 2.1377
ID Test ACCURACY: 0.6588
ID Test Loss: 2.5118
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6032
OOD Test ACCURACY: 0.5745
OOD Test Loss: 3.2801

[0m[1;37mINFO[0m: [1mChartInfo 0.6480 0.5669 0.6588 0.5745 0.6823 0.6336[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.633
SUFF++ for r=0.3 class 0 = 0.681 +- 0.114 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 1 = 0.824 +- 0.114 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 2 = 0.691 +- 0.114 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all KL = 0.881 +- 0.114 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.126 (in-sample avg dev_std = 0.266)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.76
SUFF++ for r=0.6 class 0 = 0.697 +- 0.133 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 class 1 = 0.814 +- 0.133 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 class 2 = 0.724 +- 0.133 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 all KL = 0.862 +- 0.133 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.6 all L1 = 0.762 +- 0.127 (in-sample avg dev_std = 0.291)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0 = 0.863 +- 0.063 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 class 1 = 0.891 +- 0.063 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 class 2 = 0.874 +- 0.063 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 all KL = 0.954 +- 0.063 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 all L1 = 0.88 +- 0.101 (in-sample avg dev_std = 0.159)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0 = 0.234 +- 0.083 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 1 = 0.123 +- 0.083 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 2 = 0.232 +- 0.083 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all KL = 0.058 +- 0.083 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all L1 = 0.178 +- 0.123 (in-sample avg dev_std = 0.141)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0 = 0.205 +- 0.081 (in-sample avg dev_std = 0.154)
NEC for r=0.6 class 1 = 0.131 +- 0.081 (in-sample avg dev_std = 0.154)
NEC for r=0.6 class 2 = 0.194 +- 0.081 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all KL = 0.061 +- 0.081 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all L1 = 0.165 +- 0.120 (in-sample avg dev_std = 0.154)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.873
NEC for r=0.9 class 0 = 0.132 +- 0.071 (in-sample avg dev_std = 0.132)
NEC for r=0.9 class 1 = 0.112 +- 0.071 (in-sample avg dev_std = 0.132)
NEC for r=0.9 class 2 = 0.125 +- 0.071 (in-sample avg dev_std = 0.132)
NEC for r=0.9 all KL = 0.043 +- 0.071 (in-sample avg dev_std = 0.132)
NEC for r=0.9 all L1 = 0.12 +- 0.111 (in-sample avg dev_std = 0.132)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.912
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.876
NEC for r=1.0 class 0 = 0.124 +- 0.075 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 1 = 0.105 +- 0.075 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 2 = 0.099 +- 0.075 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all KL = 0.042 +- 0.075 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all L1 = 0.108 +- 0.114 (in-sample avg dev_std = 0.136)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.569, 0.728, 0.967, 1.0], 'all_L1': [0.695, 0.829, 0.971, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.703, 0.976, 1.0], 'all_L1': [0.639, 0.885, 0.988, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.765, 0.964, 1.0], 'all_L1': [0.691, 0.872, 0.976, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.678, 0.967, 1.0], 'all_L1': [0.651, 0.856, 0.982, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.862, 0.954, 1.0], 'all_L1': [0.755, 0.762, 0.88, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.159, 0.093, 0.057, 0.051], 'all_L1': [0.169, 0.089, 0.044, 0.036]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.057, 0.038, 0.04], 'all_L1': [0.086, 0.027, 0.017, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.136, 0.085, 0.05, 0.047], 'all_L1': [0.125, 0.063, 0.032, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.147, 0.087, 0.048, 0.04], 'all_L1': [0.135, 0.054, 0.026, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.061, 0.043, 0.042], 'all_L1': [0.178, 0.165, 0.12, 0.108]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.686 +- 0.041, 0.841 +- 0.044, 0.959 +- 0.040, 1.000 +- 0.000
suff++ class all_KL  =  0.521 +- 0.206, 0.747 +- 0.064, 0.966 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.731 +- 0.051, 0.881 +- 0.063, 0.966 +- 0.049
nec class all_L1  =  0.139 +- 0.033, 0.080 +- 0.047, 0.048 +- 0.037, 0.043 +- 0.033
nec class all_KL  =  0.123 +- 0.036, 0.077 +- 0.015, 0.047 +- 0.006, 0.044 +- 0.004
nec_acc_int  =  0.866 +- 0.094, 0.935 +- 0.063, 0.962 +- 0.045, 0.965 +- 0.045


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.412 +- 0.035, 0.460 +- 0.005, 0.504 +- 0.002, 0.521 +- 0.017
Faith. Armon (L1)= 		  =  0.229 +- 0.048, 0.141 +- 0.074, 0.088 +- 0.064, 0.080 +- 0.058
Faith. GMean (L1)= 	  =  0.307 +- 0.046, 0.246 +- 0.066, 0.200 +- 0.067, 0.195 +- 0.069
Faith. Aritm (KL)= 		  =  0.322 +- 0.093, 0.412 +- 0.030, 0.506 +- 0.004, 0.522 +- 0.002
Faith. Armon (KL)= 		  =  0.189 +- 0.049, 0.138 +- 0.024, 0.090 +- 0.012, 0.084 +- 0.008
Faith. GMean (KL)= 	  =  0.240 +- 0.041, 0.238 +- 0.021, 0.213 +- 0.014, 0.210 +- 0.010
Computed for split load_split = id



Completed in  0:07:59.864199  for GSATvGIN GOODTwitter/length



DONE GSAT GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:27:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:33 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:36 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:27:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.7004
ID Validation Loss: 1.4395
ID Test ACCURACY: 0.6498
ID Test Loss: 1.7556
OOD Validation ACCURACY: 0.6269
OOD Validation Loss: 1.7485
OOD Test ACCURACY: 0.5676
OOD Test Loss: 2.4674

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6931
ID Validation Loss: 1.6611
ID Test ACCURACY: 0.6588
ID Test Loss: 1.9403
OOD Validation ACCURACY: 0.6409
OOD Validation Loss: 2.1076
OOD Test ACCURACY: 0.5813
OOD Test Loss: 2.4255

[0m[1;37mINFO[0m: [1mChartInfo 0.6498 0.5676 0.6588 0.5813 0.6931 0.6409[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.948
SUFF++ for r=0.6 class 0 = 0.879 +- 0.337 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 class 1 = 0.914 +- 0.337 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 class 2 = 0.877 +- 0.337 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 all KL = 0.679 +- 0.337 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 all L1 = 0.896 +- 0.125 (in-sample avg dev_std = 0.357)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.994
NEC for r=0.6 class 0 = 0.019 +- 0.140 (in-sample avg dev_std = 0.084)
NEC for r=0.6 class 1 = 0.006 +- 0.140 (in-sample avg dev_std = 0.084)
NEC for r=0.6 class 2 = 0.024 +- 0.140 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all KL = 0.034 +- 0.140 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all L1 = 0.014 +- 0.065 (in-sample avg dev_std = 0.084)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:28:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:10 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:12 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:15 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6968
ID Validation Loss: 1.8803
ID Test ACCURACY: 0.6552
ID Test Loss: 2.0303
OOD Validation ACCURACY: 0.6415
OOD Validation Loss: 2.1364
OOD Test ACCURACY: 0.5580
OOD Test Loss: 2.5377

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6895
ID Validation Loss: 1.7708
ID Test ACCURACY: 0.6625
ID Test Loss: 1.9030
OOD Validation ACCURACY: 0.6471
OOD Validation Loss: 2.0345
OOD Test ACCURACY: 0.5553
OOD Test Loss: 2.4157

[0m[1;37mINFO[0m: [1mChartInfo 0.6552 0.5580 0.6625 0.5553 0.6895 0.6471[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.919
SUFF++ for r=0.6 class 0 = 0.814 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.968 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.624 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.864 +- 0.170 (in-sample avg dev_std = 0.440)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.994
NEC for r=0.6 class 0 = 0.023 +- 0.148 (in-sample avg dev_std = 0.093)
NEC for r=0.6 class 1 = 0.003 +- 0.148 (in-sample avg dev_std = 0.093)
NEC for r=0.6 class 2 = 0.029 +- 0.148 (in-sample avg dev_std = 0.093)
NEC for r=0.6 all KL = 0.038 +- 0.148 (in-sample avg dev_std = 0.093)
NEC for r=0.6 all L1 = 0.015 +- 0.065 (in-sample avg dev_std = 0.093)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:28:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:48 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:28:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.4023
ID Test ACCURACY: 0.6282
ID Test Loss: 2.7740
OOD Validation ACCURACY: 0.6246
OOD Validation Loss: 2.7762
OOD Test ACCURACY: 0.5635
OOD Test Loss: 3.1692

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6679
ID Validation Loss: 2.4808
ID Test ACCURACY: 0.6462
ID Test Loss: 2.5342
OOD Validation ACCURACY: 0.6431
OOD Validation Loss: 2.6516
OOD Test ACCURACY: 0.5765
OOD Test Loss: 2.9538

[0m[1;37mINFO[0m: [1mChartInfo 0.6282 0.5635 0.6462 0.5765 0.6679 0.6431[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.986
SUFF++ for r=0.6 class 0 = 0.98 +- 0.252 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 class 1 = 0.964 +- 0.252 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 class 2 = 0.959 +- 0.252 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all KL = 0.881 +- 0.252 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all L1 = 0.967 +- 0.081 (in-sample avg dev_std = 0.206)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.998
NEC for r=0.6 class 0 = 0.006 +- 0.104 (in-sample avg dev_std = 0.070)
NEC for r=0.6 class 1 = 0.005 +- 0.104 (in-sample avg dev_std = 0.070)
NEC for r=0.6 class 2 = 0.007 +- 0.104 (in-sample avg dev_std = 0.070)
NEC for r=0.6 all KL = 0.019 +- 0.104 (in-sample avg dev_std = 0.070)
NEC for r=0.6 all L1 = 0.006 +- 0.034 (in-sample avg dev_std = 0.070)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:29:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:29:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.6780
ID Test ACCURACY: 0.6408
ID Test Loss: 1.9436
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 1.9583
OOD Test ACCURACY: 0.5662
OOD Test Loss: 2.4517

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6715
ID Validation Loss: 2.2080
ID Test ACCURACY: 0.6462
ID Test Loss: 2.5187
OOD Validation ACCURACY: 0.6465
OOD Validation Loss: 2.4911
OOD Test ACCURACY: 0.5779
OOD Test Loss: 2.9096

[0m[1;37mINFO[0m: [1mChartInfo 0.6408 0.5662 0.6462 0.5779 0.6715 0.6465[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.982
SUFF++ for r=0.6 class 0 = 0.927 +- 0.254 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1 = 0.972 +- 0.254 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 2 = 0.957 +- 0.254 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.858 +- 0.254 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.957 +- 0.090 (in-sample avg dev_std = 0.214)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.997
NEC for r=0.6 class 0 = 0.011 +- 0.094 (in-sample avg dev_std = 0.065)
NEC for r=0.6 class 1 = 0.006 +- 0.094 (in-sample avg dev_std = 0.065)
NEC for r=0.6 class 2 = 0.006 +- 0.094 (in-sample avg dev_std = 0.065)
NEC for r=0.6 all KL = 0.02 +- 0.094 (in-sample avg dev_std = 0.065)
NEC for r=0.6 all L1 = 0.007 +- 0.043 (in-sample avg dev_std = 0.065)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:29:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:57 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:29:58 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:30:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6841
ID Validation Loss: 2.1540
ID Test ACCURACY: 0.6462
ID Test Loss: 2.4067
OOD Validation ACCURACY: 0.6123
OOD Validation Loss: 2.5559
OOD Test ACCURACY: 0.5511
OOD Test Loss: 3.1148

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6643
ID Validation Loss: 2.4438
ID Test ACCURACY: 0.6408
ID Test Loss: 2.7934
OOD Validation ACCURACY: 0.6359
OOD Validation Loss: 2.7242
OOD Test ACCURACY: 0.5704
OOD Test Loss: 3.1535

[0m[1;37mINFO[0m: [1mChartInfo 0.6462 0.5511 0.6408 0.5704 0.6643 0.6359[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.983
SUFF++ for r=0.6 class 0 = 0.965 +- 0.268 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.6 class 1 = 0.963 +- 0.268 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.6 class 2 = 0.963 +- 0.268 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.6 all KL = 0.861 +- 0.268 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.6 all L1 = 0.964 +- 0.084 (in-sample avg dev_std = 0.212)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.997
NEC for r=0.6 class 0 = 0.004 +- 0.098 (in-sample avg dev_std = 0.070)
NEC for r=0.6 class 1 = 0.006 +- 0.098 (in-sample avg dev_std = 0.070)
NEC for r=0.6 class 2 = 0.004 +- 0.098 (in-sample avg dev_std = 0.070)
NEC for r=0.6 all KL = 0.016 +- 0.098 (in-sample avg dev_std = 0.070)
NEC for r=0.6 all L1 = 0.005 +- 0.038 (in-sample avg dev_std = 0.070)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.679], 'all_L1': [0.896]}), defaultdict(<class 'list'>, {'all_KL': [0.624], 'all_L1': [0.864]}), defaultdict(<class 'list'>, {'all_KL': [0.881], 'all_L1': [0.967]}), defaultdict(<class 'list'>, {'all_KL': [0.858], 'all_L1': [0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.861], 'all_L1': [0.964]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.034], 'all_L1': [0.014]}), defaultdict(<class 'list'>, {'all_KL': [0.038], 'all_L1': [0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.019], 'all_L1': [0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.02], 'all_L1': [0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.016], 'all_L1': [0.005]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.930 +- 0.042
suff++ class all_KL  =  0.781 +- 0.107
suff++_acc_int  =  0.963 +- 0.026
nec class all_L1  =  0.009 +- 0.004
nec class all_KL  =  0.025 +- 0.009
nec_acc_int  =  0.996 +- 0.002


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.470 +- 0.019
Faith. Armon (L1)= 		  =  0.019 +- 0.008
Faith. GMean (L1)= 	  =  0.091 +- 0.019
Faith. Aritm (KL)= 		  =  0.403 +- 0.049
Faith. Armon (KL)= 		  =  0.049 +- 0.016
Faith. GMean (KL)= 	  =  0.137 +- 0.014
Computed for split load_split = id



Completed in  0:02:59.322612  for CIGAvGIN GOODTwitter/length



DONE CIGA GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:31:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:04 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:11 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:13 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:31:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.0950
ID Validation ROC-AUC: 0.8455
ID Validation Loss: 0.1252
ID Test ROC-AUC: 0.8217
ID Test Loss: 0.1090
OOD Validation ROC-AUC: 0.7404
OOD Validation Loss: 0.1137
OOD Test ROC-AUC: 0.6988
OOD Test Loss: 0.0867

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.8446
Train Loss: 0.1135
ID Validation ROC-AUC: 0.8042
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8042
ID Test Loss: 0.1156
OOD Validation ROC-AUC: 0.7833
OOD Validation Loss: 0.1126
OOD Test ROC-AUC: 0.6912
OOD Test Loss: 0.0970

[0m[1;37mINFO[0m: [1mChartInfo 0.8217 0.6988 0.8042 0.6912 0.8042 0.7833[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:31:15 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.568
SUFF++ for r=0.3 class 0.0 = 0.988 +- 0.009 (in-sample avg dev_std = 0.025)
SUFF++ for r=0.3 class 1.0 = 0.981 +- 0.009 (in-sample avg dev_std = 0.025)
SUFF++ for r=0.3 all KL = 0.995 +- 0.009 (in-sample avg dev_std = 0.025)
SUFF++ for r=0.3 all L1 = 0.985 +- 0.017 (in-sample avg dev_std = 0.025)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.693
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
SUFF++ for r=0.6 class 0.0 = 0.985 +- 0.023 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.6 class 1.0 = 0.954 +- 0.023 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.6 all KL = 0.989 +- 0.023 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.6 all L1 = 0.97 +- 0.048 (in-sample avg dev_std = 0.048)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.747
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.727
SUFF++ for r=0.9 class 0.0 = 0.987 +- 0.026 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 1.0 = 0.95 +- 0.026 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all KL = 0.991 +- 0.026 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all L1 = 0.968 +- 0.059 (in-sample avg dev_std = 0.057)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.596
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0.0 = 0.009 +- 0.010 (in-sample avg dev_std = 0.020)
NEC for r=0.3 class 1.0 = 0.017 +- 0.010 (in-sample avg dev_std = 0.020)
NEC for r=0.3 all KL = 0.003 +- 0.010 (in-sample avg dev_std = 0.020)
NEC for r=0.3 all L1 = 0.013 +- 0.018 (in-sample avg dev_std = 0.020)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.693
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.682
NEC for r=0.6 class 0.0 = 0.011 +- 0.028 (in-sample avg dev_std = 0.048)
NEC for r=0.6 class 1.0 = 0.043 +- 0.028 (in-sample avg dev_std = 0.048)
NEC for r=0.6 all KL = 0.01 +- 0.028 (in-sample avg dev_std = 0.048)
NEC for r=0.6 all L1 = 0.027 +- 0.047 (in-sample avg dev_std = 0.048)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.747
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.747
NEC for r=0.9 class 0.0 = 0.013 +- 0.021 (in-sample avg dev_std = 0.050)
NEC for r=0.9 class 1.0 = 0.049 +- 0.021 (in-sample avg dev_std = 0.050)
NEC for r=0.9 all KL = 0.008 +- 0.021 (in-sample avg dev_std = 0.050)
NEC for r=0.9 all L1 = 0.031 +- 0.051 (in-sample avg dev_std = 0.050)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.762
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.758
NEC for r=1.0 class 0.0 = 0.012 +- 0.016 (in-sample avg dev_std = 0.052)
NEC for r=1.0 class 1.0 = 0.046 +- 0.016 (in-sample avg dev_std = 0.052)
NEC for r=1.0 all KL = 0.007 +- 0.016 (in-sample avg dev_std = 0.052)
NEC for r=1.0 all L1 = 0.029 +- 0.048 (in-sample avg dev_std = 0.052)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:32:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:43 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:32:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ROC-AUC: 0.9193
Train Loss: 0.0894
ID Validation ROC-AUC: 0.8354
ID Validation Loss: 0.1257
ID Test ROC-AUC: 0.8084
ID Test Loss: 0.1109
OOD Validation ROC-AUC: 0.7601
OOD Validation Loss: 0.1176
OOD Test ROC-AUC: 0.7290
OOD Test Loss: 0.0872

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.8677
Train Loss: 0.1098
ID Validation ROC-AUC: 0.8315
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8039
ID Test Loss: 0.1138
OOD Validation ROC-AUC: 0.7858
OOD Validation Loss: 0.1065
OOD Test ROC-AUC: 0.7517
OOD Test Loss: 0.0875

[0m[1;37mINFO[0m: [1mChartInfo 0.8084 0.7290 0.8039 0.7517 0.8315 0.7858[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:32:53 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0.0 = 0.935 +- 0.069 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.3 class 1.0 = 0.901 +- 0.069 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.3 all KL = 0.947 +- 0.069 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.3 all L1 = 0.918 +- 0.080 (in-sample avg dev_std = 0.129)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.773
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.712
SUFF++ for r=0.6 class 0.0 = 0.915 +- 0.088 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.6 class 1.0 = 0.814 +- 0.088 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.6 all KL = 0.924 +- 0.088 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.6 all L1 = 0.865 +- 0.117 (in-sample avg dev_std = 0.179)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.841
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.814
SUFF++ for r=0.9 class 0.0 = 0.951 +- 0.053 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 class 1.0 = 0.854 +- 0.053 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 all KL = 0.965 +- 0.053 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 all L1 = 0.902 +- 0.103 (in-sample avg dev_std = 0.128)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.614
NEC for r=0.3 class 0.0 = 0.05 +- 0.063 (in-sample avg dev_std = 0.079)
NEC for r=0.3 class 1.0 = 0.07 +- 0.063 (in-sample avg dev_std = 0.079)
NEC for r=0.3 all KL = 0.03 +- 0.063 (in-sample avg dev_std = 0.079)
NEC for r=0.3 all L1 = 0.06 +- 0.077 (in-sample avg dev_std = 0.079)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.773
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 0.0 = 0.063 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=0.6 class 1.0 = 0.141 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=0.6 all KL = 0.046 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=0.6 all L1 = 0.102 +- 0.103 (in-sample avg dev_std = 0.125)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.841
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.82
NEC for r=0.9 class 0.0 = 0.052 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 class 1.0 = 0.137 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 all KL = 0.035 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 all L1 = 0.095 +- 0.103 (in-sample avg dev_std = 0.116)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.853
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.836
NEC for r=1.0 class 0.0 = 0.044 +- 0.042 (in-sample avg dev_std = 0.097)
NEC for r=1.0 class 1.0 = 0.111 +- 0.042 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all KL = 0.023 +- 0.042 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all L1 = 0.077 +- 0.084 (in-sample avg dev_std = 0.097)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:34:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:16 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:34:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ROC-AUC: 0.9408
Train Loss: 0.0845
ID Validation ROC-AUC: 0.8353
ID Validation Loss: 0.1363
ID Test ROC-AUC: 0.8180
ID Test Loss: 0.1216
OOD Validation ROC-AUC: 0.7710
OOD Validation Loss: 0.1283
OOD Test ROC-AUC: 0.7279
OOD Test Loss: 0.0901

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9312
Train Loss: 0.0842
ID Validation ROC-AUC: 0.8199
ID Validation Loss: 0.1342
ID Test ROC-AUC: 0.7980
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7737
OOD Validation Loss: 0.1243
OOD Test ROC-AUC: 0.7203
OOD Test Loss: 0.0949

[0m[1;37mINFO[0m: [1mChartInfo 0.8180 0.7279 0.7980 0.7203 0.8199 0.7737[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:34:30 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.639
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.61
SUFF++ for r=0.3 class 0.0 = 0.826 +- 0.122 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 class 1.0 = 0.762 +- 0.122 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all KL = 0.86 +- 0.122 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all L1 = 0.794 +- 0.118 (in-sample avg dev_std = 0.255)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.727
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.674
SUFF++ for r=0.6 class 0.0 = 0.814 +- 0.109 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 class 1.0 = 0.731 +- 0.109 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 all KL = 0.873 +- 0.109 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 all L1 = 0.772 +- 0.143 (in-sample avg dev_std = 0.270)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.787
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.749
SUFF++ for r=0.9 class 0.0 = 0.907 +- 0.068 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 1.0 = 0.828 +- 0.068 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all KL = 0.95 +- 0.068 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all L1 = 0.867 +- 0.120 (in-sample avg dev_std = 0.171)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.639
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.653
NEC for r=0.3 class 0.0 = 0.129 +- 0.123 (in-sample avg dev_std = 0.168)
NEC for r=0.3 class 1.0 = 0.209 +- 0.123 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all KL = 0.09 +- 0.123 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all L1 = 0.169 +- 0.145 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.727
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.741
NEC for r=0.6 class 0.0 = 0.142 +- 0.105 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 1.0 = 0.231 +- 0.105 (in-sample avg dev_std = 0.197)
NEC for r=0.6 all KL = 0.085 +- 0.105 (in-sample avg dev_std = 0.197)
NEC for r=0.6 all L1 = 0.187 +- 0.149 (in-sample avg dev_std = 0.197)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.787
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.776
NEC for r=0.9 class 0.0 = 0.087 +- 0.060 (in-sample avg dev_std = 0.149)
NEC for r=0.9 class 1.0 = 0.164 +- 0.060 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all KL = 0.043 +- 0.060 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all L1 = 0.126 +- 0.112 (in-sample avg dev_std = 0.149)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.783
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.773
NEC for r=1.0 class 0.0 = 0.072 +- 0.063 (in-sample avg dev_std = 0.132)
NEC for r=1.0 class 1.0 = 0.138 +- 0.063 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all KL = 0.035 +- 0.063 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all L1 = 0.105 +- 0.104 (in-sample avg dev_std = 0.132)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:35:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:35:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:35:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:35:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9672
Train Loss: 0.0711
ID Validation ROC-AUC: 0.8273
ID Validation Loss: 0.1308
ID Test ROC-AUC: 0.8111
ID Test Loss: 0.1127
OOD Validation ROC-AUC: 0.7208
OOD Validation Loss: 0.1246
OOD Test ROC-AUC: 0.6528
OOD Test Loss: 0.0969

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.8696
Train Loss: 0.1264
ID Validation ROC-AUC: 0.8184
ID Validation Loss: 0.1532
ID Test ROC-AUC: 0.8196
ID Test Loss: 0.1278
OOD Validation ROC-AUC: 0.7775
OOD Validation Loss: 0.1197
OOD Test ROC-AUC: 0.7122
OOD Test Loss: 0.1159

[0m[1;37mINFO[0m: [1mChartInfo 0.8111 0.6528 0.8196 0.7122 0.8184 0.7775[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:36:05 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.674
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.643
SUFF++ for r=0.3 class 0.0 = 0.836 +- 0.130 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 class 1.0 = 0.771 +- 0.130 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 all KL = 0.845 +- 0.130 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 all L1 = 0.803 +- 0.127 (in-sample avg dev_std = 0.268)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.713
SUFF++ for r=0.6 class 0.0 = 0.821 +- 0.104 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 1.0 = 0.776 +- 0.104 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all KL = 0.887 +- 0.104 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all L1 = 0.798 +- 0.120 (in-sample avg dev_std = 0.250)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.786
SUFF++ for r=0.9 class 0.0 = 0.886 +- 0.041 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 class 1.0 = 0.873 +- 0.041 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all KL = 0.966 +- 0.041 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all L1 = 0.879 +- 0.090 (in-sample avg dev_std = 0.136)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.674
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.658
NEC for r=0.3 class 0.0 = 0.097 +- 0.089 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 1.0 = 0.174 +- 0.089 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all KL = 0.065 +- 0.089 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all L1 = 0.136 +- 0.143 (in-sample avg dev_std = 0.144)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.744
NEC for r=0.6 class 0.0 = 0.122 +- 0.079 (in-sample avg dev_std = 0.161)
NEC for r=0.6 class 1.0 = 0.176 +- 0.079 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all KL = 0.058 +- 0.079 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all L1 = 0.149 +- 0.120 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.786
NEC for r=0.9 class 0.0 = 0.104 +- 0.051 (in-sample avg dev_std = 0.129)
NEC for r=0.9 class 1.0 = 0.141 +- 0.051 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all KL = 0.033 +- 0.051 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all L1 = 0.122 +- 0.104 (in-sample avg dev_std = 0.129)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.812
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.796
NEC for r=1.0 class 0.0 = 0.092 +- 0.048 (in-sample avg dev_std = 0.122)
NEC for r=1.0 class 1.0 = 0.125 +- 0.048 (in-sample avg dev_std = 0.122)
NEC for r=1.0 all KL = 0.028 +- 0.048 (in-sample avg dev_std = 0.122)
NEC for r=1.0 all L1 = 0.109 +- 0.100 (in-sample avg dev_std = 0.122)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:37:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:30 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:42 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:42 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 61...
[0m[1;37mINFO[0m: [1mCheckpoint 61: 
-----------------------------------
Train ROC-AUC: 0.9084
Train Loss: 0.0957
ID Validation ROC-AUC: 0.8316
ID Validation Loss: 0.1288
ID Test ROC-AUC: 0.8079
ID Test Loss: 0.1132
OOD Validation ROC-AUC: 0.7393
OOD Validation Loss: 0.1117
OOD Test ROC-AUC: 0.7327
OOD Test Loss: 0.0860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 130...
[0m[1;37mINFO[0m: [1mCheckpoint 130: 
-----------------------------------
Train ROC-AUC: 0.9676
Train Loss: 0.0823
ID Validation ROC-AUC: 0.8098
ID Validation Loss: 0.1356
ID Test ROC-AUC: 0.8105
ID Test Loss: 0.1148
OOD Validation ROC-AUC: 0.7817
OOD Validation Loss: 0.1135
OOD Test ROC-AUC: 0.7377
OOD Test Loss: 0.0885

[0m[1;37mINFO[0m: [1mChartInfo 0.8079 0.7327 0.8105 0.7377 0.8098 0.7817[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:37:43 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.703
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.653
SUFF++ for r=0.3 class 0.0 = 0.877 +- 0.076 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.3 class 1.0 = 0.832 +- 0.076 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.3 all KL = 0.913 +- 0.076 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.3 all L1 = 0.854 +- 0.091 (in-sample avg dev_std = 0.189)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.778
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.697
SUFF++ for r=0.6 class 0.0 = 0.805 +- 0.105 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 class 1.0 = 0.799 +- 0.105 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 all KL = 0.892 +- 0.105 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 all L1 = 0.802 +- 0.103 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.785
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.747
SUFF++ for r=0.9 class 0.0 = 0.856 +- 0.069 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.9 class 1.0 = 0.857 +- 0.069 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.9 all KL = 0.953 +- 0.069 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.100 (in-sample avg dev_std = 0.162)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.703
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 799
Effective ratio: 0.309 +- 0.011
Model ROC-AUC over intervened graphs for r=0.3 =  0.704
NEC for r=0.3 class 0.0 = 0.069 +- 0.080 (in-sample avg dev_std = 0.118)
NEC for r=0.3 class 1.0 = 0.151 +- 0.080 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all KL = 0.049 +- 0.080 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all L1 = 0.11 +- 0.115 (in-sample avg dev_std = 0.118)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.778
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.609 +- 0.016
Model ROC-AUC over intervened graphs for r=0.6 =  0.74
NEC for r=0.6 class 0.0 = 0.105 +- 0.065 (in-sample avg dev_std = 0.133)
NEC for r=0.6 class 1.0 = 0.151 +- 0.065 (in-sample avg dev_std = 0.133)
NEC for r=0.6 all KL = 0.043 +- 0.065 (in-sample avg dev_std = 0.133)
NEC for r=0.6 all L1 = 0.128 +- 0.101 (in-sample avg dev_std = 0.133)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.785
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 799
Effective ratio: 0.908 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.745
NEC for r=0.9 class 0.0 = 0.115 +- 0.049 (in-sample avg dev_std = 0.129)
NEC for r=0.9 class 1.0 = 0.145 +- 0.049 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all KL = 0.035 +- 0.049 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all L1 = 0.13 +- 0.095 (in-sample avg dev_std = 0.129)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.792
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 799
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.75
NEC for r=1.0 class 0.0 = 0.114 +- 0.050 (in-sample avg dev_std = 0.128)
NEC for r=1.0 class 1.0 = 0.128 +- 0.050 (in-sample avg dev_std = 0.128)
NEC for r=1.0 all KL = 0.033 +- 0.050 (in-sample avg dev_std = 0.128)
NEC for r=1.0 all L1 = 0.121 +- 0.095 (in-sample avg dev_std = 0.128)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.995, 0.989, 0.991, 1.0], 'all_L1': [0.985, 0.97, 0.968, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.947, 0.924, 0.965, 1.0], 'all_L1': [0.918, 0.865, 0.902, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.873, 0.95, 1.0], 'all_L1': [0.794, 0.772, 0.867, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.887, 0.966, 1.0], 'all_L1': [0.803, 0.798, 0.879, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.913, 0.892, 0.953, 1.0], 'all_L1': [0.854, 0.802, 0.856, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.003, 0.01, 0.008, 0.007], 'all_L1': [0.013, 0.027, 0.031, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.046, 0.035, 0.023], 'all_L1': [0.06, 0.102, 0.095, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.085, 0.043, 0.035], 'all_L1': [0.169, 0.187, 0.126, 0.105]}), defaultdict(<class 'list'>, {'all_KL': [0.065, 0.058, 0.033, 0.028], 'all_L1': [0.136, 0.149, 0.122, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.043, 0.035, 0.033], 'all_L1': [0.11, 0.128, 0.13, 0.121]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.871 +- 0.072, 0.841 +- 0.071, 0.894 +- 0.040, 1.000 +- 0.000
suff++ class all_KL  =  0.912 +- 0.055, 0.913 +- 0.042, 0.965 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.612 +- 0.032, 0.687 +- 0.028, 0.765 +- 0.032
nec class all_L1  =  0.098 +- 0.055, 0.119 +- 0.054, 0.101 +- 0.037, 0.088 +- 0.033
nec class all_KL  =  0.047 +- 0.030, 0.048 +- 0.024, 0.031 +- 0.012, 0.025 +- 0.010
nec_acc_int  =  0.646 +- 0.036, 0.734 +- 0.028, 0.775 +- 0.028, 0.783 +- 0.031


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.484 +- 0.010, 0.480 +- 0.011, 0.498 +- 0.003, 0.544 +- 0.016
Faith. Armon (L1)= 		  =  0.169 +- 0.090, 0.202 +- 0.084, 0.178 +- 0.062, 0.160 +- 0.057
Faith. GMean (L1)= 	  =  0.270 +- 0.090, 0.301 +- 0.075, 0.292 +- 0.061, 0.290 +- 0.064
Faith. Aritm (KL)= 		  =  0.480 +- 0.015, 0.481 +- 0.011, 0.498 +- 0.002, 0.513 +- 0.005
Faith. Armon (KL)= 		  =  0.088 +- 0.054, 0.091 +- 0.044, 0.059 +- 0.023, 0.049 +- 0.019
Faith. GMean (KL)= 	  =  0.189 +- 0.076, 0.200 +- 0.057, 0.167 +- 0.040, 0.154 +- 0.037
Computed for split load_split = id



Completed in  0:08:08.602000  for GSATvGIN GOODHIV/scaffold



DONE GSAT GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:39:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:34 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:41 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:39:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 78...
[0m[1;37mINFO[0m: [1mCheckpoint 78: 
-----------------------------------
Train ROC-AUC: 0.9940
Train Loss: 0.0391
ID Validation ROC-AUC: 0.8450
ID Validation Loss: 0.1821
ID Test ROC-AUC: 0.8077
ID Test Loss: 0.1679
OOD Validation ROC-AUC: 0.6969
OOD Validation Loss: 0.2009
OOD Test ROC-AUC: 0.6673
OOD Test Loss: 0.1473

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ROC-AUC: 0.9930
Train Loss: 0.0404
ID Validation ROC-AUC: 0.8284
ID Validation Loss: 0.1766
ID Test ROC-AUC: 0.8100
ID Test Loss: 0.1597
OOD Validation ROC-AUC: 0.7746
OOD Validation Loss: 0.1708
OOD Test ROC-AUC: 0.6410
OOD Test Loss: 0.1507

[0m[1;37mINFO[0m: [1mChartInfo 0.8077 0.6673 0.8100 0.6410 0.8284 0.7746[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:39:49 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.561
SUFF++ for r=0.8 class 0.0 = 0.669 +- 0.284 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.8 class 1.0 = 0.602 +- 0.284 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.8 all KL = 0.577 +- 0.284 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.8 all L1 = 0.635 +- 0.222 (in-sample avg dev_std = 0.511)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.63
NEC for r=0.8 class 0.0 = 0.281 +- 0.311 (in-sample avg dev_std = 0.269)
NEC for r=0.8 class 1.0 = 0.319 +- 0.311 (in-sample avg dev_std = 0.269)
NEC for r=0.8 all KL = 0.298 +- 0.311 (in-sample avg dev_std = 0.269)
NEC for r=0.8 all L1 = 0.3 +- 0.263 (in-sample avg dev_std = 0.269)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:40:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ROC-AUC: 0.9987
Train Loss: 0.0183
ID Validation ROC-AUC: 0.8436
ID Validation Loss: 0.1867
ID Test ROC-AUC: 0.7972
ID Test Loss: 0.1808
OOD Validation ROC-AUC: 0.7113
OOD Validation Loss: 0.2083
OOD Test ROC-AUC: 0.6616
OOD Test Loss: 0.1540

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ROC-AUC: 0.8665
Train Loss: 0.1133
ID Validation ROC-AUC: 0.8073
ID Validation Loss: 0.1400
ID Test ROC-AUC: 0.8000
ID Test Loss: 0.1208
OOD Validation ROC-AUC: 0.7821
OOD Validation Loss: 0.1218
OOD Test ROC-AUC: 0.6412
OOD Test Loss: 0.0947

[0m[1;37mINFO[0m: [1mChartInfo 0.7972 0.6616 0.8000 0.6412 0.8073 0.7821[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:40:33 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.647
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.549
SUFF++ for r=0.8 class 0.0 = 0.882 +- 0.267 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.8 class 1.0 = 0.764 +- 0.267 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.8 all KL = 0.808 +- 0.267 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.8 all L1 = 0.823 +- 0.237 (in-sample avg dev_std = 0.301)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.647
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.616
NEC for r=0.8 class 0.0 = 0.195 +- 0.308 (in-sample avg dev_std = 0.320)
NEC for r=0.8 class 1.0 = 0.276 +- 0.308 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all KL = 0.264 +- 0.308 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all L1 = 0.236 +- 0.263 (in-sample avg dev_std = 0.320)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:41:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:16 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ROC-AUC: 0.9615
Train Loss: 0.0758
ID Validation ROC-AUC: 0.8439
ID Validation Loss: 0.1249
ID Test ROC-AUC: 0.7995
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7437
OOD Validation Loss: 0.1234
OOD Test ROC-AUC: 0.6739
OOD Test Loss: 0.0957

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.8809
Train Loss: 0.1125
ID Validation ROC-AUC: 0.8182
ID Validation Loss: 0.1392
ID Test ROC-AUC: 0.7843
ID Test Loss: 0.1272
OOD Validation ROC-AUC: 0.7800
OOD Validation Loss: 0.1249
OOD Test ROC-AUC: 0.6692
OOD Test Loss: 0.0917

[0m[1;37mINFO[0m: [1mChartInfo 0.7995 0.6739 0.7843 0.6692 0.8182 0.7800[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:41:19 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.77
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.666
SUFF++ for r=0.8 class 0.0 = 0.92 +- 0.084 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.8 class 1.0 = 0.846 +- 0.084 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.8 all KL = 0.93 +- 0.084 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.8 all L1 = 0.883 +- 0.111 (in-sample avg dev_std = 0.155)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.77
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.709
NEC for r=0.8 class 0.0 = 0.063 +- 0.079 (in-sample avg dev_std = 0.087)
NEC for r=0.8 class 1.0 = 0.125 +- 0.079 (in-sample avg dev_std = 0.087)
NEC for r=0.8 all KL = 0.044 +- 0.079 (in-sample avg dev_std = 0.087)
NEC for r=0.8 all L1 = 0.094 +- 0.109 (in-sample avg dev_std = 0.087)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:41:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:51 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:41:58 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:01 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9983
Train Loss: 0.0242
ID Validation ROC-AUC: 0.8431
ID Validation Loss: 0.1834
ID Test ROC-AUC: 0.8028
ID Test Loss: 0.1734
OOD Validation ROC-AUC: 0.7364
OOD Validation Loss: 0.2070
OOD Test ROC-AUC: 0.6626
OOD Test Loss: 0.1633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.9560
Train Loss: 0.0779
ID Validation ROC-AUC: 0.8151
ID Validation Loss: 0.1518
ID Test ROC-AUC: 0.7777
ID Test Loss: 0.1370
OOD Validation ROC-AUC: 0.7910
OOD Validation Loss: 0.1230
OOD Test ROC-AUC: 0.6634
OOD Test Loss: 0.1055

[0m[1;37mINFO[0m: [1mChartInfo 0.8028 0.6626 0.7777 0.6634 0.8151 0.7910[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:42:05 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.701
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.609
SUFF++ for r=0.8 class 0.0 = 0.789 +- 0.297 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.8 class 1.0 = 0.674 +- 0.297 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.8 all KL = 0.638 +- 0.297 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.8 all L1 = 0.732 +- 0.224 (in-sample avg dev_std = 0.476)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.701
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.719
NEC for r=0.8 class 0.0 = 0.142 +- 0.272 (in-sample avg dev_std = 0.258)
NEC for r=0.8 class 1.0 = 0.214 +- 0.272 (in-sample avg dev_std = 0.258)
NEC for r=0.8 all KL = 0.194 +- 0.272 (in-sample avg dev_std = 0.258)
NEC for r=0.8 all L1 = 0.178 +- 0.229 (in-sample avg dev_std = 0.258)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:42:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:36 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:42:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ROC-AUC: 0.9711
Train Loss: 0.0868
ID Validation ROC-AUC: 0.8464
ID Validation Loss: 0.1631
ID Test ROC-AUC: 0.8070
ID Test Loss: 0.1620
OOD Validation ROC-AUC: 0.7678
OOD Validation Loss: 0.1715
OOD Test ROC-AUC: 0.7207
OOD Test Loss: 0.1109

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 8...
[0m[1;37mINFO[0m: [1mCheckpoint 8: 
-----------------------------------
Train ROC-AUC: 0.8237
Train Loss: 0.1344
ID Validation ROC-AUC: 0.7836
ID Validation Loss: 0.1594
ID Test ROC-AUC: 0.7505
ID Test Loss: 0.1407
OOD Validation ROC-AUC: 0.7881
OOD Validation Loss: 0.1099
OOD Test ROC-AUC: 0.7056
OOD Test Loss: 0.1049

[0m[1;37mINFO[0m: [1mChartInfo 0.8070 0.7207 0.7505 0.7056 0.7836 0.7881[0mGOODHIV(24682)
Data example from train: Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([23758,   924]))
[1;34mDEBUG[0m: 04/14/2024 06:42:50 PM : [1mUnbalanced warning for GOODHIV (train)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([924, 924]))
F1 for r=0.8 = nan
WIoU for r=0.8 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.716
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.64
SUFF++ for r=0.8 class 0.0 = 0.736 +- 0.180 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.8 class 1.0 = 0.727 +- 0.180 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.8 all KL = 0.812 +- 0.180 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.8 all L1 = 0.731 +- 0.180 (in-sample avg dev_std = 0.330)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.8


Computing with masking

Model ROC-AUC of binarized graphs for r=0.8 =  0.716
Model XAI F1 of binarized graphs for r=0.8 =  nan
Model XAI WIoU of binarized graphs for r=0.8 =  nan
len(reference) = 799
Effective ratio: 0.808 +- 0.011
Model ROC-AUC over intervened graphs for r=0.8 =  0.67
NEC for r=0.8 class 0.0 = 0.198 +- 0.138 (in-sample avg dev_std = 0.179)
NEC for r=0.8 class 1.0 = 0.194 +- 0.138 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all KL = 0.102 +- 0.138 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all L1 = 0.196 +- 0.177 (in-sample avg dev_std = 0.179)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.577], 'all_L1': [0.635]}), defaultdict(<class 'list'>, {'all_KL': [0.808], 'all_L1': [0.823]}), defaultdict(<class 'list'>, {'all_KL': [0.93], 'all_L1': [0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.638], 'all_L1': [0.732]}), defaultdict(<class 'list'>, {'all_KL': [0.812], 'all_L1': [0.731]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.298], 'all_L1': [0.3]}), defaultdict(<class 'list'>, {'all_KL': [0.264], 'all_L1': [0.236]}), defaultdict(<class 'list'>, {'all_KL': [0.044], 'all_L1': [0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.194], 'all_L1': [0.178]}), defaultdict(<class 'list'>, {'all_KL': [0.102], 'all_L1': [0.196]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.761 +- 0.085
suff++ class all_KL  =  0.753 +- 0.128
suff++_acc_int  =  0.605 +- 0.045
nec class all_L1  =  0.201 +- 0.068
nec class all_KL  =  0.180 +- 0.096
nec_acc_int  =  0.669 +- 0.041


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.481 +- 0.027
Faith. Armon (L1)= 		  =  0.308 +- 0.081
Faith. GMean (L1)= 	  =  0.381 +- 0.056
Faith. Aritm (KL)= 		  =  0.467 +- 0.042
Faith. Armon (KL)= 		  =  0.271 +- 0.122
Faith. GMean (KL)= 	  =  0.344 +- 0.092
Computed for split load_split = id



Completed in  0:03:48.346270  for CIGAvGIN GOODHIV/scaffold



DONE CIGA GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:43:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 06:43:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:44:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:44:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:44:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:44:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:45:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 06:45:17 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.691
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.606
SUFF++ for r=0.3 class 0.0 = 0.687 +- 0.186 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 1.0 = 0.632 +- 0.186 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 all KL = 0.704 +- 0.186 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.148 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.616
SUFF++ for r=0.6 class 0.0 = 0.708 +- 0.196 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 1.0 = 0.653 +- 0.196 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all KL = 0.73 +- 0.196 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all L1 = 0.66 +- 0.153 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.719
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.683
SUFF++ for r=0.9 class 0.0 = 0.845 +- 0.157 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1.0 = 0.75 +- 0.157 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.867 +- 0.157 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.165 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.69
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.67
NEC for r=0.3 class 0.0 = 0.219 +- 0.186 (in-sample avg dev_std = 0.297)
NEC for r=0.3 class 1.0 = 0.245 +- 0.186 (in-sample avg dev_std = 0.297)
NEC for r=0.3 all KL = 0.152 +- 0.186 (in-sample avg dev_std = 0.297)
NEC for r=0.3 all L1 = 0.242 +- 0.191 (in-sample avg dev_std = 0.297)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.698
NEC for r=0.6 class 0.0 = 0.183 +- 0.163 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 1.0 = 0.228 +- 0.163 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all KL = 0.134 +- 0.163 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all L1 = 0.223 +- 0.166 (in-sample avg dev_std = 0.284)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.719
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.699
NEC for r=0.9 class 0.0 = 0.149 +- 0.134 (in-sample avg dev_std = 0.248)
NEC for r=0.9 class 1.0 = 0.197 +- 0.134 (in-sample avg dev_std = 0.248)
NEC for r=0.9 all KL = 0.096 +- 0.134 (in-sample avg dev_std = 0.248)
NEC for r=0.9 all L1 = 0.192 +- 0.145 (in-sample avg dev_std = 0.248)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.726
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.697
NEC for r=1.0 class 0.0 = 0.152 +- 0.119 (in-sample avg dev_std = 0.241)
NEC for r=1.0 class 1.0 = 0.187 +- 0.119 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all KL = 0.086 +- 0.119 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all L1 = 0.183 +- 0.140 (in-sample avg dev_std = 0.241)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:46:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 06:46:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:47:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:47:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:47:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 06:48:23 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.74
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.704
SUFF++ for r=0.3 class 0.0 = 0.751 +- 0.072 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 1.0 = 0.78 +- 0.072 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all KL = 0.912 +- 0.072 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all L1 = 0.777 +- 0.104 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.757
SUFF++ for r=0.6 class 0.0 = 0.749 +- 0.112 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 1.0 = 0.808 +- 0.112 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all KL = 0.889 +- 0.112 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all L1 = 0.801 +- 0.139 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.806
SUFF++ for r=0.9 class 0.0 = 0.833 +- 0.079 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 class 1.0 = 0.899 +- 0.079 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 all KL = 0.953 +- 0.079 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.117 (in-sample avg dev_std = 0.142)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.741
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.679
NEC for r=0.3 class 0.0 = 0.201 +- 0.060 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1.0 = 0.161 +- 0.060 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.048 +- 0.060 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.166 +- 0.102 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.773
NEC for r=0.6 class 0.0 = 0.195 +- 0.070 (in-sample avg dev_std = 0.163)
NEC for r=0.6 class 1.0 = 0.129 +- 0.070 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all KL = 0.053 +- 0.070 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all L1 = 0.137 +- 0.108 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.798
NEC for r=0.9 class 0.0 = 0.163 +- 0.064 (in-sample avg dev_std = 0.129)
NEC for r=0.9 class 1.0 = 0.083 +- 0.064 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all KL = 0.035 +- 0.064 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all L1 = 0.092 +- 0.098 (in-sample avg dev_std = 0.129)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.811
NEC for r=1.0 class 0.0 = 0.132 +- 0.042 (in-sample avg dev_std = 0.108)
NEC for r=1.0 class 1.0 = 0.065 +- 0.042 (in-sample avg dev_std = 0.108)
NEC for r=1.0 all KL = 0.024 +- 0.042 (in-sample avg dev_std = 0.108)
NEC for r=1.0 all L1 = 0.073 +- 0.081 (in-sample avg dev_std = 0.108)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:50:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 06:50:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:50:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:50:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:50:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 06:51:30 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.593
SUFF++ for r=0.3 class 0.0 = 0.689 +- 0.218 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 class 1.0 = 0.601 +- 0.218 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 all KL = 0.654 +- 0.218 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 all L1 = 0.611 +- 0.154 (in-sample avg dev_std = 0.531)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.727
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.695
SUFF++ for r=0.6 class 0.0 = 0.673 +- 0.213 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 1.0 = 0.663 +- 0.213 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all KL = 0.703 +- 0.213 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all L1 = 0.664 +- 0.193 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.747
SUFF++ for r=0.9 class 0.0 = 0.768 +- 0.183 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 1.0 = 0.835 +- 0.183 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all KL = 0.873 +- 0.183 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all L1 = 0.828 +- 0.178 (in-sample avg dev_std = 0.251)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0.0 = 0.225 +- 0.192 (in-sample avg dev_std = 0.317)
NEC for r=0.3 class 1.0 = 0.269 +- 0.192 (in-sample avg dev_std = 0.317)
NEC for r=0.3 all KL = 0.179 +- 0.192 (in-sample avg dev_std = 0.317)
NEC for r=0.3 all L1 = 0.264 +- 0.173 (in-sample avg dev_std = 0.317)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.727
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.724
NEC for r=0.6 class 0.0 = 0.229 +- 0.177 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 1.0 = 0.23 +- 0.177 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all KL = 0.154 +- 0.177 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all L1 = 0.23 +- 0.186 (in-sample avg dev_std = 0.299)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.771
NEC for r=0.9 class 0.0 = 0.222 +- 0.154 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 1.0 = 0.143 +- 0.154 (in-sample avg dev_std = 0.227)
NEC for r=0.9 all KL = 0.103 +- 0.154 (in-sample avg dev_std = 0.227)
NEC for r=0.9 all L1 = 0.152 +- 0.164 (in-sample avg dev_std = 0.227)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.789
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.782
NEC for r=1.0 class 0.0 = 0.215 +- 0.141 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 1.0 = 0.118 +- 0.141 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all KL = 0.086 +- 0.141 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all L1 = 0.13 +- 0.153 (in-sample avg dev_std = 0.210)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:53:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 06:53:10 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:53:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:53:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 06:54:37 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.641
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.595
SUFF++ for r=0.3 class 0.0 = 0.68 +- 0.116 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 class 1.0 = 0.672 +- 0.116 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all KL = 0.832 +- 0.116 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all L1 = 0.673 +- 0.110 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.727
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.66
SUFF++ for r=0.6 class 0.0 = 0.727 +- 0.096 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 1.0 = 0.709 +- 0.096 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all KL = 0.877 +- 0.096 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all L1 = 0.711 +- 0.109 (in-sample avg dev_std = 0.296)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.756
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.741
SUFF++ for r=0.9 class 0.0 = 0.876 +- 0.065 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1.0 = 0.808 +- 0.065 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.947 +- 0.065 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.111 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.642
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.618
NEC for r=0.3 class 0.0 = 0.247 +- 0.113 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 1.0 = 0.275 +- 0.113 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all KL = 0.117 +- 0.113 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all L1 = 0.271 +- 0.131 (in-sample avg dev_std = 0.261)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.727
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.719
NEC for r=0.6 class 0.0 = 0.175 +- 0.084 (in-sample avg dev_std = 0.226)
NEC for r=0.6 class 1.0 = 0.233 +- 0.084 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all KL = 0.078 +- 0.084 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all L1 = 0.226 +- 0.114 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.757
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.754
NEC for r=0.9 class 0.0 = 0.114 +- 0.056 (in-sample avg dev_std = 0.183)
NEC for r=0.9 class 1.0 = 0.174 +- 0.056 (in-sample avg dev_std = 0.183)
NEC for r=0.9 all KL = 0.045 +- 0.056 (in-sample avg dev_std = 0.183)
NEC for r=0.9 all L1 = 0.167 +- 0.096 (in-sample avg dev_std = 0.183)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.776
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.774
NEC for r=1.0 class 0.0 = 0.102 +- 0.054 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1.0 = 0.163 +- 0.054 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.04 +- 0.054 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.155 +- 0.095 (in-sample avg dev_std = 0.173)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 18:56:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 06:56:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 06:56:51 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:37 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 06:57:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 06:57:54 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.624
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.529
SUFF++ for r=0.3 class 0.0 = 0.793 +- 0.176 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1.0 = 0.776 +- 0.176 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.815 +- 0.176 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.778 +- 0.143 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0.0 = 0.748 +- 0.200 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 class 1.0 = 0.666 +- 0.200 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 all KL = 0.749 +- 0.200 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 all L1 = 0.676 +- 0.173 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.756
SUFF++ for r=0.9 class 0.0 = 0.835 +- 0.153 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 class 1.0 = 0.747 +- 0.153 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 all KL = 0.864 +- 0.153 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 all L1 = 0.757 +- 0.161 (in-sample avg dev_std = 0.272)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.625
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.568
NEC for r=0.3 class 0.0 = 0.114 +- 0.107 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 1.0 = 0.134 +- 0.107 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all KL = 0.071 +- 0.107 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all L1 = 0.132 +- 0.123 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.716
NEC for r=0.6 class 0.0 = 0.137 +- 0.149 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1.0 = 0.205 +- 0.149 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.109 +- 0.149 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.197 +- 0.163 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.778
NEC for r=0.9 class 0.0 = 0.163 +- 0.123 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 1.0 = 0.21 +- 0.123 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all KL = 0.103 +- 0.123 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all L1 = 0.205 +- 0.137 (in-sample avg dev_std = 0.252)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.806
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.782
NEC for r=1.0 class 0.0 = 0.158 +- 0.106 (in-sample avg dev_std = 0.224)
NEC for r=1.0 class 1.0 = 0.18 +- 0.106 (in-sample avg dev_std = 0.224)
NEC for r=1.0 all KL = 0.084 +- 0.106 (in-sample avg dev_std = 0.224)
NEC for r=1.0 all L1 = 0.177 +- 0.129 (in-sample avg dev_std = 0.224)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.704, 0.73, 0.867, 1.0], 'all_L1': [0.638, 0.66, 0.761, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.889, 0.953, 1.0], 'all_L1': [0.777, 0.801, 0.892, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.703, 0.873, 1.0], 'all_L1': [0.611, 0.664, 0.828, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.832, 0.877, 0.947, 1.0], 'all_L1': [0.673, 0.711, 0.816, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.815, 0.749, 0.864, 1.0], 'all_L1': [0.778, 0.676, 0.757, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.152, 0.134, 0.096, 0.086], 'all_L1': [0.242, 0.223, 0.192, 0.183]}), defaultdict(<class 'list'>, {'all_KL': [0.048, 0.053, 0.035, 0.024], 'all_L1': [0.166, 0.137, 0.092, 0.073]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.154, 0.103, 0.086], 'all_L1': [0.264, 0.23, 0.152, 0.13]}), defaultdict(<class 'list'>, {'all_KL': [0.117, 0.078, 0.045, 0.04], 'all_L1': [0.271, 0.226, 0.167, 0.155]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.109, 0.103, 0.084], 'all_L1': [0.132, 0.197, 0.205, 0.177]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.695 +- 0.070, 0.702 +- 0.052, 0.811 +- 0.050, 1.000 +- 0.000
suff++ class all_KL  =  0.783 +- 0.093, 0.790 +- 0.078, 0.901 +- 0.040, 1.000 +- 0.000
suff++_acc_int  =  0.605 +- 0.056, 0.669 +- 0.053, 0.747 +- 0.039
nec class all_L1  =  0.215 +- 0.056, 0.203 +- 0.035, 0.162 +- 0.039, 0.144 +- 0.040
nec class all_KL  =  0.113 +- 0.049, 0.106 +- 0.037, 0.076 +- 0.030, 0.064 +- 0.027
nec_acc_int  =  0.625 +- 0.043, 0.726 +- 0.025, 0.760 +- 0.034, 0.769 +- 0.038


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.455 +- 0.015, 0.453 +- 0.014, 0.486 +- 0.006, 0.572 +- 0.020
Faith. Armon (L1)= 		  =  0.321 +- 0.061, 0.311 +- 0.041, 0.266 +- 0.055, 0.249 +- 0.063
Faith. GMean (L1)= 	  =  0.380 +- 0.037, 0.374 +- 0.025, 0.357 +- 0.038, 0.375 +- 0.057
Faith. Aritm (KL)= 		  =  0.448 +- 0.025, 0.448 +- 0.022, 0.489 +- 0.006, 0.532 +- 0.013
Faith. Armon (KL)= 		  =  0.192 +- 0.071, 0.183 +- 0.055, 0.139 +- 0.051, 0.119 +- 0.048
Faith. GMean (KL)= 	  =  0.286 +- 0.052, 0.281 +- 0.040, 0.255 +- 0.050, 0.246 +- 0.058
Computed for split load_split = id



Completed in  0:15:47.090967  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:00:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 07:00:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 07:00:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 07:00:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:01:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1597
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2366
ID Test ROC-AUC: 0.9233
ID Test Loss: 0.2412
OOD Validation ROC-AUC: 0.6572
OOD Validation Loss: 0.3846
OOD Test ROC-AUC: 0.6967
OOD Test Loss: 0.5574

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ROC-AUC: 0.8713
Train Loss: 0.2869
ID Validation ROC-AUC: 0.8665
ID Validation Loss: 0.2911
ID Test ROC-AUC: 0.8695
ID Test Loss: 0.2927
OOD Validation ROC-AUC: 0.6861
OOD Validation Loss: 0.2792
OOD Test ROC-AUC: 0.7034
OOD Test Loss: 0.4207

[0m[1;37mINFO[0m: [1mChartInfo 0.9233 0.6967 0.8695 0.7034 0.8665 0.6861[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 07:01:37 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.601
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.556
SUFF++ for r=0.6 class 0.0 = 0.831 +- 0.047 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 class 1.0 = 0.861 +- 0.047 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 all KL = 0.952 +- 0.047 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 all L1 = 0.858 +- 0.074 (in-sample avg dev_std = 0.141)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.601
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.61
NEC for r=0.6 class 0.0 = 0.118 +- 0.026 (in-sample avg dev_std = 0.086)
NEC for r=0.6 class 1.0 = 0.089 +- 0.026 (in-sample avg dev_std = 0.086)
NEC for r=0.6 all KL = 0.019 +- 0.026 (in-sample avg dev_std = 0.086)
NEC for r=0.6 all L1 = 0.092 +- 0.066 (in-sample avg dev_std = 0.086)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:02:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 07:02:14 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 07:02:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 07:02:58 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:09 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:03:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.9829
Train Loss: 0.1261
ID Validation ROC-AUC: 0.9196
ID Validation Loss: 0.2917
ID Test ROC-AUC: 0.9170
ID Test Loss: 0.3056
OOD Validation ROC-AUC: 0.6433
OOD Validation Loss: 0.4965
OOD Test ROC-AUC: 0.6785
OOD Test Loss: 0.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8825
Train Loss: 0.2710
ID Validation ROC-AUC: 0.8746
ID Validation Loss: 0.2831
ID Test ROC-AUC: 0.8768
ID Test Loss: 0.2841
OOD Validation ROC-AUC: 0.6840
OOD Validation Loss: 0.3139
OOD Test ROC-AUC: 0.7101
OOD Test Loss: 0.4991

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.6785 0.8768 0.7101 0.8746 0.6840[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 07:03:43 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.625
SUFF++ for r=0.6 class 0.0 = 0.698 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.823 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.844 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.808 +- 0.166 (in-sample avg dev_std = 0.253)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.7
NEC for r=0.6 class 0.0 = 0.268 +- 0.135 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 1.0 = 0.16 +- 0.135 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all KL = 0.112 +- 0.135 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all L1 = 0.172 +- 0.177 (in-sample avg dev_std = 0.170)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:04:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 07:04:19 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 07:04:53 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:04 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:33 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:05:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9540
Train Loss: 0.1749
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2164
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2244
OOD Validation ROC-AUC: 0.6596
OOD Validation Loss: 0.3480
OOD Test ROC-AUC: 0.6987
OOD Test Loss: 0.4931

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8972
Train Loss: 0.2438
ID Validation ROC-AUC: 0.8845
ID Validation Loss: 0.2539
ID Test ROC-AUC: 0.8865
ID Test Loss: 0.2549
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2839
OOD Test ROC-AUC: 0.7162
OOD Test Loss: 0.4332

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.6987 0.8865 0.7162 0.8845 0.6935[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 07:05:50 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.643
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.587
SUFF++ for r=0.6 class 0.0 = 0.886 +- 0.024 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.6 class 1.0 = 0.884 +- 0.024 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.6 all KL = 0.983 +- 0.024 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.6 all L1 = 0.884 +- 0.047 (in-sample avg dev_std = 0.104)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.643
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.608
NEC for r=0.6 class 0.0 = 0.063 +- 0.016 (in-sample avg dev_std = 0.058)
NEC for r=0.6 class 1.0 = 0.065 +- 0.016 (in-sample avg dev_std = 0.058)
NEC for r=0.6 all KL = 0.006 +- 0.016 (in-sample avg dev_std = 0.058)
NEC for r=0.6 all L1 = 0.065 +- 0.034 (in-sample avg dev_std = 0.058)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:06:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 07:06:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:00 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:10 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 31...
[0m[1;37mINFO[0m: [1mCheckpoint 31: 
-----------------------------------
Train ROC-AUC: 0.9785
Train Loss: 0.1297
ID Validation ROC-AUC: 0.9231
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9232
ID Test Loss: 0.2591
OOD Validation ROC-AUC: 0.6355
OOD Validation Loss: 0.4365
OOD Test ROC-AUC: 0.6820
OOD Test Loss: 0.6119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.2539
ID Validation ROC-AUC: 0.8928
ID Validation Loss: 0.2745
ID Test ROC-AUC: 0.8905
ID Test Loss: 0.2822
OOD Validation ROC-AUC: 0.6800
OOD Validation Loss: 0.3263
OOD Test ROC-AUC: 0.7103
OOD Test Loss: 0.5223

[0m[1;37mINFO[0m: [1mChartInfo 0.9232 0.6820 0.8905 0.7103 0.8928 0.6800[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 07:07:55 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.617
SUFF++ for r=0.6 class 0.0 = 0.697 +- 0.206 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.6 class 1.0 = 0.682 +- 0.206 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.6 all KL = 0.809 +- 0.206 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.6 all L1 = 0.684 +- 0.157 (in-sample avg dev_std = 0.326)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.598
NEC for r=0.6 class 0.0 = 0.169 +- 0.138 (in-sample avg dev_std = 0.211)
NEC for r=0.6 class 1.0 = 0.203 +- 0.138 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all KL = 0.088 +- 0.138 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all L1 = 0.199 +- 0.140 (in-sample avg dev_std = 0.211)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:08:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/14/2024 07:08:32 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/14/2024 07:09:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/14/2024 07:09:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/14/2024 07:09:28 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/14/2024 07:09:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9685
Train Loss: 0.1653
ID Validation ROC-AUC: 0.9224
ID Validation Loss: 0.2315
ID Test ROC-AUC: 0.9196
ID Test Loss: 0.2391
OOD Validation ROC-AUC: 0.6434
OOD Validation Loss: 0.3691
OOD Test ROC-AUC: 0.6778
OOD Test Loss: 0.5284

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8955
Train Loss: 0.2439
ID Validation ROC-AUC: 0.8855
ID Validation Loss: 0.2541
ID Test ROC-AUC: 0.8869
ID Test Loss: 0.2554
OOD Validation ROC-AUC: 0.6944
OOD Validation Loss: 0.2933
OOD Test ROC-AUC: 0.7180
OOD Test Loss: 0.4561

[0m[1;37mINFO[0m: [1mChartInfo 0.9196 0.6778 0.8869 0.7180 0.8855 0.6944[0mLBAPcore(34179)
Data example from train: Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
Label distribution from train: (tensor([0., 1.]), tensor([ 3960, 30219]))
[1;34mDEBUG[0m: 04/14/2024 07:10:01 PM : [1mUnbalanced warning for LBAPcore (train)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.347
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.439
SUFF++ for r=0.6 class 0.0 = 0.892 +- 0.010 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.6 class 1.0 = 0.915 +- 0.010 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.6 all KL = 0.992 +- 0.010 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.6 all L1 = 0.913 +- 0.044 (in-sample avg dev_std = 0.074)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.347
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.333
NEC for r=0.6 class 0.0 = 0.05 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.6 class 1.0 = 0.042 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all KL = 0.002 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all L1 = 0.043 +- 0.023 (in-sample avg dev_std = 0.034)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.952], 'all_L1': [0.858]}), defaultdict(<class 'list'>, {'all_KL': [0.844], 'all_L1': [0.808]}), defaultdict(<class 'list'>, {'all_KL': [0.983], 'all_L1': [0.884]}), defaultdict(<class 'list'>, {'all_KL': [0.809], 'all_L1': [0.684]}), defaultdict(<class 'list'>, {'all_KL': [0.992], 'all_L1': [0.913]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.019], 'all_L1': [0.092]}), defaultdict(<class 'list'>, {'all_KL': [0.112], 'all_L1': [0.172]}), defaultdict(<class 'list'>, {'all_KL': [0.006], 'all_L1': [0.065]}), defaultdict(<class 'list'>, {'all_KL': [0.088], 'all_L1': [0.199]}), defaultdict(<class 'list'>, {'all_KL': [0.002], 'all_L1': [0.043]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.829 +- 0.080
suff++ class all_KL  =  0.916 +- 0.075
suff++_acc_int  =  0.565 +- 0.067
nec class all_L1  =  0.114 +- 0.061
nec class all_KL  =  0.045 +- 0.046
nec_acc_int  =  0.570 +- 0.124


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.472 +- 0.016
Faith. Armon (L1)= 		  =  0.192 +- 0.089
Faith. GMean (L1)= 	  =  0.292 +- 0.069
Faith. Aritm (KL)= 		  =  0.481 +- 0.017
Faith. Armon (KL)= 		  =  0.082 +- 0.080
Faith. GMean (KL)= 	  =  0.166 +- 0.104
Computed for split load_split = id



Completed in  0:10:32.016142  for CIGAvGIN LBAPcore/assay



DONE CIGA LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:10:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:10:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9513
Train Loss: 0.1416
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3406
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3538
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.8665
OOD Test ACCURACY: 0.2856
OOD Test Loss: 5.0562

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.8921
Train Loss: 0.3223
ID Validation ACCURACY: 0.8611
ID Validation Loss: 0.4189
ID Test ACCURACY: 0.8610
ID Test Loss: 0.4250
OOD Validation ACCURACY: 0.8180
OOD Validation Loss: 0.5733
OOD Test ACCURACY: 0.3071
OOD Test Loss: 3.0050

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.2856 0.8610 0.3071 0.8611 0.8180[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.76 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 1 = 0.907 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 2 = 0.734 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 3 = 0.857 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 4 = 0.697 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 5 = 0.778 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 6 = 0.748 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 7 = 0.663 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 8 = 0.848 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 class 9 = 0.749 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 all KL = 0.78 +- 0.282 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.3 all L1 = 0.775 +- 0.254 (in-sample avg dev_std = 0.270)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.115
SUFF++ for r=0.6 class 0 = 0.309 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 1 = 0.5 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 2 = 0.373 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 3 = 0.371 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 4 = 0.367 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 5 = 0.349 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 6 = 0.327 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 7 = 0.362 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 8 = 0.31 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 9 = 0.34 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 all KL = 0.274 +- 0.215 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 all L1 = 0.363 +- 0.147 (in-sample avg dev_std = 0.492)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.365
SUFF++ for r=0.9 class 0 = 0.275 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 1 = 0.299 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 2 = 0.329 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 3 = 0.318 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 4 = 0.355 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 5 = 0.297 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 6 = 0.333 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 7 = 0.71 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 8 = 0.335 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 class 9 = 0.351 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 all KL = 0.162 +- 0.213 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.9 all L1 = 0.362 +- 0.170 (in-sample avg dev_std = 0.648)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.304 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 1 = 0.114 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 2 = 0.282 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 3 = 0.204 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 4 = 0.255 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 5 = 0.26 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 6 = 0.27 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 7 = 0.367 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 8 = 0.202 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 9 = 0.239 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all KL = 0.254 +- 0.307 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all L1 = 0.248 +- 0.259 (in-sample avg dev_std = 0.306)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.13
NEC for r=0.6 class 0 = 0.621 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 1 = 0.372 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 2 = 0.538 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 3 = 0.565 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 4 = 0.552 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 5 = 0.586 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 6 = 0.62 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 7 = 0.541 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 8 = 0.626 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 9 = 0.583 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all KL = 0.591 +- 0.268 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all L1 = 0.557 +- 0.194 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.616
NEC for r=0.9 class 0 = 0.545 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 1 = 0.506 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 2 = 0.41 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 3 = 0.455 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 4 = 0.467 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 5 = 0.538 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 6 = 0.51 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 7 = 0.224 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 8 = 0.405 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 9 = 0.594 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all KL = 0.577 +- 0.282 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all L1 = 0.464 +- 0.232 (in-sample avg dev_std = 0.448)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.831
NEC for r=1.0 class 0 = 0.11 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 1 = 0.081 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 2 = 0.306 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 3 = 0.341 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 4 = 0.193 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 5 = 0.346 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 6 = 0.289 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 7 = 0.144 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 8 = 0.235 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 9 = 0.38 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 all KL = 0.313 +- 0.293 (in-sample avg dev_std = 0.339)
NEC for r=1.0 all L1 = 0.239 +- 0.233 (in-sample avg dev_std = 0.339)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:20:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:20:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:20:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ACCURACY: 0.9519
Train Loss: 0.1382
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3621
ID Test ACCURACY: 0.8871
ID Test Loss: 0.3798
OOD Validation ACCURACY: 0.7449
OOD Validation Loss: 1.1037
OOD Test ACCURACY: 0.3044
OOD Test Loss: 5.2755

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.9417
Train Loss: 0.1662
ID Validation ACCURACY: 0.8909
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8841
ID Test Loss: 0.3721
OOD Validation ACCURACY: 0.8134
OOD Validation Loss: 0.6389
OOD Test ACCURACY: 0.4137
OOD Test Loss: 2.6973

[0m[1;37mINFO[0m: [1mChartInfo 0.8871 0.3044 0.8841 0.4137 0.8909 0.8134[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.36 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1 = 0.482 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 2 = 0.513 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 3 = 0.541 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 4 = 0.556 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 5 = 0.535 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 6 = 0.56 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 7 = 0.61 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 8 = 0.457 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 9 = 0.575 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.456 +- 0.303 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.519 +- 0.239 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.125
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.116
SUFF++ for r=0.6 class 0 = 0.23 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 1 = 0.372 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 2 = 0.304 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 3 = 0.324 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 4 = 0.291 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 5 = 0.291 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 6 = 0.257 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 7 = 0.305 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 8 = 0.275 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 9 = 0.288 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all KL = 0.18 +- 0.184 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all L1 = 0.295 +- 0.135 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.776
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF++ for r=0.9 class 0 = 0.288 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 1 = 0.358 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 2 = 0.304 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 3 = 0.375 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 4 = 0.313 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 5 = 0.327 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 6 = 0.282 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 7 = 0.531 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 8 = 0.334 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 class 9 = 0.309 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 all KL = 0.102 +- 0.178 (in-sample avg dev_std = 0.702)
SUFF++ for r=0.9 all L1 = 0.343 +- 0.141 (in-sample avg dev_std = 0.702)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.68 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 1 = 0.488 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 2 = 0.597 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 3 = 0.56 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 4 = 0.533 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 5 = 0.575 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 6 = 0.452 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 7 = 0.511 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 8 = 0.627 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 9 = 0.48 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all KL = 0.641 +- 0.293 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all L1 = 0.549 +- 0.232 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.125
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.716 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.611 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.619 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 3 = 0.645 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 4 = 0.643 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 5 = 0.661 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 6 = 0.688 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 7 = 0.655 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 8 = 0.694 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 9 = 0.642 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.761 +- 0.203 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.657 +- 0.143 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.776
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.656
NEC for r=0.9 class 0 = 0.502 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 1 = 0.188 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 2 = 0.477 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 3 = 0.421 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 4 = 0.459 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 5 = 0.383 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 6 = 0.492 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 7 = 0.442 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 8 = 0.382 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 9 = 0.627 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all KL = 0.56 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all L1 = 0.435 +- 0.253 (in-sample avg dev_std = 0.442)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.843
NEC for r=1.0 class 0 = 0.155 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 1 = 0.037 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 2 = 0.292 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 3 = 0.324 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 4 = 0.209 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 5 = 0.217 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 6 = 0.228 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 7 = 0.239 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 8 = 0.178 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 9 = 0.339 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all KL = 0.301 +- 0.298 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all L1 = 0.22 +- 0.229 (in-sample avg dev_std = 0.342)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:30:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:30:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9534
Train Loss: 0.1343
ID Validation ACCURACY: 0.8954
ID Validation Loss: 0.3620
ID Test ACCURACY: 0.8914
ID Test Loss: 0.3791
OOD Validation ACCURACY: 0.7987
OOD Validation Loss: 0.7966
OOD Test ACCURACY: 0.2186
OOD Test Loss: 11.4348

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9452
Train Loss: 0.1585
ID Validation ACCURACY: 0.8876
ID Validation Loss: 0.3718
ID Test ACCURACY: 0.8883
ID Test Loss: 0.3697
OOD Validation ACCURACY: 0.8087
OOD Validation Loss: 0.7290
OOD Test ACCURACY: 0.2657
OOD Test Loss: 10.3527

[0m[1;37mINFO[0m: [1mChartInfo 0.8914 0.2186 0.8883 0.2657 0.8876 0.8087[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.547 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 1 = 0.774 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 2 = 0.517 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 3 = 0.603 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 4 = 0.703 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 5 = 0.54 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 6 = 0.662 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 7 = 0.705 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 8 = 0.538 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 9 = 0.667 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all KL = 0.629 +- 0.288 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all L1 = 0.629 +- 0.242 (in-sample avg dev_std = 0.324)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.154
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.117
SUFF++ for r=0.6 class 0 = 0.318 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.301 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.286 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 3 = 0.292 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 4 = 0.31 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 5 = 0.282 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 6 = 0.309 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 7 = 0.328 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 8 = 0.269 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 9 = 0.303 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.22 +- 0.165 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.3 +- 0.094 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.769
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.373
SUFF++ for r=0.9 class 0 = 0.268 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 1 = 0.325 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 2 = 0.391 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 3 = 0.327 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 4 = 0.342 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 5 = 0.315 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 6 = 0.295 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 7 = 0.352 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 8 = 0.309 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 class 9 = 0.409 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 all KL = 0.095 +- 0.137 (in-sample avg dev_std = 0.685)
SUFF++ for r=0.9 all L1 = 0.334 +- 0.118 (in-sample avg dev_std = 0.685)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
NEC for r=0.3 class 0 = 0.617 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 1 = 0.226 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 2 = 0.513 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 3 = 0.515 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 4 = 0.345 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 5 = 0.521 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 6 = 0.377 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 7 = 0.346 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 8 = 0.494 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 9 = 0.396 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all KL = 0.474 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all L1 = 0.431 +- 0.245 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.154
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
NEC for r=0.6 class 0 = 0.626 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 1 = 0.692 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 2 = 0.61 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 3 = 0.634 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 4 = 0.6 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 5 = 0.604 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 6 = 0.639 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 7 = 0.617 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 8 = 0.64 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 9 = 0.618 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 all KL = 0.684 +- 0.219 (in-sample avg dev_std = 0.382)
NEC for r=0.6 all L1 = 0.629 +- 0.136 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.769
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.641
NEC for r=0.9 class 0 = 0.473 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 1 = 0.319 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 2 = 0.367 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 3 = 0.512 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 4 = 0.471 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 5 = 0.514 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 6 = 0.49 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 7 = 0.345 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 8 = 0.399 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 9 = 0.556 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all KL = 0.57 +- 0.295 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all L1 = 0.442 +- 0.240 (in-sample avg dev_std = 0.448)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.834
NEC for r=1.0 class 0 = 0.102 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 1 = 0.063 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 2 = 0.268 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 3 = 0.378 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 4 = 0.209 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 5 = 0.342 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 6 = 0.227 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 7 = 0.138 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 8 = 0.24 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 class 9 = 0.367 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 all KL = 0.321 +- 0.311 (in-sample avg dev_std = 0.354)
NEC for r=1.0 all L1 = 0.23 +- 0.240 (in-sample avg dev_std = 0.354)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:40:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:40:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9613
Train Loss: 0.1134
ID Validation ACCURACY: 0.8956
ID Validation Loss: 0.3556
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3603
OOD Validation ACCURACY: 0.7163
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.1731
OOD Test Loss: 12.4917

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.9177
Train Loss: 0.2366
ID Validation ACCURACY: 0.8739
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.8733
ID Test Loss: 0.3982
OOD Validation ACCURACY: 0.7943
OOD Validation Loss: 0.6922
OOD Test ACCURACY: 0.3307
OOD Test Loss: 3.3639

[0m[1;37mINFO[0m: [1mChartInfo 0.8920 0.1731 0.8733 0.3307 0.8739 0.7943[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.462 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 1 = 0.33 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 2 = 0.43 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 3 = 0.402 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 4 = 0.39 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 5 = 0.426 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 6 = 0.423 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 7 = 0.417 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 8 = 0.444 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 9 = 0.406 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all KL = 0.315 +- 0.210 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all L1 = 0.412 +- 0.127 (in-sample avg dev_std = 0.479)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.139
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.11
SUFF++ for r=0.6 class 0 = 0.451 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.289 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.51 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 3 = 0.517 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 4 = 0.42 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 5 = 0.474 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 6 = 0.419 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 7 = 0.461 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 8 = 0.538 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 9 = 0.479 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.367 +- 0.228 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.453 +- 0.172 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.752
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.369
SUFF++ for r=0.9 class 0 = 0.277 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 1 = 0.303 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 2 = 0.499 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 3 = 0.33 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 4 = 0.316 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 5 = 0.306 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 6 = 0.406 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 7 = 0.513 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 8 = 0.319 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 class 9 = 0.383 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 all KL = 0.152 +- 0.180 (in-sample avg dev_std = 0.622)
SUFF++ for r=0.9 all L1 = 0.366 +- 0.154 (in-sample avg dev_std = 0.622)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
NEC for r=0.3 class 0 = 0.548 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 1 = 0.574 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 2 = 0.595 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 3 = 0.62 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 4 = 0.597 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 5 = 0.635 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 6 = 0.628 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 7 = 0.587 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 8 = 0.59 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 9 = 0.626 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 all KL = 0.677 +- 0.247 (in-sample avg dev_std = 0.466)
NEC for r=0.3 all L1 = 0.599 +- 0.162 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.139
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.524 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 1 = 0.648 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 2 = 0.474 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 3 = 0.456 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 4 = 0.546 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 5 = 0.526 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 6 = 0.566 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 7 = 0.539 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 8 = 0.428 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 9 = 0.504 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all KL = 0.566 +- 0.262 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all L1 = 0.523 +- 0.193 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.752
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.594
NEC for r=0.9 class 0 = 0.513 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 1 = 0.558 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 2 = 0.295 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 3 = 0.491 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 4 = 0.523 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 5 = 0.547 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 6 = 0.411 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 7 = 0.417 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 8 = 0.348 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 9 = 0.55 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 all KL = 0.589 +- 0.289 (in-sample avg dev_std = 0.470)
NEC for r=0.9 all L1 = 0.466 +- 0.233 (in-sample avg dev_std = 0.470)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.94
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.832
NEC for r=1.0 class 0 = 0.095 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 1 = 0.071 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 2 = 0.219 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 3 = 0.305 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 4 = 0.308 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 5 = 0.362 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 6 = 0.227 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 7 = 0.231 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 8 = 0.209 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 9 = 0.319 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 all KL = 0.324 +- 0.307 (in-sample avg dev_std = 0.349)
NEC for r=1.0 all L1 = 0.232 +- 0.236 (in-sample avg dev_std = 0.349)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 19:50:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 07:50:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9609
Train Loss: 0.1130
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3439
ID Test ACCURACY: 0.8937
ID Test Loss: 0.3554
OOD Validation ACCURACY: 0.7863
OOD Validation Loss: 0.8914
OOD Test ACCURACY: 0.2307
OOD Test Loss: 10.8940

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.9328
Train Loss: 0.1957
ID Validation ACCURACY: 0.8821
ID Validation Loss: 0.3581
ID Test ACCURACY: 0.8791
ID Test Loss: 0.3593
OOD Validation ACCURACY: 0.8147
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.3769
OOD Test Loss: 3.0655

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.2307 0.8791 0.3769 0.8821 0.8147[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.358 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 1 = 0.482 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 2 = 0.423 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 3 = 0.427 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 4 = 0.44 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 5 = 0.498 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 6 = 0.449 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 7 = 0.464 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 8 = 0.377 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 9 = 0.414 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all KL = 0.411 +- 0.262 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all L1 = 0.434 +- 0.158 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.177
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.135
SUFF++ for r=0.6 class 0 = 0.26 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 1 = 0.375 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 2 = 0.293 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 3 = 0.3 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 4 = 0.271 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 5 = 0.288 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 6 = 0.268 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 7 = 0.327 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 8 = 0.262 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 9 = 0.279 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all KL = 0.174 +- 0.167 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all L1 = 0.294 +- 0.094 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.41
SUFF++ for r=0.9 class 0 = 0.279 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 1 = 0.443 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 2 = 0.39 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 3 = 0.323 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 4 = 0.305 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 5 = 0.305 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 6 = 0.369 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 7 = 0.529 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 8 = 0.306 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 class 9 = 0.359 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 all KL = 0.123 +- 0.161 (in-sample avg dev_std = 0.653)
SUFF++ for r=0.9 all L1 = 0.363 +- 0.148 (in-sample avg dev_std = 0.653)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.645 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 1 = 0.436 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 2 = 0.561 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 3 = 0.582 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 4 = 0.556 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 5 = 0.52 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 6 = 0.571 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 7 = 0.521 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 8 = 0.64 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 9 = 0.544 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all KL = 0.573 +- 0.291 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all L1 = 0.556 +- 0.197 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.177
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.146
NEC for r=0.6 class 0 = 0.655 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 1 = 0.548 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 2 = 0.589 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 3 = 0.604 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 4 = 0.649 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 5 = 0.631 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 6 = 0.648 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 7 = 0.591 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 8 = 0.649 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 class 9 = 0.618 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 all KL = 0.68 +- 0.223 (in-sample avg dev_std = 0.408)
NEC for r=0.6 all L1 = 0.617 +- 0.142 (in-sample avg dev_std = 0.408)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.52 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 1 = 0.277 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 2 = 0.326 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 3 = 0.46 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 4 = 0.464 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 5 = 0.529 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 6 = 0.487 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 7 = 0.321 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 8 = 0.413 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 class 9 = 0.62 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 all KL = 0.559 +- 0.298 (in-sample avg dev_std = 0.439)
NEC for r=0.9 all L1 = 0.438 +- 0.244 (in-sample avg dev_std = 0.439)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.837
NEC for r=1.0 class 0 = 0.171 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 1 = 0.052 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 2 = 0.199 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 3 = 0.304 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 4 = 0.198 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 5 = 0.356 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 6 = 0.248 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 7 = 0.185 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 8 = 0.251 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 9 = 0.352 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all KL = 0.316 +- 0.303 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all L1 = 0.228 +- 0.234 (in-sample avg dev_std = 0.342)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.78, 0.274, 0.162, 1.0], 'all_L1': [0.775, 0.363, 0.362, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.18, 0.102, 1.0], 'all_L1': [0.519, 0.295, 0.343, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.629, 0.22, 0.095, 1.0], 'all_L1': [0.629, 0.3, 0.334, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.367, 0.152, 1.0], 'all_L1': [0.412, 0.453, 0.366, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.411, 0.174, 0.123, 1.0], 'all_L1': [0.434, 0.294, 0.363, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.254, 0.591, 0.577, 0.313], 'all_L1': [0.248, 0.557, 0.464, 0.239]}), defaultdict(<class 'list'>, {'all_KL': [0.641, 0.761, 0.56, 0.301], 'all_L1': [0.549, 0.657, 0.435, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.684, 0.57, 0.321], 'all_L1': [0.431, 0.629, 0.442, 0.23]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.566, 0.589, 0.324], 'all_L1': [0.599, 0.523, 0.466, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.68, 0.559, 0.316], 'all_L1': [0.556, 0.617, 0.438, 0.228]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.554 +- 0.134, 0.341 +- 0.062, 0.354 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.518 +- 0.166, 0.243 +- 0.072, 0.127 +- 0.027, 1.000 +- 0.000
suff++_acc_int  =  0.103 +- 0.003, 0.119 +- 0.008, 0.378 +- 0.016
nec class all_L1  =  0.477 +- 0.127, 0.597 +- 0.049, 0.449 +- 0.013, 0.230 +- 0.006
nec class all_KL  =  0.524 +- 0.152, 0.656 +- 0.070, 0.571 +- 0.011, 0.315 +- 0.008
nec_acc_int  =  0.106 +- 0.006, 0.128 +- 0.010, 0.629 +- 0.022, 0.835 +- 0.005


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.515 +- 0.015, 0.469 +- 0.012, 0.401 +- 0.012, 0.615 +- 0.003
Faith. Armon (L1)= 		  =  0.479 +- 0.054, 0.427 +- 0.032, 0.396 +- 0.012, 0.374 +- 0.008
Faith. GMean (L1)= 	  =  0.496 +- 0.033, 0.447 +- 0.021, 0.398 +- 0.012, 0.479 +- 0.006
Faith. Aritm (KL)= 		  =  0.521 +- 0.025, 0.450 +- 0.018, 0.349 +- 0.018, 0.657 +- 0.004
Faith. Armon (KL)= 		  =  0.473 +- 0.060, 0.344 +- 0.061, 0.206 +- 0.036, 0.479 +- 0.009
Faith. GMean (KL)= 	  =  0.496 +- 0.041, 0.392 +- 0.037, 0.268 +- 0.030, 0.561 +- 0.007
Computed for split load_split = id



Completed in  0:49:56.478876  for GSATvGIN GOODCMNIST/color



DONE GSAT GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 20:01:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:01:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.3715
Train Loss: 2.7499
ID Validation ACCURACY: 0.3654
ID Validation Loss: 2.7861
ID Test ACCURACY: 0.3729
ID Test Loss: 2.7814
OOD Validation ACCURACY: 0.3491
OOD Validation Loss: 3.1257
OOD Test ACCURACY: 0.2690
OOD Test Loss: 4.6794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.3198
Train Loss: 3.3902
ID Validation ACCURACY: 0.3150
ID Validation Loss: 3.4229
ID Test ACCURACY: 0.3230
ID Test Loss: 3.4163
OOD Validation ACCURACY: 0.3611
OOD Validation Loss: 3.3370
OOD Test ACCURACY: 0.2419
OOD Test Loss: 7.8889

[0m[1;37mINFO[0m: [1mChartInfo 0.3729 0.2690 0.3230 0.2419 0.3150 0.3611[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.349
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.207
SUFF++ for r=0.6 class 0 = 0.336 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 1 = 0.469 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 2 = 0.294 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 3 = 0.295 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 4 = 0.425 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 5 = 0.329 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 6 = 0.344 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 7 = 0.379 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 8 = 0.334 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 class 9 = 0.448 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 all KL = 0.227 +- 0.231 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.6 all L1 = 0.367 +- 0.135 (in-sample avg dev_std = 0.584)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.349
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.263
NEC for r=0.6 class 0 = 0.238 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 1 = 0.586 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 2 = 0.541 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 3 = 0.538 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 4 = 0.444 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 5 = 0.576 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 6 = 0.522 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 7 = 0.524 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 8 = 0.532 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 class 9 = 0.349 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 all KL = 0.439 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.6 all L1 = 0.486 +- 0.216 (in-sample avg dev_std = 0.261)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 20:03:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:03:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.7181
Train Loss: 0.8746
ID Validation ACCURACY: 0.6574
ID Validation Loss: 1.2188
ID Test ACCURACY: 0.6584
ID Test Loss: 1.2023
OOD Validation ACCURACY: 0.4703
OOD Validation Loss: 2.8402
OOD Test ACCURACY: 0.1883
OOD Test Loss: 15.9927

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.6624
Train Loss: 1.0155
ID Validation ACCURACY: 0.6256
ID Validation Loss: 1.1994
ID Test ACCURACY: 0.6141
ID Test Loss: 1.2223
OOD Validation ACCURACY: 0.5277
OOD Validation Loss: 1.8377
OOD Test ACCURACY: 0.2083
OOD Test Loss: 11.1952

[0m[1;37mINFO[0m: [1mChartInfo 0.6584 0.1883 0.6141 0.2083 0.6256 0.5277[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.209
SUFF++ for r=0.6 class 0 = 0.229 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 1 = 0.339 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 2 = 0.23 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 3 = 0.198 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 4 = 0.237 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 5 = 0.237 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 6 = 0.2 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 7 = 0.26 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 8 = 0.207 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 9 = 0.268 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 all KL = 0.032 +- 0.070 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 all L1 = 0.242 +- 0.097 (in-sample avg dev_std = 0.592)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.418
NEC for r=0.6 class 0 = 0.671 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.298 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.568 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 3 = 0.585 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 4 = 0.539 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 5 = 0.597 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 6 = 0.665 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 7 = 0.634 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 8 = 0.515 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 9 = 0.634 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.701 +- 0.252 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.567 +- 0.206 (in-sample avg dev_std = 0.451)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 20:06:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:06:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ACCURACY: 0.4452
Train Loss: 1.8491
ID Validation ACCURACY: 0.4349
ID Validation Loss: 1.9176
ID Test ACCURACY: 0.4390
ID Test Loss: 1.8691
OOD Validation ACCURACY: 0.3544
OOD Validation Loss: 2.4861
OOD Test ACCURACY: 0.2210
OOD Test Loss: 3.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.4067
Train Loss: 2.3142
ID Validation ACCURACY: 0.3957
ID Validation Loss: 2.4284
ID Test ACCURACY: 0.4073
ID Test Loss: 2.3439
OOD Validation ACCURACY: 0.3826
OOD Validation Loss: 2.4420
OOD Test ACCURACY: 0.2560
OOD Test Loss: 4.6004

[0m[1;37mINFO[0m: [1mChartInfo 0.4390 0.2210 0.4073 0.2560 0.3957 0.3826[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.439
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.181
SUFF++ for r=0.6 class 0 = 0.242 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 1 = 0.432 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 2 = 0.227 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 3 = 0.249 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 4 = 0.223 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 5 = 0.235 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 6 = 0.243 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 7 = 0.231 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 8 = 0.223 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 9 = 0.23 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 all KL = 0.071 +- 0.143 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 all L1 = 0.256 +- 0.103 (in-sample avg dev_std = 0.513)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.439
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.34
NEC for r=0.6 class 0 = 0.203 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 1 = 0.5 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 2 = 0.502 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 3 = 0.5 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 4 = 0.439 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 5 = 0.501 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 6 = 0.522 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 7 = 0.53 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 8 = 0.474 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 9 = 0.373 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all KL = 0.367 +- 0.219 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all L1 = 0.455 +- 0.187 (in-sample avg dev_std = 0.270)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 20:09:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:09:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.6588
Train Loss: 0.9911
ID Validation ACCURACY: 0.6276
ID Validation Loss: 1.1178
ID Test ACCURACY: 0.6277
ID Test Loss: 1.1142
OOD Validation ACCURACY: 0.4983
OOD Validation Loss: 1.7285
OOD Test ACCURACY: 0.2486
OOD Test Loss: 4.9047

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5989
Train Loss: 1.1783
ID Validation ACCURACY: 0.5699
ID Validation Loss: 1.3077
ID Test ACCURACY: 0.5776
ID Test Loss: 1.2851
OOD Validation ACCURACY: 0.5351
OOD Validation Loss: 1.4928
OOD Test ACCURACY: 0.2547
OOD Test Loss: 5.2471

[0m[1;37mINFO[0m: [1mChartInfo 0.6277 0.2486 0.5776 0.2547 0.5699 0.5351[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.611
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.227
SUFF++ for r=0.6 class 0 = 0.277 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 1 = 0.77 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 2 = 0.223 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 3 = 0.213 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 4 = 0.245 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 5 = 0.222 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 6 = 0.208 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 7 = 0.218 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 8 = 0.233 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 class 9 = 0.244 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 all KL = 0.1 +- 0.214 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.6 all L1 = 0.292 +- 0.195 (in-sample avg dev_std = 0.554)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.611
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.398
NEC for r=0.6 class 0 = 0.61 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 1 = 0.133 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 2 = 0.5 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 3 = 0.544 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 4 = 0.513 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 5 = 0.55 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 6 = 0.662 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 7 = 0.611 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 8 = 0.552 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 9 = 0.607 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all KL = 0.54 +- 0.268 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all L1 = 0.523 +- 0.206 (in-sample avg dev_std = 0.331)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 20:11:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:41 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit Backbone:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mCreating vGINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit CLF:  5
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 08:11:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.4206
Train Loss: 1.8923
ID Validation ACCURACY: 0.4203
ID Validation Loss: 1.9484
ID Test ACCURACY: 0.4191
ID Test Loss: 1.8983
OOD Validation ACCURACY: 0.3490
OOD Validation Loss: 2.3843
OOD Test ACCURACY: 0.2689
OOD Test Loss: 2.7813

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.4088
Train Loss: 1.8664
ID Validation ACCURACY: 0.4009
ID Validation Loss: 1.9187
ID Test ACCURACY: 0.4040
ID Test Loss: 1.9019
OOD Validation ACCURACY: 0.3840
OOD Validation Loss: 2.1207
OOD Test ACCURACY: 0.2513
OOD Test Loss: 3.0490

[0m[1;37mINFO[0m: [1mChartInfo 0.4191 0.2689 0.4040 0.2513 0.4009 0.3840[0mGOODCMNIST(42000)
Data example from train: Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
Label distribution from train: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([4156, 4700, 4167, 4257, 4108, 3835, 4128, 4339, 4085, 4225]))
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.415
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.23
SUFF++ for r=0.6 class 0 = 0.325 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 1 = 0.593 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 2 = 0.274 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 3 = 0.309 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 4 = 0.284 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 5 = 0.286 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 6 = 0.271 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 7 = 0.314 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 8 = 0.299 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 9 = 0.285 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 all KL = 0.193 +- 0.208 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 all L1 = 0.328 +- 0.137 (in-sample avg dev_std = 0.574)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.415
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.221 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 1 = 0.306 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 2 = 0.459 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 3 = 0.445 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 4 = 0.379 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 5 = 0.502 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 6 = 0.51 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 7 = 0.472 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 8 = 0.437 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 9 = 0.439 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 all KL = 0.302 +- 0.195 (in-sample avg dev_std = 0.234)
NEC for r=0.6 all L1 = 0.415 +- 0.175 (in-sample avg dev_std = 0.234)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.227], 'all_L1': [0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.032], 'all_L1': [0.242]}), defaultdict(<class 'list'>, {'all_KL': [0.071], 'all_L1': [0.256]}), defaultdict(<class 'list'>, {'all_KL': [0.1], 'all_L1': [0.292]}), defaultdict(<class 'list'>, {'all_KL': [0.193], 'all_L1': [0.328]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.439], 'all_L1': [0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.701], 'all_L1': [0.567]}), defaultdict(<class 'list'>, {'all_KL': [0.367], 'all_L1': [0.455]}), defaultdict(<class 'list'>, {'all_KL': [0.54], 'all_L1': [0.523]}), defaultdict(<class 'list'>, {'all_KL': [0.302], 'all_L1': [0.415]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.297 +- 0.046
suff++ class all_KL  =  0.125 +- 0.074
suff++_acc_int  =  0.211 +- 0.018
nec class all_L1  =  0.489 +- 0.053
nec class all_KL  =  0.470 +- 0.140
nec_acc_int  =  0.361 +- 0.055


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.393 +- 0.026
Faith. Armon (L1)= 		  =  0.365 +- 0.032
Faith. GMean (L1)= 	  =  0.379 +- 0.027
Faith. Aritm (KL)= 		  =  0.297 +- 0.055
Faith. Armon (KL)= 		  =  0.177 +- 0.084
Faith. GMean (KL)= 	  =  0.220 +- 0.060
Computed for split load_split = id



Completed in  0:13:07.679445  for CIGAvGIN GOODCMNIST/color



DONE CIGA GOODCMNIST/color
DONE all :)
