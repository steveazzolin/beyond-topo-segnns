nohup: ignoring input

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 22:48:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 10:48:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:03 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:11 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:49:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.8365
Train Loss: 0.5048
ID Validation ACCURACY: 0.8387
ID Validation Loss: 0.5132
ID Test ACCURACY: 0.8473
ID Test Loss: 0.5012
OOD Validation ACCURACY: 0.8727
OOD Validation Loss: 0.5047
OOD Test ACCURACY: 0.8613
OOD Test Loss: 0.5353

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.7881
Train Loss: 0.6104
ID Validation ACCURACY: 0.7843
ID Validation Loss: 0.6268
ID Test ACCURACY: 0.7953
ID Test Loss: 0.6104
OOD Validation ACCURACY: 0.8827
OOD Validation Loss: 0.4499
OOD Test ACCURACY: 0.8260
OOD Test Loss: 0.5367

[0m[1;37mINFO[0m: [1mChartInfo 0.8473 0.8613 0.7953 0.8260 0.7843 0.8827[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.531
WIoU for r=0.3 = 0.441
F1 for r=0.6 = 0.552
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.468
WIoU for r=0.9 = 0.567
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.568
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.533
WIoU for r=0.3 = 0.448
F1 for r=0.6 = 0.548
WIoU for r=0.6 = 0.552
F1 for r=0.9 = 0.470
WIoU for r=0.9 = 0.580
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.582
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.824
WIoU for r=0.3 = 0.862
F1 for r=0.6 = 0.746
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.604
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.378
WIoU for r=0.3 = 0.248
F1 for r=0.6 = 0.520
WIoU for r=0.6 = 0.366
F1 for r=0.9 = 0.586
WIoU for r=0.9 = 0.428
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.415


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.5307875
Model XAI WIoU of binarized graphs for r=0.3 =  0.4412162499999999
len(reference) = 767
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.406
SUFF++ for r=0.3 class 0 = 0.565 +- 0.218 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 1 = 0.588 +- 0.218 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 2 = 0.567 +- 0.218 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all KL = 0.685 +- 0.218 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all L1 = 0.574 +- 0.132 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.726
Model XAI F1 of binarized graphs for r=0.6 =  0.5519925
Model XAI WIoU of binarized graphs for r=0.6 =  0.5434725
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.634
SUFF++ for r=0.6 class 0 = 0.568 +- 0.234 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 1 = 0.599 +- 0.234 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 2 = 0.608 +- 0.234 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 all KL = 0.643 +- 0.234 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 all L1 = 0.592 +- 0.163 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.846
Model XAI F1 of binarized graphs for r=0.9 =  0.4683925
Model XAI WIoU of binarized graphs for r=0.9 =  0.567055
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.823
SUFF++ for r=0.9 class 0 = 0.832 +- 0.134 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 1 = 0.847 +- 0.134 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 2 = 0.853 +- 0.134 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all KL = 0.9 +- 0.134 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.148 (in-sample avg dev_std = 0.258)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.491
Model XAI F1 of binarized graphs for r=0.3 =  0.53293875
Model XAI WIoU of binarized graphs for r=0.3 =  0.44765750000000004
len(reference) = 760
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.403
SUFF++ for r=0.3 class 0 = 0.581 +- 0.213 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 class 1 = 0.579 +- 0.213 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 class 2 = 0.575 +- 0.213 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 all KL = 0.69 +- 0.213 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 all L1 = 0.578 +- 0.135 (in-sample avg dev_std = 0.416)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  0.548365
Model XAI WIoU of binarized graphs for r=0.6 =  0.55215125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0 = 0.567 +- 0.239 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 1 = 0.614 +- 0.239 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 2 = 0.603 +- 0.239 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all KL = 0.642 +- 0.239 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all L1 = 0.595 +- 0.164 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.821
Model XAI F1 of binarized graphs for r=0.9 =  0.4697775
Model XAI WIoU of binarized graphs for r=0.9 =  0.58018625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.804
SUFF++ for r=0.9 class 0 = 0.843 +- 0.129 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.129 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.129 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all KL = 0.904 +- 0.129 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.145 (in-sample avg dev_std = 0.250)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.82381375
Model XAI WIoU of binarized graphs for r=0.3 =  0.8623725
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.546
SUFF++ for r=0.3 class 0 = 0.583 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 class 1 = 0.776 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 class 2 = 0.587 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 all KL = 0.604 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 all L1 = 0.648 +- 0.200 (in-sample avg dev_std = 0.521)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.7456312500000002
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.85
SUFF++ for r=0.6 class 0 = 0.812 +- 0.209 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 1 = 0.756 +- 0.209 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 2 = 0.852 +- 0.209 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all KL = 0.809 +- 0.209 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.149 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  0.60419875
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.89
SUFF++ for r=0.9 class 0 = 0.963 +- 0.073 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1 = 0.906 +- 0.073 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 2 = 0.938 +- 0.073 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.971 +- 0.073 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.936 +- 0.095 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.332
Model XAI F1 of binarized graphs for r=0.3 =  0.3780275
Model XAI WIoU of binarized graphs for r=0.3 =  0.24807749999999998
len(reference) = 731
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF++ for r=0.3 class 0 = 0.758 +- 0.091 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 1 = 0.753 +- 0.091 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 2 = 0.754 +- 0.091 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 all KL = 0.888 +- 0.091 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.097 (in-sample avg dev_std = 0.304)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.409
Model XAI F1 of binarized graphs for r=0.6 =  0.51970625
Model XAI WIoU of binarized graphs for r=0.6 =  0.36645875000000006
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.417
SUFF++ for r=0.6 class 0 = 0.661 +- 0.167 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 class 1 = 0.709 +- 0.167 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 class 2 = 0.678 +- 0.167 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 all KL = 0.809 +- 0.167 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 all L1 = 0.682 +- 0.136 (in-sample avg dev_std = 0.353)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.58564125
Model XAI WIoU of binarized graphs for r=0.9 =  0.42799
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.82
SUFF++ for r=0.9 class 0 = 0.817 +- 0.137 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 1 = 0.969 +- 0.137 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 2 = 0.827 +- 0.137 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all KL = 0.927 +- 0.137 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all L1 = 0.869 +- 0.152 (in-sample avg dev_std = 0.193)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.47
Model XAI F1 of binarized graphs for r=0.3 =  0.5307875
Model XAI WIoU of binarized graphs for r=0.3 =  0.4412162499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.37
NEC for r=0.3 class 0 = 0.477 +- 0.252 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.412 +- 0.252 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.498 +- 0.252 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.348 +- 0.252 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.462 +- 0.151 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.726
Model XAI F1 of binarized graphs for r=0.6 =  0.5519925
Model XAI WIoU of binarized graphs for r=0.6 =  0.5434725
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.521
NEC for r=0.6 class 0 = 0.534 +- 0.263 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 1 = 0.452 +- 0.263 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 2 = 0.546 +- 0.263 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all KL = 0.478 +- 0.263 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all L1 = 0.51 +- 0.155 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.846
Model XAI F1 of binarized graphs for r=0.9 =  0.4683925
Model XAI WIoU of binarized graphs for r=0.9 =  0.567055
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.574
NEC for r=0.9 class 0 = 0.512 +- 0.266 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 1 = 0.442 +- 0.266 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 2 = 0.552 +- 0.266 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all KL = 0.51 +- 0.266 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all L1 = 0.501 +- 0.153 (in-sample avg dev_std = 0.530)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.855
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.568055
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.593
NEC for r=1.0 class 0 = 0.512 +- 0.269 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 1 = 0.446 +- 0.269 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 2 = 0.534 +- 0.269 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all KL = 0.518 +- 0.269 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all L1 = 0.497 +- 0.147 (in-sample avg dev_std = 0.547)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.479
Model XAI F1 of binarized graphs for r=0.3 =  0.53293875
Model XAI WIoU of binarized graphs for r=0.3 =  0.44765750000000004
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.357
NEC for r=0.3 class 0 = 0.477 +- 0.250 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.432 +- 0.250 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.491 +- 0.250 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.353 +- 0.250 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.467 +- 0.150 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  0.548365
Model XAI WIoU of binarized graphs for r=0.6 =  0.55215125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.498
NEC for r=0.6 class 0 = 0.526 +- 0.271 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 1 = 0.461 +- 0.271 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 2 = 0.549 +- 0.271 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all KL = 0.481 +- 0.271 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all L1 = 0.512 +- 0.156 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.821
Model XAI F1 of binarized graphs for r=0.9 =  0.4697775
Model XAI WIoU of binarized graphs for r=0.9 =  0.58018625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.558
NEC for r=0.9 class 0 = 0.506 +- 0.276 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.439 +- 0.276 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.554 +- 0.276 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.509 +- 0.276 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.5 +- 0.159 (in-sample avg dev_std = 0.533)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.839
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.58173875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.517 +- 0.283 (in-sample avg dev_std = 0.541)
NEC for r=1.0 class 1 = 0.451 +- 0.283 (in-sample avg dev_std = 0.541)
NEC for r=1.0 class 2 = 0.54 +- 0.283 (in-sample avg dev_std = 0.541)
NEC for r=1.0 all KL = 0.527 +- 0.283 (in-sample avg dev_std = 0.541)
NEC for r=1.0 all L1 = 0.503 +- 0.160 (in-sample avg dev_std = 0.541)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.82381375
Model XAI WIoU of binarized graphs for r=0.3 =  0.8623725
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.473
NEC for r=0.3 class 0 = 0.581 +- 0.349 (in-sample avg dev_std = 0.512)
NEC for r=0.3 class 1 = 0.353 +- 0.349 (in-sample avg dev_std = 0.512)
NEC for r=0.3 class 2 = 0.55 +- 0.349 (in-sample avg dev_std = 0.512)
NEC for r=0.3 all KL = 0.504 +- 0.349 (in-sample avg dev_std = 0.512)
NEC for r=0.3 all L1 = 0.496 +- 0.206 (in-sample avg dev_std = 0.512)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.7456312500000002
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.673
NEC for r=0.6 class 0 = 0.412 +- 0.347 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.196 +- 0.347 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.47 +- 0.347 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.434 +- 0.347 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.36 +- 0.213 (in-sample avg dev_std = 0.556)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  0.60419875
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.722
NEC for r=0.9 class 0 = 0.339 +- 0.272 (in-sample avg dev_std = 0.511)
NEC for r=0.9 class 1 = 0.163 +- 0.272 (in-sample avg dev_std = 0.511)
NEC for r=0.9 class 2 = 0.393 +- 0.272 (in-sample avg dev_std = 0.511)
NEC for r=0.9 all KL = 0.318 +- 0.272 (in-sample avg dev_std = 0.511)
NEC for r=0.9 all L1 = 0.299 +- 0.188 (in-sample avg dev_std = 0.511)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.724
NEC for r=1.0 class 0 = 0.323 +- 0.269 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 1 = 0.168 +- 0.269 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 2 = 0.392 +- 0.269 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all KL = 0.308 +- 0.269 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all L1 = 0.295 +- 0.188 (in-sample avg dev_std = 0.505)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.338
Model XAI F1 of binarized graphs for r=0.3 =  0.3780275
Model XAI WIoU of binarized graphs for r=0.3 =  0.24807749999999998
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.225 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 1 = 0.233 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.3 class 2 = 0.254 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.3 all KL = 0.092 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.3 all L1 = 0.237 +- 0.124 (in-sample avg dev_std = 0.222)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.409
Model XAI F1 of binarized graphs for r=0.6 =  0.51970625
Model XAI WIoU of binarized graphs for r=0.6 =  0.36645875000000006
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.41
NEC for r=0.6 class 0 = 0.417 +- 0.229 (in-sample avg dev_std = 0.411)
NEC for r=0.6 class 1 = 0.355 +- 0.229 (in-sample avg dev_std = 0.411)
NEC for r=0.6 class 2 = 0.422 +- 0.229 (in-sample avg dev_std = 0.411)
NEC for r=0.6 all KL = 0.284 +- 0.229 (in-sample avg dev_std = 0.411)
NEC for r=0.6 all L1 = 0.399 +- 0.161 (in-sample avg dev_std = 0.411)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.58564125
Model XAI WIoU of binarized graphs for r=0.9 =  0.42799
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.657
NEC for r=0.9 class 0 = 0.521 +- 0.279 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 1 = 0.163 +- 0.279 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 2 = 0.526 +- 0.279 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all KL = 0.423 +- 0.279 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all L1 = 0.408 +- 0.225 (in-sample avg dev_std = 0.530)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.41534750000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.682
NEC for r=1.0 class 0 = 0.488 +- 0.252 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 1 = 0.153 +- 0.252 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 2 = 0.477 +- 0.252 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all KL = 0.372 +- 0.252 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all L1 = 0.377 +- 0.203 (in-sample avg dev_std = 0.511)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 22:53:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 10:53:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 10:53:54 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 10:53:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 10:53:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:01 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:54:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9018
Train Loss: 0.4233
ID Validation ACCURACY: 0.8970
ID Validation Loss: 0.4483
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4353
OOD Validation ACCURACY: 0.9253
OOD Validation Loss: 0.3360
OOD Test ACCURACY: 0.7760
OOD Test Loss: 0.6729

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4111
ID Validation ACCURACY: 0.8890
ID Validation Loss: 0.4330
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4232
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.7547
OOD Test Loss: 0.6789

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.7760 0.8940 0.7547 0.8890 0.9317[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.629
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.592
WIoU for r=0.6 = 0.633
F1 for r=0.9 = 0.471
WIoU for r=0.9 = 0.629
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.628
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.627
WIoU for r=0.3 = 0.523
F1 for r=0.6 = 0.594
WIoU for r=0.6 = 0.621
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.618
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.617
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.844
WIoU for r=0.3 = 0.794
F1 for r=0.6 = 0.785
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.614
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.370
WIoU for r=0.3 = 0.258
F1 for r=0.6 = 0.517
WIoU for r=0.6 = 0.384
F1 for r=0.9 = 0.575
WIoU for r=0.9 = 0.437
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.438


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  0.6291325000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5351125
len(reference) = 781
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.444
SUFF++ for r=0.3 class 0 = 0.586 +- 0.294 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 1 = 0.631 +- 0.294 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.294 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all KL = 0.664 +- 0.294 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all L1 = 0.587 +- 0.158 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  0.59206
Model XAI WIoU of binarized graphs for r=0.6 =  0.6326824999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.73
SUFF++ for r=0.6 class 0 = 0.64 +- 0.270 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.693 +- 0.270 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.614 +- 0.270 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.661 +- 0.270 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.65 +- 0.175 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.4709175
Model XAI WIoU of binarized graphs for r=0.9 =  0.6289725
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.877
SUFF++ for r=0.9 class 0 = 0.837 +- 0.150 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 class 1 = 0.877 +- 0.150 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 class 2 = 0.887 +- 0.150 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all KL = 0.909 +- 0.150 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all L1 = 0.867 +- 0.146 (in-sample avg dev_std = 0.238)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.546
Model XAI F1 of binarized graphs for r=0.3 =  0.62702125
Model XAI WIoU of binarized graphs for r=0.3 =  0.52349875
len(reference) = 785
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.428
SUFF++ for r=0.3 class 0 = 0.552 +- 0.290 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1 = 0.638 +- 0.290 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 2 = 0.553 +- 0.290 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.664 +- 0.290 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.581 +- 0.153 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  0.593715
Model XAI WIoU of binarized graphs for r=0.6 =  0.6209
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.727
SUFF++ for r=0.6 class 0 = 0.629 +- 0.271 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 class 1 = 0.686 +- 0.271 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 class 2 = 0.618 +- 0.271 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 all KL = 0.662 +- 0.271 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 all L1 = 0.644 +- 0.179 (in-sample avg dev_std = 0.457)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.47330875
Model XAI WIoU of binarized graphs for r=0.9 =  0.61806125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.864
SUFF++ for r=0.9 class 0 = 0.838 +- 0.146 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 1 = 0.877 +- 0.146 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 2 = 0.875 +- 0.146 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all KL = 0.91 +- 0.146 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all L1 = 0.864 +- 0.145 (in-sample avg dev_std = 0.232)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  0.8444550000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.7935737499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF++ for r=0.3 class 0 = 0.627 +- 0.302 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 1 = 0.705 +- 0.302 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 2 = 0.608 +- 0.302 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all KL = 0.617 +- 0.302 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all L1 = 0.646 +- 0.182 (in-sample avg dev_std = 0.511)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.7848475
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.912
SUFF++ for r=0.6 class 0 = 0.916 +- 0.162 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 1 = 0.879 +- 0.162 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 2 = 0.929 +- 0.162 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all KL = 0.911 +- 0.162 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all L1 = 0.908 +- 0.110 (in-sample avg dev_std = 0.250)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.6144375000000001
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.929
SUFF++ for r=0.9 class 0 = 0.958 +- 0.055 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 class 1 = 0.935 +- 0.055 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 class 2 = 0.979 +- 0.055 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all KL = 0.984 +- 0.055 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.073 (in-sample avg dev_std = 0.116)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.32
Model XAI F1 of binarized graphs for r=0.3 =  0.36957375
Model XAI WIoU of binarized graphs for r=0.3 =  0.25758624999999996
len(reference) = 750
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF++ for r=0.3 class 0 = 0.739 +- 0.095 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 1 = 0.769 +- 0.095 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 2 = 0.748 +- 0.095 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all KL = 0.902 +- 0.095 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all L1 = 0.751 +- 0.104 (in-sample avg dev_std = 0.250)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.517
Model XAI F1 of binarized graphs for r=0.6 =  0.51701625
Model XAI WIoU of binarized graphs for r=0.6 =  0.38358875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.485
SUFF++ for r=0.6 class 0 = 0.643 +- 0.222 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 1 = 0.743 +- 0.222 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 2 = 0.682 +- 0.222 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all KL = 0.782 +- 0.222 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all L1 = 0.688 +- 0.157 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.805
Model XAI F1 of binarized graphs for r=0.9 =  0.5747599999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.437085
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.765
SUFF++ for r=0.9 class 0 = 0.744 +- 0.154 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 1 = 0.974 +- 0.154 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 2 = 0.86 +- 0.154 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all KL = 0.9 +- 0.154 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all L1 = 0.858 +- 0.160 (in-sample avg dev_std = 0.283)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.572
Model XAI F1 of binarized graphs for r=0.3 =  0.6291325000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5351125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
NEC for r=0.3 class 0 = 0.471 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 1 = 0.362 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 2 = 0.476 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all KL = 0.356 +- 0.327 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all L1 = 0.435 +- 0.194 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  0.59206
Model XAI WIoU of binarized graphs for r=0.6 =  0.6326824999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.592
NEC for r=0.6 class 0 = 0.543 +- 0.309 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 1 = 0.424 +- 0.309 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 2 = 0.545 +- 0.309 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all KL = 0.505 +- 0.309 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all L1 = 0.503 +- 0.168 (in-sample avg dev_std = 0.496)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.4709175
Model XAI WIoU of binarized graphs for r=0.9 =  0.6289725
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.669
NEC for r=0.9 class 0 = 0.484 +- 0.278 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.435 +- 0.278 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.487 +- 0.278 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.491 +- 0.278 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.468 +- 0.149 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.919
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.62846
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.651
NEC for r=1.0 class 0 = 0.498 +- 0.280 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 1 = 0.425 +- 0.280 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 2 = 0.487 +- 0.280 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all KL = 0.49 +- 0.280 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all L1 = 0.469 +- 0.153 (in-sample avg dev_std = 0.536)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.62702125
Model XAI WIoU of binarized graphs for r=0.3 =  0.52349875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.392
NEC for r=0.3 class 0 = 0.493 +- 0.319 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 1 = 0.36 +- 0.319 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 2 = 0.446 +- 0.319 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all KL = 0.348 +- 0.319 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all L1 = 0.432 +- 0.189 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  0.593715
Model XAI WIoU of binarized graphs for r=0.6 =  0.6209
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.582
NEC for r=0.6 class 0 = 0.541 +- 0.309 (in-sample avg dev_std = 0.494)
NEC for r=0.6 class 1 = 0.423 +- 0.309 (in-sample avg dev_std = 0.494)
NEC for r=0.6 class 2 = 0.552 +- 0.309 (in-sample avg dev_std = 0.494)
NEC for r=0.6 all KL = 0.508 +- 0.309 (in-sample avg dev_std = 0.494)
NEC for r=0.6 all L1 = 0.506 +- 0.169 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.47330875
Model XAI WIoU of binarized graphs for r=0.9 =  0.61806125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.662
NEC for r=0.9 class 0 = 0.492 +- 0.283 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 1 = 0.433 +- 0.283 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 2 = 0.485 +- 0.283 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all KL = 0.491 +- 0.283 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all L1 = 0.47 +- 0.151 (in-sample avg dev_std = 0.538)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.6174425
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.662
NEC for r=1.0 class 0 = 0.489 +- 0.280 (in-sample avg dev_std = 0.534)
NEC for r=1.0 class 1 = 0.417 +- 0.280 (in-sample avg dev_std = 0.534)
NEC for r=1.0 class 2 = 0.478 +- 0.280 (in-sample avg dev_std = 0.534)
NEC for r=1.0 all KL = 0.481 +- 0.280 (in-sample avg dev_std = 0.534)
NEC for r=1.0 all L1 = 0.461 +- 0.152 (in-sample avg dev_std = 0.534)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  0.8444550000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.7935737499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.517
NEC for r=0.3 class 0 = 0.552 +- 0.325 (in-sample avg dev_std = 0.525)
NEC for r=0.3 class 1 = 0.433 +- 0.325 (in-sample avg dev_std = 0.525)
NEC for r=0.3 class 2 = 0.475 +- 0.325 (in-sample avg dev_std = 0.525)
NEC for r=0.3 all KL = 0.496 +- 0.325 (in-sample avg dev_std = 0.525)
NEC for r=0.3 all L1 = 0.487 +- 0.187 (in-sample avg dev_std = 0.525)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.7848475
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 0 = 0.431 +- 0.259 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 1 = 0.311 +- 0.259 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 2 = 0.329 +- 0.259 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all KL = 0.448 +- 0.259 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all L1 = 0.357 +- 0.152 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.6144375000000001
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.834
NEC for r=0.9 class 0 = 0.327 +- 0.205 (in-sample avg dev_std = 0.475)
NEC for r=0.9 class 1 = 0.245 +- 0.205 (in-sample avg dev_std = 0.475)
NEC for r=0.9 class 2 = 0.269 +- 0.205 (in-sample avg dev_std = 0.475)
NEC for r=0.9 all KL = 0.279 +- 0.205 (in-sample avg dev_std = 0.475)
NEC for r=0.9 all L1 = 0.281 +- 0.141 (in-sample avg dev_std = 0.475)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0 = 0.341 +- 0.197 (in-sample avg dev_std = 0.479)
NEC for r=1.0 class 1 = 0.253 +- 0.197 (in-sample avg dev_std = 0.479)
NEC for r=1.0 class 2 = 0.26 +- 0.197 (in-sample avg dev_std = 0.479)
NEC for r=1.0 all KL = 0.279 +- 0.197 (in-sample avg dev_std = 0.479)
NEC for r=1.0 all L1 = 0.285 +- 0.134 (in-sample avg dev_std = 0.479)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.322
Model XAI F1 of binarized graphs for r=0.3 =  0.36957375
Model XAI WIoU of binarized graphs for r=0.3 =  0.25758624999999996
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.246 +- 0.097 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 1 = 0.235 +- 0.097 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 2 = 0.241 +- 0.097 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all KL = 0.085 +- 0.097 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all L1 = 0.241 +- 0.114 (in-sample avg dev_std = 0.187)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.517
Model XAI F1 of binarized graphs for r=0.6 =  0.51701625
Model XAI WIoU of binarized graphs for r=0.6 =  0.38358875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.509
NEC for r=0.6 class 0 = 0.478 +- 0.260 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 1 = 0.327 +- 0.260 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 2 = 0.425 +- 0.260 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all KL = 0.322 +- 0.260 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all L1 = 0.412 +- 0.170 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.805
Model XAI F1 of binarized graphs for r=0.9 =  0.5747599999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.437085
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.691
NEC for r=0.9 class 0 = 0.468 +- 0.213 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 1 = 0.23 +- 0.213 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 2 = 0.452 +- 0.213 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all KL = 0.422 +- 0.213 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all L1 = 0.386 +- 0.179 (in-sample avg dev_std = 0.522)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.796
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.43768500000000005
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.695
NEC for r=1.0 class 0 = 0.459 +- 0.202 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 1 = 0.221 +- 0.202 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 2 = 0.442 +- 0.202 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all KL = 0.393 +- 0.202 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all L1 = 0.376 +- 0.174 (in-sample avg dev_std = 0.501)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 22:58:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 10:58:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8760
Train Loss: 0.4616
ID Validation ACCURACY: 0.8857
ID Validation Loss: 0.4701
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4700
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3446
OOD Test ACCURACY: 0.5550
OOD Test Loss: 1.5732

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8760
Train Loss: 0.4616
ID Validation ACCURACY: 0.8857
ID Validation Loss: 0.4701
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4700
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3446
OOD Test ACCURACY: 0.5550
OOD Test Loss: 1.5732

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.5550 0.8753 0.5550 0.8857 0.9313[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.676
WIoU for r=0.3 = 0.613
F1 for r=0.6 = 0.600
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.709
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.709
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.677
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.602
WIoU for r=0.6 = 0.713
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.718
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.718
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.826
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.386
WIoU for r=0.3 = 0.278
F1 for r=0.6 = 0.532
WIoU for r=0.6 = 0.400
F1 for r=0.9 = 0.582
WIoU for r=0.9 = 0.456
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.457


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.623
Model XAI F1 of binarized graphs for r=0.3 =  0.6764474999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6130387500000001
len(reference) = 791
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.435
SUFF++ for r=0.3 class 0 = 0.514 +- 0.278 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 1 = 0.509 +- 0.278 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 2 = 0.467 +- 0.278 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all KL = 0.512 +- 0.278 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all L1 = 0.496 +- 0.136 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.59965125
Model XAI WIoU of binarized graphs for r=0.6 =  0.7060949999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.693
SUFF++ for r=0.6 class 0 = 0.562 +- 0.260 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 class 1 = 0.732 +- 0.260 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 class 2 = 0.634 +- 0.260 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all KL = 0.636 +- 0.260 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all L1 = 0.644 +- 0.197 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.47192999999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.7094312500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.876
SUFF++ for r=0.9 class 0 = 0.842 +- 0.129 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 class 1 = 0.934 +- 0.129 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 class 2 = 0.899 +- 0.129 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all KL = 0.932 +- 0.129 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all L1 = 0.893 +- 0.139 (in-sample avg dev_std = 0.218)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  0.677385
Model XAI WIoU of binarized graphs for r=0.3 =  0.61444125
len(reference) = 788
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.444
SUFF++ for r=0.3 class 0 = 0.513 +- 0.277 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.3 class 1 = 0.513 +- 0.277 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.3 class 2 = 0.497 +- 0.277 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.3 all KL = 0.522 +- 0.277 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.3 all L1 = 0.508 +- 0.143 (in-sample avg dev_std = 0.505)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.84
Model XAI F1 of binarized graphs for r=0.6 =  0.602365
Model XAI WIoU of binarized graphs for r=0.6 =  0.71316
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.678
SUFF++ for r=0.6 class 0 = 0.538 +- 0.260 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.751 +- 0.260 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.664 +- 0.260 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.649 +- 0.260 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.203 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.881
Model XAI F1 of binarized graphs for r=0.9 =  0.47449624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.7179575000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.842
SUFF++ for r=0.9 class 0 = 0.85 +- 0.125 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 class 1 = 0.924 +- 0.125 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 class 2 = 0.911 +- 0.125 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 all KL = 0.937 +- 0.125 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 all L1 = 0.896 +- 0.137 (in-sample avg dev_std = 0.209)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.6
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.82552875
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.531
SUFF++ for r=0.3 class 0 = 0.567 +- 0.321 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 1 = 0.71 +- 0.321 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 2 = 0.576 +- 0.321 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all KL = 0.497 +- 0.321 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all L1 = 0.617 +- 0.186 (in-sample avg dev_std = 0.530)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.935
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.915
SUFF++ for r=0.6 class 0 = 0.9 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 class 1 = 0.906 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 class 2 = 0.93 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all KL = 0.912 +- 0.157 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all L1 = 0.912 +- 0.116 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.935
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.934
SUFF++ for r=0.9 class 0 = 0.968 +- 0.033 (in-sample avg dev_std = 0.073)
SUFF++ for r=0.9 class 1 = 0.973 +- 0.033 (in-sample avg dev_std = 0.073)
SUFF++ for r=0.9 class 2 = 0.977 +- 0.033 (in-sample avg dev_std = 0.073)
SUFF++ for r=0.9 all KL = 0.991 +- 0.033 (in-sample avg dev_std = 0.073)
SUFF++ for r=0.9 all L1 = 0.973 +- 0.050 (in-sample avg dev_std = 0.073)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.321
Model XAI F1 of binarized graphs for r=0.3 =  0.3856125
Model XAI WIoU of binarized graphs for r=0.3 =  0.27827999999999997
len(reference) = 758
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.37
SUFF++ for r=0.3 class 0 = 0.656 +- 0.144 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 class 1 = 0.624 +- 0.144 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 class 2 = 0.631 +- 0.144 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 all KL = 0.797 +- 0.144 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.120 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.336
Model XAI F1 of binarized graphs for r=0.6 =  0.53164375
Model XAI WIoU of binarized graphs for r=0.6 =  0.39959999999999996
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF++ for r=0.6 class 0 = 0.594 +- 0.224 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.675 +- 0.224 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.604 +- 0.224 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.714 +- 0.224 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.624 +- 0.144 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.572
Model XAI F1 of binarized graphs for r=0.9 =  0.581955
Model XAI WIoU of binarized graphs for r=0.9 =  0.456155
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.55
SUFF++ for r=0.9 class 0 = 0.823 +- 0.113 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 1 = 0.987 +- 0.113 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 2 = 0.798 +- 0.113 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all KL = 0.926 +- 0.113 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all L1 = 0.867 +- 0.155 (in-sample avg dev_std = 0.217)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.616
Model XAI F1 of binarized graphs for r=0.3 =  0.6764474999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6130387500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.312
NEC for r=0.3 class 0 = 0.501 +- 0.310 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.512 +- 0.310 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.589 +- 0.310 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.501 +- 0.310 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.534 +- 0.163 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.59965125
Model XAI WIoU of binarized graphs for r=0.6 =  0.7060949999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.457
NEC for r=0.6 class 0 = 0.549 +- 0.308 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 1 = 0.506 +- 0.308 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 2 = 0.598 +- 0.308 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all KL = 0.58 +- 0.308 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all L1 = 0.55 +- 0.164 (in-sample avg dev_std = 0.497)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.47192999999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.7094312500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.553
NEC for r=0.9 class 0 = 0.511 +- 0.293 (in-sample avg dev_std = 0.548)
NEC for r=0.9 class 1 = 0.463 +- 0.293 (in-sample avg dev_std = 0.548)
NEC for r=0.9 class 2 = 0.539 +- 0.293 (in-sample avg dev_std = 0.548)
NEC for r=0.9 all KL = 0.542 +- 0.293 (in-sample avg dev_std = 0.548)
NEC for r=0.9 all L1 = 0.504 +- 0.158 (in-sample avg dev_std = 0.548)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.70937875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.512 +- 0.288 (in-sample avg dev_std = 0.545)
NEC for r=1.0 class 1 = 0.48 +- 0.288 (in-sample avg dev_std = 0.545)
NEC for r=1.0 class 2 = 0.53 +- 0.288 (in-sample avg dev_std = 0.545)
NEC for r=1.0 all KL = 0.545 +- 0.288 (in-sample avg dev_std = 0.545)
NEC for r=1.0 all L1 = 0.507 +- 0.153 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.624
Model XAI F1 of binarized graphs for r=0.3 =  0.677385
Model XAI WIoU of binarized graphs for r=0.3 =  0.61444125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.319
NEC for r=0.3 class 0 = 0.523 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.502 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.567 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.502 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.531 +- 0.162 (in-sample avg dev_std = 0.421)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.84
Model XAI F1 of binarized graphs for r=0.6 =  0.602365
Model XAI WIoU of binarized graphs for r=0.6 =  0.71316
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.47
NEC for r=0.6 class 0 = 0.53 +- 0.313 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 1 = 0.51 +- 0.313 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 2 = 0.587 +- 0.313 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all KL = 0.572 +- 0.313 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all L1 = 0.543 +- 0.166 (in-sample avg dev_std = 0.487)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.881
Model XAI F1 of binarized graphs for r=0.9 =  0.47449624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.7179575000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 0 = 0.521 +- 0.299 (in-sample avg dev_std = 0.544)
NEC for r=0.9 class 1 = 0.472 +- 0.299 (in-sample avg dev_std = 0.544)
NEC for r=0.9 class 2 = 0.539 +- 0.299 (in-sample avg dev_std = 0.544)
NEC for r=0.9 all KL = 0.547 +- 0.299 (in-sample avg dev_std = 0.544)
NEC for r=0.9 all L1 = 0.511 +- 0.157 (in-sample avg dev_std = 0.544)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.882
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.71796625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.546
NEC for r=1.0 class 0 = 0.518 +- 0.291 (in-sample avg dev_std = 0.549)
NEC for r=1.0 class 1 = 0.471 +- 0.291 (in-sample avg dev_std = 0.549)
NEC for r=1.0 class 2 = 0.54 +- 0.291 (in-sample avg dev_std = 0.549)
NEC for r=1.0 all KL = 0.548 +- 0.291 (in-sample avg dev_std = 0.549)
NEC for r=1.0 all L1 = 0.51 +- 0.154 (in-sample avg dev_std = 0.549)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.6
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.82552875
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.384
NEC for r=0.3 class 0 = 0.575 +- 0.329 (in-sample avg dev_std = 0.477)
NEC for r=0.3 class 1 = 0.563 +- 0.329 (in-sample avg dev_std = 0.477)
NEC for r=0.3 class 2 = 0.592 +- 0.329 (in-sample avg dev_std = 0.477)
NEC for r=0.3 all KL = 0.667 +- 0.329 (in-sample avg dev_std = 0.477)
NEC for r=0.3 all L1 = 0.577 +- 0.155 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.935
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.687
NEC for r=0.6 class 0 = 0.444 +- 0.264 (in-sample avg dev_std = 0.637)
NEC for r=0.6 class 1 = 0.438 +- 0.264 (in-sample avg dev_std = 0.637)
NEC for r=0.6 class 2 = 0.45 +- 0.264 (in-sample avg dev_std = 0.637)
NEC for r=0.6 all KL = 0.59 +- 0.264 (in-sample avg dev_std = 0.637)
NEC for r=0.6 all L1 = 0.444 +- 0.152 (in-sample avg dev_std = 0.637)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.935
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.73
NEC for r=0.9 class 0 = 0.367 +- 0.223 (in-sample avg dev_std = 0.586)
NEC for r=0.9 class 1 = 0.356 +- 0.223 (in-sample avg dev_std = 0.586)
NEC for r=0.9 class 2 = 0.376 +- 0.223 (in-sample avg dev_std = 0.586)
NEC for r=0.9 all KL = 0.414 +- 0.223 (in-sample avg dev_std = 0.586)
NEC for r=0.9 all L1 = 0.366 +- 0.148 (in-sample avg dev_std = 0.586)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.737
NEC for r=1.0 class 0 = 0.356 +- 0.219 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 1 = 0.358 +- 0.219 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 2 = 0.36 +- 0.219 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all KL = 0.402 +- 0.219 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all L1 = 0.358 +- 0.143 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.319
Model XAI F1 of binarized graphs for r=0.3 =  0.3856125
Model XAI WIoU of binarized graphs for r=0.3 =  0.27827999999999997
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.384
NEC for r=0.3 class 0 = 0.343 +- 0.178 (in-sample avg dev_std = 0.315)
NEC for r=0.3 class 1 = 0.354 +- 0.178 (in-sample avg dev_std = 0.315)
NEC for r=0.3 class 2 = 0.392 +- 0.178 (in-sample avg dev_std = 0.315)
NEC for r=0.3 all KL = 0.2 +- 0.178 (in-sample avg dev_std = 0.315)
NEC for r=0.3 all L1 = 0.363 +- 0.149 (in-sample avg dev_std = 0.315)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.336
Model XAI F1 of binarized graphs for r=0.6 =  0.53164375
Model XAI WIoU of binarized graphs for r=0.6 =  0.39959999999999996
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.46
NEC for r=0.6 class 0 = 0.434 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 1 = 0.47 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 2 = 0.53 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all KL = 0.399 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all L1 = 0.478 +- 0.153 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.572
Model XAI F1 of binarized graphs for r=0.9 =  0.581955
Model XAI WIoU of binarized graphs for r=0.9 =  0.456155
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.558
NEC for r=0.9 class 0 = 0.421 +- 0.240 (in-sample avg dev_std = 0.451)
NEC for r=0.9 class 1 = 0.196 +- 0.240 (in-sample avg dev_std = 0.451)
NEC for r=0.9 class 2 = 0.49 +- 0.240 (in-sample avg dev_std = 0.451)
NEC for r=0.9 all KL = 0.404 +- 0.240 (in-sample avg dev_std = 0.451)
NEC for r=0.9 all L1 = 0.372 +- 0.200 (in-sample avg dev_std = 0.451)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.559
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.45672999999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.561
NEC for r=1.0 class 0 = 0.401 +- 0.229 (in-sample avg dev_std = 0.452)
NEC for r=1.0 class 1 = 0.194 +- 0.229 (in-sample avg dev_std = 0.452)
NEC for r=1.0 class 2 = 0.486 +- 0.229 (in-sample avg dev_std = 0.452)
NEC for r=1.0 all KL = 0.384 +- 0.229 (in-sample avg dev_std = 0.452)
NEC for r=1.0 all L1 = 0.364 +- 0.196 (in-sample avg dev_std = 0.452)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:03:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:26 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:03:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8632
Train Loss: 0.4874
ID Validation ACCURACY: 0.8627
ID Validation Loss: 0.5017
ID Test ACCURACY: 0.8617
ID Test Loss: 0.4771
OOD Validation ACCURACY: 0.9223
OOD Validation Loss: 0.3662
OOD Test ACCURACY: 0.6843
OOD Test Loss: 0.9765

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.8372
Train Loss: 0.5664
ID Validation ACCURACY: 0.8407
ID Validation Loss: 0.5832
ID Test ACCURACY: 0.8400
ID Test Loss: 0.5602
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3337
OOD Test ACCURACY: 0.6390
OOD Test Loss: 0.8867

[0m[1;37mINFO[0m: [1mChartInfo 0.8617 0.6843 0.8400 0.6390 0.8407 0.9317[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.644
WIoU for r=0.3 = 0.573
F1 for r=0.6 = 0.585
WIoU for r=0.6 = 0.642
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.651
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.651
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.637
WIoU for r=0.3 = 0.575
F1 for r=0.6 = 0.586
WIoU for r=0.6 = 0.653
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.663
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.663
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.848
WIoU for r=0.3 = 0.817
F1 for r=0.6 = 0.788
WIoU for r=0.6 = 0.997
F1 for r=0.9 = 0.616
WIoU for r=0.9 = 0.996
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.996
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.352
WIoU for r=0.3 = 0.236
F1 for r=0.6 = 0.492
WIoU for r=0.6 = 0.349
F1 for r=0.9 = 0.589
WIoU for r=0.9 = 0.429
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.430


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  0.643605
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731625
len(reference) = 786
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
SUFF++ for r=0.3 class 0 = 0.507 +- 0.278 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 class 1 = 0.63 +- 0.278 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 class 2 = 0.518 +- 0.278 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 all KL = 0.57 +- 0.278 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 all L1 = 0.553 +- 0.166 (in-sample avg dev_std = 0.501)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.798
Model XAI F1 of binarized graphs for r=0.6 =  0.585175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6423362499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0 = 0.536 +- 0.304 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.74 +- 0.304 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.656 +- 0.304 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.643 +- 0.304 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.646 +- 0.214 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.871
Model XAI F1 of binarized graphs for r=0.9 =  0.47269625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.6507162500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0 = 0.848 +- 0.137 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1 = 0.876 +- 0.137 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 2 = 0.918 +- 0.137 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.924 +- 0.137 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.881 +- 0.143 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  0.6373137499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.57468125
len(reference) = 780
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.438
SUFF++ for r=0.3 class 0 = 0.484 +- 0.271 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 1 = 0.641 +- 0.271 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 2 = 0.52 +- 0.271 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all KL = 0.564 +- 0.271 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all L1 = 0.549 +- 0.168 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.8
Model XAI F1 of binarized graphs for r=0.6 =  0.58628625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6526875000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.678
SUFF++ for r=0.6 class 0 = 0.555 +- 0.303 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 1 = 0.738 +- 0.303 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 2 = 0.655 +- 0.303 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all KL = 0.649 +- 0.303 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all L1 = 0.651 +- 0.210 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  0.47497749999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.6627525
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.829
SUFF++ for r=0.9 class 0 = 0.849 +- 0.136 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 1 = 0.876 +- 0.136 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 2 = 0.925 +- 0.136 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all KL = 0.928 +- 0.136 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all L1 = 0.884 +- 0.143 (in-sample avg dev_std = 0.211)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.586
Model XAI F1 of binarized graphs for r=0.3 =  0.847735
Model XAI WIoU of binarized graphs for r=0.3 =  0.81731875
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
SUFF++ for r=0.3 class 0 = 0.565 +- 0.310 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 class 1 = 0.819 +- 0.310 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 class 2 = 0.618 +- 0.310 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 all KL = 0.623 +- 0.310 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 all L1 = 0.666 +- 0.213 (in-sample avg dev_std = 0.508)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.7879287500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.99675875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.87
SUFF++ for r=0.6 class 0 = 0.747 +- 0.248 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 1 = 0.896 +- 0.248 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 2 = 0.91 +- 0.248 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all KL = 0.83 +- 0.248 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all L1 = 0.851 +- 0.164 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.615685
Model XAI WIoU of binarized graphs for r=0.9 =  0.9960737500000001
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.924
SUFF++ for r=0.9 class 0 = 0.952 +- 0.063 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.9 class 1 = 0.955 +- 0.063 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.9 class 2 = 0.974 +- 0.063 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.9 all KL = 0.984 +- 0.063 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.9 all L1 = 0.96 +- 0.064 (in-sample avg dev_std = 0.098)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.263
Model XAI F1 of binarized graphs for r=0.3 =  0.35237
Model XAI WIoU of binarized graphs for r=0.3 =  0.23611875
len(reference) = 752
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.319
SUFF++ for r=0.3 class 0 = 0.654 +- 0.130 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 class 1 = 0.653 +- 0.130 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 class 2 = 0.664 +- 0.130 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 all KL = 0.801 +- 0.130 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 all L1 = 0.657 +- 0.120 (in-sample avg dev_std = 0.423)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.375
Model XAI F1 of binarized graphs for r=0.6 =  0.49178375
Model XAI WIoU of binarized graphs for r=0.6 =  0.3492675
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.383
SUFF++ for r=0.6 class 0 = 0.696 +- 0.175 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 class 1 = 0.826 +- 0.175 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 class 2 = 0.755 +- 0.175 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all KL = 0.845 +- 0.175 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all L1 = 0.758 +- 0.166 (in-sample avg dev_std = 0.290)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.685
Model XAI F1 of binarized graphs for r=0.9 =  0.58899125
Model XAI WIoU of binarized graphs for r=0.9 =  0.42924125
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.658
SUFF++ for r=0.9 class 0 = 0.763 +- 0.126 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1 = 0.978 +- 0.126 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 2 = 0.875 +- 0.126 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.93 +- 0.126 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.87 +- 0.155 (in-sample avg dev_std = 0.219)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  0.643605
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.432
NEC for r=0.3 class 0 = 0.52 +- 0.280 (in-sample avg dev_std = 0.450)
NEC for r=0.3 class 1 = 0.477 +- 0.280 (in-sample avg dev_std = 0.450)
NEC for r=0.3 class 2 = 0.534 +- 0.280 (in-sample avg dev_std = 0.450)
NEC for r=0.3 all KL = 0.492 +- 0.280 (in-sample avg dev_std = 0.450)
NEC for r=0.3 all L1 = 0.509 +- 0.158 (in-sample avg dev_std = 0.450)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.798
Model XAI F1 of binarized graphs for r=0.6 =  0.585175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6423362499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0 = 0.527 +- 0.309 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 1 = 0.452 +- 0.309 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 2 = 0.522 +- 0.309 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all KL = 0.525 +- 0.309 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all L1 = 0.5 +- 0.170 (in-sample avg dev_std = 0.487)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.871
Model XAI F1 of binarized graphs for r=0.9 =  0.47269625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.6507162500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.655
NEC for r=0.9 class 0 = 0.484 +- 0.281 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 1 = 0.43 +- 0.281 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 2 = 0.459 +- 0.281 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all KL = 0.485 +- 0.281 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all L1 = 0.457 +- 0.146 (in-sample avg dev_std = 0.531)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.871
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.6507162500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.652
NEC for r=1.0 class 0 = 0.485 +- 0.286 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 1 = 0.432 +- 0.286 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 2 = 0.46 +- 0.286 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all KL = 0.485 +- 0.286 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all L1 = 0.459 +- 0.155 (in-sample avg dev_std = 0.525)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  0.6373137499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.57468125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.427
NEC for r=0.3 class 0 = 0.527 +- 0.277 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 1 = 0.467 +- 0.277 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 2 = 0.527 +- 0.277 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all KL = 0.488 +- 0.277 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all L1 = 0.507 +- 0.164 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.8
Model XAI F1 of binarized graphs for r=0.6 =  0.58628625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6526875000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.555
NEC for r=0.6 class 0 = 0.529 +- 0.314 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 1 = 0.451 +- 0.314 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 2 = 0.51 +- 0.314 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all KL = 0.516 +- 0.314 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all L1 = 0.497 +- 0.174 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  0.47497749999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.6627525
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.473 +- 0.295 (in-sample avg dev_std = 0.524)
NEC for r=0.9 class 1 = 0.435 +- 0.295 (in-sample avg dev_std = 0.524)
NEC for r=0.9 class 2 = 0.469 +- 0.295 (in-sample avg dev_std = 0.524)
NEC for r=0.9 all KL = 0.486 +- 0.295 (in-sample avg dev_std = 0.524)
NEC for r=0.9 all L1 = 0.459 +- 0.154 (in-sample avg dev_std = 0.524)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.861
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.6627087499999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.644
NEC for r=1.0 class 0 = 0.475 +- 0.291 (in-sample avg dev_std = 0.520)
NEC for r=1.0 class 1 = 0.434 +- 0.291 (in-sample avg dev_std = 0.520)
NEC for r=1.0 class 2 = 0.469 +- 0.291 (in-sample avg dev_std = 0.520)
NEC for r=1.0 all KL = 0.486 +- 0.291 (in-sample avg dev_std = 0.520)
NEC for r=1.0 all L1 = 0.459 +- 0.156 (in-sample avg dev_std = 0.520)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.586
Model XAI F1 of binarized graphs for r=0.3 =  0.847735
Model XAI WIoU of binarized graphs for r=0.3 =  0.81731875
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.626 +- 0.301 (in-sample avg dev_std = 0.541)
NEC for r=0.3 class 1 = 0.495 +- 0.301 (in-sample avg dev_std = 0.541)
NEC for r=0.3 class 2 = 0.49 +- 0.301 (in-sample avg dev_std = 0.541)
NEC for r=0.3 all KL = 0.615 +- 0.301 (in-sample avg dev_std = 0.541)
NEC for r=0.3 all L1 = 0.537 +- 0.205 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.7879287500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.99675875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.753
NEC for r=0.6 class 0 = 0.422 +- 0.263 (in-sample avg dev_std = 0.577)
NEC for r=0.6 class 1 = 0.314 +- 0.263 (in-sample avg dev_std = 0.577)
NEC for r=0.6 class 2 = 0.301 +- 0.263 (in-sample avg dev_std = 0.577)
NEC for r=0.6 all KL = 0.476 +- 0.263 (in-sample avg dev_std = 0.577)
NEC for r=0.6 all L1 = 0.346 +- 0.163 (in-sample avg dev_std = 0.577)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.615685
Model XAI WIoU of binarized graphs for r=0.9 =  0.9960737500000001
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.801
NEC for r=0.9 class 0 = 0.332 +- 0.224 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.269 +- 0.224 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.273 +- 0.224 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.327 +- 0.224 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.292 +- 0.148 (in-sample avg dev_std = 0.508)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.9960737500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.804
NEC for r=1.0 class 0 = 0.324 +- 0.210 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 1 = 0.27 +- 0.210 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 2 = 0.277 +- 0.210 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all KL = 0.323 +- 0.210 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all L1 = 0.291 +- 0.141 (in-sample avg dev_std = 0.505)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.259
Model XAI F1 of binarized graphs for r=0.3 =  0.35237
Model XAI WIoU of binarized graphs for r=0.3 =  0.23611875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.285
NEC for r=0.3 class 0 = 0.313 +- 0.140 (in-sample avg dev_std = 0.294)
NEC for r=0.3 class 1 = 0.31 +- 0.140 (in-sample avg dev_std = 0.294)
NEC for r=0.3 class 2 = 0.31 +- 0.140 (in-sample avg dev_std = 0.294)
NEC for r=0.3 all KL = 0.151 +- 0.140 (in-sample avg dev_std = 0.294)
NEC for r=0.3 all L1 = 0.311 +- 0.136 (in-sample avg dev_std = 0.294)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.375
Model XAI F1 of binarized graphs for r=0.6 =  0.49178375
Model XAI WIoU of binarized graphs for r=0.6 =  0.3492675
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.417
NEC for r=0.6 class 0 = 0.387 +- 0.235 (in-sample avg dev_std = 0.373)
NEC for r=0.6 class 1 = 0.228 +- 0.235 (in-sample avg dev_std = 0.373)
NEC for r=0.6 class 2 = 0.356 +- 0.235 (in-sample avg dev_std = 0.373)
NEC for r=0.6 all KL = 0.253 +- 0.235 (in-sample avg dev_std = 0.373)
NEC for r=0.6 all L1 = 0.325 +- 0.189 (in-sample avg dev_std = 0.373)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.685
Model XAI F1 of binarized graphs for r=0.9 =  0.58899125
Model XAI WIoU of binarized graphs for r=0.9 =  0.42924125
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.616
NEC for r=0.9 class 0 = 0.424 +- 0.237 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 1 = 0.159 +- 0.237 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 2 = 0.454 +- 0.237 (in-sample avg dev_std = 0.470)
NEC for r=0.9 all KL = 0.361 +- 0.237 (in-sample avg dev_std = 0.470)
NEC for r=0.9 all L1 = 0.349 +- 0.198 (in-sample avg dev_std = 0.470)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.688
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.42977875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.623
NEC for r=1.0 class 0 = 0.412 +- 0.218 (in-sample avg dev_std = 0.453)
NEC for r=1.0 class 1 = 0.154 +- 0.218 (in-sample avg dev_std = 0.453)
NEC for r=1.0 class 2 = 0.441 +- 0.218 (in-sample avg dev_std = 0.453)
NEC for r=1.0 all KL = 0.331 +- 0.218 (in-sample avg dev_std = 0.453)
NEC for r=1.0 all L1 = 0.339 +- 0.187 (in-sample avg dev_std = 0.453)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:08:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:31 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:08:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 0.8609
Train Loss: 0.4701
ID Validation ACCURACY: 0.8647
ID Validation Loss: 0.4763
ID Test ACCURACY: 0.8613
ID Test Loss: 0.4696
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3557
OOD Test ACCURACY: 0.6877
OOD Test Loss: 0.8634

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.8226
Train Loss: 0.5752
ID Validation ACCURACY: 0.8187
ID Validation Loss: 0.5929
ID Test ACCURACY: 0.8270
ID Test Loss: 0.5741
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3784
OOD Test ACCURACY: 0.6873
OOD Test Loss: 0.8184

[0m[1;37mINFO[0m: [1mChartInfo 0.8613 0.6877 0.8270 0.6873 0.8187 0.9313[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.673
WIoU for r=0.3 = 0.601
F1 for r=0.6 = 0.606
WIoU for r=0.6 = 0.704
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.708
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.708
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.684
WIoU for r=0.3 = 0.619
F1 for r=0.6 = 0.609
WIoU for r=0.6 = 0.725
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.731
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.731
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.375
WIoU for r=0.3 = 0.251
F1 for r=0.6 = 0.476
WIoU for r=0.6 = 0.332
F1 for r=0.9 = 0.555
WIoU for r=0.9 = 0.390
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.414
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.530
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.665
WIoU for r=0.6 = 0.594
F1 for r=0.9 = 0.585
WIoU for r=0.9 = 0.612
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.612


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.6733899999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.600575
len(reference) = 795
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.438
SUFF++ for r=0.3 class 0 = 0.53 +- 0.287 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 1 = 0.566 +- 0.287 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 class 2 = 0.497 +- 0.287 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 all KL = 0.562 +- 0.287 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.3 all L1 = 0.532 +- 0.162 (in-sample avg dev_std = 0.485)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.6059187500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.703755
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.692
SUFF++ for r=0.6 class 0 = 0.604 +- 0.266 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 1 = 0.676 +- 0.266 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.266 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all KL = 0.66 +- 0.266 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all L1 = 0.636 +- 0.178 (in-sample avg dev_std = 0.472)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  0.47236125
Model XAI WIoU of binarized graphs for r=0.9 =  0.7082712500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.849
SUFF++ for r=0.9 class 0 = 0.866 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 2 = 0.867 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.911 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.868 +- 0.148 (in-sample avg dev_std = 0.265)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  0.683785
Model XAI WIoU of binarized graphs for r=0.3 =  0.61948
len(reference) = 794
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.422
SUFF++ for r=0.3 class 0 = 0.519 +- 0.280 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 class 1 = 0.558 +- 0.280 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 class 2 = 0.504 +- 0.280 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 all KL = 0.548 +- 0.280 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 all L1 = 0.527 +- 0.155 (in-sample avg dev_std = 0.504)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  0.6093575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7249937499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.69
SUFF++ for r=0.6 class 0 = 0.62 +- 0.270 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.684 +- 0.270 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.63 +- 0.270 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.662 +- 0.270 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.645 +- 0.173 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.861
Model XAI F1 of binarized graphs for r=0.9 =  0.4743562499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.7314750000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.839
SUFF++ for r=0.9 class 0 = 0.857 +- 0.197 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 1 = 0.872 +- 0.197 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 2 = 0.883 +- 0.197 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all KL = 0.906 +- 0.197 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all L1 = 0.871 +- 0.147 (in-sample avg dev_std = 0.276)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.352
Model XAI F1 of binarized graphs for r=0.3 =  0.37504
Model XAI WIoU of binarized graphs for r=0.3 =  0.25133375
len(reference) = 657
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF++ for r=0.3 class 0 = 0.756 +- 0.110 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 1 = 0.776 +- 0.110 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 2 = 0.753 +- 0.110 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 all KL = 0.876 +- 0.110 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 all L1 = 0.761 +- 0.106 (in-sample avg dev_std = 0.363)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.365
Model XAI F1 of binarized graphs for r=0.6 =  0.47649875
Model XAI WIoU of binarized graphs for r=0.6 =  0.33162874999999997
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.373
SUFF++ for r=0.6 class 0 = 0.694 +- 0.201 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 1 = 0.71 +- 0.201 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 2 = 0.698 +- 0.201 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all KL = 0.808 +- 0.201 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all L1 = 0.701 +- 0.163 (in-sample avg dev_std = 0.373)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.566
Model XAI F1 of binarized graphs for r=0.9 =  0.5546924999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.39015
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.572
SUFF++ for r=0.9 class 0 = 0.856 +- 0.110 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 1 = 0.89 +- 0.110 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 2 = 0.846 +- 0.110 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all KL = 0.933 +- 0.110 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all L1 = 0.864 +- 0.114 (in-sample avg dev_std = 0.264)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.356
Model XAI F1 of binarized graphs for r=0.3 =  0.5304362499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.43287374999999995
len(reference) = 783
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.368
SUFF++ for r=0.3 class 0 = 0.606 +- 0.213 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 1 = 0.633 +- 0.213 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 2 = 0.586 +- 0.213 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all KL = 0.696 +- 0.213 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all L1 = 0.608 +- 0.140 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  0.6654925
Model XAI WIoU of binarized graphs for r=0.6 =  0.59433875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.584
SUFF++ for r=0.6 class 0 = 0.606 +- 0.257 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 1 = 0.734 +- 0.257 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 2 = 0.581 +- 0.257 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all KL = 0.626 +- 0.257 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all L1 = 0.639 +- 0.170 (in-sample avg dev_std = 0.539)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  0.58528875
Model XAI WIoU of binarized graphs for r=0.9 =  0.6124575
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.693
SUFF++ for r=0.9 class 0 = 0.809 +- 0.169 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 1 = 0.92 +- 0.169 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 2 = 0.808 +- 0.169 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all KL = 0.891 +- 0.169 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.162 (in-sample avg dev_std = 0.313)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.6733899999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.600575
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.513 +- 0.302 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.517 +- 0.302 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.553 +- 0.302 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.494 +- 0.302 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.528 +- 0.180 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.6059187500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.703755
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.465
NEC for r=0.6 class 0 = 0.503 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1 = 0.545 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 2 = 0.555 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.513 +- 0.299 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.534 +- 0.160 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  0.47236125
Model XAI WIoU of binarized graphs for r=0.9 =  0.7082712500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.506
NEC for r=0.9 class 0 = 0.487 +- 0.298 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 1 = 0.492 +- 0.298 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 2 = 0.546 +- 0.298 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all KL = 0.5 +- 0.298 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all L1 = 0.508 +- 0.160 (in-sample avg dev_std = 0.498)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7082712500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.517
NEC for r=1.0 class 0 = 0.49 +- 0.292 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 1 = 0.505 +- 0.292 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 2 = 0.537 +- 0.292 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all KL = 0.503 +- 0.292 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all L1 = 0.511 +- 0.154 (in-sample avg dev_std = 0.504)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  0.683785
Model XAI WIoU of binarized graphs for r=0.3 =  0.61948
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.518 +- 0.299 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 1 = 0.513 +- 0.299 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 2 = 0.544 +- 0.299 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all KL = 0.496 +- 0.299 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all L1 = 0.525 +- 0.181 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  0.6093575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7249937499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.46
NEC for r=0.6 class 0 = 0.505 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 1 = 0.522 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 2 = 0.559 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all KL = 0.513 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all L1 = 0.529 +- 0.167 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.861
Model XAI F1 of binarized graphs for r=0.9 =  0.4743562499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.7314750000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.517
NEC for r=0.9 class 0 = 0.49 +- 0.304 (in-sample avg dev_std = 0.499)
NEC for r=0.9 class 1 = 0.486 +- 0.304 (in-sample avg dev_std = 0.499)
NEC for r=0.9 class 2 = 0.546 +- 0.304 (in-sample avg dev_std = 0.499)
NEC for r=0.9 all KL = 0.504 +- 0.304 (in-sample avg dev_std = 0.499)
NEC for r=0.9 all L1 = 0.508 +- 0.163 (in-sample avg dev_std = 0.499)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.861
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7314687499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.514
NEC for r=1.0 class 0 = 0.484 +- 0.301 (in-sample avg dev_std = 0.499)
NEC for r=1.0 class 1 = 0.478 +- 0.301 (in-sample avg dev_std = 0.499)
NEC for r=1.0 class 2 = 0.548 +- 0.301 (in-sample avg dev_std = 0.499)
NEC for r=1.0 all KL = 0.5 +- 0.301 (in-sample avg dev_std = 0.499)
NEC for r=1.0 all L1 = 0.504 +- 0.160 (in-sample avg dev_std = 0.499)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.347
Model XAI F1 of binarized graphs for r=0.3 =  0.37504
Model XAI WIoU of binarized graphs for r=0.3 =  0.25133375
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.139 +- 0.107 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1 = 0.15 +- 0.107 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 2 = 0.145 +- 0.107 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.052 +- 0.107 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.145 +- 0.137 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.365
Model XAI F1 of binarized graphs for r=0.6 =  0.47649875
Model XAI WIoU of binarized graphs for r=0.6 =  0.33162874999999997
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.23 +- 0.198 (in-sample avg dev_std = 0.312)
NEC for r=0.6 class 1 = 0.194 +- 0.198 (in-sample avg dev_std = 0.312)
NEC for r=0.6 class 2 = 0.211 +- 0.198 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all KL = 0.132 +- 0.198 (in-sample avg dev_std = 0.312)
NEC for r=0.6 all L1 = 0.212 +- 0.181 (in-sample avg dev_std = 0.312)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.566
Model XAI F1 of binarized graphs for r=0.9 =  0.5546924999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.39015
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.455
NEC for r=0.9 class 0 = 0.321 +- 0.247 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.317 +- 0.247 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.334 +- 0.247 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.254 +- 0.247 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.324 +- 0.177 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.413605
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.648
NEC for r=1.0 class 0 = 0.367 +- 0.217 (in-sample avg dev_std = 0.597)
NEC for r=1.0 class 1 = 0.452 +- 0.217 (in-sample avg dev_std = 0.597)
NEC for r=1.0 class 2 = 0.378 +- 0.217 (in-sample avg dev_std = 0.597)
NEC for r=1.0 all KL = 0.408 +- 0.217 (in-sample avg dev_std = 0.597)
NEC for r=1.0 all L1 = 0.399 +- 0.145 (in-sample avg dev_std = 0.597)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.354
Model XAI F1 of binarized graphs for r=0.3 =  0.5304362499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.43287374999999995
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.349
NEC for r=0.3 class 0 = 0.468 +- 0.246 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 1 = 0.455 +- 0.246 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 2 = 0.488 +- 0.246 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all KL = 0.37 +- 0.246 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all L1 = 0.471 +- 0.173 (in-sample avg dev_std = 0.429)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  0.6654925
Model XAI WIoU of binarized graphs for r=0.6 =  0.59433875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.453
NEC for r=0.6 class 0 = 0.539 +- 0.276 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 1 = 0.449 +- 0.276 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 2 = 0.596 +- 0.276 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all KL = 0.556 +- 0.276 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all L1 = 0.529 +- 0.148 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  0.58528875
Model XAI WIoU of binarized graphs for r=0.9 =  0.6124575
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.472 +- 0.226 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 1 = 0.403 +- 0.226 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 2 = 0.534 +- 0.226 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all KL = 0.451 +- 0.226 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all L1 = 0.471 +- 0.135 (in-sample avg dev_std = 0.532)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.691
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.61241375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.524
NEC for r=1.0 class 0 = 0.483 +- 0.227 (in-sample avg dev_std = 0.535)
NEC for r=1.0 class 1 = 0.413 +- 0.227 (in-sample avg dev_std = 0.535)
NEC for r=1.0 class 2 = 0.533 +- 0.227 (in-sample avg dev_std = 0.535)
NEC for r=1.0 all KL = 0.457 +- 0.227 (in-sample avg dev_std = 0.535)
NEC for r=1.0 all L1 = 0.478 +- 0.130 (in-sample avg dev_std = 0.535)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.685, 0.643, 0.9, 1.0], 'all_L1': [0.574, 0.592, 0.844, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.661, 0.909, 1.0], 'all_L1': [0.587, 0.65, 0.867, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.636, 0.932, 1.0], 'all_L1': [0.496, 0.644, 0.893, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.57, 0.643, 0.924, 1.0], 'all_L1': [0.553, 0.646, 0.881, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.66, 0.911, 1.0], 'all_L1': [0.532, 0.636, 0.868, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.348, 0.478, 0.51, 0.518], 'all_L1': [0.462, 0.51, 0.501, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.505, 0.491, 0.49], 'all_L1': [0.435, 0.503, 0.468, 0.469]}), defaultdict(<class 'list'>, {'all_KL': [0.501, 0.58, 0.542, 0.545], 'all_L1': [0.534, 0.55, 0.504, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.492, 0.525, 0.485, 0.485], 'all_L1': [0.509, 0.5, 0.457, 0.459]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.513, 0.5, 0.503], 'all_L1': [0.528, 0.534, 0.508, 0.511]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.69, 0.642, 0.904, 1.0], 'all_L1': [0.578, 0.595, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.662, 0.91, 1.0], 'all_L1': [0.581, 0.644, 0.864, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.649, 0.937, 1.0], 'all_L1': [0.508, 0.653, 0.896, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.649, 0.928, 1.0], 'all_L1': [0.549, 0.651, 0.884, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.662, 0.906, 1.0], 'all_L1': [0.527, 0.645, 0.871, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.353, 0.481, 0.509, 0.527], 'all_L1': [0.467, 0.512, 0.5, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.348, 0.508, 0.491, 0.481], 'all_L1': [0.432, 0.506, 0.47, 0.461]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.572, 0.547, 0.548], 'all_L1': [0.531, 0.543, 0.511, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.516, 0.486, 0.486], 'all_L1': [0.507, 0.497, 0.459, 0.459]}), defaultdict(<class 'list'>, {'all_KL': [0.496, 0.513, 0.504, 0.5], 'all_L1': [0.525, 0.529, 0.508, 0.504]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.604, 0.809, 0.971, 1.0], 'all_L1': [0.648, 0.807, 0.936, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.617, 0.911, 0.984, 1.0], 'all_L1': [0.646, 0.908, 0.957, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.912, 0.991, 1.0], 'all_L1': [0.617, 0.912, 0.973, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.83, 0.984, 1.0], 'all_L1': [0.666, 0.851, 0.96, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.876, 0.808, 0.933, 1.0], 'all_L1': [0.761, 0.701, 0.864, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.504, 0.434, 0.318, 0.308], 'all_L1': [0.496, 0.36, 0.299, 0.295]}), defaultdict(<class 'list'>, {'all_KL': [0.496, 0.448, 0.279, 0.279], 'all_L1': [0.487, 0.357, 0.281, 0.285]}), defaultdict(<class 'list'>, {'all_KL': [0.667, 0.59, 0.414, 0.402], 'all_L1': [0.577, 0.444, 0.366, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.615, 0.476, 0.327, 0.323], 'all_L1': [0.537, 0.346, 0.292, 0.291]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.132, 0.254, 0.408], 'all_L1': [0.145, 0.212, 0.324, 0.399]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.888, 0.809, 0.927, 1.0], 'all_L1': [0.755, 0.682, 0.869, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.902, 0.782, 0.9, 1.0], 'all_L1': [0.751, 0.688, 0.858, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.797, 0.714, 0.926, 1.0], 'all_L1': [0.638, 0.624, 0.867, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.801, 0.845, 0.93, 1.0], 'all_L1': [0.657, 0.758, 0.87, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.626, 0.891, 1.0], 'all_L1': [0.608, 0.639, 0.844, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.092, 0.284, 0.423, 0.372], 'all_L1': [0.237, 0.399, 0.408, 0.377]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.322, 0.422, 0.393], 'all_L1': [0.241, 0.412, 0.386, 0.376]}), defaultdict(<class 'list'>, {'all_KL': [0.2, 0.399, 0.404, 0.384], 'all_L1': [0.363, 0.478, 0.372, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.151, 0.253, 0.361, 0.331], 'all_L1': [0.311, 0.325, 0.349, 0.339]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.556, 0.451, 0.457], 'all_L1': [0.471, 0.529, 0.471, 0.478]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.548 +- 0.032, 0.634 +- 0.021, 0.871 +- 0.016, 1.000 +- 0.000
suff++ class all_KL  =  0.599 +- 0.065, 0.649 +- 0.010, 0.915 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.432 +- 0.013, 0.686 +- 0.031, 0.854 +- 0.021
nec class all_L1  =  0.494 +- 0.039, 0.519 +- 0.019, 0.488 +- 0.021, 0.489 +- 0.021
nec class all_KL  =  0.438 +- 0.070, 0.520 +- 0.034, 0.506 +- 0.020, 0.508 +- 0.022
nec_acc_int  =  0.374 +- 0.043, 0.522 +- 0.056, 0.592 +- 0.062, 0.593 +- 0.054

Eval split id_val
suff++ class all_L1  =  0.549 +- 0.028, 0.638 +- 0.022, 0.873 +- 0.016, 1.000 +- 0.000
suff++ class all_KL  =  0.598 +- 0.067, 0.653 +- 0.008, 0.917 +- 0.013, 1.000 +- 0.000
suff++_acc_int  =  0.427 +- 0.015, 0.678 +- 0.035, 0.836 +- 0.019
nec class all_L1  =  0.492 +- 0.038, 0.517 +- 0.017, 0.490 +- 0.021, 0.487 +- 0.023
nec class all_KL  =  0.437 +- 0.071, 0.518 +- 0.030, 0.507 +- 0.021, 0.508 +- 0.025
nec_acc_int  =  0.368 +- 0.038, 0.513 +- 0.048, 0.585 +- 0.056, 0.587 +- 0.057

Eval split val
suff++ class all_L1  =  0.668 +- 0.049, 0.836 +- 0.078, 0.938 +- 0.039, 1.000 +- 0.000
suff++ class all_KL  =  0.643 +- 0.125, 0.854 +- 0.048, 0.973 +- 0.021, 1.000 +- 0.000
suff++_acc_int  =  0.488 +- 0.076, 0.784 +- 0.207, 0.850 +- 0.140
nec class all_L1  =  0.448 +- 0.155, 0.344 +- 0.075, 0.312 +- 0.030, 0.326 +- 0.045
nec class all_KL  =  0.467 +- 0.217, 0.416 +- 0.152, 0.318 +- 0.055, 0.344 +- 0.052
nec_acc_int  =  0.415 +- 0.068, 0.653 +- 0.154, 0.708 +- 0.134, 0.749 +- 0.064

Eval split test
suff++ class all_L1  =  0.682 +- 0.060, 0.678 +- 0.047, 0.862 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.817 +- 0.074, 0.755 +- 0.078, 0.915 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.345 +- 0.020, 0.452 +- 0.075, 0.697 +- 0.093
nec class all_L1  =  0.325 +- 0.087, 0.429 +- 0.070, 0.397 +- 0.042, 0.387 +- 0.048
nec class all_KL  =  0.180 +- 0.104, 0.363 +- 0.108, 0.412 +- 0.030, 0.387 +- 0.041
nec_acc_int  =  0.345 +- 0.033, 0.450 +- 0.035, 0.609 +- 0.062, 0.617 +- 0.067


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.521 +- 0.008, 0.577 +- 0.015, 0.679 +- 0.012, 0.744 +- 0.010
Faith. Armon (L1)= 		  =  0.517 +- 0.012, 0.571 +- 0.015, 0.625 +- 0.017, 0.656 +- 0.019
Faith. GMean (L1)= 	  =  0.519 +- 0.010, 0.574 +- 0.015, 0.651 +- 0.014, 0.699 +- 0.015
Faith. Aritm (KL)= 		  =  0.518 +- 0.010, 0.584 +- 0.015, 0.710 +- 0.013, 0.754 +- 0.011
Faith. Armon (KL)= 		  =  0.497 +- 0.029, 0.577 +- 0.019, 0.651 +- 0.018, 0.674 +- 0.019
Faith. GMean (KL)= 	  =  0.507 +- 0.018, 0.580 +- 0.017, 0.680 +- 0.016, 0.713 +- 0.015

Eval split id_val
Faith. Aritm (L1)= 		  =  0.521 +- 0.008, 0.577 +- 0.015, 0.681 +- 0.014, 0.744 +- 0.011
Faith. Armon (L1)= 		  =  0.517 +- 0.011, 0.571 +- 0.015, 0.627 +- 0.018, 0.655 +- 0.020
Faith. GMean (L1)= 	  =  0.519 +- 0.009, 0.574 +- 0.015, 0.653 +- 0.016, 0.698 +- 0.016
Faith. Aritm (KL)= 		  =  0.517 +- 0.007, 0.585 +- 0.016, 0.712 +- 0.015, 0.754 +- 0.013
Faith. Armon (KL)= 		  =  0.496 +- 0.028, 0.577 +- 0.018, 0.653 +- 0.020, 0.674 +- 0.022
Faith. GMean (KL)= 	  =  0.506 +- 0.017, 0.581 +- 0.017, 0.682 +- 0.017, 0.713 +- 0.018

Eval split val
Faith. Aritm (L1)= 		  =  0.558 +- 0.054, 0.590 +- 0.074, 0.625 +- 0.025, 0.663 +- 0.023
Faith. Armon (L1)= 		  =  0.510 +- 0.134, 0.485 +- 0.088, 0.468 +- 0.034, 0.490 +- 0.050
Faith. GMean (L1)= 	  =  0.531 +- 0.101, 0.535 +- 0.082, 0.541 +- 0.028, 0.569 +- 0.039
Faith. Aritm (KL)= 		  =  0.555 +- 0.051, 0.635 +- 0.093, 0.646 +- 0.035, 0.672 +- 0.026
Faith. Armon (KL)= 		  =  0.477 +- 0.191, 0.543 +- 0.166, 0.478 +- 0.062, 0.510 +- 0.057
Faith. GMean (KL)= 	  =  0.503 +- 0.147, 0.584 +- 0.137, 0.555 +- 0.051, 0.585 +- 0.044

Eval split test
Faith. Aritm (L1)= 		  =  0.503 +- 0.019, 0.553 +- 0.016, 0.629 +- 0.017, 0.693 +- 0.024
Faith. Armon (L1)= 		  =  0.428 +- 0.064, 0.519 +- 0.041, 0.542 +- 0.036, 0.556 +- 0.048
Faith. GMean (L1)= 	  =  0.463 +- 0.042, 0.536 +- 0.028, 0.584 +- 0.027, 0.621 +- 0.037
Faith. Aritm (KL)= 		  =  0.498 +- 0.019, 0.559 +- 0.016, 0.663 +- 0.010, 0.694 +- 0.020
Faith. Armon (KL)= 		  =  0.276 +- 0.120, 0.473 +- 0.071, 0.567 +- 0.026, 0.557 +- 0.042
Faith. GMean (KL)= 	  =  0.363 +- 0.085, 0.513 +- 0.045, 0.613 +- 0.019, 0.622 +- 0.032
Computed for split load_split = id



Completed in  0:24:30.186232  for LECIGIN GOODMotif/basis



DONE LECI GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:13:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:13:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:13:58 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:00 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:04 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:14:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.8957
Train Loss: 0.4254
ID Validation ACCURACY: 0.9010
ID Validation Loss: 0.4344
ID Test ACCURACY: 0.8963
ID Test Loss: 0.4276
OOD Validation ACCURACY: 0.8990
OOD Validation Loss: 0.3962
OOD Test ACCURACY: 0.8563
OOD Test Loss: 0.4910

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4466
ID Validation ACCURACY: 0.8887
ID Validation Loss: 0.4594
ID Test ACCURACY: 0.8910
ID Test Loss: 0.4409
OOD Validation ACCURACY: 0.9113
OOD Validation Loss: 0.3833
OOD Test ACCURACY: 0.8360
OOD Test Loss: 0.5033

[0m[1;37mINFO[0m: [1mChartInfo 0.8963 0.8563 0.8910 0.8360 0.8887 0.9113[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.732
WIoU for r=0.3 = 0.704
F1 for r=0.6 = 0.618
WIoU for r=0.6 = 0.807
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.808
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.808
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.736
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.620
WIoU for r=0.6 = 0.820
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.822
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.822
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.837
WIoU for r=0.3 = 0.868
F1 for r=0.6 = 0.757
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.607
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.548
WIoU for r=0.3 = 0.416
F1 for r=0.6 = 0.699
WIoU for r=0.6 = 0.605
F1 for r=0.9 = 0.594
WIoU for r=0.9 = 0.613
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.613


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.7322312500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.7040912499999998
len(reference) = 796
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF++ for r=0.3 class 0 = 0.502 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 class 1 = 0.489 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 class 2 = 0.527 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 all KL = 0.445 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 all L1 = 0.506 +- 0.159 (in-sample avg dev_std = 0.566)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  0.617865
Model XAI WIoU of binarized graphs for r=0.6 =  0.8073974999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.785
SUFF++ for r=0.6 class 0 = 0.677 +- 0.271 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 1 = 0.714 +- 0.271 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 2 = 0.721 +- 0.271 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all KL = 0.705 +- 0.271 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all L1 = 0.704 +- 0.210 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.47373625
Model XAI WIoU of binarized graphs for r=0.9 =  0.8077462499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF++ for r=0.9 class 0 = 0.881 +- 0.145 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 class 1 = 0.861 +- 0.145 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 class 2 = 0.883 +- 0.145 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 all KL = 0.922 +- 0.145 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 all L1 = 0.875 +- 0.162 (in-sample avg dev_std = 0.201)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.7356975
Model XAI WIoU of binarized graphs for r=0.3 =  0.71415875
len(reference) = 794
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.517
SUFF++ for r=0.3 class 0 = 0.482 +- 0.272 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 class 1 = 0.486 +- 0.272 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 class 2 = 0.53 +- 0.272 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 all KL = 0.437 +- 0.272 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 all L1 = 0.5 +- 0.169 (in-sample avg dev_std = 0.570)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  0.620225
Model XAI WIoU of binarized graphs for r=0.6 =  0.81994125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.765
SUFF++ for r=0.6 class 0 = 0.684 +- 0.271 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 1 = 0.72 +- 0.271 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 2 = 0.73 +- 0.271 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all KL = 0.714 +- 0.271 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all L1 = 0.712 +- 0.207 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.47572875
Model XAI WIoU of binarized graphs for r=0.9 =  0.82163125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.878
SUFF++ for r=0.9 class 0 = 0.896 +- 0.133 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1 = 0.859 +- 0.133 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 2 = 0.915 +- 0.133 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.932 +- 0.133 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.145 (in-sample avg dev_std = 0.197)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.8365325
Model XAI WIoU of binarized graphs for r=0.3 =  0.86823375
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0 = 0.624 +- 0.323 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 1 = 0.732 +- 0.323 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 2 = 0.549 +- 0.323 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all KL = 0.515 +- 0.323 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all L1 = 0.635 +- 0.197 (in-sample avg dev_std = 0.554)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.7572424999999999
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.87
SUFF++ for r=0.6 class 0 = 0.859 +- 0.236 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 1 = 0.863 +- 0.236 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 2 = 0.84 +- 0.236 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all KL = 0.831 +- 0.236 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all L1 = 0.854 +- 0.155 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.6069075
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.907
SUFF++ for r=0.9 class 0 = 0.95 +- 0.120 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 class 1 = 0.951 +- 0.120 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 class 2 = 0.943 +- 0.120 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 all KL = 0.969 +- 0.120 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.110 (in-sample avg dev_std = 0.175)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.427
Model XAI F1 of binarized graphs for r=0.3 =  0.5481975
Model XAI WIoU of binarized graphs for r=0.3 =  0.41584125
len(reference) = 794
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.385
SUFF++ for r=0.3 class 0 = 0.465 +- 0.273 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 class 1 = 0.474 +- 0.273 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 class 2 = 0.495 +- 0.273 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 all KL = 0.389 +- 0.273 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 all L1 = 0.478 +- 0.110 (in-sample avg dev_std = 0.537)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.804
Model XAI F1 of binarized graphs for r=0.6 =  0.6993112499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.60536125
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0 = 0.568 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 1 = 0.788 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 2 = 0.758 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all KL = 0.698 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all L1 = 0.703 +- 0.225 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.876
Model XAI F1 of binarized graphs for r=0.9 =  0.5939175
Model XAI WIoU of binarized graphs for r=0.9 =  0.61302
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.797
SUFF++ for r=0.9 class 0 = 0.747 +- 0.186 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 class 1 = 0.941 +- 0.186 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 class 2 = 0.723 +- 0.186 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 all KL = 0.848 +- 0.186 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 all L1 = 0.801 +- 0.185 (in-sample avg dev_std = 0.325)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.649
Model XAI F1 of binarized graphs for r=0.3 =  0.7322312500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.7040912499999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.366
NEC for r=0.3 class 0 = 0.585 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.57 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.614 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.623 +- 0.282 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.59 +- 0.141 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  0.617865
Model XAI WIoU of binarized graphs for r=0.6 =  0.8073974999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.483
NEC for r=0.6 class 0 = 0.534 +- 0.292 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 1 = 0.551 +- 0.292 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 2 = 0.582 +- 0.292 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all KL = 0.595 +- 0.292 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all L1 = 0.556 +- 0.159 (in-sample avg dev_std = 0.480)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.47373625
Model XAI WIoU of binarized graphs for r=0.9 =  0.8077462499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.538
NEC for r=0.9 class 0 = 0.499 +- 0.291 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 1 = 0.508 +- 0.291 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 2 = 0.538 +- 0.291 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all KL = 0.537 +- 0.291 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all L1 = 0.515 +- 0.160 (in-sample avg dev_std = 0.535)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.8077462499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.537
NEC for r=1.0 class 0 = 0.495 +- 0.285 (in-sample avg dev_std = 0.539)
NEC for r=1.0 class 1 = 0.512 +- 0.285 (in-sample avg dev_std = 0.539)
NEC for r=1.0 class 2 = 0.538 +- 0.285 (in-sample avg dev_std = 0.539)
NEC for r=1.0 all KL = 0.537 +- 0.285 (in-sample avg dev_std = 0.539)
NEC for r=1.0 all L1 = 0.515 +- 0.159 (in-sample avg dev_std = 0.539)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.685
Model XAI F1 of binarized graphs for r=0.3 =  0.7356975
Model XAI WIoU of binarized graphs for r=0.3 =  0.71415875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.366
NEC for r=0.3 class 0 = 0.59 +- 0.280 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 1 = 0.553 +- 0.280 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 2 = 0.621 +- 0.280 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all KL = 0.63 +- 0.280 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all L1 = 0.588 +- 0.143 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  0.620225
Model XAI WIoU of binarized graphs for r=0.6 =  0.81994125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.481
NEC for r=0.6 class 0 = 0.529 +- 0.300 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 1 = 0.543 +- 0.300 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 2 = 0.586 +- 0.300 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all KL = 0.592 +- 0.300 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all L1 = 0.554 +- 0.164 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.47572875
Model XAI WIoU of binarized graphs for r=0.9 =  0.82163125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.539
NEC for r=0.9 class 0 = 0.496 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 1 = 0.483 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 2 = 0.539 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all KL = 0.53 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all L1 = 0.506 +- 0.167 (in-sample avg dev_std = 0.534)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.906
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.821625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.539
NEC for r=1.0 class 0 = 0.484 +- 0.302 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 1 = 0.506 +- 0.302 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 2 = 0.532 +- 0.302 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all KL = 0.531 +- 0.302 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all L1 = 0.508 +- 0.173 (in-sample avg dev_std = 0.525)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.8365325
Model XAI WIoU of binarized graphs for r=0.3 =  0.86823375
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.209
NEC for r=0.3 class 0 = 0.629 +- 0.265 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 1 = 0.629 +- 0.265 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 2 = 0.626 +- 0.265 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all KL = 0.752 +- 0.265 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all L1 = 0.628 +- 0.130 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.7572424999999999
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.558
NEC for r=0.6 class 0 = 0.469 +- 0.264 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 1 = 0.436 +- 0.264 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 2 = 0.498 +- 0.264 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all KL = 0.578 +- 0.264 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all L1 = 0.468 +- 0.161 (in-sample avg dev_std = 0.631)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.6069075
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.632
NEC for r=0.9 class 0 = 0.369 +- 0.233 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 1 = 0.36 +- 0.233 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 2 = 0.431 +- 0.233 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all KL = 0.416 +- 0.233 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all L1 = 0.387 +- 0.155 (in-sample avg dev_std = 0.601)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.638
NEC for r=1.0 class 0 = 0.36 +- 0.230 (in-sample avg dev_std = 0.593)
NEC for r=1.0 class 1 = 0.356 +- 0.230 (in-sample avg dev_std = 0.593)
NEC for r=1.0 class 2 = 0.438 +- 0.230 (in-sample avg dev_std = 0.593)
NEC for r=1.0 all KL = 0.409 +- 0.230 (in-sample avg dev_std = 0.593)
NEC for r=1.0 all L1 = 0.385 +- 0.155 (in-sample avg dev_std = 0.593)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.426
Model XAI F1 of binarized graphs for r=0.3 =  0.5481975
Model XAI WIoU of binarized graphs for r=0.3 =  0.41584125
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.363
NEC for r=0.3 class 0 = 0.533 +- 0.296 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 1 = 0.564 +- 0.296 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 2 = 0.534 +- 0.296 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all KL = 0.598 +- 0.296 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all L1 = 0.543 +- 0.159 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  0.6993112499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.60536125
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.521
NEC for r=0.6 class 0 = 0.611 +- 0.267 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 1 = 0.455 +- 0.267 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 2 = 0.608 +- 0.267 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all KL = 0.654 +- 0.267 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all L1 = 0.56 +- 0.165 (in-sample avg dev_std = 0.589)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.876
Model XAI F1 of binarized graphs for r=0.9 =  0.5939175
Model XAI WIoU of binarized graphs for r=0.9 =  0.61302
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.512 +- 0.234 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 1 = 0.388 +- 0.234 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 2 = 0.492 +- 0.234 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all KL = 0.494 +- 0.234 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all L1 = 0.465 +- 0.151 (in-sample avg dev_std = 0.573)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.876
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.6129950000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.636
NEC for r=1.0 class 0 = 0.503 +- 0.228 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 1 = 0.361 +- 0.228 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 2 = 0.453 +- 0.228 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all KL = 0.467 +- 0.228 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all L1 = 0.44 +- 0.148 (in-sample avg dev_std = 0.572)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:18:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:18:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:08 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:19:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9083
Train Loss: 0.4103
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4320
ID Test ACCURACY: 0.9007
ID Test Loss: 0.4283
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3518
OOD Test ACCURACY: 0.6320
OOD Test Loss: 0.8938

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.8859
Train Loss: 0.4323
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.8767
ID Test Loss: 0.4555
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3934
OOD Test ACCURACY: 0.7107
OOD Test Loss: 0.7650

[0m[1;37mINFO[0m: [1mChartInfo 0.9007 0.6320 0.8767 0.7107 0.8810 0.9303[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.699
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.602
WIoU for r=0.6 = 0.753
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.761
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.761
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.697
WIoU for r=0.3 = 0.664
F1 for r=0.6 = 0.601
WIoU for r=0.6 = 0.760
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.769
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.769
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.863
WIoU for r=0.3 = 0.860
F1 for r=0.6 = 0.771
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.611
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.341
WIoU for r=0.3 = 0.248
F1 for r=0.6 = 0.493
WIoU for r=0.6 = 0.349
F1 for r=0.9 = 0.558
WIoU for r=0.9 = 0.382
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.383


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.674
Model XAI F1 of binarized graphs for r=0.3 =  0.699405
Model XAI WIoU of binarized graphs for r=0.3 =  0.6601474999999999
len(reference) = 792
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.468
SUFF++ for r=0.3 class 0 = 0.484 +- 0.288 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 class 1 = 0.545 +- 0.288 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 class 2 = 0.434 +- 0.288 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 all KL = 0.431 +- 0.288 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 all L1 = 0.489 +- 0.171 (in-sample avg dev_std = 0.562)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.889
Model XAI F1 of binarized graphs for r=0.6 =  0.60170875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7525375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.734
SUFF++ for r=0.6 class 0 = 0.589 +- 0.271 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 1 = 0.709 +- 0.271 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 2 = 0.649 +- 0.271 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all KL = 0.627 +- 0.271 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all L1 = 0.65 +- 0.184 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.4723887500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.76107
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.888
SUFF++ for r=0.9 class 0 = 0.813 +- 0.179 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1 = 0.844 +- 0.179 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 2 = 0.906 +- 0.179 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.877 +- 0.179 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.854 +- 0.145 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.69667625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6639499999999999
len(reference) = 792
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.463
SUFF++ for r=0.3 class 0 = 0.469 +- 0.285 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.3 class 1 = 0.561 +- 0.285 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.3 class 2 = 0.44 +- 0.285 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.3 all KL = 0.424 +- 0.285 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.3 all L1 = 0.49 +- 0.168 (in-sample avg dev_std = 0.567)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  0.6011525
Model XAI WIoU of binarized graphs for r=0.6 =  0.7596299999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.727
SUFF++ for r=0.6 class 0 = 0.595 +- 0.268 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 class 1 = 0.7 +- 0.268 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 class 2 = 0.678 +- 0.268 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 all KL = 0.638 +- 0.268 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 all L1 = 0.659 +- 0.186 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.47432874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.76930125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.819 +- 0.170 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.170 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 2 = 0.919 +- 0.170 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all KL = 0.89 +- 0.170 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all L1 = 0.864 +- 0.140 (in-sample avg dev_std = 0.263)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.8628837500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8600175
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0 = 0.627 +- 0.332 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 class 1 = 0.796 +- 0.332 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 class 2 = 0.541 +- 0.332 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 all KL = 0.479 +- 0.332 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 all L1 = 0.654 +- 0.219 (in-sample avg dev_std = 0.597)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.7712924999999999
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.883
SUFF++ for r=0.6 class 0 = 0.919 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 class 1 = 0.809 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 class 2 = 0.906 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 all KL = 0.873 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.6 all L1 = 0.878 +- 0.136 (in-sample avg dev_std = 0.320)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.6110625000000001
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.913
SUFF++ for r=0.9 class 0 = 0.951 +- 0.092 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 class 1 = 0.921 +- 0.092 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 class 2 = 0.969 +- 0.092 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 all KL = 0.97 +- 0.092 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 all L1 = 0.947 +- 0.087 (in-sample avg dev_std = 0.166)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.353
Model XAI F1 of binarized graphs for r=0.3 =  0.34097500000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.24816375000000002
len(reference) = 760
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.354
SUFF++ for r=0.3 class 0 = 0.637 +- 0.146 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.146 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 2 = 0.627 +- 0.146 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all KL = 0.749 +- 0.146 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all L1 = 0.628 +- 0.112 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.421
Model XAI F1 of binarized graphs for r=0.6 =  0.49264624999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.34866125
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.441
SUFF++ for r=0.6 class 0 = 0.594 +- 0.223 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1 = 0.652 +- 0.223 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 2 = 0.546 +- 0.223 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.68 +- 0.223 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.597 +- 0.166 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.647
Model XAI F1 of binarized graphs for r=0.9 =  0.55754125
Model XAI WIoU of binarized graphs for r=0.9 =  0.38215125
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.671
SUFF++ for r=0.9 class 0 = 0.718 +- 0.172 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.172 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 2 = 0.769 +- 0.172 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.852 +- 0.172 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.178 (in-sample avg dev_std = 0.265)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  0.699405
Model XAI WIoU of binarized graphs for r=0.3 =  0.6601474999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.397
NEC for r=0.3 class 0 = 0.531 +- 0.300 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 1 = 0.481 +- 0.300 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 2 = 0.629 +- 0.300 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all KL = 0.591 +- 0.300 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all L1 = 0.546 +- 0.169 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.889
Model XAI F1 of binarized graphs for r=0.6 =  0.60170875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7525375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.516
NEC for r=0.6 class 0 = 0.529 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.466 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.603 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.572 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.532 +- 0.171 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.4723887500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.76107
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.567
NEC for r=0.9 class 0 = 0.487 +- 0.293 (in-sample avg dev_std = 0.574)
NEC for r=0.9 class 1 = 0.463 +- 0.293 (in-sample avg dev_std = 0.574)
NEC for r=0.9 class 2 = 0.558 +- 0.293 (in-sample avg dev_std = 0.574)
NEC for r=0.9 all KL = 0.541 +- 0.293 (in-sample avg dev_std = 0.574)
NEC for r=0.9 all L1 = 0.502 +- 0.167 (in-sample avg dev_std = 0.574)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7610575
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.587
NEC for r=1.0 class 0 = 0.481 +- 0.292 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 1 = 0.448 +- 0.292 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 2 = 0.549 +- 0.292 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all KL = 0.527 +- 0.292 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all L1 = 0.492 +- 0.164 (in-sample avg dev_std = 0.569)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.632
Model XAI F1 of binarized graphs for r=0.3 =  0.69667625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6639499999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.382
NEC for r=0.3 class 0 = 0.542 +- 0.301 (in-sample avg dev_std = 0.501)
NEC for r=0.3 class 1 = 0.477 +- 0.301 (in-sample avg dev_std = 0.501)
NEC for r=0.3 class 2 = 0.621 +- 0.301 (in-sample avg dev_std = 0.501)
NEC for r=0.3 all KL = 0.599 +- 0.301 (in-sample avg dev_std = 0.501)
NEC for r=0.3 all L1 = 0.548 +- 0.173 (in-sample avg dev_std = 0.501)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  0.6011525
Model XAI WIoU of binarized graphs for r=0.6 =  0.7596299999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.514
NEC for r=0.6 class 0 = 0.528 +- 0.299 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 1 = 0.449 +- 0.299 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 2 = 0.598 +- 0.299 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all KL = 0.563 +- 0.299 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all L1 = 0.525 +- 0.180 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.47432874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.76930125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.568
NEC for r=0.9 class 0 = 0.478 +- 0.298 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 1 = 0.447 +- 0.298 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 2 = 0.559 +- 0.298 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all KL = 0.534 +- 0.298 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all L1 = 0.495 +- 0.170 (in-sample avg dev_std = 0.569)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.76930125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.58
NEC for r=1.0 class 0 = 0.481 +- 0.298 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.439 +- 0.298 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.538 +- 0.298 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.525 +- 0.298 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.487 +- 0.170 (in-sample avg dev_std = 0.576)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.8628837500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8600175
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.313
NEC for r=0.3 class 0 = 0.558 +- 0.241 (in-sample avg dev_std = 0.549)
NEC for r=0.3 class 1 = 0.589 +- 0.241 (in-sample avg dev_std = 0.549)
NEC for r=0.3 class 2 = 0.629 +- 0.241 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all KL = 0.772 +- 0.241 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all L1 = 0.592 +- 0.165 (in-sample avg dev_std = 0.549)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.7712924999999999
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.619
NEC for r=0.6 class 0 = 0.336 +- 0.294 (in-sample avg dev_std = 0.660)
NEC for r=0.6 class 1 = 0.385 +- 0.294 (in-sample avg dev_std = 0.660)
NEC for r=0.6 class 2 = 0.507 +- 0.294 (in-sample avg dev_std = 0.660)
NEC for r=0.6 all KL = 0.528 +- 0.294 (in-sample avg dev_std = 0.660)
NEC for r=0.6 all L1 = 0.409 +- 0.181 (in-sample avg dev_std = 0.660)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.6110625000000001
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.678
NEC for r=0.9 class 0 = 0.254 +- 0.251 (in-sample avg dev_std = 0.590)
NEC for r=0.9 class 1 = 0.32 +- 0.251 (in-sample avg dev_std = 0.590)
NEC for r=0.9 class 2 = 0.416 +- 0.251 (in-sample avg dev_std = 0.590)
NEC for r=0.9 all KL = 0.365 +- 0.251 (in-sample avg dev_std = 0.590)
NEC for r=0.9 all L1 = 0.33 +- 0.159 (in-sample avg dev_std = 0.590)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.681
NEC for r=1.0 class 0 = 0.262 +- 0.252 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 1 = 0.317 +- 0.252 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 2 = 0.401 +- 0.252 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all KL = 0.36 +- 0.252 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all L1 = 0.327 +- 0.163 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.345
Model XAI F1 of binarized graphs for r=0.3 =  0.34097500000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.24816375000000002
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.257 +- 0.165 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 1 = 0.247 +- 0.165 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 2 = 0.258 +- 0.165 (in-sample avg dev_std = 0.271)
NEC for r=0.3 all KL = 0.129 +- 0.165 (in-sample avg dev_std = 0.271)
NEC for r=0.3 all L1 = 0.254 +- 0.165 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.421
Model XAI F1 of binarized graphs for r=0.6 =  0.49264624999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.34866125
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.435
NEC for r=0.6 class 0 = 0.417 +- 0.255 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 1 = 0.358 +- 0.255 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 2 = 0.51 +- 0.255 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all KL = 0.351 +- 0.255 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all L1 = 0.43 +- 0.177 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.647
Model XAI F1 of binarized graphs for r=0.9 =  0.55754125
Model XAI WIoU of binarized graphs for r=0.9 =  0.38215125
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.478 +- 0.230 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 1 = 0.256 +- 0.230 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 2 = 0.543 +- 0.230 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all KL = 0.408 +- 0.230 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all L1 = 0.429 +- 0.189 (in-sample avg dev_std = 0.505)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.636
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.38272125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.617
NEC for r=1.0 class 0 = 0.463 +- 0.223 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 1 = 0.257 +- 0.223 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 2 = 0.516 +- 0.223 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all KL = 0.387 +- 0.223 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all L1 = 0.415 +- 0.186 (in-sample avg dev_std = 0.486)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:23:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:23:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:23:57 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:23:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:04 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:24:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9186
Train Loss: 0.3698
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3807
ID Test ACCURACY: 0.9177
ID Test Loss: 0.3790
OOD Validation ACCURACY: 0.8370
OOD Validation Loss: 0.5056
OOD Test ACCURACY: 0.8183
OOD Test Loss: 0.5524

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9143
Train Loss: 0.4007
ID Validation ACCURACY: 0.9140
ID Validation Loss: 0.4218
ID Test ACCURACY: 0.9137
ID Test Loss: 0.4092
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3548
OOD Test ACCURACY: 0.8710
OOD Test Loss: 0.4604

[0m[1;37mINFO[0m: [1mChartInfo 0.9177 0.8183 0.9137 0.8710 0.9140 0.9300[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.699
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.605
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.744
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.743
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.696
WIoU for r=0.3 = 0.655
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.740
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.753
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.753
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.827
WIoU for r=0.3 = 0.872
F1 for r=0.6 = 0.756
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.606
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.466
WIoU for r=0.3 = 0.329
F1 for r=0.6 = 0.625
WIoU for r=0.6 = 0.478
F1 for r=0.9 = 0.593
WIoU for r=0.9 = 0.496
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.495


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  0.6991525
Model XAI WIoU of binarized graphs for r=0.3 =  0.6534299999999998
len(reference) = 787
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF++ for r=0.3 class 0 = 0.52 +- 0.311 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 class 1 = 0.647 +- 0.311 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 class 2 = 0.509 +- 0.311 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all KL = 0.537 +- 0.311 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all L1 = 0.559 +- 0.167 (in-sample avg dev_std = 0.503)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60533
Model XAI WIoU of binarized graphs for r=0.6 =  0.73508125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.753
SUFF++ for r=0.6 class 0 = 0.619 +- 0.285 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 class 1 = 0.728 +- 0.285 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 class 2 = 0.62 +- 0.285 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 all KL = 0.611 +- 0.285 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 all L1 = 0.657 +- 0.183 (in-sample avg dev_std = 0.527)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.944
Model XAI F1 of binarized graphs for r=0.9 =  0.47385
Model XAI WIoU of binarized graphs for r=0.9 =  0.74350375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.903
SUFF++ for r=0.9 class 0 = 0.863 +- 0.169 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 1 = 0.903 +- 0.169 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 2 = 0.899 +- 0.169 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all KL = 0.912 +- 0.169 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all L1 = 0.889 +- 0.141 (in-sample avg dev_std = 0.236)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.674
Model XAI F1 of binarized graphs for r=0.3 =  0.6959337499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6549099999999999
len(reference) = 786
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.497
SUFF++ for r=0.3 class 0 = 0.529 +- 0.303 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 1 = 0.653 +- 0.303 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 2 = 0.511 +- 0.303 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all KL = 0.542 +- 0.303 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all L1 = 0.564 +- 0.167 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.875
Model XAI F1 of binarized graphs for r=0.6 =  0.60345875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7403974999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.735
SUFF++ for r=0.6 class 0 = 0.634 +- 0.296 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 1 = 0.736 +- 0.296 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 2 = 0.613 +- 0.296 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all KL = 0.616 +- 0.296 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all L1 = 0.661 +- 0.186 (in-sample avg dev_std = 0.524)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47577375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.75322125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.89
SUFF++ for r=0.9 class 0 = 0.871 +- 0.162 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1 = 0.895 +- 0.162 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 2 = 0.915 +- 0.162 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.917 +- 0.162 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.894 +- 0.137 (in-sample avg dev_std = 0.225)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.827215
Model XAI WIoU of binarized graphs for r=0.3 =  0.8717900000000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.539
SUFF++ for r=0.3 class 0 = 0.604 +- 0.311 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 1 = 0.737 +- 0.311 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 2 = 0.61 +- 0.311 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all KL = 0.533 +- 0.311 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all L1 = 0.65 +- 0.184 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.842
Model XAI F1 of binarized graphs for r=0.6 =  0.7555675
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.848
SUFF++ for r=0.6 class 0 = 0.861 +- 0.232 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 1 = 0.842 +- 0.232 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 2 = 0.856 +- 0.232 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all KL = 0.832 +- 0.232 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.171 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  0.6056199999999999
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0 = 0.958 +- 0.124 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 1 = 0.95 +- 0.124 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 2 = 0.949 +- 0.124 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all KL = 0.969 +- 0.124 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all L1 = 0.952 +- 0.111 (in-sample avg dev_std = 0.186)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.324
Model XAI F1 of binarized graphs for r=0.3 =  0.466305
Model XAI WIoU of binarized graphs for r=0.3 =  0.32884
len(reference) = 786
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF++ for r=0.3 class 0 = 0.684 +- 0.137 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 1 = 0.69 +- 0.137 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 2 = 0.694 +- 0.137 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 all KL = 0.846 +- 0.137 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 all L1 = 0.689 +- 0.105 (in-sample avg dev_std = 0.293)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.62487875
Model XAI WIoU of binarized graphs for r=0.6 =  0.47819624999999993
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.56
SUFF++ for r=0.6 class 0 = 0.502 +- 0.253 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 1 = 0.794 +- 0.253 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 2 = 0.6 +- 0.253 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all KL = 0.646 +- 0.253 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all L1 = 0.629 +- 0.203 (in-sample avg dev_std = 0.474)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  0.593385
Model XAI WIoU of binarized graphs for r=0.9 =  0.49555375000000007
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.77
SUFF++ for r=0.9 class 0 = 0.642 +- 0.237 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 1 = 0.93 +- 0.237 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 2 = 0.73 +- 0.237 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all KL = 0.805 +- 0.237 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all L1 = 0.764 +- 0.222 (in-sample avg dev_std = 0.348)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  0.6991525
Model XAI WIoU of binarized graphs for r=0.3 =  0.6534299999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.371
NEC for r=0.3 class 0 = 0.556 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.516 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.536 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.551 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.536 +- 0.175 (in-sample avg dev_std = 0.452)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60533
Model XAI WIoU of binarized graphs for r=0.6 =  0.73508125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.517
NEC for r=0.6 class 0 = 0.559 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 1 = 0.515 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 2 = 0.575 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all KL = 0.604 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all L1 = 0.549 +- 0.169 (in-sample avg dev_std = 0.512)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.944
Model XAI F1 of binarized graphs for r=0.9 =  0.47385
Model XAI WIoU of binarized graphs for r=0.9 =  0.74350375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.588
NEC for r=0.9 class 0 = 0.494 +- 0.280 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 1 = 0.506 +- 0.280 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 2 = 0.516 +- 0.280 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all KL = 0.558 +- 0.280 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all L1 = 0.505 +- 0.160 (in-sample avg dev_std = 0.577)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7434962500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.583
NEC for r=1.0 class 0 = 0.503 +- 0.277 (in-sample avg dev_std = 0.564)
NEC for r=1.0 class 1 = 0.511 +- 0.277 (in-sample avg dev_std = 0.564)
NEC for r=1.0 class 2 = 0.51 +- 0.277 (in-sample avg dev_std = 0.564)
NEC for r=1.0 all KL = 0.556 +- 0.277 (in-sample avg dev_std = 0.564)
NEC for r=1.0 all L1 = 0.508 +- 0.158 (in-sample avg dev_std = 0.564)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  0.6959337499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6549099999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.371
NEC for r=0.3 class 0 = 0.571 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.499 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.534 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.55 +- 0.329 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.534 +- 0.180 (in-sample avg dev_std = 0.452)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.875
Model XAI F1 of binarized graphs for r=0.6 =  0.60345875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7403974999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.508
NEC for r=0.6 class 0 = 0.553 +- 0.303 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.507 +- 0.303 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.571 +- 0.303 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.596 +- 0.303 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.544 +- 0.165 (in-sample avg dev_std = 0.508)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47577375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.75322125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.499 +- 0.290 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.493 +- 0.290 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.515 +- 0.290 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.55 +- 0.290 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.502 +- 0.165 (in-sample avg dev_std = 0.561)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7532112500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.513 +- 0.284 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 1 = 0.497 +- 0.284 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 2 = 0.519 +- 0.284 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all KL = 0.559 +- 0.284 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all L1 = 0.51 +- 0.162 (in-sample avg dev_std = 0.563)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.827215
Model XAI WIoU of binarized graphs for r=0.3 =  0.8717900000000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.245
NEC for r=0.3 class 0 = 0.618 +- 0.333 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.536 +- 0.333 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.591 +- 0.333 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.679 +- 0.333 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.582 +- 0.172 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.842
Model XAI F1 of binarized graphs for r=0.6 =  0.7555675
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.549
NEC for r=0.6 class 0 = 0.486 +- 0.271 (in-sample avg dev_std = 0.627)
NEC for r=0.6 class 1 = 0.443 +- 0.271 (in-sample avg dev_std = 0.627)
NEC for r=0.6 class 2 = 0.425 +- 0.271 (in-sample avg dev_std = 0.627)
NEC for r=0.6 all KL = 0.564 +- 0.271 (in-sample avg dev_std = 0.627)
NEC for r=0.6 all L1 = 0.451 +- 0.173 (in-sample avg dev_std = 0.627)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  0.6056199999999999
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.62
NEC for r=0.9 class 0 = 0.389 +- 0.220 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 1 = 0.36 +- 0.220 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 2 = 0.361 +- 0.220 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all KL = 0.398 +- 0.220 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all L1 = 0.37 +- 0.161 (in-sample avg dev_std = 0.592)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.842
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.626
NEC for r=1.0 class 0 = 0.396 +- 0.218 (in-sample avg dev_std = 0.593)
NEC for r=1.0 class 1 = 0.355 +- 0.218 (in-sample avg dev_std = 0.593)
NEC for r=1.0 class 2 = 0.351 +- 0.218 (in-sample avg dev_std = 0.593)
NEC for r=1.0 all KL = 0.393 +- 0.218 (in-sample avg dev_std = 0.593)
NEC for r=1.0 all L1 = 0.368 +- 0.157 (in-sample avg dev_std = 0.593)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.322
Model XAI F1 of binarized graphs for r=0.3 =  0.466305
Model XAI WIoU of binarized graphs for r=0.3 =  0.32884
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.296 +- 0.160 (in-sample avg dev_std = 0.241)
NEC for r=0.3 class 1 = 0.314 +- 0.160 (in-sample avg dev_std = 0.241)
NEC for r=0.3 class 2 = 0.327 +- 0.160 (in-sample avg dev_std = 0.241)
NEC for r=0.3 all KL = 0.154 +- 0.160 (in-sample avg dev_std = 0.241)
NEC for r=0.3 all L1 = 0.312 +- 0.136 (in-sample avg dev_std = 0.241)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.623
Model XAI F1 of binarized graphs for r=0.6 =  0.62487875
Model XAI WIoU of binarized graphs for r=0.6 =  0.47819624999999993
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.56
NEC for r=0.6 class 0 = 0.568 +- 0.273 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 1 = 0.386 +- 0.273 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 2 = 0.596 +- 0.273 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all KL = 0.542 +- 0.273 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all L1 = 0.519 +- 0.171 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  0.593385
Model XAI WIoU of binarized graphs for r=0.9 =  0.49555375000000007
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.642
NEC for r=0.9 class 0 = 0.525 +- 0.239 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 1 = 0.326 +- 0.239 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 2 = 0.495 +- 0.239 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all KL = 0.497 +- 0.239 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all L1 = 0.451 +- 0.168 (in-sample avg dev_std = 0.560)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.836
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.49526749999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.672
NEC for r=1.0 class 0 = 0.494 +- 0.226 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 1 = 0.322 +- 0.226 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 2 = 0.465 +- 0.226 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all KL = 0.467 +- 0.226 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all L1 = 0.429 +- 0.159 (in-sample avg dev_std = 0.563)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:29:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:19 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:25 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:29:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9051
Train Loss: 0.4198
ID Validation ACCURACY: 0.9067
ID Validation Loss: 0.4427
ID Test ACCURACY: 0.9010
ID Test Loss: 0.4254
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4876
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.8108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9004
Train Loss: 0.4155
ID Validation ACCURACY: 0.9010
ID Validation Loss: 0.4316
ID Test ACCURACY: 0.9057
ID Test Loss: 0.4111
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4019
OOD Test ACCURACY: 0.8080
OOD Test Loss: 0.5560

[0m[1;37mINFO[0m: [1mChartInfo 0.9010 0.6950 0.9057 0.8080 0.9010 0.9017[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.687
WIoU for r=0.3 = 0.631
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.746
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.751
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.751
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.681
WIoU for r=0.3 = 0.630
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.759
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.759
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.823
WIoU for r=0.3 = 0.881
F1 for r=0.6 = 0.741
WIoU for r=0.6 = 0.999
F1 for r=0.9 = 0.602
WIoU for r=0.9 = 0.999
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.999
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.342
WIoU for r=0.3 = 0.220
F1 for r=0.6 = 0.480
WIoU for r=0.6 = 0.329
F1 for r=0.9 = 0.553
WIoU for r=0.9 = 0.392
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.400


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.623
Model XAI F1 of binarized graphs for r=0.3 =  0.6866525
Model XAI WIoU of binarized graphs for r=0.3 =  0.63080375
len(reference) = 786
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.43
SUFF++ for r=0.3 class 0 = 0.387 +- 0.264 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 class 1 = 0.387 +- 0.264 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 class 2 = 0.501 +- 0.264 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 all KL = 0.286 +- 0.264 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 all L1 = 0.425 +- 0.184 (in-sample avg dev_std = 0.669)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  0.6078162500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7463075
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.712
SUFF++ for r=0.6 class 0 = 0.589 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 class 1 = 0.614 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 class 2 = 0.617 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 all KL = 0.567 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 all L1 = 0.607 +- 0.185 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.47377375
Model XAI WIoU of binarized graphs for r=0.9 =  0.7507137500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.886
SUFF++ for r=0.9 class 0 = 0.855 +- 0.162 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 1 = 0.845 +- 0.162 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.162 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 all KL = 0.888 +- 0.162 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.159 (in-sample avg dev_std = 0.244)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.623
Model XAI F1 of binarized graphs for r=0.3 =  0.6813862499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6303425
len(reference) = 783
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.425
SUFF++ for r=0.3 class 0 = 0.384 +- 0.252 (in-sample avg dev_std = 0.677)
SUFF++ for r=0.3 class 1 = 0.395 +- 0.252 (in-sample avg dev_std = 0.677)
SUFF++ for r=0.3 class 2 = 0.475 +- 0.252 (in-sample avg dev_std = 0.677)
SUFF++ for r=0.3 all KL = 0.28 +- 0.252 (in-sample avg dev_std = 0.677)
SUFF++ for r=0.3 all L1 = 0.419 +- 0.173 (in-sample avg dev_std = 0.677)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.832
Model XAI F1 of binarized graphs for r=0.6 =  0.60767875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7540287499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.698
SUFF++ for r=0.6 class 0 = 0.614 +- 0.268 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 1 = 0.634 +- 0.268 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 2 = 0.635 +- 0.268 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all KL = 0.596 +- 0.268 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all L1 = 0.628 +- 0.184 (in-sample avg dev_std = 0.515)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.47577375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.75919375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.859 +- 0.160 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 class 1 = 0.868 +- 0.160 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 class 2 = 0.869 +- 0.160 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all KL = 0.899 +- 0.160 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all L1 = 0.865 +- 0.155 (in-sample avg dev_std = 0.224)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  0.82301625
Model XAI WIoU of binarized graphs for r=0.3 =  0.8806087499999999
len(reference) = 799
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.556
SUFF++ for r=0.3 class 0 = 0.591 +- 0.343 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.3 class 1 = 0.751 +- 0.343 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.343 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.3 all KL = 0.466 +- 0.343 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.3 all L1 = 0.628 +- 0.214 (in-sample avg dev_std = 0.630)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.871
Model XAI F1 of binarized graphs for r=0.6 =  0.74063625
Model XAI WIoU of binarized graphs for r=0.6 =  0.99875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.864
SUFF++ for r=0.6 class 0 = 0.852 +- 0.230 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 1 = 0.801 +- 0.230 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 2 = 0.848 +- 0.230 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all KL = 0.819 +- 0.230 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all L1 = 0.834 +- 0.161 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.871
Model XAI F1 of binarized graphs for r=0.9 =  0.6018075
Model XAI WIoU of binarized graphs for r=0.9 =  0.99875
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.884
SUFF++ for r=0.9 class 0 = 0.955 +- 0.103 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 class 1 = 0.937 +- 0.103 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 class 2 = 0.953 +- 0.103 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 all KL = 0.973 +- 0.103 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.100 (in-sample avg dev_std = 0.152)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.339
Model XAI F1 of binarized graphs for r=0.3 =  0.34220124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.22049624999999998
len(reference) = 704
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.342
SUFF++ for r=0.3 class 0 = 0.61 +- 0.243 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.3 class 1 = 0.61 +- 0.243 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.3 class 2 = 0.602 +- 0.243 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.3 all KL = 0.326 +- 0.243 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.3 all L1 = 0.607 +- 0.142 (in-sample avg dev_std = 0.683)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.339
Model XAI F1 of binarized graphs for r=0.6 =  0.47961374999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.32863875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.371
SUFF++ for r=0.6 class 0 = 0.446 +- 0.268 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.6 class 1 = 0.416 +- 0.268 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.6 class 2 = 0.443 +- 0.268 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.6 all KL = 0.323 +- 0.268 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.6 all L1 = 0.435 +- 0.134 (in-sample avg dev_std = 0.665)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  0.55320875
Model XAI WIoU of binarized graphs for r=0.9 =  0.3924849999999999
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.637
SUFF++ for r=0.9 class 0 = 0.801 +- 0.175 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 1 = 0.914 +- 0.175 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 2 = 0.812 +- 0.175 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all KL = 0.864 +- 0.175 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all L1 = 0.841 +- 0.146 (in-sample avg dev_std = 0.323)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.6866525
Model XAI WIoU of binarized graphs for r=0.3 =  0.63080375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.382
NEC for r=0.3 class 0 = 0.589 +- 0.270 (in-sample avg dev_std = 0.605)
NEC for r=0.3 class 1 = 0.528 +- 0.270 (in-sample avg dev_std = 0.605)
NEC for r=0.3 class 2 = 0.633 +- 0.270 (in-sample avg dev_std = 0.605)
NEC for r=0.3 all KL = 0.696 +- 0.270 (in-sample avg dev_std = 0.605)
NEC for r=0.3 all L1 = 0.583 +- 0.177 (in-sample avg dev_std = 0.605)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  0.6078162500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7463075
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.505
NEC for r=0.6 class 0 = 0.537 +- 0.289 (in-sample avg dev_std = 0.568)
NEC for r=0.6 class 1 = 0.505 +- 0.289 (in-sample avg dev_std = 0.568)
NEC for r=0.6 class 2 = 0.614 +- 0.289 (in-sample avg dev_std = 0.568)
NEC for r=0.6 all KL = 0.612 +- 0.289 (in-sample avg dev_std = 0.568)
NEC for r=0.6 all L1 = 0.551 +- 0.168 (in-sample avg dev_std = 0.568)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.47377375
Model XAI WIoU of binarized graphs for r=0.9 =  0.7507137500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.589
NEC for r=0.9 class 0 = 0.475 +- 0.285 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 1 = 0.44 +- 0.285 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 2 = 0.569 +- 0.285 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all KL = 0.542 +- 0.285 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all L1 = 0.494 +- 0.162 (in-sample avg dev_std = 0.581)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.75070375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.591
NEC for r=1.0 class 0 = 0.479 +- 0.282 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 1 = 0.453 +- 0.282 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 2 = 0.565 +- 0.282 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all KL = 0.543 +- 0.282 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all L1 = 0.498 +- 0.161 (in-sample avg dev_std = 0.578)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.623
Model XAI F1 of binarized graphs for r=0.3 =  0.6813862499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6303425
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.587 +- 0.267 (in-sample avg dev_std = 0.598)
NEC for r=0.3 class 1 = 0.523 +- 0.267 (in-sample avg dev_std = 0.598)
NEC for r=0.3 class 2 = 0.615 +- 0.267 (in-sample avg dev_std = 0.598)
NEC for r=0.3 all KL = 0.684 +- 0.267 (in-sample avg dev_std = 0.598)
NEC for r=0.3 all L1 = 0.575 +- 0.179 (in-sample avg dev_std = 0.598)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.832
Model XAI F1 of binarized graphs for r=0.6 =  0.60767875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7540287499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.502
NEC for r=0.6 class 0 = 0.529 +- 0.300 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.484 +- 0.300 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.603 +- 0.300 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.593 +- 0.300 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.54 +- 0.180 (in-sample avg dev_std = 0.556)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.47577375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.75919375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.591
NEC for r=0.9 class 0 = 0.47 +- 0.292 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.434 +- 0.292 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.558 +- 0.292 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.534 +- 0.292 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.488 +- 0.167 (in-sample avg dev_std = 0.576)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.906
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7591775000000002
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.589
NEC for r=1.0 class 0 = 0.467 +- 0.293 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 1 = 0.437 +- 0.293 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 2 = 0.572 +- 0.293 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all KL = 0.539 +- 0.293 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all L1 = 0.493 +- 0.173 (in-sample avg dev_std = 0.570)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.611
Model XAI F1 of binarized graphs for r=0.3 =  0.82301625
Model XAI WIoU of binarized graphs for r=0.3 =  0.8806087499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.562 +- 0.316 (in-sample avg dev_std = 0.589)
NEC for r=0.3 class 1 = 0.406 +- 0.316 (in-sample avg dev_std = 0.589)
NEC for r=0.3 class 2 = 0.62 +- 0.316 (in-sample avg dev_std = 0.589)
NEC for r=0.3 all KL = 0.665 +- 0.316 (in-sample avg dev_std = 0.589)
NEC for r=0.3 all L1 = 0.53 +- 0.218 (in-sample avg dev_std = 0.589)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.871
Model XAI F1 of binarized graphs for r=0.6 =  0.74063625
Model XAI WIoU of binarized graphs for r=0.6 =  0.99875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.668
NEC for r=0.6 class 0 = 0.348 +- 0.323 (in-sample avg dev_std = 0.593)
NEC for r=0.6 class 1 = 0.27 +- 0.323 (in-sample avg dev_std = 0.593)
NEC for r=0.6 class 2 = 0.491 +- 0.323 (in-sample avg dev_std = 0.593)
NEC for r=0.6 all KL = 0.463 +- 0.323 (in-sample avg dev_std = 0.593)
NEC for r=0.6 all L1 = 0.37 +- 0.187 (in-sample avg dev_std = 0.593)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.871
Model XAI F1 of binarized graphs for r=0.9 =  0.6018075
Model XAI WIoU of binarized graphs for r=0.9 =  0.99875
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.723
NEC for r=0.9 class 0 = 0.261 +- 0.260 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 1 = 0.238 +- 0.260 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 2 = 0.397 +- 0.260 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all KL = 0.319 +- 0.260 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all L1 = 0.299 +- 0.166 (in-sample avg dev_std = 0.530)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.871
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.99875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.722
NEC for r=1.0 class 0 = 0.269 +- 0.267 (in-sample avg dev_std = 0.537)
NEC for r=1.0 class 1 = 0.243 +- 0.267 (in-sample avg dev_std = 0.537)
NEC for r=1.0 class 2 = 0.401 +- 0.267 (in-sample avg dev_std = 0.537)
NEC for r=1.0 all KL = 0.326 +- 0.267 (in-sample avg dev_std = 0.537)
NEC for r=1.0 all L1 = 0.305 +- 0.172 (in-sample avg dev_std = 0.537)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.335
Model XAI F1 of binarized graphs for r=0.3 =  0.34220124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.22049624999999998
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.152 +- 0.288 (in-sample avg dev_std = 0.341)
NEC for r=0.3 class 1 = 0.178 +- 0.288 (in-sample avg dev_std = 0.341)
NEC for r=0.3 class 2 = 0.171 +- 0.288 (in-sample avg dev_std = 0.341)
NEC for r=0.3 all KL = 0.216 +- 0.288 (in-sample avg dev_std = 0.341)
NEC for r=0.3 all L1 = 0.167 +- 0.214 (in-sample avg dev_std = 0.341)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.339
Model XAI F1 of binarized graphs for r=0.6 =  0.47961374999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.32863875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.349
NEC for r=0.6 class 0 = 0.42 +- 0.296 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 1 = 0.425 +- 0.296 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 2 = 0.45 +- 0.296 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all KL = 0.488 +- 0.296 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all L1 = 0.432 +- 0.196 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  0.55320875
Model XAI WIoU of binarized graphs for r=0.9 =  0.3924849999999999
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.589
NEC for r=0.9 class 0 = 0.464 +- 0.283 (in-sample avg dev_std = 0.557)
NEC for r=0.9 class 1 = 0.253 +- 0.283 (in-sample avg dev_std = 0.557)
NEC for r=0.9 class 2 = 0.512 +- 0.283 (in-sample avg dev_std = 0.557)
NEC for r=0.9 all KL = 0.455 +- 0.283 (in-sample avg dev_std = 0.557)
NEC for r=0.9 all L1 = 0.412 +- 0.198 (in-sample avg dev_std = 0.557)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.39950625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.631
NEC for r=1.0 class 0 = 0.447 +- 0.227 (in-sample avg dev_std = 0.440)
NEC for r=1.0 class 1 = 0.173 +- 0.227 (in-sample avg dev_std = 0.440)
NEC for r=1.0 class 2 = 0.512 +- 0.227 (in-sample avg dev_std = 0.440)
NEC for r=1.0 all KL = 0.351 +- 0.227 (in-sample avg dev_std = 0.440)
NEC for r=1.0 all L1 = 0.381 +- 0.199 (in-sample avg dev_std = 0.440)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:34:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/02/2024 11:34:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:13 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:35:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9209
Train Loss: 0.3902
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.4069
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4009
OOD Validation ACCURACY: 0.9020
OOD Validation Loss: 0.3790
OOD Test ACCURACY: 0.7547
OOD Test Loss: 0.7213

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9146
Train Loss: 0.3940
ID Validation ACCURACY: 0.9120
ID Validation Loss: 0.4108
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4032
OOD Validation ACCURACY: 0.9193
OOD Validation Loss: 0.3568
OOD Test ACCURACY: 0.5650
OOD Test Loss: 1.2477

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.7547 0.9153 0.5650 0.9120 0.9193[0mGOODMotif(18000)
Data example from train: Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
Label distribution from train: (tensor([0, 1, 2]), tensor([5874, 6198, 5928]))

Gold ratio (train) =  tensor(0.3042) +- tensor(0.1620)
F1 for r=0.3 = 0.699
WIoU for r=0.3 = 0.663
F1 for r=0.6 = 0.612
WIoU for r=0.6 = 0.750
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.752
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.752
GOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.695
WIoU for r=0.3 = 0.662
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.761
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.763
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.763
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.835
WIoU for r=0.3 = 0.823
F1 for r=0.6 = 0.779
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.613
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.484
WIoU for r=0.3 = 0.366
F1 for r=0.6 = 0.626
WIoU for r=0.6 = 0.503
F1 for r=0.9 = 0.592
WIoU for r=0.9 = 0.486
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.486


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.708
Model XAI F1 of binarized graphs for r=0.3 =  0.69901125
Model XAI WIoU of binarized graphs for r=0.3 =  0.66275125
len(reference) = 791
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF++ for r=0.3 class 0 = 0.51 +- 0.279 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 1 = 0.532 +- 0.279 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 2 = 0.468 +- 0.279 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all KL = 0.483 +- 0.279 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all L1 = 0.504 +- 0.152 (in-sample avg dev_std = 0.543)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.61242125
Model XAI WIoU of binarized graphs for r=0.6 =  0.75004125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.763
SUFF++ for r=0.6 class 0 = 0.613 +- 0.282 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 class 1 = 0.719 +- 0.282 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 class 2 = 0.626 +- 0.282 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 all KL = 0.619 +- 0.282 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 all L1 = 0.654 +- 0.185 (in-sample avg dev_std = 0.498)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.942
Model XAI F1 of binarized graphs for r=0.9 =  0.47372749999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7521924999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.91
SUFF++ for r=0.9 class 0 = 0.872 +- 0.133 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 1 = 0.878 +- 0.133 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 2 = 0.905 +- 0.133 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all KL = 0.924 +- 0.133 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.135 (in-sample avg dev_std = 0.222)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.658
Model XAI F1 of binarized graphs for r=0.3 =  0.69482625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6622912500000001
len(reference) = 792
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.47
SUFF++ for r=0.3 class 0 = 0.485 +- 0.274 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 class 1 = 0.544 +- 0.274 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 class 2 = 0.475 +- 0.274 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 all KL = 0.488 +- 0.274 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.156 (in-sample avg dev_std = 0.539)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.896
Model XAI F1 of binarized graphs for r=0.6 =  0.6125562499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7606887499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.737
SUFF++ for r=0.6 class 0 = 0.588 +- 0.289 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.289 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 2 = 0.639 +- 0.289 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all KL = 0.613 +- 0.289 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all L1 = 0.645 +- 0.196 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.4756
Model XAI WIoU of binarized graphs for r=0.9 =  0.7628999999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.887
SUFF++ for r=0.9 class 0 = 0.871 +- 0.136 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 class 1 = 0.878 +- 0.136 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 class 2 = 0.906 +- 0.136 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 all KL = 0.925 +- 0.136 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.141 (in-sample avg dev_std = 0.216)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.596
Model XAI F1 of binarized graphs for r=0.3 =  0.8350675000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.82321
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.55
SUFF++ for r=0.3 class 0 = 0.588 +- 0.316 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 class 1 = 0.743 +- 0.316 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 class 2 = 0.555 +- 0.316 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 all KL = 0.532 +- 0.316 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 all L1 = 0.628 +- 0.201 (in-sample avg dev_std = 0.570)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.7788262499999999
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.88
SUFF++ for r=0.6 class 0 = 0.897 +- 0.202 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 1 = 0.855 +- 0.202 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 2 = 0.884 +- 0.202 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all KL = 0.87 +- 0.202 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all L1 = 0.879 +- 0.142 (in-sample avg dev_std = 0.336)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.61348375
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.91
SUFF++ for r=0.9 class 0 = 0.956 +- 0.089 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 class 1 = 0.947 +- 0.089 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 class 2 = 0.963 +- 0.089 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all KL = 0.976 +- 0.089 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all L1 = 0.956 +- 0.089 (in-sample avg dev_std = 0.158)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.367
Model XAI F1 of binarized graphs for r=0.3 =  0.48421499999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.36574875000000007
len(reference) = 773
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.361
SUFF++ for r=0.3 class 0 = 0.575 +- 0.158 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 1 = 0.583 +- 0.158 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 2 = 0.584 +- 0.158 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all KL = 0.718 +- 0.158 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all L1 = 0.581 +- 0.116 (in-sample avg dev_std = 0.453)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  0.62566375
Model XAI WIoU of binarized graphs for r=0.6 =  0.502695
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.642
SUFF++ for r=0.6 class 0 = 0.541 +- 0.258 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 1 = 0.81 +- 0.258 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 2 = 0.675 +- 0.258 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all KL = 0.685 +- 0.258 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all L1 = 0.673 +- 0.217 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.748
Model XAI F1 of binarized graphs for r=0.9 =  0.59248375
Model XAI WIoU of binarized graphs for r=0.9 =  0.48591375
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.729
SUFF++ for r=0.9 class 0 = 0.704 +- 0.141 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 1 = 0.973 +- 0.141 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 2 = 0.844 +- 0.141 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all KL = 0.903 +- 0.141 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all L1 = 0.838 +- 0.169 (in-sample avg dev_std = 0.254)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.69901125
Model XAI WIoU of binarized graphs for r=0.3 =  0.66275125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.581 +- 0.304 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 1 = 0.512 +- 0.304 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 2 = 0.618 +- 0.304 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all KL = 0.578 +- 0.304 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all L1 = 0.57 +- 0.166 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.61242125
Model XAI WIoU of binarized graphs for r=0.6 =  0.75004125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.48
NEC for r=0.6 class 0 = 0.56 +- 0.298 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 1 = 0.516 +- 0.298 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 2 = 0.598 +- 0.298 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all KL = 0.601 +- 0.298 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all L1 = 0.557 +- 0.168 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.942
Model XAI F1 of binarized graphs for r=0.9 =  0.47372749999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7521924999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.546
NEC for r=0.9 class 0 = 0.517 +- 0.288 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.484 +- 0.288 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.551 +- 0.288 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.548 +- 0.288 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.516 +- 0.159 (in-sample avg dev_std = 0.568)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  0.4444524999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7521912499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.52 +- 0.285 (in-sample avg dev_std = 0.568)
NEC for r=1.0 class 1 = 0.483 +- 0.285 (in-sample avg dev_std = 0.568)
NEC for r=1.0 class 2 = 0.53 +- 0.285 (in-sample avg dev_std = 0.568)
NEC for r=1.0 all KL = 0.543 +- 0.285 (in-sample avg dev_std = 0.568)
NEC for r=1.0 all L1 = 0.511 +- 0.157 (in-sample avg dev_std = 0.568)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.658
Model XAI F1 of binarized graphs for r=0.3 =  0.69482625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6622912500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.583 +- 0.305 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 1 = 0.493 +- 0.305 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 2 = 0.588 +- 0.305 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all KL = 0.557 +- 0.305 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all L1 = 0.555 +- 0.171 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.896
Model XAI F1 of binarized graphs for r=0.6 =  0.6125562499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7606887499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.483
NEC for r=0.6 class 0 = 0.559 +- 0.310 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 1 = 0.497 +- 0.310 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 2 = 0.6 +- 0.310 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all KL = 0.588 +- 0.310 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all L1 = 0.552 +- 0.179 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.4756
Model XAI WIoU of binarized graphs for r=0.9 =  0.7628999999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 0 = 0.509 +- 0.296 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 1 = 0.47 +- 0.296 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 2 = 0.545 +- 0.296 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all KL = 0.54 +- 0.296 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all L1 = 0.508 +- 0.166 (in-sample avg dev_std = 0.560)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.919
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7628925
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.538
NEC for r=1.0 class 0 = 0.522 +- 0.294 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 1 = 0.461 +- 0.294 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 2 = 0.543 +- 0.294 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all KL = 0.542 +- 0.294 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all L1 = 0.509 +- 0.165 (in-sample avg dev_std = 0.563)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.596
Model XAI F1 of binarized graphs for r=0.3 =  0.8350675000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.82321
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.394
NEC for r=0.3 class 0 = 0.641 +- 0.309 (in-sample avg dev_std = 0.539)
NEC for r=0.3 class 1 = 0.594 +- 0.309 (in-sample avg dev_std = 0.539)
NEC for r=0.3 class 2 = 0.591 +- 0.309 (in-sample avg dev_std = 0.539)
NEC for r=0.3 all KL = 0.686 +- 0.309 (in-sample avg dev_std = 0.539)
NEC for r=0.3 all L1 = 0.609 +- 0.170 (in-sample avg dev_std = 0.539)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.7788262499999999
Model XAI WIoU of binarized graphs for r=0.6 =  1.0
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0 = 0.419 +- 0.246 (in-sample avg dev_std = 0.592)
NEC for r=0.6 class 1 = 0.423 +- 0.246 (in-sample avg dev_std = 0.592)
NEC for r=0.6 class 2 = 0.36 +- 0.246 (in-sample avg dev_std = 0.592)
NEC for r=0.6 all KL = 0.516 +- 0.246 (in-sample avg dev_std = 0.592)
NEC for r=0.6 all L1 = 0.401 +- 0.149 (in-sample avg dev_std = 0.592)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.61348375
Model XAI WIoU of binarized graphs for r=0.9 =  1.0
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.716
NEC for r=0.9 class 0 = 0.331 +- 0.196 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 1 = 0.325 +- 0.196 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 2 = 0.296 +- 0.196 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all KL = 0.326 +- 0.196 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all L1 = 0.317 +- 0.141 (in-sample avg dev_std = 0.525)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  1.0
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.706
NEC for r=1.0 class 0 = 0.314 +- 0.194 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 1 = 0.338 +- 0.194 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 2 = 0.3 +- 0.194 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all KL = 0.323 +- 0.194 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all L1 = 0.317 +- 0.140 (in-sample avg dev_std = 0.525)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.37
Model XAI F1 of binarized graphs for r=0.3 =  0.48421499999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.36574875000000007
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.412
NEC for r=0.3 class 0 = 0.44 +- 0.205 (in-sample avg dev_std = 0.366)
NEC for r=0.3 class 1 = 0.458 +- 0.205 (in-sample avg dev_std = 0.366)
NEC for r=0.3 class 2 = 0.388 +- 0.205 (in-sample avg dev_std = 0.366)
NEC for r=0.3 all KL = 0.286 +- 0.205 (in-sample avg dev_std = 0.366)
NEC for r=0.3 all L1 = 0.428 +- 0.159 (in-sample avg dev_std = 0.366)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  0.62566375
Model XAI WIoU of binarized graphs for r=0.6 =  0.502695
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.619
NEC for r=0.6 class 0 = 0.533 +- 0.279 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 1 = 0.332 +- 0.279 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 2 = 0.58 +- 0.279 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.538 +- 0.279 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.484 +- 0.183 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.748
Model XAI F1 of binarized graphs for r=0.9 =  0.59248375
Model XAI WIoU of binarized graphs for r=0.9 =  0.48591375
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.488 +- 0.201 (in-sample avg dev_std = 0.504)
NEC for r=0.9 class 1 = 0.307 +- 0.201 (in-sample avg dev_std = 0.504)
NEC for r=0.9 class 2 = 0.476 +- 0.201 (in-sample avg dev_std = 0.504)
NEC for r=0.9 all KL = 0.457 +- 0.201 (in-sample avg dev_std = 0.504)
NEC for r=0.9 all L1 = 0.426 +- 0.161 (in-sample avg dev_std = 0.504)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.746
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.48585125000000007
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.681
NEC for r=1.0 class 0 = 0.466 +- 0.188 (in-sample avg dev_std = 0.491)
NEC for r=1.0 class 1 = 0.285 +- 0.188 (in-sample avg dev_std = 0.491)
NEC for r=1.0 class 2 = 0.456 +- 0.188 (in-sample avg dev_std = 0.491)
NEC for r=1.0 all KL = 0.413 +- 0.188 (in-sample avg dev_std = 0.491)
NEC for r=1.0 all L1 = 0.404 +- 0.157 (in-sample avg dev_std = 0.491)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.445, 0.705, 0.922, 1.0], 'all_L1': [0.506, 0.704, 0.875, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.431, 0.627, 0.877, 1.0], 'all_L1': [0.489, 0.65, 0.854, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.611, 0.912, 1.0], 'all_L1': [0.559, 0.657, 0.889, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.286, 0.567, 0.888, 1.0], 'all_L1': [0.425, 0.607, 0.852, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.619, 0.924, 1.0], 'all_L1': [0.504, 0.654, 0.885, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.623, 0.595, 0.537, 0.537], 'all_L1': [0.59, 0.556, 0.515, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.591, 0.572, 0.541, 0.527], 'all_L1': [0.546, 0.532, 0.502, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.551, 0.604, 0.558, 0.556], 'all_L1': [0.536, 0.549, 0.505, 0.508]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.612, 0.542, 0.543], 'all_L1': [0.583, 0.551, 0.494, 0.498]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.601, 0.548, 0.543], 'all_L1': [0.57, 0.557, 0.516, 0.511]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.437, 0.714, 0.932, 1.0], 'all_L1': [0.5, 0.712, 0.89, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.424, 0.638, 0.89, 1.0], 'all_L1': [0.49, 0.659, 0.864, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.616, 0.917, 1.0], 'all_L1': [0.564, 0.661, 0.894, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.596, 0.899, 1.0], 'all_L1': [0.419, 0.628, 0.865, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.613, 0.925, 1.0], 'all_L1': [0.501, 0.645, 0.885, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.63, 0.592, 0.53, 0.531], 'all_L1': [0.588, 0.554, 0.506, 0.508]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.563, 0.534, 0.525], 'all_L1': [0.548, 0.525, 0.495, 0.487]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.596, 0.55, 0.559], 'all_L1': [0.534, 0.544, 0.502, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.593, 0.534, 0.539], 'all_L1': [0.575, 0.54, 0.488, 0.493]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.588, 0.54, 0.542], 'all_L1': [0.555, 0.552, 0.508, 0.509]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.515, 0.831, 0.969, 1.0], 'all_L1': [0.635, 0.854, 0.948, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.479, 0.873, 0.97, 1.0], 'all_L1': [0.654, 0.878, 0.947, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.832, 0.969, 1.0], 'all_L1': [0.65, 0.853, 0.952, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.819, 0.973, 1.0], 'all_L1': [0.628, 0.834, 0.948, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.87, 0.976, 1.0], 'all_L1': [0.628, 0.879, 0.956, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.752, 0.578, 0.416, 0.409], 'all_L1': [0.628, 0.468, 0.387, 0.385]}), defaultdict(<class 'list'>, {'all_KL': [0.772, 0.528, 0.365, 0.36], 'all_L1': [0.592, 0.409, 0.33, 0.327]}), defaultdict(<class 'list'>, {'all_KL': [0.679, 0.564, 0.398, 0.393], 'all_L1': [0.582, 0.451, 0.37, 0.368]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.463, 0.319, 0.326], 'all_L1': [0.53, 0.37, 0.299, 0.305]}), defaultdict(<class 'list'>, {'all_KL': [0.686, 0.516, 0.326, 0.323], 'all_L1': [0.609, 0.401, 0.317, 0.317]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.389, 0.698, 0.848, 1.0], 'all_L1': [0.478, 0.703, 0.801, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.68, 0.852, 1.0], 'all_L1': [0.628, 0.597, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.846, 0.646, 0.805, 1.0], 'all_L1': [0.689, 0.629, 0.764, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.323, 0.864, 1.0], 'all_L1': [0.607, 0.435, 0.841, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.718, 0.685, 0.903, 1.0], 'all_L1': [0.581, 0.673, 0.838, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.598, 0.654, 0.494, 0.467], 'all_L1': [0.543, 0.56, 0.465, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.129, 0.351, 0.408, 0.387], 'all_L1': [0.254, 0.43, 0.429, 0.415]}), defaultdict(<class 'list'>, {'all_KL': [0.154, 0.542, 0.497, 0.467], 'all_L1': [0.312, 0.519, 0.451, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.216, 0.488, 0.455, 0.351], 'all_L1': [0.167, 0.432, 0.412, 0.381]}), defaultdict(<class 'list'>, {'all_KL': [0.286, 0.538, 0.457, 0.413], 'all_L1': [0.428, 0.484, 0.426, 0.404]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.497 +- 0.043, 0.654 +- 0.031, 0.871 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.436 +- 0.084, 0.626 +- 0.045, 0.905 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.480 +- 0.028, 0.749 +- 0.025, 0.894 +- 0.011
nec class all_L1  =  0.565 +- 0.021, 0.549 +- 0.009, 0.506 +- 0.008, 0.505 +- 0.009
nec class all_KL  =  0.608 +- 0.050, 0.597 +- 0.014, 0.545 +- 0.007, 0.541 +- 0.009
nec_acc_int  =  0.376 +- 0.012, 0.500 +- 0.016, 0.566 +- 0.021, 0.570 +- 0.021

Eval split id_val
suff++ class all_L1  =  0.495 +- 0.046, 0.661 +- 0.028, 0.880 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.434 +- 0.088, 0.635 +- 0.042, 0.913 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.474 +- 0.032, 0.733 +- 0.021, 0.880 +- 0.008
nec class all_L1  =  0.560 +- 0.019, 0.543 +- 0.010, 0.500 +- 0.007, 0.501 +- 0.010
nec class all_KL  =  0.604 +- 0.049, 0.586 +- 0.012, 0.538 +- 0.007, 0.539 +- 0.012
nec_acc_int  =  0.378 +- 0.011, 0.498 +- 0.013, 0.565 +- 0.019, 0.564 +- 0.021

Eval split val
suff++ class all_L1  =  0.639 +- 0.011, 0.860 +- 0.017, 0.950 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.505 +- 0.028, 0.845 +- 0.022, 0.971 +- 0.003, 1.000 +- 0.000
suff++_acc_int  =  0.542 +- 0.009, 0.869 +- 0.013, 0.895 +- 0.021
nec class all_L1  =  0.588 +- 0.033, 0.420 +- 0.035, 0.341 +- 0.033, 0.340 +- 0.031
nec class all_KL  =  0.711 +- 0.043, 0.530 +- 0.040, 0.365 +- 0.038, 0.362 +- 0.035
nec_acc_int  =  0.312 +- 0.077, 0.609 +- 0.048, 0.674 +- 0.042, 0.675 +- 0.037

Eval split test
suff++ class all_L1  =  0.597 +- 0.069, 0.607 +- 0.094, 0.804 +- 0.031, 1.000 +- 0.000
suff++ class all_KL  =  0.606 +- 0.208, 0.606 +- 0.143, 0.854 +- 0.031, 1.000 +- 0.000
suff++_acc_int  =  0.357 +- 0.016, 0.554 +- 0.137, 0.721 +- 0.060
nec class all_L1  =  0.341 +- 0.132, 0.485 +- 0.050, 0.437 +- 0.019, 0.414 +- 0.020
nec class all_KL  =  0.277 +- 0.170, 0.515 +- 0.098, 0.462 +- 0.032, 0.417 +- 0.045
nec_acc_int  =  0.353 +- 0.032, 0.497 +- 0.095, 0.625 +- 0.029, 0.648 +- 0.025


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.531 +- 0.017, 0.602 +- 0.017, 0.689 +- 0.011, 0.752 +- 0.004
Faith. Armon (L1)= 		  =  0.527 +- 0.021, 0.597 +- 0.015, 0.640 +- 0.010, 0.671 +- 0.008
Faith. GMean (L1)= 	  =  0.529 +- 0.019, 0.599 +- 0.016, 0.664 +- 0.010, 0.710 +- 0.006
Faith. Aritm (KL)= 		  =  0.522 +- 0.019, 0.611 +- 0.021, 0.725 +- 0.011, 0.771 +- 0.005
Faith. Armon (KL)= 		  =  0.499 +- 0.049, 0.610 +- 0.019, 0.680 +- 0.009, 0.702 +- 0.008
Faith. GMean (KL)= 	  =  0.510 +- 0.034, 0.611 +- 0.020, 0.702 +- 0.010, 0.736 +- 0.006

Eval split id_val
Faith. Aritm (L1)= 		  =  0.527 +- 0.019, 0.602 +- 0.017, 0.690 +- 0.010, 0.751 +- 0.005
Faith. Armon (L1)= 		  =  0.524 +- 0.022, 0.596 +- 0.015, 0.637 +- 0.009, 0.668 +- 0.008
Faith. GMean (L1)= 	  =  0.525 +- 0.020, 0.599 +- 0.016, 0.663 +- 0.009, 0.708 +- 0.007
Faith. Aritm (KL)= 		  =  0.519 +- 0.022, 0.611 +- 0.021, 0.725 +- 0.009, 0.770 +- 0.006
Faith. Armon (KL)= 		  =  0.495 +- 0.051, 0.609 +- 0.019, 0.677 +- 0.007, 0.701 +- 0.010
Faith. GMean (KL)= 	  =  0.507 +- 0.037, 0.610 +- 0.020, 0.700 +- 0.008, 0.734 +- 0.008

Eval split val
Faith. Aritm (L1)= 		  =  0.614 +- 0.018, 0.640 +- 0.020, 0.645 +- 0.016, 0.670 +- 0.015
Faith. Armon (L1)= 		  =  0.612 +- 0.019, 0.563 +- 0.032, 0.501 +- 0.035, 0.507 +- 0.034
Faith. GMean (L1)= 	  =  0.613 +- 0.019, 0.600 +- 0.026, 0.568 +- 0.027, 0.583 +- 0.026
Faith. Aritm (KL)= 		  =  0.608 +- 0.024, 0.687 +- 0.023, 0.668 +- 0.018, 0.681 +- 0.017
Faith. Armon (KL)= 		  =  0.589 +- 0.022, 0.650 +- 0.032, 0.529 +- 0.040, 0.531 +- 0.037
Faith. GMean (KL)= 	  =  0.599 +- 0.022, 0.669 +- 0.027, 0.594 +- 0.031, 0.601 +- 0.029

Eval split test
Faith. Aritm (L1)= 		  =  0.469 +- 0.048, 0.546 +- 0.068, 0.620 +- 0.013, 0.707 +- 0.010
Faith. Armon (L1)= 		  =  0.411 +- 0.091, 0.538 +- 0.065, 0.565 +- 0.013, 0.585 +- 0.021
Faith. GMean (L1)= 	  =  0.438 +- 0.071, 0.542 +- 0.066, 0.592 +- 0.011, 0.643 +- 0.016
Faith. Aritm (KL)= 		  =  0.441 +- 0.088, 0.561 +- 0.093, 0.658 +- 0.017, 0.709 +- 0.023
Faith. Armon (KL)= 		  =  0.324 +- 0.098, 0.544 +- 0.103, 0.599 +- 0.025, 0.587 +- 0.045
Faith. GMean (KL)= 	  =  0.375 +- 0.082, 0.552 +- 0.098, 0.628 +- 0.020, 0.645 +- 0.035
Computed for split load_split = id



Completed in  0:27:09.434015  for LECIGIN GOODMotif/basis



DONE LECI GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:41:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:41:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.8919
Train Loss: 0.4402
ID Validation ACCURACY: 0.8920
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.8870
ID Test Loss: 0.4639
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.6049
OOD Test ACCURACY: 0.7937
OOD Test Loss: 0.6760

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.8381
Train Loss: 0.5254
ID Validation ACCURACY: 0.8367
ID Validation Loss: 0.5281
ID Test ACCURACY: 0.8403
ID Test Loss: 0.5399
OOD Validation ACCURACY: 0.9063
OOD Validation Loss: 0.5418
OOD Test ACCURACY: 0.8933
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.8870 0.7937 0.8403 0.8933 0.8367 0.9063[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.431
WIoU for r=0.3 = 0.422
F1 for r=0.6 = 0.506
WIoU for r=0.6 = 0.596
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.643
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.640
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.435
WIoU for r=0.3 = 0.421
F1 for r=0.6 = 0.513
WIoU for r=0.6 = 0.596
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.639
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.636
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.566
WIoU for r=0.3 = 0.919
F1 for r=0.6 = 0.345
WIoU for r=0.6 = 0.919
F1 for r=0.9 = 0.266
WIoU for r=0.9 = 0.919
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.919
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.682
WIoU for r=0.3 = 0.565
F1 for r=0.6 = 0.550
WIoU for r=0.6 = 0.588
F1 for r=0.9 = 0.418
WIoU for r=0.9 = 0.558
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.558


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  0.43066374999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.4223374999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.426
SUFF++ for r=0.3 class 0 = 0.581 +- 0.282 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 class 1 = 0.659 +- 0.282 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 class 2 = 0.554 +- 0.282 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 all KL = 0.647 +- 0.282 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.168 (in-sample avg dev_std = 0.436)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.5063662499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.59587625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.571
SUFF++ for r=0.6 class 0 = 0.651 +- 0.242 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 1 = 0.658 +- 0.242 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 2 = 0.63 +- 0.242 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all KL = 0.705 +- 0.242 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all L1 = 0.646 +- 0.178 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.86
Model XAI F1 of binarized graphs for r=0.9 =  0.4665675
Model XAI WIoU of binarized graphs for r=0.9 =  0.6430562499999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.818
SUFF++ for r=0.9 class 0 = 0.815 +- 0.146 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.797 +- 0.146 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.832 +- 0.146 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.884 +- 0.146 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.815 +- 0.152 (in-sample avg dev_std = 0.256)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  0.43462625000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.42082250000000004
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.432
SUFF++ for r=0.3 class 0 = 0.596 +- 0.295 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 class 1 = 0.66 +- 0.295 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 class 2 = 0.538 +- 0.295 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 all KL = 0.638 +- 0.295 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.171 (in-sample avg dev_std = 0.436)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.51252875
Model XAI WIoU of binarized graphs for r=0.6 =  0.5958087500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.548
SUFF++ for r=0.6 class 0 = 0.66 +- 0.254 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 1 = 0.667 +- 0.254 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 2 = 0.618 +- 0.254 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all KL = 0.701 +- 0.254 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all L1 = 0.649 +- 0.181 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.873
Model XAI F1 of binarized graphs for r=0.9 =  0.46699625
Model XAI WIoU of binarized graphs for r=0.9 =  0.6393
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.829
SUFF++ for r=0.9 class 0 = 0.807 +- 0.143 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.81 +- 0.143 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.852 +- 0.143 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.891 +- 0.143 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.823 +- 0.149 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.91
Model XAI F1 of binarized graphs for r=0.3 =  0.56554875
Model XAI WIoU of binarized graphs for r=0.3 =  0.91921125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.595
SUFF++ for r=0.3 class 0 = 0.504 +- 0.284 (in-sample avg dev_std = 0.599)
SUFF++ for r=0.3 class 1 = 0.569 +- 0.284 (in-sample avg dev_std = 0.599)
SUFF++ for r=0.3 class 2 = 0.486 +- 0.284 (in-sample avg dev_std = 0.599)
SUFF++ for r=0.3 all KL = 0.521 +- 0.284 (in-sample avg dev_std = 0.599)
SUFF++ for r=0.3 all L1 = 0.519 +- 0.115 (in-sample avg dev_std = 0.599)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.34547124999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.91921125
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.69
SUFF++ for r=0.6 class 0 = 0.686 +- 0.195 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 1 = 0.571 +- 0.195 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 2 = 0.699 +- 0.195 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all KL = 0.76 +- 0.195 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.152 (in-sample avg dev_std = 0.401)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.26621249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.91921125
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.809
SUFF++ for r=0.9 class 0 = 0.866 +- 0.075 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 class 1 = 0.755 +- 0.075 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 class 2 = 0.906 +- 0.075 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 all KL = 0.942 +- 0.075 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.125 (in-sample avg dev_std = 0.201)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.565
Model XAI F1 of binarized graphs for r=0.3 =  0.68192875
Model XAI WIoU of binarized graphs for r=0.3 =  0.56466625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.471
SUFF++ for r=0.3 class 0 = 0.543 +- 0.223 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 class 1 = 0.699 +- 0.223 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 class 2 = 0.531 +- 0.223 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 all KL = 0.673 +- 0.223 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.140 (in-sample avg dev_std = 0.447)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.55034375
Model XAI WIoU of binarized graphs for r=0.6 =  0.5882725
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.695
SUFF++ for r=0.6 class 0 = 0.559 +- 0.347 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 class 1 = 0.622 +- 0.347 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 class 2 = 0.638 +- 0.347 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 all KL = 0.56 +- 0.347 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 all L1 = 0.607 +- 0.186 (in-sample avg dev_std = 0.591)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.417665
Model XAI WIoU of binarized graphs for r=0.9 =  0.5576225
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.795
SUFF++ for r=0.9 class 0 = 0.764 +- 0.186 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 1 = 0.709 +- 0.186 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.186 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all KL = 0.826 +- 0.186 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all L1 = 0.775 +- 0.197 (in-sample avg dev_std = 0.263)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  0.43066374999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.4223374999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.364
NEC for r=0.3 class 0 = 0.463 +- 0.294 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 1 = 0.445 +- 0.294 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 2 = 0.517 +- 0.294 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all KL = 0.422 +- 0.294 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all L1 = 0.475 +- 0.178 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.5063662499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.59587625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.51
NEC for r=0.6 class 0 = 0.413 +- 0.251 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 1 = 0.413 +- 0.251 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 2 = 0.497 +- 0.251 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all KL = 0.389 +- 0.251 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all L1 = 0.441 +- 0.156 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.86
Model XAI F1 of binarized graphs for r=0.9 =  0.4665675
Model XAI WIoU of binarized graphs for r=0.9 =  0.6430562499999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.598
NEC for r=0.9 class 0 = 0.443 +- 0.263 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 1 = 0.407 +- 0.263 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 2 = 0.525 +- 0.263 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all KL = 0.419 +- 0.263 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all L1 = 0.458 +- 0.161 (in-sample avg dev_std = 0.467)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.640465
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.627
NEC for r=1.0 class 0 = 0.434 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 1 = 0.408 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 2 = 0.525 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all KL = 0.434 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all L1 = 0.456 +- 0.163 (in-sample avg dev_std = 0.486)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  0.43462625000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.42082250000000004
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.449 +- 0.302 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1 = 0.455 +- 0.302 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 2 = 0.552 +- 0.302 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.435 +- 0.302 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.485 +- 0.178 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.51252875
Model XAI WIoU of binarized graphs for r=0.6 =  0.5958087500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.506
NEC for r=0.6 class 0 = 0.411 +- 0.263 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.407 +- 0.263 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.5 +- 0.263 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.396 +- 0.263 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.439 +- 0.154 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.873
Model XAI F1 of binarized graphs for r=0.9 =  0.46699625
Model XAI WIoU of binarized graphs for r=0.9 =  0.6393
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.462 +- 0.262 (in-sample avg dev_std = 0.483)
NEC for r=0.9 class 1 = 0.393 +- 0.262 (in-sample avg dev_std = 0.483)
NEC for r=0.9 class 2 = 0.54 +- 0.262 (in-sample avg dev_std = 0.483)
NEC for r=0.9 all KL = 0.432 +- 0.262 (in-sample avg dev_std = 0.483)
NEC for r=0.9 all L1 = 0.465 +- 0.156 (in-sample avg dev_std = 0.483)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.63644875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.632
NEC for r=1.0 class 0 = 0.431 +- 0.258 (in-sample avg dev_std = 0.493)
NEC for r=1.0 class 1 = 0.384 +- 0.258 (in-sample avg dev_std = 0.493)
NEC for r=1.0 class 2 = 0.527 +- 0.258 (in-sample avg dev_std = 0.493)
NEC for r=1.0 all KL = 0.425 +- 0.258 (in-sample avg dev_std = 0.493)
NEC for r=1.0 all L1 = 0.447 +- 0.153 (in-sample avg dev_std = 0.493)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.91
Model XAI F1 of binarized graphs for r=0.3 =  0.56554875
Model XAI WIoU of binarized graphs for r=0.3 =  0.91921125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.36
NEC for r=0.3 class 0 = 0.601 +- 0.324 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 1 = 0.46 +- 0.324 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 2 = 0.753 +- 0.324 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all KL = 0.582 +- 0.324 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all L1 = 0.606 +- 0.162 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.34547124999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.91921125
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.498
NEC for r=0.6 class 0 = 0.458 +- 0.228 (in-sample avg dev_std = 0.456)
NEC for r=0.6 class 1 = 0.452 +- 0.228 (in-sample avg dev_std = 0.456)
NEC for r=0.6 class 2 = 0.566 +- 0.228 (in-sample avg dev_std = 0.456)
NEC for r=0.6 all KL = 0.384 +- 0.228 (in-sample avg dev_std = 0.456)
NEC for r=0.6 all L1 = 0.493 +- 0.134 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.26621249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.91921125
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.557
NEC for r=0.9 class 0 = 0.425 +- 0.204 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 1 = 0.416 +- 0.204 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 2 = 0.471 +- 0.204 (in-sample avg dev_std = 0.462)
NEC for r=0.9 all KL = 0.328 +- 0.204 (in-sample avg dev_std = 0.462)
NEC for r=0.9 all L1 = 0.438 +- 0.123 (in-sample avg dev_std = 0.462)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.772
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.91921125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.566
NEC for r=1.0 class 0 = 0.411 +- 0.197 (in-sample avg dev_std = 0.453)
NEC for r=1.0 class 1 = 0.411 +- 0.197 (in-sample avg dev_std = 0.453)
NEC for r=1.0 class 2 = 0.465 +- 0.197 (in-sample avg dev_std = 0.453)
NEC for r=1.0 all KL = 0.316 +- 0.197 (in-sample avg dev_std = 0.453)
NEC for r=1.0 all L1 = 0.429 +- 0.120 (in-sample avg dev_std = 0.453)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.565
Model XAI F1 of binarized graphs for r=0.3 =  0.68192875
Model XAI WIoU of binarized graphs for r=0.3 =  0.56466625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.396
NEC for r=0.3 class 0 = 0.515 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 1 = 0.437 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 2 = 0.529 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all KL = 0.412 +- 0.267 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all L1 = 0.493 +- 0.155 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.55034375
Model XAI WIoU of binarized graphs for r=0.6 =  0.5882725
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.534
NEC for r=0.6 class 0 = 0.526 +- 0.335 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.507 +- 0.335 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.565 +- 0.335 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.569 +- 0.335 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.533 +- 0.185 (in-sample avg dev_std = 0.556)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.417665
Model XAI WIoU of binarized graphs for r=0.9 =  0.5576225
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.491 +- 0.288 (in-sample avg dev_std = 0.562)
NEC for r=0.9 class 1 = 0.496 +- 0.288 (in-sample avg dev_std = 0.562)
NEC for r=0.9 class 2 = 0.439 +- 0.288 (in-sample avg dev_std = 0.562)
NEC for r=0.9 all KL = 0.528 +- 0.288 (in-sample avg dev_std = 0.562)
NEC for r=0.9 all L1 = 0.476 +- 0.151 (in-sample avg dev_std = 0.562)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.799
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.5575024999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.63
NEC for r=1.0 class 0 = 0.484 +- 0.283 (in-sample avg dev_std = 0.559)
NEC for r=1.0 class 1 = 0.487 +- 0.283 (in-sample avg dev_std = 0.559)
NEC for r=1.0 class 2 = 0.424 +- 0.283 (in-sample avg dev_std = 0.559)
NEC for r=1.0 all KL = 0.516 +- 0.283 (in-sample avg dev_std = 0.559)
NEC for r=1.0 all L1 = 0.465 +- 0.149 (in-sample avg dev_std = 0.559)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:47:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:47:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8941
Train Loss: 0.4387
ID Validation ACCURACY: 0.8933
ID Validation Loss: 0.4199
ID Test ACCURACY: 0.8857
ID Test Loss: 0.4740
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4243
OOD Test ACCURACY: 0.9167
OOD Test Loss: 0.3882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8941
Train Loss: 0.4387
ID Validation ACCURACY: 0.8933
ID Validation Loss: 0.4199
ID Test ACCURACY: 0.8857
ID Test Loss: 0.4740
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4243
OOD Test ACCURACY: 0.9167
OOD Test Loss: 0.3882

[0m[1;37mINFO[0m: [1mChartInfo 0.8857 0.9167 0.8857 0.9167 0.8933 0.9263[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.400
WIoU for r=0.3 = 0.302
F1 for r=0.6 = 0.577
WIoU for r=0.6 = 0.546
F1 for r=0.9 = 0.478
WIoU for r=0.9 = 0.565
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.565
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.398
WIoU for r=0.3 = 0.302
F1 for r=0.6 = 0.572
WIoU for r=0.6 = 0.542
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.560
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.561
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.653
WIoU for r=0.3 = 0.862
F1 for r=0.6 = 0.403
WIoU for r=0.6 = 0.865
F1 for r=0.9 = 0.291
WIoU for r=0.9 = 0.865
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.865
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.507
WIoU for r=0.3 = 0.537
F1 for r=0.6 = 0.538
WIoU for r=0.6 = 0.702
F1 for r=0.9 = 0.419
WIoU for r=0.9 = 0.689
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.689


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.435
Model XAI F1 of binarized graphs for r=0.3 =  0.40021999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.30246875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
SUFF++ for r=0.3 class 0 = 0.551 +- 0.247 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 1 = 0.586 +- 0.247 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 2 = 0.518 +- 0.247 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all KL = 0.659 +- 0.247 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all L1 = 0.552 +- 0.134 (in-sample avg dev_std = 0.383)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.806
Model XAI F1 of binarized graphs for r=0.6 =  0.57744
Model XAI WIoU of binarized graphs for r=0.6 =  0.54618875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.634
SUFF++ for r=0.6 class 0 = 0.599 +- 0.252 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 1 = 0.62 +- 0.252 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 2 = 0.604 +- 0.252 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all KL = 0.613 +- 0.252 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all L1 = 0.608 +- 0.180 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.47759875000000007
Model XAI WIoU of binarized graphs for r=0.9 =  0.5646375
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.841
SUFF++ for r=0.9 class 0 = 0.806 +- 0.171 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 1 = 0.815 +- 0.171 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 2 = 0.869 +- 0.171 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all KL = 0.883 +- 0.171 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.183 (in-sample avg dev_std = 0.236)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.452
Model XAI F1 of binarized graphs for r=0.3 =  0.39763999999999994
Model XAI WIoU of binarized graphs for r=0.3 =  0.30240125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.374
SUFF++ for r=0.3 class 0 = 0.563 +- 0.246 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 1 = 0.593 +- 0.246 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 2 = 0.527 +- 0.246 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all KL = 0.676 +- 0.246 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all L1 = 0.561 +- 0.130 (in-sample avg dev_std = 0.385)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.79
Model XAI F1 of binarized graphs for r=0.6 =  0.5723024999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.54200625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.632
SUFF++ for r=0.6 class 0 = 0.604 +- 0.247 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 class 1 = 0.634 +- 0.247 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 class 2 = 0.616 +- 0.247 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 all KL = 0.617 +- 0.247 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 all L1 = 0.618 +- 0.177 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.4734399999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.5597675
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.852
SUFF++ for r=0.9 class 0 = 0.801 +- 0.163 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 1 = 0.849 +- 0.163 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.163 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all KL = 0.895 +- 0.163 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.171 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.919
Model XAI F1 of binarized graphs for r=0.3 =  0.6530425000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8621787500000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.555
SUFF++ for r=0.3 class 0 = 0.414 +- 0.263 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.263 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 class 2 = 0.438 +- 0.263 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 all KL = 0.423 +- 0.263 (in-sample avg dev_std = 0.626)
SUFF++ for r=0.3 all L1 = 0.489 +- 0.143 (in-sample avg dev_std = 0.626)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.40273125
Model XAI WIoU of binarized graphs for r=0.6 =  0.8649862500000001
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.682
SUFF++ for r=0.6 class 0 = 0.56 +- 0.218 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 1 = 0.599 +- 0.218 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 2 = 0.63 +- 0.218 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all KL = 0.665 +- 0.218 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all L1 = 0.596 +- 0.140 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.2907125
Model XAI WIoU of binarized graphs for r=0.9 =  0.8649862500000001
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.876
SUFF++ for r=0.9 class 0 = 0.819 +- 0.122 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 class 1 = 0.809 +- 0.122 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 class 2 = 0.878 +- 0.122 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 all KL = 0.923 +- 0.122 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 all L1 = 0.836 +- 0.126 (in-sample avg dev_std = 0.213)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  0.50702375
Model XAI WIoU of binarized graphs for r=0.3 =  0.53719
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.604 +- 0.269 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 class 1 = 0.58 +- 0.269 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.269 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 all KL = 0.565 +- 0.269 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.3 all L1 = 0.585 +- 0.201 (in-sample avg dev_std = 0.531)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.841
Model XAI F1 of binarized graphs for r=0.6 =  0.53827
Model XAI WIoU of binarized graphs for r=0.6 =  0.70155
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF++ for r=0.6 class 0 = 0.641 +- 0.335 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 1 = 0.614 +- 0.335 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 2 = 0.681 +- 0.335 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 all KL = 0.577 +- 0.335 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 all L1 = 0.645 +- 0.195 (in-sample avg dev_std = 0.563)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.41909749999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.68894375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.896
SUFF++ for r=0.9 class 0 = 0.803 +- 0.181 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 1 = 0.92 +- 0.181 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 2 = 0.924 +- 0.181 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all KL = 0.89 +- 0.181 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all L1 = 0.883 +- 0.126 (in-sample avg dev_std = 0.234)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.435
Model XAI F1 of binarized graphs for r=0.3 =  0.40021999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.30246875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.327
NEC for r=0.3 class 0 = 0.503 +- 0.274 (in-sample avg dev_std = 0.374)
NEC for r=0.3 class 1 = 0.431 +- 0.274 (in-sample avg dev_std = 0.374)
NEC for r=0.3 class 2 = 0.516 +- 0.274 (in-sample avg dev_std = 0.374)
NEC for r=0.3 all KL = 0.385 +- 0.274 (in-sample avg dev_std = 0.374)
NEC for r=0.3 all L1 = 0.483 +- 0.163 (in-sample avg dev_std = 0.374)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.806
Model XAI F1 of binarized graphs for r=0.6 =  0.57744
Model XAI WIoU of binarized graphs for r=0.6 =  0.54618875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.456
NEC for r=0.6 class 0 = 0.528 +- 0.288 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 1 = 0.523 +- 0.288 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 2 = 0.575 +- 0.288 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all KL = 0.558 +- 0.288 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all L1 = 0.542 +- 0.153 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.47759875000000007
Model XAI WIoU of binarized graphs for r=0.9 =  0.5646375
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.504 +- 0.283 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.518 +- 0.283 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.55 +- 0.283 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.567 +- 0.283 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.524 +- 0.155 (in-sample avg dev_std = 0.561)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.5648837499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.507 +- 0.279 (in-sample avg dev_std = 0.558)
NEC for r=1.0 class 1 = 0.509 +- 0.279 (in-sample avg dev_std = 0.558)
NEC for r=1.0 class 2 = 0.515 +- 0.279 (in-sample avg dev_std = 0.558)
NEC for r=1.0 all KL = 0.553 +- 0.279 (in-sample avg dev_std = 0.558)
NEC for r=1.0 all L1 = 0.51 +- 0.151 (in-sample avg dev_std = 0.558)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.452
Model XAI F1 of binarized graphs for r=0.3 =  0.39763999999999994
Model XAI WIoU of binarized graphs for r=0.3 =  0.30240125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.487 +- 0.262 (in-sample avg dev_std = 0.363)
NEC for r=0.3 class 1 = 0.435 +- 0.262 (in-sample avg dev_std = 0.363)
NEC for r=0.3 class 2 = 0.52 +- 0.262 (in-sample avg dev_std = 0.363)
NEC for r=0.3 all KL = 0.369 +- 0.262 (in-sample avg dev_std = 0.363)
NEC for r=0.3 all L1 = 0.481 +- 0.152 (in-sample avg dev_std = 0.363)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.79
Model XAI F1 of binarized graphs for r=0.6 =  0.5723024999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.54200625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.444
NEC for r=0.6 class 0 = 0.528 +- 0.288 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 1 = 0.548 +- 0.288 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 2 = 0.595 +- 0.288 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all KL = 0.583 +- 0.288 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all L1 = 0.557 +- 0.153 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.4734399999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.5597675
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.544
NEC for r=0.9 class 0 = 0.501 +- 0.282 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.508 +- 0.282 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.556 +- 0.282 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.567 +- 0.282 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.521 +- 0.157 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.56101625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.565
NEC for r=1.0 class 0 = 0.496 +- 0.275 (in-sample avg dev_std = 0.558)
NEC for r=1.0 class 1 = 0.495 +- 0.275 (in-sample avg dev_std = 0.558)
NEC for r=1.0 class 2 = 0.525 +- 0.275 (in-sample avg dev_std = 0.558)
NEC for r=1.0 all KL = 0.547 +- 0.275 (in-sample avg dev_std = 0.558)
NEC for r=1.0 all L1 = 0.505 +- 0.153 (in-sample avg dev_std = 0.558)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.919
Model XAI F1 of binarized graphs for r=0.3 =  0.6530425000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8621787500000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.675 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.3 class 1 = 0.576 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.3 class 2 = 0.725 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.3 all KL = 0.715 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.3 all L1 = 0.66 +- 0.114 (in-sample avg dev_std = 0.453)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.40273125
Model XAI WIoU of binarized graphs for r=0.6 =  0.8649862500000001
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.476
NEC for r=0.6 class 0 = 0.555 +- 0.219 (in-sample avg dev_std = 0.522)
NEC for r=0.6 class 1 = 0.512 +- 0.219 (in-sample avg dev_std = 0.522)
NEC for r=0.6 class 2 = 0.544 +- 0.219 (in-sample avg dev_std = 0.522)
NEC for r=0.6 all KL = 0.477 +- 0.219 (in-sample avg dev_std = 0.522)
NEC for r=0.6 all L1 = 0.537 +- 0.120 (in-sample avg dev_std = 0.522)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.2907125
Model XAI WIoU of binarized graphs for r=0.9 =  0.8649862500000001
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.525 +- 0.206 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 1 = 0.505 +- 0.206 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 2 = 0.431 +- 0.206 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all KL = 0.421 +- 0.206 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all L1 = 0.487 +- 0.128 (in-sample avg dev_std = 0.520)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.8649862500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.55
NEC for r=1.0 class 0 = 0.524 +- 0.197 (in-sample avg dev_std = 0.519)
NEC for r=1.0 class 1 = 0.486 +- 0.197 (in-sample avg dev_std = 0.519)
NEC for r=1.0 class 2 = 0.44 +- 0.197 (in-sample avg dev_std = 0.519)
NEC for r=1.0 all KL = 0.415 +- 0.197 (in-sample avg dev_std = 0.519)
NEC for r=1.0 all L1 = 0.483 +- 0.121 (in-sample avg dev_std = 0.519)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  0.50702375
Model XAI WIoU of binarized graphs for r=0.3 =  0.53719
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.472
NEC for r=0.3 class 0 = 0.523 +- 0.222 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 1 = 0.524 +- 0.222 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 2 = 0.617 +- 0.222 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all KL = 0.585 +- 0.222 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all L1 = 0.555 +- 0.123 (in-sample avg dev_std = 0.516)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.841
Model XAI F1 of binarized graphs for r=0.6 =  0.53827
Model XAI WIoU of binarized graphs for r=0.6 =  0.70155
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.512
NEC for r=0.6 class 0 = 0.457 +- 0.348 (in-sample avg dev_std = 0.493)
NEC for r=0.6 class 1 = 0.47 +- 0.348 (in-sample avg dev_std = 0.493)
NEC for r=0.6 class 2 = 0.526 +- 0.348 (in-sample avg dev_std = 0.493)
NEC for r=0.6 all KL = 0.515 +- 0.348 (in-sample avg dev_std = 0.493)
NEC for r=0.6 all L1 = 0.484 +- 0.211 (in-sample avg dev_std = 0.493)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.41909749999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.68894375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.605
NEC for r=0.9 class 0 = 0.412 +- 0.337 (in-sample avg dev_std = 0.572)
NEC for r=0.9 class 1 = 0.453 +- 0.337 (in-sample avg dev_std = 0.572)
NEC for r=0.9 class 2 = 0.433 +- 0.337 (in-sample avg dev_std = 0.572)
NEC for r=0.9 all KL = 0.486 +- 0.337 (in-sample avg dev_std = 0.572)
NEC for r=0.9 all L1 = 0.433 +- 0.208 (in-sample avg dev_std = 0.572)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.68894375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.64
NEC for r=1.0 class 0 = 0.41 +- 0.314 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 1 = 0.428 +- 0.314 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 2 = 0.387 +- 0.314 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all KL = 0.455 +- 0.314 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all L1 = 0.408 +- 0.193 (in-sample avg dev_std = 0.565)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:52:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:52:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8840
Train Loss: 0.4621
ID Validation ACCURACY: 0.8847
ID Validation Loss: 0.4565
ID Test ACCURACY: 0.8710
ID Test Loss: 0.4904
OOD Validation ACCURACY: 0.8557
OOD Validation Loss: 0.5559
OOD Test ACCURACY: 0.8713
OOD Test Loss: 0.4670

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.8378
Train Loss: 0.5626
ID Validation ACCURACY: 0.8373
ID Validation Loss: 0.5631
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5713
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.5173
OOD Test ACCURACY: 0.8860
OOD Test Loss: 0.4481

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.8713 0.8380 0.8860 0.8373 0.9187[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.606
WIoU for r=0.3 = 0.568
F1 for r=0.6 = 0.609
WIoU for r=0.6 = 0.733
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.745
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.746
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.624
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.600
WIoU for r=0.6 = 0.732
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.746
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.747
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.641
WIoU for r=0.3 = 0.967
F1 for r=0.6 = 0.392
WIoU for r=0.6 = 0.967
F1 for r=0.9 = 0.284
WIoU for r=0.9 = 0.967
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.967
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.585
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.538
WIoU for r=0.6 = 0.682
F1 for r=0.9 = 0.419
WIoU for r=0.9 = 0.693
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.693


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  0.60619
Model XAI WIoU of binarized graphs for r=0.3 =  0.5684925
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.386
SUFF++ for r=0.3 class 0 = 0.549 +- 0.264 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 class 1 = 0.629 +- 0.264 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 class 2 = 0.55 +- 0.264 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 all KL = 0.643 +- 0.264 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 all L1 = 0.576 +- 0.154 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.842
Model XAI F1 of binarized graphs for r=0.6 =  0.6092525000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7328575
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.661
SUFF++ for r=0.6 class 0 = 0.596 +- 0.233 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.642 +- 0.233 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.659 +- 0.233 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.657 +- 0.233 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.187 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.47995875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7454837499999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.85
SUFF++ for r=0.9 class 0 = 0.831 +- 0.156 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 class 1 = 0.821 +- 0.156 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.156 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 all KL = 0.906 +- 0.156 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.177 (in-sample avg dev_std = 0.205)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.539
Model XAI F1 of binarized graphs for r=0.3 =  0.623875
Model XAI WIoU of binarized graphs for r=0.3 =  0.58365
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.384
SUFF++ for r=0.3 class 0 = 0.553 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 1 = 0.629 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 2 = 0.524 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all KL = 0.641 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all L1 = 0.569 +- 0.148 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  0.60034625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7322475
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0 = 0.609 +- 0.248 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.654 +- 0.248 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.66 +- 0.248 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.661 +- 0.248 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.641 +- 0.189 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.47543875
Model XAI WIoU of binarized graphs for r=0.9 =  0.74633375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.848
SUFF++ for r=0.9 class 0 = 0.82 +- 0.147 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 class 1 = 0.833 +- 0.147 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 class 2 = 0.878 +- 0.147 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 all KL = 0.913 +- 0.147 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.172 (in-sample avg dev_std = 0.190)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.837
Model XAI F1 of binarized graphs for r=0.3 =  0.6413
Model XAI WIoU of binarized graphs for r=0.3 =  0.96719875
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.552
SUFF++ for r=0.3 class 0 = 0.481 +- 0.291 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.3 class 1 = 0.659 +- 0.291 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.3 class 2 = 0.474 +- 0.291 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.3 all KL = 0.524 +- 0.291 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.3 all L1 = 0.537 +- 0.144 (in-sample avg dev_std = 0.595)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.858
Model XAI F1 of binarized graphs for r=0.6 =  0.39219375
Model XAI WIoU of binarized graphs for r=0.6 =  0.96719875
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.664
SUFF++ for r=0.6 class 0 = 0.606 +- 0.196 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.607 +- 0.196 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.648 +- 0.196 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.717 +- 0.196 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.621 +- 0.140 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.859
Model XAI F1 of binarized graphs for r=0.9 =  0.28374874999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.96719875
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.832
SUFF++ for r=0.9 class 0 = 0.833 +- 0.084 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 class 1 = 0.82 +- 0.084 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 class 2 = 0.838 +- 0.084 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 all KL = 0.937 +- 0.084 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.114 (in-sample avg dev_std = 0.191)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  0.5849775
Model XAI WIoU of binarized graphs for r=0.3 =  0.5925825
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.548
SUFF++ for r=0.3 class 0 = 0.627 +- 0.241 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.241 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 2 = 0.637 +- 0.241 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all KL = 0.634 +- 0.241 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all L1 = 0.647 +- 0.139 (in-sample avg dev_std = 0.481)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.798
Model XAI F1 of binarized graphs for r=0.6 =  0.5379175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6819325
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF++ for r=0.6 class 0 = 0.684 +- 0.237 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1 = 0.735 +- 0.237 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 2 = 0.71 +- 0.237 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.758 +- 0.237 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.71 +- 0.174 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.41876
Model XAI WIoU of binarized graphs for r=0.9 =  0.69301125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0 = 0.825 +- 0.062 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 class 1 = 0.909 +- 0.062 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 class 2 = 0.929 +- 0.062 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 all KL = 0.953 +- 0.062 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 all L1 = 0.889 +- 0.113 (in-sample avg dev_std = 0.168)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  0.60619
Model XAI WIoU of binarized graphs for r=0.3 =  0.5684925
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
NEC for r=0.3 class 0 = 0.547 +- 0.285 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 1 = 0.523 +- 0.285 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 2 = 0.571 +- 0.285 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all KL = 0.501 +- 0.285 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all L1 = 0.547 +- 0.147 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.842
Model XAI F1 of binarized graphs for r=0.6 =  0.6092525000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7328575
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.445
NEC for r=0.6 class 0 = 0.533 +- 0.299 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.544 +- 0.299 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.59 +- 0.299 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.547 +- 0.299 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.556 +- 0.161 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.47995875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7454837499999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.502
NEC for r=0.9 class 0 = 0.506 +- 0.279 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.517 +- 0.279 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.545 +- 0.279 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.512 +- 0.279 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.523 +- 0.155 (in-sample avg dev_std = 0.508)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.74578
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.523
NEC for r=1.0 class 0 = 0.491 +- 0.275 (in-sample avg dev_std = 0.510)
NEC for r=1.0 class 1 = 0.508 +- 0.275 (in-sample avg dev_std = 0.510)
NEC for r=1.0 class 2 = 0.522 +- 0.275 (in-sample avg dev_std = 0.510)
NEC for r=1.0 all KL = 0.497 +- 0.275 (in-sample avg dev_std = 0.510)
NEC for r=1.0 all L1 = 0.507 +- 0.153 (in-sample avg dev_std = 0.510)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.539
Model XAI F1 of binarized graphs for r=0.3 =  0.623875
Model XAI WIoU of binarized graphs for r=0.3 =  0.58365
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
NEC for r=0.3 class 0 = 0.548 +- 0.276 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 1 = 0.544 +- 0.276 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 2 = 0.569 +- 0.276 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all KL = 0.5 +- 0.276 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all L1 = 0.554 +- 0.144 (in-sample avg dev_std = 0.371)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  0.60034625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7322475
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.445
NEC for r=0.6 class 0 = 0.523 +- 0.306 (in-sample avg dev_std = 0.456)
NEC for r=0.6 class 1 = 0.544 +- 0.306 (in-sample avg dev_std = 0.456)
NEC for r=0.6 class 2 = 0.573 +- 0.306 (in-sample avg dev_std = 0.456)
NEC for r=0.6 all KL = 0.54 +- 0.306 (in-sample avg dev_std = 0.456)
NEC for r=0.6 all L1 = 0.547 +- 0.167 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.47543875
Model XAI WIoU of binarized graphs for r=0.9 =  0.74633375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.488 +- 0.282 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 1 = 0.504 +- 0.282 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 2 = 0.522 +- 0.282 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all KL = 0.489 +- 0.282 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all L1 = 0.505 +- 0.158 (in-sample avg dev_std = 0.507)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.9
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7474975
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.53
NEC for r=1.0 class 0 = 0.485 +- 0.275 (in-sample avg dev_std = 0.509)
NEC for r=1.0 class 1 = 0.499 +- 0.275 (in-sample avg dev_std = 0.509)
NEC for r=1.0 class 2 = 0.519 +- 0.275 (in-sample avg dev_std = 0.509)
NEC for r=1.0 all KL = 0.487 +- 0.275 (in-sample avg dev_std = 0.509)
NEC for r=1.0 all L1 = 0.501 +- 0.154 (in-sample avg dev_std = 0.509)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.837
Model XAI F1 of binarized graphs for r=0.3 =  0.6413
Model XAI WIoU of binarized graphs for r=0.3 =  0.96719875
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.594 +- 0.286 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.533 +- 0.286 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.72 +- 0.286 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.606 +- 0.286 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.617 +- 0.146 (in-sample avg dev_std = 0.403)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.858
Model XAI F1 of binarized graphs for r=0.6 =  0.39219375
Model XAI WIoU of binarized graphs for r=0.6 =  0.96719875
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.459
NEC for r=0.6 class 0 = 0.521 +- 0.224 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.49 +- 0.224 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.557 +- 0.224 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.433 +- 0.224 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.523 +- 0.122 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.859
Model XAI F1 of binarized graphs for r=0.9 =  0.28374874999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.96719875
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.521
NEC for r=0.9 class 0 = 0.496 +- 0.201 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 1 = 0.491 +- 0.201 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 2 = 0.47 +- 0.201 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all KL = 0.398 +- 0.201 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all L1 = 0.486 +- 0.122 (in-sample avg dev_std = 0.498)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.859
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.96719875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.525
NEC for r=1.0 class 0 = 0.499 +- 0.192 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 1 = 0.483 +- 0.192 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 2 = 0.454 +- 0.192 (in-sample avg dev_std = 0.494)
NEC for r=1.0 all KL = 0.389 +- 0.192 (in-sample avg dev_std = 0.494)
NEC for r=1.0 all L1 = 0.478 +- 0.120 (in-sample avg dev_std = 0.494)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  0.5849775
Model XAI WIoU of binarized graphs for r=0.3 =  0.5925825
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.417
NEC for r=0.3 class 0 = 0.533 +- 0.311 (in-sample avg dev_std = 0.436)
NEC for r=0.3 class 1 = 0.468 +- 0.311 (in-sample avg dev_std = 0.436)
NEC for r=0.3 class 2 = 0.547 +- 0.311 (in-sample avg dev_std = 0.436)
NEC for r=0.3 all KL = 0.54 +- 0.311 (in-sample avg dev_std = 0.436)
NEC for r=0.3 all L1 = 0.516 +- 0.174 (in-sample avg dev_std = 0.436)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.798
Model XAI F1 of binarized graphs for r=0.6 =  0.5379175
Model XAI WIoU of binarized graphs for r=0.6 =  0.6819325
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.527
NEC for r=0.6 class 0 = 0.46 +- 0.303 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.457 +- 0.303 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.451 +- 0.303 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.42 +- 0.303 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.456 +- 0.181 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.41876
Model XAI WIoU of binarized graphs for r=0.9 =  0.69301125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.444 +- 0.314 (in-sample avg dev_std = 0.553)
NEC for r=0.9 class 1 = 0.409 +- 0.314 (in-sample avg dev_std = 0.553)
NEC for r=0.9 class 2 = 0.415 +- 0.314 (in-sample avg dev_std = 0.553)
NEC for r=0.9 all KL = 0.426 +- 0.314 (in-sample avg dev_std = 0.553)
NEC for r=0.9 all L1 = 0.423 +- 0.184 (in-sample avg dev_std = 0.553)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.874
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.69301125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.606
NEC for r=1.0 class 0 = 0.439 +- 0.302 (in-sample avg dev_std = 0.561)
NEC for r=1.0 class 1 = 0.399 +- 0.302 (in-sample avg dev_std = 0.561)
NEC for r=1.0 class 2 = 0.42 +- 0.302 (in-sample avg dev_std = 0.561)
NEC for r=1.0 all KL = 0.419 +- 0.302 (in-sample avg dev_std = 0.561)
NEC for r=1.0 all L1 = 0.419 +- 0.174 (in-sample avg dev_std = 0.561)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu May  2 23:58:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/02/2024 11:58:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ACCURACY: 0.8867
Train Loss: 0.4438
ID Validation ACCURACY: 0.8937
ID Validation Loss: 0.4262
ID Test ACCURACY: 0.8900
ID Test Loss: 0.4573
OOD Validation ACCURACY: 0.8703
OOD Validation Loss: 0.5403
OOD Test ACCURACY: 0.8920
OOD Test Loss: 0.4081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.8267
Train Loss: 0.5441
ID Validation ACCURACY: 0.8370
ID Validation Loss: 0.5474
ID Test ACCURACY: 0.8303
ID Test Loss: 0.5671
OOD Validation ACCURACY: 0.8900
OOD Validation Loss: 0.5611
OOD Test ACCURACY: 0.7843
OOD Test Loss: 0.6018

[0m[1;37mINFO[0m: [1mChartInfo 0.8900 0.8920 0.8303 0.7843 0.8370 0.8900[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.438
WIoU for r=0.3 = 0.393
F1 for r=0.6 = 0.511
WIoU for r=0.6 = 0.558
F1 for r=0.9 = 0.465
WIoU for r=0.9 = 0.605
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.610
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.463
WIoU for r=0.3 = 0.419
F1 for r=0.6 = 0.526
WIoU for r=0.6 = 0.579
F1 for r=0.9 = 0.465
WIoU for r=0.9 = 0.616
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.621
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.589
WIoU for r=0.3 = 0.854
F1 for r=0.6 = 0.360
WIoU for r=0.6 = 0.854
F1 for r=0.9 = 0.270
WIoU for r=0.9 = 0.854
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.854
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.735
WIoU for r=0.3 = 0.813
F1 for r=0.6 = 0.545
WIoU for r=0.6 = 0.798
F1 for r=0.9 = 0.412
WIoU for r=0.9 = 0.763
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.763


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  0.43781875
Model XAI WIoU of binarized graphs for r=0.3 =  0.39279375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF++ for r=0.3 class 0 = 0.547 +- 0.257 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 class 1 = 0.627 +- 0.257 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 class 2 = 0.496 +- 0.257 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 all KL = 0.64 +- 0.257 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 all L1 = 0.557 +- 0.151 (in-sample avg dev_std = 0.430)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.51127875
Model XAI WIoU of binarized graphs for r=0.6 =  0.55828375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.599
SUFF++ for r=0.6 class 0 = 0.606 +- 0.259 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 1 = 0.641 +- 0.259 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 2 = 0.524 +- 0.259 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all KL = 0.648 +- 0.259 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all L1 = 0.591 +- 0.182 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  0.46452375
Model XAI WIoU of binarized graphs for r=0.9 =  0.6050125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.804
SUFF++ for r=0.9 class 0 = 0.824 +- 0.138 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 1 = 0.821 +- 0.138 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 2 = 0.833 +- 0.138 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all KL = 0.905 +- 0.138 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all L1 = 0.826 +- 0.153 (in-sample avg dev_std = 0.232)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.526
Model XAI F1 of binarized graphs for r=0.3 =  0.4631637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.41868125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.431
SUFF++ for r=0.3 class 0 = 0.543 +- 0.259 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 1 = 0.615 +- 0.259 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 2 = 0.494 +- 0.259 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all KL = 0.632 +- 0.259 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.147 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.52616875
Model XAI WIoU of binarized graphs for r=0.6 =  0.5794812500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.622
SUFF++ for r=0.6 class 0 = 0.603 +- 0.255 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1 = 0.656 +- 0.255 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 2 = 0.533 +- 0.255 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.649 +- 0.255 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.598 +- 0.177 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.46528625000000007
Model XAI WIoU of binarized graphs for r=0.9 =  0.6162899999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.827
SUFF++ for r=0.9 class 0 = 0.838 +- 0.140 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 1 = 0.825 +- 0.140 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 2 = 0.843 +- 0.140 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all KL = 0.908 +- 0.140 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all L1 = 0.835 +- 0.149 (in-sample avg dev_std = 0.230)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.842
Model XAI F1 of binarized graphs for r=0.3 =  0.58859625
Model XAI WIoU of binarized graphs for r=0.3 =  0.85407625
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.55
SUFF++ for r=0.3 class 0 = 0.561 +- 0.304 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 class 1 = 0.655 +- 0.304 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 class 2 = 0.403 +- 0.304 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 all KL = 0.546 +- 0.304 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 all L1 = 0.538 +- 0.153 (in-sample avg dev_std = 0.576)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  0.36009125000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.8544625
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0 = 0.678 +- 0.175 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 1 = 0.678 +- 0.175 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 2 = 0.61 +- 0.175 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all KL = 0.785 +- 0.175 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all L1 = 0.655 +- 0.127 (in-sample avg dev_std = 0.372)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  0.26972124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.8544625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0 = 0.859 +- 0.076 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 1 = 0.825 +- 0.076 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 2 = 0.835 +- 0.076 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all KL = 0.946 +- 0.076 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.101 (in-sample avg dev_std = 0.178)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  0.73547
Model XAI WIoU of binarized graphs for r=0.3 =  0.8133475000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0 = 0.568 +- 0.310 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 1 = 0.637 +- 0.310 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 2 = 0.586 +- 0.310 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 all KL = 0.561 +- 0.310 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.189 (in-sample avg dev_std = 0.489)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.54466375
Model XAI WIoU of binarized graphs for r=0.6 =  0.79770625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0 = 0.593 +- 0.348 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.6 class 1 = 0.766 +- 0.348 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.6 class 2 = 0.638 +- 0.348 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.6 all KL = 0.654 +- 0.348 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.6 all L1 = 0.667 +- 0.220 (in-sample avg dev_std = 0.558)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.41188625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7625737499999999
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.805
SUFF++ for r=0.9 class 0 = 0.711 +- 0.240 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1 = 0.884 +- 0.240 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 2 = 0.812 +- 0.240 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.833 +- 0.240 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.194 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  0.43781875
Model XAI WIoU of binarized graphs for r=0.3 =  0.39279375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.381
NEC for r=0.3 class 0 = 0.507 +- 0.272 (in-sample avg dev_std = 0.369)
NEC for r=0.3 class 1 = 0.442 +- 0.272 (in-sample avg dev_std = 0.369)
NEC for r=0.3 class 2 = 0.548 +- 0.272 (in-sample avg dev_std = 0.369)
NEC for r=0.3 all KL = 0.41 +- 0.272 (in-sample avg dev_std = 0.369)
NEC for r=0.3 all L1 = 0.499 +- 0.158 (in-sample avg dev_std = 0.369)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.51127875
Model XAI WIoU of binarized graphs for r=0.6 =  0.55828375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.468
NEC for r=0.6 class 0 = 0.494 +- 0.263 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 1 = 0.446 +- 0.263 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 2 = 0.595 +- 0.263 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all KL = 0.46 +- 0.263 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all L1 = 0.512 +- 0.161 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  0.46452375
Model XAI WIoU of binarized graphs for r=0.9 =  0.6050125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.516 +- 0.264 (in-sample avg dev_std = 0.502)
NEC for r=0.9 class 1 = 0.404 +- 0.264 (in-sample avg dev_std = 0.502)
NEC for r=0.9 class 2 = 0.556 +- 0.264 (in-sample avg dev_std = 0.502)
NEC for r=0.9 all KL = 0.447 +- 0.264 (in-sample avg dev_std = 0.502)
NEC for r=0.9 all L1 = 0.492 +- 0.162 (in-sample avg dev_std = 0.502)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.892
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.60985125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.507 +- 0.284 (in-sample avg dev_std = 0.526)
NEC for r=1.0 class 1 = 0.4 +- 0.284 (in-sample avg dev_std = 0.526)
NEC for r=1.0 class 2 = 0.549 +- 0.284 (in-sample avg dev_std = 0.526)
NEC for r=1.0 all KL = 0.47 +- 0.284 (in-sample avg dev_std = 0.526)
NEC for r=1.0 all L1 = 0.485 +- 0.171 (in-sample avg dev_std = 0.526)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.526
Model XAI F1 of binarized graphs for r=0.3 =  0.4631637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.41868125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.375
NEC for r=0.3 class 0 = 0.518 +- 0.271 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 1 = 0.454 +- 0.271 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 2 = 0.547 +- 0.271 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all KL = 0.419 +- 0.271 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all L1 = 0.506 +- 0.153 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.52616875
Model XAI WIoU of binarized graphs for r=0.6 =  0.5794812500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.46
NEC for r=0.6 class 0 = 0.5 +- 0.273 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 1 = 0.468 +- 0.273 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 2 = 0.603 +- 0.273 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all KL = 0.484 +- 0.273 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all L1 = 0.523 +- 0.165 (in-sample avg dev_std = 0.474)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.46528625000000007
Model XAI WIoU of binarized graphs for r=0.9 =  0.6162899999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.546
NEC for r=0.9 class 0 = 0.515 +- 0.268 (in-sample avg dev_std = 0.521)
NEC for r=0.9 class 1 = 0.408 +- 0.268 (in-sample avg dev_std = 0.521)
NEC for r=0.9 class 2 = 0.541 +- 0.268 (in-sample avg dev_std = 0.521)
NEC for r=0.9 all KL = 0.454 +- 0.268 (in-sample avg dev_std = 0.521)
NEC for r=0.9 all L1 = 0.488 +- 0.163 (in-sample avg dev_std = 0.521)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.905
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.6206375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.578
NEC for r=1.0 class 0 = 0.509 +- 0.280 (in-sample avg dev_std = 0.539)
NEC for r=1.0 class 1 = 0.4 +- 0.280 (in-sample avg dev_std = 0.539)
NEC for r=1.0 class 2 = 0.538 +- 0.280 (in-sample avg dev_std = 0.539)
NEC for r=1.0 all KL = 0.472 +- 0.280 (in-sample avg dev_std = 0.539)
NEC for r=1.0 all L1 = 0.482 +- 0.165 (in-sample avg dev_std = 0.539)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.842
Model XAI F1 of binarized graphs for r=0.3 =  0.58859625
Model XAI WIoU of binarized graphs for r=0.3 =  0.85407625
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.551 +- 0.315 (in-sample avg dev_std = 0.358)
NEC for r=0.3 class 1 = 0.483 +- 0.315 (in-sample avg dev_std = 0.358)
NEC for r=0.3 class 2 = 0.755 +- 0.315 (in-sample avg dev_std = 0.358)
NEC for r=0.3 all KL = 0.573 +- 0.315 (in-sample avg dev_std = 0.358)
NEC for r=0.3 all L1 = 0.598 +- 0.177 (in-sample avg dev_std = 0.358)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  0.36009125000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.8544625
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.49
NEC for r=0.6 class 0 = 0.451 +- 0.231 (in-sample avg dev_std = 0.400)
NEC for r=0.6 class 1 = 0.385 +- 0.231 (in-sample avg dev_std = 0.400)
NEC for r=0.6 class 2 = 0.562 +- 0.231 (in-sample avg dev_std = 0.400)
NEC for r=0.6 all KL = 0.333 +- 0.231 (in-sample avg dev_std = 0.400)
NEC for r=0.6 all L1 = 0.467 +- 0.150 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  0.26972124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.8544625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.562
NEC for r=0.9 class 0 = 0.424 +- 0.195 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.359 +- 0.195 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.482 +- 0.195 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.285 +- 0.195 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.422 +- 0.127 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.8544625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0 = 0.415 +- 0.191 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 1 = 0.356 +- 0.191 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 2 = 0.475 +- 0.191 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all KL = 0.279 +- 0.191 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all L1 = 0.416 +- 0.125 (in-sample avg dev_std = 0.416)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  0.73547
Model XAI WIoU of binarized graphs for r=0.3 =  0.8133475000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.433
NEC for r=0.3 class 0 = 0.553 +- 0.299 (in-sample avg dev_std = 0.499)
NEC for r=0.3 class 1 = 0.49 +- 0.299 (in-sample avg dev_std = 0.499)
NEC for r=0.3 class 2 = 0.619 +- 0.299 (in-sample avg dev_std = 0.499)
NEC for r=0.3 all KL = 0.599 +- 0.299 (in-sample avg dev_std = 0.499)
NEC for r=0.3 all L1 = 0.553 +- 0.171 (in-sample avg dev_std = 0.499)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.54466375
Model XAI WIoU of binarized graphs for r=0.6 =  0.79770625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.574
NEC for r=0.6 class 0 = 0.426 +- 0.317 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 1 = 0.351 +- 0.317 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 2 = 0.544 +- 0.317 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all KL = 0.434 +- 0.317 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all L1 = 0.44 +- 0.210 (in-sample avg dev_std = 0.519)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.41188625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7625737499999999
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.595
NEC for r=0.9 class 0 = 0.435 +- 0.307 (in-sample avg dev_std = 0.554)
NEC for r=0.9 class 1 = 0.299 +- 0.307 (in-sample avg dev_std = 0.554)
NEC for r=0.9 class 2 = 0.505 +- 0.307 (in-sample avg dev_std = 0.554)
NEC for r=0.9 all KL = 0.412 +- 0.307 (in-sample avg dev_std = 0.554)
NEC for r=0.9 all L1 = 0.411 +- 0.208 (in-sample avg dev_std = 0.554)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7625737499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.602
NEC for r=1.0 class 0 = 0.422 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 1 = 0.3 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 2 = 0.494 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all KL = 0.407 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all L1 = 0.404 +- 0.207 (in-sample avg dev_std = 0.562)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:03:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:03:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.8653
Train Loss: 0.4841
ID Validation ACCURACY: 0.8673
ID Validation Loss: 0.4704
ID Test ACCURACY: 0.8673
ID Test Loss: 0.4934
OOD Validation ACCURACY: 0.8580
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.8357
OOD Test Loss: 0.5047

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 0.8568
Train Loss: 0.4933
ID Validation ACCURACY: 0.8580
ID Validation Loss: 0.4774
ID Test ACCURACY: 0.8570
ID Test Loss: 0.5011
OOD Validation ACCURACY: 0.8980
OOD Validation Loss: 0.5087
OOD Test ACCURACY: 0.8823
OOD Test Loss: 0.4434

[0m[1;37mINFO[0m: [1mChartInfo 0.8673 0.8357 0.8570 0.8823 0.8580 0.8980[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.613
WIoU for r=0.3 = 0.608
F1 for r=0.6 = 0.587
WIoU for r=0.6 = 0.763
F1 for r=0.9 = 0.470
WIoU for r=0.9 = 0.773
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.773
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.626
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.585
WIoU for r=0.6 = 0.769
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.778
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.779
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.587
WIoU for r=0.3 = 0.839
F1 for r=0.6 = 0.359
WIoU for r=0.6 = 0.840
F1 for r=0.9 = 0.274
WIoU for r=0.9 = 0.840
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.840
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.734
WIoU for r=0.3 = 0.762
F1 for r=0.6 = 0.536
WIoU for r=0.6 = 0.823
F1 for r=0.9 = 0.406
WIoU for r=0.9 = 0.823
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.823


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  0.61303
Model XAI WIoU of binarized graphs for r=0.3 =  0.60824125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.436
SUFF++ for r=0.3 class 0 = 0.557 +- 0.246 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 1 = 0.67 +- 0.246 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 2 = 0.522 +- 0.246 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all KL = 0.604 +- 0.246 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all L1 = 0.583 +- 0.168 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.58687
Model XAI WIoU of binarized graphs for r=0.6 =  0.762625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.727
SUFF++ for r=0.6 class 0 = 0.653 +- 0.240 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 class 1 = 0.721 +- 0.240 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 class 2 = 0.676 +- 0.240 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 all KL = 0.731 +- 0.240 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 all L1 = 0.683 +- 0.193 (in-sample avg dev_std = 0.420)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  0.47012625
Model XAI WIoU of binarized graphs for r=0.9 =  0.77271
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0 = 0.874 +- 0.110 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 1 = 0.839 +- 0.110 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.110 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all KL = 0.932 +- 0.110 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all L1 = 0.864 +- 0.139 (in-sample avg dev_std = 0.177)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.585
Model XAI F1 of binarized graphs for r=0.3 =  0.6257699999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6238025
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.455
SUFF++ for r=0.3 class 0 = 0.566 +- 0.259 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 class 1 = 0.672 +- 0.259 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 class 2 = 0.506 +- 0.259 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 all KL = 0.589 +- 0.259 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 all L1 = 0.582 +- 0.172 (in-sample avg dev_std = 0.504)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.853
Model XAI F1 of binarized graphs for r=0.6 =  0.58496875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7690174999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.732
SUFF++ for r=0.6 class 0 = 0.687 +- 0.242 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1 = 0.736 +- 0.242 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 2 = 0.671 +- 0.242 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.741 +- 0.242 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.698 +- 0.192 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.46699124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7780787499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.85
SUFF++ for r=0.9 class 0 = 0.872 +- 0.097 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.097 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 2 = 0.873 +- 0.097 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all KL = 0.934 +- 0.097 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all L1 = 0.865 +- 0.133 (in-sample avg dev_std = 0.182)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.9
Model XAI F1 of binarized graphs for r=0.3 =  0.5871275
Model XAI WIoU of binarized graphs for r=0.3 =  0.83905125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0 = 0.523 +- 0.279 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.3 class 1 = 0.622 +- 0.279 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.3 class 2 = 0.444 +- 0.279 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.3 all KL = 0.537 +- 0.279 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.3 all L1 = 0.529 +- 0.150 (in-sample avg dev_std = 0.569)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  0.35938749999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.840145
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.71
SUFF++ for r=0.6 class 0 = 0.746 +- 0.174 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 class 1 = 0.692 +- 0.174 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 class 2 = 0.686 +- 0.174 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 all KL = 0.828 +- 0.174 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 all L1 = 0.708 +- 0.141 (in-sample avg dev_std = 0.345)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  0.27361625
Model XAI WIoU of binarized graphs for r=0.9 =  0.840145
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.814
SUFF++ for r=0.9 class 0 = 0.882 +- 0.084 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.084 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 class 2 = 0.863 +- 0.084 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 all KL = 0.956 +- 0.084 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 all L1 = 0.872 +- 0.114 (in-sample avg dev_std = 0.169)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  0.73378625
Model XAI WIoU of binarized graphs for r=0.3 =  0.76169125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.542
SUFF++ for r=0.3 class 0 = 0.62 +- 0.271 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 1 = 0.733 +- 0.271 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 2 = 0.561 +- 0.271 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 all KL = 0.622 +- 0.271 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 all L1 = 0.639 +- 0.154 (in-sample avg dev_std = 0.489)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.84
Model XAI F1 of binarized graphs for r=0.6 =  0.5364249999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.8232725000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.809
SUFF++ for r=0.6 class 0 = 0.833 +- 0.149 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 1 = 0.742 +- 0.149 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 2 = 0.843 +- 0.149 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 all KL = 0.874 +- 0.149 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 all L1 = 0.805 +- 0.123 (in-sample avg dev_std = 0.293)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  0.40617625
Model XAI WIoU of binarized graphs for r=0.9 =  0.8232725000000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.828
SUFF++ for r=0.9 class 0 = 0.905 +- 0.074 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 1 = 0.877 +- 0.074 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 2 = 0.89 +- 0.074 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all KL = 0.951 +- 0.074 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.116 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  0.61303
Model XAI WIoU of binarized graphs for r=0.3 =  0.60824125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.372
NEC for r=0.3 class 0 = 0.521 +- 0.282 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 1 = 0.513 +- 0.282 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 2 = 0.52 +- 0.282 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all KL = 0.505 +- 0.282 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all L1 = 0.518 +- 0.162 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  0.58687
Model XAI WIoU of binarized graphs for r=0.6 =  0.762625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.493
NEC for r=0.6 class 0 = 0.519 +- 0.285 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 1 = 0.473 +- 0.285 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 2 = 0.568 +- 0.285 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all KL = 0.493 +- 0.285 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all L1 = 0.52 +- 0.156 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  0.47012625
Model XAI WIoU of binarized graphs for r=0.9 =  0.77271
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.572
NEC for r=0.9 class 0 = 0.469 +- 0.285 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 1 = 0.441 +- 0.285 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 2 = 0.51 +- 0.285 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all KL = 0.449 +- 0.285 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all L1 = 0.473 +- 0.157 (in-sample avg dev_std = 0.500)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.77281375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.586
NEC for r=1.0 class 0 = 0.453 +- 0.283 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 1 = 0.444 +- 0.283 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 2 = 0.499 +- 0.283 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all KL = 0.438 +- 0.283 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all L1 = 0.465 +- 0.155 (in-sample avg dev_std = 0.492)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.585
Model XAI F1 of binarized graphs for r=0.3 =  0.6257699999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6238025
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.508 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 1 = 0.539 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 2 = 0.552 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all KL = 0.537 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all L1 = 0.533 +- 0.161 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.853
Model XAI F1 of binarized graphs for r=0.6 =  0.58496875
Model XAI WIoU of binarized graphs for r=0.6 =  0.7690174999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.504
NEC for r=0.6 class 0 = 0.517 +- 0.289 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.48 +- 0.289 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.57 +- 0.289 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.504 +- 0.289 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.522 +- 0.159 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.46699124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7780787499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.573
NEC for r=0.9 class 0 = 0.463 +- 0.277 (in-sample avg dev_std = 0.513)
NEC for r=0.9 class 1 = 0.436 +- 0.277 (in-sample avg dev_std = 0.513)
NEC for r=0.9 class 2 = 0.513 +- 0.277 (in-sample avg dev_std = 0.513)
NEC for r=0.9 all KL = 0.446 +- 0.277 (in-sample avg dev_std = 0.513)
NEC for r=0.9 all L1 = 0.471 +- 0.151 (in-sample avg dev_std = 0.513)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.879
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7785000000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.585
NEC for r=1.0 class 0 = 0.456 +- 0.278 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 1 = 0.426 +- 0.278 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 2 = 0.506 +- 0.278 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all KL = 0.434 +- 0.278 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all L1 = 0.462 +- 0.157 (in-sample avg dev_std = 0.492)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.9
Model XAI F1 of binarized graphs for r=0.3 =  0.5871275
Model XAI WIoU of binarized graphs for r=0.3 =  0.83905125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.352
NEC for r=0.3 class 0 = 0.594 +- 0.276 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.516 +- 0.276 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.708 +- 0.276 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.586 +- 0.276 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.607 +- 0.142 (in-sample avg dev_std = 0.405)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  0.35938749999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.840145
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.512
NEC for r=0.6 class 0 = 0.441 +- 0.209 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 1 = 0.405 +- 0.209 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 2 = 0.506 +- 0.209 (in-sample avg dev_std = 0.409)
NEC for r=0.6 all KL = 0.316 +- 0.209 (in-sample avg dev_std = 0.409)
NEC for r=0.6 all L1 = 0.451 +- 0.136 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  0.27361625
Model XAI WIoU of binarized graphs for r=0.9 =  0.840145
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.563
NEC for r=0.9 class 0 = 0.389 +- 0.176 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 1 = 0.378 +- 0.176 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 2 = 0.438 +- 0.176 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all KL = 0.258 +- 0.176 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all L1 = 0.402 +- 0.123 (in-sample avg dev_std = 0.393)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.863
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.840145
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.568
NEC for r=1.0 class 0 = 0.384 +- 0.172 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 1 = 0.388 +- 0.172 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 2 = 0.439 +- 0.172 (in-sample avg dev_std = 0.396)
NEC for r=1.0 all KL = 0.26 +- 0.172 (in-sample avg dev_std = 0.396)
NEC for r=1.0 all L1 = 0.404 +- 0.118 (in-sample avg dev_std = 0.396)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  0.73378625
Model XAI WIoU of binarized graphs for r=0.3 =  0.76169125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.551 +- 0.268 (in-sample avg dev_std = 0.518)
NEC for r=0.3 class 1 = 0.526 +- 0.268 (in-sample avg dev_std = 0.518)
NEC for r=0.3 class 2 = 0.58 +- 0.268 (in-sample avg dev_std = 0.518)
NEC for r=0.3 all KL = 0.592 +- 0.268 (in-sample avg dev_std = 0.518)
NEC for r=0.3 all L1 = 0.552 +- 0.143 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.84
Model XAI F1 of binarized graphs for r=0.6 =  0.5364249999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.8232725000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.52
NEC for r=0.6 class 0 = 0.489 +- 0.338 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 1 = 0.384 +- 0.338 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 2 = 0.555 +- 0.338 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all KL = 0.452 +- 0.338 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all L1 = 0.475 +- 0.199 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  0.40617625
Model XAI WIoU of binarized graphs for r=0.9 =  0.8232725000000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.411 +- 0.298 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 1 = 0.351 +- 0.298 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 2 = 0.467 +- 0.298 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all KL = 0.384 +- 0.298 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all L1 = 0.409 +- 0.167 (in-sample avg dev_std = 0.523)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.84
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.8232725000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.613
NEC for r=1.0 class 0 = 0.399 +- 0.288 (in-sample avg dev_std = 0.520)
NEC for r=1.0 class 1 = 0.346 +- 0.288 (in-sample avg dev_std = 0.520)
NEC for r=1.0 class 2 = 0.456 +- 0.288 (in-sample avg dev_std = 0.520)
NEC for r=1.0 all KL = 0.372 +- 0.288 (in-sample avg dev_std = 0.520)
NEC for r=1.0 all L1 = 0.4 +- 0.157 (in-sample avg dev_std = 0.520)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.647, 0.705, 0.884, 1.0], 'all_L1': [0.598, 0.646, 0.815, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.659, 0.613, 0.883, 1.0], 'all_L1': [0.552, 0.608, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.657, 0.906, 1.0], 'all_L1': [0.576, 0.632, 0.84, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.64, 0.648, 0.905, 1.0], 'all_L1': [0.557, 0.591, 0.826, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.731, 0.932, 1.0], 'all_L1': [0.583, 0.683, 0.864, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.422, 0.389, 0.419, 0.434], 'all_L1': [0.475, 0.441, 0.458, 0.456]}), defaultdict(<class 'list'>, {'all_KL': [0.385, 0.558, 0.567, 0.553], 'all_L1': [0.483, 0.542, 0.524, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.501, 0.547, 0.512, 0.497], 'all_L1': [0.547, 0.556, 0.523, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.46, 0.447, 0.47], 'all_L1': [0.499, 0.512, 0.492, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.493, 0.449, 0.438], 'all_L1': [0.518, 0.52, 0.473, 0.465]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.638, 0.701, 0.891, 1.0], 'all_L1': [0.598, 0.649, 0.823, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.617, 0.895, 1.0], 'all_L1': [0.561, 0.618, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.641, 0.661, 0.913, 1.0], 'all_L1': [0.569, 0.641, 0.844, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.632, 0.649, 0.908, 1.0], 'all_L1': [0.551, 0.598, 0.835, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.741, 0.934, 1.0], 'all_L1': [0.582, 0.698, 0.865, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.435, 0.396, 0.432, 0.425], 'all_L1': [0.485, 0.439, 0.465, 0.447]}), defaultdict(<class 'list'>, {'all_KL': [0.369, 0.583, 0.567, 0.547], 'all_L1': [0.481, 0.557, 0.521, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.5, 0.54, 0.489, 0.487], 'all_L1': [0.554, 0.547, 0.505, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.484, 0.454, 0.472], 'all_L1': [0.506, 0.523, 0.488, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.504, 0.446, 0.434], 'all_L1': [0.533, 0.522, 0.471, 0.462]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.521, 0.76, 0.942, 1.0], 'all_L1': [0.519, 0.653, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.423, 0.665, 0.923, 1.0], 'all_L1': [0.489, 0.596, 0.836, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.717, 0.937, 1.0], 'all_L1': [0.537, 0.621, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.785, 0.946, 1.0], 'all_L1': [0.538, 0.655, 0.84, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.828, 0.956, 1.0], 'all_L1': [0.529, 0.708, 0.872, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.384, 0.328, 0.316], 'all_L1': [0.606, 0.493, 0.438, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.715, 0.477, 0.421, 0.415], 'all_L1': [0.66, 0.537, 0.487, 0.483]}), defaultdict(<class 'list'>, {'all_KL': [0.606, 0.433, 0.398, 0.389], 'all_L1': [0.617, 0.523, 0.486, 0.478]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.333, 0.285, 0.279], 'all_L1': [0.598, 0.467, 0.422, 0.416]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.316, 0.258, 0.26], 'all_L1': [0.607, 0.451, 0.402, 0.404]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.673, 0.56, 0.826, 1.0], 'all_L1': [0.592, 0.607, 0.775, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.577, 0.89, 1.0], 'all_L1': [0.585, 0.645, 0.883, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.634, 0.758, 0.953, 1.0], 'all_L1': [0.647, 0.71, 0.889, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.654, 0.833, 1.0], 'all_L1': [0.598, 0.667, 0.804, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.874, 0.951, 1.0], 'all_L1': [0.639, 0.805, 0.89, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.412, 0.569, 0.528, 0.516], 'all_L1': [0.493, 0.533, 0.476, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.515, 0.486, 0.455], 'all_L1': [0.555, 0.484, 0.433, 0.408]}), defaultdict(<class 'list'>, {'all_KL': [0.54, 0.42, 0.426, 0.419], 'all_L1': [0.516, 0.456, 0.423, 0.419]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.434, 0.412, 0.407], 'all_L1': [0.553, 0.44, 0.411, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.592, 0.452, 0.384, 0.372], 'all_L1': [0.552, 0.475, 0.409, 0.4]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.573 +- 0.017, 0.632 +- 0.032, 0.835 +- 0.017, 1.000 +- 0.000
suff++ class all_KL  =  0.639 +- 0.018, 0.671 +- 0.042, 0.902 +- 0.018, 1.000 +- 0.000
suff++_acc_int  =  0.405 +- 0.025, 0.638 +- 0.054, 0.831 +- 0.017
nec class all_L1  =  0.504 +- 0.026, 0.514 +- 0.040, 0.494 +- 0.026, 0.485 +- 0.022
nec class all_KL  =  0.445 +- 0.049, 0.489 +- 0.062, 0.479 +- 0.054, 0.478 +- 0.044
nec_acc_int  =  0.357 +- 0.019, 0.475 +- 0.024, 0.548 +- 0.033, 0.571 +- 0.035

Eval split id_val
suff++ class all_L1  =  0.572 +- 0.016, 0.641 +- 0.034, 0.842 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.635 +- 0.028, 0.674 +- 0.043, 0.908 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.415 +- 0.031, 0.643 +- 0.061, 0.841 +- 0.011
nec class all_L1  =  0.512 +- 0.028, 0.518 +- 0.042, 0.490 +- 0.021, 0.479 +- 0.022
nec class all_KL  =  0.452 +- 0.060, 0.501 +- 0.063, 0.478 +- 0.048, 0.473 +- 0.044
nec_acc_int  =  0.354 +- 0.015, 0.472 +- 0.028, 0.554 +- 0.022, 0.578 +- 0.033

Eval split val
suff++ class all_L1  =  0.522 +- 0.018, 0.647 +- 0.038, 0.844 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.510 +- 0.045, 0.751 +- 0.056, 0.941 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.570 +- 0.022, 0.685 +- 0.015, 0.833 +- 0.024
nec class all_L1  =  0.618 +- 0.022, 0.494 +- 0.032, 0.447 +- 0.034, 0.442 +- 0.032
nec class all_KL  =  0.612 +- 0.052, 0.389 +- 0.060, 0.338 +- 0.063, 0.332 +- 0.061
nec_acc_int  =  0.350 +- 0.007, 0.487 +- 0.018, 0.550 +- 0.015, 0.557 +- 0.019

Eval split test
suff++ class all_L1  =  0.612 +- 0.026, 0.687 +- 0.068, 0.848 +- 0.049, 1.000 +- 0.000
suff++ class all_KL  =  0.611 +- 0.043, 0.685 +- 0.118, 0.891 +- 0.055, 1.000 +- 0.000
suff++_acc_int  =  0.542 +- 0.039, 0.733 +- 0.039, 0.836 +- 0.036
nec class all_L1  =  0.534 +- 0.025, 0.478 +- 0.032, 0.430 +- 0.024, 0.419 +- 0.024
nec class all_KL  =  0.546 +- 0.070, 0.478 +- 0.056, 0.447 +- 0.052, 0.434 +- 0.049
nec_acc_int  =  0.417 +- 0.035, 0.533 +- 0.022, 0.601 +- 0.003, 0.618 +- 0.015


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.539 +- 0.016, 0.573 +- 0.023, 0.664 +- 0.016, 0.742 +- 0.011
Faith. Armon (L1)= 		  =  0.536 +- 0.016, 0.566 +- 0.026, 0.620 +- 0.022, 0.653 +- 0.020
Faith. GMean (L1)= 	  =  0.537 +- 0.016, 0.569 +- 0.024, 0.642 +- 0.019, 0.696 +- 0.016
Faith. Aritm (KL)= 		  =  0.542 +- 0.019, 0.580 +- 0.026, 0.690 +- 0.026, 0.739 +- 0.022
Faith. Armon (KL)= 		  =  0.522 +- 0.030, 0.562 +- 0.037, 0.624 +- 0.043, 0.646 +- 0.039
Faith. GMean (KL)= 	  =  0.532 +- 0.024, 0.571 +- 0.031, 0.656 +- 0.035, 0.691 +- 0.031

Eval split id_val
Faith. Aritm (L1)= 		  =  0.542 +- 0.016, 0.579 +- 0.024, 0.666 +- 0.013, 0.740 +- 0.011
Faith. Armon (L1)= 		  =  0.540 +- 0.017, 0.571 +- 0.027, 0.619 +- 0.017, 0.648 +- 0.020
Faith. GMean (L1)= 	  =  0.541 +- 0.016, 0.575 +- 0.025, 0.642 +- 0.015, 0.692 +- 0.016
Faith. Aritm (KL)= 		  =  0.544 +- 0.020, 0.588 +- 0.027, 0.693 +- 0.023, 0.736 +- 0.022
Faith. Armon (KL)= 		  =  0.524 +- 0.033, 0.571 +- 0.037, 0.624 +- 0.039, 0.641 +- 0.040
Faith. GMean (KL)= 	  =  0.534 +- 0.026, 0.579 +- 0.031, 0.658 +- 0.031, 0.687 +- 0.031

Eval split val
Faith. Aritm (L1)= 		  =  0.570 +- 0.005, 0.570 +- 0.006, 0.646 +- 0.012, 0.721 +- 0.016
Faith. Armon (L1)= 		  =  0.565 +- 0.005, 0.558 +- 0.009, 0.583 +- 0.027, 0.612 +- 0.031
Faith. GMean (L1)= 	  =  0.568 +- 0.005, 0.564 +- 0.006, 0.614 +- 0.019, 0.664 +- 0.024
Faith. Aritm (KL)= 		  =  0.561 +- 0.006, 0.570 +- 0.006, 0.639 +- 0.026, 0.666 +- 0.030
Faith. Armon (KL)= 		  =  0.553 +- 0.011, 0.506 +- 0.039, 0.494 +- 0.067, 0.495 +- 0.068
Faith. GMean (KL)= 	  =  0.557 +- 0.006, 0.537 +- 0.022, 0.561 +- 0.050, 0.574 +- 0.052

Eval split test
Faith. Aritm (L1)= 		  =  0.573 +- 0.017, 0.582 +- 0.030, 0.639 +- 0.020, 0.710 +- 0.012
Faith. Armon (L1)= 		  =  0.570 +- 0.018, 0.561 +- 0.022, 0.570 +- 0.016, 0.590 +- 0.023
Faith. GMean (L1)= 	  =  0.571 +- 0.018, 0.571 +- 0.026, 0.603 +- 0.015, 0.647 +- 0.018
Faith. Aritm (KL)= 		  =  0.578 +- 0.021, 0.581 +- 0.044, 0.669 +- 0.025, 0.717 +- 0.024
Faith. Armon (KL)= 		  =  0.571 +- 0.032, 0.553 +- 0.025, 0.592 +- 0.039, 0.604 +- 0.047
Faith. GMean (KL)= 	  =  0.575 +- 0.026, 0.567 +- 0.033, 0.629 +- 0.029, 0.658 +- 0.037
Computed for split load_split = id



Completed in  0:27:53.370856  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:09:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:09:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9133
Train Loss: 0.4290
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.4031
ID Test ACCURACY: 0.9080
ID Test Loss: 0.4515
OOD Validation ACCURACY: 0.9227
OOD Validation Loss: 0.3936
OOD Test ACCURACY: 0.8737
OOD Test Loss: 0.4903

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.4715
ID Validation ACCURACY: 0.8663
ID Validation Loss: 0.4430
ID Test ACCURACY: 0.8633
ID Test Loss: 0.4820
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3746
OOD Test ACCURACY: 0.7837
OOD Test Loss: 0.6415

[0m[1;37mINFO[0m: [1mChartInfo 0.9080 0.8737 0.8633 0.7837 0.8663 0.9313[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.674
WIoU for r=0.3 = 0.612
F1 for r=0.6 = 0.612
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.703
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.703
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.677
WIoU for r=0.3 = 0.613
F1 for r=0.6 = 0.615
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.699
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.699
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.668
WIoU for r=0.3 = 0.887
F1 for r=0.6 = 0.409
WIoU for r=0.6 = 0.881
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.881
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.881
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.634
WIoU for r=0.3 = 0.628
F1 for r=0.6 = 0.503
WIoU for r=0.6 = 0.625
F1 for r=0.9 = 0.421
WIoU for r=0.9 = 0.629
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.629


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.676
Model XAI F1 of binarized graphs for r=0.3 =  0.6741825
Model XAI WIoU of binarized graphs for r=0.3 =  0.61211625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.473
SUFF++ for r=0.3 class 0 = 0.503 +- 0.291 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 class 1 = 0.573 +- 0.291 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 class 2 = 0.449 +- 0.291 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 all KL = 0.459 +- 0.291 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 all L1 = 0.508 +- 0.160 (in-sample avg dev_std = 0.550)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.61235375
Model XAI WIoU of binarized graphs for r=0.6 =  0.6991675
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.703
SUFF++ for r=0.6 class 0 = 0.598 +- 0.283 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 class 1 = 0.645 +- 0.283 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 class 2 = 0.577 +- 0.283 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 all KL = 0.535 +- 0.283 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 all L1 = 0.607 +- 0.174 (in-sample avg dev_std = 0.550)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.48164625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7034050000000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.857
SUFF++ for r=0.9 class 0 = 0.793 +- 0.200 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 1 = 0.816 +- 0.200 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 2 = 0.816 +- 0.200 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all KL = 0.826 +- 0.200 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all L1 = 0.808 +- 0.151 (in-sample avg dev_std = 0.329)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  0.6773650000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61260875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.489
SUFF++ for r=0.3 class 0 = 0.491 +- 0.275 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 class 1 = 0.57 +- 0.275 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 class 2 = 0.445 +- 0.275 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 all KL = 0.445 +- 0.275 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 all L1 = 0.502 +- 0.152 (in-sample avg dev_std = 0.562)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  0.61451625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989574999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.726
SUFF++ for r=0.6 class 0 = 0.609 +- 0.286 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 1 = 0.651 +- 0.286 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 2 = 0.595 +- 0.286 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 all KL = 0.542 +- 0.286 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 all L1 = 0.618 +- 0.179 (in-sample avg dev_std = 0.533)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.935
Model XAI F1 of binarized graphs for r=0.9 =  0.48001374999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.6990912499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.877
SUFF++ for r=0.9 class 0 = 0.791 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 1 = 0.832 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 2 = 0.817 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all KL = 0.827 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all L1 = 0.813 +- 0.151 (in-sample avg dev_std = 0.320)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.921
Model XAI F1 of binarized graphs for r=0.3 =  0.66766875
Model XAI WIoU of binarized graphs for r=0.3 =  0.8870675000000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.631
SUFF++ for r=0.3 class 0 = 0.477 +- 0.274 (in-sample avg dev_std = 0.672)
SUFF++ for r=0.3 class 1 = 0.564 +- 0.274 (in-sample avg dev_std = 0.672)
SUFF++ for r=0.3 class 2 = 0.497 +- 0.274 (in-sample avg dev_std = 0.672)
SUFF++ for r=0.3 all KL = 0.36 +- 0.274 (in-sample avg dev_std = 0.672)
SUFF++ for r=0.3 all L1 = 0.512 +- 0.143 (in-sample avg dev_std = 0.672)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.921
Model XAI F1 of binarized graphs for r=0.6 =  0.40856125000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.8811100000000001
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF++ for r=0.6 class 0 = 0.638 +- 0.205 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 1 = 0.656 +- 0.205 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 2 = 0.67 +- 0.205 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all KL = 0.709 +- 0.205 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all L1 = 0.655 +- 0.121 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.29483375
Model XAI WIoU of binarized graphs for r=0.9 =  0.881055
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.802 +- 0.124 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 1 = 0.829 +- 0.124 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.124 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all KL = 0.899 +- 0.124 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.112 (in-sample avg dev_std = 0.280)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.524
Model XAI F1 of binarized graphs for r=0.3 =  0.6342637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.62753625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.523
SUFF++ for r=0.3 class 0 = 0.512 +- 0.293 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 class 1 = 0.552 +- 0.293 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 class 2 = 0.534 +- 0.293 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 all KL = 0.464 +- 0.293 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 all L1 = 0.533 +- 0.175 (in-sample avg dev_std = 0.574)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  0.50262625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6251525
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.663
SUFF++ for r=0.6 class 0 = 0.638 +- 0.304 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 1 = 0.584 +- 0.304 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 2 = 0.535 +- 0.304 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all KL = 0.57 +- 0.304 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all L1 = 0.585 +- 0.197 (in-sample avg dev_std = 0.534)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.42123999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.629245
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0 = 0.907 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 1 = 0.757 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all KL = 0.837 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all L1 = 0.823 +- 0.192 (in-sample avg dev_std = 0.282)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.676
Model XAI F1 of binarized graphs for r=0.3 =  0.6741825
Model XAI WIoU of binarized graphs for r=0.3 =  0.61211625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.41
NEC for r=0.3 class 0 = 0.586 +- 0.320 (in-sample avg dev_std = 0.441)
NEC for r=0.3 class 1 = 0.49 +- 0.320 (in-sample avg dev_std = 0.441)
NEC for r=0.3 class 2 = 0.558 +- 0.320 (in-sample avg dev_std = 0.441)
NEC for r=0.3 all KL = 0.572 +- 0.320 (in-sample avg dev_std = 0.441)
NEC for r=0.3 all L1 = 0.545 +- 0.180 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.61235375
Model XAI WIoU of binarized graphs for r=0.6 =  0.6991675
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.497
NEC for r=0.6 class 0 = 0.603 +- 0.305 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 1 = 0.519 +- 0.305 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 2 = 0.55 +- 0.305 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all KL = 0.614 +- 0.305 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all L1 = 0.557 +- 0.157 (in-sample avg dev_std = 0.497)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.48164625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7034050000000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.567 +- 0.294 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 1 = 0.476 +- 0.294 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 2 = 0.522 +- 0.294 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all KL = 0.552 +- 0.294 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all L1 = 0.522 +- 0.157 (in-sample avg dev_std = 0.531)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.914
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.703125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.547
NEC for r=1.0 class 0 = 0.555 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=1.0 class 1 = 0.476 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=1.0 class 2 = 0.516 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=1.0 all KL = 0.548 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=1.0 all L1 = 0.515 +- 0.159 (in-sample avg dev_std = 0.531)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.692
Model XAI F1 of binarized graphs for r=0.3 =  0.6773650000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61260875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.415
NEC for r=0.3 class 0 = 0.572 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.494 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.581 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.577 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.549 +- 0.173 (in-sample avg dev_std = 0.452)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  0.61451625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989574999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.6 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 1 = 0.541 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 2 = 0.561 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all KL = 0.637 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all L1 = 0.567 +- 0.152 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.935
Model XAI F1 of binarized graphs for r=0.9 =  0.48001374999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.6990912499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.551
NEC for r=0.9 class 0 = 0.555 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 1 = 0.485 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 2 = 0.521 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all KL = 0.563 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all L1 = 0.52 +- 0.158 (in-sample avg dev_std = 0.538)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.6988987499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.55 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 1 = 0.487 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 2 = 0.519 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all KL = 0.562 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all L1 = 0.519 +- 0.151 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.921
Model XAI F1 of binarized graphs for r=0.3 =  0.66766875
Model XAI WIoU of binarized graphs for r=0.3 =  0.8870675000000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.39
NEC for r=0.3 class 0 = 0.729 +- 0.237 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 1 = 0.563 +- 0.237 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 2 = 0.699 +- 0.237 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all KL = 0.779 +- 0.237 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all L1 = 0.665 +- 0.119 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.921
Model XAI F1 of binarized graphs for r=0.6 =  0.40856125000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.8811100000000001
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.533
NEC for r=0.6 class 0 = 0.58 +- 0.242 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 1 = 0.464 +- 0.242 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 2 = 0.536 +- 0.242 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all KL = 0.498 +- 0.242 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all L1 = 0.527 +- 0.126 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.29483375
Model XAI WIoU of binarized graphs for r=0.9 =  0.881055
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.526 +- 0.227 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 1 = 0.439 +- 0.227 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 2 = 0.484 +- 0.227 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all KL = 0.43 +- 0.227 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all L1 = 0.483 +- 0.128 (in-sample avg dev_std = 0.520)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.921
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.881055
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.587
NEC for r=1.0 class 0 = 0.522 +- 0.227 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 1 = 0.426 +- 0.227 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 2 = 0.482 +- 0.227 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all KL = 0.422 +- 0.227 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all L1 = 0.477 +- 0.125 (in-sample avg dev_std = 0.515)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.524
Model XAI F1 of binarized graphs for r=0.3 =  0.6342637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.62753625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.439
NEC for r=0.3 class 0 = 0.634 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 1 = 0.603 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 2 = 0.562 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all KL = 0.668 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all L1 = 0.599 +- 0.136 (in-sample avg dev_std = 0.474)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  0.50262625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6251525
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.578
NEC for r=0.6 class 0 = 0.5 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 1 = 0.397 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 2 = 0.517 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all KL = 0.482 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all L1 = 0.47 +- 0.197 (in-sample avg dev_std = 0.558)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.42123999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.629245
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.611
NEC for r=0.9 class 0 = 0.444 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 1 = 0.432 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 2 = 0.448 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all KL = 0.475 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all L1 = 0.441 +- 0.191 (in-sample avg dev_std = 0.598)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.886
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.6285324999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.627
NEC for r=1.0 class 0 = 0.422 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 class 1 = 0.418 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 class 2 = 0.443 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 all KL = 0.452 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 all L1 = 0.428 +- 0.179 (in-sample avg dev_std = 0.571)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:15:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:15:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9118
Train Loss: 0.4030
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3794
ID Test ACCURACY: 0.9047
ID Test Loss: 0.4384
OOD Validation ACCURACY: 0.9233
OOD Validation Loss: 0.3768
OOD Test ACCURACY: 0.8853
OOD Test Loss: 0.4748

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.8885
Train Loss: 0.4487
ID Validation ACCURACY: 0.8923
ID Validation Loss: 0.4387
ID Test ACCURACY: 0.8827
ID Test Loss: 0.4705
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.4388
OOD Test ACCURACY: 0.7740
OOD Test Loss: 0.7590

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8853 0.8827 0.7740 0.8923 0.9290[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.666
WIoU for r=0.3 = 0.613
F1 for r=0.6 = 0.599
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.730
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.730
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.677
WIoU for r=0.3 = 0.618
F1 for r=0.6 = 0.601
WIoU for r=0.6 = 0.724
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.732
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.732
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.665
WIoU for r=0.3 = 0.912
F1 for r=0.6 = 0.408
WIoU for r=0.6 = 0.911
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.911
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.911
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.640
WIoU for r=0.3 = 0.727
F1 for r=0.6 = 0.542
WIoU for r=0.6 = 0.772
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.770
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.770


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.655
Model XAI F1 of binarized graphs for r=0.3 =  0.6661750000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6128637499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.454
SUFF++ for r=0.3 class 0 = 0.475 +- 0.256 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 class 1 = 0.564 +- 0.256 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 class 2 = 0.434 +- 0.256 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 all KL = 0.405 +- 0.256 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 all L1 = 0.491 +- 0.146 (in-sample avg dev_std = 0.548)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.5992462500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7207399999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.745
SUFF++ for r=0.6 class 0 = 0.645 +- 0.289 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 1 = 0.671 +- 0.289 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 2 = 0.686 +- 0.289 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all KL = 0.636 +- 0.289 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all L1 = 0.667 +- 0.202 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.48078625
Model XAI WIoU of binarized graphs for r=0.9 =  0.73
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.875
SUFF++ for r=0.9 class 0 = 0.82 +- 0.165 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 class 1 = 0.834 +- 0.165 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 class 2 = 0.886 +- 0.165 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all KL = 0.896 +- 0.165 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all L1 = 0.846 +- 0.166 (in-sample avg dev_std = 0.218)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  0.6771187499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.61805625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.467
SUFF++ for r=0.3 class 0 = 0.487 +- 0.251 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 class 1 = 0.559 +- 0.251 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 class 2 = 0.438 +- 0.251 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 all KL = 0.4 +- 0.251 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 all L1 = 0.495 +- 0.137 (in-sample avg dev_std = 0.550)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.906
Model XAI F1 of binarized graphs for r=0.6 =  0.60146
Model XAI WIoU of binarized graphs for r=0.6 =  0.724375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.754
SUFF++ for r=0.6 class 0 = 0.649 +- 0.291 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 class 1 = 0.694 +- 0.291 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 class 2 = 0.686 +- 0.291 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 all KL = 0.636 +- 0.291 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 all L1 = 0.676 +- 0.200 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.47954125
Model XAI WIoU of binarized graphs for r=0.9 =  0.7315299999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.889
SUFF++ for r=0.9 class 0 = 0.814 +- 0.160 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 class 1 = 0.84 +- 0.160 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.160 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 all KL = 0.898 +- 0.160 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.161 (in-sample avg dev_std = 0.212)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.914
Model XAI F1 of binarized graphs for r=0.3 =  0.6646387500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.91249875
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.642
SUFF++ for r=0.3 class 0 = 0.482 +- 0.255 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 class 1 = 0.587 +- 0.255 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 class 2 = 0.48 +- 0.255 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 all KL = 0.362 +- 0.255 (in-sample avg dev_std = 0.669)
SUFF++ for r=0.3 all L1 = 0.516 +- 0.132 (in-sample avg dev_std = 0.669)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.40831999999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.9109262499999999
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.74
SUFF++ for r=0.6 class 0 = 0.614 +- 0.219 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 1 = 0.621 +- 0.219 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 2 = 0.677 +- 0.219 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all KL = 0.695 +- 0.219 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all L1 = 0.638 +- 0.140 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.29473999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.91087875
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.808 +- 0.154 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 1 = 0.811 +- 0.154 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 2 = 0.867 +- 0.154 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all KL = 0.904 +- 0.154 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.146 (in-sample avg dev_std = 0.240)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.696
Model XAI F1 of binarized graphs for r=0.3 =  0.6404124999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.72653
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.541 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all KL = 0.558 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all L1 = 0.589 +- 0.210 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5424575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7723887500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF++ for r=0.6 class 0 = 0.654 +- 0.323 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 class 1 = 0.64 +- 0.323 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 class 2 = 0.653 +- 0.323 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 all KL = 0.615 +- 0.323 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 all L1 = 0.649 +- 0.188 (in-sample avg dev_std = 0.572)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.422365
Model XAI WIoU of binarized graphs for r=0.9 =  0.76983375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.848
SUFF++ for r=0.9 class 0 = 0.809 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 2 = 0.957 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all KL = 0.838 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.170 (in-sample avg dev_std = 0.287)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.655
Model XAI F1 of binarized graphs for r=0.3 =  0.6661750000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6128637499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.358
NEC for r=0.3 class 0 = 0.579 +- 0.266 (in-sample avg dev_std = 0.509)
NEC for r=0.3 class 1 = 0.529 +- 0.266 (in-sample avg dev_std = 0.509)
NEC for r=0.3 class 2 = 0.626 +- 0.266 (in-sample avg dev_std = 0.509)
NEC for r=0.3 all KL = 0.653 +- 0.266 (in-sample avg dev_std = 0.509)
NEC for r=0.3 all L1 = 0.578 +- 0.142 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.5992462500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7207399999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.484
NEC for r=0.6 class 0 = 0.56 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.487 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.621 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.622 +- 0.289 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.556 +- 0.168 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.48078625
Model XAI WIoU of binarized graphs for r=0.9 =  0.73
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.593
NEC for r=0.9 class 0 = 0.476 +- 0.292 (in-sample avg dev_std = 0.578)
NEC for r=0.9 class 1 = 0.468 +- 0.292 (in-sample avg dev_std = 0.578)
NEC for r=0.9 class 2 = 0.541 +- 0.292 (in-sample avg dev_std = 0.578)
NEC for r=0.9 all KL = 0.546 +- 0.292 (in-sample avg dev_std = 0.578)
NEC for r=0.9 all L1 = 0.495 +- 0.162 (in-sample avg dev_std = 0.578)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.73
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.596
NEC for r=1.0 class 0 = 0.491 +- 0.290 (in-sample avg dev_std = 0.580)
NEC for r=1.0 class 1 = 0.468 +- 0.290 (in-sample avg dev_std = 0.580)
NEC for r=1.0 class 2 = 0.518 +- 0.290 (in-sample avg dev_std = 0.580)
NEC for r=1.0 all KL = 0.546 +- 0.290 (in-sample avg dev_std = 0.580)
NEC for r=1.0 all L1 = 0.492 +- 0.158 (in-sample avg dev_std = 0.580)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  0.6771187499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.61805625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.36
NEC for r=0.3 class 0 = 0.578 +- 0.263 (in-sample avg dev_std = 0.509)
NEC for r=0.3 class 1 = 0.542 +- 0.263 (in-sample avg dev_std = 0.509)
NEC for r=0.3 class 2 = 0.642 +- 0.263 (in-sample avg dev_std = 0.509)
NEC for r=0.3 all KL = 0.664 +- 0.263 (in-sample avg dev_std = 0.509)
NEC for r=0.3 all L1 = 0.587 +- 0.140 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.906
Model XAI F1 of binarized graphs for r=0.6 =  0.60146
Model XAI WIoU of binarized graphs for r=0.6 =  0.724375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.494
NEC for r=0.6 class 0 = 0.549 +- 0.290 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.52 +- 0.290 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.613 +- 0.290 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.633 +- 0.290 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.56 +- 0.163 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.47954125
Model XAI WIoU of binarized graphs for r=0.9 =  0.7315299999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.586
NEC for r=0.9 class 0 = 0.498 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 1 = 0.469 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 2 = 0.532 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all KL = 0.554 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all L1 = 0.499 +- 0.151 (in-sample avg dev_std = 0.585)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7315112500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.603
NEC for r=1.0 class 0 = 0.492 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 1 = 0.481 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 2 = 0.52 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all KL = 0.554 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all L1 = 0.497 +- 0.154 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.915
Model XAI F1 of binarized graphs for r=0.3 =  0.6646387500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.91249875
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.399
NEC for r=0.3 class 0 = 0.667 +- 0.210 (in-sample avg dev_std = 0.524)
NEC for r=0.3 class 1 = 0.604 +- 0.210 (in-sample avg dev_std = 0.524)
NEC for r=0.3 class 2 = 0.714 +- 0.210 (in-sample avg dev_std = 0.524)
NEC for r=0.3 all KL = 0.787 +- 0.210 (in-sample avg dev_std = 0.524)
NEC for r=0.3 all L1 = 0.662 +- 0.111 (in-sample avg dev_std = 0.524)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.40831999999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.9109262499999999
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.529
NEC for r=0.6 class 0 = 0.515 +- 0.232 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 1 = 0.516 +- 0.232 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 2 = 0.547 +- 0.232 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.493 +- 0.232 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.526 +- 0.124 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.29473999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.91087875
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.465 +- 0.212 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 1 = 0.501 +- 0.212 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 2 = 0.486 +- 0.212 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all KL = 0.429 +- 0.212 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all L1 = 0.484 +- 0.121 (in-sample avg dev_std = 0.520)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.91087875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0 = 0.454 +- 0.209 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 1 = 0.502 +- 0.209 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 2 = 0.479 +- 0.209 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all KL = 0.422 +- 0.209 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all L1 = 0.478 +- 0.121 (in-sample avg dev_std = 0.516)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.696
Model XAI F1 of binarized graphs for r=0.3 =  0.6404124999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.72653
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.472
NEC for r=0.3 class 0 = 0.541 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 class 1 = 0.469 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 class 2 = 0.56 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 all KL = 0.567 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 all L1 = 0.523 +- 0.127 (in-sample avg dev_std = 0.527)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5424575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7723887500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.595
NEC for r=0.6 class 0 = 0.462 +- 0.329 (in-sample avg dev_std = 0.526)
NEC for r=0.6 class 1 = 0.375 +- 0.329 (in-sample avg dev_std = 0.526)
NEC for r=0.6 class 2 = 0.527 +- 0.329 (in-sample avg dev_std = 0.526)
NEC for r=0.6 all KL = 0.471 +- 0.329 (in-sample avg dev_std = 0.526)
NEC for r=0.6 all L1 = 0.454 +- 0.216 (in-sample avg dev_std = 0.526)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.422365
Model XAI WIoU of binarized graphs for r=0.9 =  0.76983375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.648
NEC for r=0.9 class 0 = 0.393 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 1 = 0.381 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 2 = 0.476 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all KL = 0.481 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all L1 = 0.416 +- 0.200 (in-sample avg dev_std = 0.601)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.76983375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.652
NEC for r=1.0 class 0 = 0.41 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 class 1 = 0.383 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 class 2 = 0.457 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 all KL = 0.485 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 all L1 = 0.417 +- 0.198 (in-sample avg dev_std = 0.599)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:21:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:21:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.8932
Train Loss: 0.4562
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.4325
ID Test ACCURACY: 0.8937
ID Test Loss: 0.4701
OOD Validation ACCURACY: 0.9143
OOD Validation Loss: 0.4605
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.5237

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.8433
Train Loss: 0.5132
ID Validation ACCURACY: 0.8480
ID Validation Loss: 0.5068
ID Test ACCURACY: 0.8413
ID Test Loss: 0.5417
OOD Validation ACCURACY: 0.9147
OOD Validation Loss: 0.5475
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.5372

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.8143 0.8413 0.8277 0.8480 0.9147[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.631
WIoU for r=0.3 = 0.604
F1 for r=0.6 = 0.604
WIoU for r=0.6 = 0.753
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.769
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.769
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.637
WIoU for r=0.3 = 0.612
F1 for r=0.6 = 0.600
WIoU for r=0.6 = 0.756
F1 for r=0.9 = 0.477
WIoU for r=0.9 = 0.771
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.771
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.660
WIoU for r=0.3 = 0.907
F1 for r=0.6 = 0.405
WIoU for r=0.6 = 0.906
F1 for r=0.9 = 0.292
WIoU for r=0.9 = 0.906
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.906
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.446
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.503
WIoU for r=0.6 = 0.525
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.514
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.510


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.6312662499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.60375625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.426
SUFF++ for r=0.3 class 0 = 0.489 +- 0.266 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 1 = 0.578 +- 0.266 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 2 = 0.465 +- 0.266 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all KL = 0.546 +- 0.266 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all L1 = 0.511 +- 0.145 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  0.6044725
Model XAI WIoU of binarized graphs for r=0.6 =  0.7525562499999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.733
SUFF++ for r=0.6 class 0 = 0.649 +- 0.260 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 class 1 = 0.654 +- 0.260 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 class 2 = 0.711 +- 0.260 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 all KL = 0.695 +- 0.260 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 all L1 = 0.671 +- 0.212 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.47983625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7689050000000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.851
SUFF++ for r=0.9 class 0 = 0.814 +- 0.181 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 1 = 0.784 +- 0.181 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 2 = 0.874 +- 0.181 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all KL = 0.882 +- 0.181 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all L1 = 0.824 +- 0.185 (in-sample avg dev_std = 0.255)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.6372800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61194625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.44
SUFF++ for r=0.3 class 0 = 0.479 +- 0.268 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 class 1 = 0.584 +- 0.268 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 class 2 = 0.442 +- 0.268 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 all KL = 0.526 +- 0.268 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 all L1 = 0.502 +- 0.143 (in-sample avg dev_std = 0.514)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.6004400000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.755675
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.745
SUFF++ for r=0.6 class 0 = 0.675 +- 0.261 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 class 1 = 0.664 +- 0.261 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 class 2 = 0.711 +- 0.261 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all KL = 0.705 +- 0.261 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all L1 = 0.683 +- 0.212 (in-sample avg dev_std = 0.408)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.47724249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.7708825
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0 = 0.803 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1 = 0.802 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 2 = 0.874 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.881 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.826 +- 0.183 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.909
Model XAI F1 of binarized graphs for r=0.3 =  0.6599212499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.90729125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.561
SUFF++ for r=0.3 class 0 = 0.392 +- 0.279 (in-sample avg dev_std = 0.609)
SUFF++ for r=0.3 class 1 = 0.587 +- 0.279 (in-sample avg dev_std = 0.609)
SUFF++ for r=0.3 class 2 = 0.437 +- 0.279 (in-sample avg dev_std = 0.609)
SUFF++ for r=0.3 all KL = 0.402 +- 0.279 (in-sample avg dev_std = 0.609)
SUFF++ for r=0.3 all L1 = 0.471 +- 0.139 (in-sample avg dev_std = 0.609)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  0.40515999999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.90569875
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.684
SUFF++ for r=0.6 class 0 = 0.537 +- 0.191 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 1 = 0.575 +- 0.191 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 2 = 0.663 +- 0.191 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all KL = 0.696 +- 0.191 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all L1 = 0.592 +- 0.131 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.29247125
Model XAI WIoU of binarized graphs for r=0.9 =  0.90569875
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.819
SUFF++ for r=0.9 class 0 = 0.764 +- 0.139 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 1 = 0.726 +- 0.139 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 2 = 0.833 +- 0.139 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all KL = 0.89 +- 0.139 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all L1 = 0.775 +- 0.143 (in-sample avg dev_std = 0.248)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  0.4464175
Model XAI WIoU of binarized graphs for r=0.3 =  0.3652025
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.495
SUFF++ for r=0.3 class 0 = 0.49 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 class 1 = 0.559 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 class 2 = 0.471 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 all KL = 0.481 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 all L1 = 0.507 +- 0.144 (in-sample avg dev_std = 0.592)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.697
Model XAI F1 of binarized graphs for r=0.6 =  0.50256
Model XAI WIoU of binarized graphs for r=0.6 =  0.5247987500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.711
SUFF++ for r=0.6 class 0 = 0.677 +- 0.264 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 1 = 0.611 +- 0.264 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 2 = 0.674 +- 0.264 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all KL = 0.671 +- 0.264 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.187 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.804
Model XAI F1 of binarized graphs for r=0.9 =  0.42183624999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.5138825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.818
SUFF++ for r=0.9 class 0 = 0.767 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 1 = 0.787 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 2 = 0.921 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all KL = 0.866 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.172 (in-sample avg dev_std = 0.338)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.6312662499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.60375625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.54 +- 0.285 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 1 = 0.455 +- 0.285 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 2 = 0.54 +- 0.285 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all KL = 0.472 +- 0.285 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all L1 = 0.511 +- 0.169 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  0.6044725
Model XAI WIoU of binarized graphs for r=0.6 =  0.7525562499999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.532 +- 0.304 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 1 = 0.516 +- 0.304 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 2 = 0.569 +- 0.304 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all KL = 0.556 +- 0.304 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all L1 = 0.539 +- 0.162 (in-sample avg dev_std = 0.480)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.47983625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7689050000000001
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.581
NEC for r=0.9 class 0 = 0.494 +- 0.288 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.473 +- 0.288 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.483 +- 0.288 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.483 +- 0.288 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.483 +- 0.150 (in-sample avg dev_std = 0.510)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.906
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.7688812500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.601
NEC for r=1.0 class 0 = 0.482 +- 0.284 (in-sample avg dev_std = 0.506)
NEC for r=1.0 class 1 = 0.469 +- 0.284 (in-sample avg dev_std = 0.506)
NEC for r=1.0 class 2 = 0.465 +- 0.284 (in-sample avg dev_std = 0.506)
NEC for r=1.0 all KL = 0.47 +- 0.284 (in-sample avg dev_std = 0.506)
NEC for r=1.0 all L1 = 0.472 +- 0.153 (in-sample avg dev_std = 0.506)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.6372800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61194625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.543 +- 0.280 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 1 = 0.474 +- 0.280 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 2 = 0.563 +- 0.280 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all KL = 0.493 +- 0.280 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all L1 = 0.526 +- 0.160 (in-sample avg dev_std = 0.429)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.6004400000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.755675
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.49
NEC for r=0.6 class 0 = 0.536 +- 0.303 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 1 = 0.524 +- 0.303 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 2 = 0.573 +- 0.303 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all KL = 0.573 +- 0.303 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all L1 = 0.544 +- 0.156 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.47724249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.7708825
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.595
NEC for r=0.9 class 0 = 0.484 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 1 = 0.478 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 2 = 0.472 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all KL = 0.485 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all L1 = 0.478 +- 0.152 (in-sample avg dev_std = 0.512)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7709799999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.605
NEC for r=1.0 class 0 = 0.483 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 1 = 0.476 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 2 = 0.458 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all KL = 0.476 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all L1 = 0.472 +- 0.153 (in-sample avg dev_std = 0.501)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.909
Model XAI F1 of binarized graphs for r=0.3 =  0.6599212499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.90729125
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.4
NEC for r=0.3 class 0 = 0.681 +- 0.269 (in-sample avg dev_std = 0.457)
NEC for r=0.3 class 1 = 0.516 +- 0.269 (in-sample avg dev_std = 0.457)
NEC for r=0.3 class 2 = 0.705 +- 0.269 (in-sample avg dev_std = 0.457)
NEC for r=0.3 all KL = 0.684 +- 0.269 (in-sample avg dev_std = 0.457)
NEC for r=0.3 all L1 = 0.635 +- 0.137 (in-sample avg dev_std = 0.457)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  0.40515999999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.90569875
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.542
NEC for r=0.6 class 0 = 0.537 +- 0.221 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 1 = 0.435 +- 0.221 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 2 = 0.511 +- 0.221 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all KL = 0.399 +- 0.221 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all L1 = 0.495 +- 0.127 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.29247125
Model XAI WIoU of binarized graphs for r=0.9 =  0.90569875
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.597
NEC for r=0.9 class 0 = 0.504 +- 0.187 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 1 = 0.425 +- 0.187 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 2 = 0.442 +- 0.187 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all KL = 0.348 +- 0.187 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all L1 = 0.457 +- 0.112 (in-sample avg dev_std = 0.454)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.90569875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.606
NEC for r=1.0 class 0 = 0.502 +- 0.186 (in-sample avg dev_std = 0.448)
NEC for r=1.0 class 1 = 0.434 +- 0.186 (in-sample avg dev_std = 0.448)
NEC for r=1.0 class 2 = 0.415 +- 0.186 (in-sample avg dev_std = 0.448)
NEC for r=1.0 all KL = 0.341 +- 0.186 (in-sample avg dev_std = 0.448)
NEC for r=1.0 all L1 = 0.45 +- 0.114 (in-sample avg dev_std = 0.448)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  0.4464175
Model XAI WIoU of binarized graphs for r=0.3 =  0.3652025
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.495
NEC for r=0.3 class 0 = 0.541 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 1 = 0.528 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 2 = 0.532 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all KL = 0.543 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all L1 = 0.533 +- 0.125 (in-sample avg dev_std = 0.506)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.69
Model XAI F1 of binarized graphs for r=0.6 =  0.50256
Model XAI WIoU of binarized graphs for r=0.6 =  0.5247987500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.558
NEC for r=0.6 class 0 = 0.475 +- 0.330 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 1 = 0.455 +- 0.330 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 2 = 0.501 +- 0.330 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all KL = 0.464 +- 0.330 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all L1 = 0.477 +- 0.205 (in-sample avg dev_std = 0.521)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.804
Model XAI F1 of binarized graphs for r=0.9 =  0.42183624999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.5138825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0 = 0.428 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 1 = 0.425 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 2 = 0.352 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all KL = 0.417 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all L1 = 0.402 +- 0.191 (in-sample avg dev_std = 0.505)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.50977875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.675
NEC for r=1.0 class 0 = 0.419 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 class 1 = 0.419 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 class 2 = 0.357 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 all KL = 0.426 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 all L1 = 0.399 +- 0.182 (in-sample avg dev_std = 0.530)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:27:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:27:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9057
Train Loss: 0.4303
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4156
ID Test ACCURACY: 0.8993
ID Test Loss: 0.4653
OOD Validation ACCURACY: 0.9207
OOD Validation Loss: 0.4392
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.4806

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8659
Train Loss: 0.5021
ID Validation ACCURACY: 0.8630
ID Validation Loss: 0.5023
ID Test ACCURACY: 0.8600
ID Test Loss: 0.5351
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4432
OOD Test ACCURACY: 0.7227
OOD Test Loss: 0.7492

[0m[1;37mINFO[0m: [1mChartInfo 0.8993 0.8143 0.8600 0.7227 0.8630 0.9283[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.696
WIoU for r=0.3 = 0.695
F1 for r=0.6 = 0.605
WIoU for r=0.6 = 0.796
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.804
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.804
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.700
WIoU for r=0.3 = 0.695
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.796
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.796
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.652
WIoU for r=0.3 = 0.946
F1 for r=0.6 = 0.399
WIoU for r=0.6 = 0.946
F1 for r=0.9 = 0.288
WIoU for r=0.9 = 0.946
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.946
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.474
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.516
WIoU for r=0.6 = 0.756
F1 for r=0.9 = 0.399
WIoU for r=0.9 = 0.748
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.748


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  0.6964224999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6954025
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.471
SUFF++ for r=0.3 class 0 = 0.514 +- 0.267 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 1 = 0.632 +- 0.267 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 2 = 0.509 +- 0.267 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all KL = 0.474 +- 0.267 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all L1 = 0.552 +- 0.167 (in-sample avg dev_std = 0.547)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.909
Model XAI F1 of binarized graphs for r=0.6 =  0.6053262500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7957462500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.761
SUFF++ for r=0.6 class 0 = 0.614 +- 0.268 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1 = 0.73 +- 0.268 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 2 = 0.72 +- 0.268 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.683 +- 0.268 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.688 +- 0.208 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.47612625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.80386875
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.866
SUFF++ for r=0.9 class 0 = 0.808 +- 0.136 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 1 = 0.848 +- 0.136 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 2 = 0.896 +- 0.136 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all KL = 0.896 +- 0.136 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all L1 = 0.851 +- 0.141 (in-sample avg dev_std = 0.234)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.618
Model XAI F1 of binarized graphs for r=0.3 =  0.7002862499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6953324999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.485
SUFF++ for r=0.3 class 0 = 0.528 +- 0.261 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 1 = 0.619 +- 0.261 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 2 = 0.484 +- 0.261 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all KL = 0.466 +- 0.261 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all L1 = 0.544 +- 0.164 (in-sample avg dev_std = 0.554)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60346625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7893375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.771
SUFF++ for r=0.6 class 0 = 0.64 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.73 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.714 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.693 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.695 +- 0.208 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47362375
Model XAI WIoU of binarized graphs for r=0.9 =  0.7962062499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.885
SUFF++ for r=0.9 class 0 = 0.789 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.857 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.901 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.896 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.849 +- 0.146 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.915
Model XAI F1 of binarized graphs for r=0.3 =  0.651755
Model XAI WIoU of binarized graphs for r=0.3 =  0.9459825000000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.641
SUFF++ for r=0.3 class 0 = 0.46 +- 0.289 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.3 class 1 = 0.641 +- 0.289 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.3 class 2 = 0.498 +- 0.289 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.3 all KL = 0.442 +- 0.289 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.3 all L1 = 0.532 +- 0.146 (in-sample avg dev_std = 0.657)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.398635
Model XAI WIoU of binarized graphs for r=0.6 =  0.9463025
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.777
SUFF++ for r=0.6 class 0 = 0.619 +- 0.187 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1 = 0.674 +- 0.187 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.187 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.772 +- 0.187 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.677 +- 0.131 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.28804375
Model XAI WIoU of binarized graphs for r=0.9 =  0.9463025
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.886
SUFF++ for r=0.9 class 0 = 0.812 +- 0.088 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 1 = 0.863 +- 0.088 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 2 = 0.908 +- 0.088 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all KL = 0.941 +- 0.088 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.110 (in-sample avg dev_std = 0.207)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.683
Model XAI F1 of binarized graphs for r=0.3 =  0.47423250000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.58244125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0 = 0.552 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.718 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.636 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.681 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.637 +- 0.163 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  0.5155825
Model XAI WIoU of binarized graphs for r=0.6 =  0.75621375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.69
SUFF++ for r=0.6 class 0 = 0.558 +- 0.316 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.6 class 1 = 0.656 +- 0.316 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.6 class 2 = 0.69 +- 0.316 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.6 all KL = 0.599 +- 0.316 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.6 all L1 = 0.636 +- 0.192 (in-sample avg dev_std = 0.588)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.805
Model XAI F1 of binarized graphs for r=0.9 =  0.39854875000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.7475125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0 = 0.666 +- 0.227 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.227 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 2 = 0.845 +- 0.227 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all KL = 0.792 +- 0.227 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all L1 = 0.785 +- 0.191 (in-sample avg dev_std = 0.348)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  0.6964224999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6954025
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
NEC for r=0.3 class 0 = 0.597 +- 0.274 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 1 = 0.563 +- 0.274 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 2 = 0.597 +- 0.274 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all KL = 0.665 +- 0.274 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all L1 = 0.586 +- 0.142 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.909
Model XAI F1 of binarized graphs for r=0.6 =  0.6053262500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7957462500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.481
NEC for r=0.6 class 0 = 0.547 +- 0.312 (in-sample avg dev_std = 0.485)
NEC for r=0.6 class 1 = 0.513 +- 0.312 (in-sample avg dev_std = 0.485)
NEC for r=0.6 class 2 = 0.59 +- 0.312 (in-sample avg dev_std = 0.485)
NEC for r=0.6 all KL = 0.582 +- 0.312 (in-sample avg dev_std = 0.485)
NEC for r=0.6 all L1 = 0.55 +- 0.176 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.47612625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.80386875
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.552
NEC for r=0.9 class 0 = 0.496 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.459 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.515 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.51 +- 0.297 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.49 +- 0.165 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.80386875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.568
NEC for r=1.0 class 0 = 0.477 +- 0.301 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 1 = 0.462 +- 0.301 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 2 = 0.511 +- 0.301 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all KL = 0.503 +- 0.301 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all L1 = 0.483 +- 0.170 (in-sample avg dev_std = 0.536)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.618
Model XAI F1 of binarized graphs for r=0.3 =  0.7002862499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6953324999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.577 +- 0.278 (in-sample avg dev_std = 0.465)
NEC for r=0.3 class 1 = 0.57 +- 0.278 (in-sample avg dev_std = 0.465)
NEC for r=0.3 class 2 = 0.617 +- 0.278 (in-sample avg dev_std = 0.465)
NEC for r=0.3 all KL = 0.662 +- 0.278 (in-sample avg dev_std = 0.465)
NEC for r=0.3 all L1 = 0.588 +- 0.147 (in-sample avg dev_std = 0.465)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60346625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7893375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.482
NEC for r=0.6 class 0 = 0.542 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 1 = 0.52 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 2 = 0.609 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all KL = 0.593 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all L1 = 0.557 +- 0.173 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47362375
Model XAI WIoU of binarized graphs for r=0.9 =  0.7962062499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.562
NEC for r=0.9 class 0 = 0.481 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.47 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.519 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.514 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.49 +- 0.168 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7962062499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0 = 0.481 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 1 = 0.469 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 2 = 0.504 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all KL = 0.507 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all L1 = 0.485 +- 0.166 (in-sample avg dev_std = 0.544)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.915
Model XAI F1 of binarized graphs for r=0.3 =  0.651755
Model XAI WIoU of binarized graphs for r=0.3 =  0.9459825000000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.417
NEC for r=0.3 class 0 = 0.636 +- 0.267 (in-sample avg dev_std = 0.503)
NEC for r=0.3 class 1 = 0.524 +- 0.267 (in-sample avg dev_std = 0.503)
NEC for r=0.3 class 2 = 0.72 +- 0.267 (in-sample avg dev_std = 0.503)
NEC for r=0.3 all KL = 0.687 +- 0.267 (in-sample avg dev_std = 0.503)
NEC for r=0.3 all L1 = 0.628 +- 0.140 (in-sample avg dev_std = 0.503)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.398635
Model XAI WIoU of binarized graphs for r=0.6 =  0.9463025
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.553
NEC for r=0.6 class 0 = 0.495 +- 0.241 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.421 +- 0.241 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.538 +- 0.241 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.403 +- 0.241 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.485 +- 0.136 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.28804375
Model XAI WIoU of binarized graphs for r=0.9 =  0.9463025
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.467 +- 0.207 (in-sample avg dev_std = 0.475)
NEC for r=0.9 class 1 = 0.407 +- 0.207 (in-sample avg dev_std = 0.475)
NEC for r=0.9 class 2 = 0.453 +- 0.207 (in-sample avg dev_std = 0.475)
NEC for r=0.9 all KL = 0.35 +- 0.207 (in-sample avg dev_std = 0.475)
NEC for r=0.9 all L1 = 0.443 +- 0.120 (in-sample avg dev_std = 0.475)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.9463025
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.611
NEC for r=1.0 class 0 = 0.443 +- 0.207 (in-sample avg dev_std = 0.471)
NEC for r=1.0 class 1 = 0.412 +- 0.207 (in-sample avg dev_std = 0.471)
NEC for r=1.0 class 2 = 0.453 +- 0.207 (in-sample avg dev_std = 0.471)
NEC for r=1.0 all KL = 0.343 +- 0.207 (in-sample avg dev_std = 0.471)
NEC for r=1.0 all L1 = 0.436 +- 0.124 (in-sample avg dev_std = 0.471)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.683
Model XAI F1 of binarized graphs for r=0.3 =  0.47423250000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.58244125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.453
NEC for r=0.3 class 0 = 0.447 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 1 = 0.465 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 2 = 0.515 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all KL = 0.41 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all L1 = 0.476 +- 0.123 (in-sample avg dev_std = 0.458)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  0.5155825
Model XAI WIoU of binarized graphs for r=0.6 =  0.75621375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.547
NEC for r=0.6 class 0 = 0.421 +- 0.348 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 1 = 0.406 +- 0.348 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 2 = 0.549 +- 0.348 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all KL = 0.484 +- 0.348 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all L1 = 0.458 +- 0.227 (in-sample avg dev_std = 0.551)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.805
Model XAI F1 of binarized graphs for r=0.9 =  0.39854875000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.7475125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.617
NEC for r=0.9 class 0 = 0.399 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 1 = 0.384 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 2 = 0.433 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all KL = 0.442 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all L1 = 0.405 +- 0.207 (in-sample avg dev_std = 0.575)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.805
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7475125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.637
NEC for r=1.0 class 0 = 0.405 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 1 = 0.368 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 2 = 0.436 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all KL = 0.435 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all L1 = 0.403 +- 0.196 (in-sample avg dev_std = 0.570)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:32:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:32:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9160
ID Validation Loss: 0.3999
ID Test ACCURACY: 0.9063
ID Test Loss: 0.4570
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.4378
OOD Test ACCURACY: 0.7653
OOD Test Loss: 0.7567

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ACCURACY: 0.8616
Train Loss: 0.5039
ID Validation ACCURACY: 0.8560
ID Validation Loss: 0.5048
ID Test ACCURACY: 0.8567
ID Test Loss: 0.5356
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4136
OOD Test ACCURACY: 0.7727
OOD Test Loss: 0.6722

[0m[1;37mINFO[0m: [1mChartInfo 0.9063 0.7653 0.8567 0.7727 0.8560 0.9293[0mGOODMotif2(18000)
Data example from train: Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from train: (tensor([0, 1, 2]), tensor([5925, 6060, 6015]))

Gold ratio (train) =  tensor(0.3124) +- tensor(0.1674)
F1 for r=0.3 = 0.674
WIoU for r=0.3 = 0.661
F1 for r=0.6 = 0.597
WIoU for r=0.6 = 0.762
F1 for r=0.9 = 0.478
WIoU for r=0.9 = 0.775
F1 for r=1.0 = 0.453
WIoU for r=1.0 = 0.774
GOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.683
WIoU for r=0.3 = 0.670
F1 for r=0.6 = 0.595
WIoU for r=0.6 = 0.765
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.777
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.777
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.667
WIoU for r=0.3 = 0.997
F1 for r=0.6 = 0.408
WIoU for r=0.6 = 0.997
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.997
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.997
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.365
WIoU for r=0.3 = 0.522
F1 for r=0.6 = 0.451
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.402
WIoU for r=0.9 = 0.738
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.738


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  0.6743875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6614875000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.492 +- 0.302 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 1 = 0.628 +- 0.302 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 2 = 0.468 +- 0.302 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all KL = 0.431 +- 0.302 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all L1 = 0.53 +- 0.183 (in-sample avg dev_std = 0.551)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.864
Model XAI F1 of binarized graphs for r=0.6 =  0.5966625000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7619650000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.703
SUFF++ for r=0.6 class 0 = 0.584 +- 0.290 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 class 1 = 0.717 +- 0.290 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 class 2 = 0.593 +- 0.290 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 all KL = 0.58 +- 0.290 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.179 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.477815
Model XAI WIoU of binarized graphs for r=0.9 =  0.77456125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0 = 0.8 +- 0.148 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 1 = 0.854 +- 0.148 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 2 = 0.891 +- 0.148 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all KL = 0.893 +- 0.148 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.146 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.68321625
Model XAI WIoU of binarized graphs for r=0.3 =  0.669955
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.446
SUFF++ for r=0.3 class 0 = 0.497 +- 0.305 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 1 = 0.614 +- 0.305 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 2 = 0.455 +- 0.305 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all KL = 0.422 +- 0.305 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all L1 = 0.522 +- 0.186 (in-sample avg dev_std = 0.553)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.59516125
Model XAI WIoU of binarized graphs for r=0.6 =  0.765335
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0 = 0.595 +- 0.293 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 class 1 = 0.705 +- 0.293 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 class 2 = 0.606 +- 0.293 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 all KL = 0.583 +- 0.293 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.6 all L1 = 0.636 +- 0.183 (in-sample avg dev_std = 0.527)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47566
Model XAI WIoU of binarized graphs for r=0.9 =  0.7768124999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0 = 0.788 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 1 = 0.852 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 2 = 0.889 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all KL = 0.883 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.158 (in-sample avg dev_std = 0.247)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.916
Model XAI F1 of binarized graphs for r=0.3 =  0.6671662500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99738625
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.602
SUFF++ for r=0.3 class 0 = 0.426 +- 0.319 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.3 class 1 = 0.657 +- 0.319 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.3 class 2 = 0.407 +- 0.319 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.3 all KL = 0.406 +- 0.319 (in-sample avg dev_std = 0.665)
SUFF++ for r=0.3 all L1 = 0.495 +- 0.174 (in-sample avg dev_std = 0.665)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.4079575
Model XAI WIoU of binarized graphs for r=0.6 =  0.99738625
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.761
SUFF++ for r=0.6 class 0 = 0.607 +- 0.213 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1 = 0.632 +- 0.213 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 2 = 0.679 +- 0.213 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.723 +- 0.213 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.639 +- 0.140 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.29450875
Model XAI WIoU of binarized graphs for r=0.9 =  0.99738625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.9
SUFF++ for r=0.9 class 0 = 0.823 +- 0.073 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 1 = 0.824 +- 0.073 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 2 = 0.92 +- 0.073 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all KL = 0.94 +- 0.073 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.106 (in-sample avg dev_std = 0.207)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.36501875
Model XAI WIoU of binarized graphs for r=0.3 =  0.52244875
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0 = 0.565 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 class 1 = 0.629 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 class 2 = 0.582 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 all KL = 0.519 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.179 (in-sample avg dev_std = 0.580)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.45104
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934600000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.636
SUFF++ for r=0.6 class 0 = 0.527 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 class 1 = 0.582 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 class 2 = 0.575 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 all KL = 0.585 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 all L1 = 0.562 +- 0.213 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.761
Model XAI F1 of binarized graphs for r=0.9 =  0.40172875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7375375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF++ for r=0.9 class 0 = 0.688 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 1 = 0.778 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 2 = 0.743 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all KL = 0.711 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all L1 = 0.737 +- 0.201 (in-sample avg dev_std = 0.323)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  0.6743875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6614875000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.386
NEC for r=0.3 class 0 = 0.508 +- 0.323 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 1 = 0.437 +- 0.323 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 2 = 0.56 +- 0.323 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all KL = 0.594 +- 0.323 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all L1 = 0.502 +- 0.190 (in-sample avg dev_std = 0.458)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.864
Model XAI F1 of binarized graphs for r=0.6 =  0.5966625000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7619650000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.533
NEC for r=0.6 class 0 = 0.516 +- 0.307 (in-sample avg dev_std = 0.518)
NEC for r=0.6 class 1 = 0.464 +- 0.307 (in-sample avg dev_std = 0.518)
NEC for r=0.6 class 2 = 0.584 +- 0.307 (in-sample avg dev_std = 0.518)
NEC for r=0.6 all KL = 0.568 +- 0.307 (in-sample avg dev_std = 0.518)
NEC for r=0.6 all L1 = 0.521 +- 0.173 (in-sample avg dev_std = 0.518)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.477815
Model XAI WIoU of binarized graphs for r=0.9 =  0.77456125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.616
NEC for r=0.9 class 0 = 0.465 +- 0.302 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 1 = 0.428 +- 0.302 (in-sample avg dev_std = 0.534)
NEC for r=0.9 class 2 = 0.531 +- 0.302 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all KL = 0.511 +- 0.302 (in-sample avg dev_std = 0.534)
NEC for r=0.9 all L1 = 0.475 +- 0.168 (in-sample avg dev_std = 0.534)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.45279875
Model XAI WIoU of binarized graphs for r=1.0 =  0.77421625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.629
NEC for r=1.0 class 0 = 0.457 +- 0.302 (in-sample avg dev_std = 0.542)
NEC for r=1.0 class 1 = 0.423 +- 0.302 (in-sample avg dev_std = 0.542)
NEC for r=1.0 class 2 = 0.501 +- 0.302 (in-sample avg dev_std = 0.542)
NEC for r=1.0 all KL = 0.499 +- 0.302 (in-sample avg dev_std = 0.542)
NEC for r=1.0 all L1 = 0.46 +- 0.166 (in-sample avg dev_std = 0.542)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.68321625
Model XAI WIoU of binarized graphs for r=0.3 =  0.669955
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.393
NEC for r=0.3 class 0 = 0.524 +- 0.319 (in-sample avg dev_std = 0.447)
NEC for r=0.3 class 1 = 0.452 +- 0.319 (in-sample avg dev_std = 0.447)
NEC for r=0.3 class 2 = 0.589 +- 0.319 (in-sample avg dev_std = 0.447)
NEC for r=0.3 all KL = 0.613 +- 0.319 (in-sample avg dev_std = 0.447)
NEC for r=0.3 all L1 = 0.521 +- 0.187 (in-sample avg dev_std = 0.447)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.59516125
Model XAI WIoU of binarized graphs for r=0.6 =  0.765335
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.525
NEC for r=0.6 class 0 = 0.523 +- 0.308 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 1 = 0.479 +- 0.308 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 2 = 0.596 +- 0.308 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all KL = 0.587 +- 0.308 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all L1 = 0.532 +- 0.169 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47566
Model XAI WIoU of binarized graphs for r=0.9 =  0.7768124999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.613
NEC for r=0.9 class 0 = 0.469 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 class 1 = 0.438 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 class 2 = 0.54 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 all KL = 0.521 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 all L1 = 0.482 +- 0.167 (in-sample avg dev_std = 0.540)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.77693625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.627
NEC for r=1.0 class 0 = 0.465 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 1 = 0.417 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 2 = 0.515 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all KL = 0.508 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all L1 = 0.465 +- 0.165 (in-sample avg dev_std = 0.547)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.916
Model XAI F1 of binarized graphs for r=0.3 =  0.6671662500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99738625
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.414
NEC for r=0.3 class 0 = 0.665 +- 0.297 (in-sample avg dev_std = 0.488)
NEC for r=0.3 class 1 = 0.463 +- 0.297 (in-sample avg dev_std = 0.488)
NEC for r=0.3 class 2 = 0.745 +- 0.297 (in-sample avg dev_std = 0.488)
NEC for r=0.3 all KL = 0.683 +- 0.297 (in-sample avg dev_std = 0.488)
NEC for r=0.3 all L1 = 0.626 +- 0.166 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.923
Model XAI F1 of binarized graphs for r=0.6 =  0.4079575
Model XAI WIoU of binarized graphs for r=0.6 =  0.99738625
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.563
NEC for r=0.6 class 0 = 0.495 +- 0.252 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.414 +- 0.252 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.566 +- 0.252 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.419 +- 0.252 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.493 +- 0.143 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.29450875
Model XAI WIoU of binarized graphs for r=0.9 =  0.99738625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0 = 0.471 +- 0.228 (in-sample avg dev_std = 0.482)
NEC for r=0.9 class 1 = 0.392 +- 0.228 (in-sample avg dev_std = 0.482)
NEC for r=0.9 class 2 = 0.486 +- 0.228 (in-sample avg dev_std = 0.482)
NEC for r=0.9 all KL = 0.368 +- 0.228 (in-sample avg dev_std = 0.482)
NEC for r=0.9 all L1 = 0.45 +- 0.131 (in-sample avg dev_std = 0.482)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.99738625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.62
NEC for r=1.0 class 0 = 0.465 +- 0.224 (in-sample avg dev_std = 0.479)
NEC for r=1.0 class 1 = 0.394 +- 0.224 (in-sample avg dev_std = 0.479)
NEC for r=1.0 class 2 = 0.481 +- 0.224 (in-sample avg dev_std = 0.479)
NEC for r=1.0 all KL = 0.363 +- 0.224 (in-sample avg dev_std = 0.479)
NEC for r=1.0 all L1 = 0.447 +- 0.127 (in-sample avg dev_std = 0.479)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.36501875
Model XAI WIoU of binarized graphs for r=0.3 =  0.52244875
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.525
NEC for r=0.3 class 0 = 0.586 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 class 1 = 0.486 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 class 2 = 0.658 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 all KL = 0.652 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 all L1 = 0.576 +- 0.186 (in-sample avg dev_std = 0.519)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.45104
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934600000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.588
NEC for r=0.6 class 0 = 0.452 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 1 = 0.462 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 2 = 0.518 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all KL = 0.454 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all L1 = 0.477 +- 0.213 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.761
Model XAI F1 of binarized graphs for r=0.9 =  0.40172875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7375375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.643
NEC for r=0.9 class 0 = 0.402 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 1 = 0.4 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 2 = 0.494 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all KL = 0.487 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all L1 = 0.432 +- 0.208 (in-sample avg dev_std = 0.573)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.761
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7375375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.673
NEC for r=1.0 class 0 = 0.416 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 1 = 0.388 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 2 = 0.455 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all KL = 0.48 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all L1 = 0.42 +- 0.192 (in-sample avg dev_std = 0.572)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.459, 0.535, 0.826, 1.0], 'all_L1': [0.508, 0.607, 0.808, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.636, 0.896, 1.0], 'all_L1': [0.491, 0.667, 0.846, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.695, 0.882, 1.0], 'all_L1': [0.511, 0.671, 0.824, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.683, 0.896, 1.0], 'all_L1': [0.552, 0.688, 0.851, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.431, 0.58, 0.893, 1.0], 'all_L1': [0.53, 0.632, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.572, 0.614, 0.552, 0.548], 'all_L1': [0.545, 0.557, 0.522, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.653, 0.622, 0.546, 0.546], 'all_L1': [0.578, 0.556, 0.495, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.556, 0.483, 0.47], 'all_L1': [0.511, 0.539, 0.483, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.582, 0.51, 0.503], 'all_L1': [0.586, 0.55, 0.49, 0.483]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.568, 0.511, 0.499], 'all_L1': [0.502, 0.521, 0.475, 0.46]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.445, 0.542, 0.827, 1.0], 'all_L1': [0.502, 0.618, 0.813, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.636, 0.898, 1.0], 'all_L1': [0.495, 0.676, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.705, 0.881, 1.0], 'all_L1': [0.502, 0.683, 0.826, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.693, 0.896, 1.0], 'all_L1': [0.544, 0.695, 0.849, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.583, 0.883, 1.0], 'all_L1': [0.522, 0.636, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.577, 0.637, 0.563, 0.562], 'all_L1': [0.549, 0.567, 0.52, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.633, 0.554, 0.554], 'all_L1': [0.587, 0.56, 0.499, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.493, 0.573, 0.485, 0.476], 'all_L1': [0.526, 0.544, 0.478, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.593, 0.514, 0.507], 'all_L1': [0.588, 0.557, 0.49, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.587, 0.521, 0.508], 'all_L1': [0.521, 0.532, 0.482, 0.465]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.36, 0.709, 0.899, 1.0], 'all_L1': [0.512, 0.655, 0.829, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.362, 0.695, 0.904, 1.0], 'all_L1': [0.516, 0.638, 0.829, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.696, 0.89, 1.0], 'all_L1': [0.471, 0.592, 0.775, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.442, 0.772, 0.941, 1.0], 'all_L1': [0.532, 0.677, 0.861, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.723, 0.94, 1.0], 'all_L1': [0.495, 0.639, 0.856, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.779, 0.498, 0.43, 0.422], 'all_L1': [0.665, 0.527, 0.483, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.787, 0.493, 0.429, 0.422], 'all_L1': [0.662, 0.526, 0.484, 0.478]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.399, 0.348, 0.341], 'all_L1': [0.635, 0.495, 0.457, 0.45]}), defaultdict(<class 'list'>, {'all_KL': [0.687, 0.403, 0.35, 0.343], 'all_L1': [0.628, 0.485, 0.443, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.419, 0.368, 0.363], 'all_L1': [0.626, 0.493, 0.45, 0.447]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.464, 0.57, 0.837, 1.0], 'all_L1': [0.533, 0.585, 0.823, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.615, 0.838, 1.0], 'all_L1': [0.589, 0.649, 0.861, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.671, 0.866, 1.0], 'all_L1': [0.507, 0.653, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.681, 0.599, 0.792, 1.0], 'all_L1': [0.637, 0.636, 0.785, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.519, 0.585, 0.711, 1.0], 'all_L1': [0.592, 0.562, 0.737, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.668, 0.482, 0.475, 0.452], 'all_L1': [0.599, 0.47, 0.441, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.471, 0.481, 0.485], 'all_L1': [0.523, 0.454, 0.416, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.464, 0.417, 0.426], 'all_L1': [0.533, 0.477, 0.402, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.484, 0.442, 0.435], 'all_L1': [0.476, 0.458, 0.405, 0.403]}), defaultdict(<class 'list'>, {'all_KL': [0.652, 0.454, 0.487, 0.48], 'all_L1': [0.576, 0.477, 0.432, 0.42]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.518 +- 0.021, 0.653 +- 0.029, 0.835 +- 0.017, 1.000 +- 0.000
suff++ class all_KL  =  0.463 +- 0.048, 0.626 +- 0.061, 0.879 +- 0.027, 1.000 +- 0.000
suff++_acc_int  =  0.454 +- 0.018, 0.729 +- 0.023, 0.866 +- 0.012
nec class all_L1  =  0.544 +- 0.034, 0.545 +- 0.013, 0.493 +- 0.016, 0.484 +- 0.019
nec class all_KL  =  0.591 +- 0.069, 0.588 +- 0.026, 0.520 +- 0.025, 0.513 +- 0.030
nec_acc_int  =  0.381 +- 0.018, 0.498 +- 0.018, 0.576 +- 0.028, 0.588 +- 0.028

Eval split id_val
suff++ class all_L1  =  0.513 +- 0.018, 0.662 +- 0.029, 0.836 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.452 +- 0.043, 0.632 +- 0.063, 0.877 +- 0.026, 1.000 +- 0.000
suff++_acc_int  =  0.465 +- 0.020, 0.743 +- 0.019, 0.878 +- 0.008
nec class all_L1  =  0.554 +- 0.029, 0.552 +- 0.012, 0.494 +- 0.015, 0.488 +- 0.019
nec class all_KL  =  0.602 +- 0.063, 0.605 +- 0.026, 0.527 +- 0.028, 0.521 +- 0.032
nec_acc_int  =  0.384 +- 0.019, 0.497 +- 0.015, 0.581 +- 0.022, 0.594 +- 0.024

Eval split val
suff++ class all_L1  =  0.505 +- 0.021, 0.640 +- 0.028, 0.830 +- 0.031, 1.000 +- 0.000
suff++ class all_KL  =  0.394 +- 0.031, 0.719 +- 0.028, 0.915 +- 0.021, 1.000 +- 0.000
suff++_acc_int  =  0.616 +- 0.031, 0.748 +- 0.035, 0.870 +- 0.027
nec class all_L1  =  0.643 +- 0.017, 0.505 +- 0.018, 0.463 +- 0.017, 0.458 +- 0.017
nec class all_KL  =  0.724 +- 0.048, 0.442 +- 0.044, 0.385 +- 0.037, 0.378 +- 0.037
nec_acc_int  =  0.404 +- 0.010, 0.544 +- 0.013, 0.595 +- 0.015, 0.600 +- 0.016

Eval split test
suff++ class all_L1  =  0.572 +- 0.046, 0.617 +- 0.037, 0.806 +- 0.042, 1.000 +- 0.000
suff++ class all_KL  =  0.541 +- 0.077, 0.608 +- 0.035, 0.809 +- 0.054, 1.000 +- 0.000
suff++_acc_int  =  0.538 +- 0.033, 0.685 +- 0.032, 0.783 +- 0.063
nec class all_L1  =  0.541 +- 0.043, 0.467 +- 0.010, 0.419 +- 0.015, 0.413 +- 0.011
nec class all_KL  =  0.568 +- 0.092, 0.471 +- 0.011, 0.460 +- 0.027, 0.456 +- 0.024
nec_acc_int  =  0.477 +- 0.031, 0.573 +- 0.018, 0.636 +- 0.019, 0.653 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.531 +- 0.020, 0.599 +- 0.017, 0.664 +- 0.006, 0.742 +- 0.009
Faith. Armon (L1)= 		  =  0.530 +- 0.020, 0.594 +- 0.015, 0.620 +- 0.010, 0.652 +- 0.017
Faith. GMean (L1)= 	  =  0.531 +- 0.020, 0.596 +- 0.016, 0.642 +- 0.007, 0.696 +- 0.013
Faith. Aritm (KL)= 		  =  0.527 +- 0.022, 0.607 +- 0.027, 0.700 +- 0.013, 0.757 +- 0.015
Faith. Armon (KL)= 		  =  0.514 +- 0.020, 0.604 +- 0.026, 0.653 +- 0.018, 0.678 +- 0.026
Faith. GMean (KL)= 	  =  0.520 +- 0.021, 0.606 +- 0.026, 0.676 +- 0.015, 0.716 +- 0.021

Eval split id_val
Faith. Aritm (L1)= 		  =  0.534 +- 0.018, 0.607 +- 0.016, 0.665 +- 0.007, 0.744 +- 0.010
Faith. Armon (L1)= 		  =  0.532 +- 0.018, 0.601 +- 0.014, 0.621 +- 0.010, 0.655 +- 0.017
Faith. GMean (L1)= 	  =  0.533 +- 0.018, 0.604 +- 0.015, 0.642 +- 0.008, 0.698 +- 0.014
Faith. Aritm (KL)= 		  =  0.527 +- 0.020, 0.618 +- 0.025, 0.702 +- 0.014, 0.761 +- 0.016
Faith. Armon (KL)= 		  =  0.512 +- 0.018, 0.615 +- 0.025, 0.658 +- 0.020, 0.685 +- 0.028
Faith. GMean (KL)= 	  =  0.519 +- 0.018, 0.617 +- 0.025, 0.680 +- 0.016, 0.722 +- 0.022

Eval split val
Faith. Aritm (L1)= 		  =  0.574 +- 0.015, 0.573 +- 0.017, 0.647 +- 0.015, 0.729 +- 0.008
Faith. Armon (L1)= 		  =  0.566 +- 0.016, 0.564 +- 0.016, 0.594 +- 0.014, 0.628 +- 0.016
Faith. GMean (L1)= 	  =  0.570 +- 0.015, 0.568 +- 0.016, 0.620 +- 0.014, 0.676 +- 0.012
Faith. Aritm (KL)= 		  =  0.559 +- 0.013, 0.581 +- 0.020, 0.650 +- 0.017, 0.689 +- 0.018
Faith. Armon (KL)= 		  =  0.508 +- 0.016, 0.546 +- 0.030, 0.541 +- 0.035, 0.548 +- 0.038
Faith. GMean (KL)= 	  =  0.533 +- 0.010, 0.563 +- 0.024, 0.593 +- 0.026, 0.614 +- 0.030

Eval split test
Faith. Aritm (L1)= 		  =  0.556 +- 0.021, 0.542 +- 0.016, 0.613 +- 0.021, 0.707 +- 0.005
Faith. Armon (L1)= 		  =  0.553 +- 0.021, 0.531 +- 0.012, 0.551 +- 0.015, 0.585 +- 0.011
Faith. GMean (L1)= 	  =  0.555 +- 0.021, 0.537 +- 0.014, 0.581 +- 0.017, 0.643 +- 0.008
Faith. Aritm (KL)= 		  =  0.554 +- 0.025, 0.539 +- 0.017, 0.635 +- 0.023, 0.728 +- 0.012
Faith. Armon (KL)= 		  =  0.542 +- 0.027, 0.530 +- 0.013, 0.585 +- 0.020, 0.626 +- 0.022
Faith. GMean (KL)= 	  =  0.548 +- 0.025, 0.535 +- 0.015, 0.609 +- 0.020, 0.675 +- 0.017
Computed for split load_split = id



Completed in  0:28:30.234621  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:38:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:38:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 161...
[0m[1;37mINFO[0m: [1mCheckpoint 161: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9232
ID Validation Loss: 0.4071
ID Test ACCURACY: 0.9138
ID Test Loss: 0.4704
OOD Validation ACCURACY: 0.8802
OOD Validation Loss: 0.6430
OOD Test ACCURACY: 0.8284
OOD Test Loss: 1.3885

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4384
ID Test ACCURACY: 0.9176
ID Test Loss: 0.5121
OOD Validation ACCURACY: 0.8828
OOD Validation Loss: 0.6819
OOD Test ACCURACY: 0.8285
OOD Test Loss: 1.4679

[0m[1;37mINFO[0m: [1mChartInfo 0.9138 0.8284 0.9176 0.8285 0.9219 0.8828[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 12:38:42 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 12:38:46 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.937
SUFF++ for r=0.6 class 0.0 = 0.886 +- 0.327 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 1.0 = 0.922 +- 0.327 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all KL = 0.786 +- 0.327 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all L1 = 0.907 +- 0.162 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.997
SUFF++ for r=0.9 class 0.0 = 0.992 +- 0.072 (in-sample avg dev_std = 0.053)
SUFF++ for r=0.9 class 1.0 = 0.998 +- 0.072 (in-sample avg dev_std = 0.053)
SUFF++ for r=0.9 all KL = 0.993 +- 0.072 (in-sample avg dev_std = 0.053)
SUFF++ for r=0.9 all L1 = 0.996 +- 0.037 (in-sample avg dev_std = 0.053)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.839
SUFF++ for r=0.6 class 0.0 = 0.878 +- 0.302 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 class 1.0 = 0.909 +- 0.302 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 all KL = 0.798 +- 0.302 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 all L1 = 0.896 +- 0.171 (in-sample avg dev_std = 0.351)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.883
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0.0 = 0.954 +- 0.126 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.9 class 1.0 = 0.985 +- 0.126 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.9 all KL = 0.975 +- 0.126 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.9 all L1 = 0.971 +- 0.111 (in-sample avg dev_std = 0.132)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.829
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 788
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.776
SUFF++ for r=0.3 class 0.0 = 0.799 +- 0.323 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 1.0 = 0.849 +- 0.323 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 all KL = 0.702 +- 0.323 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 all L1 = 0.825 +- 0.192 (in-sample avg dev_std = 0.469)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.839
SUFF++ for r=0.6 class 0.0 = 0.879 +- 0.264 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.6 class 1.0 = 0.921 +- 0.264 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.6 all KL = 0.837 +- 0.264 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.6 all L1 = 0.901 +- 0.163 (in-sample avg dev_std = 0.321)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.879
SUFF++ for r=0.9 class 0.0 = 0.95 +- 0.148 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 class 1.0 = 0.948 +- 0.148 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all KL = 0.932 +- 0.148 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all L1 = 0.949 +- 0.105 (in-sample avg dev_std = 0.224)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.801
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.742
SUFF++ for r=0.3 class 0.0 = 0.725 +- 0.312 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 1.0 = 0.863 +- 0.312 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all KL = 0.664 +- 0.312 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all L1 = 0.796 +- 0.200 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.79
SUFF++ for r=0.6 class 0.0 = 0.819 +- 0.291 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.291 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all KL = 0.781 +- 0.291 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all L1 = 0.858 +- 0.201 (in-sample avg dev_std = 0.374)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0.0 = 0.924 +- 0.161 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 1.0 = 0.956 +- 0.161 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all KL = 0.932 +- 0.161 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all L1 = 0.941 +- 0.134 (in-sample avg dev_std = 0.215)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.981
NEC for r=0.6 class 0.0 = 0.024 +- 0.146 (in-sample avg dev_std = 0.097)
NEC for r=0.6 class 1.0 = 0.022 +- 0.146 (in-sample avg dev_std = 0.097)
NEC for r=0.6 all KL = 0.034 +- 0.146 (in-sample avg dev_std = 0.097)
NEC for r=0.6 all L1 = 0.023 +- 0.100 (in-sample avg dev_std = 0.097)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.016 +- 0.099 (in-sample avg dev_std = 0.078)
NEC for r=0.9 class 1.0 = 0.001 +- 0.099 (in-sample avg dev_std = 0.078)
NEC for r=0.9 all KL = 0.014 +- 0.099 (in-sample avg dev_std = 0.078)
NEC for r=0.9 all L1 = 0.008 +- 0.056 (in-sample avg dev_std = 0.078)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.016 +- 0.099 (in-sample avg dev_std = 0.078)
NEC for r=1.0 class 1.0 = 0.001 +- 0.099 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all KL = 0.014 +- 0.099 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all L1 = 0.008 +- 0.056 (in-sample avg dev_std = 0.078)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.872
NEC for r=0.6 class 0.0 = 0.072 +- 0.200 (in-sample avg dev_std = 0.172)
NEC for r=0.6 class 1.0 = 0.046 +- 0.200 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all KL = 0.067 +- 0.200 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all L1 = 0.057 +- 0.157 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.874
NEC for r=0.9 class 0.0 = 0.04 +- 0.135 (in-sample avg dev_std = 0.110)
NEC for r=0.9 class 1.0 = 0.022 +- 0.135 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all KL = 0.027 +- 0.135 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all L1 = 0.029 +- 0.121 (in-sample avg dev_std = 0.110)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.874
NEC for r=1.0 class 0.0 = 0.04 +- 0.136 (in-sample avg dev_std = 0.110)
NEC for r=1.0 class 1.0 = 0.021 +- 0.136 (in-sample avg dev_std = 0.110)
NEC for r=1.0 all KL = 0.027 +- 0.136 (in-sample avg dev_std = 0.110)
NEC for r=1.0 all L1 = 0.029 +- 0.121 (in-sample avg dev_std = 0.110)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.829
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.825
NEC for r=0.3 class 0.0 = 0.124 +- 0.258 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1.0 = 0.088 +- 0.258 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.117 +- 0.258 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.106 +- 0.209 (in-sample avg dev_std = 0.236)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.857
NEC for r=0.6 class 0.0 = 0.078 +- 0.192 (in-sample avg dev_std = 0.205)
NEC for r=0.6 class 1.0 = 0.049 +- 0.192 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all KL = 0.065 +- 0.192 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all L1 = 0.063 +- 0.157 (in-sample avg dev_std = 0.205)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.885
NEC for r=0.9 class 0.0 = 0.027 +- 0.084 (in-sample avg dev_std = 0.086)
NEC for r=0.9 class 1.0 = 0.02 +- 0.084 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all KL = 0.016 +- 0.084 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all L1 = 0.023 +- 0.089 (in-sample avg dev_std = 0.086)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.892
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.886
NEC for r=1.0 class 0.0 = 0.025 +- 0.076 (in-sample avg dev_std = 0.067)
NEC for r=1.0 class 1.0 = 0.014 +- 0.076 (in-sample avg dev_std = 0.067)
NEC for r=1.0 all KL = 0.012 +- 0.076 (in-sample avg dev_std = 0.067)
NEC for r=1.0 all L1 = 0.019 +- 0.079 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.801
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.772
NEC for r=0.3 class 0.0 = 0.198 +- 0.284 (in-sample avg dev_std = 0.311)
NEC for r=0.3 class 1.0 = 0.101 +- 0.284 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.175 +- 0.284 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.148 +- 0.223 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.809
NEC for r=0.6 class 0.0 = 0.12 +- 0.224 (in-sample avg dev_std = 0.246)
NEC for r=0.6 class 1.0 = 0.077 +- 0.224 (in-sample avg dev_std = 0.246)
NEC for r=0.6 all KL = 0.106 +- 0.224 (in-sample avg dev_std = 0.246)
NEC for r=0.6 all L1 = 0.098 +- 0.189 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.836
NEC for r=0.9 class 0.0 = 0.058 +- 0.123 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.034 +- 0.123 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.038 +- 0.123 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.046 +- 0.121 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.848
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0.0 = 0.033 +- 0.089 (in-sample avg dev_std = 0.104)
NEC for r=1.0 class 1.0 = 0.029 +- 0.089 (in-sample avg dev_std = 0.104)
NEC for r=1.0 all KL = 0.022 +- 0.089 (in-sample avg dev_std = 0.104)
NEC for r=1.0 all L1 = 0.031 +- 0.093 (in-sample avg dev_std = 0.104)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:42:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:42:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:42:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9215
ID Validation Loss: 0.4292
ID Test ACCURACY: 0.9138
ID Test Loss: 0.4908
OOD Validation ACCURACY: 0.8802
OOD Validation Loss: 0.6680
OOD Test ACCURACY: 0.8261
OOD Test Loss: 1.4346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0057
ID Validation ACCURACY: 0.9157
ID Validation Loss: 0.2928
ID Test ACCURACY: 0.9127
ID Test Loss: 0.3309
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.4550
OOD Test ACCURACY: 0.8361
OOD Test Loss: 0.9548

[0m[1;37mINFO[0m: [1mChartInfo 0.9138 0.8261 0.9127 0.8361 0.9157 0.8829[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 12:42:51 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 12:42:55 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.947
SUFF++ for r=0.6 class 0.0 = 0.894 +- 0.338 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 1.0 = 0.924 +- 0.338 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all KL = 0.772 +- 0.338 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all L1 = 0.911 +- 0.144 (in-sample avg dev_std = 0.371)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF++ for r=0.9 class 0.0 = 0.992 +- 0.068 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 class 1.0 = 1.0 +- 0.068 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 all KL = 0.994 +- 0.068 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 all L1 = 0.997 +- 0.041 (in-sample avg dev_std = 0.024)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.852
SUFF++ for r=0.6 class 0.0 = 0.846 +- 0.318 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 class 1.0 = 0.914 +- 0.318 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 all KL = 0.783 +- 0.318 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 all L1 = 0.886 +- 0.177 (in-sample avg dev_std = 0.380)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0.0 = 0.963 +- 0.105 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 class 1.0 = 0.988 +- 0.105 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all KL = 0.982 +- 0.105 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all L1 = 0.977 +- 0.091 (in-sample avg dev_std = 0.108)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 790
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.761
SUFF++ for r=0.3 class 0.0 = 0.816 +- 0.327 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1.0 = 0.86 +- 0.327 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.721 +- 0.327 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.839 +- 0.195 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.819
SUFF++ for r=0.6 class 0.0 = 0.867 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 class 1.0 = 0.92 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all KL = 0.826 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all L1 = 0.895 +- 0.181 (in-sample avg dev_std = 0.337)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF++ for r=0.9 class 0.0 = 0.945 +- 0.155 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 1.0 = 0.956 +- 0.155 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all KL = 0.932 +- 0.155 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all L1 = 0.95 +- 0.107 (in-sample avg dev_std = 0.230)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.735
SUFF++ for r=0.3 class 0.0 = 0.826 +- 0.304 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 1.0 = 0.895 +- 0.304 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all KL = 0.768 +- 0.304 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all L1 = 0.862 +- 0.187 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.81
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.791
SUFF++ for r=0.6 class 0.0 = 0.86 +- 0.257 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.6 class 1.0 = 0.925 +- 0.257 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.6 all KL = 0.843 +- 0.257 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.183 (in-sample avg dev_std = 0.310)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0.0 = 0.941 +- 0.159 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 class 1.0 = 0.959 +- 0.159 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all KL = 0.938 +- 0.159 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all L1 = 0.95 +- 0.123 (in-sample avg dev_std = 0.208)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.996
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.994
NEC for r=0.6 class 0.0 = 0.019 +- 0.091 (in-sample avg dev_std = 0.063)
NEC for r=0.6 class 1.0 = 0.009 +- 0.091 (in-sample avg dev_std = 0.063)
NEC for r=0.6 all KL = 0.02 +- 0.091 (in-sample avg dev_std = 0.063)
NEC for r=0.6 all L1 = 0.013 +- 0.056 (in-sample avg dev_std = 0.063)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 0.0 = 0.006 +- 0.068 (in-sample avg dev_std = 0.029)
NEC for r=0.9 class 1.0 = 0.0 +- 0.068 (in-sample avg dev_std = 0.029)
NEC for r=0.9 all KL = 0.008 +- 0.068 (in-sample avg dev_std = 0.029)
NEC for r=0.9 all L1 = 0.003 +- 0.026 (in-sample avg dev_std = 0.029)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  1.0
NEC for r=1.0 class 0.0 = 0.006 +- 0.068 (in-sample avg dev_std = 0.029)
NEC for r=1.0 class 1.0 = 0.0 +- 0.068 (in-sample avg dev_std = 0.029)
NEC for r=1.0 all KL = 0.008 +- 0.068 (in-sample avg dev_std = 0.029)
NEC for r=1.0 all L1 = 0.003 +- 0.026 (in-sample avg dev_std = 0.029)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.882
NEC for r=0.6 class 0.0 = 0.072 +- 0.179 (in-sample avg dev_std = 0.162)
NEC for r=0.6 class 1.0 = 0.034 +- 0.179 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all KL = 0.054 +- 0.179 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all L1 = 0.05 +- 0.145 (in-sample avg dev_std = 0.162)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.879
NEC for r=0.9 class 0.0 = 0.044 +- 0.124 (in-sample avg dev_std = 0.082)
NEC for r=0.9 class 1.0 = 0.016 +- 0.124 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all KL = 0.024 +- 0.124 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all L1 = 0.028 +- 0.108 (in-sample avg dev_std = 0.082)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.879
NEC for r=1.0 class 0.0 = 0.044 +- 0.124 (in-sample avg dev_std = 0.082)
NEC for r=1.0 class 1.0 = 0.016 +- 0.124 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all KL = 0.024 +- 0.124 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all L1 = 0.028 +- 0.108 (in-sample avg dev_std = 0.082)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.798
NEC for r=0.3 class 0.0 = 0.108 +- 0.224 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 1.0 = 0.063 +- 0.224 (in-sample avg dev_std = 0.215)
NEC for r=0.3 all KL = 0.087 +- 0.224 (in-sample avg dev_std = 0.215)
NEC for r=0.3 all L1 = 0.084 +- 0.186 (in-sample avg dev_std = 0.215)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.845
NEC for r=0.6 class 0.0 = 0.065 +- 0.180 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 1.0 = 0.042 +- 0.180 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.055 +- 0.180 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.053 +- 0.147 (in-sample avg dev_std = 0.191)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.873
NEC for r=0.9 class 0.0 = 0.027 +- 0.096 (in-sample avg dev_std = 0.101)
NEC for r=0.9 class 1.0 = 0.018 +- 0.096 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all KL = 0.017 +- 0.096 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all L1 = 0.022 +- 0.091 (in-sample avg dev_std = 0.101)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.88
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.873
NEC for r=1.0 class 0.0 = 0.025 +- 0.092 (in-sample avg dev_std = 0.085)
NEC for r=1.0 class 1.0 = 0.018 +- 0.092 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all KL = 0.016 +- 0.092 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all L1 = 0.021 +- 0.091 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.772
NEC for r=0.3 class 0.0 = 0.113 +- 0.215 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1.0 = 0.057 +- 0.215 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.086 +- 0.215 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.084 +- 0.181 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.81
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.807
NEC for r=0.6 class 0.0 = 0.076 +- 0.162 (in-sample avg dev_std = 0.163)
NEC for r=0.6 class 1.0 = 0.043 +- 0.162 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all KL = 0.053 +- 0.162 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all L1 = 0.059 +- 0.152 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.84
NEC for r=0.9 class 0.0 = 0.042 +- 0.104 (in-sample avg dev_std = 0.119)
NEC for r=0.9 class 1.0 = 0.023 +- 0.104 (in-sample avg dev_std = 0.119)
NEC for r=0.9 all KL = 0.026 +- 0.104 (in-sample avg dev_std = 0.119)
NEC for r=0.9 all L1 = 0.032 +- 0.103 (in-sample avg dev_std = 0.119)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.846
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.845
NEC for r=1.0 class 0.0 = 0.021 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.016 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.012 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.019 +- 0.070 (in-sample avg dev_std = 0.091)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:46:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 80...
[0m[1;37mINFO[0m: [1mCheckpoint 80: 
-----------------------------------
Train ACCURACY: 0.9991
Train Loss: 0.0067
ID Validation ACCURACY: 0.9191
ID Validation Loss: 0.3068
ID Test ACCURACY: 0.9104
ID Test Loss: 0.3679
OOD Validation ACCURACY: 0.8770
OOD Validation Loss: 0.5744
OOD Test ACCURACY: 0.8208
OOD Test Loss: 1.4759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9187
ID Validation Loss: 0.4818
ID Test ACCURACY: 0.9189
ID Test Loss: 0.5496
OOD Validation ACCURACY: 0.8843
OOD Validation Loss: 0.6971
OOD Test ACCURACY: 0.8280
OOD Test Loss: 1.3584

[0m[1;37mINFO[0m: [1mChartInfo 0.9104 0.8208 0.9189 0.8280 0.9187 0.8843[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 12:46:33 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 12:46:36 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.926
SUFF++ for r=0.6 class 0.0 = 0.878 +- 0.289 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 class 1.0 = 0.911 +- 0.289 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all KL = 0.805 +- 0.289 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.157 (in-sample avg dev_std = 0.348)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF++ for r=0.9 class 0.0 = 0.989 +- 0.050 (in-sample avg dev_std = 0.029)
SUFF++ for r=0.9 class 1.0 = 0.995 +- 0.050 (in-sample avg dev_std = 0.029)
SUFF++ for r=0.9 all KL = 0.993 +- 0.050 (in-sample avg dev_std = 0.029)
SUFF++ for r=0.9 all L1 = 0.992 +- 0.035 (in-sample avg dev_std = 0.029)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.842
SUFF++ for r=0.6 class 0.0 = 0.859 +- 0.267 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 class 1.0 = 0.903 +- 0.267 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 all KL = 0.82 +- 0.267 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 all L1 = 0.884 +- 0.170 (in-sample avg dev_std = 0.332)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
SUFF++ for r=0.9 class 0.0 = 0.952 +- 0.098 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.972 +- 0.098 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.977 +- 0.098 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.963 +- 0.109 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.816
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 790
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.768
SUFF++ for r=0.3 class 0.0 = 0.817 +- 0.267 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1.0 = 0.857 +- 0.267 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.777 +- 0.267 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.838 +- 0.178 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.827
SUFF++ for r=0.6 class 0.0 = 0.878 +- 0.217 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 1.0 = 0.914 +- 0.217 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 all KL = 0.865 +- 0.217 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.160 (in-sample avg dev_std = 0.293)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.876
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.862
SUFF++ for r=0.9 class 0.0 = 0.938 +- 0.120 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1.0 = 0.94 +- 0.120 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.938 +- 0.120 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.107 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.783
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.75
SUFF++ for r=0.3 class 0.0 = 0.824 +- 0.246 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 class 1.0 = 0.881 +- 0.246 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 all KL = 0.808 +- 0.246 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 all L1 = 0.854 +- 0.172 (in-sample avg dev_std = 0.360)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.801
SUFF++ for r=0.6 class 0.0 = 0.874 +- 0.229 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 class 1.0 = 0.908 +- 0.229 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all KL = 0.855 +- 0.229 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all L1 = 0.891 +- 0.165 (in-sample avg dev_std = 0.290)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.841
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.834
SUFF++ for r=0.9 class 0.0 = 0.946 +- 0.131 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 class 1.0 = 0.943 +- 0.131 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 all KL = 0.941 +- 0.131 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.116 (in-sample avg dev_std = 0.198)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.977
NEC for r=0.6 class 0.0 = 0.038 +- 0.115 (in-sample avg dev_std = 0.091)
NEC for r=0.6 class 1.0 = 0.032 +- 0.115 (in-sample avg dev_std = 0.091)
NEC for r=0.6 all KL = 0.035 +- 0.115 (in-sample avg dev_std = 0.091)
NEC for r=0.6 all L1 = 0.035 +- 0.107 (in-sample avg dev_std = 0.091)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.021 +- 0.094 (in-sample avg dev_std = 0.057)
NEC for r=0.9 class 1.0 = 0.006 +- 0.094 (in-sample avg dev_std = 0.057)
NEC for r=0.9 all KL = 0.015 +- 0.094 (in-sample avg dev_std = 0.057)
NEC for r=0.9 all L1 = 0.013 +- 0.061 (in-sample avg dev_std = 0.057)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.021 +- 0.094 (in-sample avg dev_std = 0.057)
NEC for r=1.0 class 1.0 = 0.006 +- 0.094 (in-sample avg dev_std = 0.057)
NEC for r=1.0 all KL = 0.015 +- 0.094 (in-sample avg dev_std = 0.057)
NEC for r=1.0 all L1 = 0.013 +- 0.061 (in-sample avg dev_std = 0.057)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.871
NEC for r=0.6 class 0.0 = 0.085 +- 0.166 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.048 +- 0.166 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.06 +- 0.166 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.063 +- 0.145 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.875
NEC for r=0.9 class 0.0 = 0.045 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=0.9 class 1.0 = 0.027 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all KL = 0.021 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all L1 = 0.034 +- 0.102 (in-sample avg dev_std = 0.101)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.875
NEC for r=1.0 class 0.0 = 0.045 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=1.0 class 1.0 = 0.027 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all KL = 0.021 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all L1 = 0.034 +- 0.102 (in-sample avg dev_std = 0.101)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.812
NEC for r=0.3 class 0.0 = 0.114 +- 0.182 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 1.0 = 0.077 +- 0.182 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all KL = 0.079 +- 0.182 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all L1 = 0.095 +- 0.176 (in-sample avg dev_std = 0.177)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.846
NEC for r=0.6 class 0.0 = 0.063 +- 0.126 (in-sample avg dev_std = 0.152)
NEC for r=0.6 class 1.0 = 0.044 +- 0.126 (in-sample avg dev_std = 0.152)
NEC for r=0.6 all KL = 0.041 +- 0.126 (in-sample avg dev_std = 0.152)
NEC for r=0.6 all L1 = 0.053 +- 0.128 (in-sample avg dev_std = 0.152)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.876
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.87
NEC for r=0.9 class 0.0 = 0.03 +- 0.059 (in-sample avg dev_std = 0.085)
NEC for r=0.9 class 1.0 = 0.024 +- 0.059 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all KL = 0.014 +- 0.059 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all L1 = 0.027 +- 0.085 (in-sample avg dev_std = 0.085)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.876
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0.0 = 0.027 +- 0.058 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.024 +- 0.058 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.013 +- 0.058 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.025 +- 0.082 (in-sample avg dev_std = 0.080)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.783
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.786
NEC for r=0.3 class 0.0 = 0.124 +- 0.161 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1.0 = 0.072 +- 0.161 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.073 +- 0.161 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.097 +- 0.169 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.819
NEC for r=0.6 class 0.0 = 0.08 +- 0.140 (in-sample avg dev_std = 0.139)
NEC for r=0.6 class 1.0 = 0.049 +- 0.140 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all KL = 0.05 +- 0.140 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all L1 = 0.064 +- 0.140 (in-sample avg dev_std = 0.139)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.841
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.837
NEC for r=0.9 class 0.0 = 0.037 +- 0.086 (in-sample avg dev_std = 0.101)
NEC for r=0.9 class 1.0 = 0.035 +- 0.086 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all KL = 0.023 +- 0.086 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all L1 = 0.036 +- 0.099 (in-sample avg dev_std = 0.101)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.842
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.84
NEC for r=1.0 class 0.0 = 0.028 +- 0.061 (in-sample avg dev_std = 0.088)
NEC for r=1.0 class 1.0 = 0.024 +- 0.061 (in-sample avg dev_std = 0.088)
NEC for r=1.0 all KL = 0.013 +- 0.061 (in-sample avg dev_std = 0.088)
NEC for r=1.0 all L1 = 0.026 +- 0.080 (in-sample avg dev_std = 0.088)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:50:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:50:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:50:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4390
ID Test ACCURACY: 0.9162
ID Test Loss: 0.5246
OOD Validation ACCURACY: 0.8849
OOD Validation Loss: 0.6551
OOD Test ACCURACY: 0.8289
OOD Test Loss: 1.3384

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4486
ID Test ACCURACY: 0.9172
ID Test Loss: 0.5292
OOD Validation ACCURACY: 0.8852
OOD Validation Loss: 0.6477
OOD Test ACCURACY: 0.8321
OOD Test Loss: 1.2473

[0m[1;37mINFO[0m: [1mChartInfo 0.9162 0.8289 0.9172 0.8321 0.9178 0.8852[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 12:50:42 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 12:50:45 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.937
SUFF++ for r=0.6 class 0.0 = 0.908 +- 0.346 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 1.0 = 0.913 +- 0.346 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all KL = 0.768 +- 0.346 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all L1 = 0.911 +- 0.156 (in-sample avg dev_std = 0.370)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.994
SUFF++ for r=0.9 class 0.0 = 0.987 +- 0.079 (in-sample avg dev_std = 0.000)
SUFF++ for r=0.9 class 1.0 = 0.999 +- 0.079 (in-sample avg dev_std = 0.000)
SUFF++ for r=0.9 all KL = 0.992 +- 0.079 (in-sample avg dev_std = 0.000)
SUFF++ for r=0.9 all L1 = 0.994 +- 0.066 (in-sample avg dev_std = 0.000)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.853
SUFF++ for r=0.6 class 0.0 = 0.87 +- 0.315 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 class 1.0 = 0.914 +- 0.315 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 all KL = 0.795 +- 0.315 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 all L1 = 0.896 +- 0.181 (in-sample avg dev_std = 0.361)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.876
SUFF++ for r=0.9 class 0.0 = 0.959 +- 0.121 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.988 +- 0.121 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.978 +- 0.121 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.975 +- 0.107 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 790
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.767
SUFF++ for r=0.3 class 0.0 = 0.824 +- 0.325 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 1.0 = 0.862 +- 0.325 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all KL = 0.719 +- 0.325 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all L1 = 0.844 +- 0.188 (in-sample avg dev_std = 0.445)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.866
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.828
SUFF++ for r=0.6 class 0.0 = 0.884 +- 0.284 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 1.0 = 0.912 +- 0.284 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 all KL = 0.827 +- 0.284 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 all L1 = 0.899 +- 0.173 (in-sample avg dev_std = 0.327)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.875
SUFF++ for r=0.9 class 0.0 = 0.946 +- 0.154 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 1.0 = 0.95 +- 0.154 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all KL = 0.933 +- 0.154 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.110 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.748
SUFF++ for r=0.3 class 0.0 = 0.807 +- 0.301 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1.0 = 0.896 +- 0.301 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.764 +- 0.301 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.853 +- 0.188 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.827
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.806
SUFF++ for r=0.6 class 0.0 = 0.867 +- 0.256 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.6 class 1.0 = 0.924 +- 0.256 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.6 all KL = 0.847 +- 0.256 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.173 (in-sample avg dev_std = 0.302)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.828
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.147 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 class 1.0 = 0.958 +- 0.147 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all KL = 0.941 +- 0.147 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all L1 = 0.951 +- 0.115 (in-sample avg dev_std = 0.199)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.983
NEC for r=0.6 class 0.0 = 0.019 +- 0.132 (in-sample avg dev_std = 0.113)
NEC for r=0.6 class 1.0 = 0.02 +- 0.132 (in-sample avg dev_std = 0.113)
NEC for r=0.6 all KL = 0.027 +- 0.132 (in-sample avg dev_std = 0.113)
NEC for r=0.6 all L1 = 0.02 +- 0.094 (in-sample avg dev_std = 0.113)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.011 +- 0.086 (in-sample avg dev_std = 0.075)
NEC for r=0.9 class 1.0 = 0.001 +- 0.086 (in-sample avg dev_std = 0.075)
NEC for r=0.9 all KL = 0.01 +- 0.086 (in-sample avg dev_std = 0.075)
NEC for r=0.9 all L1 = 0.005 +- 0.050 (in-sample avg dev_std = 0.075)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.011 +- 0.086 (in-sample avg dev_std = 0.075)
NEC for r=1.0 class 1.0 = 0.001 +- 0.086 (in-sample avg dev_std = 0.075)
NEC for r=1.0 all KL = 0.01 +- 0.086 (in-sample avg dev_std = 0.075)
NEC for r=1.0 all L1 = 0.005 +- 0.050 (in-sample avg dev_std = 0.075)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.881
NEC for r=0.6 class 0.0 = 0.062 +- 0.181 (in-sample avg dev_std = 0.146)
NEC for r=0.6 class 1.0 = 0.033 +- 0.181 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all KL = 0.053 +- 0.181 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all L1 = 0.045 +- 0.143 (in-sample avg dev_std = 0.146)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.874
NEC for r=0.9 class 0.0 = 0.038 +- 0.128 (in-sample avg dev_std = 0.085)
NEC for r=0.9 class 1.0 = 0.014 +- 0.128 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all KL = 0.024 +- 0.128 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all L1 = 0.024 +- 0.110 (in-sample avg dev_std = 0.085)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.874
NEC for r=1.0 class 0.0 = 0.038 +- 0.128 (in-sample avg dev_std = 0.085)
NEC for r=1.0 class 1.0 = 0.014 +- 0.128 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all KL = 0.024 +- 0.128 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all L1 = 0.024 +- 0.110 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.812
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.814
NEC for r=0.3 class 0.0 = 0.097 +- 0.219 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1.0 = 0.071 +- 0.219 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.086 +- 0.219 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.084 +- 0.188 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.866
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.858
NEC for r=0.6 class 0.0 = 0.052 +- 0.156 (in-sample avg dev_std = 0.163)
NEC for r=0.6 class 1.0 = 0.046 +- 0.156 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all KL = 0.046 +- 0.156 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all L1 = 0.049 +- 0.135 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.882
NEC for r=0.9 class 0.0 = 0.024 +- 0.078 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.016 +- 0.078 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.014 +- 0.078 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.02 +- 0.079 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.889
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.883
NEC for r=1.0 class 0.0 = 0.022 +- 0.073 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.014 +- 0.073 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.011 +- 0.073 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.018 +- 0.074 (in-sample avg dev_std = 0.080)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.782
NEC for r=0.3 class 0.0 = 0.124 +- 0.213 (in-sample avg dev_std = 0.196)
NEC for r=0.3 class 1.0 = 0.06 +- 0.213 (in-sample avg dev_std = 0.196)
NEC for r=0.3 all KL = 0.087 +- 0.213 (in-sample avg dev_std = 0.196)
NEC for r=0.3 all L1 = 0.091 +- 0.187 (in-sample avg dev_std = 0.196)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.827
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.075 +- 0.167 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 1.0 = 0.048 +- 0.167 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.056 +- 0.167 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.061 +- 0.151 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.836
NEC for r=0.9 class 0.0 = 0.035 +- 0.097 (in-sample avg dev_std = 0.110)
NEC for r=0.9 class 1.0 = 0.029 +- 0.097 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all KL = 0.024 +- 0.097 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all L1 = 0.032 +- 0.104 (in-sample avg dev_std = 0.110)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.84
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.837
NEC for r=1.0 class 0.0 = 0.024 +- 0.069 (in-sample avg dev_std = 0.088)
NEC for r=1.0 class 1.0 = 0.018 +- 0.069 (in-sample avg dev_std = 0.088)
NEC for r=1.0 all KL = 0.013 +- 0.069 (in-sample avg dev_std = 0.088)
NEC for r=1.0 all L1 = 0.021 +- 0.076 (in-sample avg dev_std = 0.088)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:54:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:54:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:54:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0005
ID Validation ACCURACY: 0.9202
ID Validation Loss: 0.3844
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4498
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.5759
OOD Test ACCURACY: 0.8366
OOD Test Loss: 0.9989

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9170
ID Validation Loss: 0.4333
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5038
OOD Validation ACCURACY: 0.8868
OOD Validation Loss: 0.6171
OOD Test ACCURACY: 0.8387
OOD Test Loss: 1.0809

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8366 0.9164 0.8387 0.9170 0.8868[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 12:54:21 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 12:54:24 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.936
SUFF++ for r=0.6 class 0.0 = 0.875 +- 0.328 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 1.0 = 0.933 +- 0.328 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all KL = 0.786 +- 0.328 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all L1 = 0.909 +- 0.155 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0.0 = 0.988 +- 0.077 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.9 class 1.0 = 1.0 +- 0.077 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.9 all KL = 0.992 +- 0.077 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.9 all L1 = 0.995 +- 0.056 (in-sample avg dev_std = 0.040)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.843
SUFF++ for r=0.6 class 0.0 = 0.857 +- 0.299 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.6 class 1.0 = 0.914 +- 0.299 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.6 all KL = 0.795 +- 0.299 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.6 all L1 = 0.89 +- 0.173 (in-sample avg dev_std = 0.341)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.878
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.865
SUFF++ for r=0.9 class 0.0 = 0.947 +- 0.128 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 class 1.0 = 0.982 +- 0.128 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all KL = 0.974 +- 0.128 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all L1 = 0.967 +- 0.114 (in-sample avg dev_std = 0.105)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.808
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 790
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.766
SUFF++ for r=0.3 class 0.0 = 0.821 +- 0.299 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 1.0 = 0.887 +- 0.299 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all KL = 0.761 +- 0.299 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all L1 = 0.855 +- 0.177 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.832
SUFF++ for r=0.6 class 0.0 = 0.878 +- 0.249 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 1.0 = 0.926 +- 0.249 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all KL = 0.848 +- 0.249 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all L1 = 0.903 +- 0.161 (in-sample avg dev_std = 0.303)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0.0 = 0.942 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1.0 = 0.949 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.934 +- 0.141 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.103 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.783
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.742
SUFF++ for r=0.3 class 0.0 = 0.807 +- 0.270 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 1.0 = 0.902 +- 0.270 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 all KL = 0.789 +- 0.270 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 all L1 = 0.856 +- 0.185 (in-sample avg dev_std = 0.370)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.792
SUFF++ for r=0.6 class 0.0 = 0.857 +- 0.226 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 1.0 = 0.915 +- 0.226 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 all KL = 0.862 +- 0.226 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 all L1 = 0.887 +- 0.178 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0.0 = 0.932 +- 0.140 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 class 1.0 = 0.955 +- 0.140 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all KL = 0.941 +- 0.140 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all L1 = 0.944 +- 0.118 (in-sample avg dev_std = 0.195)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.981
NEC for r=0.6 class 0.0 = 0.035 +- 0.134 (in-sample avg dev_std = 0.109)
NEC for r=0.6 class 1.0 = 0.012 +- 0.134 (in-sample avg dev_std = 0.109)
NEC for r=0.6 all KL = 0.031 +- 0.134 (in-sample avg dev_std = 0.109)
NEC for r=0.6 all L1 = 0.022 +- 0.090 (in-sample avg dev_std = 0.109)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.017 +- 0.107 (in-sample avg dev_std = 0.072)
NEC for r=0.9 class 1.0 = 0.0 +- 0.107 (in-sample avg dev_std = 0.072)
NEC for r=0.9 all KL = 0.014 +- 0.107 (in-sample avg dev_std = 0.072)
NEC for r=0.9 all L1 = 0.007 +- 0.057 (in-sample avg dev_std = 0.072)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.017 +- 0.107 (in-sample avg dev_std = 0.072)
NEC for r=1.0 class 1.0 = 0.0 +- 0.107 (in-sample avg dev_std = 0.072)
NEC for r=1.0 all KL = 0.014 +- 0.107 (in-sample avg dev_std = 0.072)
NEC for r=1.0 all L1 = 0.007 +- 0.057 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.87
NEC for r=0.6 class 0.0 = 0.081 +- 0.189 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 1.0 = 0.04 +- 0.189 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all KL = 0.061 +- 0.189 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all L1 = 0.057 +- 0.152 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.872
NEC for r=0.9 class 0.0 = 0.053 +- 0.130 (in-sample avg dev_std = 0.102)
NEC for r=0.9 class 1.0 = 0.02 +- 0.130 (in-sample avg dev_std = 0.102)
NEC for r=0.9 all KL = 0.028 +- 0.130 (in-sample avg dev_std = 0.102)
NEC for r=0.9 all L1 = 0.033 +- 0.117 (in-sample avg dev_std = 0.102)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.872
NEC for r=1.0 class 0.0 = 0.053 +- 0.130 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 1.0 = 0.02 +- 0.130 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all KL = 0.028 +- 0.130 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all L1 = 0.033 +- 0.117 (in-sample avg dev_std = 0.102)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.806
NEC for r=0.3 class 0.0 = 0.109 +- 0.197 (in-sample avg dev_std = 0.174)
NEC for r=0.3 class 1.0 = 0.055 +- 0.197 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all KL = 0.075 +- 0.197 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all L1 = 0.081 +- 0.176 (in-sample avg dev_std = 0.174)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.851
NEC for r=0.6 class 0.0 = 0.068 +- 0.155 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 1.0 = 0.035 +- 0.155 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all KL = 0.047 +- 0.155 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all L1 = 0.051 +- 0.138 (in-sample avg dev_std = 0.153)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.878
NEC for r=0.9 class 0.0 = 0.029 +- 0.064 (in-sample avg dev_std = 0.076)
NEC for r=0.9 class 1.0 = 0.016 +- 0.064 (in-sample avg dev_std = 0.076)
NEC for r=0.9 all KL = 0.012 +- 0.064 (in-sample avg dev_std = 0.076)
NEC for r=0.9 all L1 = 0.022 +- 0.080 (in-sample avg dev_std = 0.076)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.882
NEC for r=1.0 class 0.0 = 0.03 +- 0.071 (in-sample avg dev_std = 0.085)
NEC for r=1.0 class 1.0 = 0.016 +- 0.071 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all KL = 0.013 +- 0.071 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all L1 = 0.023 +- 0.084 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.783
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.773
NEC for r=0.3 class 0.0 = 0.134 +- 0.197 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 1.0 = 0.056 +- 0.197 (in-sample avg dev_std = 0.180)
NEC for r=0.3 all KL = 0.086 +- 0.197 (in-sample avg dev_std = 0.180)
NEC for r=0.3 all L1 = 0.094 +- 0.178 (in-sample avg dev_std = 0.180)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.814
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.813
NEC for r=0.6 class 0.0 = 0.089 +- 0.137 (in-sample avg dev_std = 0.145)
NEC for r=0.6 class 1.0 = 0.053 +- 0.137 (in-sample avg dev_std = 0.145)
NEC for r=0.6 all KL = 0.051 +- 0.137 (in-sample avg dev_std = 0.145)
NEC for r=0.6 all L1 = 0.07 +- 0.148 (in-sample avg dev_std = 0.145)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.837
NEC for r=0.9 class 0.0 = 0.049 +- 0.084 (in-sample avg dev_std = 0.089)
NEC for r=0.9 class 1.0 = 0.025 +- 0.084 (in-sample avg dev_std = 0.089)
NEC for r=0.9 all KL = 0.021 +- 0.084 (in-sample avg dev_std = 0.089)
NEC for r=0.9 all L1 = 0.037 +- 0.103 (in-sample avg dev_std = 0.089)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.845
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0.0 = 0.038 +- 0.071 (in-sample avg dev_std = 0.078)
NEC for r=1.0 class 1.0 = 0.021 +- 0.071 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all KL = 0.015 +- 0.071 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all L1 = 0.029 +- 0.091 (in-sample avg dev_std = 0.078)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.786, 0.993, 1.0], 'all_L1': [0.907, 0.996, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.772, 0.994, 1.0], 'all_L1': [0.911, 0.997, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.805, 0.993, 1.0], 'all_L1': [0.897, 0.992, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.992, 1.0], 'all_L1': [0.911, 0.994, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.992, 1.0], 'all_L1': [0.909, 0.995, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.034, 0.014, 0.014], 'all_L1': [0.023, 0.008, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.008, 0.008], 'all_L1': [0.013, 0.003, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.035, 0.015, 0.015], 'all_L1': [0.035, 0.013, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.01, 0.01], 'all_L1': [0.02, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.014, 0.014], 'all_L1': [0.022, 0.007, 0.007]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.798, 0.975, 1.0], 'all_L1': [0.896, 0.971, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.783, 0.982, 1.0], 'all_L1': [0.886, 0.977, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.82, 0.977, 1.0], 'all_L1': [0.884, 0.963, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.795, 0.978, 1.0], 'all_L1': [0.896, 0.975, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.795, 0.974, 1.0], 'all_L1': [0.89, 0.967, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.067, 0.027, 0.027], 'all_L1': [0.057, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.024, 0.024], 'all_L1': [0.05, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.021, 0.021], 'all_L1': [0.063, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.053, 0.024, 0.024], 'all_L1': [0.045, 0.024, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.028, 0.028], 'all_L1': [0.057, 0.033, 0.033]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.702, 0.837, 0.932, 1.0], 'all_L1': [0.825, 0.901, 0.949, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.826, 0.932, 1.0], 'all_L1': [0.839, 0.895, 0.95, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.777, 0.865, 0.938, 1.0], 'all_L1': [0.838, 0.897, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.719, 0.827, 0.933, 1.0], 'all_L1': [0.844, 0.899, 0.948, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.848, 0.934, 1.0], 'all_L1': [0.855, 0.903, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.117, 0.065, 0.016, 0.012], 'all_L1': [0.106, 0.063, 0.023, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.055, 0.017, 0.016], 'all_L1': [0.084, 0.053, 0.022, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.041, 0.014, 0.013], 'all_L1': [0.095, 0.053, 0.027, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.046, 0.014, 0.011], 'all_L1': [0.084, 0.049, 0.02, 0.018]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.047, 0.012, 0.013], 'all_L1': [0.081, 0.051, 0.022, 0.023]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.664, 0.781, 0.932, 1.0], 'all_L1': [0.796, 0.858, 0.941, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.843, 0.938, 1.0], 'all_L1': [0.862, 0.894, 0.95, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.855, 0.941, 1.0], 'all_L1': [0.854, 0.891, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.847, 0.941, 1.0], 'all_L1': [0.853, 0.897, 0.951, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.789, 0.862, 0.941, 1.0], 'all_L1': [0.856, 0.887, 0.944, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.175, 0.106, 0.038, 0.022], 'all_L1': [0.148, 0.098, 0.046, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.053, 0.026, 0.012], 'all_L1': [0.084, 0.059, 0.032, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.073, 0.05, 0.023, 0.013], 'all_L1': [0.097, 0.064, 0.036, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.056, 0.024, 0.013], 'all_L1': [0.091, 0.061, 0.032, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.051, 0.021, 0.015], 'all_L1': [0.094, 0.07, 0.037, 0.029]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.907 +- 0.005, 0.995 +- 0.002, 1.000 +- 0.000
suff++ class all_KL  =  0.783 +- 0.013, 0.993 +- 0.001, 1.000 +- 0.000
suff++_acc_int  =  0.937 +- 0.007, 0.997 +- 0.002
nec class all_L1  =  0.023 +- 0.007, 0.007 +- 0.003, 0.007 +- 0.003
nec class all_KL  =  0.029 +- 0.005, 0.012 +- 0.003, 0.012 +- 0.003
nec_acc_int  =  0.983 +- 0.006, 0.997 +- 0.002, 0.997 +- 0.002

Eval split id_val
suff++ class all_L1  =  0.890 +- 0.005, 0.971 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.798 +- 0.012, 0.977 +- 0.003, 1.000 +- 0.000
suff++_acc_int  =  0.846 +- 0.005, 0.876 +- 0.007
nec class all_L1  =  0.054 +- 0.006, 0.030 +- 0.004, 0.030 +- 0.004
nec class all_KL  =  0.059 +- 0.005, 0.025 +- 0.002, 0.025 +- 0.002
nec_acc_int  =  0.875 +- 0.005, 0.875 +- 0.002, 0.875 +- 0.002

Eval split val
suff++ class all_L1  =  0.840 +- 0.010, 0.899 +- 0.003, 0.946 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.736 +- 0.028, 0.841 +- 0.015, 0.934 +- 0.002, 1.000 +- 0.000
suff++_acc_int  =  0.767 +- 0.005, 0.829 +- 0.006, 0.871 +- 0.006
nec class all_L1  =  0.090 +- 0.009, 0.054 +- 0.005, 0.023 +- 0.002, 0.021 +- 0.003
nec class all_KL  =  0.089 +- 0.015, 0.051 +- 0.008, 0.015 +- 0.002, 0.013 +- 0.002
nec_acc_int  =  0.811 +- 0.009, 0.851 +- 0.005, 0.878 +- 0.006, 0.879 +- 0.006

Eval split test
suff++ class all_L1  =  0.844 +- 0.024, 0.885 +- 0.014, 0.946 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.759 +- 0.050, 0.838 +- 0.029, 0.939 +- 0.003, 1.000 +- 0.000
suff++_acc_int  =  0.743 +- 0.005, 0.796 +- 0.006, 0.834 +- 0.003
nec class all_L1  =  0.103 +- 0.023, 0.070 +- 0.014, 0.037 +- 0.005, 0.025 +- 0.005
nec class all_KL  =  0.101 +- 0.037, 0.063 +- 0.021, 0.026 +- 0.006, 0.015 +- 0.004
nec_acc_int  =  0.777 +- 0.006, 0.813 +- 0.004, 0.837 +- 0.002, 0.841 +- 0.003


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.465 +- 0.001, 0.501 +- 0.001, 0.504 +- 0.002
Faith. Armon (L1)= 		  =  0.044 +- 0.013, 0.014 +- 0.007, 0.014 +- 0.007
Faith. GMean (L1)= 	  =  0.141 +- 0.022, 0.082 +- 0.020, 0.083 +- 0.020
Faith. Aritm (KL)= 		  =  0.406 +- 0.009, 0.502 +- 0.001, 0.506 +- 0.001
Faith. Armon (KL)= 		  =  0.057 +- 0.010, 0.024 +- 0.005, 0.024 +- 0.005
Faith. GMean (KL)= 	  =  0.151 +- 0.016, 0.109 +- 0.013, 0.110 +- 0.013

Eval split id_val
Faith. Aritm (L1)= 		  =  0.472 +- 0.003, 0.500 +- 0.001, 0.515 +- 0.002
Faith. Armon (L1)= 		  =  0.102 +- 0.011, 0.057 +- 0.007, 0.057 +- 0.007
Faith. GMean (L1)= 	  =  0.220 +- 0.012, 0.169 +- 0.010, 0.172 +- 0.011
Faith. Aritm (KL)= 		  =  0.429 +- 0.007, 0.501 +- 0.001, 0.512 +- 0.001
Faith. Armon (KL)= 		  =  0.110 +- 0.009, 0.048 +- 0.005, 0.048 +- 0.005
Faith. GMean (KL)= 	  =  0.217 +- 0.010, 0.155 +- 0.008, 0.157 +- 0.008

Eval split val
Faith. Aritm (L1)= 		  =  0.465 +- 0.002, 0.476 +- 0.003, 0.485 +- 0.001, 0.511 +- 0.001
Faith. Armon (L1)= 		  =  0.162 +- 0.015, 0.101 +- 0.009, 0.045 +- 0.004, 0.042 +- 0.005
Faith. GMean (L1)= 	  =  0.275 +- 0.013, 0.220 +- 0.010, 0.147 +- 0.007, 0.145 +- 0.009
Faith. Aritm (KL)= 		  =  0.412 +- 0.010, 0.446 +- 0.006, 0.474 +- 0.001, 0.507 +- 0.001
Faith. Armon (KL)= 		  =  0.158 +- 0.022, 0.096 +- 0.015, 0.029 +- 0.003, 0.026 +- 0.003
Faith. GMean (KL)= 	  =  0.254 +- 0.017, 0.206 +- 0.016, 0.117 +- 0.007, 0.114 +- 0.007

Eval split test
Faith. Aritm (L1)= 		  =  0.474 +- 0.001, 0.478 +- 0.001, 0.491 +- 0.001, 0.513 +- 0.002
Faith. Armon (L1)= 		  =  0.182 +- 0.034, 0.130 +- 0.024, 0.070 +- 0.009, 0.049 +- 0.009
Faith. GMean (L1)= 	  =  0.292 +- 0.026, 0.248 +- 0.022, 0.186 +- 0.012, 0.158 +- 0.015
Faith. Aritm (KL)= 		  =  0.430 +- 0.008, 0.450 +- 0.004, 0.482 +- 0.001, 0.507 +- 0.002
Faith. Armon (KL)= 		  =  0.175 +- 0.051, 0.116 +- 0.035, 0.051 +- 0.011, 0.030 +- 0.007
Faith. GMean (KL)= 	  =  0.272 +- 0.035, 0.227 +- 0.031, 0.156 +- 0.017, 0.122 +- 0.014
Computed for split load_split = id



Completed in  0:19:58.919053  for LECIvGIN GOODSST2/length



DONE LECI GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 00:59:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 12:59:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4476
OOD Validation ACCURACY: 0.8772
OOD Validation Loss: 0.5532
OOD Test ACCURACY: 0.8226
OOD Test Loss: 0.9289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0021
ID Validation ACCURACY: 0.9159
ID Validation Loss: 0.3511
ID Test ACCURACY: 0.9110
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.8826
OOD Validation Loss: 0.4988
OOD Test ACCURACY: 0.8356
OOD Test Loss: 0.8592

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8226 0.9110 0.8356 0.9159 0.8826[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 12:59:06 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 12:59:10 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.974
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.875
SUFF++ for r=0.6 class 0.0 = 0.731 +- 0.334 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 1.0 = 0.866 +- 0.334 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all KL = 0.585 +- 0.334 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all L1 = 0.808 +- 0.183 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.997
SUFF++ for r=0.9 class 0.0 = 0.99 +- 0.073 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 1.0 = 1.0 +- 0.073 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all KL = 0.993 +- 0.073 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all L1 = 0.996 +- 0.039 (in-sample avg dev_std = 0.057)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.805
SUFF++ for r=0.6 class 0.0 = 0.718 +- 0.327 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 class 1.0 = 0.827 +- 0.327 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all KL = 0.615 +- 0.327 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all L1 = 0.781 +- 0.212 (in-sample avg dev_std = 0.530)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.893
SUFF++ for r=0.9 class 0.0 = 0.968 +- 0.106 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1.0 = 0.982 +- 0.106 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.982 +- 0.106 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.976 +- 0.097 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.8
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.768
SUFF++ for r=0.3 class 0.0 = 0.743 +- 0.302 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 1.0 = 0.856 +- 0.302 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all KL = 0.695 +- 0.302 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.202 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.817
SUFF++ for r=0.6 class 0.0 = 0.778 +- 0.294 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 1.0 = 0.881 +- 0.294 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all KL = 0.733 +- 0.294 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all L1 = 0.831 +- 0.196 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.88
SUFF++ for r=0.9 class 0.0 = 0.92 +- 0.146 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1.0 = 0.951 +- 0.146 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.917 +- 0.146 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.936 +- 0.108 (in-sample avg dev_std = 0.261)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.761
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.726
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1.0 = 0.849 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.701 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.785 +- 0.219 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.808
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.786
SUFF++ for r=0.6 class 0.0 = 0.81 +- 0.262 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 1.0 = 0.897 +- 0.262 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all KL = 0.799 +- 0.262 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all L1 = 0.855 +- 0.194 (in-sample avg dev_std = 0.372)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.82
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.113 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.113 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all KL = 0.943 +- 0.113 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all L1 = 0.942 +- 0.109 (in-sample avg dev_std = 0.218)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.974
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.97
NEC for r=0.6 class 0.0 = 0.094 +- 0.189 (in-sample avg dev_std = 0.132)
NEC for r=0.6 class 1.0 = 0.016 +- 0.189 (in-sample avg dev_std = 0.132)
NEC for r=0.6 all KL = 0.064 +- 0.189 (in-sample avg dev_std = 0.132)
NEC for r=0.6 all L1 = 0.049 +- 0.143 (in-sample avg dev_std = 0.132)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.015 +- 0.088 (in-sample avg dev_std = 0.078)
NEC for r=0.9 class 1.0 = 0.0 +- 0.088 (in-sample avg dev_std = 0.078)
NEC for r=0.9 all KL = 0.011 +- 0.088 (in-sample avg dev_std = 0.078)
NEC for r=0.9 all L1 = 0.006 +- 0.054 (in-sample avg dev_std = 0.078)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.015 +- 0.088 (in-sample avg dev_std = 0.078)
NEC for r=1.0 class 1.0 = 0.0 +- 0.088 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all KL = 0.011 +- 0.088 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all L1 = 0.006 +- 0.054 (in-sample avg dev_std = 0.078)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.853
NEC for r=0.6 class 0.0 = 0.157 +- 0.257 (in-sample avg dev_std = 0.249)
NEC for r=0.6 class 1.0 = 0.06 +- 0.257 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all KL = 0.114 +- 0.257 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all L1 = 0.101 +- 0.209 (in-sample avg dev_std = 0.249)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.038 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=0.9 class 1.0 = 0.021 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all KL = 0.024 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all L1 = 0.028 +- 0.116 (in-sample avg dev_std = 0.100)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.88
NEC for r=1.0 class 0.0 = 0.038 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=1.0 class 1.0 = 0.021 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all KL = 0.024 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all L1 = 0.028 +- 0.116 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.8
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.791
NEC for r=0.3 class 0.0 = 0.159 +- 0.267 (in-sample avg dev_std = 0.281)
NEC for r=0.3 class 1.0 = 0.09 +- 0.267 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all KL = 0.139 +- 0.267 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all L1 = 0.123 +- 0.207 (in-sample avg dev_std = 0.281)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.851
NEC for r=0.6 class 0.0 = 0.109 +- 0.200 (in-sample avg dev_std = 0.224)
NEC for r=0.6 class 1.0 = 0.055 +- 0.200 (in-sample avg dev_std = 0.224)
NEC for r=0.6 all KL = 0.082 +- 0.200 (in-sample avg dev_std = 0.224)
NEC for r=0.6 all L1 = 0.081 +- 0.169 (in-sample avg dev_std = 0.224)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.886
NEC for r=0.9 class 0.0 = 0.026 +- 0.075 (in-sample avg dev_std = 0.062)
NEC for r=0.9 class 1.0 = 0.012 +- 0.075 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all KL = 0.012 +- 0.075 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all L1 = 0.019 +- 0.080 (in-sample avg dev_std = 0.062)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.888
NEC for r=1.0 class 0.0 = 0.022 +- 0.069 (in-sample avg dev_std = 0.066)
NEC for r=1.0 class 1.0 = 0.011 +- 0.069 (in-sample avg dev_std = 0.066)
NEC for r=1.0 all KL = 0.011 +- 0.069 (in-sample avg dev_std = 0.066)
NEC for r=1.0 all L1 = 0.017 +- 0.073 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.761
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.754
NEC for r=0.3 class 0.0 = 0.219 +- 0.279 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 1.0 = 0.111 +- 0.279 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all KL = 0.172 +- 0.279 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all L1 = 0.163 +- 0.241 (in-sample avg dev_std = 0.300)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.808
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.804
NEC for r=0.6 class 0.0 = 0.102 +- 0.166 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1.0 = 0.057 +- 0.166 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.07 +- 0.166 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.078 +- 0.160 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.829
NEC for r=0.9 class 0.0 = 0.043 +- 0.064 (in-sample avg dev_std = 0.086)
NEC for r=0.9 class 1.0 = 0.02 +- 0.064 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all KL = 0.016 +- 0.064 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all L1 = 0.031 +- 0.086 (in-sample avg dev_std = 0.086)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.829
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.828
NEC for r=1.0 class 0.0 = 0.037 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.019 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.016 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.028 +- 0.081 (in-sample avg dev_std = 0.091)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:02:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3737
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4207
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.5304
OOD Test ACCURACY: 0.8254
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4219
ID Test ACCURACY: 0.9157
ID Test Loss: 0.4817
OOD Validation ACCURACY: 0.8832
OOD Validation Loss: 0.6079
OOD Test ACCURACY: 0.8258
OOD Test Loss: 1.2557

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8254 0.9157 0.8258 0.9194 0.8832[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 01:02:51 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 01:02:55 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.967
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.882
SUFF++ for r=0.6 class 0.0 = 0.778 +- 0.328 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 class 1.0 = 0.854 +- 0.328 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 all KL = 0.64 +- 0.328 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.6 all L1 = 0.821 +- 0.187 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0.0 = 0.989 +- 0.076 (in-sample avg dev_std = 0.034)
SUFF++ for r=0.9 class 1.0 = 0.998 +- 0.076 (in-sample avg dev_std = 0.034)
SUFF++ for r=0.9 all KL = 0.993 +- 0.076 (in-sample avg dev_std = 0.034)
SUFF++ for r=0.9 all L1 = 0.995 +- 0.051 (in-sample avg dev_std = 0.034)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.811
SUFF++ for r=0.6 class 0.0 = 0.772 +- 0.312 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 1.0 = 0.825 +- 0.312 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all KL = 0.649 +- 0.312 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all L1 = 0.803 +- 0.192 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0.0 = 0.951 +- 0.127 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.979 +- 0.127 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.973 +- 0.127 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.966 +- 0.120 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.777
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.751
SUFF++ for r=0.3 class 0.0 = 0.762 +- 0.287 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 1.0 = 0.818 +- 0.287 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all KL = 0.696 +- 0.287 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all L1 = 0.791 +- 0.190 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.824
SUFF++ for r=0.6 class 0.0 = 0.81 +- 0.274 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 1.0 = 0.867 +- 0.274 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all KL = 0.761 +- 0.274 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all L1 = 0.84 +- 0.192 (in-sample avg dev_std = 0.401)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.877
SUFF++ for r=0.9 class 0.0 = 0.919 +- 0.153 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1.0 = 0.947 +- 0.153 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.917 +- 0.153 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.934 +- 0.109 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.738
SUFF++ for r=0.3 class 0.0 = 0.746 +- 0.290 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 class 1.0 = 0.81 +- 0.290 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all KL = 0.671 +- 0.290 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all L1 = 0.779 +- 0.202 (in-sample avg dev_std = 0.482)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.795
SUFF++ for r=0.6 class 0.0 = 0.816 +- 0.266 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1.0 = 0.872 +- 0.266 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.782 +- 0.266 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.845 +- 0.197 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.848
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0.0 = 0.924 +- 0.133 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.133 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all KL = 0.932 +- 0.133 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.114 (in-sample avg dev_std = 0.232)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.967
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.972
NEC for r=0.6 class 0.0 = 0.086 +- 0.175 (in-sample avg dev_std = 0.126)
NEC for r=0.6 class 1.0 = 0.025 +- 0.175 (in-sample avg dev_std = 0.126)
NEC for r=0.6 all KL = 0.062 +- 0.175 (in-sample avg dev_std = 0.126)
NEC for r=0.6 all L1 = 0.051 +- 0.144 (in-sample avg dev_std = 0.126)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
NEC for r=0.9 class 0.0 = 0.015 +- 0.097 (in-sample avg dev_std = 0.057)
NEC for r=0.9 class 1.0 = 0.001 +- 0.097 (in-sample avg dev_std = 0.057)
NEC for r=0.9 all KL = 0.013 +- 0.097 (in-sample avg dev_std = 0.057)
NEC for r=0.9 all L1 = 0.007 +- 0.054 (in-sample avg dev_std = 0.057)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.995
NEC for r=1.0 class 0.0 = 0.015 +- 0.097 (in-sample avg dev_std = 0.057)
NEC for r=1.0 class 1.0 = 0.001 +- 0.097 (in-sample avg dev_std = 0.057)
NEC for r=1.0 all KL = 0.013 +- 0.097 (in-sample avg dev_std = 0.057)
NEC for r=1.0 all L1 = 0.007 +- 0.054 (in-sample avg dev_std = 0.057)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.857
NEC for r=0.6 class 0.0 = 0.138 +- 0.249 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 1.0 = 0.07 +- 0.249 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all KL = 0.113 +- 0.249 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all L1 = 0.098 +- 0.200 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
NEC for r=0.9 class 0.0 = 0.043 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.019 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.028 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.029 +- 0.115 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.871
NEC for r=1.0 class 0.0 = 0.043 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=1.0 class 1.0 = 0.019 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all KL = 0.028 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all L1 = 0.029 +- 0.115 (in-sample avg dev_std = 0.090)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.777
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.79
NEC for r=0.3 class 0.0 = 0.209 +- 0.286 (in-sample avg dev_std = 0.258)
NEC for r=0.3 class 1.0 = 0.111 +- 0.286 (in-sample avg dev_std = 0.258)
NEC for r=0.3 all KL = 0.165 +- 0.286 (in-sample avg dev_std = 0.258)
NEC for r=0.3 all L1 = 0.158 +- 0.238 (in-sample avg dev_std = 0.258)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.869
NEC for r=0.6 class 0.0 = 0.096 +- 0.165 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 1.0 = 0.052 +- 0.165 (in-sample avg dev_std = 0.188)
NEC for r=0.6 all KL = 0.064 +- 0.165 (in-sample avg dev_std = 0.188)
NEC for r=0.6 all L1 = 0.073 +- 0.158 (in-sample avg dev_std = 0.188)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.884
NEC for r=0.9 class 0.0 = 0.03 +- 0.075 (in-sample avg dev_std = 0.068)
NEC for r=0.9 class 1.0 = 0.01 +- 0.075 (in-sample avg dev_std = 0.068)
NEC for r=0.9 all KL = 0.012 +- 0.075 (in-sample avg dev_std = 0.068)
NEC for r=0.9 all L1 = 0.02 +- 0.082 (in-sample avg dev_std = 0.068)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.89
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.885
NEC for r=1.0 class 0.0 = 0.028 +- 0.073 (in-sample avg dev_std = 0.073)
NEC for r=1.0 class 1.0 = 0.01 +- 0.073 (in-sample avg dev_std = 0.073)
NEC for r=1.0 all KL = 0.011 +- 0.073 (in-sample avg dev_std = 0.073)
NEC for r=1.0 all L1 = 0.019 +- 0.079 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.759
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.76
NEC for r=0.3 class 0.0 = 0.201 +- 0.270 (in-sample avg dev_std = 0.286)
NEC for r=0.3 class 1.0 = 0.115 +- 0.270 (in-sample avg dev_std = 0.286)
NEC for r=0.3 all KL = 0.165 +- 0.270 (in-sample avg dev_std = 0.286)
NEC for r=0.3 all L1 = 0.156 +- 0.230 (in-sample avg dev_std = 0.286)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.81
NEC for r=0.6 class 0.0 = 0.111 +- 0.196 (in-sample avg dev_std = 0.216)
NEC for r=0.6 class 1.0 = 0.073 +- 0.196 (in-sample avg dev_std = 0.216)
NEC for r=0.6 all KL = 0.085 +- 0.196 (in-sample avg dev_std = 0.216)
NEC for r=0.6 all L1 = 0.092 +- 0.180 (in-sample avg dev_std = 0.216)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.848
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.841
NEC for r=0.9 class 0.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.099)
NEC for r=0.9 class 1.0 = 0.027 +- 0.074 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all KL = 0.018 +- 0.074 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all L1 = 0.03 +- 0.087 (in-sample avg dev_std = 0.099)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.849
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.845
NEC for r=1.0 class 0.0 = 0.027 +- 0.064 (in-sample avg dev_std = 0.087)
NEC for r=1.0 class 1.0 = 0.023 +- 0.064 (in-sample avg dev_std = 0.087)
NEC for r=1.0 all KL = 0.014 +- 0.064 (in-sample avg dev_std = 0.087)
NEC for r=1.0 all L1 = 0.025 +- 0.076 (in-sample avg dev_std = 0.087)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:07:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.4058
ID Test ACCURACY: 0.9147
ID Test Loss: 0.4863
OOD Validation ACCURACY: 0.8811
OOD Validation Loss: 0.5978
OOD Test ACCURACY: 0.8111
OOD Test Loss: 1.3825

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9211
ID Validation Loss: 0.4242
ID Test ACCURACY: 0.9145
ID Test Loss: 0.5078
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.6388
OOD Test ACCURACY: 0.8267
OOD Test Loss: 1.3856

[0m[1;37mINFO[0m: [1mChartInfo 0.9147 0.8111 0.9145 0.8267 0.9211 0.8839[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 01:07:13 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 01:07:16 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.908
SUFF++ for r=0.6 class 0.0 = 0.803 +- 0.339 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1.0 = 0.882 +- 0.339 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.647 +- 0.339 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.848 +- 0.179 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF++ for r=0.9 class 0.0 = 0.993 +- 0.066 (in-sample avg dev_std = 0.030)
SUFF++ for r=0.9 class 1.0 = 0.999 +- 0.066 (in-sample avg dev_std = 0.030)
SUFF++ for r=0.9 all KL = 0.994 +- 0.066 (in-sample avg dev_std = 0.030)
SUFF++ for r=0.9 all L1 = 0.997 +- 0.036 (in-sample avg dev_std = 0.030)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.825
SUFF++ for r=0.6 class 0.0 = 0.787 +- 0.324 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 class 1.0 = 0.845 +- 0.324 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all KL = 0.657 +- 0.324 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all L1 = 0.821 +- 0.191 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.894
SUFF++ for r=0.9 class 0.0 = 0.969 +- 0.096 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 class 1.0 = 0.989 +- 0.096 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 all KL = 0.984 +- 0.096 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 all L1 = 0.98 +- 0.086 (in-sample avg dev_std = 0.071)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.805
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.753
SUFF++ for r=0.3 class 0.0 = 0.762 +- 0.327 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 class 1.0 = 0.797 +- 0.327 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 all KL = 0.623 +- 0.327 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 all L1 = 0.781 +- 0.202 (in-sample avg dev_std = 0.527)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.818
SUFF++ for r=0.6 class 0.0 = 0.817 +- 0.297 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1.0 = 0.87 +- 0.297 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.729 +- 0.297 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.845 +- 0.184 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0.0 = 0.927 +- 0.148 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1.0 = 0.957 +- 0.148 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.919 +- 0.148 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.943 +- 0.102 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.727
SUFF++ for r=0.3 class 0.0 = 0.715 +- 0.341 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 1.0 = 0.813 +- 0.341 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all KL = 0.606 +- 0.341 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all L1 = 0.766 +- 0.217 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.811
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.782
SUFF++ for r=0.6 class 0.0 = 0.778 +- 0.306 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 1.0 = 0.905 +- 0.306 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all KL = 0.749 +- 0.306 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all L1 = 0.844 +- 0.202 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.812
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.148 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.148 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all KL = 0.932 +- 0.148 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.109 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.993
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.981
NEC for r=0.6 class 0.0 = 0.06 +- 0.173 (in-sample avg dev_std = 0.129)
NEC for r=0.6 class 1.0 = 0.021 +- 0.173 (in-sample avg dev_std = 0.129)
NEC for r=0.6 all KL = 0.055 +- 0.173 (in-sample avg dev_std = 0.129)
NEC for r=0.6 all L1 = 0.037 +- 0.113 (in-sample avg dev_std = 0.129)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.998
NEC for r=0.9 class 0.0 = 0.013 +- 0.092 (in-sample avg dev_std = 0.061)
NEC for r=0.9 class 1.0 = 0.0 +- 0.092 (in-sample avg dev_std = 0.061)
NEC for r=0.9 all KL = 0.011 +- 0.092 (in-sample avg dev_std = 0.061)
NEC for r=0.9 all L1 = 0.006 +- 0.048 (in-sample avg dev_std = 0.061)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.998
NEC for r=1.0 class 0.0 = 0.013 +- 0.092 (in-sample avg dev_std = 0.061)
NEC for r=1.0 class 1.0 = 0.0 +- 0.092 (in-sample avg dev_std = 0.061)
NEC for r=1.0 all KL = 0.011 +- 0.092 (in-sample avg dev_std = 0.061)
NEC for r=1.0 all L1 = 0.006 +- 0.048 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.864
NEC for r=0.6 class 0.0 = 0.098 +- 0.217 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 1.0 = 0.057 +- 0.217 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.084 +- 0.217 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.074 +- 0.170 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.882
NEC for r=0.9 class 0.0 = 0.035 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=0.9 class 1.0 = 0.014 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all KL = 0.021 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all L1 = 0.023 +- 0.098 (in-sample avg dev_std = 0.085)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.882
NEC for r=1.0 class 0.0 = 0.035 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=1.0 class 1.0 = 0.014 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all KL = 0.021 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all L1 = 0.023 +- 0.098 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.805
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.786
NEC for r=0.3 class 0.0 = 0.181 +- 0.304 (in-sample avg dev_std = 0.286)
NEC for r=0.3 class 1.0 = 0.119 +- 0.304 (in-sample avg dev_std = 0.286)
NEC for r=0.3 all KL = 0.179 +- 0.304 (in-sample avg dev_std = 0.286)
NEC for r=0.3 all L1 = 0.149 +- 0.238 (in-sample avg dev_std = 0.286)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.858
NEC for r=0.6 class 0.0 = 0.09 +- 0.199 (in-sample avg dev_std = 0.196)
NEC for r=0.6 class 1.0 = 0.054 +- 0.199 (in-sample avg dev_std = 0.196)
NEC for r=0.6 all KL = 0.077 +- 0.199 (in-sample avg dev_std = 0.196)
NEC for r=0.6 all L1 = 0.071 +- 0.158 (in-sample avg dev_std = 0.196)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.876
NEC for r=0.9 class 0.0 = 0.025 +- 0.085 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.015 +- 0.085 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.014 +- 0.085 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.02 +- 0.087 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.885
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.877
NEC for r=1.0 class 0.0 = 0.02 +- 0.077 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.014 +- 0.077 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.017 +- 0.079 (in-sample avg dev_std = 0.091)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.783
NEC for r=0.3 class 0.0 = 0.194 +- 0.289 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 1.0 = 0.102 +- 0.289 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all KL = 0.171 +- 0.289 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all L1 = 0.147 +- 0.234 (in-sample avg dev_std = 0.303)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.811
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.105 +- 0.179 (in-sample avg dev_std = 0.203)
NEC for r=0.6 class 1.0 = 0.049 +- 0.179 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all KL = 0.073 +- 0.179 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all L1 = 0.076 +- 0.165 (in-sample avg dev_std = 0.203)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.815
NEC for r=0.9 class 0.0 = 0.034 +- 0.075 (in-sample avg dev_std = 0.093)
NEC for r=0.9 class 1.0 = 0.016 +- 0.075 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all KL = 0.015 +- 0.075 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all L1 = 0.025 +- 0.084 (in-sample avg dev_std = 0.093)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.819
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.815
NEC for r=1.0 class 0.0 = 0.03 +- 0.062 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.014 +- 0.062 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.013 +- 0.062 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.022 +- 0.075 (in-sample avg dev_std = 0.091)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:10:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:10:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9223
ID Validation Loss: 0.3683
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4352
OOD Validation ACCURACY: 0.8814
OOD Validation Loss: 0.5797
OOD Test ACCURACY: 0.8193
OOD Test Loss: 1.6663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0050
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.3159
ID Test ACCURACY: 0.9144
ID Test Loss: 0.3601
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.5335
OOD Test ACCURACY: 0.8287
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8193 0.9144 0.8287 0.9183 0.8839[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 01:10:54 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 01:10:57 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.909
SUFF++ for r=0.6 class 0.0 = 0.801 +- 0.331 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 class 1.0 = 0.873 +- 0.331 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 all KL = 0.662 +- 0.331 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 all L1 = 0.842 +- 0.178 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF++ for r=0.9 class 0.0 = 0.99 +- 0.074 (in-sample avg dev_std = 0.002)
SUFF++ for r=0.9 class 1.0 = 0.998 +- 0.074 (in-sample avg dev_std = 0.002)
SUFF++ for r=0.9 all KL = 0.993 +- 0.074 (in-sample avg dev_std = 0.002)
SUFF++ for r=0.9 all L1 = 0.995 +- 0.048 (in-sample avg dev_std = 0.002)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.817
SUFF++ for r=0.6 class 0.0 = 0.778 +- 0.317 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1.0 = 0.834 +- 0.317 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.666 +- 0.317 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.811 +- 0.199 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.886
SUFF++ for r=0.9 class 0.0 = 0.957 +- 0.121 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 class 1.0 = 0.984 +- 0.121 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all KL = 0.976 +- 0.121 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.105 (in-sample avg dev_std = 0.104)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.791
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.749
SUFF++ for r=0.3 class 0.0 = 0.735 +- 0.306 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 1.0 = 0.8 +- 0.306 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all KL = 0.639 +- 0.306 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all L1 = 0.769 +- 0.194 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.864
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.828
SUFF++ for r=0.6 class 0.0 = 0.822 +- 0.279 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 1.0 = 0.868 +- 0.279 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all KL = 0.748 +- 0.279 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all L1 = 0.846 +- 0.185 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF++ for r=0.9 class 0.0 = 0.927 +- 0.163 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 1.0 = 0.941 +- 0.163 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all KL = 0.911 +- 0.163 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all L1 = 0.934 +- 0.116 (in-sample avg dev_std = 0.273)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.78
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.734
SUFF++ for r=0.3 class 0.0 = 0.714 +- 0.328 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 1.0 = 0.831 +- 0.328 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all KL = 0.629 +- 0.328 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all L1 = 0.774 +- 0.215 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.785
SUFF++ for r=0.6 class 0.0 = 0.805 +- 0.311 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 class 1.0 = 0.9 +- 0.311 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all KL = 0.76 +- 0.311 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all L1 = 0.854 +- 0.200 (in-sample avg dev_std = 0.408)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.829
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.138 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.138 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 all KL = 0.945 +- 0.138 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.101 (in-sample avg dev_std = 0.213)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.989
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.98
NEC for r=0.6 class 0.0 = 0.072 +- 0.191 (in-sample avg dev_std = 0.118)
NEC for r=0.6 class 1.0 = 0.028 +- 0.191 (in-sample avg dev_std = 0.118)
NEC for r=0.6 all KL = 0.071 +- 0.191 (in-sample avg dev_std = 0.118)
NEC for r=0.6 all L1 = 0.047 +- 0.122 (in-sample avg dev_std = 0.118)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.999
NEC for r=0.9 class 0.0 = 0.015 +- 0.091 (in-sample avg dev_std = 0.060)
NEC for r=0.9 class 1.0 = 0.001 +- 0.091 (in-sample avg dev_std = 0.060)
NEC for r=0.9 all KL = 0.014 +- 0.091 (in-sample avg dev_std = 0.060)
NEC for r=0.9 all L1 = 0.007 +- 0.044 (in-sample avg dev_std = 0.060)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.999
NEC for r=1.0 class 0.0 = 0.015 +- 0.091 (in-sample avg dev_std = 0.060)
NEC for r=1.0 class 1.0 = 0.001 +- 0.091 (in-sample avg dev_std = 0.060)
NEC for r=1.0 all KL = 0.014 +- 0.091 (in-sample avg dev_std = 0.060)
NEC for r=1.0 all L1 = 0.007 +- 0.044 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.859
NEC for r=0.6 class 0.0 = 0.147 +- 0.266 (in-sample avg dev_std = 0.227)
NEC for r=0.6 class 1.0 = 0.074 +- 0.266 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all KL = 0.128 +- 0.266 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all L1 = 0.105 +- 0.205 (in-sample avg dev_std = 0.227)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.872
NEC for r=0.9 class 0.0 = 0.05 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=0.9 class 1.0 = 0.017 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all KL = 0.029 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all L1 = 0.031 +- 0.123 (in-sample avg dev_std = 0.083)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.872
NEC for r=1.0 class 0.0 = 0.05 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=1.0 class 1.0 = 0.017 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=1.0 all KL = 0.029 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=1.0 all L1 = 0.031 +- 0.123 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.791
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.807
NEC for r=0.3 class 0.0 = 0.19 +- 0.273 (in-sample avg dev_std = 0.286)
NEC for r=0.3 class 1.0 = 0.117 +- 0.273 (in-sample avg dev_std = 0.286)
NEC for r=0.3 all KL = 0.167 +- 0.273 (in-sample avg dev_std = 0.286)
NEC for r=0.3 all L1 = 0.152 +- 0.222 (in-sample avg dev_std = 0.286)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.864
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.858
NEC for r=0.6 class 0.0 = 0.096 +- 0.201 (in-sample avg dev_std = 0.210)
NEC for r=0.6 class 1.0 = 0.057 +- 0.201 (in-sample avg dev_std = 0.210)
NEC for r=0.6 all KL = 0.081 +- 0.201 (in-sample avg dev_std = 0.210)
NEC for r=0.6 all L1 = 0.076 +- 0.168 (in-sample avg dev_std = 0.210)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.877
NEC for r=0.9 class 0.0 = 0.03 +- 0.089 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.011 +- 0.089 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.015 +- 0.089 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.02 +- 0.085 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.877
NEC for r=1.0 class 0.0 = 0.025 +- 0.078 (in-sample avg dev_std = 0.082)
NEC for r=1.0 class 1.0 = 0.011 +- 0.078 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all KL = 0.012 +- 0.078 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all L1 = 0.018 +- 0.079 (in-sample avg dev_std = 0.082)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.78
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.773
NEC for r=0.3 class 0.0 = 0.202 +- 0.279 (in-sample avg dev_std = 0.280)
NEC for r=0.3 class 1.0 = 0.098 +- 0.279 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all KL = 0.17 +- 0.279 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all L1 = 0.148 +- 0.229 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.104 +- 0.200 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1.0 = 0.054 +- 0.200 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.083 +- 0.200 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.078 +- 0.169 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.83
NEC for r=0.9 class 0.0 = 0.031 +- 0.091 (in-sample avg dev_std = 0.103)
NEC for r=0.9 class 1.0 = 0.02 +- 0.091 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all KL = 0.019 +- 0.091 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all L1 = 0.025 +- 0.093 (in-sample avg dev_std = 0.103)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.832
NEC for r=1.0 class 0.0 = 0.021 +- 0.077 (in-sample avg dev_std = 0.100)
NEC for r=1.0 class 1.0 = 0.017 +- 0.077 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all KL = 0.014 +- 0.077 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all L1 = 0.019 +- 0.069 (in-sample avg dev_std = 0.100)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:15:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:13 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0042
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.3042
ID Test ACCURACY: 0.9100
ID Test Loss: 0.3409
OOD Validation ACCURACY: 0.8736
OOD Validation Loss: 0.4929
OOD Test ACCURACY: 0.8157
OOD Test Loss: 0.9444

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9155
ID Validation Loss: 0.4081
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4411
OOD Validation ACCURACY: 0.8864
OOD Validation Loss: 0.5536
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.0612

[0m[1;37mINFO[0m: [1mChartInfo 0.9100 0.8157 0.9153 0.8255 0.9155 0.8864[0mGOODSST2(24744)
Data example from train: Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
Label distribution from train: (tensor([0., 1.]), tensor([10099, 14645]))
[1;34mDEBUG[0m: 05/03/2024 01:15:14 AM : [1mUnbalanced warning for GOODSST2 (train)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 05/03/2024 01:15:18 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.904
SUFF++ for r=0.6 class 0.0 = 0.795 +- 0.284 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1.0 = 0.862 +- 0.284 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.674 +- 0.284 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.833 +- 0.167 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 169
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.995
SUFF++ for r=0.9 class 0.0 = 0.98 +- 0.066 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.9 class 1.0 = 0.998 +- 0.066 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.9 all KL = 0.991 +- 0.066 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.9 all L1 = 0.991 +- 0.056 (in-sample avg dev_std = 0.038)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.826
SUFF++ for r=0.6 class 0.0 = 0.784 +- 0.265 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1.0 = 0.839 +- 0.265 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.716 +- 0.265 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.816 +- 0.183 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.879
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.102 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.9 class 1.0 = 0.987 +- 0.102 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.9 all KL = 0.981 +- 0.102 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.9 all L1 = 0.968 +- 0.105 (in-sample avg dev_std = 0.079)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.796
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.75
SUFF++ for r=0.3 class 0.0 = 0.731 +- 0.276 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.3 class 1.0 = 0.808 +- 0.276 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.3 all KL = 0.68 +- 0.276 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.3 all L1 = 0.771 +- 0.190 (in-sample avg dev_std = 0.492)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.786 +- 0.253 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 1.0 = 0.86 +- 0.253 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all KL = 0.756 +- 0.253 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all L1 = 0.825 +- 0.185 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.865
SUFF++ for r=0.9 class 0.0 = 0.911 +- 0.124 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 class 1.0 = 0.951 +- 0.124 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 all KL = 0.927 +- 0.124 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 all L1 = 0.932 +- 0.105 (in-sample avg dev_std = 0.249)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.766
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.71
SUFF++ for r=0.3 class 0.0 = 0.654 +- 0.292 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 class 1.0 = 0.817 +- 0.292 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all KL = 0.642 +- 0.292 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all L1 = 0.738 +- 0.216 (in-sample avg dev_std = 0.503)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.781
SUFF++ for r=0.6 class 0.0 = 0.787 +- 0.250 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.250 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all KL = 0.79 +- 0.250 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all L1 = 0.843 +- 0.190 (in-sample avg dev_std = 0.374)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0.0 = 0.927 +- 0.107 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 1.0 = 0.963 +- 0.107 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all KL = 0.948 +- 0.107 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.104 (in-sample avg dev_std = 0.207)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.985
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 273
Effective ratio: 0.663 +- 0.263
Model Accuracy over intervened graphs for r=0.6 =  0.988
NEC for r=0.6 class 0.0 = 0.079 +- 0.144 (in-sample avg dev_std = 0.125)
NEC for r=0.6 class 1.0 = 0.017 +- 0.144 (in-sample avg dev_std = 0.125)
NEC for r=0.6 all KL = 0.05 +- 0.144 (in-sample avg dev_std = 0.125)
NEC for r=0.6 all L1 = 0.044 +- 0.118 (in-sample avg dev_std = 0.125)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 273
Effective ratio: 0.877 +- 0.301
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 0.0 = 0.022 +- 0.081 (in-sample avg dev_std = 0.075)
NEC for r=0.9 class 1.0 = 0.002 +- 0.081 (in-sample avg dev_std = 0.075)
NEC for r=0.9 all KL = 0.012 +- 0.081 (in-sample avg dev_std = 0.075)
NEC for r=0.9 all L1 = 0.011 +- 0.057 (in-sample avg dev_std = 0.075)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 273
Effective ratio: 0.896 +- 0.305
Model Accuracy over intervened graphs for r=1.0 =  0.996
NEC for r=1.0 class 0.0 = 0.022 +- 0.081 (in-sample avg dev_std = 0.075)
NEC for r=1.0 class 1.0 = 0.002 +- 0.081 (in-sample avg dev_std = 0.075)
NEC for r=1.0 all KL = 0.012 +- 0.081 (in-sample avg dev_std = 0.075)
NEC for r=1.0 all L1 = 0.011 +- 0.057 (in-sample avg dev_std = 0.075)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.852
NEC for r=0.6 class 0.0 = 0.138 +- 0.231 (in-sample avg dev_std = 0.208)
NEC for r=0.6 class 1.0 = 0.066 +- 0.231 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all KL = 0.096 +- 0.231 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all L1 = 0.096 +- 0.192 (in-sample avg dev_std = 0.208)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.87
NEC for r=0.9 class 0.0 = 0.052 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=0.9 class 1.0 = 0.02 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all KL = 0.023 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all L1 = 0.034 +- 0.107 (in-sample avg dev_std = 0.082)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.87
NEC for r=1.0 class 0.0 = 0.052 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=1.0 class 1.0 = 0.02 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all KL = 0.023 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all L1 = 0.034 +- 0.107 (in-sample avg dev_std = 0.082)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.796
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.798
NEC for r=0.3 class 0.0 = 0.187 +- 0.247 (in-sample avg dev_std = 0.237)
NEC for r=0.3 class 1.0 = 0.112 +- 0.247 (in-sample avg dev_std = 0.237)
NEC for r=0.3 all KL = 0.139 +- 0.247 (in-sample avg dev_std = 0.237)
NEC for r=0.3 all L1 = 0.148 +- 0.221 (in-sample avg dev_std = 0.237)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.852
NEC for r=0.6 class 0.0 = 0.098 +- 0.151 (in-sample avg dev_std = 0.167)
NEC for r=0.6 class 1.0 = 0.055 +- 0.151 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all KL = 0.059 +- 0.151 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all L1 = 0.076 +- 0.152 (in-sample avg dev_std = 0.167)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.879
NEC for r=0.9 class 0.0 = 0.03 +- 0.065 (in-sample avg dev_std = 0.072)
NEC for r=0.9 class 1.0 = 0.016 +- 0.065 (in-sample avg dev_std = 0.072)
NEC for r=0.9 all KL = 0.012 +- 0.065 (in-sample avg dev_std = 0.072)
NEC for r=0.9 all L1 = 0.023 +- 0.082 (in-sample avg dev_std = 0.072)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.882
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.879
NEC for r=1.0 class 0.0 = 0.029 +- 0.064 (in-sample avg dev_std = 0.074)
NEC for r=1.0 class 1.0 = 0.013 +- 0.064 (in-sample avg dev_std = 0.074)
NEC for r=1.0 all KL = 0.011 +- 0.064 (in-sample avg dev_std = 0.074)
NEC for r=1.0 all L1 = 0.021 +- 0.078 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.763
NEC for r=0.3 class 0.0 = 0.259 +- 0.265 (in-sample avg dev_std = 0.281)
NEC for r=0.3 class 1.0 = 0.121 +- 0.265 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all KL = 0.184 +- 0.265 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all L1 = 0.188 +- 0.241 (in-sample avg dev_std = 0.281)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.806
NEC for r=0.6 class 0.0 = 0.118 +- 0.154 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 1.0 = 0.062 +- 0.154 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all KL = 0.07 +- 0.154 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all L1 = 0.089 +- 0.168 (in-sample avg dev_std = 0.190)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.828
NEC for r=0.9 class 0.0 = 0.041 +- 0.055 (in-sample avg dev_std = 0.082)
NEC for r=0.9 class 1.0 = 0.017 +- 0.055 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all KL = 0.014 +- 0.055 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all L1 = 0.029 +- 0.080 (in-sample avg dev_std = 0.082)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0.0 = 0.034 +- 0.051 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.015 +- 0.051 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.011 +- 0.051 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.024 +- 0.072 (in-sample avg dev_std = 0.080)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.585, 0.993, 1.0], 'all_L1': [0.808, 0.996, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.64, 0.993, 1.0], 'all_L1': [0.821, 0.995, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.647, 0.994, 1.0], 'all_L1': [0.848, 0.997, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.993, 1.0], 'all_L1': [0.842, 0.995, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.674, 0.991, 1.0], 'all_L1': [0.833, 0.991, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.064, 0.011, 0.011], 'all_L1': [0.049, 0.006, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.013, 0.013], 'all_L1': [0.051, 0.007, 0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.011, 0.011], 'all_L1': [0.037, 0.006, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.014, 0.014], 'all_L1': [0.047, 0.007, 0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.012, 0.012], 'all_L1': [0.044, 0.011, 0.011]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.615, 0.982, 1.0], 'all_L1': [0.781, 0.976, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.649, 0.973, 1.0], 'all_L1': [0.803, 0.966, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.984, 1.0], 'all_L1': [0.821, 0.98, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.666, 0.976, 1.0], 'all_L1': [0.811, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.716, 0.981, 1.0], 'all_L1': [0.816, 0.968, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.114, 0.024, 0.024], 'all_L1': [0.101, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.028, 0.028], 'all_L1': [0.098, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.084, 0.021, 0.021], 'all_L1': [0.074, 0.023, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.128, 0.029, 0.029], 'all_L1': [0.105, 0.031, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.023, 0.023], 'all_L1': [0.096, 0.034, 0.034]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.695, 0.733, 0.917, 1.0], 'all_L1': [0.802, 0.831, 0.936, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.761, 0.917, 1.0], 'all_L1': [0.791, 0.84, 0.934, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.729, 0.919, 1.0], 'all_L1': [0.781, 0.845, 0.943, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.748, 0.911, 1.0], 'all_L1': [0.769, 0.846, 0.934, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.756, 0.927, 1.0], 'all_L1': [0.771, 0.825, 0.932, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.139, 0.082, 0.012, 0.011], 'all_L1': [0.123, 0.081, 0.019, 0.017]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.064, 0.012, 0.011], 'all_L1': [0.158, 0.073, 0.02, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.077, 0.014, 0.012], 'all_L1': [0.149, 0.071, 0.02, 0.017]}), defaultdict(<class 'list'>, {'all_KL': [0.167, 0.081, 0.015, 0.012], 'all_L1': [0.152, 0.076, 0.02, 0.018]}), defaultdict(<class 'list'>, {'all_KL': [0.139, 0.059, 0.012, 0.011], 'all_L1': [0.148, 0.076, 0.023, 0.021]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.701, 0.799, 0.943, 1.0], 'all_L1': [0.785, 0.855, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.671, 0.782, 0.932, 1.0], 'all_L1': [0.779, 0.845, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.606, 0.749, 0.932, 1.0], 'all_L1': [0.766, 0.844, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.629, 0.76, 0.945, 1.0], 'all_L1': [0.774, 0.854, 0.957, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.642, 0.79, 0.948, 1.0], 'all_L1': [0.738, 0.843, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.172, 0.07, 0.016, 0.016], 'all_L1': [0.163, 0.078, 0.031, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.085, 0.018, 0.014], 'all_L1': [0.156, 0.092, 0.03, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.171, 0.073, 0.015, 0.013], 'all_L1': [0.147, 0.076, 0.025, 0.022]}), defaultdict(<class 'list'>, {'all_KL': [0.17, 0.083, 0.019, 0.014], 'all_L1': [0.148, 0.078, 0.025, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.184, 0.07, 0.014, 0.011], 'all_L1': [0.188, 0.089, 0.029, 0.024]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.830 +- 0.014, 0.995 +- 0.002, 1.000 +- 0.000
suff++ class all_KL  =  0.642 +- 0.031, 0.993 +- 0.001, 1.000 +- 0.000
suff++_acc_int  =  0.896 +- 0.014, 0.997 +- 0.002
nec class all_L1  =  0.046 +- 0.005, 0.007 +- 0.002, 0.007 +- 0.002
nec class all_KL  =  0.060 +- 0.007, 0.012 +- 0.001, 0.012 +- 0.001
nec_acc_int  =  0.978 +- 0.006, 0.997 +- 0.001, 0.997 +- 0.001

Eval split id_val
suff++ class all_L1  =  0.806 +- 0.014, 0.972 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.661 +- 0.033, 0.979 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.817 +- 0.008, 0.885 +- 0.008
nec class all_L1  =  0.095 +- 0.011, 0.029 +- 0.004, 0.029 +- 0.004
nec class all_KL  =  0.107 +- 0.015, 0.025 +- 0.003, 0.025 +- 0.003
nec_acc_int  =  0.857 +- 0.004, 0.875 +- 0.005, 0.875 +- 0.005

Eval split val
suff++ class all_L1  =  0.783 +- 0.012, 0.837 +- 0.008, 0.936 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.667 +- 0.030, 0.745 +- 0.013, 0.918 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.755 +- 0.007, 0.821 +- 0.005, 0.873 +- 0.005
nec class all_L1  =  0.146 +- 0.012, 0.075 +- 0.003, 0.020 +- 0.001, 0.018 +- 0.001
nec class all_KL  =  0.158 +- 0.016, 0.073 +- 0.009, 0.013 +- 0.001, 0.011 +- 0.000
nec_acc_int  =  0.794 +- 0.007, 0.858 +- 0.006, 0.881 +- 0.004, 0.881 +- 0.004

Eval split test
suff++ class all_L1  =  0.768 +- 0.016, 0.848 +- 0.005, 0.946 +- 0.006, 1.000 +- 0.000
suff++ class all_KL  =  0.650 +- 0.033, 0.776 +- 0.019, 0.940 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.727 +- 0.009, 0.786 +- 0.005, 0.824 +- 0.007
nec class all_L1  =  0.160 +- 0.015, 0.083 +- 0.007, 0.028 +- 0.003, 0.024 +- 0.003
nec class all_KL  =  0.172 +- 0.006, 0.076 +- 0.006, 0.016 +- 0.002, 0.014 +- 0.002
nec_acc_int  =  0.766 +- 0.010, 0.810 +- 0.004, 0.829 +- 0.008, 0.830 +- 0.010


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.438 +- 0.006, 0.501 +- 0.000, 0.504 +- 0.001
Faith. Armon (L1)= 		  =  0.086 +- 0.009, 0.015 +- 0.004, 0.015 +- 0.004
Faith. GMean (L1)= 	  =  0.194 +- 0.010, 0.085 +- 0.010, 0.085 +- 0.010
Faith. Aritm (KL)= 		  =  0.351 +- 0.015, 0.502 +- 0.001, 0.506 +- 0.001
Faith. Armon (KL)= 		  =  0.110 +- 0.012, 0.024 +- 0.002, 0.024 +- 0.002
Faith. GMean (KL)= 	  =  0.196 +- 0.011, 0.110 +- 0.005, 0.110 +- 0.005

Eval split id_val
Faith. Aritm (L1)= 		  =  0.451 +- 0.006, 0.501 +- 0.002, 0.515 +- 0.002
Faith. Armon (L1)= 		  =  0.169 +- 0.017, 0.056 +- 0.007, 0.056 +- 0.007
Faith. GMean (L1)= 	  =  0.276 +- 0.015, 0.168 +- 0.010, 0.170 +- 0.011
Faith. Aritm (KL)= 		  =  0.384 +- 0.016, 0.502 +- 0.001, 0.512 +- 0.002
Faith. Armon (KL)= 		  =  0.184 +- 0.022, 0.049 +- 0.006, 0.049 +- 0.006
Faith. GMean (KL)= 	  =  0.265 +- 0.018, 0.156 +- 0.009, 0.158 +- 0.010

Eval split val
Faith. Aritm (L1)= 		  =  0.464 +- 0.005, 0.456 +- 0.003, 0.478 +- 0.002, 0.509 +- 0.001
Faith. Armon (L1)= 		  =  0.246 +- 0.017, 0.138 +- 0.006, 0.040 +- 0.003, 0.036 +- 0.003
Faith. GMean (L1)= 	  =  0.338 +- 0.013, 0.251 +- 0.005, 0.138 +- 0.004, 0.136 +- 0.005
Faith. Aritm (KL)= 		  =  0.412 +- 0.011, 0.409 +- 0.004, 0.466 +- 0.002, 0.506 +- 0.000
Faith. Armon (KL)= 		  =  0.254 +- 0.019, 0.132 +- 0.015, 0.026 +- 0.002, 0.023 +- 0.001
Faith. GMean (KL)= 	  =  0.324 +- 0.012, 0.232 +- 0.014, 0.109 +- 0.005, 0.107 +- 0.002

Eval split test
Faith. Aritm (L1)= 		  =  0.464 +- 0.006, 0.465 +- 0.003, 0.487 +- 0.002, 0.512 +- 0.002
Faith. Armon (L1)= 		  =  0.265 +- 0.019, 0.150 +- 0.011, 0.054 +- 0.005, 0.046 +- 0.006
Faith. GMean (L1)= 	  =  0.351 +- 0.013, 0.264 +- 0.010, 0.163 +- 0.007, 0.153 +- 0.010
Faith. Aritm (KL)= 		  =  0.411 +- 0.016, 0.426 +- 0.009, 0.478 +- 0.003, 0.507 +- 0.001
Faith. Armon (KL)= 		  =  0.272 +- 0.008, 0.139 +- 0.011, 0.032 +- 0.004, 0.027 +- 0.003
Faith. GMean (KL)= 	  =  0.335 +- 0.010, 0.243 +- 0.010, 0.124 +- 0.007, 0.116 +- 0.007
Computed for split load_split = id



Completed in  0:19:36.990758  for LECIvGIN GOODSST2/length



DONE LECI GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:19:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:05 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:08 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:10 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:19:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8247
Train Loss: 0.4478
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.9793
ID Test ACCURACY: 0.6913
ID Test Loss: 0.9987
OOD Validation ACCURACY: 0.6347
OOD Validation Loss: 1.2582
OOD Test ACCURACY: 0.5896
OOD Test Loss: 1.8350

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8525
Train Loss: 0.3804
ID Validation ACCURACY: 0.6787
ID Validation Loss: 1.0172
ID Test ACCURACY: 0.6787
ID Test Loss: 1.0574
OOD Validation ACCURACY: 0.6381
OOD Validation Loss: 1.2694
OOD Test ACCURACY: 0.6074
OOD Test Loss: 1.7435

[0m[1;37mINFO[0m: [1mChartInfo 0.6913 0.5896 0.6787 0.6074 0.6787 0.6381[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.741
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 640
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.669
SUFF++ for r=0.3 class 0 = 0.805 +- 0.122 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 1 = 0.812 +- 0.122 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 2 = 0.781 +- 0.122 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 all KL = 0.881 +- 0.122 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.312)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0 = 0.885 +- 0.055 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 class 1 = 0.885 +- 0.055 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 class 2 = 0.902 +- 0.055 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 all KL = 0.963 +- 0.055 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 all L1 = 0.889 +- 0.097 (in-sample avg dev_std = 0.154)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.825
SUFF++ for r=0.9 class 0 = 0.946 +- 0.027 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 class 1 = 0.952 +- 0.027 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 class 2 = 0.955 +- 0.027 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all KL = 0.987 +- 0.027 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all L1 = 0.951 +- 0.053 (in-sample avg dev_std = 0.108)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 435
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0 = 0.791 +- 0.124 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 1 = 0.812 +- 0.124 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 2 = 0.777 +- 0.124 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 all KL = 0.881 +- 0.124 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.124 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.655
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0 = 0.88 +- 0.066 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 class 1 = 0.879 +- 0.066 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 class 2 = 0.873 +- 0.066 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 all KL = 0.956 +- 0.066 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 all L1 = 0.878 +- 0.103 (in-sample avg dev_std = 0.168)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.68
SUFF++ for r=0.9 class 0 = 0.953 +- 0.021 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 class 1 = 0.953 +- 0.021 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 class 2 = 0.945 +- 0.021 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 all KL = 0.989 +- 0.021 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 all L1 = 0.951 +- 0.050 (in-sample avg dev_std = 0.097)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 772
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.571
SUFF++ for r=0.3 class 0 = 0.759 +- 0.134 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 class 1 = 0.777 +- 0.134 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 class 2 = 0.761 +- 0.134 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 all KL = 0.86 +- 0.134 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 all L1 = 0.769 +- 0.128 (in-sample avg dev_std = 0.325)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.603
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.6
SUFF++ for r=0.6 class 0 = 0.88 +- 0.050 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 1 = 0.885 +- 0.050 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 2 = 0.89 +- 0.050 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all KL = 0.969 +- 0.050 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all L1 = 0.885 +- 0.095 (in-sample avg dev_std = 0.108)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.616
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.62
SUFF++ for r=0.9 class 0 = 0.957 +- 0.013 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.013 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 class 2 = 0.958 +- 0.013 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 all KL = 0.994 +- 0.013 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 all L1 = 0.96 +- 0.043 (in-sample avg dev_std = 0.072)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.563
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.541
SUFF++ for r=0.3 class 0 = 0.767 +- 0.152 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 1 = 0.77 +- 0.152 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 2 = 0.738 +- 0.152 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all KL = 0.835 +- 0.152 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all L1 = 0.761 +- 0.128 (in-sample avg dev_std = 0.362)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.576
SUFF++ for r=0.6 class 0 = 0.893 +- 0.064 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.6 class 1 = 0.878 +- 0.064 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.6 class 2 = 0.881 +- 0.064 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.6 all KL = 0.962 +- 0.064 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.6 all L1 = 0.883 +- 0.100 (in-sample avg dev_std = 0.131)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.589
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.59
SUFF++ for r=0.9 class 0 = 0.972 +- 0.010 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 1 = 0.966 +- 0.010 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 2 = 0.959 +- 0.010 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all L1 = 0.966 +- 0.037 (in-sample avg dev_std = 0.057)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.743
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.721
NEC for r=0.3 class 0 = 0.134 +- 0.076 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1 = 0.113 +- 0.076 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 2 = 0.122 +- 0.076 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.04 +- 0.076 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.121 +- 0.106 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.791
NEC for r=0.6 class 0 = 0.102 +- 0.061 (in-sample avg dev_std = 0.123)
NEC for r=0.6 class 1 = 0.09 +- 0.061 (in-sample avg dev_std = 0.123)
NEC for r=0.6 class 2 = 0.076 +- 0.061 (in-sample avg dev_std = 0.123)
NEC for r=0.6 all KL = 0.026 +- 0.061 (in-sample avg dev_std = 0.123)
NEC for r=0.6 all L1 = 0.089 +- 0.093 (in-sample avg dev_std = 0.123)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.819
NEC for r=0.9 class 0 = 0.099 +- 0.058 (in-sample avg dev_std = 0.103)
NEC for r=0.9 class 1 = 0.074 +- 0.058 (in-sample avg dev_std = 0.103)
NEC for r=0.9 class 2 = 0.074 +- 0.058 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all KL = 0.024 +- 0.058 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all L1 = 0.08 +- 0.086 (in-sample avg dev_std = 0.103)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.831
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.819
NEC for r=1.0 class 0 = 0.095 +- 0.068 (in-sample avg dev_std = 0.103)
NEC for r=1.0 class 1 = 0.074 +- 0.068 (in-sample avg dev_std = 0.103)
NEC for r=1.0 class 2 = 0.071 +- 0.068 (in-sample avg dev_std = 0.103)
NEC for r=1.0 all KL = 0.025 +- 0.068 (in-sample avg dev_std = 0.103)
NEC for r=1.0 all L1 = 0.078 +- 0.087 (in-sample avg dev_std = 0.103)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.611
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0 = 0.141 +- 0.081 (in-sample avg dev_std = 0.136)
NEC for r=0.3 class 1 = 0.115 +- 0.081 (in-sample avg dev_std = 0.136)
NEC for r=0.3 class 2 = 0.115 +- 0.081 (in-sample avg dev_std = 0.136)
NEC for r=0.3 all KL = 0.038 +- 0.081 (in-sample avg dev_std = 0.136)
NEC for r=0.3 all L1 = 0.121 +- 0.106 (in-sample avg dev_std = 0.136)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.655
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.64
NEC for r=0.6 class 0 = 0.12 +- 0.084 (in-sample avg dev_std = 0.139)
NEC for r=0.6 class 1 = 0.093 +- 0.084 (in-sample avg dev_std = 0.139)
NEC for r=0.6 class 2 = 0.101 +- 0.084 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all KL = 0.034 +- 0.084 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all L1 = 0.102 +- 0.102 (in-sample avg dev_std = 0.139)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.685
NEC for r=0.9 class 0 = 0.104 +- 0.072 (in-sample avg dev_std = 0.108)
NEC for r=0.9 class 1 = 0.08 +- 0.072 (in-sample avg dev_std = 0.108)
NEC for r=0.9 class 2 = 0.082 +- 0.072 (in-sample avg dev_std = 0.108)
NEC for r=0.9 all KL = 0.027 +- 0.072 (in-sample avg dev_std = 0.108)
NEC for r=0.9 all L1 = 0.086 +- 0.093 (in-sample avg dev_std = 0.108)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.697
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.677
NEC for r=1.0 class 0 = 0.115 +- 0.074 (in-sample avg dev_std = 0.116)
NEC for r=1.0 class 1 = 0.086 +- 0.074 (in-sample avg dev_std = 0.116)
NEC for r=1.0 class 2 = 0.087 +- 0.074 (in-sample avg dev_std = 0.116)
NEC for r=1.0 all KL = 0.03 +- 0.074 (in-sample avg dev_std = 0.116)
NEC for r=1.0 all L1 = 0.094 +- 0.098 (in-sample avg dev_std = 0.116)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.588
NEC for r=0.3 class 0 = 0.16 +- 0.072 (in-sample avg dev_std = 0.156)
NEC for r=0.3 class 1 = 0.138 +- 0.072 (in-sample avg dev_std = 0.156)
NEC for r=0.3 class 2 = 0.157 +- 0.072 (in-sample avg dev_std = 0.156)
NEC for r=0.3 all KL = 0.047 +- 0.072 (in-sample avg dev_std = 0.156)
NEC for r=0.3 all L1 = 0.147 +- 0.111 (in-sample avg dev_std = 0.156)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.603
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.603
NEC for r=0.6 class 0 = 0.115 +- 0.057 (in-sample avg dev_std = 0.125)
NEC for r=0.6 class 1 = 0.113 +- 0.057 (in-sample avg dev_std = 0.125)
NEC for r=0.6 class 2 = 0.118 +- 0.057 (in-sample avg dev_std = 0.125)
NEC for r=0.6 all KL = 0.034 +- 0.057 (in-sample avg dev_std = 0.125)
NEC for r=0.6 all L1 = 0.115 +- 0.098 (in-sample avg dev_std = 0.125)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.616
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.621
NEC for r=0.9 class 0 = 0.127 +- 0.063 (in-sample avg dev_std = 0.112)
NEC for r=0.9 class 1 = 0.106 +- 0.063 (in-sample avg dev_std = 0.112)
NEC for r=0.9 class 2 = 0.122 +- 0.063 (in-sample avg dev_std = 0.112)
NEC for r=0.9 all KL = 0.034 +- 0.063 (in-sample avg dev_std = 0.112)
NEC for r=0.9 all L1 = 0.115 +- 0.105 (in-sample avg dev_std = 0.112)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.627
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.626
NEC for r=1.0 class 0 = 0.137 +- 0.079 (in-sample avg dev_std = 0.116)
NEC for r=1.0 class 1 = 0.111 +- 0.079 (in-sample avg dev_std = 0.116)
NEC for r=1.0 class 2 = 0.132 +- 0.079 (in-sample avg dev_std = 0.116)
NEC for r=1.0 all KL = 0.04 +- 0.079 (in-sample avg dev_std = 0.116)
NEC for r=1.0 all L1 = 0.122 +- 0.118 (in-sample avg dev_std = 0.116)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.564
NEC for r=0.3 class 0 = 0.125 +- 0.069 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 1 = 0.146 +- 0.069 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 2 = 0.139 +- 0.069 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all KL = 0.044 +- 0.069 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all L1 = 0.139 +- 0.109 (in-sample avg dev_std = 0.145)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.569
NEC for r=0.6 class 0 = 0.096 +- 0.050 (in-sample avg dev_std = 0.124)
NEC for r=0.6 class 1 = 0.116 +- 0.050 (in-sample avg dev_std = 0.124)
NEC for r=0.6 class 2 = 0.113 +- 0.050 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all KL = 0.031 +- 0.050 (in-sample avg dev_std = 0.124)
NEC for r=0.6 all L1 = 0.11 +- 0.094 (in-sample avg dev_std = 0.124)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.589
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.59
NEC for r=0.9 class 0 = 0.099 +- 0.057 (in-sample avg dev_std = 0.112)
NEC for r=0.9 class 1 = 0.107 +- 0.057 (in-sample avg dev_std = 0.112)
NEC for r=0.9 class 2 = 0.126 +- 0.057 (in-sample avg dev_std = 0.112)
NEC for r=0.9 all KL = 0.033 +- 0.057 (in-sample avg dev_std = 0.112)
NEC for r=0.9 all L1 = 0.109 +- 0.102 (in-sample avg dev_std = 0.112)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.585
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.581
NEC for r=1.0 class 0 = 0.103 +- 0.076 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 1 = 0.107 +- 0.076 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 2 = 0.127 +- 0.076 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all KL = 0.038 +- 0.076 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all L1 = 0.111 +- 0.109 (in-sample avg dev_std = 0.112)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:24:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:46 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:48 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:51 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:24:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9425
Train Loss: 0.1667
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.2093
ID Test ACCURACY: 0.6787
ID Test Loss: 1.3015
OOD Validation ACCURACY: 0.6179
OOD Validation Loss: 1.6746
OOD Test ACCURACY: 0.5738
OOD Test Loss: 2.2987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 8...
[0m[1;37mINFO[0m: [1mCheckpoint 8: 
-----------------------------------
Train ACCURACY: 0.7544
Train Loss: 0.6546
ID Validation ACCURACY: 0.6787
ID Validation Loss: 1.0050
ID Test ACCURACY: 0.6751
ID Test Loss: 0.9474
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 1.1678
OOD Test ACCURACY: 0.5848
OOD Test Loss: 1.4431

[0m[1;37mINFO[0m: [1mChartInfo 0.6787 0.5738 0.6751 0.5848 0.6787 0.6331[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.801
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 628
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.727
SUFF++ for r=0.3 class 0 = 0.753 +- 0.194 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 1 = 0.791 +- 0.194 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 2 = 0.761 +- 0.194 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all KL = 0.791 +- 0.194 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all L1 = 0.774 +- 0.148 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.858
SUFF++ for r=0.6 class 0 = 0.875 +- 0.110 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 class 1 = 0.895 +- 0.110 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 class 2 = 0.907 +- 0.110 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 all KL = 0.937 +- 0.110 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 all L1 = 0.893 +- 0.130 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.937
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.929
SUFF++ for r=0.9 class 0 = 0.96 +- 0.029 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 1 = 0.96 +- 0.029 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 2 = 0.969 +- 0.029 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all KL = 0.986 +- 0.029 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.058 (in-sample avg dev_std = 0.102)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.618
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 432
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.571
SUFF++ for r=0.3 class 0 = 0.771 +- 0.195 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 1 = 0.756 +- 0.195 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 2 = 0.764 +- 0.195 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all KL = 0.785 +- 0.195 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all L1 = 0.762 +- 0.163 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.641
SUFF++ for r=0.6 class 0 = 0.859 +- 0.115 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 class 1 = 0.872 +- 0.115 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 class 2 = 0.878 +- 0.115 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 all KL = 0.927 +- 0.115 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.6 all L1 = 0.87 +- 0.132 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.69
SUFF++ for r=0.9 class 0 = 0.944 +- 0.039 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 class 1 = 0.943 +- 0.039 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 class 2 = 0.946 +- 0.039 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 all KL = 0.98 +- 0.039 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 all L1 = 0.944 +- 0.071 (in-sample avg dev_std = 0.130)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.578
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 765
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.541
SUFF++ for r=0.3 class 0 = 0.716 +- 0.216 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 class 1 = 0.737 +- 0.216 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 class 2 = 0.7 +- 0.216 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 all KL = 0.75 +- 0.216 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 all L1 = 0.724 +- 0.167 (in-sample avg dev_std = 0.427)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.592
SUFF++ for r=0.6 class 0 = 0.826 +- 0.142 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 class 1 = 0.857 +- 0.142 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 class 2 = 0.834 +- 0.142 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 all KL = 0.911 +- 0.142 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.6 all L1 = 0.844 +- 0.158 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.619
SUFF++ for r=0.9 class 0 = 0.961 +- 0.022 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 class 1 = 0.951 +- 0.022 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 class 2 = 0.949 +- 0.022 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 all KL = 0.988 +- 0.022 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 all L1 = 0.953 +- 0.060 (in-sample avg dev_std = 0.093)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.51
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 778
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.493
SUFF++ for r=0.3 class 0 = 0.714 +- 0.230 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 1 = 0.725 +- 0.230 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 2 = 0.707 +- 0.230 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all KL = 0.707 +- 0.230 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all L1 = 0.718 +- 0.162 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.534
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.538
SUFF++ for r=0.6 class 0 = 0.865 +- 0.144 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 1 = 0.849 +- 0.144 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 2 = 0.849 +- 0.144 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all KL = 0.905 +- 0.144 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.153 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.561
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.555
SUFF++ for r=0.9 class 0 = 0.953 +- 0.024 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 class 1 = 0.952 +- 0.024 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 class 2 = 0.958 +- 0.024 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 all KL = 0.989 +- 0.024 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.063 (in-sample avg dev_std = 0.091)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.802
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.797
NEC for r=0.3 class 0 = 0.15 +- 0.109 (in-sample avg dev_std = 0.170)
NEC for r=0.3 class 1 = 0.125 +- 0.109 (in-sample avg dev_std = 0.170)
NEC for r=0.3 class 2 = 0.092 +- 0.109 (in-sample avg dev_std = 0.170)
NEC for r=0.3 all KL = 0.056 +- 0.109 (in-sample avg dev_std = 0.170)
NEC for r=0.3 all L1 = 0.122 +- 0.127 (in-sample avg dev_std = 0.170)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.869
NEC for r=0.6 class 0 = 0.104 +- 0.092 (in-sample avg dev_std = 0.148)
NEC for r=0.6 class 1 = 0.085 +- 0.092 (in-sample avg dev_std = 0.148)
NEC for r=0.6 class 2 = 0.059 +- 0.092 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all KL = 0.039 +- 0.092 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all L1 = 0.083 +- 0.118 (in-sample avg dev_std = 0.148)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.937
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.924
NEC for r=0.9 class 0 = 0.062 +- 0.076 (in-sample avg dev_std = 0.115)
NEC for r=0.9 class 1 = 0.07 +- 0.076 (in-sample avg dev_std = 0.115)
NEC for r=0.9 class 2 = 0.049 +- 0.076 (in-sample avg dev_std = 0.115)
NEC for r=0.9 all KL = 0.029 +- 0.076 (in-sample avg dev_std = 0.115)
NEC for r=0.9 all L1 = 0.062 +- 0.100 (in-sample avg dev_std = 0.115)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.926
NEC for r=1.0 class 0 = 0.063 +- 0.077 (in-sample avg dev_std = 0.115)
NEC for r=1.0 class 1 = 0.071 +- 0.077 (in-sample avg dev_std = 0.115)
NEC for r=1.0 class 2 = 0.053 +- 0.077 (in-sample avg dev_std = 0.115)
NEC for r=1.0 all KL = 0.032 +- 0.077 (in-sample avg dev_std = 0.115)
NEC for r=1.0 all L1 = 0.064 +- 0.106 (in-sample avg dev_std = 0.115)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.613
NEC for r=0.3 class 0 = 0.136 +- 0.115 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 1 = 0.142 +- 0.115 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 2 = 0.12 +- 0.115 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all KL = 0.061 +- 0.115 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all L1 = 0.134 +- 0.135 (in-sample avg dev_std = 0.185)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.654
NEC for r=0.6 class 0 = 0.112 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.6 class 1 = 0.107 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.6 class 2 = 0.1 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all KL = 0.043 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all L1 = 0.106 +- 0.123 (in-sample avg dev_std = 0.146)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.108 +- 0.107 (in-sample avg dev_std = 0.153)
NEC for r=0.9 class 1 = 0.1 +- 0.107 (in-sample avg dev_std = 0.153)
NEC for r=0.9 class 2 = 0.088 +- 0.107 (in-sample avg dev_std = 0.153)
NEC for r=0.9 all KL = 0.046 +- 0.107 (in-sample avg dev_std = 0.153)
NEC for r=0.9 all L1 = 0.099 +- 0.126 (in-sample avg dev_std = 0.153)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.701
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.679
NEC for r=1.0 class 0 = 0.099 +- 0.112 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 1 = 0.098 +- 0.112 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 2 = 0.098 +- 0.112 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all KL = 0.048 +- 0.112 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all L1 = 0.098 +- 0.126 (in-sample avg dev_std = 0.155)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.576
NEC for r=0.3 class 0 = 0.171 +- 0.124 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 1 = 0.176 +- 0.124 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 2 = 0.184 +- 0.124 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all KL = 0.089 +- 0.124 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all L1 = 0.176 +- 0.158 (in-sample avg dev_std = 0.205)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.605
NEC for r=0.6 class 0 = 0.154 +- 0.122 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 1 = 0.134 +- 0.122 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 2 = 0.149 +- 0.122 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all KL = 0.072 +- 0.122 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all L1 = 0.142 +- 0.151 (in-sample avg dev_std = 0.192)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.624
NEC for r=0.9 class 0 = 0.12 +- 0.114 (in-sample avg dev_std = 0.159)
NEC for r=0.9 class 1 = 0.123 +- 0.114 (in-sample avg dev_std = 0.159)
NEC for r=0.9 class 2 = 0.128 +- 0.114 (in-sample avg dev_std = 0.159)
NEC for r=0.9 all KL = 0.061 +- 0.114 (in-sample avg dev_std = 0.159)
NEC for r=0.9 all L1 = 0.123 +- 0.140 (in-sample avg dev_std = 0.159)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.62
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.627
NEC for r=1.0 class 0 = 0.125 +- 0.105 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 1 = 0.119 +- 0.105 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 2 = 0.126 +- 0.105 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all KL = 0.058 +- 0.105 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all L1 = 0.122 +- 0.133 (in-sample avg dev_std = 0.155)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.516
NEC for r=0.3 class 0 = 0.168 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1 = 0.156 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 2 = 0.152 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.079 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.158 +- 0.152 (in-sample avg dev_std = 0.195)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.534
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.533
NEC for r=0.6 class 0 = 0.118 +- 0.105 (in-sample avg dev_std = 0.176)
NEC for r=0.6 class 1 = 0.133 +- 0.105 (in-sample avg dev_std = 0.176)
NEC for r=0.6 class 2 = 0.123 +- 0.105 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all KL = 0.062 +- 0.105 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all L1 = 0.126 +- 0.141 (in-sample avg dev_std = 0.176)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.561
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.552
NEC for r=0.9 class 0 = 0.116 +- 0.106 (in-sample avg dev_std = 0.157)
NEC for r=0.9 class 1 = 0.117 +- 0.106 (in-sample avg dev_std = 0.157)
NEC for r=0.9 class 2 = 0.127 +- 0.106 (in-sample avg dev_std = 0.157)
NEC for r=0.9 all KL = 0.055 +- 0.106 (in-sample avg dev_std = 0.157)
NEC for r=0.9 all L1 = 0.119 +- 0.142 (in-sample avg dev_std = 0.157)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.569
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.561
NEC for r=1.0 class 0 = 0.116 +- 0.113 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 1 = 0.12 +- 0.113 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 2 = 0.133 +- 0.113 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all KL = 0.06 +- 0.113 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all L1 = 0.122 +- 0.143 (in-sample avg dev_std = 0.154)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:30:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:24 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:26 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:27 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:27 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:30 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:30:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8552
Train Loss: 0.3957
ID Validation ACCURACY: 0.7184
ID Validation Loss: 0.9655
ID Test ACCURACY: 0.6805
ID Test Loss: 1.0729
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 1.4058
OOD Test ACCURACY: 0.5875
OOD Test Loss: 1.9096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8552
Train Loss: 0.3957
ID Validation ACCURACY: 0.7184
ID Validation Loss: 0.9655
ID Test ACCURACY: 0.6805
ID Test Loss: 1.0729
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 1.4058
OOD Test ACCURACY: 0.5875
OOD Test Loss: 1.9096

[0m[1;37mINFO[0m: [1mChartInfo 0.6805 0.5875 0.6805 0.5875 0.7184 0.6342[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 649
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.707
SUFF++ for r=0.3 class 0 = 0.817 +- 0.112 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 1 = 0.843 +- 0.112 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 2 = 0.772 +- 0.112 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all KL = 0.896 +- 0.112 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all L1 = 0.819 +- 0.123 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.792
SUFF++ for r=0.6 class 0 = 0.897 +- 0.060 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.6 class 1 = 0.925 +- 0.060 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.6 class 2 = 0.866 +- 0.060 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.6 all KL = 0.965 +- 0.060 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.6 all L1 = 0.903 +- 0.099 (in-sample avg dev_std = 0.146)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.835
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.831
SUFF++ for r=0.9 class 0 = 0.959 +- 0.018 (in-sample avg dev_std = 0.090)
SUFF++ for r=0.9 class 1 = 0.971 +- 0.018 (in-sample avg dev_std = 0.090)
SUFF++ for r=0.9 class 2 = 0.946 +- 0.018 (in-sample avg dev_std = 0.090)
SUFF++ for r=0.9 all KL = 0.991 +- 0.018 (in-sample avg dev_std = 0.090)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.048 (in-sample avg dev_std = 0.090)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.662
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 420
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.63
SUFF++ for r=0.3 class 0 = 0.808 +- 0.104 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 1 = 0.84 +- 0.104 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 2 = 0.776 +- 0.104 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 all KL = 0.898 +- 0.104 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.116 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.67
SUFF++ for r=0.6 class 0 = 0.882 +- 0.070 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.6 class 1 = 0.909 +- 0.070 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.6 class 2 = 0.877 +- 0.070 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.6 all KL = 0.96 +- 0.070 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.105 (in-sample avg dev_std = 0.158)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.697
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.698
SUFF++ for r=0.9 class 0 = 0.954 +- 0.020 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 class 1 = 0.963 +- 0.020 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 class 2 = 0.947 +- 0.020 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 all KL = 0.989 +- 0.020 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 all L1 = 0.956 +- 0.051 (in-sample avg dev_std = 0.096)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.613
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 762
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.799 +- 0.123 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 class 1 = 0.813 +- 0.123 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 class 2 = 0.778 +- 0.123 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 all KL = 0.884 +- 0.123 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.130 (in-sample avg dev_std = 0.298)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0 = 0.879 +- 0.052 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.6 class 1 = 0.906 +- 0.052 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.6 class 2 = 0.876 +- 0.052 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.6 all KL = 0.968 +- 0.052 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.6 all L1 = 0.893 +- 0.103 (in-sample avg dev_std = 0.117)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.633
SUFF++ for r=0.9 class 0 = 0.965 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 1 = 0.966 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 2 = 0.961 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all KL = 0.994 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all L1 = 0.965 +- 0.045 (in-sample avg dev_std = 0.070)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 779
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.551
SUFF++ for r=0.3 class 0 = 0.779 +- 0.138 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 class 1 = 0.802 +- 0.138 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 class 2 = 0.776 +- 0.138 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all KL = 0.864 +- 0.138 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all L1 = 0.79 +- 0.134 (in-sample avg dev_std = 0.333)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.586
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.585
SUFF++ for r=0.6 class 0 = 0.877 +- 0.065 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 class 1 = 0.891 +- 0.065 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 class 2 = 0.887 +- 0.065 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 all KL = 0.96 +- 0.065 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 all L1 = 0.886 +- 0.114 (in-sample avg dev_std = 0.140)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.59
SUFF++ for r=0.9 class 0 = 0.968 +- 0.014 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 class 1 = 0.963 +- 0.014 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 class 2 = 0.955 +- 0.014 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 all KL = 0.994 +- 0.014 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.049 (in-sample avg dev_std = 0.069)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.759
NEC for r=0.3 class 0 = 0.107 +- 0.061 (in-sample avg dev_std = 0.128)
NEC for r=0.3 class 1 = 0.087 +- 0.061 (in-sample avg dev_std = 0.128)
NEC for r=0.3 class 2 = 0.133 +- 0.061 (in-sample avg dev_std = 0.128)
NEC for r=0.3 all KL = 0.03 +- 0.061 (in-sample avg dev_std = 0.128)
NEC for r=0.3 all L1 = 0.104 +- 0.098 (in-sample avg dev_std = 0.128)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.808
NEC for r=0.6 class 0 = 0.085 +- 0.056 (in-sample avg dev_std = 0.114)
NEC for r=0.6 class 1 = 0.062 +- 0.056 (in-sample avg dev_std = 0.114)
NEC for r=0.6 class 2 = 0.104 +- 0.056 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all KL = 0.025 +- 0.056 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all L1 = 0.079 +- 0.090 (in-sample avg dev_std = 0.114)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.836
NEC for r=0.9 class 0 = 0.075 +- 0.054 (in-sample avg dev_std = 0.102)
NEC for r=0.9 class 1 = 0.056 +- 0.054 (in-sample avg dev_std = 0.102)
NEC for r=0.9 class 2 = 0.09 +- 0.054 (in-sample avg dev_std = 0.102)
NEC for r=0.9 all KL = 0.023 +- 0.054 (in-sample avg dev_std = 0.102)
NEC for r=0.9 all L1 = 0.069 +- 0.092 (in-sample avg dev_std = 0.102)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.846
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.84
NEC for r=1.0 class 0 = 0.078 +- 0.068 (in-sample avg dev_std = 0.114)
NEC for r=1.0 class 1 = 0.058 +- 0.068 (in-sample avg dev_std = 0.114)
NEC for r=1.0 class 2 = 0.095 +- 0.068 (in-sample avg dev_std = 0.114)
NEC for r=1.0 all KL = 0.027 +- 0.068 (in-sample avg dev_std = 0.114)
NEC for r=1.0 all L1 = 0.072 +- 0.100 (in-sample avg dev_std = 0.114)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.662
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.662
NEC for r=0.3 class 0 = 0.134 +- 0.063 (in-sample avg dev_std = 0.138)
NEC for r=0.3 class 1 = 0.093 +- 0.063 (in-sample avg dev_std = 0.138)
NEC for r=0.3 class 2 = 0.133 +- 0.063 (in-sample avg dev_std = 0.138)
NEC for r=0.3 all KL = 0.033 +- 0.063 (in-sample avg dev_std = 0.138)
NEC for r=0.3 all L1 = 0.114 +- 0.099 (in-sample avg dev_std = 0.138)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.672
NEC for r=0.6 class 0 = 0.107 +- 0.071 (in-sample avg dev_std = 0.131)
NEC for r=0.6 class 1 = 0.075 +- 0.071 (in-sample avg dev_std = 0.131)
NEC for r=0.6 class 2 = 0.096 +- 0.071 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all KL = 0.03 +- 0.071 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all L1 = 0.089 +- 0.100 (in-sample avg dev_std = 0.131)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0 = 0.103 +- 0.069 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 1 = 0.077 +- 0.069 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 2 = 0.09 +- 0.069 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all KL = 0.031 +- 0.069 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all L1 = 0.087 +- 0.106 (in-sample avg dev_std = 0.127)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.715
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.702
NEC for r=1.0 class 0 = 0.103 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 1 = 0.085 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 2 = 0.093 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all KL = 0.036 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all L1 = 0.092 +- 0.112 (in-sample avg dev_std = 0.136)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.614
NEC for r=0.3 class 0 = 0.144 +- 0.085 (in-sample avg dev_std = 0.156)
NEC for r=0.3 class 1 = 0.125 +- 0.085 (in-sample avg dev_std = 0.156)
NEC for r=0.3 class 2 = 0.152 +- 0.085 (in-sample avg dev_std = 0.156)
NEC for r=0.3 all KL = 0.049 +- 0.085 (in-sample avg dev_std = 0.156)
NEC for r=0.3 all L1 = 0.136 +- 0.122 (in-sample avg dev_std = 0.156)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.63
NEC for r=0.6 class 0 = 0.123 +- 0.067 (in-sample avg dev_std = 0.139)
NEC for r=0.6 class 1 = 0.106 +- 0.067 (in-sample avg dev_std = 0.139)
NEC for r=0.6 class 2 = 0.126 +- 0.067 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all KL = 0.039 +- 0.067 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all L1 = 0.114 +- 0.116 (in-sample avg dev_std = 0.139)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.629
NEC for r=0.9 class 0 = 0.118 +- 0.079 (in-sample avg dev_std = 0.136)
NEC for r=0.9 class 1 = 0.103 +- 0.079 (in-sample avg dev_std = 0.136)
NEC for r=0.9 class 2 = 0.111 +- 0.079 (in-sample avg dev_std = 0.136)
NEC for r=0.9 all KL = 0.041 +- 0.079 (in-sample avg dev_std = 0.136)
NEC for r=0.9 all L1 = 0.108 +- 0.116 (in-sample avg dev_std = 0.136)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.639
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.632
NEC for r=1.0 class 0 = 0.116 +- 0.078 (in-sample avg dev_std = 0.126)
NEC for r=1.0 class 1 = 0.096 +- 0.078 (in-sample avg dev_std = 0.126)
NEC for r=1.0 class 2 = 0.105 +- 0.078 (in-sample avg dev_std = 0.126)
NEC for r=1.0 all KL = 0.04 +- 0.078 (in-sample avg dev_std = 0.126)
NEC for r=1.0 all L1 = 0.103 +- 0.119 (in-sample avg dev_std = 0.126)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.577
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.577
NEC for r=0.3 class 0 = 0.143 +- 0.086 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1 = 0.128 +- 0.086 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 2 = 0.156 +- 0.086 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.05 +- 0.086 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.139 +- 0.122 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.586
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.578
NEC for r=0.6 class 0 = 0.119 +- 0.075 (in-sample avg dev_std = 0.148)
NEC for r=0.6 class 1 = 0.112 +- 0.075 (in-sample avg dev_std = 0.148)
NEC for r=0.6 class 2 = 0.127 +- 0.075 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all KL = 0.043 +- 0.075 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all L1 = 0.117 +- 0.116 (in-sample avg dev_std = 0.148)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.105 +- 0.082 (in-sample avg dev_std = 0.135)
NEC for r=0.9 class 1 = 0.102 +- 0.082 (in-sample avg dev_std = 0.135)
NEC for r=0.9 class 2 = 0.12 +- 0.082 (in-sample avg dev_std = 0.135)
NEC for r=0.9 all KL = 0.042 +- 0.082 (in-sample avg dev_std = 0.135)
NEC for r=0.9 all L1 = 0.107 +- 0.121 (in-sample avg dev_std = 0.135)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.595
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.586
NEC for r=1.0 class 0 = 0.109 +- 0.091 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 1 = 0.105 +- 0.091 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 2 = 0.119 +- 0.091 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all KL = 0.045 +- 0.091 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all L1 = 0.11 +- 0.128 (in-sample avg dev_std = 0.139)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:36:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:02 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:05 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:36:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0078
ID Validation ACCURACY: 0.7022
ID Validation Loss: 1.7503
ID Test ACCURACY: 0.6733
ID Test Loss: 1.9391
OOD Validation ACCURACY: 0.6056
OOD Validation Loss: 2.3958
OOD Test ACCURACY: 0.5594
OOD Test Loss: 3.4823

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.9151
Train Loss: 0.2350
ID Validation ACCURACY: 0.6895
ID Validation Loss: 1.2064
ID Test ACCURACY: 0.6805
ID Test Loss: 1.2517
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 1.6038
OOD Test ACCURACY: 0.5937
OOD Test Loss: 2.1227

[0m[1;37mINFO[0m: [1mChartInfo 0.6733 0.5594 0.6805 0.5937 0.6895 0.6342[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.914
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 642
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.806
SUFF++ for r=0.3 class 0 = 0.77 +- 0.287 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 1 = 0.812 +- 0.287 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 2 = 0.76 +- 0.287 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 all KL = 0.693 +- 0.287 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 all L1 = 0.788 +- 0.186 (in-sample avg dev_std = 0.473)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.971
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.945
SUFF++ for r=0.6 class 0 = 0.921 +- 0.165 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1 = 0.939 +- 0.165 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 2 = 0.912 +- 0.165 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.923 +- 0.165 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.927 +- 0.131 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.995
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.994
SUFF++ for r=0.9 class 0 = 0.987 +- 0.040 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 class 1 = 0.991 +- 0.040 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 class 2 = 0.988 +- 0.040 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 all KL = 0.991 +- 0.040 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 all L1 = 0.99 +- 0.035 (in-sample avg dev_std = 0.064)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 453
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.601
SUFF++ for r=0.3 class 0 = 0.772 +- 0.261 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 1 = 0.756 +- 0.261 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 2 = 0.736 +- 0.261 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all KL = 0.704 +- 0.261 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.194 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.662
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.654
SUFF++ for r=0.6 class 0 = 0.853 +- 0.172 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 1 = 0.876 +- 0.172 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 2 = 0.838 +- 0.172 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all KL = 0.889 +- 0.172 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all L1 = 0.86 +- 0.168 (in-sample avg dev_std = 0.256)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.69
SUFF++ for r=0.9 class 0 = 0.949 +- 0.082 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 class 1 = 0.947 +- 0.082 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 class 2 = 0.918 +- 0.082 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 all KL = 0.964 +- 0.082 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.094 (in-sample avg dev_std = 0.175)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.587
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 767
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.543
SUFF++ for r=0.3 class 0 = 0.726 +- 0.282 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 1 = 0.721 +- 0.282 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 2 = 0.694 +- 0.282 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all KL = 0.667 +- 0.282 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all L1 = 0.716 +- 0.197 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.589
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.601
SUFF++ for r=0.6 class 0 = 0.864 +- 0.151 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 class 1 = 0.868 +- 0.151 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 class 2 = 0.841 +- 0.151 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 all KL = 0.909 +- 0.151 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 all L1 = 0.862 +- 0.168 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.603
SUFF++ for r=0.9 class 0 = 0.952 +- 0.038 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.038 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 class 2 = 0.947 +- 0.038 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 all KL = 0.984 +- 0.038 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 all L1 = 0.955 +- 0.072 (in-sample avg dev_std = 0.113)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.535
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 787
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.495
SUFF++ for r=0.3 class 0 = 0.749 +- 0.284 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 1 = 0.716 +- 0.284 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 2 = 0.694 +- 0.284 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all KL = 0.644 +- 0.284 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all L1 = 0.719 +- 0.189 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.543
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.539
SUFF++ for r=0.6 class 0 = 0.868 +- 0.140 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 class 1 = 0.87 +- 0.140 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 class 2 = 0.863 +- 0.140 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 all KL = 0.914 +- 0.140 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 all L1 = 0.868 +- 0.154 (in-sample avg dev_std = 0.208)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.558
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.551
SUFF++ for r=0.9 class 0 = 0.953 +- 0.032 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 class 1 = 0.96 +- 0.032 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 class 2 = 0.95 +- 0.032 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 all KL = 0.986 +- 0.032 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 all L1 = 0.955 +- 0.071 (in-sample avg dev_std = 0.096)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.911
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.89
NEC for r=0.3 class 0 = 0.098 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 1 = 0.083 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 2 = 0.12 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all KL = 0.072 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all L1 = 0.096 +- 0.151 (in-sample avg dev_std = 0.188)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.971
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.963
NEC for r=0.6 class 0 = 0.04 +- 0.099 (in-sample avg dev_std = 0.122)
NEC for r=0.6 class 1 = 0.041 +- 0.099 (in-sample avg dev_std = 0.122)
NEC for r=0.6 class 2 = 0.051 +- 0.099 (in-sample avg dev_std = 0.122)
NEC for r=0.6 all KL = 0.032 +- 0.099 (in-sample avg dev_std = 0.122)
NEC for r=0.6 all L1 = 0.043 +- 0.096 (in-sample avg dev_std = 0.122)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.995
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.986
NEC for r=0.9 class 0 = 0.03 +- 0.111 (in-sample avg dev_std = 0.111)
NEC for r=0.9 class 1 = 0.02 +- 0.111 (in-sample avg dev_std = 0.111)
NEC for r=0.9 class 2 = 0.03 +- 0.111 (in-sample avg dev_std = 0.111)
NEC for r=0.9 all KL = 0.03 +- 0.111 (in-sample avg dev_std = 0.111)
NEC for r=0.9 all L1 = 0.025 +- 0.079 (in-sample avg dev_std = 0.111)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.996
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.99
NEC for r=1.0 class 0 = 0.028 +- 0.119 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 1 = 0.017 +- 0.119 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 2 = 0.029 +- 0.119 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all KL = 0.031 +- 0.119 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all L1 = 0.023 +- 0.077 (in-sample avg dev_std = 0.102)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.639
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.635
NEC for r=0.3 class 0 = 0.122 +- 0.146 (in-sample avg dev_std = 0.196)
NEC for r=0.3 class 1 = 0.132 +- 0.146 (in-sample avg dev_std = 0.196)
NEC for r=0.3 class 2 = 0.162 +- 0.146 (in-sample avg dev_std = 0.196)
NEC for r=0.3 all KL = 0.085 +- 0.146 (in-sample avg dev_std = 0.196)
NEC for r=0.3 all L1 = 0.138 +- 0.165 (in-sample avg dev_std = 0.196)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.662
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.654
NEC for r=0.6 class 0 = 0.121 +- 0.150 (in-sample avg dev_std = 0.198)
NEC for r=0.6 class 1 = 0.102 +- 0.150 (in-sample avg dev_std = 0.198)
NEC for r=0.6 class 2 = 0.139 +- 0.150 (in-sample avg dev_std = 0.198)
NEC for r=0.6 all KL = 0.077 +- 0.150 (in-sample avg dev_std = 0.198)
NEC for r=0.6 all L1 = 0.117 +- 0.164 (in-sample avg dev_std = 0.198)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.687
NEC for r=0.9 class 0 = 0.104 +- 0.154 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 1 = 0.084 +- 0.154 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 2 = 0.131 +- 0.154 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all KL = 0.069 +- 0.154 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all L1 = 0.102 +- 0.158 (in-sample avg dev_std = 0.192)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.699
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.681
NEC for r=1.0 class 0 = 0.103 +- 0.152 (in-sample avg dev_std = 0.194)
NEC for r=1.0 class 1 = 0.087 +- 0.152 (in-sample avg dev_std = 0.194)
NEC for r=1.0 class 2 = 0.122 +- 0.152 (in-sample avg dev_std = 0.194)
NEC for r=1.0 all KL = 0.07 +- 0.152 (in-sample avg dev_std = 0.194)
NEC for r=1.0 all L1 = 0.101 +- 0.155 (in-sample avg dev_std = 0.194)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.577
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.567
NEC for r=0.3 class 0 = 0.172 +- 0.180 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 1 = 0.166 +- 0.180 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 2 = 0.194 +- 0.180 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all KL = 0.123 +- 0.180 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all L1 = 0.173 +- 0.179 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.589
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.597
NEC for r=0.6 class 0 = 0.119 +- 0.127 (in-sample avg dev_std = 0.184)
NEC for r=0.6 class 1 = 0.118 +- 0.127 (in-sample avg dev_std = 0.184)
NEC for r=0.6 class 2 = 0.139 +- 0.127 (in-sample avg dev_std = 0.184)
NEC for r=0.6 all KL = 0.074 +- 0.127 (in-sample avg dev_std = 0.184)
NEC for r=0.6 all L1 = 0.123 +- 0.148 (in-sample avg dev_std = 0.184)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0 = 0.124 +- 0.151 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 1 = 0.104 +- 0.151 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 2 = 0.145 +- 0.151 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all KL = 0.081 +- 0.151 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all L1 = 0.117 +- 0.160 (in-sample avg dev_std = 0.189)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.599
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.612
NEC for r=1.0 class 0 = 0.119 +- 0.168 (in-sample avg dev_std = 0.181)
NEC for r=1.0 class 1 = 0.104 +- 0.168 (in-sample avg dev_std = 0.181)
NEC for r=1.0 class 2 = 0.151 +- 0.168 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all KL = 0.084 +- 0.168 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all L1 = 0.118 +- 0.169 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.533
NEC for r=0.3 class 0 = 0.124 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=0.3 class 1 = 0.149 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=0.3 class 2 = 0.178 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=0.3 all KL = 0.095 +- 0.150 (in-sample avg dev_std = 0.218)
NEC for r=0.3 all L1 = 0.149 +- 0.169 (in-sample avg dev_std = 0.218)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.543
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.549
NEC for r=0.6 class 0 = 0.114 +- 0.124 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 1 = 0.122 +- 0.124 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 2 = 0.137 +- 0.124 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all KL = 0.072 +- 0.124 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all L1 = 0.123 +- 0.151 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.558
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0 = 0.126 +- 0.140 (in-sample avg dev_std = 0.191)
NEC for r=0.9 class 1 = 0.116 +- 0.140 (in-sample avg dev_std = 0.191)
NEC for r=0.9 class 2 = 0.123 +- 0.140 (in-sample avg dev_std = 0.191)
NEC for r=0.9 all KL = 0.078 +- 0.140 (in-sample avg dev_std = 0.191)
NEC for r=0.9 all L1 = 0.12 +- 0.157 (in-sample avg dev_std = 0.191)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.558
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.552
NEC for r=1.0 class 0 = 0.114 +- 0.162 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 1 = 0.125 +- 0.162 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 2 = 0.141 +- 0.162 (in-sample avg dev_std = 0.201)
NEC for r=1.0 all KL = 0.091 +- 0.162 (in-sample avg dev_std = 0.201)
NEC for r=1.0 all L1 = 0.126 +- 0.169 (in-sample avg dev_std = 0.201)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:41:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:45 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:46 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:48 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:41:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8317
Train Loss: 0.4556
ID Validation ACCURACY: 0.6877
ID Validation Loss: 1.0401
ID Test ACCURACY: 0.6823
ID Test Loss: 1.1431
OOD Validation ACCURACY: 0.6280
OOD Validation Loss: 1.4168
OOD Test ACCURACY: 0.5882
OOD Test Loss: 2.0213

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 12...
[0m[1;37mINFO[0m: [1mCheckpoint 12: 
-----------------------------------
Train ACCURACY: 0.8131
Train Loss: 0.4676
ID Validation ACCURACY: 0.6552
ID Validation Loss: 0.9394
ID Test ACCURACY: 0.6877
ID Test Loss: 0.9807
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 1.2476
OOD Test ACCURACY: 0.5765
OOD Test Loss: 1.7766

[0m[1;37mINFO[0m: [1mChartInfo 0.6823 0.5882 0.6877 0.5765 0.6552 0.6353[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.744
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 653
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.683
SUFF++ for r=0.3 class 0 = 0.817 +- 0.121 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 1 = 0.8 +- 0.121 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 2 = 0.773 +- 0.121 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all KL = 0.88 +- 0.121 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.121 (in-sample avg dev_std = 0.314)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.778
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.751
SUFF++ for r=0.6 class 0 = 0.912 +- 0.061 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 class 1 = 0.879 +- 0.061 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 class 2 = 0.891 +- 0.061 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 all KL = 0.963 +- 0.061 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 all L1 = 0.89 +- 0.101 (in-sample avg dev_std = 0.152)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.832
SUFF++ for r=0.9 class 0 = 0.964 +- 0.025 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 class 1 = 0.949 +- 0.025 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 class 2 = 0.953 +- 0.025 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 all KL = 0.988 +- 0.025 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.052 (in-sample avg dev_std = 0.100)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.602
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 422
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.571
SUFF++ for r=0.3 class 0 = 0.787 +- 0.128 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.3 class 1 = 0.796 +- 0.128 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.3 class 2 = 0.791 +- 0.128 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.3 all KL = 0.878 +- 0.128 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.3 all L1 = 0.793 +- 0.124 (in-sample avg dev_std = 0.320)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.637
SUFF++ for r=0.6 class 0 = 0.902 +- 0.055 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 class 1 = 0.878 +- 0.055 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 class 2 = 0.889 +- 0.055 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 all KL = 0.963 +- 0.055 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.6 all L1 = 0.887 +- 0.093 (in-sample avg dev_std = 0.152)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.683
SUFF++ for r=0.9 class 0 = 0.966 +- 0.028 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 1 = 0.948 +- 0.028 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 2 = 0.945 +- 0.028 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all KL = 0.987 +- 0.028 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all L1 = 0.952 +- 0.052 (in-sample avg dev_std = 0.102)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.563
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 762
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.531
SUFF++ for r=0.3 class 0 = 0.783 +- 0.135 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 1 = 0.77 +- 0.135 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 2 = 0.754 +- 0.135 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 all KL = 0.859 +- 0.135 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 all L1 = 0.77 +- 0.126 (in-sample avg dev_std = 0.332)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.598
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.585
SUFF++ for r=0.6 class 0 = 0.893 +- 0.049 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.6 class 1 = 0.885 +- 0.049 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.6 class 2 = 0.883 +- 0.049 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.6 all KL = 0.968 +- 0.049 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.6 all L1 = 0.887 +- 0.097 (in-sample avg dev_std = 0.121)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.627
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.627
SUFF++ for r=0.9 class 0 = 0.967 +- 0.011 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.011 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 2 = 0.954 +- 0.011 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all KL = 0.994 +- 0.011 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all L1 = 0.961 +- 0.043 (in-sample avg dev_std = 0.070)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.504
SUFF++ for r=0.3 class 0 = 0.78 +- 0.149 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 class 1 = 0.774 +- 0.149 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 class 2 = 0.752 +- 0.149 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 all KL = 0.843 +- 0.149 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.3 all L1 = 0.77 +- 0.130 (in-sample avg dev_std = 0.360)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.549
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.547
SUFF++ for r=0.6 class 0 = 0.891 +- 0.067 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 class 1 = 0.871 +- 0.067 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 class 2 = 0.872 +- 0.067 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 all KL = 0.955 +- 0.067 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 all L1 = 0.877 +- 0.111 (in-sample avg dev_std = 0.147)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.587
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.589
SUFF++ for r=0.9 class 0 = 0.965 +- 0.016 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 class 1 = 0.956 +- 0.016 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 class 2 = 0.954 +- 0.016 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 all KL = 0.992 +- 0.016 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 all L1 = 0.958 +- 0.051 (in-sample avg dev_std = 0.076)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.738
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.729
NEC for r=0.3 class 0 = 0.091 +- 0.059 (in-sample avg dev_std = 0.130)
NEC for r=0.3 class 1 = 0.114 +- 0.059 (in-sample avg dev_std = 0.130)
NEC for r=0.3 class 2 = 0.136 +- 0.059 (in-sample avg dev_std = 0.130)
NEC for r=0.3 all KL = 0.032 +- 0.059 (in-sample avg dev_std = 0.130)
NEC for r=0.3 all L1 = 0.114 +- 0.093 (in-sample avg dev_std = 0.130)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.778
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.768
NEC for r=0.6 class 0 = 0.068 +- 0.055 (in-sample avg dev_std = 0.126)
NEC for r=0.6 class 1 = 0.102 +- 0.055 (in-sample avg dev_std = 0.126)
NEC for r=0.6 class 2 = 0.096 +- 0.055 (in-sample avg dev_std = 0.126)
NEC for r=0.6 all KL = 0.027 +- 0.055 (in-sample avg dev_std = 0.126)
NEC for r=0.6 all L1 = 0.093 +- 0.094 (in-sample avg dev_std = 0.126)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.828
NEC for r=0.9 class 0 = 0.072 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.9 class 1 = 0.087 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.9 class 2 = 0.077 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.9 all KL = 0.024 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.9 all L1 = 0.081 +- 0.090 (in-sample avg dev_std = 0.102)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.839
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.835
NEC for r=1.0 class 0 = 0.075 +- 0.062 (in-sample avg dev_std = 0.106)
NEC for r=1.0 class 1 = 0.084 +- 0.062 (in-sample avg dev_std = 0.106)
NEC for r=1.0 class 2 = 0.079 +- 0.062 (in-sample avg dev_std = 0.106)
NEC for r=1.0 all KL = 0.026 +- 0.062 (in-sample avg dev_std = 0.106)
NEC for r=1.0 all L1 = 0.08 +- 0.094 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.618
NEC for r=0.3 class 0 = 0.107 +- 0.053 (in-sample avg dev_std = 0.135)
NEC for r=0.3 class 1 = 0.122 +- 0.053 (in-sample avg dev_std = 0.135)
NEC for r=0.3 class 2 = 0.121 +- 0.053 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all KL = 0.032 +- 0.053 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all L1 = 0.118 +- 0.093 (in-sample avg dev_std = 0.135)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.645
NEC for r=0.6 class 0 = 0.089 +- 0.066 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 1 = 0.107 +- 0.066 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 2 = 0.099 +- 0.066 (in-sample avg dev_std = 0.135)
NEC for r=0.6 all KL = 0.032 +- 0.066 (in-sample avg dev_std = 0.135)
NEC for r=0.6 all L1 = 0.1 +- 0.099 (in-sample avg dev_std = 0.135)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.076 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 class 1 = 0.098 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 class 2 = 0.085 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 all KL = 0.027 +- 0.063 (in-sample avg dev_std = 0.116)
NEC for r=0.9 all L1 = 0.089 +- 0.091 (in-sample avg dev_std = 0.116)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.686
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.672
NEC for r=1.0 class 0 = 0.085 +- 0.069 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 1 = 0.096 +- 0.069 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 2 = 0.089 +- 0.069 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all KL = 0.03 +- 0.069 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all L1 = 0.091 +- 0.103 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.577
NEC for r=0.3 class 0 = 0.127 +- 0.067 (in-sample avg dev_std = 0.149)
NEC for r=0.3 class 1 = 0.142 +- 0.067 (in-sample avg dev_std = 0.149)
NEC for r=0.3 class 2 = 0.151 +- 0.067 (in-sample avg dev_std = 0.149)
NEC for r=0.3 all KL = 0.043 +- 0.067 (in-sample avg dev_std = 0.149)
NEC for r=0.3 all L1 = 0.14 +- 0.105 (in-sample avg dev_std = 0.149)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.598
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.594
NEC for r=0.6 class 0 = 0.102 +- 0.063 (in-sample avg dev_std = 0.128)
NEC for r=0.6 class 1 = 0.117 +- 0.063 (in-sample avg dev_std = 0.128)
NEC for r=0.6 class 2 = 0.121 +- 0.063 (in-sample avg dev_std = 0.128)
NEC for r=0.6 all KL = 0.035 +- 0.063 (in-sample avg dev_std = 0.128)
NEC for r=0.6 all L1 = 0.114 +- 0.099 (in-sample avg dev_std = 0.128)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.627
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.626
NEC for r=0.9 class 0 = 0.102 +- 0.088 (in-sample avg dev_std = 0.129)
NEC for r=0.9 class 1 = 0.115 +- 0.088 (in-sample avg dev_std = 0.129)
NEC for r=0.9 class 2 = 0.129 +- 0.088 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all KL = 0.043 +- 0.088 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all L1 = 0.114 +- 0.115 (in-sample avg dev_std = 0.129)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.626
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.63
NEC for r=1.0 class 0 = 0.111 +- 0.110 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 1 = 0.117 +- 0.110 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 2 = 0.135 +- 0.110 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all KL = 0.051 +- 0.110 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all L1 = 0.119 +- 0.130 (in-sample avg dev_std = 0.136)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.518
NEC for r=0.3 class 0 = 0.116 +- 0.070 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 1 = 0.137 +- 0.070 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 2 = 0.146 +- 0.070 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all KL = 0.042 +- 0.070 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all L1 = 0.134 +- 0.109 (in-sample avg dev_std = 0.141)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.549
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.551
NEC for r=0.6 class 0 = 0.088 +- 0.055 (in-sample avg dev_std = 0.123)
NEC for r=0.6 class 1 = 0.119 +- 0.055 (in-sample avg dev_std = 0.123)
NEC for r=0.6 class 2 = 0.125 +- 0.055 (in-sample avg dev_std = 0.123)
NEC for r=0.6 all KL = 0.035 +- 0.055 (in-sample avg dev_std = 0.123)
NEC for r=0.6 all L1 = 0.112 +- 0.105 (in-sample avg dev_std = 0.123)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.587
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.586
NEC for r=0.9 class 0 = 0.096 +- 0.079 (in-sample avg dev_std = 0.121)
NEC for r=0.9 class 1 = 0.12 +- 0.079 (in-sample avg dev_std = 0.121)
NEC for r=0.9 class 2 = 0.116 +- 0.079 (in-sample avg dev_std = 0.121)
NEC for r=0.9 all KL = 0.043 +- 0.079 (in-sample avg dev_std = 0.121)
NEC for r=0.9 all L1 = 0.113 +- 0.120 (in-sample avg dev_std = 0.121)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.599
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.596
NEC for r=1.0 class 0 = 0.107 +- 0.105 (in-sample avg dev_std = 0.134)
NEC for r=1.0 class 1 = 0.121 +- 0.105 (in-sample avg dev_std = 0.134)
NEC for r=1.0 class 2 = 0.126 +- 0.105 (in-sample avg dev_std = 0.134)
NEC for r=1.0 all KL = 0.053 +- 0.105 (in-sample avg dev_std = 0.134)
NEC for r=1.0 all L1 = 0.118 +- 0.134 (in-sample avg dev_std = 0.134)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.881, 0.963, 0.987, 1.0], 'all_L1': [0.802, 0.889, 0.951, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.791, 0.937, 0.986, 1.0], 'all_L1': [0.774, 0.893, 0.962, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.896, 0.965, 0.991, 1.0], 'all_L1': [0.819, 0.903, 0.962, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.923, 0.991, 1.0], 'all_L1': [0.788, 0.927, 0.99, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.963, 0.988, 1.0], 'all_L1': [0.798, 0.89, 0.954, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.04, 0.026, 0.024, 0.025], 'all_L1': [0.121, 0.089, 0.08, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.039, 0.029, 0.032], 'all_L1': [0.122, 0.083, 0.062, 0.064]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.025, 0.023, 0.027], 'all_L1': [0.104, 0.079, 0.069, 0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.032, 0.03, 0.031], 'all_L1': [0.096, 0.043, 0.025, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.027, 0.024, 0.026], 'all_L1': [0.114, 0.093, 0.081, 0.08]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.881, 0.956, 0.989, 1.0], 'all_L1': [0.798, 0.878, 0.951, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.785, 0.927, 0.98, 1.0], 'all_L1': [0.762, 0.87, 0.944, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.898, 0.96, 0.989, 1.0], 'all_L1': [0.816, 0.894, 0.956, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.889, 0.964, 1.0], 'all_L1': [0.754, 0.86, 0.939, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.878, 0.963, 0.987, 1.0], 'all_L1': [0.793, 0.887, 0.952, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.038, 0.034, 0.027, 0.03], 'all_L1': [0.121, 0.102, 0.086, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.043, 0.046, 0.048], 'all_L1': [0.134, 0.106, 0.099, 0.098]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.03, 0.031, 0.036], 'all_L1': [0.114, 0.089, 0.087, 0.092]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.077, 0.069, 0.07], 'all_L1': [0.138, 0.117, 0.102, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.032, 0.027, 0.03], 'all_L1': [0.118, 0.1, 0.089, 0.091]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.86, 0.969, 0.994, 1.0], 'all_L1': [0.769, 0.885, 0.96, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.75, 0.911, 0.988, 1.0], 'all_L1': [0.724, 0.844, 0.953, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.968, 0.994, 1.0], 'all_L1': [0.802, 0.893, 0.965, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.667, 0.909, 0.984, 1.0], 'all_L1': [0.716, 0.862, 0.955, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.859, 0.968, 0.994, 1.0], 'all_L1': [0.77, 0.887, 0.961, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.047, 0.034, 0.034, 0.04], 'all_L1': [0.147, 0.115, 0.115, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.072, 0.061, 0.058], 'all_L1': [0.176, 0.142, 0.123, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.039, 0.041, 0.04], 'all_L1': [0.136, 0.114, 0.108, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.074, 0.081, 0.084], 'all_L1': [0.173, 0.123, 0.117, 0.118]}), defaultdict(<class 'list'>, {'all_KL': [0.043, 0.035, 0.043, 0.051], 'all_L1': [0.14, 0.114, 0.114, 0.119]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.835, 0.962, 0.995, 1.0], 'all_L1': [0.761, 0.883, 0.966, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.905, 0.989, 1.0], 'all_L1': [0.718, 0.853, 0.954, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.96, 0.994, 1.0], 'all_L1': [0.79, 0.886, 0.962, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.644, 0.914, 0.986, 1.0], 'all_L1': [0.719, 0.868, 0.955, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.843, 0.955, 0.992, 1.0], 'all_L1': [0.77, 0.877, 0.958, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.044, 0.031, 0.033, 0.038], 'all_L1': [0.139, 0.11, 0.109, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.062, 0.055, 0.06], 'all_L1': [0.158, 0.126, 0.119, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.043, 0.042, 0.045], 'all_L1': [0.139, 0.117, 0.107, 0.11]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.072, 0.078, 0.091], 'all_L1': [0.149, 0.123, 0.12, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.035, 0.043, 0.053], 'all_L1': [0.134, 0.112, 0.113, 0.118]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.796 +- 0.015, 0.900 +- 0.014, 0.964 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.828 +- 0.077, 0.950 +- 0.017, 0.989 +- 0.002, 1.000 +- 0.000
suff++_acc_int  =  0.718 +- 0.048, 0.824 +- 0.070, 0.882 +- 0.068
nec class all_L1  =  0.111 +- 0.010, 0.077 +- 0.018, 0.063 +- 0.020, 0.063 +- 0.021
nec class all_KL  =  0.046 +- 0.016, 0.030 +- 0.005, 0.026 +- 0.003, 0.028 +- 0.003
nec_acc_int  =  0.779 +- 0.062, 0.840 +- 0.070, 0.878 +- 0.066, 0.882 +- 0.066

Eval split id_val
suff++ class all_L1  =  0.785 +- 0.023, 0.878 +- 0.012, 0.948 +- 0.006, 1.000 +- 0.000
suff++ class all_KL  =  0.829 +- 0.074, 0.939 +- 0.028, 0.982 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.591 +- 0.022, 0.646 +- 0.015, 0.688 +- 0.006
nec class all_L1  =  0.125 +- 0.009, 0.103 +- 0.009, 0.093 +- 0.007, 0.095 +- 0.004
nec class all_KL  =  0.050 +- 0.021, 0.043 +- 0.017, 0.040 +- 0.016, 0.043 +- 0.015
nec_acc_int  =  0.626 +- 0.021, 0.653 +- 0.011, 0.682 +- 0.009, 0.682 +- 0.010

Eval split val
suff++ class all_L1  =  0.756 +- 0.032, 0.874 +- 0.018, 0.959 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.804 +- 0.083, 0.945 +- 0.029, 0.991 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.555 +- 0.022, 0.601 +- 0.014, 0.620 +- 0.010
nec class all_L1  =  0.154 +- 0.017, 0.122 +- 0.011, 0.115 +- 0.005, 0.117 +- 0.007
nec class all_KL  =  0.070 +- 0.031, 0.051 +- 0.018, 0.052 +- 0.017, 0.055 +- 0.016
nec_acc_int  =  0.585 +- 0.016, 0.606 +- 0.013, 0.622 +- 0.006, 0.625 +- 0.007

Eval split test
suff++ class all_L1  =  0.752 +- 0.029, 0.873 +- 0.012, 0.959 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.779 +- 0.087, 0.939 +- 0.025, 0.991 +- 0.003, 1.000 +- 0.000
suff++_acc_int  =  0.517 +- 0.024, 0.557 +- 0.020, 0.575 +- 0.018
nec class all_L1  =  0.144 +- 0.009, 0.118 +- 0.006, 0.114 +- 0.005, 0.117 +- 0.006
nec class all_KL  =  0.062 +- 0.021, 0.049 +- 0.016, 0.050 +- 0.016, 0.057 +- 0.018
nec_acc_int  =  0.541 +- 0.025, 0.556 +- 0.016, 0.572 +- 0.018, 0.575 +- 0.016


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.454 +- 0.008, 0.489 +- 0.002, 0.514 +- 0.004, 0.532 +- 0.010
Faith. Armon (L1)= 		  =  0.195 +- 0.015, 0.142 +- 0.031, 0.118 +- 0.037, 0.118 +- 0.038
Faith. GMean (L1)= 	  =  0.297 +- 0.013, 0.262 +- 0.032, 0.243 +- 0.044, 0.247 +- 0.049
Faith. Aritm (KL)= 		  =  0.437 +- 0.031, 0.490 +- 0.007, 0.507 +- 0.002, 0.514 +- 0.001
Faith. Armon (KL)= 		  =  0.086 +- 0.027, 0.058 +- 0.010, 0.051 +- 0.005, 0.055 +- 0.005
Faith. GMean (KL)= 	  =  0.191 +- 0.023, 0.168 +- 0.013, 0.160 +- 0.009, 0.168 +- 0.008

Eval split id_val
Faith. Aritm (L1)= 		  =  0.455 +- 0.007, 0.490 +- 0.002, 0.521 +- 0.001, 0.548 +- 0.002
Faith. Armon (L1)= 		  =  0.215 +- 0.013, 0.184 +- 0.014, 0.169 +- 0.011, 0.174 +- 0.006
Faith. GMean (L1)= 	  =  0.313 +- 0.007, 0.300 +- 0.011, 0.296 +- 0.010, 0.308 +- 0.006
Faith. Aritm (KL)= 		  =  0.440 +- 0.027, 0.491 +- 0.006, 0.511 +- 0.003, 0.521 +- 0.008
Faith. Armon (KL)= 		  =  0.093 +- 0.035, 0.082 +- 0.031, 0.076 +- 0.029, 0.082 +- 0.027
Faith. GMean (KL)= 	  =  0.197 +- 0.030, 0.197 +- 0.034, 0.194 +- 0.036, 0.204 +- 0.035

Eval split val
Faith. Aritm (L1)= 		  =  0.455 +- 0.008, 0.498 +- 0.004, 0.537 +- 0.001, 0.558 +- 0.004
Faith. Armon (L1)= 		  =  0.256 +- 0.021, 0.213 +- 0.016, 0.206 +- 0.008, 0.209 +- 0.011
Faith. GMean (L1)= 	  =  0.341 +- 0.012, 0.326 +- 0.011, 0.333 +- 0.006, 0.342 +- 0.011
Faith. Aritm (KL)= 		  =  0.437 +- 0.026, 0.498 +- 0.005, 0.521 +- 0.006, 0.527 +- 0.008
Faith. Armon (KL)= 		  =  0.126 +- 0.049, 0.096 +- 0.032, 0.098 +- 0.030, 0.103 +- 0.029
Faith. GMean (KL)= 	  =  0.229 +- 0.037, 0.215 +- 0.035, 0.224 +- 0.035, 0.231 +- 0.033

Eval split test
Faith. Aritm (L1)= 		  =  0.448 +- 0.011, 0.495 +- 0.004, 0.536 +- 0.001, 0.559 +- 0.003
Faith. Armon (L1)= 		  =  0.241 +- 0.011, 0.207 +- 0.009, 0.203 +- 0.008, 0.210 +- 0.010
Faith. GMean (L1)= 	  =  0.328 +- 0.005, 0.320 +- 0.007, 0.330 +- 0.007, 0.343 +- 0.009
Faith. Aritm (KL)= 		  =  0.420 +- 0.033, 0.494 +- 0.006, 0.521 +- 0.006, 0.529 +- 0.009
Faith. Armon (KL)= 		  =  0.113 +- 0.034, 0.092 +- 0.028, 0.095 +- 0.028, 0.108 +- 0.032
Faith. GMean (KL)= 	  =  0.214 +- 0.024, 0.210 +- 0.032, 0.221 +- 0.033, 0.237 +- 0.037
Computed for split load_split = id



Completed in  0:28:21.798111  for LECIvGIN GOODTwitter/length



DONE LECI GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:47:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:47:53 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:47:55 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:47:56 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:47:56 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:47:58 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:48:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.6949
ID Validation Loss: 3.1220
ID Test ACCURACY: 0.6715
ID Test Loss: 3.1210
OOD Validation ACCURACY: 0.5972
OOD Validation Loss: 3.9517
OOD Test ACCURACY: 0.5436
OOD Test Loss: 5.5896

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 12...
[0m[1;37mINFO[0m: [1mCheckpoint 12: 
-----------------------------------
Train ACCURACY: 0.8382
Train Loss: 0.4283
ID Validation ACCURACY: 0.6751
ID Validation Loss: 0.8734
ID Test ACCURACY: 0.6913
ID Test Loss: 0.8739
OOD Validation ACCURACY: 0.6291
OOD Validation Loss: 1.1390
OOD Test ACCURACY: 0.5978
OOD Test Loss: 1.5533

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5436 0.6913 0.5978 0.6751 0.6291[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.772
SUFF++ for r=0.3 class 0 = 0.606 +- 0.338 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 class 1 = 0.711 +- 0.338 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 class 2 = 0.718 +- 0.338 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 all KL = 0.39 +- 0.338 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 all L1 = 0.688 +- 0.196 (in-sample avg dev_std = 0.650)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.895
SUFF++ for r=0.6 class 0 = 0.753 +- 0.376 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 1 = 0.847 +- 0.376 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 2 = 0.846 +- 0.376 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 all KL = 0.567 +- 0.376 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 all L1 = 0.824 +- 0.177 (in-sample avg dev_std = 0.502)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.997
SUFF++ for r=0.9 class 0 = 0.99 +- 0.109 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 class 1 = 0.991 +- 0.109 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 class 2 = 0.989 +- 0.109 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 all KL = 0.971 +- 0.109 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 all L1 = 0.99 +- 0.042 (in-sample avg dev_std = 0.082)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.544
SUFF++ for r=0.3 class 0 = 0.608 +- 0.311 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.3 class 1 = 0.637 +- 0.311 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.3 class 2 = 0.639 +- 0.311 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.3 all KL = 0.409 +- 0.311 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.3 all L1 = 0.631 +- 0.200 (in-sample avg dev_std = 0.634)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.621
SUFF++ for r=0.6 class 0 = 0.677 +- 0.328 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 class 1 = 0.743 +- 0.328 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 class 2 = 0.724 +- 0.328 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 all KL = 0.553 +- 0.328 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.6 all L1 = 0.722 +- 0.215 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.682
SUFF++ for r=0.9 class 0 = 0.881 +- 0.206 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.206 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 2 = 0.859 +- 0.206 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all KL = 0.86 +- 0.206 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all L1 = 0.87 +- 0.175 (in-sample avg dev_std = 0.271)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.482
SUFF++ for r=0.3 class 0 = 0.632 +- 0.305 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 class 1 = 0.613 +- 0.305 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 class 2 = 0.596 +- 0.305 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 all KL = 0.438 +- 0.305 (in-sample avg dev_std = 0.604)
SUFF++ for r=0.3 all L1 = 0.614 +- 0.214 (in-sample avg dev_std = 0.604)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.556
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.547
SUFF++ for r=0.6 class 0 = 0.729 +- 0.288 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 1 = 0.717 +- 0.288 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 2 = 0.701 +- 0.288 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all KL = 0.621 +- 0.288 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all L1 = 0.716 +- 0.205 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.598
SUFF++ for r=0.9 class 0 = 0.872 +- 0.201 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1 = 0.845 +- 0.201 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 2 = 0.82 +- 0.201 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.863 +- 0.201 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.846 +- 0.182 (in-sample avg dev_std = 0.265)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.459
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.459
SUFF++ for r=0.3 class 0 = 0.636 +- 0.293 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 class 1 = 0.607 +- 0.293 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 class 2 = 0.625 +- 0.293 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 all KL = 0.442 +- 0.293 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 all L1 = 0.619 +- 0.205 (in-sample avg dev_std = 0.596)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.508
SUFF++ for r=0.6 class 0 = 0.751 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 1 = 0.71 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 2 = 0.715 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all KL = 0.626 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all L1 = 0.722 +- 0.205 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.536
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.53
SUFF++ for r=0.9 class 0 = 0.882 +- 0.188 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 1 = 0.846 +- 0.188 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 2 = 0.851 +- 0.188 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all KL = 0.871 +- 0.188 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.177 (in-sample avg dev_std = 0.241)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.897
NEC for r=0.3 class 0 = 0.189 +- 0.312 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 1 = 0.133 +- 0.312 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 2 = 0.143 +- 0.312 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all KL = 0.211 +- 0.312 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all L1 = 0.149 +- 0.216 (in-sample avg dev_std = 0.319)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.983
NEC for r=0.6 class 0 = 0.072 +- 0.181 (in-sample avg dev_std = 0.157)
NEC for r=0.6 class 1 = 0.031 +- 0.181 (in-sample avg dev_std = 0.157)
NEC for r=0.6 class 2 = 0.04 +- 0.181 (in-sample avg dev_std = 0.157)
NEC for r=0.6 all KL = 0.068 +- 0.181 (in-sample avg dev_std = 0.157)
NEC for r=0.6 all L1 = 0.043 +- 0.114 (in-sample avg dev_std = 0.157)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.997
NEC for r=0.9 class 0 = 0.01 +- 0.097 (in-sample avg dev_std = 0.073)
NEC for r=0.9 class 1 = 0.007 +- 0.097 (in-sample avg dev_std = 0.073)
NEC for r=0.9 class 2 = 0.008 +- 0.097 (in-sample avg dev_std = 0.073)
NEC for r=0.9 all KL = 0.018 +- 0.097 (in-sample avg dev_std = 0.073)
NEC for r=0.9 all L1 = 0.008 +- 0.049 (in-sample avg dev_std = 0.073)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.997
NEC for r=1.0 class 0 = 0.01 +- 0.104 (in-sample avg dev_std = 0.066)
NEC for r=1.0 class 1 = 0.006 +- 0.104 (in-sample avg dev_std = 0.066)
NEC for r=1.0 class 2 = 0.005 +- 0.104 (in-sample avg dev_std = 0.066)
NEC for r=1.0 all KL = 0.017 +- 0.104 (in-sample avg dev_std = 0.066)
NEC for r=1.0 all L1 = 0.006 +- 0.049 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0 = 0.312 +- 0.350 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 1 = 0.271 +- 0.350 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 2 = 0.278 +- 0.350 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all KL = 0.355 +- 0.350 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all L1 = 0.283 +- 0.256 (in-sample avg dev_std = 0.423)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.661
NEC for r=0.6 class 0 = 0.206 +- 0.295 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 1 = 0.188 +- 0.295 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 2 = 0.212 +- 0.295 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all KL = 0.234 +- 0.295 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all L1 = 0.199 +- 0.227 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.115 +- 0.211 (in-sample avg dev_std = 0.236)
NEC for r=0.9 class 1 = 0.114 +- 0.211 (in-sample avg dev_std = 0.236)
NEC for r=0.9 class 2 = 0.128 +- 0.211 (in-sample avg dev_std = 0.236)
NEC for r=0.9 all KL = 0.112 +- 0.211 (in-sample avg dev_std = 0.236)
NEC for r=0.9 all L1 = 0.118 +- 0.176 (in-sample avg dev_std = 0.236)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.692
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.68
NEC for r=1.0 class 0 = 0.095 +- 0.178 (in-sample avg dev_std = 0.218)
NEC for r=1.0 class 1 = 0.094 +- 0.178 (in-sample avg dev_std = 0.218)
NEC for r=1.0 class 2 = 0.101 +- 0.178 (in-sample avg dev_std = 0.218)
NEC for r=1.0 all KL = 0.085 +- 0.178 (in-sample avg dev_std = 0.218)
NEC for r=1.0 all L1 = 0.096 +- 0.154 (in-sample avg dev_std = 0.218)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.515
NEC for r=0.3 class 0 = 0.313 +- 0.355 (in-sample avg dev_std = 0.476)
NEC for r=0.3 class 1 = 0.369 +- 0.355 (in-sample avg dev_std = 0.476)
NEC for r=0.3 class 2 = 0.408 +- 0.355 (in-sample avg dev_std = 0.476)
NEC for r=0.3 all KL = 0.455 +- 0.355 (in-sample avg dev_std = 0.476)
NEC for r=0.3 all L1 = 0.363 +- 0.268 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.556
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.569
NEC for r=0.6 class 0 = 0.191 +- 0.295 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 1 = 0.246 +- 0.295 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 2 = 0.292 +- 0.295 (in-sample avg dev_std = 0.341)
NEC for r=0.6 all KL = 0.259 +- 0.295 (in-sample avg dev_std = 0.341)
NEC for r=0.6 all L1 = 0.241 +- 0.236 (in-sample avg dev_std = 0.341)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.126 +- 0.210 (in-sample avg dev_std = 0.233)
NEC for r=0.9 class 1 = 0.151 +- 0.210 (in-sample avg dev_std = 0.233)
NEC for r=0.9 class 2 = 0.193 +- 0.210 (in-sample avg dev_std = 0.233)
NEC for r=0.9 all KL = 0.135 +- 0.210 (in-sample avg dev_std = 0.233)
NEC for r=0.9 all L1 = 0.154 +- 0.195 (in-sample avg dev_std = 0.233)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.599
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.595
NEC for r=1.0 class 0 = 0.127 +- 0.218 (in-sample avg dev_std = 0.240)
NEC for r=1.0 class 1 = 0.14 +- 0.218 (in-sample avg dev_std = 0.240)
NEC for r=1.0 class 2 = 0.183 +- 0.218 (in-sample avg dev_std = 0.240)
NEC for r=1.0 all KL = 0.135 +- 0.218 (in-sample avg dev_std = 0.240)
NEC for r=1.0 all L1 = 0.146 +- 0.195 (in-sample avg dev_std = 0.240)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.459
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.49
NEC for r=0.3 class 0 = 0.285 +- 0.358 (in-sample avg dev_std = 0.440)
NEC for r=0.3 class 1 = 0.353 +- 0.358 (in-sample avg dev_std = 0.440)
NEC for r=0.3 class 2 = 0.361 +- 0.358 (in-sample avg dev_std = 0.440)
NEC for r=0.3 all KL = 0.413 +- 0.358 (in-sample avg dev_std = 0.440)
NEC for r=0.3 all L1 = 0.337 +- 0.269 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.521
NEC for r=0.6 class 0 = 0.193 +- 0.285 (in-sample avg dev_std = 0.317)
NEC for r=0.6 class 1 = 0.245 +- 0.285 (in-sample avg dev_std = 0.317)
NEC for r=0.6 class 2 = 0.239 +- 0.285 (in-sample avg dev_std = 0.317)
NEC for r=0.6 all KL = 0.237 +- 0.285 (in-sample avg dev_std = 0.317)
NEC for r=0.6 all L1 = 0.23 +- 0.237 (in-sample avg dev_std = 0.317)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.536
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.534
NEC for r=0.9 class 0 = 0.127 +- 0.205 (in-sample avg dev_std = 0.226)
NEC for r=0.9 class 1 = 0.152 +- 0.205 (in-sample avg dev_std = 0.226)
NEC for r=0.9 class 2 = 0.163 +- 0.205 (in-sample avg dev_std = 0.226)
NEC for r=0.9 all KL = 0.128 +- 0.205 (in-sample avg dev_std = 0.226)
NEC for r=0.9 all L1 = 0.148 +- 0.192 (in-sample avg dev_std = 0.226)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.531
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.53
NEC for r=1.0 class 0 = 0.1 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1 = 0.14 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 2 = 0.13 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.115 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.127 +- 0.180 (in-sample avg dev_std = 0.228)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 01:54:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:23 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:24 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 01:54:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8892
Train Loss: 0.3033
ID Validation ACCURACY: 0.7022
ID Validation Loss: 0.9031
ID Test ACCURACY: 0.6931
ID Test Loss: 0.9372
OOD Validation ACCURACY: 0.6347
OOD Validation Loss: 1.2072
OOD Test ACCURACY: 0.5813
OOD Test Loss: 1.6533

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8606
Train Loss: 0.3678
ID Validation ACCURACY: 0.6968
ID Validation Loss: 0.8431
ID Test ACCURACY: 0.6805
ID Test Loss: 0.8699
OOD Validation ACCURACY: 0.6443
OOD Validation Loss: 1.0506
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.3458

[0m[1;37mINFO[0m: [1mChartInfo 0.6931 0.5813 0.6805 0.5964 0.6968 0.6443[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.743
SUFF++ for r=0.3 class 0 = 0.694 +- 0.131 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 class 1 = 0.736 +- 0.131 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 class 2 = 0.708 +- 0.131 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 all KL = 0.822 +- 0.131 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 all L1 = 0.719 +- 0.128 (in-sample avg dev_std = 0.340)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.806
SUFF++ for r=0.6 class 0 = 0.777 +- 0.140 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 class 1 = 0.784 +- 0.140 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 class 2 = 0.793 +- 0.140 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all KL = 0.858 +- 0.140 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.6 all L1 = 0.785 +- 0.143 (in-sample avg dev_std = 0.290)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.885
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.875
SUFF++ for r=0.9 class 0 = 0.902 +- 0.047 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 1 = 0.913 +- 0.047 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 2 = 0.909 +- 0.047 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all KL = 0.971 +- 0.047 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.092 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.657
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.612
SUFF++ for r=0.3 class 0 = 0.704 +- 0.142 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 class 1 = 0.716 +- 0.142 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 class 2 = 0.694 +- 0.142 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 all KL = 0.817 +- 0.142 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.3 all L1 = 0.707 +- 0.132 (in-sample avg dev_std = 0.340)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.672
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.648
SUFF++ for r=0.6 class 0 = 0.76 +- 0.164 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.6 class 1 = 0.771 +- 0.164 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.6 class 2 = 0.749 +- 0.164 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.6 all KL = 0.842 +- 0.164 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.6 all L1 = 0.762 +- 0.147 (in-sample avg dev_std = 0.316)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.684
SUFF++ for r=0.9 class 0 = 0.893 +- 0.069 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 class 1 = 0.888 +- 0.069 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 class 2 = 0.9 +- 0.069 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all KL = 0.963 +- 0.069 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all L1 = 0.893 +- 0.104 (in-sample avg dev_std = 0.141)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.601
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.594
SUFF++ for r=0.3 class 0 = 0.659 +- 0.156 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 1 = 0.699 +- 0.156 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 2 = 0.652 +- 0.156 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 all KL = 0.803 +- 0.156 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 all L1 = 0.679 +- 0.137 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.608
SUFF++ for r=0.6 class 0 = 0.736 +- 0.143 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 1 = 0.756 +- 0.143 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 2 = 0.71 +- 0.143 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 all KL = 0.847 +- 0.143 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 all L1 = 0.741 +- 0.143 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.634
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.635
SUFF++ for r=0.9 class 0 = 0.859 +- 0.087 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 class 1 = 0.848 +- 0.087 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 class 2 = 0.836 +- 0.087 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 all KL = 0.94 +- 0.087 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.123 (in-sample avg dev_std = 0.153)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.543
SUFF++ for r=0.3 class 0 = 0.713 +- 0.134 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 1 = 0.729 +- 0.134 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 2 = 0.678 +- 0.134 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 all KL = 0.845 +- 0.134 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 all L1 = 0.712 +- 0.121 (in-sample avg dev_std = 0.284)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.572
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.565
SUFF++ for r=0.6 class 0 = 0.796 +- 0.114 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.6 class 1 = 0.79 +- 0.114 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.6 class 2 = 0.758 +- 0.114 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.6 all KL = 0.891 +- 0.114 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.6 all L1 = 0.784 +- 0.125 (in-sample avg dev_std = 0.231)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.582
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.57
SUFF++ for r=0.9 class 0 = 0.863 +- 0.082 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.082 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 class 2 = 0.83 +- 0.082 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all KL = 0.942 +- 0.082 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all L1 = 0.849 +- 0.123 (in-sample avg dev_std = 0.160)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.803
NEC for r=0.3 class 0 = 0.242 +- 0.117 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 1 = 0.188 +- 0.117 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 2 = 0.228 +- 0.117 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all KL = 0.095 +- 0.117 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all L1 = 0.211 +- 0.142 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.838
NEC for r=0.6 class 0 = 0.166 +- 0.112 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 1 = 0.152 +- 0.112 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 2 = 0.175 +- 0.112 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all KL = 0.079 +- 0.112 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all L1 = 0.162 +- 0.134 (in-sample avg dev_std = 0.192)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.87
NEC for r=0.9 class 0 = 0.115 +- 0.062 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 1 = 0.094 +- 0.062 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 2 = 0.118 +- 0.062 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all KL = 0.037 +- 0.062 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all L1 = 0.105 +- 0.102 (in-sample avg dev_std = 0.127)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.881
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.868
NEC for r=1.0 class 0 = 0.105 +- 0.055 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 1 = 0.08 +- 0.055 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 2 = 0.101 +- 0.055 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all KL = 0.03 +- 0.055 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all L1 = 0.091 +- 0.099 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.657
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.638
NEC for r=0.3 class 0 = 0.226 +- 0.129 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1 = 0.208 +- 0.129 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 2 = 0.261 +- 0.129 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.103 +- 0.129 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.227 +- 0.148 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.672
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.659
NEC for r=0.6 class 0 = 0.198 +- 0.126 (in-sample avg dev_std = 0.212)
NEC for r=0.6 class 1 = 0.179 +- 0.126 (in-sample avg dev_std = 0.212)
NEC for r=0.6 class 2 = 0.183 +- 0.126 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all KL = 0.091 +- 0.126 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all L1 = 0.185 +- 0.142 (in-sample avg dev_std = 0.212)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.669
NEC for r=0.9 class 0 = 0.139 +- 0.095 (in-sample avg dev_std = 0.157)
NEC for r=0.9 class 1 = 0.124 +- 0.095 (in-sample avg dev_std = 0.157)
NEC for r=0.9 class 2 = 0.133 +- 0.095 (in-sample avg dev_std = 0.157)
NEC for r=0.9 all KL = 0.052 +- 0.095 (in-sample avg dev_std = 0.157)
NEC for r=0.9 all L1 = 0.13 +- 0.119 (in-sample avg dev_std = 0.157)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.699
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.674
NEC for r=1.0 class 0 = 0.121 +- 0.087 (in-sample avg dev_std = 0.131)
NEC for r=1.0 class 1 = 0.105 +- 0.087 (in-sample avg dev_std = 0.131)
NEC for r=1.0 class 2 = 0.114 +- 0.087 (in-sample avg dev_std = 0.131)
NEC for r=1.0 all KL = 0.04 +- 0.087 (in-sample avg dev_std = 0.131)
NEC for r=1.0 all L1 = 0.111 +- 0.109 (in-sample avg dev_std = 0.131)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.601
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.615
NEC for r=0.3 class 0 = 0.265 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 1 = 0.254 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 2 = 0.293 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=0.3 all KL = 0.132 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=0.3 all L1 = 0.265 +- 0.146 (in-sample avg dev_std = 0.228)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.625
NEC for r=0.6 class 0 = 0.211 +- 0.110 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 1 = 0.193 +- 0.110 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 2 = 0.215 +- 0.110 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all KL = 0.091 +- 0.110 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all L1 = 0.202 +- 0.137 (in-sample avg dev_std = 0.192)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.634
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0 = 0.152 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.9 class 1 = 0.145 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.9 class 2 = 0.164 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.9 all KL = 0.061 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.9 all L1 = 0.151 +- 0.125 (in-sample avg dev_std = 0.150)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.641
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.638
NEC for r=1.0 class 0 = 0.133 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=1.0 class 1 = 0.117 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=1.0 class 2 = 0.132 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all KL = 0.045 +- 0.079 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all L1 = 0.124 +- 0.108 (in-sample avg dev_std = 0.125)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.56
NEC for r=0.3 class 0 = 0.242 +- 0.104 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 1 = 0.222 +- 0.104 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 2 = 0.24 +- 0.104 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.095 +- 0.104 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.232 +- 0.125 (in-sample avg dev_std = 0.193)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.572
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.58
NEC for r=0.6 class 0 = 0.165 +- 0.101 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 1 = 0.178 +- 0.101 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 2 = 0.207 +- 0.101 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all KL = 0.076 +- 0.101 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all L1 = 0.182 +- 0.132 (in-sample avg dev_std = 0.170)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.582
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.576
NEC for r=0.9 class 0 = 0.126 +- 0.085 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1 = 0.137 +- 0.085 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 2 = 0.159 +- 0.085 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.054 +- 0.085 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.139 +- 0.123 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.587
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0 = 0.115 +- 0.089 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 1 = 0.126 +- 0.089 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 2 = 0.152 +- 0.089 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all KL = 0.051 +- 0.089 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all L1 = 0.13 +- 0.127 (in-sample avg dev_std = 0.136)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 02:00:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:54 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:55 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:57 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:00:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8734
Train Loss: 0.3344
ID Validation ACCURACY: 0.7202
ID Validation Loss: 0.8706
ID Test ACCURACY: 0.6751
ID Test Loss: 0.9643
OOD Validation ACCURACY: 0.6291
OOD Validation Loss: 1.2646
OOD Test ACCURACY: 0.5882
OOD Test Loss: 1.8504

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9448
Train Loss: 0.1544
ID Validation ACCURACY: 0.6841
ID Validation Loss: 1.0118
ID Test ACCURACY: 0.6625
ID Test Loss: 1.1612
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 1.4160
OOD Test ACCURACY: 0.5779
OOD Test Loss: 2.1088

[0m[1;37mINFO[0m: [1mChartInfo 0.6751 0.5882 0.6625 0.5779 0.6841 0.6437[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.806
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.73
SUFF++ for r=0.3 class 0 = 0.718 +- 0.122 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 class 1 = 0.786 +- 0.122 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 class 2 = 0.691 +- 0.122 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 all KL = 0.856 +- 0.122 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 all L1 = 0.744 +- 0.125 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.844
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.801
SUFF++ for r=0.6 class 0 = 0.807 +- 0.119 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 class 1 = 0.842 +- 0.119 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 class 2 = 0.792 +- 0.119 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 all KL = 0.901 +- 0.119 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 all L1 = 0.821 +- 0.127 (in-sample avg dev_std = 0.242)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.864
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.846
SUFF++ for r=0.9 class 0 = 0.925 +- 0.058 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 class 1 = 0.933 +- 0.058 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 class 2 = 0.894 +- 0.058 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 all KL = 0.975 +- 0.058 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 all L1 = 0.921 +- 0.087 (in-sample avg dev_std = 0.115)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.651
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.595
SUFF++ for r=0.3 class 0 = 0.711 +- 0.126 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 1 = 0.754 +- 0.126 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 2 = 0.709 +- 0.126 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 all KL = 0.845 +- 0.126 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 all L1 = 0.731 +- 0.125 (in-sample avg dev_std = 0.323)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.662
SUFF++ for r=0.6 class 0 = 0.781 +- 0.128 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 1 = 0.826 +- 0.128 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 2 = 0.783 +- 0.128 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 all KL = 0.888 +- 0.128 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 all L1 = 0.803 +- 0.135 (in-sample avg dev_std = 0.255)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.694
SUFF++ for r=0.9 class 0 = 0.898 +- 0.074 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 class 1 = 0.91 +- 0.074 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 class 2 = 0.895 +- 0.074 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 all KL = 0.965 +- 0.074 (in-sample avg dev_std = 0.143)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.101 (in-sample avg dev_std = 0.143)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.583
SUFF++ for r=0.3 class 0 = 0.695 +- 0.141 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.3 class 1 = 0.733 +- 0.141 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.3 class 2 = 0.685 +- 0.141 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.3 all KL = 0.831 +- 0.141 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.3 all L1 = 0.714 +- 0.136 (in-sample avg dev_std = 0.303)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.603
SUFF++ for r=0.6 class 0 = 0.753 +- 0.154 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 class 1 = 0.756 +- 0.154 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 class 2 = 0.719 +- 0.154 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all KL = 0.832 +- 0.154 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all L1 = 0.747 +- 0.153 (in-sample avg dev_std = 0.301)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.623
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.623
SUFF++ for r=0.9 class 0 = 0.88 +- 0.093 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1 = 0.878 +- 0.093 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 2 = 0.86 +- 0.093 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.949 +- 0.093 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.875 +- 0.124 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.546
SUFF++ for r=0.3 class 0 = 0.718 +- 0.138 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 class 1 = 0.728 +- 0.138 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 class 2 = 0.691 +- 0.138 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 all KL = 0.83 +- 0.138 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 all L1 = 0.716 +- 0.131 (in-sample avg dev_std = 0.299)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.567
SUFF++ for r=0.6 class 0 = 0.798 +- 0.128 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 1 = 0.777 +- 0.128 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 2 = 0.739 +- 0.128 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all KL = 0.868 +- 0.128 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all L1 = 0.773 +- 0.144 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.595
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.585
SUFF++ for r=0.9 class 0 = 0.875 +- 0.079 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 class 1 = 0.858 +- 0.079 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 class 2 = 0.85 +- 0.079 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all KL = 0.943 +- 0.079 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.129 (in-sample avg dev_std = 0.163)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.806
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.784
NEC for r=0.3 class 0 = 0.214 +- 0.105 (in-sample avg dev_std = 0.168)
NEC for r=0.3 class 1 = 0.16 +- 0.105 (in-sample avg dev_std = 0.168)
NEC for r=0.3 class 2 = 0.257 +- 0.105 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all KL = 0.079 +- 0.105 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all L1 = 0.199 +- 0.137 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.844
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.819
NEC for r=0.6 class 0 = 0.16 +- 0.104 (in-sample avg dev_std = 0.172)
NEC for r=0.6 class 1 = 0.133 +- 0.104 (in-sample avg dev_std = 0.172)
NEC for r=0.6 class 2 = 0.198 +- 0.104 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all KL = 0.07 +- 0.104 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all L1 = 0.157 +- 0.133 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.864
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.844
NEC for r=0.9 class 0 = 0.099 +- 0.072 (in-sample avg dev_std = 0.121)
NEC for r=0.9 class 1 = 0.087 +- 0.072 (in-sample avg dev_std = 0.121)
NEC for r=0.9 class 2 = 0.143 +- 0.072 (in-sample avg dev_std = 0.121)
NEC for r=0.9 all KL = 0.036 +- 0.072 (in-sample avg dev_std = 0.121)
NEC for r=0.9 all L1 = 0.104 +- 0.104 (in-sample avg dev_std = 0.121)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.872
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.854
NEC for r=1.0 class 0 = 0.088 +- 0.058 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 1 = 0.072 +- 0.058 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 2 = 0.124 +- 0.058 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all KL = 0.028 +- 0.058 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all L1 = 0.09 +- 0.096 (in-sample avg dev_std = 0.102)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.651
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.633
NEC for r=0.3 class 0 = 0.242 +- 0.119 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 1 = 0.176 +- 0.119 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 2 = 0.254 +- 0.119 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all KL = 0.089 +- 0.119 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all L1 = 0.214 +- 0.145 (in-sample avg dev_std = 0.187)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.673
NEC for r=0.6 class 0 = 0.192 +- 0.113 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 1 = 0.151 +- 0.113 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 2 = 0.195 +- 0.113 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all KL = 0.08 +- 0.113 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all L1 = 0.173 +- 0.140 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0 = 0.134 +- 0.082 (in-sample avg dev_std = 0.144)
NEC for r=0.9 class 1 = 0.101 +- 0.082 (in-sample avg dev_std = 0.144)
NEC for r=0.9 class 2 = 0.13 +- 0.082 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all KL = 0.043 +- 0.082 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all L1 = 0.117 +- 0.106 (in-sample avg dev_std = 0.144)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.717
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.701
NEC for r=1.0 class 0 = 0.114 +- 0.073 (in-sample avg dev_std = 0.123)
NEC for r=1.0 class 1 = 0.088 +- 0.073 (in-sample avg dev_std = 0.123)
NEC for r=1.0 class 2 = 0.108 +- 0.073 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all KL = 0.034 +- 0.073 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all L1 = 0.1 +- 0.098 (in-sample avg dev_std = 0.123)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.606
NEC for r=0.3 class 0 = 0.269 +- 0.143 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 1 = 0.232 +- 0.143 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 2 = 0.267 +- 0.143 (in-sample avg dev_std = 0.224)
NEC for r=0.3 all KL = 0.125 +- 0.143 (in-sample avg dev_std = 0.224)
NEC for r=0.3 all L1 = 0.249 +- 0.151 (in-sample avg dev_std = 0.224)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.612
NEC for r=0.6 class 0 = 0.207 +- 0.135 (in-sample avg dev_std = 0.209)
NEC for r=0.6 class 1 = 0.19 +- 0.135 (in-sample avg dev_std = 0.209)
NEC for r=0.6 class 2 = 0.218 +- 0.135 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all KL = 0.103 +- 0.135 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all L1 = 0.2 +- 0.149 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.623
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.623
NEC for r=0.9 class 0 = 0.142 +- 0.102 (in-sample avg dev_std = 0.159)
NEC for r=0.9 class 1 = 0.139 +- 0.102 (in-sample avg dev_std = 0.159)
NEC for r=0.9 class 2 = 0.168 +- 0.102 (in-sample avg dev_std = 0.159)
NEC for r=0.9 all KL = 0.063 +- 0.102 (in-sample avg dev_std = 0.159)
NEC for r=0.9 all L1 = 0.146 +- 0.135 (in-sample avg dev_std = 0.159)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.626
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.625
NEC for r=1.0 class 0 = 0.125 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=1.0 class 1 = 0.118 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=1.0 class 2 = 0.137 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=1.0 all KL = 0.048 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=1.0 all L1 = 0.124 +- 0.122 (in-sample avg dev_std = 0.131)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.574
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.565
NEC for r=0.3 class 0 = 0.245 +- 0.123 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 1 = 0.216 +- 0.123 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 2 = 0.24 +- 0.123 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all KL = 0.108 +- 0.123 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all L1 = 0.229 +- 0.143 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.579
NEC for r=0.6 class 0 = 0.164 +- 0.101 (in-sample avg dev_std = 0.180)
NEC for r=0.6 class 1 = 0.177 +- 0.101 (in-sample avg dev_std = 0.180)
NEC for r=0.6 class 2 = 0.2 +- 0.101 (in-sample avg dev_std = 0.180)
NEC for r=0.6 all KL = 0.08 +- 0.101 (in-sample avg dev_std = 0.180)
NEC for r=0.6 all L1 = 0.179 +- 0.141 (in-sample avg dev_std = 0.180)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.595
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.581
NEC for r=0.9 class 0 = 0.124 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.9 class 1 = 0.133 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.9 class 2 = 0.155 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.9 all KL = 0.055 +- 0.083 (in-sample avg dev_std = 0.146)
NEC for r=0.9 all L1 = 0.136 +- 0.128 (in-sample avg dev_std = 0.146)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.582
NEC for r=1.0 class 0 = 0.119 +- 0.090 (in-sample avg dev_std = 0.137)
NEC for r=1.0 class 1 = 0.116 +- 0.090 (in-sample avg dev_std = 0.137)
NEC for r=1.0 class 2 = 0.138 +- 0.090 (in-sample avg dev_std = 0.137)
NEC for r=1.0 all KL = 0.05 +- 0.090 (in-sample avg dev_std = 0.137)
NEC for r=1.0 all L1 = 0.122 +- 0.125 (in-sample avg dev_std = 0.137)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 02:07:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:25 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:28 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:28 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:29 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:31 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:07:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.6986
ID Validation Loss: 3.3225
ID Test ACCURACY: 0.6823
ID Test Loss: 3.4204
OOD Validation ACCURACY: 0.6090
OOD Validation Loss: 4.1729
OOD Test ACCURACY: 0.5573
OOD Test Loss: 6.0573

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8158
Train Loss: 0.4571
ID Validation ACCURACY: 0.6841
ID Validation Loss: 0.8000
ID Test ACCURACY: 0.7040
ID Test Loss: 0.7929
OOD Validation ACCURACY: 0.6415
OOD Validation Loss: 1.0189
OOD Test ACCURACY: 0.5889
OOD Test Loss: 1.3595

[0m[1;37mINFO[0m: [1mChartInfo 0.6823 0.5573 0.7040 0.5889 0.6841 0.6415[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.893
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.794
SUFF++ for r=0.3 class 0 = 0.578 +- 0.396 (in-sample avg dev_std = 0.624)
SUFF++ for r=0.3 class 1 = 0.823 +- 0.396 (in-sample avg dev_std = 0.624)
SUFF++ for r=0.3 class 2 = 0.741 +- 0.396 (in-sample avg dev_std = 0.624)
SUFF++ for r=0.3 all KL = 0.429 +- 0.396 (in-sample avg dev_std = 0.624)
SUFF++ for r=0.3 all L1 = 0.743 +- 0.219 (in-sample avg dev_std = 0.624)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.969
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.902
SUFF++ for r=0.6 class 0 = 0.738 +- 0.410 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 1 = 0.889 +- 0.410 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 2 = 0.884 +- 0.410 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all KL = 0.595 +- 0.410 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all L1 = 0.851 +- 0.177 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.997
SUFF++ for r=0.9 class 0 = 0.988 +- 0.120 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 class 1 = 0.991 +- 0.120 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 class 2 = 0.995 +- 0.120 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 all KL = 0.977 +- 0.120 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 all L1 = 0.991 +- 0.052 (in-sample avg dev_std = 0.092)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.554
SUFF++ for r=0.3 class 0 = 0.609 +- 0.371 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 class 1 = 0.686 +- 0.371 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 class 2 = 0.67 +- 0.371 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 all KL = 0.4 +- 0.371 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 all L1 = 0.663 +- 0.231 (in-sample avg dev_std = 0.660)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.644
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0 = 0.739 +- 0.373 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 1 = 0.775 +- 0.373 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 2 = 0.761 +- 0.373 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all KL = 0.577 +- 0.373 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all L1 = 0.762 +- 0.218 (in-sample avg dev_std = 0.515)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.681
SUFF++ for r=0.9 class 0 = 0.885 +- 0.190 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.909 +- 0.190 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.896 +- 0.190 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.897 +- 0.190 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.9 +- 0.164 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.479
SUFF++ for r=0.3 class 0 = 0.612 +- 0.347 (in-sample avg dev_std = 0.655)
SUFF++ for r=0.3 class 1 = 0.665 +- 0.347 (in-sample avg dev_std = 0.655)
SUFF++ for r=0.3 class 2 = 0.634 +- 0.347 (in-sample avg dev_std = 0.655)
SUFF++ for r=0.3 all KL = 0.404 +- 0.347 (in-sample avg dev_std = 0.655)
SUFF++ for r=0.3 all L1 = 0.645 +- 0.231 (in-sample avg dev_std = 0.655)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.545
SUFF++ for r=0.6 class 0 = 0.705 +- 0.351 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 class 1 = 0.73 +- 0.351 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.351 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 all KL = 0.571 +- 0.351 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 all L1 = 0.725 +- 0.224 (in-sample avg dev_std = 0.525)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.603
SUFF++ for r=0.9 class 0 = 0.883 +- 0.188 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.883 +- 0.188 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.188 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.894 +- 0.188 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.176 (in-sample avg dev_std = 0.229)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.447
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.417
SUFF++ for r=0.3 class 0 = 0.6 +- 0.321 (in-sample avg dev_std = 0.692)
SUFF++ for r=0.3 class 1 = 0.609 +- 0.321 (in-sample avg dev_std = 0.692)
SUFF++ for r=0.3 class 2 = 0.591 +- 0.321 (in-sample avg dev_std = 0.692)
SUFF++ for r=0.3 all KL = 0.332 +- 0.321 (in-sample avg dev_std = 0.692)
SUFF++ for r=0.3 all L1 = 0.602 +- 0.214 (in-sample avg dev_std = 0.692)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.499
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.475
SUFF++ for r=0.6 class 0 = 0.707 +- 0.354 (in-sample avg dev_std = 0.561)
SUFF++ for r=0.6 class 1 = 0.689 +- 0.354 (in-sample avg dev_std = 0.561)
SUFF++ for r=0.6 class 2 = 0.67 +- 0.354 (in-sample avg dev_std = 0.561)
SUFF++ for r=0.6 all KL = 0.516 +- 0.354 (in-sample avg dev_std = 0.561)
SUFF++ for r=0.6 all L1 = 0.689 +- 0.231 (in-sample avg dev_std = 0.561)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.536
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.532
SUFF++ for r=0.9 class 0 = 0.875 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.856 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.869 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.864 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.864 +- 0.187 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.893
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.893
NEC for r=0.3 class 0 = 0.285 +- 0.325 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 1 = 0.078 +- 0.325 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 2 = 0.087 +- 0.325 (in-sample avg dev_std = 0.302)
NEC for r=0.3 all KL = 0.192 +- 0.325 (in-sample avg dev_std = 0.302)
NEC for r=0.3 all L1 = 0.13 +- 0.231 (in-sample avg dev_std = 0.302)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.969
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.969
NEC for r=0.6 class 0 = 0.128 +- 0.213 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 1 = 0.021 +- 0.213 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 2 = 0.024 +- 0.213 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all KL = 0.077 +- 0.213 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all L1 = 0.048 +- 0.139 (in-sample avg dev_std = 0.189)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.993
NEC for r=0.9 class 0 = 0.022 +- 0.114 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 1 = 0.009 +- 0.114 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 2 = 0.003 +- 0.114 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all KL = 0.021 +- 0.114 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all L1 = 0.01 +- 0.071 (in-sample avg dev_std = 0.091)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  1.0
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.995
NEC for r=1.0 class 0 = 0.017 +- 0.108 (in-sample avg dev_std = 0.079)
NEC for r=1.0 class 1 = 0.008 +- 0.108 (in-sample avg dev_std = 0.079)
NEC for r=1.0 class 2 = 0.001 +- 0.108 (in-sample avg dev_std = 0.079)
NEC for r=1.0 all KL = 0.018 +- 0.108 (in-sample avg dev_std = 0.079)
NEC for r=1.0 all L1 = 0.008 +- 0.062 (in-sample avg dev_std = 0.079)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 0 = 0.344 +- 0.404 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 1 = 0.271 +- 0.404 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 2 = 0.27 +- 0.404 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all KL = 0.381 +- 0.404 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all L1 = 0.289 +- 0.305 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.644
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.642
NEC for r=0.6 class 0 = 0.239 +- 0.329 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 1 = 0.174 +- 0.329 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 2 = 0.169 +- 0.329 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all KL = 0.24 +- 0.329 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all L1 = 0.189 +- 0.245 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0 = 0.123 +- 0.217 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 1 = 0.102 +- 0.217 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 2 = 0.141 +- 0.217 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all KL = 0.113 +- 0.217 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all L1 = 0.118 +- 0.199 (in-sample avg dev_std = 0.247)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.695
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.672
NEC for r=1.0 class 0 = 0.104 +- 0.198 (in-sample avg dev_std = 0.238)
NEC for r=1.0 class 1 = 0.093 +- 0.198 (in-sample avg dev_std = 0.238)
NEC for r=1.0 class 2 = 0.118 +- 0.198 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all KL = 0.1 +- 0.198 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all L1 = 0.103 +- 0.176 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.541
NEC for r=0.3 class 0 = 0.352 +- 0.390 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 1 = 0.316 +- 0.390 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 2 = 0.32 +- 0.390 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all KL = 0.451 +- 0.390 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all L1 = 0.326 +- 0.297 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.59
NEC for r=0.6 class 0 = 0.276 +- 0.333 (in-sample avg dev_std = 0.372)
NEC for r=0.6 class 1 = 0.218 +- 0.333 (in-sample avg dev_std = 0.372)
NEC for r=0.6 class 2 = 0.233 +- 0.333 (in-sample avg dev_std = 0.372)
NEC for r=0.6 all KL = 0.289 +- 0.333 (in-sample avg dev_std = 0.372)
NEC for r=0.6 all L1 = 0.236 +- 0.261 (in-sample avg dev_std = 0.372)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.156 +- 0.244 (in-sample avg dev_std = 0.249)
NEC for r=0.9 class 1 = 0.138 +- 0.244 (in-sample avg dev_std = 0.249)
NEC for r=0.9 class 2 = 0.143 +- 0.244 (in-sample avg dev_std = 0.249)
NEC for r=0.9 all KL = 0.143 +- 0.244 (in-sample avg dev_std = 0.249)
NEC for r=0.9 all L1 = 0.144 +- 0.214 (in-sample avg dev_std = 0.249)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.596
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.612
NEC for r=1.0 class 0 = 0.131 +- 0.235 (in-sample avg dev_std = 0.248)
NEC for r=1.0 class 1 = 0.123 +- 0.235 (in-sample avg dev_std = 0.248)
NEC for r=1.0 class 2 = 0.131 +- 0.235 (in-sample avg dev_std = 0.248)
NEC for r=1.0 all KL = 0.132 +- 0.235 (in-sample avg dev_std = 0.248)
NEC for r=1.0 all L1 = 0.127 +- 0.198 (in-sample avg dev_std = 0.248)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.447
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.461
NEC for r=0.3 class 0 = 0.3 +- 0.385 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.333 +- 0.385 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.354 +- 0.385 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.46 +- 0.385 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.33 +- 0.284 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.499
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.509
NEC for r=0.6 class 0 = 0.254 +- 0.347 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 1 = 0.273 +- 0.347 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 2 = 0.259 +- 0.347 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all KL = 0.323 +- 0.347 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all L1 = 0.265 +- 0.268 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.536
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.54
NEC for r=0.9 class 0 = 0.126 +- 0.240 (in-sample avg dev_std = 0.254)
NEC for r=0.9 class 1 = 0.162 +- 0.240 (in-sample avg dev_std = 0.254)
NEC for r=0.9 class 2 = 0.152 +- 0.240 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all KL = 0.151 +- 0.240 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all L1 = 0.151 +- 0.212 (in-sample avg dev_std = 0.254)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.535
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.539
NEC for r=1.0 class 0 = 0.099 +- 0.237 (in-sample avg dev_std = 0.258)
NEC for r=1.0 class 1 = 0.149 +- 0.237 (in-sample avg dev_std = 0.258)
NEC for r=1.0 class 2 = 0.144 +- 0.237 (in-sample avg dev_std = 0.258)
NEC for r=1.0 all KL = 0.136 +- 0.237 (in-sample avg dev_std = 0.258)
NEC for r=1.0 all L1 = 0.135 +- 0.205 (in-sample avg dev_std = 0.258)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 02:13:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:51 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:53 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:54 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:54 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:56 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:13:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9351
Train Loss: 0.1964
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.9889
ID Test ACCURACY: 0.6715
ID Test Loss: 1.0936
OOD Validation ACCURACY: 0.6213
OOD Validation Loss: 1.3820
OOD Test ACCURACY: 0.5806
OOD Test Loss: 1.9963

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8988
Train Loss: 0.2761
ID Validation ACCURACY: 0.6841
ID Validation Loss: 0.9618
ID Test ACCURACY: 0.6859
ID Test Loss: 0.9980
OOD Validation ACCURACY: 0.6392
OOD Validation Loss: 1.2491
OOD Test ACCURACY: 0.5957
OOD Test Loss: 1.7247

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5806 0.6859 0.5957 0.6841 0.6392[0mGOODTwitter(2590)
Data example from train: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from train: (tensor([0, 1, 2]), tensor([ 625, 1283,  682]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.808
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.718
SUFF++ for r=0.3 class 0 = 0.631 +- 0.170 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 class 1 = 0.804 +- 0.170 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 class 2 = 0.67 +- 0.170 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 all KL = 0.802 +- 0.170 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 all L1 = 0.727 +- 0.148 (in-sample avg dev_std = 0.367)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.824
SUFF++ for r=0.6 class 0 = 0.734 +- 0.157 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 1 = 0.846 +- 0.157 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 2 = 0.777 +- 0.157 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all KL = 0.853 +- 0.157 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all L1 = 0.801 +- 0.141 (in-sample avg dev_std = 0.296)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 794
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.914
SUFF++ for r=0.9 class 0 = 0.9 +- 0.058 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 1 = 0.938 +- 0.058 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 2 = 0.914 +- 0.058 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all KL = 0.972 +- 0.058 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.094 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.648
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.591
SUFF++ for r=0.3 class 0 = 0.676 +- 0.157 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 1 = 0.762 +- 0.157 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 2 = 0.695 +- 0.157 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 all KL = 0.815 +- 0.157 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 all L1 = 0.723 +- 0.149 (in-sample avg dev_std = 0.346)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.653
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.634
SUFF++ for r=0.6 class 0 = 0.743 +- 0.145 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 1 = 0.788 +- 0.145 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 2 = 0.784 +- 0.145 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all KL = 0.852 +- 0.145 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all L1 = 0.776 +- 0.152 (in-sample avg dev_std = 0.296)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.671
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.674
SUFF++ for r=0.9 class 0 = 0.875 +- 0.078 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 class 1 = 0.9 +- 0.078 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 class 2 = 0.883 +- 0.078 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 all KL = 0.956 +- 0.078 (in-sample avg dev_std = 0.159)
SUFF++ for r=0.9 all L1 = 0.889 +- 0.119 (in-sample avg dev_std = 0.159)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0 = 0.691 +- 0.152 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 class 1 = 0.764 +- 0.152 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 class 2 = 0.706 +- 0.152 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 all KL = 0.838 +- 0.152 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 all L1 = 0.733 +- 0.146 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.634
SUFF++ for r=0.6 class 0 = 0.771 +- 0.128 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 class 1 = 0.81 +- 0.128 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 class 2 = 0.761 +- 0.128 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all KL = 0.882 +- 0.128 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all L1 = 0.79 +- 0.144 (in-sample avg dev_std = 0.243)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.636
SUFF++ for r=0.9 class 0 = 0.88 +- 0.082 (in-sample avg dev_std = 0.145)
SUFF++ for r=0.9 class 1 = 0.874 +- 0.082 (in-sample avg dev_std = 0.145)
SUFF++ for r=0.9 class 2 = 0.864 +- 0.082 (in-sample avg dev_std = 0.145)
SUFF++ for r=0.9 all KL = 0.95 +- 0.082 (in-sample avg dev_std = 0.145)
SUFF++ for r=0.9 all L1 = 0.873 +- 0.121 (in-sample avg dev_std = 0.145)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.595
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.56
SUFF++ for r=0.3 class 0 = 0.723 +- 0.159 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.3 class 1 = 0.775 +- 0.159 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.3 class 2 = 0.701 +- 0.159 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.3 all KL = 0.852 +- 0.159 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.3 all L1 = 0.743 +- 0.148 (in-sample avg dev_std = 0.276)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.584
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.578
SUFF++ for r=0.6 class 0 = 0.78 +- 0.136 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 class 1 = 0.8 +- 0.136 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 class 2 = 0.769 +- 0.136 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 all KL = 0.874 +- 0.136 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.6 all L1 = 0.787 +- 0.147 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.574
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.587
SUFF++ for r=0.9 class 0 = 0.886 +- 0.082 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 class 1 = 0.878 +- 0.082 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 class 2 = 0.866 +- 0.082 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 all KL = 0.95 +- 0.082 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 all L1 = 0.877 +- 0.122 (in-sample avg dev_std = 0.151)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over train across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.808
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 797
Effective ratio: 0.314 +- 0.014
Model Accuracy over intervened graphs for r=0.3 =  0.79
NEC for r=0.3 class 0 = 0.256 +- 0.141 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 1 = 0.128 +- 0.141 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 2 = 0.277 +- 0.141 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all KL = 0.097 +- 0.141 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all L1 = 0.198 +- 0.163 (in-sample avg dev_std = 0.185)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 797
Effective ratio: 0.615 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.861
NEC for r=0.6 class 0 = 0.196 +- 0.115 (in-sample avg dev_std = 0.177)
NEC for r=0.6 class 1 = 0.108 +- 0.115 (in-sample avg dev_std = 0.177)
NEC for r=0.6 class 2 = 0.174 +- 0.115 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all KL = 0.075 +- 0.115 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all L1 = 0.146 +- 0.136 (in-sample avg dev_std = 0.177)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 797
Effective ratio: 0.915 +- 0.015
Model Accuracy over intervened graphs for r=0.9 =  0.909
NEC for r=0.9 class 0 = 0.134 +- 0.076 (in-sample avg dev_std = 0.124)
NEC for r=0.9 class 1 = 0.074 +- 0.076 (in-sample avg dev_std = 0.124)
NEC for r=0.9 class 2 = 0.106 +- 0.076 (in-sample avg dev_std = 0.124)
NEC for r=0.9 all KL = 0.039 +- 0.076 (in-sample avg dev_std = 0.124)
NEC for r=0.9 all L1 = 0.097 +- 0.109 (in-sample avg dev_std = 0.124)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.927
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 797
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.914
NEC for r=1.0 class 0 = 0.107 +- 0.071 (in-sample avg dev_std = 0.109)
NEC for r=1.0 class 1 = 0.067 +- 0.071 (in-sample avg dev_std = 0.109)
NEC for r=1.0 class 2 = 0.092 +- 0.071 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all KL = 0.032 +- 0.071 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all L1 = 0.083 +- 0.101 (in-sample avg dev_std = 0.109)



--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.648
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.627
NEC for r=0.3 class 0 = 0.257 +- 0.147 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.178 +- 0.147 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.272 +- 0.147 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.114 +- 0.147 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.223 +- 0.166 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.653
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0 = 0.222 +- 0.147 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 1 = 0.169 +- 0.147 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 2 = 0.187 +- 0.147 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all KL = 0.103 +- 0.147 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all L1 = 0.187 +- 0.156 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.673
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.14 +- 0.102 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 1 = 0.12 +- 0.102 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 2 = 0.136 +- 0.102 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all KL = 0.057 +- 0.102 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all L1 = 0.129 +- 0.129 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.697
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.678
NEC for r=1.0 class 0 = 0.126 +- 0.091 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1 = 0.107 +- 0.091 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 2 = 0.121 +- 0.091 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.047 +- 0.091 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.115 +- 0.125 (in-sample avg dev_std = 0.142)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.617
NEC for r=0.3 class 0 = 0.255 +- 0.128 (in-sample avg dev_std = 0.197)
NEC for r=0.3 class 1 = 0.193 +- 0.128 (in-sample avg dev_std = 0.197)
NEC for r=0.3 class 2 = 0.243 +- 0.128 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all KL = 0.104 +- 0.128 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all L1 = 0.219 +- 0.145 (in-sample avg dev_std = 0.197)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.641
NEC for r=0.6 class 0 = 0.198 +- 0.118 (in-sample avg dev_std = 0.187)
NEC for r=0.6 class 1 = 0.16 +- 0.118 (in-sample avg dev_std = 0.187)
NEC for r=0.6 class 2 = 0.191 +- 0.118 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all KL = 0.084 +- 0.118 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all L1 = 0.176 +- 0.143 (in-sample avg dev_std = 0.187)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.637
NEC for r=0.9 class 0 = 0.132 +- 0.097 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1 = 0.131 +- 0.097 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 2 = 0.143 +- 0.097 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.057 +- 0.097 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.134 +- 0.130 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.623
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.635
NEC for r=1.0 class 0 = 0.12 +- 0.106 (in-sample avg dev_std = 0.148)
NEC for r=1.0 class 1 = 0.129 +- 0.106 (in-sample avg dev_std = 0.148)
NEC for r=1.0 class 2 = 0.138 +- 0.106 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all KL = 0.058 +- 0.106 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all L1 = 0.129 +- 0.141 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.595
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.577
NEC for r=0.3 class 0 = 0.231 +- 0.124 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 1 = 0.193 +- 0.124 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 2 = 0.241 +- 0.124 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.098 +- 0.124 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.215 +- 0.143 (in-sample avg dev_std = 0.200)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.584
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.59
NEC for r=0.6 class 0 = 0.187 +- 0.122 (in-sample avg dev_std = 0.178)
NEC for r=0.6 class 1 = 0.166 +- 0.122 (in-sample avg dev_std = 0.178)
NEC for r=0.6 class 2 = 0.186 +- 0.122 (in-sample avg dev_std = 0.178)
NEC for r=0.6 all KL = 0.086 +- 0.122 (in-sample avg dev_std = 0.178)
NEC for r=0.6 all L1 = 0.176 +- 0.148 (in-sample avg dev_std = 0.178)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.574
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.576
NEC for r=0.9 class 0 = 0.129 +- 0.099 (in-sample avg dev_std = 0.133)
NEC for r=0.9 class 1 = 0.13 +- 0.099 (in-sample avg dev_std = 0.133)
NEC for r=0.9 class 2 = 0.136 +- 0.099 (in-sample avg dev_std = 0.133)
NEC for r=0.9 all KL = 0.057 +- 0.099 (in-sample avg dev_std = 0.133)
NEC for r=0.9 all L1 = 0.131 +- 0.140 (in-sample avg dev_std = 0.133)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.577
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.116 +- 0.115 (in-sample avg dev_std = 0.153)
NEC for r=1.0 class 1 = 0.126 +- 0.115 (in-sample avg dev_std = 0.153)
NEC for r=1.0 class 2 = 0.139 +- 0.115 (in-sample avg dev_std = 0.153)
NEC for r=1.0 all KL = 0.062 +- 0.115 (in-sample avg dev_std = 0.153)
NEC for r=1.0 all L1 = 0.127 +- 0.146 (in-sample avg dev_std = 0.153)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split train
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.39, 0.567, 0.971, 1.0], 'all_L1': [0.688, 0.824, 0.99, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.822, 0.858, 0.971, 1.0], 'all_L1': [0.719, 0.785, 0.909, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.901, 0.975, 1.0], 'all_L1': [0.744, 0.821, 0.921, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.595, 0.977, 1.0], 'all_L1': [0.743, 0.851, 0.991, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.853, 0.972, 1.0], 'all_L1': [0.727, 0.801, 0.923, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.211, 0.068, 0.018, 0.017], 'all_L1': [0.149, 0.043, 0.008, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.079, 0.037, 0.03], 'all_L1': [0.211, 0.162, 0.105, 0.091]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.07, 0.036, 0.028], 'all_L1': [0.199, 0.157, 0.104, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.192, 0.077, 0.021, 0.018], 'all_L1': [0.13, 0.048, 0.01, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.097, 0.075, 0.039, 0.032], 'all_L1': [0.198, 0.146, 0.097, 0.083]})]

Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.409, 0.553, 0.86, 1.0], 'all_L1': [0.631, 0.722, 0.87, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.817, 0.842, 0.963, 1.0], 'all_L1': [0.707, 0.762, 0.893, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.888, 0.965, 1.0], 'all_L1': [0.731, 0.803, 0.903, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.577, 0.897, 1.0], 'all_L1': [0.663, 0.762, 0.9, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.815, 0.852, 0.956, 1.0], 'all_L1': [0.723, 0.776, 0.889, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.355, 0.234, 0.112, 0.085], 'all_L1': [0.283, 0.199, 0.118, 0.096]}), defaultdict(<class 'list'>, {'all_KL': [0.103, 0.091, 0.052, 0.04], 'all_L1': [0.227, 0.185, 0.13, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.08, 0.043, 0.034], 'all_L1': [0.214, 0.173, 0.117, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.381, 0.24, 0.113, 0.1], 'all_L1': [0.289, 0.189, 0.118, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.114, 0.103, 0.057, 0.047], 'all_L1': [0.223, 0.187, 0.129, 0.115]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.438, 0.621, 0.863, 1.0], 'all_L1': [0.614, 0.716, 0.846, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.803, 0.847, 0.94, 1.0], 'all_L1': [0.679, 0.741, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.831, 0.832, 0.949, 1.0], 'all_L1': [0.714, 0.747, 0.875, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.571, 0.894, 1.0], 'all_L1': [0.645, 0.725, 0.885, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.838, 0.882, 0.95, 1.0], 'all_L1': [0.733, 0.79, 0.873, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.455, 0.259, 0.135, 0.135], 'all_L1': [0.363, 0.241, 0.154, 0.146]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.091, 0.061, 0.045], 'all_L1': [0.265, 0.202, 0.151, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.125, 0.103, 0.063, 0.048], 'all_L1': [0.249, 0.2, 0.146, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.451, 0.289, 0.143, 0.132], 'all_L1': [0.326, 0.236, 0.144, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.084, 0.057, 0.058], 'all_L1': [0.219, 0.176, 0.134, 0.129]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.442, 0.626, 0.871, 1.0], 'all_L1': [0.619, 0.722, 0.856, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.891, 0.942, 1.0], 'all_L1': [0.712, 0.784, 0.849, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.868, 0.943, 1.0], 'all_L1': [0.716, 0.773, 0.86, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.332, 0.516, 0.864, 1.0], 'all_L1': [0.602, 0.689, 0.864, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.852, 0.874, 0.95, 1.0], 'all_L1': [0.743, 0.787, 0.877, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.413, 0.237, 0.128, 0.115], 'all_L1': [0.337, 0.23, 0.148, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.076, 0.054, 0.051], 'all_L1': [0.232, 0.182, 0.139, 0.13]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.08, 0.055, 0.05], 'all_L1': [0.229, 0.179, 0.136, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.46, 0.323, 0.151, 0.136], 'all_L1': [0.33, 0.265, 0.151, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.098, 0.086, 0.057, 0.062], 'all_L1': [0.215, 0.176, 0.131, 0.127]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split train
suff++ class all_L1  =  0.724 +- 0.020, 0.816 +- 0.022, 0.947 +- 0.036, 1.000 +- 0.000
suff++ class all_KL  =  0.660 +- 0.205, 0.755 +- 0.143, 0.973 +- 0.002, 1.000 +- 0.000
suff++_acc_int  =  0.752 +- 0.028, 0.846 +- 0.044, 0.926 +- 0.062
nec class all_L1  =  0.177 +- 0.032, 0.111 +- 0.054, 0.065 +- 0.046, 0.056 +- 0.040
nec class all_KL  =  0.135 +- 0.055, 0.074 +- 0.004, 0.030 +- 0.009, 0.025 +- 0.006
nec_acc_int  =  0.833 +- 0.051, 0.894 +- 0.068, 0.923 +- 0.063, 0.926 +- 0.061

Eval split id_val
suff++ class all_L1  =  0.691 +- 0.038, 0.765 +- 0.026, 0.891 +- 0.012, 1.000 +- 0.000
suff++ class all_KL  =  0.657 +- 0.207, 0.742 +- 0.146, 0.928 +- 0.042, 1.000 +- 0.000
suff++_acc_int  =  0.579 +- 0.026, 0.638 +- 0.015, 0.683 +- 0.006
nec class all_L1  =  0.247 +- 0.032, 0.187 +- 0.008, 0.122 +- 0.006, 0.105 +- 0.007
nec class all_KL  =  0.208 +- 0.131, 0.150 +- 0.072, 0.075 +- 0.031, 0.061 +- 0.026
nec_acc_int  =  0.618 +- 0.019, 0.657 +- 0.011, 0.678 +- 0.009, 0.681 +- 0.010

Eval split val
suff++ class all_L1  =  0.677 +- 0.044, 0.744 +- 0.026, 0.865 +- 0.016, 1.000 +- 0.000
suff++ class all_KL  =  0.663 +- 0.198, 0.751 +- 0.128, 0.919 +- 0.035, 1.000 +- 0.000
suff++_acc_int  =  0.547 +- 0.055, 0.587 +- 0.035, 0.619 +- 0.016
nec class all_L1  =  0.284 +- 0.053, 0.211 +- 0.024, 0.146 +- 0.007, 0.130 +- 0.008
nec class all_KL  =  0.253 +- 0.163, 0.165 +- 0.090, 0.092 +- 0.039, 0.084 +- 0.041
nec_acc_int  =  0.579 +- 0.043, 0.607 +- 0.026, 0.619 +- 0.017, 0.621 +- 0.016

Eval split test
suff++ class all_L1  =  0.678 +- 0.057, 0.751 +- 0.039, 0.861 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.660 +- 0.226, 0.755 +- 0.154, 0.914 +- 0.038, 1.000 +- 0.000
suff++_acc_int  =  0.505 +- 0.056, 0.539 +- 0.040, 0.561 +- 0.025
nec class all_L1  =  0.269 +- 0.053, 0.206 +- 0.035, 0.141 +- 0.007, 0.128 +- 0.004
nec class all_KL  =  0.235 +- 0.165, 0.160 +- 0.101, 0.089 +- 0.042, 0.083 +- 0.036
nec_acc_int  =  0.531 +- 0.046, 0.556 +- 0.034, 0.561 +- 0.020, 0.561 +- 0.022


 -------------------------------------------------- 
Computing faithfulness

Eval split train
Faith. Aritm (L1)= 		  =  0.451 +- 0.020, 0.464 +- 0.020, 0.506 +- 0.005, 0.528 +- 0.020
Faith. Armon (L1)= 		  =  0.284 +- 0.042, 0.190 +- 0.085, 0.117 +- 0.081, 0.103 +- 0.073
Faith. GMean (L1)= 	  =  0.357 +- 0.034, 0.290 +- 0.077, 0.221 +- 0.104, 0.211 +- 0.105
Faith. Aritm (KL)= 		  =  0.397 +- 0.075, 0.414 +- 0.072, 0.502 +- 0.004, 0.512 +- 0.003
Faith. Armon (KL)= 		  =  0.205 +- 0.053, 0.134 +- 0.008, 0.058 +- 0.017, 0.049 +- 0.012
Faith. GMean (KL)= 	  =  0.278 +- 0.010, 0.235 +- 0.025, 0.169 +- 0.026, 0.157 +- 0.020

Eval split id_val
Faith. Aritm (L1)= 		  =  0.469 +- 0.007, 0.476 +- 0.009, 0.507 +- 0.006, 0.553 +- 0.004
Faith. Armon (L1)= 		  =  0.362 +- 0.029, 0.300 +- 0.009, 0.215 +- 0.009, 0.190 +- 0.011
Faith. GMean (L1)= 	  =  0.412 +- 0.016, 0.378 +- 0.003, 0.330 +- 0.008, 0.324 +- 0.011
Faith. Aritm (KL)= 		  =  0.433 +- 0.038, 0.446 +- 0.037, 0.502 +- 0.008, 0.531 +- 0.013
Faith. Armon (KL)= 		  =  0.263 +- 0.101, 0.233 +- 0.084, 0.137 +- 0.051, 0.114 +- 0.046
Faith. GMean (KL)= 	  =  0.328 +- 0.048, 0.314 +- 0.043, 0.258 +- 0.047, 0.242 +- 0.052

Eval split val
Faith. Aritm (L1)= 		  =  0.481 +- 0.006, 0.477 +- 0.004, 0.506 +- 0.006, 0.565 +- 0.004
Faith. Armon (L1)= 		  =  0.395 +- 0.043, 0.328 +- 0.027, 0.249 +- 0.010, 0.230 +- 0.013
Faith. GMean (L1)= 	  =  0.435 +- 0.026, 0.395 +- 0.017, 0.355 +- 0.007, 0.360 +- 0.011
Faith. Aritm (KL)= 		  =  0.458 +- 0.019, 0.458 +- 0.020, 0.506 +- 0.007, 0.542 +- 0.020
Faith. Armon (KL)= 		  =  0.300 +- 0.112, 0.250 +- 0.102, 0.164 +- 0.062, 0.152 +- 0.069
Faith. GMean (KL)= 	  =  0.363 +- 0.061, 0.330 +- 0.061, 0.283 +- 0.055, 0.281 +- 0.070

Eval split test
Faith. Aritm (L1)= 		  =  0.474 +- 0.005, 0.479 +- 0.003, 0.501 +- 0.005, 0.564 +- 0.002
Faith. Armon (L1)= 		  =  0.379 +- 0.044, 0.321 +- 0.038, 0.242 +- 0.011, 0.227 +- 0.007
Faith. GMean (L1)= 	  =  0.423 +- 0.024, 0.391 +- 0.022, 0.348 +- 0.009, 0.358 +- 0.006
Faith. Aritm (KL)= 		  =  0.447 +- 0.031, 0.458 +- 0.027, 0.502 +- 0.004, 0.541 +- 0.018
Faith. Armon (KL)= 		  =  0.270 +- 0.112, 0.237 +- 0.111, 0.159 +- 0.067, 0.151 +- 0.060
Faith. GMean (KL)= 	  =  0.338 +- 0.059, 0.318 +- 0.065, 0.276 +- 0.059, 0.281 +- 0.061
Computed for split load_split = id



Completed in  0:32:31.024500  for LECIvGIN GOODTwitter/length



DONE LECI GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 02:20:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 02:20:51 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:03 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:05 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:07 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:10 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 02:21:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;31mERROR[0m: 05/03/2024 02:21:18 AM - utils.py - line 52 : [1mCheckpoint not found at /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/checkpoints/round1/GOODMotif_size_covariate/repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoreshardavgedgeattnmean/0.001lr_0.0wd/LECI_0.0_0.1_0_0.3_50_0_True/best.ckpt
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 609, in goodtg
    main()
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 509, in main
    evaluate_metric(args)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 286, in evaluate_metric
    pipeline.load_task(load_param=True, load_split=load_split)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1370, in load_task
    test_score, test_loss = self.config_model('test', load_param=load_param, load_split=load_split)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1400, in config_model
    print(f'#E#Checkpoint not found at {os.path.abspath(self.config.test_ckpt)}')
