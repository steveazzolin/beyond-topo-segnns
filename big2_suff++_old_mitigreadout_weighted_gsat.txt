
[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 10:58:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 10:58:41 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 10:58:54 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 10:58:56 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 10:58:58 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:00 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 10:59:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.3185
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3227
OOD Validation ACCURACY: 0.7380
OOD Validation Loss: 0.8407
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.3688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9291
Train Loss: 0.3281
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3407
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3224
OOD Test ACCURACY: 0.5867
OOD Test Loss: 1.3358

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.5787 0.9273 0.5867 0.9273 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.681
WIoU for r=0.3 = 0.557
F1 for r=0.6 = 0.591
WIoU for r=0.6 = 0.478
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.348
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.328
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.704
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.492
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.453
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.524
WIoU for r=0.3 = 0.401
F1 for r=0.6 = 0.658
WIoU for r=0.6 = 0.522
F1 for r=0.9 = 0.590
WIoU for r=0.9 = 0.435
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.404


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  0.6810075000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.55689
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.475
SUFF++ for r=0.3 class 0 = 0.374 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 class 1 = 0.447 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 class 2 = 0.525 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 all KL = 0.379 +- 0.267 (in-sample avg dev_std = 0.566)
SUFF++ for r=0.3 all L1 = 0.451 +- 0.176 (in-sample avg dev_std = 0.566)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.64
Model XAI F1 of binarized graphs for r=0.6 =  0.59141375
Model XAI WIoU of binarized graphs for r=0.6 =  0.47775625000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.665
SUFF++ for r=0.6 class 0 = 0.394 +- 0.284 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 1 = 0.566 +- 0.284 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 2 = 0.649 +- 0.284 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all KL = 0.509 +- 0.284 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all L1 = 0.54 +- 0.222 (in-sample avg dev_std = 0.472)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.46712000000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.34836875000000006
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0 = 0.661 +- 0.192 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 1 = 0.796 +- 0.192 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 2 = 0.834 +- 0.192 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all KL = 0.81 +- 0.192 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all L1 = 0.766 +- 0.164 (in-sample avg dev_std = 0.308)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.429
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7810075000000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.347
SUFF++ for r=0.3 class 0 = 0.505 +- 0.299 (in-sample avg dev_std = 0.661)
SUFF++ for r=0.3 class 1 = 0.522 +- 0.299 (in-sample avg dev_std = 0.661)
SUFF++ for r=0.3 class 2 = 0.528 +- 0.299 (in-sample avg dev_std = 0.661)
SUFF++ for r=0.3 all KL = 0.396 +- 0.299 (in-sample avg dev_std = 0.661)
SUFF++ for r=0.3 all L1 = 0.518 +- 0.177 (in-sample avg dev_std = 0.661)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.7041537500000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0 = 0.566 +- 0.377 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 1 = 0.619 +- 0.377 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 2 = 0.93 +- 0.377 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all KL = 0.645 +- 0.377 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all L1 = 0.705 +- 0.263 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49183
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.841
SUFF++ for r=0.9 class 0 = 0.784 +- 0.181 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 1 = 0.92 +- 0.181 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.181 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all KL = 0.9 +- 0.181 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.160 (in-sample avg dev_std = 0.260)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.291
Model XAI F1 of binarized graphs for r=0.3 =  0.52405125
Model XAI WIoU of binarized graphs for r=0.3 =  0.40118375
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.298
SUFF++ for r=0.3 class 0 = 0.44 +- 0.254 (in-sample avg dev_std = 0.617)
SUFF++ for r=0.3 class 1 = 0.456 +- 0.254 (in-sample avg dev_std = 0.617)
SUFF++ for r=0.3 class 2 = 0.459 +- 0.254 (in-sample avg dev_std = 0.617)
SUFF++ for r=0.3 all KL = 0.393 +- 0.254 (in-sample avg dev_std = 0.617)
SUFF++ for r=0.3 all L1 = 0.452 +- 0.147 (in-sample avg dev_std = 0.617)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  0.6582012499999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.52166125
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.657
SUFF++ for r=0.6 class 0 = 0.492 +- 0.285 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1 = 0.603 +- 0.285 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 2 = 0.866 +- 0.285 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.645 +- 0.285 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.655 +- 0.237 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.58955375
Model XAI WIoU of binarized graphs for r=0.9 =  0.43473875
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.689
SUFF++ for r=0.9 class 0 = 0.668 +- 0.167 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 1 = 0.844 +- 0.167 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 2 = 0.803 +- 0.167 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all KL = 0.845 +- 0.167 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all L1 = 0.771 +- 0.176 (in-sample avg dev_std = 0.269)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  0.6810075000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.55689
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
NEC for r=0.3 class 0 = 0.661 +- 0.253 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 1 = 0.606 +- 0.253 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 2 = 0.602 +- 0.253 (in-sample avg dev_std = 0.505)
NEC for r=0.3 all KL = 0.689 +- 0.253 (in-sample avg dev_std = 0.505)
NEC for r=0.3 all L1 = 0.622 +- 0.155 (in-sample avg dev_std = 0.505)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.639
Model XAI F1 of binarized graphs for r=0.6 =  0.59141375
Model XAI WIoU of binarized graphs for r=0.6 =  0.47775625000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.585 +- 0.270 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 1 = 0.578 +- 0.270 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 2 = 0.654 +- 0.270 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all KL = 0.675 +- 0.270 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all L1 = 0.606 +- 0.167 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.46712000000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.34836875000000006
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.486
NEC for r=0.9 class 0 = 0.623 +- 0.237 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 1 = 0.554 +- 0.237 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 2 = 0.569 +- 0.237 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all KL = 0.682 +- 0.237 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all L1 = 0.581 +- 0.159 (in-sample avg dev_std = 0.639)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32819000000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.534
NEC for r=1.0 class 0 = 0.554 +- 0.251 (in-sample avg dev_std = 0.654)
NEC for r=1.0 class 1 = 0.497 +- 0.251 (in-sample avg dev_std = 0.654)
NEC for r=1.0 class 2 = 0.574 +- 0.251 (in-sample avg dev_std = 0.654)
NEC for r=1.0 all KL = 0.608 +- 0.251 (in-sample avg dev_std = 0.654)
NEC for r=1.0 all L1 = 0.542 +- 0.171 (in-sample avg dev_std = 0.654)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.429
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7810075000000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.254
NEC for r=0.3 class 0 = 0.715 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.3 class 1 = 0.626 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.3 class 2 = 0.618 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.3 all KL = 0.721 +- 0.263 (in-sample avg dev_std = 0.444)
NEC for r=0.3 all L1 = 0.653 +- 0.190 (in-sample avg dev_std = 0.444)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.7041537500000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.431
NEC for r=0.6 class 0 = 0.434 +- 0.350 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 1 = 0.367 +- 0.350 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 2 = 0.3 +- 0.350 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all KL = 0.424 +- 0.350 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all L1 = 0.367 +- 0.284 (in-sample avg dev_std = 0.496)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49183
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.579
NEC for r=0.9 class 0 = 0.409 +- 0.218 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 1 = 0.287 +- 0.218 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 2 = 0.398 +- 0.218 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all KL = 0.332 +- 0.218 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all L1 = 0.365 +- 0.163 (in-sample avg dev_std = 0.543)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.745
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.45259875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.39 +- 0.214 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 1 = 0.226 +- 0.214 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 2 = 0.327 +- 0.214 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all KL = 0.272 +- 0.214 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all L1 = 0.315 +- 0.183 (in-sample avg dev_std = 0.504)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.292
Model XAI F1 of binarized graphs for r=0.3 =  0.52405125
Model XAI WIoU of binarized graphs for r=0.3 =  0.40118375
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.342
NEC for r=0.3 class 0 = 0.619 +- 0.281 (in-sample avg dev_std = 0.497)
NEC for r=0.3 class 1 = 0.552 +- 0.281 (in-sample avg dev_std = 0.497)
NEC for r=0.3 class 2 = 0.573 +- 0.281 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all KL = 0.617 +- 0.281 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all L1 = 0.582 +- 0.192 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  0.6582012499999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.52166125
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.431
NEC for r=0.6 class 0 = 0.611 +- 0.236 (in-sample avg dev_std = 0.610)
NEC for r=0.6 class 1 = 0.588 +- 0.236 (in-sample avg dev_std = 0.610)
NEC for r=0.6 class 2 = 0.617 +- 0.236 (in-sample avg dev_std = 0.610)
NEC for r=0.6 all KL = 0.704 +- 0.236 (in-sample avg dev_std = 0.610)
NEC for r=0.6 all L1 = 0.606 +- 0.150 (in-sample avg dev_std = 0.610)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.58955375
Model XAI WIoU of binarized graphs for r=0.9 =  0.43473875
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.561
NEC for r=0.9 class 0 = 0.543 +- 0.240 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 1 = 0.383 +- 0.240 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 2 = 0.539 +- 0.240 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all KL = 0.51 +- 0.240 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all L1 = 0.49 +- 0.156 (in-sample avg dev_std = 0.535)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.582
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.40385875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.559
NEC for r=1.0 class 0 = 0.443 +- 0.235 (in-sample avg dev_std = 0.487)
NEC for r=1.0 class 1 = 0.215 +- 0.235 (in-sample avg dev_std = 0.487)
NEC for r=1.0 class 2 = 0.503 +- 0.235 (in-sample avg dev_std = 0.487)
NEC for r=1.0 all KL = 0.383 +- 0.235 (in-sample avg dev_std = 0.487)
NEC for r=1.0 all L1 = 0.39 +- 0.201 (in-sample avg dev_std = 0.487)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:02:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:34 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:02:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3133
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3230
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3198
OOD Validation ACCURACY: 0.7460
OOD Validation Loss: 0.7757
OOD Test ACCURACY: 0.5250
OOD Test Loss: 1.4601

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3139
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3286
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3177
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3256
OOD Test ACCURACY: 0.5230
OOD Test Loss: 1.9314

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5250 0.9293 0.5230 0.9297 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.711
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.494
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.350
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.326
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.701
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.488
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.448
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.297
WIoU for r=0.3 = 0.208
F1 for r=0.6 = 0.583
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.588
WIoU for r=0.9 = 0.428
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.400


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.7112950000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.58282375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.466
SUFF++ for r=0.3 class 0 = 0.372 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 class 1 = 0.55 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 class 2 = 0.498 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 all KL = 0.382 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 all L1 = 0.475 +- 0.198 (in-sample avg dev_std = 0.564)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.6130325
Model XAI WIoU of binarized graphs for r=0.6 =  0.49401375000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.65
SUFF++ for r=0.6 class 0 = 0.404 +- 0.303 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 1 = 0.649 +- 0.303 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 2 = 0.573 +- 0.303 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all KL = 0.473 +- 0.303 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all L1 = 0.544 +- 0.212 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.47448375
Model XAI WIoU of binarized graphs for r=0.9 =  0.35010374999999994
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0 = 0.665 +- 0.200 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 1 = 0.872 +- 0.200 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 2 = 0.802 +- 0.200 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 all KL = 0.829 +- 0.200 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 all L1 = 0.781 +- 0.174 (in-sample avg dev_std = 0.289)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.447
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7802962500000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.403
SUFF++ for r=0.3 class 0 = 0.495 +- 0.345 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 class 1 = 0.685 +- 0.345 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 class 2 = 0.523 +- 0.345 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 all KL = 0.458 +- 0.345 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 all L1 = 0.567 +- 0.216 (in-sample avg dev_std = 0.587)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.7007000000000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0 = 0.524 +- 0.324 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 class 1 = 0.586 +- 0.324 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 class 2 = 0.86 +- 0.324 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 all KL = 0.624 +- 0.324 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 all L1 = 0.657 +- 0.228 (in-sample avg dev_std = 0.521)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.815
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.4877025
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0 = 0.738 +- 0.155 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 1 = 0.84 +- 0.155 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 2 = 0.894 +- 0.155 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all KL = 0.91 +- 0.155 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all L1 = 0.824 +- 0.148 (in-sample avg dev_std = 0.234)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.29737625
Model XAI WIoU of binarized graphs for r=0.3 =  0.20834874999999997
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF++ for r=0.3 class 0 = 0.58 +- 0.263 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 1 = 0.64 +- 0.263 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 2 = 0.618 +- 0.263 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all KL = 0.584 +- 0.263 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all L1 = 0.612 +- 0.154 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.475
Model XAI F1 of binarized graphs for r=0.6 =  0.58348
Model XAI WIoU of binarized graphs for r=0.6 =  0.45278999999999997
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.464
SUFF++ for r=0.6 class 0 = 0.494 +- 0.263 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 class 1 = 0.577 +- 0.263 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 class 2 = 0.556 +- 0.263 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 all KL = 0.499 +- 0.263 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 all L1 = 0.541 +- 0.209 (in-sample avg dev_std = 0.542)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.58843
Model XAI WIoU of binarized graphs for r=0.9 =  0.42841999999999997
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.645
SUFF++ for r=0.9 class 0 = 0.649 +- 0.220 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 class 1 = 0.856 +- 0.220 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 class 2 = 0.668 +- 0.220 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 all KL = 0.767 +- 0.220 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 all L1 = 0.722 +- 0.203 (in-sample avg dev_std = 0.355)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.558
Model XAI F1 of binarized graphs for r=0.3 =  0.7112950000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.58282375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.67 +- 0.260 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 1 = 0.604 +- 0.260 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 2 = 0.64 +- 0.260 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all KL = 0.725 +- 0.260 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all L1 = 0.637 +- 0.175 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.6130325
Model XAI WIoU of binarized graphs for r=0.6 =  0.49401375000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.373
NEC for r=0.6 class 0 = 0.619 +- 0.256 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 1 = 0.582 +- 0.256 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 2 = 0.625 +- 0.256 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all KL = 0.707 +- 0.256 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all L1 = 0.609 +- 0.173 (in-sample avg dev_std = 0.549)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.47448375
Model XAI WIoU of binarized graphs for r=0.9 =  0.35010374999999994
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.46
NEC for r=0.9 class 0 = 0.625 +- 0.251 (in-sample avg dev_std = 0.624)
NEC for r=0.9 class 1 = 0.523 +- 0.251 (in-sample avg dev_std = 0.624)
NEC for r=0.9 class 2 = 0.6 +- 0.251 (in-sample avg dev_std = 0.624)
NEC for r=0.9 all KL = 0.657 +- 0.251 (in-sample avg dev_std = 0.624)
NEC for r=0.9 all L1 = 0.582 +- 0.176 (in-sample avg dev_std = 0.624)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.32550375000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.519
NEC for r=1.0 class 0 = 0.579 +- 0.243 (in-sample avg dev_std = 0.662)
NEC for r=1.0 class 1 = 0.475 +- 0.243 (in-sample avg dev_std = 0.662)
NEC for r=1.0 class 2 = 0.579 +- 0.243 (in-sample avg dev_std = 0.662)
NEC for r=1.0 all KL = 0.629 +- 0.243 (in-sample avg dev_std = 0.662)
NEC for r=1.0 all L1 = 0.544 +- 0.185 (in-sample avg dev_std = 0.662)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.446
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7802962500000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.196
NEC for r=0.3 class 0 = 0.718 +- 0.271 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 1 = 0.594 +- 0.271 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 2 = 0.661 +- 0.271 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all KL = 0.752 +- 0.271 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all L1 = 0.658 +- 0.196 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.7007000000000001
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.38
NEC for r=0.6 class 0 = 0.5 +- 0.318 (in-sample avg dev_std = 0.478)
NEC for r=0.6 class 1 = 0.363 +- 0.318 (in-sample avg dev_std = 0.478)
NEC for r=0.6 class 2 = 0.366 +- 0.318 (in-sample avg dev_std = 0.478)
NEC for r=0.6 all KL = 0.409 +- 0.318 (in-sample avg dev_std = 0.478)
NEC for r=0.6 all L1 = 0.41 +- 0.262 (in-sample avg dev_std = 0.478)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.815
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.4877025
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.417 +- 0.209 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 1 = 0.362 +- 0.209 (in-sample avg dev_std = 0.560)
NEC for r=0.9 class 2 = 0.381 +- 0.209 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all KL = 0.322 +- 0.209 (in-sample avg dev_std = 0.560)
NEC for r=0.9 all L1 = 0.387 +- 0.149 (in-sample avg dev_std = 0.560)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.766
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.44825499999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.545
NEC for r=1.0 class 0 = 0.405 +- 0.212 (in-sample avg dev_std = 0.524)
NEC for r=1.0 class 1 = 0.309 +- 0.212 (in-sample avg dev_std = 0.524)
NEC for r=1.0 class 2 = 0.357 +- 0.212 (in-sample avg dev_std = 0.524)
NEC for r=1.0 all KL = 0.317 +- 0.212 (in-sample avg dev_std = 0.524)
NEC for r=1.0 all L1 = 0.357 +- 0.159 (in-sample avg dev_std = 0.524)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.29737625
Model XAI WIoU of binarized graphs for r=0.3 =  0.20834874999999997
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.496 +- 0.308 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.364 +- 0.308 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.431 +- 0.308 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.449 +- 0.308 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.432 +- 0.193 (in-sample avg dev_std = 0.405)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.479
Model XAI F1 of binarized graphs for r=0.6 =  0.58348
Model XAI WIoU of binarized graphs for r=0.6 =  0.45278999999999997
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.469
NEC for r=0.6 class 0 = 0.636 +- 0.245 (in-sample avg dev_std = 0.578)
NEC for r=0.6 class 1 = 0.593 +- 0.245 (in-sample avg dev_std = 0.578)
NEC for r=0.6 class 2 = 0.608 +- 0.245 (in-sample avg dev_std = 0.578)
NEC for r=0.6 all KL = 0.678 +- 0.245 (in-sample avg dev_std = 0.578)
NEC for r=0.6 all L1 = 0.613 +- 0.141 (in-sample avg dev_std = 0.578)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.58843
Model XAI WIoU of binarized graphs for r=0.9 =  0.42841999999999997
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.521
NEC for r=0.9 class 0 = 0.562 +- 0.209 (in-sample avg dev_std = 0.596)
NEC for r=0.9 class 1 = 0.47 +- 0.209 (in-sample avg dev_std = 0.596)
NEC for r=0.9 class 2 = 0.537 +- 0.209 (in-sample avg dev_std = 0.596)
NEC for r=0.9 all KL = 0.589 +- 0.209 (in-sample avg dev_std = 0.596)
NEC for r=0.9 all L1 = 0.524 +- 0.142 (in-sample avg dev_std = 0.596)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.527
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.39950625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.513
NEC for r=1.0 class 0 = 0.474 +- 0.226 (in-sample avg dev_std = 0.558)
NEC for r=1.0 class 1 = 0.298 +- 0.226 (in-sample avg dev_std = 0.558)
NEC for r=1.0 class 2 = 0.505 +- 0.226 (in-sample avg dev_std = 0.558)
NEC for r=1.0 all KL = 0.472 +- 0.226 (in-sample avg dev_std = 0.558)
NEC for r=1.0 all L1 = 0.428 +- 0.190 (in-sample avg dev_std = 0.558)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:05:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:05:56 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:09 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:11 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:13 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:06:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9322
Train Loss: 0.3072
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3220
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3118
OOD Validation ACCURACY: 0.5597
OOD Validation Loss: 1.9919
OOD Test ACCURACY: 0.6200
OOD Test Loss: 1.2815

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3340
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3459
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3377
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3470
OOD Test ACCURACY: 0.7067
OOD Test Loss: 0.9028

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.6200 0.9270 0.7067 0.9270 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3071) +- tensor(0.1673)
F1 for r=0.3 = 0.687
WIoU for r=0.3 = 0.569
F1 for r=0.6 = 0.584
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.462
WIoU for r=0.9 = 0.347
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4137) +- tensor(0.0836)
F1 for r=0.3 = 0.869
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.798
WIoU for r=0.6 = 0.703
F1 for r=0.9 = 0.618
WIoU for r=0.9 = 0.490
F1 for r=1.0 = 0.580
WIoU for r=1.0 = 0.451
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.363
WIoU for r=0.3 = 0.261
F1 for r=0.6 = 0.654
WIoU for r=0.6 = 0.508
F1 for r=0.9 = 0.591
WIoU for r=0.9 = 0.433
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.403


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.6873524999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.568545
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.468
SUFF++ for r=0.3 class 0 = 0.394 +- 0.287 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 1 = 0.465 +- 0.287 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 2 = 0.564 +- 0.287 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all KL = 0.412 +- 0.287 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all L1 = 0.476 +- 0.177 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.678
Model XAI F1 of binarized graphs for r=0.6 =  0.58392125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47413875000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.659
SUFF++ for r=0.6 class 0 = 0.429 +- 0.284 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 1 = 0.628 +- 0.284 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 2 = 0.684 +- 0.284 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all KL = 0.543 +- 0.284 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all L1 = 0.584 +- 0.217 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.461935
Model XAI WIoU of binarized graphs for r=0.9 =  0.34719750000000005
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0 = 0.59 +- 0.222 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 class 1 = 0.798 +- 0.222 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.222 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 all KL = 0.787 +- 0.222 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 all L1 = 0.753 +- 0.197 (in-sample avg dev_std = 0.336)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7807900000000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.423
SUFF++ for r=0.3 class 0 = 0.463 +- 0.314 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 class 1 = 0.563 +- 0.314 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 class 2 = 0.525 +- 0.314 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 all KL = 0.426 +- 0.314 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 all L1 = 0.517 +- 0.174 (in-sample avg dev_std = 0.619)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.70308875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.731
SUFF++ for r=0.6 class 0 = 0.504 +- 0.396 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.6 class 1 = 0.55 +- 0.396 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.6 class 2 = 0.889 +- 0.396 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.6 all KL = 0.526 +- 0.396 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.6 all L1 = 0.648 +- 0.274 (in-sample avg dev_std = 0.576)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.691
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49044375
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.735
SUFF++ for r=0.9 class 0 = 0.797 +- 0.184 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 class 1 = 0.941 +- 0.184 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 class 2 = 0.842 +- 0.184 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all KL = 0.903 +- 0.184 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.157 (in-sample avg dev_std = 0.253)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.26
Model XAI F1 of binarized graphs for r=0.3 =  0.36331
Model XAI WIoU of binarized graphs for r=0.3 =  0.2606225
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.296
SUFF++ for r=0.3 class 0 = 0.419 +- 0.256 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 class 1 = 0.455 +- 0.256 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 class 2 = 0.479 +- 0.256 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 all KL = 0.413 +- 0.256 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 all L1 = 0.451 +- 0.130 (in-sample avg dev_std = 0.564)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.571
Model XAI F1 of binarized graphs for r=0.6 =  0.65431
Model XAI WIoU of binarized graphs for r=0.6 =  0.5077862500000001
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.57
SUFF++ for r=0.6 class 0 = 0.511 +- 0.269 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1 = 0.602 +- 0.269 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 2 = 0.727 +- 0.269 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.606 +- 0.269 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.613 +- 0.229 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.590915
Model XAI WIoU of binarized graphs for r=0.9 =  0.4329775
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.683
SUFF++ for r=0.9 class 0 = 0.654 +- 0.177 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 class 1 = 0.915 +- 0.177 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 class 2 = 0.763 +- 0.177 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 all KL = 0.838 +- 0.177 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 all L1 = 0.775 +- 0.181 (in-sample avg dev_std = 0.288)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.461
Model XAI F1 of binarized graphs for r=0.3 =  0.6873524999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.568545
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.643 +- 0.270 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.575 +- 0.270 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.594 +- 0.270 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.668 +- 0.270 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.603 +- 0.167 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.58392125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47413875000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 0 = 0.623 +- 0.254 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.592 +- 0.254 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.647 +- 0.254 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.713 +- 0.254 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.621 +- 0.150 (in-sample avg dev_std = 0.546)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.461935
Model XAI WIoU of binarized graphs for r=0.9 =  0.34719750000000005
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.494
NEC for r=0.9 class 0 = 0.641 +- 0.234 (in-sample avg dev_std = 0.648)
NEC for r=0.9 class 1 = 0.509 +- 0.234 (in-sample avg dev_std = 0.648)
NEC for r=0.9 class 2 = 0.553 +- 0.234 (in-sample avg dev_std = 0.648)
NEC for r=0.9 all KL = 0.674 +- 0.234 (in-sample avg dev_std = 0.648)
NEC for r=0.9 all L1 = 0.566 +- 0.167 (in-sample avg dev_std = 0.648)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.4465199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.33141999999999994
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.53
NEC for r=1.0 class 0 = 0.572 +- 0.230 (in-sample avg dev_std = 0.671)
NEC for r=1.0 class 1 = 0.476 +- 0.230 (in-sample avg dev_std = 0.671)
NEC for r=1.0 class 2 = 0.59 +- 0.230 (in-sample avg dev_std = 0.671)
NEC for r=1.0 all KL = 0.646 +- 0.230 (in-sample avg dev_std = 0.671)
NEC for r=1.0 all L1 = 0.546 +- 0.175 (in-sample avg dev_std = 0.671)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.468
Model XAI F1 of binarized graphs for r=0.3 =  0.86858875
Model XAI WIoU of binarized graphs for r=0.3 =  0.7807900000000001
len(reference) = 800
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.222
NEC for r=0.3 class 0 = 0.692 +- 0.286 (in-sample avg dev_std = 0.436)
NEC for r=0.3 class 1 = 0.613 +- 0.286 (in-sample avg dev_std = 0.436)
NEC for r=0.3 class 2 = 0.634 +- 0.286 (in-sample avg dev_std = 0.436)
NEC for r=0.3 all KL = 0.706 +- 0.286 (in-sample avg dev_std = 0.436)
NEC for r=0.3 all L1 = 0.647 +- 0.187 (in-sample avg dev_std = 0.436)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.7975175
Model XAI WIoU of binarized graphs for r=0.6 =  0.70308875
len(reference) = 800
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.414
NEC for r=0.6 class 0 = 0.401 +- 0.344 (in-sample avg dev_std = 0.467)
NEC for r=0.6 class 1 = 0.32 +- 0.344 (in-sample avg dev_std = 0.467)
NEC for r=0.6 class 2 = 0.262 +- 0.344 (in-sample avg dev_std = 0.467)
NEC for r=0.6 all KL = 0.382 +- 0.344 (in-sample avg dev_std = 0.467)
NEC for r=0.6 all L1 = 0.328 +- 0.284 (in-sample avg dev_std = 0.467)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.691
Model XAI F1 of binarized graphs for r=0.9 =  0.61811125
Model XAI WIoU of binarized graphs for r=0.9 =  0.49044375
len(reference) = 800
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.557
NEC for r=0.9 class 0 = 0.39 +- 0.222 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 1 = 0.186 +- 0.222 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 2 = 0.334 +- 0.222 (in-sample avg dev_std = 0.455)
NEC for r=0.9 all KL = 0.262 +- 0.222 (in-sample avg dev_std = 0.455)
NEC for r=0.9 all L1 = 0.304 +- 0.195 (in-sample avg dev_std = 0.455)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.584
Model XAI F1 of binarized graphs for r=1.0 =  0.5803825
Model XAI WIoU of binarized graphs for r=1.0 =  0.45112749999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.495
NEC for r=1.0 class 0 = 0.374 +- 0.195 (in-sample avg dev_std = 0.369)
NEC for r=1.0 class 1 = 0.138 +- 0.195 (in-sample avg dev_std = 0.369)
NEC for r=1.0 class 2 = 0.229 +- 0.195 (in-sample avg dev_std = 0.369)
NEC for r=1.0 all KL = 0.195 +- 0.195 (in-sample avg dev_std = 0.369)
NEC for r=1.0 all L1 = 0.247 +- 0.199 (in-sample avg dev_std = 0.369)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.261
Model XAI F1 of binarized graphs for r=0.3 =  0.36331
Model XAI WIoU of binarized graphs for r=0.3 =  0.2606225
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.284
NEC for r=0.3 class 0 = 0.619 +- 0.277 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 1 = 0.551 +- 0.277 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 2 = 0.577 +- 0.277 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all KL = 0.613 +- 0.277 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all L1 = 0.583 +- 0.173 (in-sample avg dev_std = 0.468)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.57
Model XAI F1 of binarized graphs for r=0.6 =  0.65431
Model XAI WIoU of binarized graphs for r=0.6 =  0.5077862500000001
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.448
NEC for r=0.6 class 0 = 0.604 +- 0.266 (in-sample avg dev_std = 0.582)
NEC for r=0.6 class 1 = 0.532 +- 0.266 (in-sample avg dev_std = 0.582)
NEC for r=0.6 class 2 = 0.62 +- 0.266 (in-sample avg dev_std = 0.582)
NEC for r=0.6 all KL = 0.659 +- 0.266 (in-sample avg dev_std = 0.582)
NEC for r=0.6 all L1 = 0.586 +- 0.160 (in-sample avg dev_std = 0.582)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.590915
Model XAI WIoU of binarized graphs for r=0.9 =  0.4329775
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.513 +- 0.234 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 1 = 0.373 +- 0.234 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 2 = 0.532 +- 0.234 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all KL = 0.487 +- 0.234 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all L1 = 0.475 +- 0.162 (in-sample avg dev_std = 0.539)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.624
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.40290875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.431 +- 0.231 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 1 = 0.233 +- 0.231 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 2 = 0.512 +- 0.231 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all KL = 0.388 +- 0.231 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all L1 = 0.395 +- 0.189 (in-sample avg dev_std = 0.507)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.379, 0.509, 0.81, 1.0], 'all_L1': [0.451, 0.54, 0.766, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.473, 0.829, 1.0], 'all_L1': [0.475, 0.544, 0.781, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.412, 0.543, 0.787, 1.0], 'all_L1': [0.476, 0.584, 0.753, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.689, 0.675, 0.682, 0.608], 'all_L1': [0.622, 0.606, 0.581, 0.542]}), defaultdict(<class 'list'>, {'all_KL': [0.725, 0.707, 0.657, 0.629], 'all_L1': [0.637, 0.609, 0.582, 0.544]}), defaultdict(<class 'list'>, {'all_KL': [0.668, 0.713, 0.674, 0.646], 'all_L1': [0.603, 0.621, 0.566, 0.546]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.396, 0.645, 0.9, 1.0], 'all_L1': [0.518, 0.705, 0.844, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.624, 0.91, 1.0], 'all_L1': [0.567, 0.657, 0.824, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.426, 0.526, 0.903, 1.0], 'all_L1': [0.517, 0.648, 0.86, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.721, 0.424, 0.332, 0.272], 'all_L1': [0.653, 0.367, 0.365, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.752, 0.409, 0.322, 0.317], 'all_L1': [0.658, 0.41, 0.387, 0.357]}), defaultdict(<class 'list'>, {'all_KL': [0.706, 0.382, 0.262, 0.195], 'all_L1': [0.647, 0.328, 0.304, 0.247]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.393, 0.645, 0.845, 1.0], 'all_L1': [0.452, 0.655, 0.771, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.584, 0.499, 0.767, 1.0], 'all_L1': [0.612, 0.541, 0.722, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.413, 0.606, 0.838, 1.0], 'all_L1': [0.451, 0.613, 0.775, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.617, 0.704, 0.51, 0.383], 'all_L1': [0.582, 0.606, 0.49, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.678, 0.589, 0.472], 'all_L1': [0.432, 0.613, 0.524, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.659, 0.487, 0.388], 'all_L1': [0.583, 0.586, 0.475, 0.395]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.467 +- 0.012, 0.556 +- 0.020, 0.767 +- 0.011, 1.000 +- 0.000
suff++ class all_KL  =  0.391 +- 0.015, 0.508 +- 0.029, 0.809 +- 0.017, 1.000 +- 0.000
suff++_acc_int  =  0.470 +- 0.004, 0.658 +- 0.006, 0.828 +- 0.021
nec class all_L1  =  0.621 +- 0.014, 0.612 +- 0.006, 0.576 +- 0.007, 0.544 +- 0.002
nec class all_KL  =  0.694 +- 0.024, 0.698 +- 0.017, 0.671 +- 0.010, 0.628 +- 0.016
nec_acc_int  =  0.340 +- 0.007, 0.375 +- 0.009, 0.480 +- 0.014, 0.528 +- 0.006

Eval split val
suff++ class all_L1  =  0.534 +- 0.023, 0.670 +- 0.025, 0.843 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.427 +- 0.025, 0.598 +- 0.052, 0.904 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.391 +- 0.032, 0.744 +- 0.021, 0.792 +- 0.044
nec class all_L1  =  0.653 +- 0.004, 0.368 +- 0.033, 0.352 +- 0.035, 0.306 +- 0.045
nec class all_KL  =  0.726 +- 0.019, 0.405 +- 0.017, 0.305 +- 0.031, 0.261 +- 0.050
nec_acc_int  =  0.224 +- 0.024, 0.408 +- 0.021, 0.553 +- 0.024, 0.532 +- 0.027

Eval split test
suff++ class all_L1  =  0.505 +- 0.076, 0.603 +- 0.047, 0.756 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.463 +- 0.086, 0.583 +- 0.062, 0.817 +- 0.035, 1.000 +- 0.000
suff++_acc_int  =  0.310 +- 0.019, 0.564 +- 0.079, 0.672 +- 0.019
nec class all_L1  =  0.532 +- 0.071, 0.602 +- 0.011, 0.496 +- 0.020, 0.404 +- 0.017
nec class all_KL  =  0.560 +- 0.078, 0.680 +- 0.018, 0.529 +- 0.044, 0.414 +- 0.041
nec_acc_int  =  0.325 +- 0.029, 0.449 +- 0.015, 0.543 +- 0.016, 0.549 +- 0.026


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.544 +- 0.009, 0.584 +- 0.013, 0.672 +- 0.009, 0.772 +- 0.001
Faith. Armon (L1)= 		  =  0.533 +- 0.009, 0.583 +- 0.014, 0.658 +- 0.009, 0.705 +- 0.001
Faith. GMean (L1)= 	  =  0.538 +- 0.009, 0.583 +- 0.013, 0.665 +- 0.009, 0.738 +- 0.001
Faith. Aritm (KL)= 		  =  0.543 +- 0.008, 0.603 +- 0.017, 0.740 +- 0.007, 0.814 +- 0.008
Faith. Armon (KL)= 		  =  0.500 +- 0.008, 0.588 +- 0.021, 0.733 +- 0.006, 0.771 +- 0.012
Faith. GMean (KL)= 	  =  0.521 +- 0.007, 0.596 +- 0.019, 0.737 +- 0.006, 0.792 +- 0.010

Eval split val
Faith. Aritm (L1)= 		  =  0.593 +- 0.014, 0.519 +- 0.022, 0.597 +- 0.011, 0.653 +- 0.023
Faith. Armon (L1)= 		  =  0.587 +- 0.016, 0.474 +- 0.029, 0.495 +- 0.033, 0.467 +- 0.054
Faith. GMean (L1)= 	  =  0.590 +- 0.015, 0.496 +- 0.025, 0.544 +- 0.023, 0.552 +- 0.042
Faith. Aritm (KL)= 		  =  0.576 +- 0.020, 0.502 +- 0.034, 0.605 +- 0.016, 0.631 +- 0.025
Faith. Armon (KL)= 		  =  0.537 +- 0.024, 0.483 +- 0.029, 0.456 +- 0.035, 0.412 +- 0.064
Faith. GMean (KL)= 	  =  0.557 +- 0.022, 0.492 +- 0.032, 0.525 +- 0.027, 0.509 +- 0.050

Eval split test
Faith. Aritm (L1)= 		  =  0.519 +- 0.002, 0.602 +- 0.022, 0.626 +- 0.003, 0.702 +- 0.008
Faith. Armon (L1)= 		  =  0.508 +- 0.001, 0.601 +- 0.022, 0.598 +- 0.007, 0.576 +- 0.017
Faith. GMean (L1)= 	  =  0.513 +- 0.001, 0.602 +- 0.022, 0.612 +- 0.004, 0.636 +- 0.013
Faith. Aritm (KL)= 		  =  0.512 +- 0.005, 0.632 +- 0.035, 0.673 +- 0.007, 0.707 +- 0.020
Faith. Armon (KL)= 		  =  0.494 +- 0.011, 0.626 +- 0.040, 0.639 +- 0.021, 0.585 +- 0.040
Faith. GMean (KL)= 	  =  0.503 +- 0.008, 0.629 +- 0.038, 0.656 +- 0.014, 0.643 +- 0.031
Computed for split load_split = id



Completed in  0:10:50.144451  for GSATGIN GOODMotif/basis



DONE GSAT GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:09:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:50 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:50 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:09:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:09:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.3224
ID Validation ACCURACY: 0.9360
ID Validation Loss: 0.3055
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3402
OOD Validation ACCURACY: 0.7387
OOD Validation Loss: 0.6602
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.1222

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3370
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9240
ID Test Loss: 0.3558
OOD Validation ACCURACY: 0.9200
OOD Validation Loss: 0.4528
OOD Test ACCURACY: 0.6980
OOD Test Loss: 1.4036

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.6417 0.9240 0.6980 0.9327 0.9200[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.717
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.592
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.466
WIoU for r=0.9 = 0.344
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.330
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.508
WIoU for r=0.3 = 0.385
F1 for r=0.6 = 0.330
WIoU for r=0.6 = 0.219
F1 for r=0.9 = 0.264
WIoU for r=0.9 = 0.167
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.169
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.686
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.513
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.399
WIoU for r=0.9 = 0.273
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.265


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.428
Model XAI F1 of binarized graphs for r=0.3 =  0.7169475
Model XAI WIoU of binarized graphs for r=0.3 =  0.60174375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.414 +- 0.275 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 1 = 0.503 +- 0.275 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 2 = 0.491 +- 0.275 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all KL = 0.378 +- 0.275 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all L1 = 0.469 +- 0.185 (in-sample avg dev_std = 0.547)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.5915225
Model XAI WIoU of binarized graphs for r=0.6 =  0.4740025
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.655
SUFF++ for r=0.6 class 0 = 0.438 +- 0.307 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 1 = 0.775 +- 0.307 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 2 = 0.633 +- 0.307 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all KL = 0.573 +- 0.307 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all L1 = 0.616 +- 0.229 (in-sample avg dev_std = 0.472)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.46625875000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.34398874999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0 = 0.626 +- 0.214 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.214 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 2 = 0.785 +- 0.214 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all KL = 0.788 +- 0.214 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all L1 = 0.75 +- 0.184 (in-sample avg dev_std = 0.329)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  0.5077612499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.38458749999999997
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.588
SUFF++ for r=0.3 class 0 = 0.441 +- 0.273 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 1 = 0.66 +- 0.273 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 2 = 0.57 +- 0.273 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all KL = 0.55 +- 0.273 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all L1 = 0.556 +- 0.199 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.33007624999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.219075
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.577
SUFF++ for r=0.6 class 0 = 0.405 +- 0.248 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 class 1 = 0.7 +- 0.248 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 class 2 = 0.521 +- 0.248 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 all KL = 0.602 +- 0.248 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.6 all L1 = 0.54 +- 0.188 (in-sample avg dev_std = 0.361)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.734
Model XAI F1 of binarized graphs for r=0.9 =  0.2642075
Model XAI WIoU of binarized graphs for r=0.9 =  0.16662750000000004
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0 = 0.49 +- 0.202 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 1 = 0.616 +- 0.202 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 2 = 0.641 +- 0.202 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all KL = 0.652 +- 0.202 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all L1 = 0.582 +- 0.159 (in-sample avg dev_std = 0.348)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.495
Model XAI F1 of binarized graphs for r=0.3 =  0.68614875
Model XAI WIoU of binarized graphs for r=0.3 =  0.5508675000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.545
SUFF++ for r=0.3 class 0 = 0.438 +- 0.322 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 1 = 0.641 +- 0.322 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 2 = 0.635 +- 0.322 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all KL = 0.507 +- 0.322 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all L1 = 0.573 +- 0.243 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  0.5133225
Model XAI WIoU of binarized graphs for r=0.6 =  0.37650625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.686
SUFF++ for r=0.6 class 0 = 0.457 +- 0.230 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 1 = 0.818 +- 0.230 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 2 = 0.689 +- 0.230 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 all KL = 0.667 +- 0.230 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 all L1 = 0.658 +- 0.206 (in-sample avg dev_std = 0.398)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.3989425
Model XAI WIoU of binarized graphs for r=0.9 =  0.272865
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.666
SUFF++ for r=0.9 class 0 = 0.531 +- 0.235 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 class 1 = 0.767 +- 0.235 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.235 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 all KL = 0.741 +- 0.235 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.9 all L1 = 0.705 +- 0.208 (in-sample avg dev_std = 0.343)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.428
Model XAI F1 of binarized graphs for r=0.3 =  0.7169475
Model XAI WIoU of binarized graphs for r=0.3 =  0.60174375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.64 +- 0.307 (in-sample avg dev_std = 0.496)
NEC for r=0.3 class 1 = 0.501 +- 0.307 (in-sample avg dev_std = 0.496)
NEC for r=0.3 class 2 = 0.684 +- 0.307 (in-sample avg dev_std = 0.496)
NEC for r=0.3 all KL = 0.701 +- 0.307 (in-sample avg dev_std = 0.496)
NEC for r=0.3 all L1 = 0.608 +- 0.206 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  0.5915225
Model XAI WIoU of binarized graphs for r=0.6 =  0.4740025
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.595 +- 0.309 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 1 = 0.438 +- 0.309 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 2 = 0.652 +- 0.309 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all KL = 0.644 +- 0.309 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all L1 = 0.561 +- 0.213 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.46625875000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.34398874999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.512
NEC for r=0.9 class 0 = 0.612 +- 0.233 (in-sample avg dev_std = 0.633)
NEC for r=0.9 class 1 = 0.47 +- 0.233 (in-sample avg dev_std = 0.633)
NEC for r=0.9 class 2 = 0.588 +- 0.233 (in-sample avg dev_std = 0.633)
NEC for r=0.9 all KL = 0.646 +- 0.233 (in-sample avg dev_std = 0.633)
NEC for r=0.9 all L1 = 0.556 +- 0.161 (in-sample avg dev_std = 0.633)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.3296275
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.559
NEC for r=1.0 class 0 = 0.553 +- 0.244 (in-sample avg dev_std = 0.655)
NEC for r=1.0 class 1 = 0.407 +- 0.244 (in-sample avg dev_std = 0.655)
NEC for r=1.0 class 2 = 0.591 +- 0.244 (in-sample avg dev_std = 0.655)
NEC for r=1.0 all KL = 0.598 +- 0.244 (in-sample avg dev_std = 0.655)
NEC for r=1.0 all L1 = 0.516 +- 0.181 (in-sample avg dev_std = 0.655)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.5077612499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.38458749999999997
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.302
NEC for r=0.3 class 0 = 0.576 +- 0.267 (in-sample avg dev_std = 0.446)
NEC for r=0.3 class 1 = 0.549 +- 0.267 (in-sample avg dev_std = 0.446)
NEC for r=0.3 class 2 = 0.718 +- 0.267 (in-sample avg dev_std = 0.446)
NEC for r=0.3 all KL = 0.65 +- 0.267 (in-sample avg dev_std = 0.446)
NEC for r=0.3 all L1 = 0.615 +- 0.156 (in-sample avg dev_std = 0.446)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.674
Model XAI F1 of binarized graphs for r=0.6 =  0.33007624999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.219075
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.416
NEC for r=0.6 class 0 = 0.591 +- 0.220 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.47 +- 0.220 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.61 +- 0.220 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.545 +- 0.220 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.558 +- 0.136 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  0.2642075
Model XAI WIoU of binarized graphs for r=0.9 =  0.16662750000000004
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.556
NEC for r=0.9 class 0 = 0.599 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 class 1 = 0.556 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 class 2 = 0.503 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 all KL = 0.558 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 all L1 = 0.552 +- 0.119 (in-sample avg dev_std = 0.547)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.731
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.16869875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.588
NEC for r=1.0 class 0 = 0.619 +- 0.215 (in-sample avg dev_std = 0.559)
NEC for r=1.0 class 1 = 0.502 +- 0.215 (in-sample avg dev_std = 0.559)
NEC for r=1.0 class 2 = 0.57 +- 0.215 (in-sample avg dev_std = 0.559)
NEC for r=1.0 all KL = 0.607 +- 0.215 (in-sample avg dev_std = 0.559)
NEC for r=1.0 all L1 = 0.564 +- 0.120 (in-sample avg dev_std = 0.559)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.496
Model XAI F1 of binarized graphs for r=0.3 =  0.68614875
Model XAI WIoU of binarized graphs for r=0.3 =  0.5508675000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.418
NEC for r=0.3 class 0 = 0.637 +- 0.231 (in-sample avg dev_std = 0.586)
NEC for r=0.3 class 1 = 0.514 +- 0.231 (in-sample avg dev_std = 0.586)
NEC for r=0.3 class 2 = 0.614 +- 0.231 (in-sample avg dev_std = 0.586)
NEC for r=0.3 all KL = 0.72 +- 0.231 (in-sample avg dev_std = 0.586)
NEC for r=0.3 all L1 = 0.587 +- 0.165 (in-sample avg dev_std = 0.586)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  0.5133225
Model XAI WIoU of binarized graphs for r=0.6 =  0.37650625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.467
NEC for r=0.6 class 0 = 0.574 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 class 1 = 0.429 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 class 2 = 0.638 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 all KL = 0.616 +- 0.274 (in-sample avg dev_std = 0.565)
NEC for r=0.6 all L1 = 0.546 +- 0.185 (in-sample avg dev_std = 0.565)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  0.3989425
Model XAI WIoU of binarized graphs for r=0.9 =  0.272865
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.534
NEC for r=0.9 class 0 = 0.629 +- 0.316 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.433 +- 0.316 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.496 +- 0.316 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.591 +- 0.316 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.518 +- 0.193 (in-sample avg dev_std = 0.571)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.665
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26548625000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.566
NEC for r=1.0 class 0 = 0.528 +- 0.272 (in-sample avg dev_std = 0.531)
NEC for r=1.0 class 1 = 0.407 +- 0.272 (in-sample avg dev_std = 0.531)
NEC for r=1.0 class 2 = 0.377 +- 0.272 (in-sample avg dev_std = 0.531)
NEC for r=1.0 all KL = 0.463 +- 0.272 (in-sample avg dev_std = 0.531)
NEC for r=1.0 all L1 = 0.436 +- 0.166 (in-sample avg dev_std = 0.531)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:13:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:13:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9294
Train Loss: 0.3188
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3050
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3427
OOD Validation ACCURACY: 0.9233
OOD Validation Loss: 0.3537
OOD Test ACCURACY: 0.5027
OOD Test Loss: 1.2959

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.9271
Train Loss: 0.3300
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3113
ID Test ACCURACY: 0.9240
ID Test Loss: 0.3472
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3600
OOD Test ACCURACY: 0.5900
OOD Test Loss: 1.4067

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.5027 0.9240 0.5900 0.9323 0.9297[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.681
WIoU for r=0.3 = 0.567
F1 for r=0.6 = 0.576
WIoU for r=0.6 = 0.456
F1 for r=0.9 = 0.458
WIoU for r=0.9 = 0.334
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.329
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.519
WIoU for r=0.3 = 0.405
F1 for r=0.6 = 0.344
WIoU for r=0.6 = 0.236
F1 for r=0.9 = 0.277
WIoU for r=0.9 = 0.180
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.175
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.633
WIoU for r=0.3 = 0.516
F1 for r=0.6 = 0.497
WIoU for r=0.6 = 0.369
F1 for r=0.9 = 0.398
WIoU for r=0.9 = 0.269
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.262


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.423
Model XAI F1 of binarized graphs for r=0.3 =  0.68094125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5674275
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.413
SUFF++ for r=0.3 class 0 = 0.398 +- 0.287 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 class 1 = 0.42 +- 0.287 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 class 2 = 0.514 +- 0.287 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 all KL = 0.389 +- 0.287 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 all L1 = 0.444 +- 0.177 (in-sample avg dev_std = 0.545)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.671
Model XAI F1 of binarized graphs for r=0.6 =  0.57578875
Model XAI WIoU of binarized graphs for r=0.6 =  0.45611500000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.64
SUFF++ for r=0.6 class 0 = 0.425 +- 0.279 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.635 +- 0.279 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.721 +- 0.279 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.563 +- 0.279 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.593 +- 0.211 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.45764625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.33444374999999993
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.83
SUFF++ for r=0.9 class 0 = 0.553 +- 0.230 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 1 = 0.814 +- 0.230 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 2 = 0.848 +- 0.230 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all KL = 0.774 +- 0.230 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all L1 = 0.738 +- 0.194 (in-sample avg dev_std = 0.354)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  0.5191525
Model XAI WIoU of binarized graphs for r=0.3 =  0.40485249999999995
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.589
SUFF++ for r=0.3 class 0 = 0.422 +- 0.280 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 1 = 0.54 +- 0.280 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 2 = 0.64 +- 0.280 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all KL = 0.537 +- 0.280 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all L1 = 0.534 +- 0.201 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  0.34392375000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.23554374999999997
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.634
SUFF++ for r=0.6 class 0 = 0.417 +- 0.236 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 class 1 = 0.627 +- 0.236 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 class 2 = 0.621 +- 0.236 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 all KL = 0.618 +- 0.236 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 all L1 = 0.554 +- 0.166 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  0.27651375
Model XAI WIoU of binarized graphs for r=0.9 =  0.18005250000000003
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.716
SUFF++ for r=0.9 class 0 = 0.529 +- 0.189 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 class 1 = 0.631 +- 0.189 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 class 2 = 0.736 +- 0.189 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 all KL = 0.712 +- 0.189 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 all L1 = 0.632 +- 0.157 (in-sample avg dev_std = 0.330)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.63324625
Model XAI WIoU of binarized graphs for r=0.3 =  0.5162574999999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.479
SUFF++ for r=0.3 class 0 = 0.428 +- 0.320 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 1 = 0.58 +- 0.320 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 2 = 0.554 +- 0.320 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all KL = 0.523 +- 0.320 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all L1 = 0.522 +- 0.230 (in-sample avg dev_std = 0.481)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.49685
Model XAI WIoU of binarized graphs for r=0.6 =  0.36898875000000003
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.667
SUFF++ for r=0.6 class 0 = 0.487 +- 0.226 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.6 class 1 = 0.722 +- 0.226 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.6 class 2 = 0.773 +- 0.226 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.6 all KL = 0.723 +- 0.226 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.6 all L1 = 0.663 +- 0.198 (in-sample avg dev_std = 0.340)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.39836125
Model XAI WIoU of binarized graphs for r=0.9 =  0.26933625
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.707
SUFF++ for r=0.9 class 0 = 0.484 +- 0.249 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 1 = 0.676 +- 0.249 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 2 = 0.85 +- 0.249 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 all KL = 0.74 +- 0.249 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 all L1 = 0.672 +- 0.222 (in-sample avg dev_std = 0.307)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.423
Model XAI F1 of binarized graphs for r=0.3 =  0.68094125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5674275
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.313
NEC for r=0.3 class 0 = 0.586 +- 0.286 (in-sample avg dev_std = 0.500)
NEC for r=0.3 class 1 = 0.613 +- 0.286 (in-sample avg dev_std = 0.500)
NEC for r=0.3 class 2 = 0.661 +- 0.286 (in-sample avg dev_std = 0.500)
NEC for r=0.3 all KL = 0.68 +- 0.286 (in-sample avg dev_std = 0.500)
NEC for r=0.3 all L1 = 0.62 +- 0.177 (in-sample avg dev_std = 0.500)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.674
Model XAI F1 of binarized graphs for r=0.6 =  0.57578875
Model XAI WIoU of binarized graphs for r=0.6 =  0.45611500000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.363
NEC for r=0.6 class 0 = 0.582 +- 0.274 (in-sample avg dev_std = 0.542)
NEC for r=0.6 class 1 = 0.565 +- 0.274 (in-sample avg dev_std = 0.542)
NEC for r=0.6 class 2 = 0.653 +- 0.274 (in-sample avg dev_std = 0.542)
NEC for r=0.6 all KL = 0.674 +- 0.274 (in-sample avg dev_std = 0.542)
NEC for r=0.6 all L1 = 0.6 +- 0.163 (in-sample avg dev_std = 0.542)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.45764625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.33444374999999993
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.491
NEC for r=0.9 class 0 = 0.613 +- 0.244 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 1 = 0.51 +- 0.244 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 2 = 0.574 +- 0.244 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all KL = 0.642 +- 0.244 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all L1 = 0.565 +- 0.159 (in-sample avg dev_std = 0.627)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32874749999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.539
NEC for r=1.0 class 0 = 0.553 +- 0.237 (in-sample avg dev_std = 0.658)
NEC for r=1.0 class 1 = 0.475 +- 0.237 (in-sample avg dev_std = 0.658)
NEC for r=1.0 class 2 = 0.562 +- 0.237 (in-sample avg dev_std = 0.658)
NEC for r=1.0 all KL = 0.598 +- 0.237 (in-sample avg dev_std = 0.658)
NEC for r=1.0 all L1 = 0.53 +- 0.167 (in-sample avg dev_std = 0.658)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  0.5191525
Model XAI WIoU of binarized graphs for r=0.3 =  0.40485249999999995
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.318
NEC for r=0.3 class 0 = 0.585 +- 0.248 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 1 = 0.596 +- 0.248 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 2 = 0.698 +- 0.248 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all KL = 0.663 +- 0.248 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all L1 = 0.627 +- 0.128 (in-sample avg dev_std = 0.468)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.733
Model XAI F1 of binarized graphs for r=0.6 =  0.34392375000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.23554374999999997
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.418
NEC for r=0.6 class 0 = 0.61 +- 0.230 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 1 = 0.496 +- 0.230 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 2 = 0.605 +- 0.230 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all KL = 0.553 +- 0.230 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all L1 = 0.571 +- 0.124 (in-sample avg dev_std = 0.480)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.27651375
Model XAI WIoU of binarized graphs for r=0.9 =  0.18005250000000003
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.513
NEC for r=0.9 class 0 = 0.563 +- 0.198 (in-sample avg dev_std = 0.529)
NEC for r=0.9 class 1 = 0.58 +- 0.198 (in-sample avg dev_std = 0.529)
NEC for r=0.9 class 2 = 0.47 +- 0.198 (in-sample avg dev_std = 0.529)
NEC for r=0.9 all KL = 0.541 +- 0.198 (in-sample avg dev_std = 0.529)
NEC for r=0.9 all L1 = 0.537 +- 0.116 (in-sample avg dev_std = 0.529)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.17522000000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.493 +- 0.203 (in-sample avg dev_std = 0.594)
NEC for r=1.0 class 1 = 0.517 +- 0.203 (in-sample avg dev_std = 0.594)
NEC for r=1.0 class 2 = 0.506 +- 0.203 (in-sample avg dev_std = 0.594)
NEC for r=1.0 all KL = 0.535 +- 0.203 (in-sample avg dev_std = 0.594)
NEC for r=1.0 all L1 = 0.505 +- 0.126 (in-sample avg dev_std = 0.594)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.63324625
Model XAI WIoU of binarized graphs for r=0.3 =  0.5162574999999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.561 +- 0.291 (in-sample avg dev_std = 0.575)
NEC for r=0.3 class 1 = 0.497 +- 0.291 (in-sample avg dev_std = 0.575)
NEC for r=0.3 class 2 = 0.677 +- 0.291 (in-sample avg dev_std = 0.575)
NEC for r=0.3 all KL = 0.61 +- 0.291 (in-sample avg dev_std = 0.575)
NEC for r=0.3 all L1 = 0.578 +- 0.150 (in-sample avg dev_std = 0.575)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.49685
Model XAI WIoU of binarized graphs for r=0.6 =  0.36898875000000003
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.44
NEC for r=0.6 class 0 = 0.564 +- 0.273 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 1 = 0.445 +- 0.273 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 2 = 0.605 +- 0.273 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all KL = 0.549 +- 0.273 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all L1 = 0.537 +- 0.155 (in-sample avg dev_std = 0.545)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.39836125
Model XAI WIoU of binarized graphs for r=0.9 =  0.26933625
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.527
NEC for r=0.9 class 0 = 0.57 +- 0.306 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 1 = 0.457 +- 0.306 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 2 = 0.501 +- 0.306 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all KL = 0.545 +- 0.306 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all L1 = 0.508 +- 0.173 (in-sample avg dev_std = 0.546)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.526
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26152749999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.504
NEC for r=1.0 class 0 = 0.464 +- 0.242 (in-sample avg dev_std = 0.478)
NEC for r=1.0 class 1 = 0.465 +- 0.242 (in-sample avg dev_std = 0.478)
NEC for r=1.0 class 2 = 0.312 +- 0.242 (in-sample avg dev_std = 0.478)
NEC for r=1.0 all KL = 0.44 +- 0.242 (in-sample avg dev_std = 0.478)
NEC for r=1.0 all L1 = 0.414 +- 0.166 (in-sample avg dev_std = 0.478)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:17:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:17:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3191
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3380
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3803
OOD Test ACCURACY: 0.6390
OOD Test Loss: 1.0273

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.9197
Train Loss: 0.3431
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3258
ID Test ACCURACY: 0.9177
ID Test Loss: 0.3707
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3668
OOD Test ACCURACY: 0.7483
OOD Test Loss: 1.8033

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.6390 0.9177 0.7483 0.9267 0.9290[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.702
WIoU for r=0.3 = 0.579
F1 for r=0.6 = 0.574
WIoU for r=0.6 = 0.451
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.349
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.329
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.525
WIoU for r=0.3 = 0.408
F1 for r=0.6 = 0.342
WIoU for r=0.6 = 0.232
F1 for r=0.9 = 0.264
WIoU for r=0.9 = 0.171
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.173
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.677
WIoU for r=0.3 = 0.544
F1 for r=0.6 = 0.523
WIoU for r=0.6 = 0.384
F1 for r=0.9 = 0.411
WIoU for r=0.9 = 0.281
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.264


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.441
Model XAI F1 of binarized graphs for r=0.3 =  0.7019137499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5791775
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.425
SUFF++ for r=0.3 class 0 = 0.383 +- 0.256 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 1 = 0.436 +- 0.256 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 2 = 0.486 +- 0.256 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all KL = 0.397 +- 0.256 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all L1 = 0.435 +- 0.154 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.641
Model XAI F1 of binarized graphs for r=0.6 =  0.57352375
Model XAI WIoU of binarized graphs for r=0.6 =  0.45057875000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.621
SUFF++ for r=0.6 class 0 = 0.438 +- 0.256 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 1 = 0.569 +- 0.256 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 2 = 0.668 +- 0.256 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all KL = 0.534 +- 0.256 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all L1 = 0.558 +- 0.191 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.47448875
Model XAI WIoU of binarized graphs for r=0.9 =  0.34942875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.675 +- 0.180 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 1 = 0.817 +- 0.180 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 2 = 0.803 +- 0.180 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all KL = 0.816 +- 0.180 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all L1 = 0.765 +- 0.162 (in-sample avg dev_std = 0.308)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  0.52470875
Model XAI WIoU of binarized graphs for r=0.3 =  0.40773
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.562
SUFF++ for r=0.3 class 0 = 0.456 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 class 1 = 0.471 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 class 2 = 0.583 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 all KL = 0.526 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 all L1 = 0.504 +- 0.165 (in-sample avg dev_std = 0.463)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.734
Model XAI F1 of binarized graphs for r=0.6 =  0.34203125
Model XAI WIoU of binarized graphs for r=0.6 =  0.23239249999999997
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.584
SUFF++ for r=0.6 class 0 = 0.416 +- 0.221 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 1 = 0.622 +- 0.221 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 2 = 0.556 +- 0.221 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all KL = 0.621 +- 0.221 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all L1 = 0.53 +- 0.153 (in-sample avg dev_std = 0.371)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.876
Model XAI F1 of binarized graphs for r=0.9 =  0.2643725
Model XAI WIoU of binarized graphs for r=0.9 =  0.17077750000000003
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.705
SUFF++ for r=0.9 class 0 = 0.51 +- 0.191 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 class 1 = 0.675 +- 0.191 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 class 2 = 0.713 +- 0.191 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 all KL = 0.729 +- 0.191 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.9 all L1 = 0.632 +- 0.155 (in-sample avg dev_std = 0.336)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.479
Model XAI F1 of binarized graphs for r=0.3 =  0.6768700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.54437125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.52
SUFF++ for r=0.3 class 0 = 0.437 +- 0.295 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 class 1 = 0.501 +- 0.295 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.295 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 all KL = 0.438 +- 0.295 (in-sample avg dev_std = 0.570)
SUFF++ for r=0.3 all L1 = 0.504 +- 0.210 (in-sample avg dev_std = 0.570)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.777
Model XAI F1 of binarized graphs for r=0.6 =  0.52257
Model XAI WIoU of binarized graphs for r=0.6 =  0.38445
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.672
SUFF++ for r=0.6 class 0 = 0.483 +- 0.236 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 class 1 = 0.726 +- 0.236 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 class 2 = 0.725 +- 0.236 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 all KL = 0.663 +- 0.236 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 all L1 = 0.647 +- 0.186 (in-sample avg dev_std = 0.415)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  0.41138374999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.28105375000000005
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.671
SUFF++ for r=0.9 class 0 = 0.493 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 1 = 0.743 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 2 = 0.811 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all KL = 0.763 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all L1 = 0.685 +- 0.198 (in-sample avg dev_std = 0.284)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.44
Model XAI F1 of binarized graphs for r=0.3 =  0.7019137499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5791775
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.297
NEC for r=0.3 class 0 = 0.697 +- 0.268 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 1 = 0.54 +- 0.268 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 2 = 0.656 +- 0.268 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all KL = 0.679 +- 0.268 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all L1 = 0.631 +- 0.173 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.639
Model XAI F1 of binarized graphs for r=0.6 =  0.57352375
Model XAI WIoU of binarized graphs for r=0.6 =  0.45057875000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.375
NEC for r=0.6 class 0 = 0.617 +- 0.269 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 1 = 0.55 +- 0.269 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 2 = 0.663 +- 0.269 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all KL = 0.673 +- 0.269 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all L1 = 0.61 +- 0.160 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.47448875
Model XAI WIoU of binarized graphs for r=0.9 =  0.34942875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.608 +- 0.223 (in-sample avg dev_std = 0.631)
NEC for r=0.9 class 1 = 0.515 +- 0.223 (in-sample avg dev_std = 0.631)
NEC for r=0.9 class 2 = 0.575 +- 0.223 (in-sample avg dev_std = 0.631)
NEC for r=0.9 all KL = 0.632 +- 0.223 (in-sample avg dev_std = 0.631)
NEC for r=0.9 all L1 = 0.566 +- 0.150 (in-sample avg dev_std = 0.631)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32868875000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.545
NEC for r=1.0 class 0 = 0.553 +- 0.225 (in-sample avg dev_std = 0.641)
NEC for r=1.0 class 1 = 0.459 +- 0.225 (in-sample avg dev_std = 0.641)
NEC for r=1.0 class 2 = 0.559 +- 0.225 (in-sample avg dev_std = 0.641)
NEC for r=1.0 all KL = 0.567 +- 0.225 (in-sample avg dev_std = 0.641)
NEC for r=1.0 all L1 = 0.523 +- 0.163 (in-sample avg dev_std = 0.641)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.656
Model XAI F1 of binarized graphs for r=0.3 =  0.52470875
Model XAI WIoU of binarized graphs for r=0.3 =  0.40773
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.324
NEC for r=0.3 class 0 = 0.568 +- 0.244 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 1 = 0.607 +- 0.244 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 2 = 0.681 +- 0.244 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all KL = 0.621 +- 0.244 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all L1 = 0.619 +- 0.118 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.735
Model XAI F1 of binarized graphs for r=0.6 =  0.34203125
Model XAI WIoU of binarized graphs for r=0.6 =  0.23239249999999997
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.434
NEC for r=0.6 class 0 = 0.601 +- 0.221 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 1 = 0.484 +- 0.221 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 2 = 0.577 +- 0.221 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all KL = 0.497 +- 0.221 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all L1 = 0.555 +- 0.123 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.2643725
Model XAI WIoU of binarized graphs for r=0.9 =  0.17077750000000003
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.574 +- 0.185 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 1 = 0.519 +- 0.185 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 2 = 0.5 +- 0.185 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all KL = 0.516 +- 0.185 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all L1 = 0.531 +- 0.108 (in-sample avg dev_std = 0.522)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.17272625000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.58
NEC for r=1.0 class 0 = 0.513 +- 0.201 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 1 = 0.474 +- 0.201 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 2 = 0.516 +- 0.201 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all KL = 0.518 +- 0.201 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all L1 = 0.501 +- 0.124 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.476
Model XAI F1 of binarized graphs for r=0.3 =  0.6768700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.54437125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.349
NEC for r=0.3 class 0 = 0.62 +- 0.237 (in-sample avg dev_std = 0.580)
NEC for r=0.3 class 1 = 0.651 +- 0.237 (in-sample avg dev_std = 0.580)
NEC for r=0.3 class 2 = 0.695 +- 0.237 (in-sample avg dev_std = 0.580)
NEC for r=0.3 all KL = 0.749 +- 0.237 (in-sample avg dev_std = 0.580)
NEC for r=0.3 all L1 = 0.656 +- 0.134 (in-sample avg dev_std = 0.580)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.775
Model XAI F1 of binarized graphs for r=0.6 =  0.52257
Model XAI WIoU of binarized graphs for r=0.6 =  0.38445
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.422
NEC for r=0.6 class 0 = 0.577 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 1 = 0.514 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 class 2 = 0.629 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all KL = 0.618 +- 0.291 (in-sample avg dev_std = 0.550)
NEC for r=0.6 all L1 = 0.573 +- 0.168 (in-sample avg dev_std = 0.550)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  0.41138374999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.28105375000000005
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.607 +- 0.308 (in-sample avg dev_std = 0.518)
NEC for r=0.9 class 1 = 0.427 +- 0.308 (in-sample avg dev_std = 0.518)
NEC for r=0.9 class 2 = 0.477 +- 0.308 (in-sample avg dev_std = 0.518)
NEC for r=0.9 all KL = 0.504 +- 0.308 (in-sample avg dev_std = 0.518)
NEC for r=0.9 all L1 = 0.502 +- 0.179 (in-sample avg dev_std = 0.518)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.66
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26439750000000006
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.551
NEC for r=1.0 class 0 = 0.488 +- 0.259 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 1 = 0.411 +- 0.259 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 2 = 0.384 +- 0.259 (in-sample avg dev_std = 0.475)
NEC for r=1.0 all KL = 0.404 +- 0.259 (in-sample avg dev_std = 0.475)
NEC for r=1.0 all L1 = 0.427 +- 0.151 (in-sample avg dev_std = 0.475)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.378, 0.573, 0.788, 1.0], 'all_L1': [0.469, 0.616, 0.75, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.563, 0.774, 1.0], 'all_L1': [0.444, 0.593, 0.738, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.397, 0.534, 0.816, 1.0], 'all_L1': [0.435, 0.558, 0.765, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.701, 0.644, 0.646, 0.598], 'all_L1': [0.608, 0.561, 0.556, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.674, 0.642, 0.598], 'all_L1': [0.62, 0.6, 0.565, 0.53]}), defaultdict(<class 'list'>, {'all_KL': [0.679, 0.673, 0.632, 0.567], 'all_L1': [0.631, 0.61, 0.566, 0.523]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.55, 0.602, 0.652, 1.0], 'all_L1': [0.556, 0.54, 0.582, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.618, 0.712, 1.0], 'all_L1': [0.534, 0.554, 0.632, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.621, 0.729, 1.0], 'all_L1': [0.504, 0.53, 0.632, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.65, 0.545, 0.558, 0.607], 'all_L1': [0.615, 0.558, 0.552, 0.564]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.553, 0.541, 0.535], 'all_L1': [0.627, 0.571, 0.537, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.621, 0.497, 0.516, 0.518], 'all_L1': [0.619, 0.555, 0.531, 0.501]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.507, 0.667, 0.741, 1.0], 'all_L1': [0.573, 0.658, 0.705, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.523, 0.723, 0.74, 1.0], 'all_L1': [0.522, 0.663, 0.672, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.663, 0.763, 1.0], 'all_L1': [0.504, 0.647, 0.685, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.72, 0.616, 0.591, 0.463], 'all_L1': [0.587, 0.546, 0.518, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.549, 0.545, 0.44], 'all_L1': [0.578, 0.537, 0.508, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.618, 0.504, 0.404], 'all_L1': [0.656, 0.573, 0.502, 0.427]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.449 +- 0.014, 0.589 +- 0.024, 0.751 +- 0.011, 1.000 +- 0.000
suff++ class all_KL  =  0.388 +- 0.008, 0.557 +- 0.017, 0.793 +- 0.017, 1.000 +- 0.000
suff++_acc_int  =  0.428 +- 0.013, 0.639 +- 0.014, 0.852 +- 0.017
nec class all_L1  =  0.620 +- 0.009, 0.590 +- 0.021, 0.562 +- 0.004, 0.523 +- 0.006
nec class all_KL  =  0.687 +- 0.010, 0.664 +- 0.014, 0.640 +- 0.006, 0.588 +- 0.015
nec_acc_int  =  0.315 +- 0.016, 0.375 +- 0.010, 0.504 +- 0.010, 0.548 +- 0.009

Eval split val
suff++ class all_L1  =  0.531 +- 0.021, 0.541 +- 0.010, 0.615 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.538 +- 0.010, 0.614 +- 0.008, 0.698 +- 0.033, 1.000 +- 0.000
suff++_acc_int  =  0.580 +- 0.012, 0.598 +- 0.026, 0.703 +- 0.012
nec class all_L1  =  0.620 +- 0.005, 0.561 +- 0.007, 0.540 +- 0.009, 0.523 +- 0.029
nec class all_KL  =  0.645 +- 0.018, 0.532 +- 0.025, 0.538 +- 0.017, 0.553 +- 0.039
nec_acc_int  =  0.315 +- 0.010, 0.422 +- 0.008, 0.534 +- 0.017, 0.579 +- 0.007

Eval split test
suff++ class all_L1  =  0.533 +- 0.029, 0.656 +- 0.007, 0.687 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.489 +- 0.037, 0.684 +- 0.027, 0.748 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.515 +- 0.027, 0.675 +- 0.008, 0.681 +- 0.018
nec class all_L1  =  0.607 +- 0.035, 0.552 +- 0.015, 0.509 +- 0.007, 0.426 +- 0.009
nec class all_KL  =  0.693 +- 0.060, 0.594 +- 0.032, 0.547 +- 0.036, 0.436 +- 0.024
nec_acc_int  =  0.381 +- 0.028, 0.443 +- 0.018, 0.532 +- 0.003, 0.540 +- 0.026


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.535 +- 0.003, 0.590 +- 0.005, 0.657 +- 0.006, 0.762 +- 0.003
Faith. Armon (L1)= 		  =  0.521 +- 0.006, 0.589 +- 0.006, 0.643 +- 0.005, 0.687 +- 0.005
Faith. GMean (L1)= 	  =  0.528 +- 0.005, 0.589 +- 0.005, 0.650 +- 0.006, 0.723 +- 0.004
Faith. Aritm (KL)= 		  =  0.537 +- 0.002, 0.610 +- 0.006, 0.716 +- 0.007, 0.794 +- 0.007
Faith. Armon (KL)= 		  =  0.496 +- 0.004, 0.605 +- 0.007, 0.708 +- 0.004, 0.740 +- 0.012
Faith. GMean (KL)= 	  =  0.516 +- 0.002, 0.608 +- 0.007, 0.712 +- 0.005, 0.767 +- 0.010

Eval split val
Faith. Aritm (L1)= 		  =  0.576 +- 0.010, 0.551 +- 0.008, 0.578 +- 0.008, 0.762 +- 0.014
Faith. Armon (L1)= 		  =  0.572 +- 0.012, 0.551 +- 0.008, 0.575 +- 0.006, 0.687 +- 0.025
Faith. GMean (L1)= 	  =  0.574 +- 0.011, 0.551 +- 0.008, 0.576 +- 0.007, 0.723 +- 0.020
Faith. Aritm (KL)= 		  =  0.591 +- 0.012, 0.573 +- 0.011, 0.618 +- 0.009, 0.777 +- 0.019
Faith. Armon (KL)= 		  =  0.586 +- 0.012, 0.569 +- 0.013, 0.607 +- 0.006, 0.712 +- 0.032
Faith. GMean (KL)= 	  =  0.589 +- 0.012, 0.571 +- 0.012, 0.612 +- 0.007, 0.743 +- 0.026

Eval split test
Faith. Aritm (L1)= 		  =  0.570 +- 0.014, 0.604 +- 0.004, 0.598 +- 0.009, 0.713 +- 0.005
Faith. Armon (L1)= 		  =  0.566 +- 0.013, 0.599 +- 0.006, 0.585 +- 0.009, 0.597 +- 0.009
Faith. GMean (L1)= 	  =  0.568 +- 0.013, 0.602 +- 0.005, 0.592 +- 0.009, 0.652 +- 0.007
Faith. Aritm (KL)= 		  =  0.591 +- 0.019, 0.639 +- 0.002, 0.647 +- 0.014, 0.718 +- 0.012
Faith. Armon (KL)= 		  =  0.570 +- 0.018, 0.635 +- 0.008, 0.631 +- 0.021, 0.607 +- 0.024
Faith. GMean (KL)= 	  =  0.581 +- 0.017, 0.637 +- 0.005, 0.639 +- 0.017, 0.660 +- 0.018
Computed for split load_split = id



Completed in  0:11:28.205408  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:21:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 11:21:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9472
Train Loss: 0.0807
ID Validation ACCURACY: 0.8638
ID Validation Loss: 0.5569
ID Test ACCURACY: 0.8542
ID Test Loss: 0.6640
OOD Validation ACCURACY: 0.8582
OOD Validation Loss: 1.2856
OOD Test ACCURACY: 0.8136
OOD Test Loss: 3.3019

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 0.9439
Train Loss: 0.0928
ID Validation ACCURACY: 0.8502
ID Validation Loss: 0.4924
ID Test ACCURACY: 0.8523
ID Test Loss: 0.5678
OOD Validation ACCURACY: 0.8595
OOD Validation Loss: 0.9019
OOD Test ACCURACY: 0.8168
OOD Test Loss: 2.0206

[0m[1;37mINFO[0m: [1mChartInfo 0.8542 0.8136 0.8523 0.8168 0.8502 0.8595[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 11:21:49 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.823
SUFF++ for r=0.6 class 0.0 = 0.856 +- 0.316 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 1.0 = 0.856 +- 0.316 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all KL = 0.75 +- 0.316 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all L1 = 0.856 +- 0.208 (in-sample avg dev_std = 0.391)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.85
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0.0 = 0.916 +- 0.175 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 1.0 = 0.933 +- 0.175 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all KL = 0.933 +- 0.175 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all L1 = 0.926 +- 0.168 (in-sample avg dev_std = 0.182)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.837
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.741
SUFF++ for r=0.3 class 0.0 = 0.763 +- 0.337 (in-sample avg dev_std = 0.642)
SUFF++ for r=0.3 class 1.0 = 0.662 +- 0.337 (in-sample avg dev_std = 0.642)
SUFF++ for r=0.3 all KL = 0.433 +- 0.337 (in-sample avg dev_std = 0.642)
SUFF++ for r=0.3 all L1 = 0.711 +- 0.202 (in-sample avg dev_std = 0.642)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.844
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.81
SUFF++ for r=0.6 class 0.0 = 0.89 +- 0.335 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1.0 = 0.813 +- 0.335 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.7 +- 0.335 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.85 +- 0.190 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.855
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.852
SUFF++ for r=0.9 class 0.0 = 0.951 +- 0.163 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.163 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 all KL = 0.931 +- 0.163 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.122 (in-sample avg dev_std = 0.205)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.812
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.744
SUFF++ for r=0.3 class 0.0 = 0.781 +- 0.388 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.3 class 1.0 = 0.72 +- 0.388 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.3 all KL = 0.429 +- 0.388 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.3 all L1 = 0.75 +- 0.205 (in-sample avg dev_std = 0.627)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.792
SUFF++ for r=0.6 class 0.0 = 0.893 +- 0.367 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 1.0 = 0.845 +- 0.367 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all KL = 0.715 +- 0.367 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all L1 = 0.868 +- 0.192 (in-sample avg dev_std = 0.397)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.825
SUFF++ for r=0.9 class 0.0 = 0.945 +- 0.173 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.9 class 1.0 = 0.934 +- 0.173 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.9 all KL = 0.93 +- 0.173 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.137 (in-sample avg dev_std = 0.181)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.85
NEC for r=0.6 class 0.0 = 0.127 +- 0.278 (in-sample avg dev_std = 0.228)
NEC for r=0.6 class 1.0 = 0.099 +- 0.278 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all KL = 0.134 +- 0.278 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all L1 = 0.111 +- 0.225 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.864
NEC for r=0.9 class 0.0 = 0.068 +- 0.160 (in-sample avg dev_std = 0.176)
NEC for r=0.9 class 1.0 = 0.049 +- 0.160 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all KL = 0.055 +- 0.160 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all L1 = 0.057 +- 0.146 (in-sample avg dev_std = 0.176)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.867
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.864
NEC for r=1.0 class 0.0 = 0.074 +- 0.162 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1.0 = 0.046 +- 0.162 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.057 +- 0.162 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.057 +- 0.150 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.837
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.826
NEC for r=0.3 class 0.0 = 0.126 +- 0.283 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 1.0 = 0.133 +- 0.283 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all KL = 0.156 +- 0.283 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all L1 = 0.13 +- 0.229 (in-sample avg dev_std = 0.242)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.844
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.839
NEC for r=0.6 class 0.0 = 0.079 +- 0.226 (in-sample avg dev_std = 0.212)
NEC for r=0.6 class 1.0 = 0.095 +- 0.226 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all KL = 0.107 +- 0.226 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all L1 = 0.088 +- 0.177 (in-sample avg dev_std = 0.212)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.855
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.856
NEC for r=0.9 class 0.0 = 0.061 +- 0.172 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.063 +- 0.172 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.064 +- 0.172 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.062 +- 0.147 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.859
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.862
NEC for r=1.0 class 0.0 = 0.054 +- 0.149 (in-sample avg dev_std = 0.147)
NEC for r=1.0 class 1.0 = 0.05 +- 0.149 (in-sample avg dev_std = 0.147)
NEC for r=1.0 all KL = 0.05 +- 0.149 (in-sample avg dev_std = 0.147)
NEC for r=1.0 all L1 = 0.052 +- 0.130 (in-sample avg dev_std = 0.147)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.812
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.811
NEC for r=0.3 class 0.0 = 0.096 +- 0.293 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 1.0 = 0.126 +- 0.293 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all KL = 0.158 +- 0.293 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all L1 = 0.112 +- 0.214 (in-sample avg dev_std = 0.276)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.815
NEC for r=0.6 class 0.0 = 0.076 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 1.0 = 0.093 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all KL = 0.127 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all L1 = 0.085 +- 0.177 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.83
NEC for r=0.9 class 0.0 = 0.069 +- 0.206 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 1.0 = 0.069 +- 0.206 (in-sample avg dev_std = 0.187)
NEC for r=0.9 all KL = 0.087 +- 0.206 (in-sample avg dev_std = 0.187)
NEC for r=0.9 all L1 = 0.069 +- 0.154 (in-sample avg dev_std = 0.187)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.836
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0.0 = 0.069 +- 0.189 (in-sample avg dev_std = 0.180)
NEC for r=1.0 class 1.0 = 0.066 +- 0.189 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all KL = 0.077 +- 0.189 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all L1 = 0.067 +- 0.158 (in-sample avg dev_std = 0.180)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:25:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0755
ID Validation ACCURACY: 0.8640
ID Validation Loss: 0.6847
ID Test ACCURACY: 0.8623
ID Test Loss: 0.7604
OOD Validation ACCURACY: 0.8614
OOD Validation Loss: 1.0820
OOD Test ACCURACY: 0.8157
OOD Test Loss: 2.1369

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0754
ID Validation ACCURACY: 0.8619
ID Validation Loss: 0.7617
ID Test ACCURACY: 0.8598
ID Test Loss: 0.8515
OOD Validation ACCURACY: 0.8642
OOD Validation Loss: 1.0488
OOD Test ACCURACY: 0.8181
OOD Test Loss: 2.0109

[0m[1;37mINFO[0m: [1mChartInfo 0.8623 0.8157 0.8598 0.8181 0.8619 0.8642[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 11:25:04 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.79
SUFF++ for r=0.6 class 0.0 = 0.708 +- 0.384 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.6 class 1.0 = 0.862 +- 0.384 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.6 all KL = 0.602 +- 0.384 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.6 all L1 = 0.798 +- 0.225 (in-sample avg dev_std = 0.511)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0.0 = 0.94 +- 0.186 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 class 1.0 = 0.937 +- 0.186 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 all KL = 0.932 +- 0.186 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.158 (in-sample avg dev_std = 0.187)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.801
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.699
SUFF++ for r=0.3 class 0.0 = 0.594 +- 0.330 (in-sample avg dev_std = 0.710)
SUFF++ for r=0.3 class 1.0 = 0.735 +- 0.330 (in-sample avg dev_std = 0.710)
SUFF++ for r=0.3 all KL = 0.35 +- 0.330 (in-sample avg dev_std = 0.710)
SUFF++ for r=0.3 all L1 = 0.667 +- 0.212 (in-sample avg dev_std = 0.710)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.835
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.769
SUFF++ for r=0.6 class 0.0 = 0.739 +- 0.374 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 class 1.0 = 0.851 +- 0.374 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 all KL = 0.584 +- 0.374 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.6 all L1 = 0.797 +- 0.208 (in-sample avg dev_std = 0.542)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.841
SUFF++ for r=0.9 class 0.0 = 0.915 +- 0.210 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 1.0 = 0.946 +- 0.210 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all KL = 0.897 +- 0.210 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.140 (in-sample avg dev_std = 0.271)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.707
SUFF++ for r=0.3 class 0.0 = 0.626 +- 0.385 (in-sample avg dev_std = 0.641)
SUFF++ for r=0.3 class 1.0 = 0.807 +- 0.385 (in-sample avg dev_std = 0.641)
SUFF++ for r=0.3 all KL = 0.437 +- 0.385 (in-sample avg dev_std = 0.641)
SUFF++ for r=0.3 all L1 = 0.719 +- 0.228 (in-sample avg dev_std = 0.641)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.77
SUFF++ for r=0.6 class 0.0 = 0.75 +- 0.351 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 1.0 = 0.892 +- 0.351 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all KL = 0.663 +- 0.351 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all L1 = 0.823 +- 0.211 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0.0 = 0.893 +- 0.199 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1.0 = 0.934 +- 0.199 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.901 +- 0.199 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.914 +- 0.169 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.836
NEC for r=0.6 class 0.0 = 0.138 +- 0.260 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 1.0 = 0.072 +- 0.260 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all KL = 0.121 +- 0.260 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all L1 = 0.1 +- 0.203 (in-sample avg dev_std = 0.251)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.86
NEC for r=0.9 class 0.0 = 0.056 +- 0.178 (in-sample avg dev_std = 0.173)
NEC for r=0.9 class 1.0 = 0.055 +- 0.178 (in-sample avg dev_std = 0.173)
NEC for r=0.9 all KL = 0.063 +- 0.178 (in-sample avg dev_std = 0.173)
NEC for r=0.9 all L1 = 0.056 +- 0.151 (in-sample avg dev_std = 0.173)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.86
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.855
NEC for r=1.0 class 0.0 = 0.047 +- 0.183 (in-sample avg dev_std = 0.176)
NEC for r=1.0 class 1.0 = 0.053 +- 0.183 (in-sample avg dev_std = 0.176)
NEC for r=1.0 all KL = 0.06 +- 0.183 (in-sample avg dev_std = 0.176)
NEC for r=1.0 all L1 = 0.051 +- 0.149 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.801
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.792
NEC for r=0.3 class 0.0 = 0.231 +- 0.339 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 1.0 = 0.099 +- 0.339 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all KL = 0.212 +- 0.339 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all L1 = 0.162 +- 0.256 (in-sample avg dev_std = 0.332)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.835
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.826
NEC for r=0.6 class 0.0 = 0.135 +- 0.245 (in-sample avg dev_std = 0.246)
NEC for r=0.6 class 1.0 = 0.05 +- 0.245 (in-sample avg dev_std = 0.246)
NEC for r=0.6 all KL = 0.113 +- 0.245 (in-sample avg dev_std = 0.246)
NEC for r=0.6 all L1 = 0.091 +- 0.191 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.849
NEC for r=0.9 class 0.0 = 0.078 +- 0.174 (in-sample avg dev_std = 0.199)
NEC for r=0.9 class 1.0 = 0.04 +- 0.174 (in-sample avg dev_std = 0.199)
NEC for r=0.9 all KL = 0.063 +- 0.174 (in-sample avg dev_std = 0.199)
NEC for r=0.9 all L1 = 0.058 +- 0.150 (in-sample avg dev_std = 0.199)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.851
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.852
NEC for r=1.0 class 0.0 = 0.068 +- 0.144 (in-sample avg dev_std = 0.158)
NEC for r=1.0 class 1.0 = 0.035 +- 0.144 (in-sample avg dev_std = 0.158)
NEC for r=1.0 all KL = 0.046 +- 0.144 (in-sample avg dev_std = 0.158)
NEC for r=1.0 all L1 = 0.051 +- 0.137 (in-sample avg dev_std = 0.158)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.769
NEC for r=0.3 class 0.0 = 0.275 +- 0.362 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1.0 = 0.092 +- 0.362 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.26 +- 0.362 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.18 +- 0.264 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.804
NEC for r=0.6 class 0.0 = 0.196 +- 0.273 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 1.0 = 0.057 +- 0.273 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all KL = 0.153 +- 0.273 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all L1 = 0.124 +- 0.215 (in-sample avg dev_std = 0.297)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.826
NEC for r=0.9 class 0.0 = 0.1 +- 0.180 (in-sample avg dev_std = 0.191)
NEC for r=0.9 class 1.0 = 0.056 +- 0.180 (in-sample avg dev_std = 0.191)
NEC for r=0.9 all KL = 0.076 +- 0.180 (in-sample avg dev_std = 0.191)
NEC for r=0.9 all L1 = 0.077 +- 0.167 (in-sample avg dev_std = 0.191)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.841
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.837
NEC for r=1.0 class 0.0 = 0.081 +- 0.141 (in-sample avg dev_std = 0.148)
NEC for r=1.0 class 1.0 = 0.049 +- 0.141 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all KL = 0.051 +- 0.141 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all L1 = 0.065 +- 0.148 (in-sample avg dev_std = 0.148)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:28:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8630
ID Validation Loss: 0.8408
ID Test ACCURACY: 0.8625
ID Test Loss: 0.9711
OOD Validation ACCURACY: 0.8587
OOD Validation Loss: 1.3017
OOD Test ACCURACY: 0.7962
OOD Test Loss: 2.1004

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9474
Train Loss: 0.0804
ID Validation ACCURACY: 0.8585
ID Validation Loss: 0.5789
ID Test ACCURACY: 0.8617
ID Test Loss: 0.6702
OOD Validation ACCURACY: 0.8607
OOD Validation Loss: 0.9609
OOD Test ACCURACY: 0.8074
OOD Test Loss: 1.7859

[0m[1;37mINFO[0m: [1mChartInfo 0.8625 0.7962 0.8617 0.8074 0.8585 0.8607[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 04/22/2024 11:28:14 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17206)
Data example from val: Data(x=[8, 768], edge_index=[2, 14], y=[1, 1], idx=[1], sentence_tokens=[8], length=[1], domain_id=[1])
Label distribution from val: (tensor([0., 1.]), tensor([8233, 8973]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.829
SUFF++ for r=0.6 class 0.0 = 0.831 +- 0.384 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 1.0 = 0.898 +- 0.384 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all KL = 0.713 +- 0.384 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all L1 = 0.87 +- 0.203 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0.0 = 0.93 +- 0.202 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 1.0 = 0.936 +- 0.202 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all KL = 0.928 +- 0.202 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all L1 = 0.933 +- 0.175 (in-sample avg dev_std = 0.174)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.755
SUFF++ for r=0.3 class 0.0 = 0.709 +- 0.389 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 class 1.0 = 0.779 +- 0.389 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 all KL = 0.422 +- 0.389 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 all L1 = 0.746 +- 0.204 (in-sample avg dev_std = 0.636)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.802
SUFF++ for r=0.6 class 0.0 = 0.789 +- 0.379 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 1.0 = 0.873 +- 0.379 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all KL = 0.67 +- 0.379 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all L1 = 0.833 +- 0.218 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.858
SUFF++ for r=0.9 class 0.0 = 0.924 +- 0.185 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 1.0 = 0.94 +- 0.185 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all KL = 0.915 +- 0.185 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all L1 = 0.933 +- 0.143 (in-sample avg dev_std = 0.250)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.81
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.729
SUFF++ for r=0.3 class 0.0 = 0.677 +- 0.375 (in-sample avg dev_std = 0.640)
SUFF++ for r=0.3 class 1.0 = 0.776 +- 0.375 (in-sample avg dev_std = 0.640)
SUFF++ for r=0.3 all KL = 0.407 +- 0.375 (in-sample avg dev_std = 0.640)
SUFF++ for r=0.3 all L1 = 0.728 +- 0.215 (in-sample avg dev_std = 0.640)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.801
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.766
SUFF++ for r=0.6 class 0.0 = 0.772 +- 0.362 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1.0 = 0.907 +- 0.362 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.708 +- 0.362 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.842 +- 0.215 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.804
SUFF++ for r=0.9 class 0.0 = 0.899 +- 0.215 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 class 1.0 = 0.956 +- 0.215 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all KL = 0.906 +- 0.215 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all L1 = 0.928 +- 0.159 (in-sample avg dev_std = 0.224)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.864
NEC for r=0.6 class 0.0 = 0.105 +- 0.262 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 1.0 = 0.048 +- 0.262 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all KL = 0.103 +- 0.262 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all L1 = 0.072 +- 0.188 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.87
NEC for r=0.9 class 0.0 = 0.082 +- 0.204 (in-sample avg dev_std = 0.175)
NEC for r=0.9 class 1.0 = 0.049 +- 0.204 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all L1 = 0.063 +- 0.174 (in-sample avg dev_std = 0.175)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0.0 = 0.078 +- 0.195 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1.0 = 0.045 +- 0.195 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.064 +- 0.195 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.059 +- 0.171 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.324 +- 0.019
Model Accuracy over intervened graphs for r=0.3 =  0.819
NEC for r=0.3 class 0.0 = 0.162 +- 0.328 (in-sample avg dev_std = 0.313)
NEC for r=0.3 class 1.0 = 0.092 +- 0.328 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all KL = 0.177 +- 0.328 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all L1 = 0.126 +- 0.234 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.623 +- 0.014
Model Accuracy over intervened graphs for r=0.6 =  0.845
NEC for r=0.6 class 0.0 = 0.134 +- 0.281 (in-sample avg dev_std = 0.276)
NEC for r=0.6 class 1.0 = 0.081 +- 0.281 (in-sample avg dev_std = 0.276)
NEC for r=0.6 all KL = 0.138 +- 0.281 (in-sample avg dev_std = 0.276)
NEC for r=0.6 all L1 = 0.107 +- 0.217 (in-sample avg dev_std = 0.276)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.924 +- 0.014
Model Accuracy over intervened graphs for r=0.9 =  0.851
NEC for r=0.9 class 0.0 = 0.088 +- 0.202 (in-sample avg dev_std = 0.224)
NEC for r=0.9 class 1.0 = 0.061 +- 0.202 (in-sample avg dev_std = 0.224)
NEC for r=0.9 all KL = 0.081 +- 0.202 (in-sample avg dev_std = 0.224)
NEC for r=0.9 all L1 = 0.074 +- 0.169 (in-sample avg dev_std = 0.224)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.864
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.862
NEC for r=1.0 class 0.0 = 0.062 +- 0.161 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 1.0 = 0.047 +- 0.161 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all KL = 0.054 +- 0.161 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all L1 = 0.054 +- 0.138 (in-sample avg dev_std = 0.177)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.81
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.805
NEC for r=0.3 class 0.0 = 0.15 +- 0.286 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 1.0 = 0.087 +- 0.286 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all KL = 0.155 +- 0.286 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all L1 = 0.118 +- 0.220 (in-sample avg dev_std = 0.293)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.801
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.799
NEC for r=0.6 class 0.0 = 0.133 +- 0.259 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1.0 = 0.069 +- 0.259 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.126 +- 0.259 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.1 +- 0.199 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.804
NEC for r=0.9 class 0.0 = 0.1 +- 0.219 (in-sample avg dev_std = 0.231)
NEC for r=0.9 class 1.0 = 0.055 +- 0.219 (in-sample avg dev_std = 0.231)
NEC for r=0.9 all KL = 0.094 +- 0.219 (in-sample avg dev_std = 0.231)
NEC for r=0.9 all L1 = 0.077 +- 0.173 (in-sample avg dev_std = 0.231)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.809
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.809
NEC for r=1.0 class 0.0 = 0.09 +- 0.187 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 1.0 = 0.047 +- 0.187 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all KL = 0.071 +- 0.187 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all L1 = 0.068 +- 0.164 (in-sample avg dev_std = 0.195)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.75, 0.933, 1.0], 'all_L1': [0.856, 0.926, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.932, 1.0], 'all_L1': [0.798, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.713, 0.928, 1.0], 'all_L1': [0.87, 0.933, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.134, 0.055, 0.057], 'all_L1': [0.111, 0.057, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.063, 0.06], 'all_L1': [0.1, 0.056, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.103, 0.072, 0.064], 'all_L1': [0.072, 0.063, 0.059]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.433, 0.7, 0.931, 1.0], 'all_L1': [0.711, 0.85, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.35, 0.584, 0.897, 1.0], 'all_L1': [0.667, 0.797, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.67, 0.915, 1.0], 'all_L1': [0.746, 0.833, 0.933, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.156, 0.107, 0.064, 0.05], 'all_L1': [0.13, 0.088, 0.062, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.113, 0.063, 0.046], 'all_L1': [0.162, 0.091, 0.058, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.177, 0.138, 0.081, 0.054], 'all_L1': [0.126, 0.107, 0.074, 0.054]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.429, 0.715, 0.93, 1.0], 'all_L1': [0.75, 0.868, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.663, 0.901, 1.0], 'all_L1': [0.719, 0.823, 0.914, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.708, 0.906, 1.0], 'all_L1': [0.728, 0.842, 0.928, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.158, 0.127, 0.087, 0.077], 'all_L1': [0.112, 0.085, 0.069, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.153, 0.076, 0.051], 'all_L1': [0.18, 0.124, 0.077, 0.065]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.126, 0.094, 0.071], 'all_L1': [0.118, 0.1, 0.077, 0.068]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.841 +- 0.031, 0.932 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.688 +- 0.063, 0.931 +- 0.002, 1.000 +- 0.000
suff++_acc_int  =  0.814 +- 0.017, 0.868 +- 0.012
nec class all_L1  =  0.094 +- 0.016, 0.059 +- 0.003, 0.056 +- 0.003
nec class all_KL  =  0.119 +- 0.013, 0.063 +- 0.007, 0.060 +- 0.003
nec_acc_int  =  0.850 +- 0.012, 0.864 +- 0.004, 0.863 +- 0.006

Eval split val
suff++ class all_L1  =  0.708 +- 0.032, 0.827 +- 0.022, 0.936 +- 0.006, 1.000 +- 0.000
suff++ class all_KL  =  0.402 +- 0.037, 0.651 +- 0.049, 0.914 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.731 +- 0.024, 0.793 +- 0.018, 0.850 +- 0.007
nec class all_L1  =  0.139 +- 0.016, 0.095 +- 0.008, 0.065 +- 0.007, 0.052 +- 0.001
nec class all_KL  =  0.182 +- 0.023, 0.119 +- 0.013, 0.069 +- 0.008, 0.050 +- 0.003
nec_acc_int  =  0.813 +- 0.015, 0.837 +- 0.008, 0.852 +- 0.003, 0.859 +- 0.005

Eval split test
suff++ class all_L1  =  0.732 +- 0.013, 0.844 +- 0.018, 0.927 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.424 +- 0.013, 0.695 +- 0.023, 0.912 +- 0.013, 1.000 +- 0.000
suff++_acc_int  =  0.727 +- 0.015, 0.776 +- 0.011, 0.818 +- 0.010
nec class all_L1  =  0.137 +- 0.031, 0.103 +- 0.016, 0.074 +- 0.004, 0.067 +- 0.001
nec class all_KL  =  0.191 +- 0.049, 0.135 +- 0.012, 0.086 +- 0.007, 0.066 +- 0.011
nec_acc_int  =  0.795 +- 0.018, 0.806 +- 0.007, 0.820 +- 0.011, 0.826 +- 0.012


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.468 +- 0.014, 0.495 +- 0.003, 0.528 +- 0.002
Faith. Armon (L1)= 		  =  0.169 +- 0.027, 0.110 +- 0.005, 0.105 +- 0.006
Faith. GMean (L1)= 	  =  0.280 +- 0.024, 0.234 +- 0.006, 0.236 +- 0.007
Faith. Aritm (KL)= 		  =  0.404 +- 0.033, 0.497 +- 0.002, 0.530 +- 0.001
Faith. Armon (KL)= 		  =  0.203 +- 0.019, 0.119 +- 0.012, 0.114 +- 0.005
Faith. GMean (KL)= 	  =  0.286 +- 0.022, 0.242 +- 0.013, 0.246 +- 0.006

Eval split val
Faith. Aritm (L1)= 		  =  0.424 +- 0.009, 0.461 +- 0.012, 0.500 +- 0.004, 0.526 +- 0.001
Faith. Armon (L1)= 		  =  0.232 +- 0.020, 0.171 +- 0.013, 0.121 +- 0.012, 0.099 +- 0.002
Faith. GMean (L1)= 	  =  0.313 +- 0.011, 0.280 +- 0.013, 0.246 +- 0.013, 0.229 +- 0.003
Faith. Aritm (KL)= 		  =  0.292 +- 0.008, 0.385 +- 0.026, 0.492 +- 0.008, 0.525 +- 0.002
Faith. Armon (KL)= 		  =  0.248 +- 0.014, 0.201 +- 0.020, 0.129 +- 0.014, 0.095 +- 0.006
Faith. GMean (KL)= 	  =  0.269 +- 0.006, 0.278 +- 0.020, 0.251 +- 0.015, 0.223 +- 0.007

Eval split test
Faith. Aritm (L1)= 		  =  0.434 +- 0.011, 0.474 +- 0.002, 0.501 +- 0.004, 0.533 +- 0.001
Faith. Armon (L1)= 		  =  0.229 +- 0.042, 0.183 +- 0.025, 0.138 +- 0.006, 0.125 +- 0.002
Faith. GMean (L1)= 	  =  0.314 +- 0.032, 0.294 +- 0.020, 0.262 +- 0.006, 0.258 +- 0.002
Faith. Aritm (KL)= 		  =  0.308 +- 0.029, 0.415 +- 0.005, 0.499 +- 0.008, 0.533 +- 0.006
Faith. Armon (KL)= 		  =  0.260 +- 0.046, 0.226 +- 0.016, 0.157 +- 0.012, 0.124 +- 0.020
Faith. GMean (KL)= 	  =  0.283 +- 0.039, 0.306 +- 0.009, 0.279 +- 0.013, 0.257 +- 0.022
Computed for split load_split = id



Completed in  0:10:05.639663  for GSATvGIN GOODSST2/length



DONE GSAT GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:32:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:19 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:21 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 11:32:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.7058
ID Validation Loss: 2.4932
ID Test ACCURACY: 0.6588
ID Test Loss: 2.8260
OOD Validation ACCURACY: 0.6471
OOD Validation Loss: 2.9021
OOD Test ACCURACY: 0.5710
OOD Test Loss: 3.5556

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.7058
ID Validation Loss: 2.4932
ID Test ACCURACY: 0.6588
ID Test Loss: 2.8260
OOD Validation ACCURACY: 0.6471
OOD Validation Loss: 2.9021
OOD Test ACCURACY: 0.5710
OOD Test Loss: 3.5556

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5710 0.6588 0.5710 0.7058 0.6471[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.57
SUFF++ for r=0.3 class 0 = 0.56 +- 0.329 (in-sample avg dev_std = 0.712)
SUFF++ for r=0.3 class 1 = 0.671 +- 0.329 (in-sample avg dev_std = 0.712)
SUFF++ for r=0.3 class 2 = 0.577 +- 0.329 (in-sample avg dev_std = 0.712)
SUFF++ for r=0.3 all KL = 0.326 +- 0.329 (in-sample avg dev_std = 0.712)
SUFF++ for r=0.3 all L1 = 0.618 +- 0.227 (in-sample avg dev_std = 0.712)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.639
SUFF++ for r=0.6 class 0 = 0.712 +- 0.379 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.6 class 1 = 0.799 +- 0.379 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.6 class 2 = 0.703 +- 0.379 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.6 all KL = 0.54 +- 0.379 (in-sample avg dev_std = 0.569)
SUFF++ for r=0.6 all L1 = 0.751 +- 0.237 (in-sample avg dev_std = 0.569)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.681
SUFF++ for r=0.9 class 0 = 0.874 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 1 = 0.891 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 2 = 0.86 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all KL = 0.858 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all L1 = 0.878 +- 0.188 (in-sample avg dev_std = 0.315)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0 = 0.592 +- 0.359 (in-sample avg dev_std = 0.658)
SUFF++ for r=0.3 class 1 = 0.724 +- 0.359 (in-sample avg dev_std = 0.658)
SUFF++ for r=0.3 class 2 = 0.621 +- 0.359 (in-sample avg dev_std = 0.658)
SUFF++ for r=0.3 all KL = 0.396 +- 0.359 (in-sample avg dev_std = 0.658)
SUFF++ for r=0.3 all L1 = 0.669 +- 0.241 (in-sample avg dev_std = 0.658)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.624
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.617
SUFF++ for r=0.6 class 0 = 0.757 +- 0.364 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 1 = 0.821 +- 0.364 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 2 = 0.755 +- 0.364 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 all KL = 0.651 +- 0.364 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 all L1 = 0.791 +- 0.238 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.64
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.629
SUFF++ for r=0.9 class 0 = 0.845 +- 0.236 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 1 = 0.885 +- 0.236 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 2 = 0.846 +- 0.236 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all KL = 0.865 +- 0.236 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all L1 = 0.866 +- 0.209 (in-sample avg dev_std = 0.296)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.522
SUFF++ for r=0.3 class 0 = 0.621 +- 0.352 (in-sample avg dev_std = 0.688)
SUFF++ for r=0.3 class 1 = 0.68 +- 0.352 (in-sample avg dev_std = 0.688)
SUFF++ for r=0.3 class 2 = 0.613 +- 0.352 (in-sample avg dev_std = 0.688)
SUFF++ for r=0.3 all KL = 0.373 +- 0.352 (in-sample avg dev_std = 0.688)
SUFF++ for r=0.3 all L1 = 0.648 +- 0.243 (in-sample avg dev_std = 0.688)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.566
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.547
SUFF++ for r=0.6 class 0 = 0.776 +- 0.358 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 class 1 = 0.781 +- 0.358 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 class 2 = 0.739 +- 0.358 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 all KL = 0.629 +- 0.358 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 all L1 = 0.769 +- 0.241 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.558
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.565
SUFF++ for r=0.9 class 0 = 0.858 +- 0.204 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.204 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 class 2 = 0.849 +- 0.204 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 all KL = 0.874 +- 0.204 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 all L1 = 0.862 +- 0.197 (in-sample avg dev_std = 0.274)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.652
NEC for r=0.3 class 0 = 0.234 +- 0.332 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.161 +- 0.332 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.217 +- 0.332 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.246 +- 0.332 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.194 +- 0.254 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.68
NEC for r=0.6 class 0 = 0.175 +- 0.324 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 1 = 0.122 +- 0.324 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 2 = 0.173 +- 0.324 (in-sample avg dev_std = 0.364)
NEC for r=0.6 all KL = 0.205 +- 0.324 (in-sample avg dev_std = 0.364)
NEC for r=0.6 all L1 = 0.149 +- 0.231 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.678
NEC for r=0.9 class 0 = 0.124 +- 0.246 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 1 = 0.11 +- 0.246 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 2 = 0.146 +- 0.246 (in-sample avg dev_std = 0.304)
NEC for r=0.9 all KL = 0.137 +- 0.246 (in-sample avg dev_std = 0.304)
NEC for r=0.9 all L1 = 0.124 +- 0.201 (in-sample avg dev_std = 0.304)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.704
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.686
NEC for r=1.0 class 0 = 0.112 +- 0.218 (in-sample avg dev_std = 0.259)
NEC for r=1.0 class 1 = 0.105 +- 0.218 (in-sample avg dev_std = 0.259)
NEC for r=1.0 class 2 = 0.118 +- 0.218 (in-sample avg dev_std = 0.259)
NEC for r=1.0 all KL = 0.107 +- 0.218 (in-sample avg dev_std = 0.259)
NEC for r=1.0 all L1 = 0.11 +- 0.189 (in-sample avg dev_std = 0.259)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.624
NEC for r=0.3 class 0 = 0.254 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 1 = 0.184 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 2 = 0.233 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all KL = 0.298 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all L1 = 0.212 +- 0.269 (in-sample avg dev_std = 0.413)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.624
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.623
NEC for r=0.6 class 0 = 0.217 +- 0.337 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 1 = 0.152 +- 0.337 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 2 = 0.186 +- 0.337 (in-sample avg dev_std = 0.377)
NEC for r=0.6 all KL = 0.241 +- 0.337 (in-sample avg dev_std = 0.377)
NEC for r=0.6 all L1 = 0.176 +- 0.254 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.64
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.186 +- 0.257 (in-sample avg dev_std = 0.284)
NEC for r=0.9 class 1 = 0.121 +- 0.257 (in-sample avg dev_std = 0.284)
NEC for r=0.9 class 2 = 0.159 +- 0.257 (in-sample avg dev_std = 0.284)
NEC for r=0.9 all KL = 0.157 +- 0.257 (in-sample avg dev_std = 0.284)
NEC for r=0.9 all L1 = 0.146 +- 0.220 (in-sample avg dev_std = 0.284)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.652
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.643
NEC for r=1.0 class 0 = 0.169 +- 0.229 (in-sample avg dev_std = 0.267)
NEC for r=1.0 class 1 = 0.111 +- 0.229 (in-sample avg dev_std = 0.267)
NEC for r=1.0 class 2 = 0.152 +- 0.229 (in-sample avg dev_std = 0.267)
NEC for r=1.0 all KL = 0.13 +- 0.229 (in-sample avg dev_std = 0.267)
NEC for r=1.0 all L1 = 0.134 +- 0.207 (in-sample avg dev_std = 0.267)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.566
NEC for r=0.3 class 0 = 0.244 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 1 = 0.198 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 2 = 0.242 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all KL = 0.302 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all L1 = 0.221 +- 0.270 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.565
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.564
NEC for r=0.6 class 0 = 0.206 +- 0.345 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.177 +- 0.345 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.223 +- 0.345 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.263 +- 0.345 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.196 +- 0.262 (in-sample avg dev_std = 0.399)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.558
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.564
NEC for r=0.9 class 0 = 0.169 +- 0.247 (in-sample avg dev_std = 0.285)
NEC for r=0.9 class 1 = 0.149 +- 0.247 (in-sample avg dev_std = 0.285)
NEC for r=0.9 class 2 = 0.169 +- 0.247 (in-sample avg dev_std = 0.285)
NEC for r=0.9 all KL = 0.159 +- 0.247 (in-sample avg dev_std = 0.285)
NEC for r=0.9 all L1 = 0.159 +- 0.225 (in-sample avg dev_std = 0.285)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.569
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.161 +- 0.198 (in-sample avg dev_std = 0.252)
NEC for r=1.0 class 1 = 0.131 +- 0.198 (in-sample avg dev_std = 0.252)
NEC for r=1.0 class 2 = 0.146 +- 0.198 (in-sample avg dev_std = 0.252)
NEC for r=1.0 all KL = 0.119 +- 0.198 (in-sample avg dev_std = 0.252)
NEC for r=1.0 all L1 = 0.142 +- 0.198 (in-sample avg dev_std = 0.252)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:38:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:13 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:15 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:16 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:17 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:21 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 11:38:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0026
ID Validation ACCURACY: 0.7022
ID Validation Loss: 1.9916
ID Test ACCURACY: 0.6625
ID Test Loss: 2.1428
OOD Validation ACCURACY: 0.6090
OOD Validation Loss: 2.2830
OOD Test ACCURACY: 0.5607
OOD Test Loss: 2.6565

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0020
ID Validation ACCURACY: 0.6661
ID Validation Loss: 2.4967
ID Test ACCURACY: 0.6390
ID Test Loss: 2.5469
OOD Validation ACCURACY: 0.6297
OOD Validation Loss: 2.7461
OOD Test ACCURACY: 0.5635
OOD Test Loss: 3.2086

[0m[1;37mINFO[0m: [1mChartInfo 0.6625 0.5607 0.6390 0.5635 0.6661 0.6297[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.566
SUFF++ for r=0.3 class 0 = 0.641 +- 0.301 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 class 1 = 0.673 +- 0.301 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.301 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 all KL = 0.445 +- 0.301 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 all L1 = 0.63 +- 0.216 (in-sample avg dev_std = 0.628)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.653
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.623
SUFF++ for r=0.6 class 0 = 0.772 +- 0.316 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 class 1 = 0.798 +- 0.316 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 class 2 = 0.68 +- 0.316 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 all KL = 0.633 +- 0.316 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 all L1 = 0.759 +- 0.217 (in-sample avg dev_std = 0.509)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.676
SUFF++ for r=0.9 class 0 = 0.876 +- 0.197 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.889 +- 0.197 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.882 +- 0.197 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.887 +- 0.197 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.884 +- 0.175 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.567
SUFF++ for r=0.3 class 0 = 0.702 +- 0.334 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 class 1 = 0.725 +- 0.334 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 class 2 = 0.633 +- 0.334 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 all KL = 0.526 +- 0.334 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 all L1 = 0.699 +- 0.232 (in-sample avg dev_std = 0.580)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.604
SUFF++ for r=0.6 class 0 = 0.787 +- 0.300 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 1 = 0.844 +- 0.300 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 2 = 0.761 +- 0.300 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all KL = 0.739 +- 0.300 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all L1 = 0.812 +- 0.215 (in-sample avg dev_std = 0.426)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.619
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.609
SUFF++ for r=0.9 class 0 = 0.856 +- 0.192 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 class 1 = 0.888 +- 0.192 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.192 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 all KL = 0.898 +- 0.192 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.9 all L1 = 0.878 +- 0.186 (in-sample avg dev_std = 0.249)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.553
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.51
SUFF++ for r=0.3 class 0 = 0.687 +- 0.325 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 1 = 0.703 +- 0.325 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 2 = 0.661 +- 0.325 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all KL = 0.527 +- 0.325 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all L1 = 0.688 +- 0.231 (in-sample avg dev_std = 0.584)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.552
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.526
SUFF++ for r=0.6 class 0 = 0.781 +- 0.284 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 1 = 0.812 +- 0.284 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 2 = 0.742 +- 0.284 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all KL = 0.724 +- 0.284 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all L1 = 0.787 +- 0.220 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.534
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.529
SUFF++ for r=0.9 class 0 = 0.864 +- 0.185 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.877 +- 0.185 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.848 +- 0.185 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.893 +- 0.185 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.866 +- 0.180 (in-sample avg dev_std = 0.256)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.621
NEC for r=0.3 class 0 = 0.241 +- 0.303 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 1 = 0.207 +- 0.303 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 2 = 0.286 +- 0.303 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all KL = 0.255 +- 0.303 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all L1 = 0.237 +- 0.252 (in-sample avg dev_std = 0.354)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.653
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.648
NEC for r=0.6 class 0 = 0.164 +- 0.267 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 1 = 0.138 +- 0.267 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 2 = 0.194 +- 0.267 (in-sample avg dev_std = 0.318)
NEC for r=0.6 all KL = 0.174 +- 0.267 (in-sample avg dev_std = 0.318)
NEC for r=0.6 all L1 = 0.16 +- 0.219 (in-sample avg dev_std = 0.318)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.667
NEC for r=0.9 class 0 = 0.126 +- 0.212 (in-sample avg dev_std = 0.248)
NEC for r=0.9 class 1 = 0.112 +- 0.212 (in-sample avg dev_std = 0.248)
NEC for r=0.9 class 2 = 0.134 +- 0.212 (in-sample avg dev_std = 0.248)
NEC for r=0.9 all KL = 0.115 +- 0.212 (in-sample avg dev_std = 0.248)
NEC for r=0.9 all L1 = 0.121 +- 0.192 (in-sample avg dev_std = 0.248)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.699
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.68
NEC for r=1.0 class 0 = 0.106 +- 0.184 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1 = 0.108 +- 0.184 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 2 = 0.109 +- 0.184 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.09 +- 0.184 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.108 +- 0.175 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.608
NEC for r=0.3 class 0 = 0.218 +- 0.323 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 1 = 0.197 +- 0.323 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 2 = 0.253 +- 0.323 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all KL = 0.272 +- 0.323 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all L1 = 0.214 +- 0.247 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.614
NEC for r=0.6 class 0 = 0.187 +- 0.293 (in-sample avg dev_std = 0.336)
NEC for r=0.6 class 1 = 0.14 +- 0.293 (in-sample avg dev_std = 0.336)
NEC for r=0.6 class 2 = 0.215 +- 0.293 (in-sample avg dev_std = 0.336)
NEC for r=0.6 all KL = 0.2 +- 0.293 (in-sample avg dev_std = 0.336)
NEC for r=0.6 all L1 = 0.168 +- 0.232 (in-sample avg dev_std = 0.336)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.619
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0 = 0.179 +- 0.230 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 1 = 0.13 +- 0.230 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 2 = 0.17 +- 0.230 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all KL = 0.142 +- 0.230 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all L1 = 0.151 +- 0.212 (in-sample avg dev_std = 0.278)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.626
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.612
NEC for r=1.0 class 0 = 0.172 +- 0.193 (in-sample avg dev_std = 0.241)
NEC for r=1.0 class 1 = 0.121 +- 0.193 (in-sample avg dev_std = 0.241)
NEC for r=1.0 class 2 = 0.157 +- 0.193 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all KL = 0.114 +- 0.193 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all L1 = 0.142 +- 0.196 (in-sample avg dev_std = 0.241)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.553
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.54
NEC for r=0.3 class 0 = 0.261 +- 0.327 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.223 +- 0.327 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.247 +- 0.327 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.296 +- 0.327 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.239 +- 0.259 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.532
NEC for r=0.6 class 0 = 0.207 +- 0.288 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 1 = 0.172 +- 0.288 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 2 = 0.212 +- 0.288 (in-sample avg dev_std = 0.335)
NEC for r=0.6 all KL = 0.212 +- 0.288 (in-sample avg dev_std = 0.335)
NEC for r=0.6 all L1 = 0.191 +- 0.240 (in-sample avg dev_std = 0.335)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.534
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.53
NEC for r=0.9 class 0 = 0.18 +- 0.226 (in-sample avg dev_std = 0.273)
NEC for r=0.9 class 1 = 0.15 +- 0.226 (in-sample avg dev_std = 0.273)
NEC for r=0.9 class 2 = 0.176 +- 0.226 (in-sample avg dev_std = 0.273)
NEC for r=0.9 all KL = 0.149 +- 0.226 (in-sample avg dev_std = 0.273)
NEC for r=0.9 all L1 = 0.164 +- 0.213 (in-sample avg dev_std = 0.273)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.533
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.535
NEC for r=1.0 class 0 = 0.165 +- 0.189 (in-sample avg dev_std = 0.241)
NEC for r=1.0 class 1 = 0.135 +- 0.189 (in-sample avg dev_std = 0.241)
NEC for r=1.0 class 2 = 0.159 +- 0.189 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all KL = 0.117 +- 0.189 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all L1 = 0.149 +- 0.192 (in-sample avg dev_std = 0.241)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:43:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:35 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:38 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 11:43:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.9121
ID Test ACCURACY: 0.6606
ID Test Loss: 2.3481
OOD Validation ACCURACY: 0.6006
OOD Validation Loss: 2.6995
OOD Test ACCURACY: 0.5271
OOD Test Loss: 4.1606

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 61...
[0m[1;37mINFO[0m: [1mCheckpoint 61: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0011
ID Validation ACCURACY: 0.6823
ID Validation Loss: 2.0777
ID Test ACCURACY: 0.6570
ID Test Loss: 2.3521
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 2.3260
OOD Test ACCURACY: 0.5546
OOD Test Loss: 3.2175

[0m[1;37mINFO[0m: [1mChartInfo 0.6606 0.5271 0.6570 0.5546 0.6823 0.6342[0mGOODTwitter(554)
Data example from id_val: Data(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
Label distribution from id_val: (tensor([0, 1, 2]), tensor([138, 264, 152]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1785)
Data example from val: Data(x=[23, 768], edge_index=[2, 44], y=[1], idx=[1], sentence_tokens=[23], length=[1], domain_id=[1], ori_edge_index=[2, 44], node_perm=[23])
Label distribution from val: (tensor([0, 1, 2]), tensor([453, 956, 376]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.639
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.562
SUFF++ for r=0.3 class 0 = 0.659 +- 0.301 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.3 class 1 = 0.637 +- 0.301 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.3 class 2 = 0.552 +- 0.301 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.3 all KL = 0.383 +- 0.301 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.3 all L1 = 0.619 +- 0.213 (in-sample avg dev_std = 0.671)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.664
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.633
SUFF++ for r=0.6 class 0 = 0.806 +- 0.338 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 1 = 0.784 +- 0.338 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 2 = 0.702 +- 0.338 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 all KL = 0.637 +- 0.338 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 all L1 = 0.766 +- 0.235 (in-sample avg dev_std = 0.500)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.678
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.674
SUFF++ for r=0.9 class 0 = 0.892 +- 0.176 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 1 = 0.887 +- 0.176 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 2 = 0.863 +- 0.176 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all KL = 0.894 +- 0.176 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all L1 = 0.881 +- 0.171 (in-sample avg dev_std = 0.264)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.585
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.53
SUFF++ for r=0.3 class 0 = 0.692 +- 0.311 (in-sample avg dev_std = 0.652)
SUFF++ for r=0.3 class 1 = 0.636 +- 0.311 (in-sample avg dev_std = 0.652)
SUFF++ for r=0.3 class 2 = 0.592 +- 0.311 (in-sample avg dev_std = 0.652)
SUFF++ for r=0.3 all KL = 0.412 +- 0.311 (in-sample avg dev_std = 0.652)
SUFF++ for r=0.3 all L1 = 0.641 +- 0.221 (in-sample avg dev_std = 0.652)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.572
SUFF++ for r=0.6 class 0 = 0.831 +- 0.307 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.782 +- 0.307 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.756 +- 0.307 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.707 +- 0.307 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.789 +- 0.228 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.589
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.585
SUFF++ for r=0.9 class 0 = 0.901 +- 0.219 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 1 = 0.835 +- 0.219 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 2 = 0.852 +- 0.219 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all KL = 0.871 +- 0.219 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all L1 = 0.855 +- 0.201 (in-sample avg dev_std = 0.283)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.517
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.465
SUFF++ for r=0.3 class 0 = 0.736 +- 0.323 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 class 1 = 0.647 +- 0.323 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 class 2 = 0.581 +- 0.323 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 all KL = 0.439 +- 0.323 (in-sample avg dev_std = 0.636)
SUFF++ for r=0.3 all L1 = 0.654 +- 0.228 (in-sample avg dev_std = 0.636)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.515
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.488
SUFF++ for r=0.6 class 0 = 0.856 +- 0.303 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.794 +- 0.303 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.303 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.724 +- 0.303 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.8 +- 0.224 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.519
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.505
SUFF++ for r=0.9 class 0 = 0.898 +- 0.183 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 1 = 0.886 +- 0.183 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 2 = 0.833 +- 0.183 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 all KL = 0.899 +- 0.183 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 all L1 = 0.876 +- 0.180 (in-sample avg dev_std = 0.242)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.639
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 548
Effective ratio: 0.316 +- 0.016
Model Accuracy over intervened graphs for r=0.3 =  0.652
NEC for r=0.3 class 0 = 0.184 +- 0.293 (in-sample avg dev_std = 0.328)
NEC for r=0.3 class 1 = 0.191 +- 0.293 (in-sample avg dev_std = 0.328)
NEC for r=0.3 class 2 = 0.25 +- 0.293 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all KL = 0.229 +- 0.293 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all L1 = 0.205 +- 0.242 (in-sample avg dev_std = 0.328)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.664
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 548
Effective ratio: 0.617 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.666
NEC for r=0.6 class 0 = 0.127 +- 0.278 (in-sample avg dev_std = 0.338)
NEC for r=0.6 class 1 = 0.136 +- 0.278 (in-sample avg dev_std = 0.338)
NEC for r=0.6 class 2 = 0.211 +- 0.278 (in-sample avg dev_std = 0.338)
NEC for r=0.6 all KL = 0.184 +- 0.278 (in-sample avg dev_std = 0.338)
NEC for r=0.6 all L1 = 0.155 +- 0.224 (in-sample avg dev_std = 0.338)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.679
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 548
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.122 +- 0.220 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 1 = 0.13 +- 0.220 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 2 = 0.16 +- 0.220 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all KL = 0.126 +- 0.220 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all L1 = 0.136 +- 0.198 (in-sample avg dev_std = 0.274)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.704
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 548
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.681
NEC for r=1.0 class 0 = 0.12 +- 0.202 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 1 = 0.115 +- 0.202 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 2 = 0.146 +- 0.202 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all KL = 0.107 +- 0.202 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all L1 = 0.125 +- 0.187 (in-sample avg dev_std = 0.242)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.585
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.312 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.57
NEC for r=0.3 class 0 = 0.174 +- 0.306 (in-sample avg dev_std = 0.380)
NEC for r=0.3 class 1 = 0.225 +- 0.306 (in-sample avg dev_std = 0.380)
NEC for r=0.3 class 2 = 0.248 +- 0.306 (in-sample avg dev_std = 0.380)
NEC for r=0.3 all KL = 0.254 +- 0.306 (in-sample avg dev_std = 0.380)
NEC for r=0.3 all L1 = 0.217 +- 0.250 (in-sample avg dev_std = 0.380)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.612 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.585
NEC for r=0.6 class 0 = 0.148 +- 0.298 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 1 = 0.195 +- 0.298 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 2 = 0.193 +- 0.298 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all KL = 0.221 +- 0.298 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all L1 = 0.183 +- 0.236 (in-sample avg dev_std = 0.353)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.589
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.909 +- 0.006
Model Accuracy over intervened graphs for r=0.9 =  0.591
NEC for r=0.9 class 0 = 0.124 +- 0.245 (in-sample avg dev_std = 0.285)
NEC for r=0.9 class 1 = 0.183 +- 0.245 (in-sample avg dev_std = 0.285)
NEC for r=0.9 class 2 = 0.191 +- 0.245 (in-sample avg dev_std = 0.285)
NEC for r=0.9 all KL = 0.164 +- 0.245 (in-sample avg dev_std = 0.285)
NEC for r=0.9 all L1 = 0.17 +- 0.222 (in-sample avg dev_std = 0.285)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.595
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.586
NEC for r=1.0 class 0 = 0.122 +- 0.207 (in-sample avg dev_std = 0.256)
NEC for r=1.0 class 1 = 0.165 +- 0.207 (in-sample avg dev_std = 0.256)
NEC for r=1.0 class 2 = 0.171 +- 0.207 (in-sample avg dev_std = 0.256)
NEC for r=1.0 all KL = 0.13 +- 0.207 (in-sample avg dev_std = 0.256)
NEC for r=1.0 all L1 = 0.155 +- 0.203 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.517
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.512
NEC for r=0.3 class 0 = 0.169 +- 0.308 (in-sample avg dev_std = 0.368)
NEC for r=0.3 class 1 = 0.209 +- 0.308 (in-sample avg dev_std = 0.368)
NEC for r=0.3 class 2 = 0.256 +- 0.308 (in-sample avg dev_std = 0.368)
NEC for r=0.3 all KL = 0.247 +- 0.308 (in-sample avg dev_std = 0.368)
NEC for r=0.3 all L1 = 0.21 +- 0.249 (in-sample avg dev_std = 0.368)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.515
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.502
NEC for r=0.6 class 0 = 0.13 +- 0.286 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 1 = 0.169 +- 0.286 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 2 = 0.21 +- 0.286 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.2 +- 0.286 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.169 +- 0.226 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.519
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.138 +- 0.222 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 1 = 0.147 +- 0.222 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 2 = 0.185 +- 0.222 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all KL = 0.141 +- 0.222 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all L1 = 0.154 +- 0.211 (in-sample avg dev_std = 0.274)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.527
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.509
NEC for r=1.0 class 0 = 0.134 +- 0.203 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 1 = 0.14 +- 0.203 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 2 = 0.171 +- 0.203 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all KL = 0.121 +- 0.203 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all L1 = 0.146 +- 0.203 (in-sample avg dev_std = 0.246)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.326, 0.54, 0.858, 1.0], 'all_L1': [0.618, 0.751, 0.878, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.633, 0.887, 1.0], 'all_L1': [0.63, 0.759, 0.884, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.637, 0.894, 1.0], 'all_L1': [0.619, 0.766, 0.881, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.246, 0.205, 0.137, 0.107], 'all_L1': [0.194, 0.149, 0.124, 0.11]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.174, 0.115, 0.09], 'all_L1': [0.237, 0.16, 0.121, 0.108]}), defaultdict(<class 'list'>, {'all_KL': [0.229, 0.184, 0.126, 0.107], 'all_L1': [0.205, 0.155, 0.136, 0.125]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.396, 0.651, 0.865, 1.0], 'all_L1': [0.669, 0.791, 0.866, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.739, 0.898, 1.0], 'all_L1': [0.699, 0.812, 0.878, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.412, 0.707, 0.871, 1.0], 'all_L1': [0.641, 0.789, 0.855, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.298, 0.241, 0.157, 0.13], 'all_L1': [0.212, 0.176, 0.146, 0.134]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.2, 0.142, 0.114], 'all_L1': [0.214, 0.168, 0.151, 0.142]}), defaultdict(<class 'list'>, {'all_KL': [0.254, 0.221, 0.164, 0.13], 'all_L1': [0.217, 0.183, 0.17, 0.155]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.373, 0.629, 0.874, 1.0], 'all_L1': [0.648, 0.769, 0.862, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.527, 0.724, 0.893, 1.0], 'all_L1': [0.688, 0.787, 0.866, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.724, 0.899, 1.0], 'all_L1': [0.654, 0.8, 0.876, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.302, 0.263, 0.159, 0.119], 'all_L1': [0.221, 0.196, 0.159, 0.142]}), defaultdict(<class 'list'>, {'all_KL': [0.296, 0.212, 0.149, 0.117], 'all_L1': [0.239, 0.191, 0.164, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.2, 0.141, 0.121], 'all_L1': [0.21, 0.169, 0.154, 0.146]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.622 +- 0.005, 0.759 +- 0.006, 0.881 +- 0.002, 1.000 +- 0.000
suff++ class all_KL  =  0.385 +- 0.049, 0.603 +- 0.045, 0.880 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.566 +- 0.003, 0.632 +- 0.007, 0.677 +- 0.003
nec class all_L1  =  0.212 +- 0.018, 0.155 +- 0.004, 0.127 +- 0.006, 0.114 +- 0.008
nec class all_KL  =  0.243 +- 0.011, 0.188 +- 0.013, 0.126 +- 0.009, 0.101 +- 0.008
nec_acc_int  =  0.642 +- 0.014, 0.665 +- 0.013, 0.676 +- 0.006, 0.682 +- 0.003

Eval split val
suff++ class all_L1  =  0.670 +- 0.024, 0.797 +- 0.010, 0.866 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.445 +- 0.058, 0.699 +- 0.036, 0.878 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.561 +- 0.024, 0.598 +- 0.019, 0.608 +- 0.018
nec class all_L1  =  0.214 +- 0.002, 0.176 +- 0.006, 0.156 +- 0.010, 0.144 +- 0.009
nec class all_KL  =  0.275 +- 0.018, 0.221 +- 0.017, 0.154 +- 0.009, 0.125 +- 0.008
nec_acc_int  =  0.601 +- 0.023, 0.607 +- 0.016, 0.615 +- 0.020, 0.614 +- 0.023

Eval split test
suff++ class all_L1  =  0.663 +- 0.018, 0.785 +- 0.013, 0.868 +- 0.006, 1.000 +- 0.000
suff++ class all_KL  =  0.446 +- 0.063, 0.692 +- 0.045, 0.889 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.499 +- 0.025, 0.521 +- 0.024, 0.533 +- 0.025
nec class all_L1  =  0.223 +- 0.012, 0.185 +- 0.012, 0.159 +- 0.004, 0.146 +- 0.003
nec class all_KL  =  0.282 +- 0.025, 0.225 +- 0.027, 0.150 +- 0.007, 0.119 +- 0.002
nec_acc_int  =  0.539 +- 0.022, 0.533 +- 0.025, 0.534 +- 0.023, 0.537 +- 0.024


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.417 +- 0.012, 0.457 +- 0.005, 0.504 +- 0.003, 0.557 +- 0.004
Faith. Armon (L1)= 		  =  0.316 +- 0.021, 0.257 +- 0.006, 0.222 +- 0.010, 0.205 +- 0.012
Faith. GMean (L1)= 	  =  0.363 +- 0.017, 0.343 +- 0.006, 0.334 +- 0.008, 0.338 +- 0.011
Faith. Aritm (KL)= 		  =  0.314 +- 0.027, 0.396 +- 0.017, 0.503 +- 0.005, 0.551 +- 0.004
Faith. Armon (KL)= 		  =  0.297 +- 0.019, 0.285 +- 0.010, 0.220 +- 0.013, 0.184 +- 0.013
Faith. GMean (KL)= 	  =  0.305 +- 0.023, 0.336 +- 0.005, 0.333 +- 0.010, 0.318 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.442 +- 0.011, 0.487 +- 0.003, 0.511 +- 0.004, 0.572 +- 0.004
Faith. Armon (L1)= 		  =  0.325 +- 0.002, 0.288 +- 0.008, 0.264 +- 0.014, 0.251 +- 0.013
Faith. GMean (L1)= 	  =  0.379 +- 0.006, 0.374 +- 0.004, 0.367 +- 0.011, 0.379 +- 0.011
Faith. Aritm (KL)= 		  =  0.360 +- 0.028, 0.460 +- 0.010, 0.516 +- 0.004, 0.562 +- 0.004
Faith. Armon (KL)= 		  =  0.338 +- 0.018, 0.334 +- 0.015, 0.262 +- 0.013, 0.222 +- 0.012
Faith. GMean (KL)= 	  =  0.348 +- 0.023, 0.392 +- 0.005, 0.368 +- 0.009, 0.353 +- 0.011

Eval split test
Faith. Aritm (L1)= 		  =  0.443 +- 0.014, 0.485 +- 0.003, 0.514 +- 0.002, 0.573 +- 0.001
Faith. Armon (L1)= 		  =  0.334 +- 0.015, 0.300 +- 0.015, 0.269 +- 0.006, 0.254 +- 0.004
Faith. GMean (L1)= 	  =  0.385 +- 0.015, 0.381 +- 0.010, 0.371 +- 0.004, 0.382 +- 0.004
Faith. Aritm (KL)= 		  =  0.364 +- 0.034, 0.459 +- 0.009, 0.519 +- 0.002, 0.560 +- 0.001
Faith. Armon (KL)= 		  =  0.343 +- 0.027, 0.337 +- 0.024, 0.256 +- 0.010, 0.213 +- 0.003
Faith. GMean (KL)= 	  =  0.353 +- 0.030, 0.393 +- 0.011, 0.365 +- 0.007, 0.345 +- 0.002
Computed for split load_split = id



Completed in  0:16:34.212676  for GSATvGIN GOODTwitter/length



DONE GSAT GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:49:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:41 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:49:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.9271
Train Loss: 0.3266
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3011
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3266
OOD Validation ACCURACY: 0.8727
OOD Validation Loss: 0.5282
OOD Test ACCURACY: 0.4900
OOD Test Loss: 2.9279

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3374
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3128
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3355
OOD Validation ACCURACY: 0.9080
OOD Validation Loss: 0.4881
OOD Test ACCURACY: 0.5520
OOD Test Loss: 1.7201

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.4900 0.9257 0.5520 0.9317 0.9080[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.736
WIoU for r=0.3 = 0.622
F1 for r=0.6 = 0.636
WIoU for r=0.6 = 0.514
F1 for r=0.9 = 0.511
WIoU for r=0.9 = 0.387
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.372
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.569
WIoU for r=0.3 = 0.438
F1 for r=0.6 = 0.359
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.155
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.318
WIoU for r=0.3 = 0.205
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.076
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.069


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.736055
Model XAI WIoU of binarized graphs for r=0.3 =  0.62213
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.444
SUFF++ for r=0.3 class 0 = 0.471 +- 0.273 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 1 = 0.528 +- 0.273 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 2 = 0.531 +- 0.273 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all KL = 0.521 +- 0.273 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all L1 = 0.51 +- 0.166 (in-sample avg dev_std = 0.511)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  0.6359775000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.514435
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.695
SUFF++ for r=0.6 class 0 = 0.545 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 1 = 0.603 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 2 = 0.705 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all KL = 0.658 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all L1 = 0.618 +- 0.203 (in-sample avg dev_std = 0.426)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.51087625
Model XAI WIoU of binarized graphs for r=0.9 =  0.38717625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.74 +- 0.165 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 1 = 0.839 +- 0.165 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.165 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all KL = 0.881 +- 0.165 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all L1 = 0.815 +- 0.171 (in-sample avg dev_std = 0.236)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.68
Model XAI F1 of binarized graphs for r=0.3 =  0.56905
Model XAI WIoU of binarized graphs for r=0.3 =  0.43845375000000003
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.658
SUFF++ for r=0.3 class 0 = 0.524 +- 0.243 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 1 = 0.544 +- 0.243 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 2 = 0.653 +- 0.243 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all KL = 0.629 +- 0.243 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all L1 = 0.573 +- 0.178 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.35864000000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.24326250000000002
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.678
SUFF++ for r=0.6 class 0 = 0.549 +- 0.249 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.589 +- 0.249 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.644 +- 0.249 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.635 +- 0.249 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.593 +- 0.158 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.25925125
Model XAI WIoU of binarized graphs for r=0.9 =  0.16912
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.814
SUFF++ for r=0.9 class 0 = 0.727 +- 0.115 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 1 = 0.778 +- 0.115 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 2 = 0.771 +- 0.115 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all KL = 0.887 +- 0.115 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.146 (in-sample avg dev_std = 0.217)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.57
Model XAI F1 of binarized graphs for r=0.3 =  0.31756
Model XAI WIoU of binarized graphs for r=0.3 =  0.20501000000000003
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0 = 0.578 +- 0.240 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 class 1 = 0.603 +- 0.240 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 class 2 = 0.642 +- 0.240 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 all KL = 0.701 +- 0.240 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 all L1 = 0.607 +- 0.123 (in-sample avg dev_std = 0.410)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.642
Model XAI F1 of binarized graphs for r=0.6 =  0.1795225
Model XAI WIoU of binarized graphs for r=0.6 =  0.1099225
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.549
SUFF++ for r=0.6 class 0 = 0.543 +- 0.238 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.582 +- 0.238 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.598 +- 0.238 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.646 +- 0.238 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.574 +- 0.117 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.636
Model XAI F1 of binarized graphs for r=0.9 =  0.12439250000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07565625000000001
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.562
SUFF++ for r=0.9 class 0 = 0.775 +- 0.108 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 class 1 = 0.759 +- 0.108 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 class 2 = 0.781 +- 0.108 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 all KL = 0.889 +- 0.108 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 all L1 = 0.772 +- 0.130 (in-sample avg dev_std = 0.192)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  0.736055
Model XAI WIoU of binarized graphs for r=0.3 =  0.62213
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.336
NEC for r=0.3 class 0 = 0.599 +- 0.301 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 1 = 0.538 +- 0.301 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 2 = 0.606 +- 0.301 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all KL = 0.563 +- 0.301 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all L1 = 0.582 +- 0.173 (in-sample avg dev_std = 0.394)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.733
Model XAI F1 of binarized graphs for r=0.6 =  0.6359775000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.514435
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.389
NEC for r=0.6 class 0 = 0.575 +- 0.276 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.537 +- 0.276 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.65 +- 0.276 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.598 +- 0.276 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.588 +- 0.172 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.51087625
Model XAI WIoU of binarized graphs for r=0.9 =  0.38717625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.492
NEC for r=0.9 class 0 = 0.569 +- 0.238 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.511 +- 0.238 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.588 +- 0.238 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.575 +- 0.238 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.556 +- 0.156 (in-sample avg dev_std = 0.571)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.37217625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.524
NEC for r=1.0 class 0 = 0.558 +- 0.245 (in-sample avg dev_std = 0.627)
NEC for r=1.0 class 1 = 0.497 +- 0.245 (in-sample avg dev_std = 0.627)
NEC for r=1.0 class 2 = 0.588 +- 0.245 (in-sample avg dev_std = 0.627)
NEC for r=1.0 all KL = 0.614 +- 0.245 (in-sample avg dev_std = 0.627)
NEC for r=1.0 all L1 = 0.549 +- 0.169 (in-sample avg dev_std = 0.627)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  0.56905
Model XAI WIoU of binarized graphs for r=0.3 =  0.43845375000000003
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.557 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 1 = 0.513 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 2 = 0.518 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all KL = 0.475 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all L1 = 0.529 +- 0.187 (in-sample avg dev_std = 0.306)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.35864000000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.24326250000000002
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.517 +- 0.242 (in-sample avg dev_std = 0.400)
NEC for r=0.6 class 1 = 0.444 +- 0.242 (in-sample avg dev_std = 0.400)
NEC for r=0.6 class 2 = 0.533 +- 0.242 (in-sample avg dev_std = 0.400)
NEC for r=0.6 all KL = 0.456 +- 0.242 (in-sample avg dev_std = 0.400)
NEC for r=0.6 all L1 = 0.498 +- 0.175 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.901
Model XAI F1 of binarized graphs for r=0.9 =  0.25925125
Model XAI WIoU of binarized graphs for r=0.9 =  0.16912
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.519
NEC for r=0.9 class 0 = 0.512 +- 0.192 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 1 = 0.412 +- 0.192 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 2 = 0.502 +- 0.192 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all KL = 0.348 +- 0.192 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all L1 = 0.475 +- 0.134 (in-sample avg dev_std = 0.397)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.154555
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.545
NEC for r=1.0 class 0 = 0.484 +- 0.187 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 1 = 0.439 +- 0.187 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 2 = 0.506 +- 0.187 (in-sample avg dev_std = 0.414)
NEC for r=1.0 all KL = 0.368 +- 0.187 (in-sample avg dev_std = 0.414)
NEC for r=1.0 all L1 = 0.476 +- 0.123 (in-sample avg dev_std = 0.414)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  0.31756
Model XAI WIoU of binarized graphs for r=0.3 =  0.20501000000000003
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.466 +- 0.245 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 1 = 0.462 +- 0.245 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 2 = 0.433 +- 0.245 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all KL = 0.327 +- 0.245 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all L1 = 0.454 +- 0.218 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  0.1795225
Model XAI WIoU of binarized graphs for r=0.6 =  0.1099225
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.413 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1 = 0.31 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 2 = 0.418 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.244 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.379 +- 0.158 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  0.12439250000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07565625000000001
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.417
NEC for r=0.9 class 0 = 0.323 +- 0.134 (in-sample avg dev_std = 0.230)
NEC for r=0.9 class 1 = 0.276 +- 0.134 (in-sample avg dev_std = 0.230)
NEC for r=0.9 class 2 = 0.352 +- 0.134 (in-sample avg dev_std = 0.230)
NEC for r=0.9 all KL = 0.162 +- 0.134 (in-sample avg dev_std = 0.230)
NEC for r=0.9 all L1 = 0.316 +- 0.177 (in-sample avg dev_std = 0.230)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.502
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06884625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.398
NEC for r=1.0 class 0 = 0.263 +- 0.178 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 1 = 0.315 +- 0.178 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 2 = 0.27 +- 0.178 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all KL = 0.152 +- 0.178 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all L1 = 0.283 +- 0.188 (in-sample avg dev_std = 0.175)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 11:57:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:34 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:39 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:43 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 11:57:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3318
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3073
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3342
OOD Validation ACCURACY: 0.8717
OOD Validation Loss: 0.5372
OOD Test ACCURACY: 0.4823
OOD Test Loss: 1.7079

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9254
Train Loss: 0.3369
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3113
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3369
OOD Validation ACCURACY: 0.9010
OOD Validation Loss: 0.4831
OOD Test ACCURACY: 0.4413
OOD Test Loss: 1.7290

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4823 0.9290 0.4413 0.9323 0.9010[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.726
WIoU for r=0.3 = 0.608
F1 for r=0.6 = 0.645
WIoU for r=0.6 = 0.523
F1 for r=0.9 = 0.517
WIoU for r=0.9 = 0.394
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.374
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.569
WIoU for r=0.3 = 0.438
F1 for r=0.6 = 0.360
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.155
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.320
WIoU for r=0.3 = 0.206
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  0.7264099999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.607515
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.455
SUFF++ for r=0.3 class 0 = 0.504 +- 0.260 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.3 class 1 = 0.574 +- 0.260 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.3 class 2 = 0.556 +- 0.260 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.3 all KL = 0.573 +- 0.260 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.3 all L1 = 0.544 +- 0.155 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.6450824999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.5232725
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.705
SUFF++ for r=0.6 class 0 = 0.559 +- 0.245 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1 = 0.636 +- 0.245 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 2 = 0.754 +- 0.245 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.685 +- 0.245 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.65 +- 0.198 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.516945
Model XAI WIoU of binarized graphs for r=0.9 =  0.39419875000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.878
SUFF++ for r=0.9 class 0 = 0.775 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 1 = 0.85 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 2 = 0.87 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all KL = 0.892 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.161 (in-sample avg dev_std = 0.223)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.81
Model XAI F1 of binarized graphs for r=0.3 =  0.5694625
Model XAI WIoU of binarized graphs for r=0.3 =  0.437645
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.705
SUFF++ for r=0.3 class 0 = 0.572 +- 0.223 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 1 = 0.613 +- 0.223 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 2 = 0.659 +- 0.223 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all KL = 0.677 +- 0.223 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all L1 = 0.614 +- 0.166 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.837
Model XAI F1 of binarized graphs for r=0.6 =  0.35963625
Model XAI WIoU of binarized graphs for r=0.6 =  0.244235
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.751
SUFF++ for r=0.6 class 0 = 0.629 +- 0.168 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 1 = 0.684 +- 0.168 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 2 = 0.708 +- 0.168 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all KL = 0.792 +- 0.168 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all L1 = 0.673 +- 0.144 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.259135
Model XAI WIoU of binarized graphs for r=0.9 =  0.16907125
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF++ for r=0.9 class 0 = 0.803 +- 0.085 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 1 = 0.821 +- 0.085 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 2 = 0.793 +- 0.085 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all KL = 0.927 +- 0.085 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all L1 = 0.806 +- 0.129 (in-sample avg dev_std = 0.183)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.654
Model XAI F1 of binarized graphs for r=0.3 =  0.32047
Model XAI WIoU of binarized graphs for r=0.3 =  0.20576375
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.597 +- 0.202 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 1 = 0.61 +- 0.202 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 2 = 0.641 +- 0.202 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all KL = 0.739 +- 0.202 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all L1 = 0.616 +- 0.125 (in-sample avg dev_std = 0.383)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.658
Model XAI F1 of binarized graphs for r=0.6 =  0.17980624999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.10942
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.586
SUFF++ for r=0.6 class 0 = 0.586 +- 0.226 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 class 1 = 0.639 +- 0.226 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 class 2 = 0.607 +- 0.226 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 all KL = 0.721 +- 0.226 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.6 all L1 = 0.611 +- 0.118 (in-sample avg dev_std = 0.415)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.61
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07513875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.622
SUFF++ for r=0.9 class 0 = 0.74 +- 0.191 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 class 1 = 0.726 +- 0.191 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 class 2 = 0.73 +- 0.191 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 all KL = 0.85 +- 0.191 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 all L1 = 0.732 +- 0.159 (in-sample avg dev_std = 0.179)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.551
Model XAI F1 of binarized graphs for r=0.3 =  0.7264099999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.607515
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.586 +- 0.319 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 1 = 0.483 +- 0.319 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 2 = 0.58 +- 0.319 (in-sample avg dev_std = 0.351)
NEC for r=0.3 all KL = 0.52 +- 0.319 (in-sample avg dev_std = 0.351)
NEC for r=0.3 all L1 = 0.551 +- 0.193 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  0.6450824999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.5232725
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.586 +- 0.269 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 1 = 0.523 +- 0.269 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 2 = 0.651 +- 0.269 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all KL = 0.611 +- 0.269 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all L1 = 0.588 +- 0.162 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.516945
Model XAI WIoU of binarized graphs for r=0.9 =  0.39419875000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.491
NEC for r=0.9 class 0 = 0.566 +- 0.249 (in-sample avg dev_std = 0.549)
NEC for r=0.9 class 1 = 0.49 +- 0.249 (in-sample avg dev_std = 0.549)
NEC for r=0.9 class 2 = 0.593 +- 0.249 (in-sample avg dev_std = 0.549)
NEC for r=0.9 all KL = 0.566 +- 0.249 (in-sample avg dev_std = 0.549)
NEC for r=0.9 all L1 = 0.551 +- 0.165 (in-sample avg dev_std = 0.549)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.3735625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.52
NEC for r=1.0 class 0 = 0.557 +- 0.263 (in-sample avg dev_std = 0.591)
NEC for r=1.0 class 1 = 0.471 +- 0.263 (in-sample avg dev_std = 0.591)
NEC for r=1.0 class 2 = 0.599 +- 0.263 (in-sample avg dev_std = 0.591)
NEC for r=1.0 all KL = 0.583 +- 0.263 (in-sample avg dev_std = 0.591)
NEC for r=1.0 all L1 = 0.543 +- 0.178 (in-sample avg dev_std = 0.591)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.812
Model XAI F1 of binarized graphs for r=0.3 =  0.5694625
Model XAI WIoU of binarized graphs for r=0.3 =  0.437645
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.606 +- 0.260 (in-sample avg dev_std = 0.323)
NEC for r=0.3 class 1 = 0.525 +- 0.260 (in-sample avg dev_std = 0.323)
NEC for r=0.3 class 2 = 0.598 +- 0.260 (in-sample avg dev_std = 0.323)
NEC for r=0.3 all KL = 0.542 +- 0.260 (in-sample avg dev_std = 0.323)
NEC for r=0.3 all L1 = 0.576 +- 0.166 (in-sample avg dev_std = 0.323)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  0.35963625
Model XAI WIoU of binarized graphs for r=0.6 =  0.244235
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.43
NEC for r=0.6 class 0 = 0.524 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 1 = 0.438 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 2 = 0.561 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all KL = 0.399 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all L1 = 0.507 +- 0.162 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.259135
Model XAI WIoU of binarized graphs for r=0.9 =  0.16907125
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.484 +- 0.173 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 1 = 0.394 +- 0.173 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 2 = 0.515 +- 0.173 (in-sample avg dev_std = 0.373)
NEC for r=0.9 all KL = 0.315 +- 0.173 (in-sample avg dev_std = 0.373)
NEC for r=0.9 all L1 = 0.463 +- 0.132 (in-sample avg dev_std = 0.373)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.15455625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.433 +- 0.168 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 1 = 0.398 +- 0.168 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 2 = 0.494 +- 0.168 (in-sample avg dev_std = 0.355)
NEC for r=1.0 all KL = 0.292 +- 0.168 (in-sample avg dev_std = 0.355)
NEC for r=1.0 all L1 = 0.441 +- 0.120 (in-sample avg dev_std = 0.355)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.32047
Model XAI WIoU of binarized graphs for r=0.3 =  0.20576375
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.359
NEC for r=0.3 class 0 = 0.44 +- 0.211 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 1 = 0.451 +- 0.211 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 2 = 0.424 +- 0.211 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all KL = 0.296 +- 0.211 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all L1 = 0.439 +- 0.186 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.17980624999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.10942
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.357 +- 0.126 (in-sample avg dev_std = 0.231)
NEC for r=0.6 class 1 = 0.35 +- 0.126 (in-sample avg dev_std = 0.231)
NEC for r=0.6 class 2 = 0.396 +- 0.126 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all KL = 0.207 +- 0.126 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all L1 = 0.367 +- 0.128 (in-sample avg dev_std = 0.231)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.609
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07513875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.456
NEC for r=0.9 class 0 = 0.335 +- 0.168 (in-sample avg dev_std = 0.207)
NEC for r=0.9 class 1 = 0.35 +- 0.168 (in-sample avg dev_std = 0.207)
NEC for r=0.9 class 2 = 0.383 +- 0.168 (in-sample avg dev_std = 0.207)
NEC for r=0.9 all KL = 0.18 +- 0.168 (in-sample avg dev_std = 0.207)
NEC for r=0.9 all L1 = 0.355 +- 0.134 (in-sample avg dev_std = 0.207)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.48
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06820999999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.443
NEC for r=1.0 class 0 = 0.303 +- 0.185 (in-sample avg dev_std = 0.202)
NEC for r=1.0 class 1 = 0.385 +- 0.185 (in-sample avg dev_std = 0.202)
NEC for r=1.0 class 2 = 0.364 +- 0.185 (in-sample avg dev_std = 0.202)
NEC for r=1.0 all KL = 0.187 +- 0.185 (in-sample avg dev_std = 0.202)
NEC for r=1.0 all L1 = 0.35 +- 0.147 (in-sample avg dev_std = 0.202)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:04:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:36 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:04:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9257
Train Loss: 0.3361
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3077
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3376
OOD Validation ACCURACY: 0.8420
OOD Validation Loss: 0.5515
OOD Test ACCURACY: 0.4797
OOD Test Loss: 2.8706

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3241
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3015
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3264
OOD Validation ACCURACY: 0.9020
OOD Validation Loss: 0.4748
OOD Test ACCURACY: 0.4983
OOD Test Loss: 2.8719

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.4797 0.9280 0.4983 0.9327 0.9020[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.738
WIoU for r=0.3 = 0.623
F1 for r=0.6 = 0.647
WIoU for r=0.6 = 0.527
F1 for r=0.9 = 0.518
WIoU for r=0.9 = 0.393
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.370
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.574
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.360
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.167
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.153
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.317
WIoU for r=0.3 = 0.200
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.107
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.074
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.067


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.466
Model XAI F1 of binarized graphs for r=0.3 =  0.7382762500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6227275
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.415
SUFF++ for r=0.3 class 0 = 0.469 +- 0.274 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 class 1 = 0.537 +- 0.274 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 class 2 = 0.577 +- 0.274 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 all KL = 0.538 +- 0.274 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.3 all L1 = 0.528 +- 0.165 (in-sample avg dev_std = 0.508)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.6473224999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.52664125
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.703
SUFF++ for r=0.6 class 0 = 0.608 +- 0.257 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 class 1 = 0.593 +- 0.257 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.257 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 all KL = 0.666 +- 0.257 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 all L1 = 0.646 +- 0.205 (in-sample avg dev_std = 0.431)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.51768
Model XAI WIoU of binarized graphs for r=0.9 =  0.39266625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.88
SUFF++ for r=0.9 class 0 = 0.785 +- 0.167 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 1 = 0.858 +- 0.167 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 2 = 0.865 +- 0.167 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all KL = 0.886 +- 0.167 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all L1 = 0.836 +- 0.152 (in-sample avg dev_std = 0.234)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.712
Model XAI F1 of binarized graphs for r=0.3 =  0.5741937500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.4427525
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.691
SUFF++ for r=0.3 class 0 = 0.584 +- 0.239 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 1 = 0.542 +- 0.239 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 2 = 0.681 +- 0.239 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all KL = 0.657 +- 0.239 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all L1 = 0.601 +- 0.179 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  0.36014375
Model XAI WIoU of binarized graphs for r=0.6 =  0.24242750000000002
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.718
SUFF++ for r=0.6 class 0 = 0.535 +- 0.237 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 1 = 0.619 +- 0.237 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 2 = 0.72 +- 0.237 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all KL = 0.694 +- 0.237 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all L1 = 0.623 +- 0.163 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.2593275
Model XAI WIoU of binarized graphs for r=0.9 =  0.16749625
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0 = 0.724 +- 0.123 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 class 1 = 0.799 +- 0.123 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 class 2 = 0.809 +- 0.123 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 all KL = 0.896 +- 0.123 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.137 (in-sample avg dev_std = 0.210)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.619
Model XAI F1 of binarized graphs for r=0.3 =  0.31706249999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.20024375
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.58
SUFF++ for r=0.3 class 0 = 0.597 +- 0.215 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 1 = 0.614 +- 0.215 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 2 = 0.667 +- 0.215 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all KL = 0.728 +- 0.215 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all L1 = 0.625 +- 0.127 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  0.17987874999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.10706875
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.579
SUFF++ for r=0.6 class 0 = 0.588 +- 0.228 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 class 1 = 0.616 +- 0.228 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 class 2 = 0.625 +- 0.228 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 all KL = 0.704 +- 0.228 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.6 all L1 = 0.609 +- 0.114 (in-sample avg dev_std = 0.418)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07358625
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.541
SUFF++ for r=0.9 class 0 = 0.781 +- 0.068 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 1 = 0.822 +- 0.068 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 2 = 0.778 +- 0.068 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all KL = 0.91 +- 0.068 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all L1 = 0.794 +- 0.117 (in-sample avg dev_std = 0.186)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.468
Model XAI F1 of binarized graphs for r=0.3 =  0.7382762500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6227275
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.631 +- 0.314 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 1 = 0.532 +- 0.314 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 2 = 0.594 +- 0.314 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all KL = 0.566 +- 0.314 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all L1 = 0.586 +- 0.184 (in-sample avg dev_std = 0.382)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.794
Model XAI F1 of binarized graphs for r=0.6 =  0.6473224999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.52664125
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.404
NEC for r=0.6 class 0 = 0.625 +- 0.294 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 1 = 0.491 +- 0.294 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 2 = 0.639 +- 0.294 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all KL = 0.635 +- 0.294 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all L1 = 0.586 +- 0.183 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.51768
Model XAI WIoU of binarized graphs for r=0.9 =  0.39266625
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.484
NEC for r=0.9 class 0 = 0.604 +- 0.256 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 1 = 0.504 +- 0.256 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 2 = 0.588 +- 0.256 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all KL = 0.623 +- 0.256 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all L1 = 0.566 +- 0.171 (in-sample avg dev_std = 0.580)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.3704925
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.523
NEC for r=1.0 class 0 = 0.573 +- 0.268 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 1 = 0.462 +- 0.268 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 2 = 0.577 +- 0.268 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all KL = 0.616 +- 0.268 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all L1 = 0.539 +- 0.187 (in-sample avg dev_std = 0.617)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.5741937500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.4427525
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.319
NEC for r=0.3 class 0 = 0.602 +- 0.289 (in-sample avg dev_std = 0.318)
NEC for r=0.3 class 1 = 0.523 +- 0.289 (in-sample avg dev_std = 0.318)
NEC for r=0.3 class 2 = 0.54 +- 0.289 (in-sample avg dev_std = 0.318)
NEC for r=0.3 all KL = 0.521 +- 0.289 (in-sample avg dev_std = 0.318)
NEC for r=0.3 all L1 = 0.556 +- 0.190 (in-sample avg dev_std = 0.318)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  0.36014375
Model XAI WIoU of binarized graphs for r=0.6 =  0.24242750000000002
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.409
NEC for r=0.6 class 0 = 0.516 +- 0.242 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.441 +- 0.242 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.535 +- 0.242 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.441 +- 0.242 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.497 +- 0.181 (in-sample avg dev_std = 0.390)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.2593275
Model XAI WIoU of binarized graphs for r=0.9 =  0.16749625
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.526
NEC for r=0.9 class 0 = 0.52 +- 0.191 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 1 = 0.405 +- 0.191 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 2 = 0.504 +- 0.191 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all KL = 0.361 +- 0.191 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all L1 = 0.476 +- 0.129 (in-sample avg dev_std = 0.407)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.874
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.15292124999999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.573
NEC for r=1.0 class 0 = 0.459 +- 0.178 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 1 = 0.41 +- 0.178 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 2 = 0.492 +- 0.178 (in-sample avg dev_std = 0.398)
NEC for r=1.0 all KL = 0.34 +- 0.178 (in-sample avg dev_std = 0.398)
NEC for r=1.0 all L1 = 0.453 +- 0.116 (in-sample avg dev_std = 0.398)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.619
Model XAI F1 of binarized graphs for r=0.3 =  0.31706249999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.20024375
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.338
NEC for r=0.3 class 0 = 0.502 +- 0.239 (in-sample avg dev_std = 0.246)
NEC for r=0.3 class 1 = 0.434 +- 0.239 (in-sample avg dev_std = 0.246)
NEC for r=0.3 class 2 = 0.428 +- 0.239 (in-sample avg dev_std = 0.246)
NEC for r=0.3 all KL = 0.336 +- 0.239 (in-sample avg dev_std = 0.246)
NEC for r=0.3 all L1 = 0.455 +- 0.214 (in-sample avg dev_std = 0.246)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  0.17987874999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.10706875
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.391
NEC for r=0.6 class 0 = 0.373 +- 0.143 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 1 = 0.323 +- 0.143 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 2 = 0.396 +- 0.143 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all KL = 0.221 +- 0.143 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all L1 = 0.363 +- 0.142 (in-sample avg dev_std = 0.254)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07358625
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.423
NEC for r=0.9 class 0 = 0.275 +- 0.125 (in-sample avg dev_std = 0.211)
NEC for r=0.9 class 1 = 0.294 +- 0.125 (in-sample avg dev_std = 0.211)
NEC for r=0.9 class 2 = 0.285 +- 0.125 (in-sample avg dev_std = 0.211)
NEC for r=0.9 all KL = 0.139 +- 0.125 (in-sample avg dev_std = 0.211)
NEC for r=0.9 all L1 = 0.285 +- 0.175 (in-sample avg dev_std = 0.211)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.476
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06688
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.408
NEC for r=1.0 class 0 = 0.234 +- 0.131 (in-sample avg dev_std = 0.202)
NEC for r=1.0 class 1 = 0.265 +- 0.131 (in-sample avg dev_std = 0.202)
NEC for r=1.0 class 2 = 0.238 +- 0.131 (in-sample avg dev_std = 0.202)
NEC for r=1.0 all KL = 0.124 +- 0.131 (in-sample avg dev_std = 0.202)
NEC for r=1.0 all L1 = 0.246 +- 0.170 (in-sample avg dev_std = 0.202)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.521, 0.658, 0.881, 1.0], 'all_L1': [0.51, 0.618, 0.815, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.685, 0.892, 1.0], 'all_L1': [0.544, 0.65, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.666, 0.886, 1.0], 'all_L1': [0.528, 0.646, 0.836, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.563, 0.598, 0.575, 0.614], 'all_L1': [0.582, 0.588, 0.556, 0.549]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.611, 0.566, 0.583], 'all_L1': [0.551, 0.588, 0.551, 0.543]}), defaultdict(<class 'list'>, {'all_KL': [0.566, 0.635, 0.623, 0.616], 'all_L1': [0.586, 0.586, 0.566, 0.539]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.629, 0.635, 0.887, 1.0], 'all_L1': [0.573, 0.593, 0.758, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.792, 0.927, 1.0], 'all_L1': [0.614, 0.673, 0.806, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.694, 0.896, 1.0], 'all_L1': [0.601, 0.623, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.475, 0.456, 0.348, 0.368], 'all_L1': [0.529, 0.498, 0.475, 0.476]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.399, 0.315, 0.292], 'all_L1': [0.576, 0.507, 0.463, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.521, 0.441, 0.361, 0.34], 'all_L1': [0.556, 0.497, 0.476, 0.453]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.701, 0.646, 0.889, 1.0], 'all_L1': [0.607, 0.574, 0.772, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.739, 0.721, 0.85, 1.0], 'all_L1': [0.616, 0.611, 0.732, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.728, 0.704, 0.91, 1.0], 'all_L1': [0.625, 0.609, 0.794, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.327, 0.244, 0.162, 0.152], 'all_L1': [0.454, 0.379, 0.316, 0.283]}), defaultdict(<class 'list'>, {'all_KL': [0.296, 0.207, 0.18, 0.187], 'all_L1': [0.439, 0.367, 0.355, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.336, 0.221, 0.139, 0.124], 'all_L1': [0.455, 0.363, 0.285, 0.246]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.527 +- 0.014, 0.638 +- 0.014, 0.827 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.544 +- 0.022, 0.670 +- 0.011, 0.886 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.438 +- 0.017, 0.701 +- 0.004, 0.877 +- 0.003
nec class all_L1  =  0.573 +- 0.016, 0.587 +- 0.001, 0.558 +- 0.006, 0.544 +- 0.004
nec class all_KL  =  0.550 +- 0.021, 0.615 +- 0.015, 0.588 +- 0.025, 0.604 +- 0.015
nec_acc_int  =  0.322 +- 0.011, 0.393 +- 0.007, 0.489 +- 0.003, 0.522 +- 0.002

Eval split val
suff++ class all_L1  =  0.596 +- 0.017, 0.630 +- 0.033, 0.780 +- 0.020, 1.000 +- 0.000
suff++ class all_KL  =  0.654 +- 0.020, 0.707 +- 0.065, 0.903 +- 0.017, 1.000 +- 0.000
suff++_acc_int  =  0.685 +- 0.020, 0.716 +- 0.030, 0.849 +- 0.024
nec class all_L1  =  0.554 +- 0.019, 0.501 +- 0.004, 0.471 +- 0.006, 0.457 +- 0.015
nec class all_KL  =  0.513 +- 0.028, 0.432 +- 0.024, 0.341 +- 0.019, 0.333 +- 0.031
nec_acc_int  =  0.331 +- 0.009, 0.413 +- 0.013, 0.525 +- 0.004, 0.562 +- 0.012

Eval split test
suff++ class all_L1  =  0.616 +- 0.007, 0.598 +- 0.017, 0.766 +- 0.026, 1.000 +- 0.000
suff++ class all_KL  =  0.723 +- 0.016, 0.690 +- 0.032, 0.883 +- 0.025, 1.000 +- 0.000
suff++_acc_int  =  0.568 +- 0.025, 0.571 +- 0.016, 0.575 +- 0.034
nec class all_L1  =  0.449 +- 0.007, 0.370 +- 0.007, 0.319 +- 0.029, 0.293 +- 0.043
nec class all_KL  =  0.320 +- 0.017, 0.224 +- 0.015, 0.160 +- 0.017, 0.154 +- 0.026
nec_acc_int  =  0.342 +- 0.013, 0.385 +- 0.005, 0.432 +- 0.017, 0.416 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.550 +- 0.005, 0.613 +- 0.007, 0.692 +- 0.006, 0.772 +- 0.002
Faith. Armon (L1)= 		  =  0.549 +- 0.005, 0.612 +- 0.006, 0.666 +- 0.006, 0.704 +- 0.003
Faith. GMean (L1)= 	  =  0.550 +- 0.005, 0.612 +- 0.007, 0.679 +- 0.006, 0.737 +- 0.003
Faith. Aritm (KL)= 		  =  0.547 +- 0.004, 0.642 +- 0.010, 0.737 +- 0.012, 0.802 +- 0.008
Faith. Armon (KL)= 		  =  0.546 +- 0.004, 0.641 +- 0.010, 0.707 +- 0.018, 0.753 +- 0.012
Faith. GMean (KL)= 	  =  0.546 +- 0.004, 0.642 +- 0.010, 0.722 +- 0.015, 0.777 +- 0.010

Eval split val
Faith. Aritm (L1)= 		  =  0.575 +- 0.018, 0.565 +- 0.019, 0.626 +- 0.007, 0.728 +- 0.007
Faith. Armon (L1)= 		  =  0.574 +- 0.018, 0.558 +- 0.015, 0.587 +- 0.003, 0.627 +- 0.014
Faith. GMean (L1)= 	  =  0.574 +- 0.018, 0.561 +- 0.017, 0.606 +- 0.005, 0.676 +- 0.011
Faith. Aritm (KL)= 		  =  0.583 +- 0.024, 0.570 +- 0.020, 0.622 +- 0.005, 0.667 +- 0.016
Faith. Armon (KL)= 		  =  0.575 +- 0.025, 0.534 +- 0.004, 0.495 +- 0.018, 0.499 +- 0.036
Faith. GMean (KL)= 	  =  0.579 +- 0.025, 0.551 +- 0.010, 0.555 +- 0.012, 0.577 +- 0.027

Eval split test
Faith. Aritm (L1)= 		  =  0.533 +- 0.005, 0.484 +- 0.005, 0.542 +- 0.002, 0.646 +- 0.022
Faith. Armon (L1)= 		  =  0.520 +- 0.006, 0.457 +- 0.002, 0.449 +- 0.024, 0.452 +- 0.051
Faith. GMean (L1)= 	  =  0.526 +- 0.005, 0.470 +- 0.003, 0.493 +- 0.014, 0.540 +- 0.039
Faith. Aritm (KL)= 		  =  0.521 +- 0.008, 0.457 +- 0.009, 0.522 +- 0.005, 0.577 +- 0.013
Faith. Armon (KL)= 		  =  0.443 +- 0.015, 0.337 +- 0.013, 0.271 +- 0.023, 0.267 +- 0.039
Faith. GMean (KL)= 	  =  0.480 +- 0.011, 0.393 +- 0.005, 0.375 +- 0.015, 0.391 +- 0.033
Computed for split load_split = id



Completed in  0:22:30.695291  for GSATGIN GOODMotif/size



DONE GSAT GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:12:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:12:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ROC-AUC: 0.9213
Train Loss: 0.0885
ID Validation ROC-AUC: 0.8414
ID Validation Loss: 0.1273
ID Test ROC-AUC: 0.7885
ID Test Loss: 0.1135
OOD Validation ROC-AUC: 0.7416
OOD Validation Loss: 0.1219
OOD Test ROC-AUC: 0.6658
OOD Test Loss: 0.0954

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ROC-AUC: 0.9328
Train Loss: 0.0914
ID Validation ROC-AUC: 0.8173
ID Validation Loss: 0.1397
ID Test ROC-AUC: 0.7987
ID Test Loss: 0.1216
OOD Validation ROC-AUC: 0.7790
OOD Validation Loss: 0.1193
OOD Test ROC-AUC: 0.6905
OOD Test Loss: 0.0920

[0m[1;37mINFO[0m: [1mChartInfo 0.7885 0.6658 0.7987 0.6905 0.8173 0.7790[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 12:12:30 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 12:12:33 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 12:12:34 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.6
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.61
SUFF++ for r=0.3 class 0.0 = 0.979 +- 0.089 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.3 class 1.0 = 0.933 +- 0.089 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.3 all KL = 0.955 +- 0.089 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.3 all L1 = 0.956 +- 0.080 (in-sample avg dev_std = 0.126)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.703
SUFF++ for r=0.6 class 0.0 = 0.95 +- 0.124 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.6 class 1.0 = 0.855 +- 0.124 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.6 all KL = 0.919 +- 0.124 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.6 all L1 = 0.903 +- 0.124 (in-sample avg dev_std = 0.197)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0.0 = 0.962 +- 0.071 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 class 1.0 = 0.89 +- 0.071 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 all KL = 0.964 +- 0.071 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 all L1 = 0.926 +- 0.104 (in-sample avg dev_std = 0.128)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.635
SUFF++ for r=0.3 class 0.0 = 0.981 +- 0.085 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.3 class 1.0 = 0.933 +- 0.085 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.3 all KL = 0.964 +- 0.085 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.3 all L1 = 0.957 +- 0.094 (in-sample avg dev_std = 0.111)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.676
SUFF++ for r=0.6 class 0.0 = 0.955 +- 0.117 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.6 class 1.0 = 0.878 +- 0.117 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.6 all KL = 0.934 +- 0.117 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.6 all L1 = 0.916 +- 0.122 (in-sample avg dev_std = 0.150)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
SUFF++ for r=0.9 class 0.0 = 0.967 +- 0.064 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 class 1.0 = 0.894 +- 0.064 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 all KL = 0.971 +- 0.064 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.107 (in-sample avg dev_std = 0.115)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.528
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.585
SUFF++ for r=0.3 class 0.0 = 0.991 +- 0.032 (in-sample avg dev_std = 0.059)
SUFF++ for r=0.3 class 1.0 = 0.977 +- 0.032 (in-sample avg dev_std = 0.059)
SUFF++ for r=0.3 all KL = 0.989 +- 0.032 (in-sample avg dev_std = 0.059)
SUFF++ for r=0.3 all L1 = 0.984 +- 0.045 (in-sample avg dev_std = 0.059)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.51
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.561
SUFF++ for r=0.6 class 0.0 = 0.965 +- 0.076 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.6 class 1.0 = 0.944 +- 0.076 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.6 all KL = 0.96 +- 0.076 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.6 all L1 = 0.955 +- 0.077 (in-sample avg dev_std = 0.115)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.546
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.54
SUFF++ for r=0.9 class 0.0 = 0.962 +- 0.055 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 class 1.0 = 0.936 +- 0.055 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all KL = 0.976 +- 0.055 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all L1 = 0.949 +- 0.090 (in-sample avg dev_std = 0.099)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.599
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.659
NEC for r=0.3 class 0.0 = 0.005 +- 0.083 (in-sample avg dev_std = 0.065)
NEC for r=0.3 class 1.0 = 0.056 +- 0.083 (in-sample avg dev_std = 0.065)
NEC for r=0.3 all KL = 0.02 +- 0.083 (in-sample avg dev_std = 0.065)
NEC for r=0.3 all L1 = 0.031 +- 0.086 (in-sample avg dev_std = 0.065)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.719
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.717
NEC for r=0.6 class 0.0 = 0.022 +- 0.108 (in-sample avg dev_std = 0.099)
NEC for r=0.6 class 1.0 = 0.112 +- 0.108 (in-sample avg dev_std = 0.099)
NEC for r=0.6 all KL = 0.039 +- 0.108 (in-sample avg dev_std = 0.099)
NEC for r=0.6 all L1 = 0.067 +- 0.131 (in-sample avg dev_std = 0.099)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.737
NEC for r=0.9 class 0.0 = 0.028 +- 0.051 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 1.0 = 0.087 +- 0.051 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all KL = 0.021 +- 0.051 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all L1 = 0.058 +- 0.090 (in-sample avg dev_std = 0.091)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.781
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.744
NEC for r=1.0 class 0.0 = 0.03 +- 0.051 (in-sample avg dev_std = 0.090)
NEC for r=1.0 class 1.0 = 0.085 +- 0.051 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all KL = 0.02 +- 0.051 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all L1 = 0.057 +- 0.095 (in-sample avg dev_std = 0.090)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.676
NEC for r=0.3 class 0.0 = 0.01 +- 0.100 (in-sample avg dev_std = 0.067)
NEC for r=0.3 class 1.0 = 0.061 +- 0.100 (in-sample avg dev_std = 0.067)
NEC for r=0.3 all KL = 0.025 +- 0.100 (in-sample avg dev_std = 0.067)
NEC for r=0.3 all L1 = 0.036 +- 0.105 (in-sample avg dev_std = 0.067)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.683
NEC for r=0.6 class 0.0 = 0.033 +- 0.127 (in-sample avg dev_std = 0.119)
NEC for r=0.6 class 1.0 = 0.1 +- 0.127 (in-sample avg dev_std = 0.119)
NEC for r=0.6 all KL = 0.045 +- 0.127 (in-sample avg dev_std = 0.119)
NEC for r=0.6 all L1 = 0.067 +- 0.127 (in-sample avg dev_std = 0.119)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.701
NEC for r=0.9 class 0.0 = 0.034 +- 0.084 (in-sample avg dev_std = 0.099)
NEC for r=0.9 class 1.0 = 0.108 +- 0.084 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all KL = 0.031 +- 0.084 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all L1 = 0.071 +- 0.118 (in-sample avg dev_std = 0.099)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.704
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.705
NEC for r=1.0 class 0.0 = 0.026 +- 0.048 (in-sample avg dev_std = 0.078)
NEC for r=1.0 class 1.0 = 0.083 +- 0.048 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all KL = 0.017 +- 0.048 (in-sample avg dev_std = 0.078)
NEC for r=1.0 all L1 = 0.054 +- 0.093 (in-sample avg dev_std = 0.078)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.528
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.554
NEC for r=0.3 class 0.0 = 0.006 +- 0.060 (in-sample avg dev_std = 0.053)
NEC for r=0.3 class 1.0 = 0.029 +- 0.060 (in-sample avg dev_std = 0.053)
NEC for r=0.3 all KL = 0.011 +- 0.060 (in-sample avg dev_std = 0.053)
NEC for r=0.3 all L1 = 0.018 +- 0.067 (in-sample avg dev_std = 0.053)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.517
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.53
NEC for r=0.6 class 0.0 = 0.022 +- 0.084 (in-sample avg dev_std = 0.068)
NEC for r=0.6 class 1.0 = 0.042 +- 0.084 (in-sample avg dev_std = 0.068)
NEC for r=0.6 all KL = 0.022 +- 0.084 (in-sample avg dev_std = 0.068)
NEC for r=0.6 all L1 = 0.032 +- 0.079 (in-sample avg dev_std = 0.068)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.546
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.544
NEC for r=0.9 class 0.0 = 0.036 +- 0.047 (in-sample avg dev_std = 0.068)
NEC for r=0.9 class 1.0 = 0.058 +- 0.047 (in-sample avg dev_std = 0.068)
NEC for r=0.9 all KL = 0.018 +- 0.047 (in-sample avg dev_std = 0.068)
NEC for r=0.9 all L1 = 0.047 +- 0.091 (in-sample avg dev_std = 0.068)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.561
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.55
NEC for r=1.0 class 0.0 = 0.027 +- 0.033 (in-sample avg dev_std = 0.058)
NEC for r=1.0 class 1.0 = 0.048 +- 0.033 (in-sample avg dev_std = 0.058)
NEC for r=1.0 all KL = 0.012 +- 0.033 (in-sample avg dev_std = 0.058)
NEC for r=1.0 all L1 = 0.037 +- 0.075 (in-sample avg dev_std = 0.058)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:13:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 12:13:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:13:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:13:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:13:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 157...
[0m[1;37mINFO[0m: [1mCheckpoint 157: 
-----------------------------------
Train ROC-AUC: 0.9815
Train Loss: 0.0601
ID Validation ROC-AUC: 0.8516
ID Validation Loss: 0.1361
ID Test ROC-AUC: 0.8303
ID Test Loss: 0.1200
OOD Validation ROC-AUC: 0.7584
OOD Validation Loss: 0.1298
OOD Test ROC-AUC: 0.7363
OOD Test Loss: 0.1003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.8880
Train Loss: 0.1085
ID Validation ROC-AUC: 0.8321
ID Validation Loss: 0.1476
ID Test ROC-AUC: 0.8109
ID Test Loss: 0.1260
OOD Validation ROC-AUC: 0.7838
OOD Validation Loss: 0.1166
OOD Test ROC-AUC: 0.6928
OOD Test Loss: 0.0948

[0m[1;37mINFO[0m: [1mChartInfo 0.8303 0.7363 0.8109 0.6928 0.8321 0.7838[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 12:14:02 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 12:14:04 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 12:14:05 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.636
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.588
SUFF++ for r=0.3 class 0.0 = 0.976 +- 0.105 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.3 class 1.0 = 0.932 +- 0.105 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.3 all KL = 0.948 +- 0.105 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.3 all L1 = 0.954 +- 0.085 (in-sample avg dev_std = 0.134)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
SUFF++ for r=0.6 class 0.0 = 0.941 +- 0.152 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 class 1.0 = 0.805 +- 0.152 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 all KL = 0.887 +- 0.152 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 all L1 = 0.873 +- 0.161 (in-sample avg dev_std = 0.242)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.798
SUFF++ for r=0.9 class 0.0 = 0.975 +- 0.107 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 1.0 = 0.845 +- 0.107 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all KL = 0.95 +- 0.107 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all L1 = 0.91 +- 0.144 (in-sample avg dev_std = 0.171)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.544
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.588
SUFF++ for r=0.3 class 0.0 = 0.983 +- 0.090 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.3 class 1.0 = 0.948 +- 0.090 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.3 all KL = 0.961 +- 0.090 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.3 all L1 = 0.965 +- 0.059 (in-sample avg dev_std = 0.098)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.695
SUFF++ for r=0.6 class 0.0 = 0.943 +- 0.137 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.6 class 1.0 = 0.805 +- 0.137 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.6 all KL = 0.894 +- 0.137 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.6 all L1 = 0.874 +- 0.165 (in-sample avg dev_std = 0.223)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.75
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.75
SUFF++ for r=0.9 class 0.0 = 0.969 +- 0.084 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.9 class 1.0 = 0.881 +- 0.084 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.9 all KL = 0.962 +- 0.084 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.9 all L1 = 0.925 +- 0.120 (in-sample avg dev_std = 0.135)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.453
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.511
SUFF++ for r=0.3 class 0.0 = 0.991 +- 0.029 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 class 1.0 = 0.987 +- 0.029 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 all KL = 0.992 +- 0.029 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 all L1 = 0.989 +- 0.023 (in-sample avg dev_std = 0.043)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.587
SUFF++ for r=0.6 class 0.0 = 0.984 +- 0.086 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.6 class 1.0 = 0.95 +- 0.086 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.6 all KL = 0.973 +- 0.086 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.6 all L1 = 0.967 +- 0.087 (in-sample avg dev_std = 0.102)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.683
SUFF++ for r=0.9 class 0.0 = 0.993 +- 0.045 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 class 1.0 = 0.951 +- 0.045 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all KL = 0.986 +- 0.045 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.079 (in-sample avg dev_std = 0.099)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.637
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.656
NEC for r=0.3 class 0.0 = 0.006 +- 0.086 (in-sample avg dev_std = 0.087)
NEC for r=0.3 class 1.0 = 0.06 +- 0.086 (in-sample avg dev_std = 0.087)
NEC for r=0.3 all KL = 0.023 +- 0.086 (in-sample avg dev_std = 0.087)
NEC for r=0.3 all L1 = 0.033 +- 0.090 (in-sample avg dev_std = 0.087)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.753
NEC for r=0.6 class 0.0 = 0.02 +- 0.104 (in-sample avg dev_std = 0.130)
NEC for r=0.6 class 1.0 = 0.154 +- 0.104 (in-sample avg dev_std = 0.130)
NEC for r=0.6 all KL = 0.049 +- 0.104 (in-sample avg dev_std = 0.130)
NEC for r=0.6 all L1 = 0.087 +- 0.146 (in-sample avg dev_std = 0.130)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.789
NEC for r=0.9 class 0.0 = 0.023 +- 0.115 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.175 +- 0.115 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.057 +- 0.115 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.099 +- 0.160 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.834
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.79
NEC for r=1.0 class 0.0 = 0.02 +- 0.123 (in-sample avg dev_std = 0.176)
NEC for r=1.0 class 1.0 = 0.174 +- 0.123 (in-sample avg dev_std = 0.176)
NEC for r=1.0 all KL = 0.056 +- 0.123 (in-sample avg dev_std = 0.176)
NEC for r=1.0 all L1 = 0.097 +- 0.164 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.656
NEC for r=0.3 class 0.0 = 0.007 +- 0.086 (in-sample avg dev_std = 0.062)
NEC for r=0.3 class 1.0 = 0.05 +- 0.086 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all KL = 0.026 +- 0.086 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all L1 = 0.029 +- 0.067 (in-sample avg dev_std = 0.062)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.701
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.715
NEC for r=0.6 class 0.0 = 0.024 +- 0.084 (in-sample avg dev_std = 0.129)
NEC for r=0.6 class 1.0 = 0.128 +- 0.084 (in-sample avg dev_std = 0.129)
NEC for r=0.6 all KL = 0.039 +- 0.084 (in-sample avg dev_std = 0.129)
NEC for r=0.6 all L1 = 0.076 +- 0.131 (in-sample avg dev_std = 0.129)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.75
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.734
NEC for r=0.9 class 0.0 = 0.025 +- 0.090 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 1.0 = 0.157 +- 0.090 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all KL = 0.047 +- 0.090 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all L1 = 0.091 +- 0.140 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.767
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.738
NEC for r=1.0 class 0.0 = 0.023 +- 0.080 (in-sample avg dev_std = 0.153)
NEC for r=1.0 class 1.0 = 0.143 +- 0.080 (in-sample avg dev_std = 0.153)
NEC for r=1.0 all KL = 0.038 +- 0.080 (in-sample avg dev_std = 0.153)
NEC for r=1.0 all L1 = 0.083 +- 0.128 (in-sample avg dev_std = 0.153)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.453
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.564
NEC for r=0.3 class 0.0 = 0.006 +- 0.024 (in-sample avg dev_std = 0.028)
NEC for r=0.3 class 1.0 = 0.013 +- 0.024 (in-sample avg dev_std = 0.028)
NEC for r=0.3 all KL = 0.006 +- 0.024 (in-sample avg dev_std = 0.028)
NEC for r=0.3 all L1 = 0.009 +- 0.020 (in-sample avg dev_std = 0.028)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.632
NEC for r=0.6 class 0.0 = 0.009 +- 0.038 (in-sample avg dev_std = 0.061)
NEC for r=0.6 class 1.0 = 0.042 +- 0.038 (in-sample avg dev_std = 0.061)
NEC for r=0.6 all KL = 0.015 +- 0.038 (in-sample avg dev_std = 0.061)
NEC for r=0.6 all L1 = 0.025 +- 0.067 (in-sample avg dev_std = 0.061)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.698
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.681
NEC for r=0.9 class 0.0 = 0.008 +- 0.087 (in-sample avg dev_std = 0.118)
NEC for r=0.9 class 1.0 = 0.066 +- 0.087 (in-sample avg dev_std = 0.118)
NEC for r=0.9 all KL = 0.024 +- 0.087 (in-sample avg dev_std = 0.118)
NEC for r=0.9 all L1 = 0.037 +- 0.114 (in-sample avg dev_std = 0.118)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.725
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.699
NEC for r=1.0 class 0.0 = 0.007 +- 0.093 (in-sample avg dev_std = 0.128)
NEC for r=1.0 class 1.0 = 0.062 +- 0.093 (in-sample avg dev_std = 0.128)
NEC for r=1.0 all KL = 0.024 +- 0.093 (in-sample avg dev_std = 0.128)
NEC for r=1.0 all L1 = 0.035 +- 0.109 (in-sample avg dev_std = 0.128)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:15:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ROC-AUC: 0.9435
Train Loss: 0.0815
ID Validation ROC-AUC: 0.8481
ID Validation Loss: 0.1324
ID Test ROC-AUC: 0.8267
ID Test Loss: 0.1177
OOD Validation ROC-AUC: 0.7799
OOD Validation Loss: 0.1230
OOD Test ROC-AUC: 0.6955
OOD Test Loss: 0.0948

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ROC-AUC: 0.8972
Train Loss: 0.1011
ID Validation ROC-AUC: 0.8092
ID Validation Loss: 0.1406
ID Test ROC-AUC: 0.7826
ID Test Loss: 0.1253
OOD Validation ROC-AUC: 0.7984
OOD Validation Loss: 0.1161
OOD Test ROC-AUC: 0.6964
OOD Test Loss: 0.0942

[0m[1;37mINFO[0m: [1mChartInfo 0.8267 0.6955 0.7826 0.6964 0.8092 0.7984[0mGOODHIV(4112)
Data example from id_val: Data(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
Label distribution from id_val: (tensor([0., 1.]), tensor([3936,  176]))
[1;34mDEBUG[0m: 04/22/2024 12:15:27 PM : [1mUnbalanced warning for GOODHIV (id_val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([176, 176]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4113)
Data example from val: Data(x=[33, 9], edge_index=[2, 74], edge_attr=[74, 3], y=[1, 1], smiles='OC(c1ccccc1)c1c(-c2ccccc2)[nH]c(-c2ccccc2)c1C(O)c1ccccc1', idx=[1], scaffold='c1ccc(Cc2c(-c3ccccc3)[nH]c(-c3ccccc3)c2Cc2ccccc2)cc1', domain_id=[1], ori_edge_index=[2, 74], node_perm=[33])
Label distribution from val: (tensor([0., 1.]), tensor([3987,  126]))
[1;34mDEBUG[0m: 04/22/2024 12:15:28 PM : [1mUnbalanced warning for GOODHIV (val)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([126, 126]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 04/22/2024 12:15:30 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.575
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.559
SUFF++ for r=0.3 class 0.0 = 0.97 +- 0.166 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.3 class 1.0 = 0.911 +- 0.166 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.3 all KL = 0.919 +- 0.166 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.3 all L1 = 0.941 +- 0.126 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.754
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.709
SUFF++ for r=0.6 class 0.0 = 0.899 +- 0.221 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 class 1.0 = 0.785 +- 0.221 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 all KL = 0.802 +- 0.221 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 all L1 = 0.842 +- 0.164 (in-sample avg dev_std = 0.356)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.756
SUFF++ for r=0.9 class 0.0 = 0.932 +- 0.149 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 class 1.0 = 0.874 +- 0.149 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all KL = 0.919 +- 0.149 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.147 (in-sample avg dev_std = 0.208)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.611
SUFF++ for r=0.3 class 0.0 = 0.976 +- 0.147 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.3 class 1.0 = 0.892 +- 0.147 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.3 all KL = 0.925 +- 0.147 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.3 all L1 = 0.934 +- 0.130 (in-sample avg dev_std = 0.177)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.714
SUFF++ for r=0.6 class 0.0 = 0.923 +- 0.202 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 class 1.0 = 0.815 +- 0.202 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 all KL = 0.835 +- 0.202 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 all L1 = 0.869 +- 0.158 (in-sample avg dev_std = 0.318)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.76
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.758
SUFF++ for r=0.9 class 0.0 = 0.97 +- 0.081 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 1.0 = 0.929 +- 0.081 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all KL = 0.963 +- 0.081 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all L1 = 0.949 +- 0.092 (in-sample avg dev_std = 0.123)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.547
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.534
SUFF++ for r=0.3 class 0.0 = 0.993 +- 0.051 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.3 class 1.0 = 0.982 +- 0.051 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.3 all KL = 0.989 +- 0.051 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.3 all L1 = 0.987 +- 0.036 (in-sample avg dev_std = 0.055)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.613
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.617
SUFF++ for r=0.6 class 0.0 = 0.955 +- 0.126 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.6 class 1.0 = 0.925 +- 0.126 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.6 all KL = 0.93 +- 0.126 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.6 all L1 = 0.94 +- 0.100 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.669
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.076 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 class 1.0 = 0.935 +- 0.076 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all KL = 0.975 +- 0.076 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all L1 = 0.958 +- 0.105 (in-sample avg dev_std = 0.105)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.575
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 352
Effective ratio: 0.308 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.589
NEC for r=0.3 class 0.0 = 0.008 +- 0.109 (in-sample avg dev_std = 0.097)
NEC for r=0.3 class 1.0 = 0.058 +- 0.109 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all KL = 0.031 +- 0.109 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all L1 = 0.033 +- 0.098 (in-sample avg dev_std = 0.097)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 352
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.748
NEC for r=0.6 class 0.0 = 0.034 +- 0.128 (in-sample avg dev_std = 0.162)
NEC for r=0.6 class 1.0 = 0.138 +- 0.128 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all KL = 0.061 +- 0.128 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all L1 = 0.086 +- 0.144 (in-sample avg dev_std = 0.162)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 352
Effective ratio: 0.907 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.756
NEC for r=0.9 class 0.0 = 0.045 +- 0.113 (in-sample avg dev_std = 0.155)
NEC for r=0.9 class 1.0 = 0.112 +- 0.113 (in-sample avg dev_std = 0.155)
NEC for r=0.9 all KL = 0.05 +- 0.113 (in-sample avg dev_std = 0.155)
NEC for r=0.9 all L1 = 0.078 +- 0.129 (in-sample avg dev_std = 0.155)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.785
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 352
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.757
NEC for r=1.0 class 0.0 = 0.049 +- 0.113 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.099 +- 0.113 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.048 +- 0.113 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.074 +- 0.123 (in-sample avg dev_std = 0.159)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.6
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 252
Effective ratio: 0.309 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.671
NEC for r=0.3 class 0.0 = 0.01 +- 0.165 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 1.0 = 0.108 +- 0.165 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all KL = 0.057 +- 0.165 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all L1 = 0.059 +- 0.145 (in-sample avg dev_std = 0.141)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.756
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 252
Effective ratio: 0.609 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.753
NEC for r=0.6 class 0.0 = 0.022 +- 0.112 (in-sample avg dev_std = 0.117)
NEC for r=0.6 class 1.0 = 0.107 +- 0.112 (in-sample avg dev_std = 0.117)
NEC for r=0.6 all KL = 0.045 +- 0.112 (in-sample avg dev_std = 0.117)
NEC for r=0.6 all L1 = 0.064 +- 0.126 (in-sample avg dev_std = 0.117)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.759
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 252
Effective ratio: 0.907 +- 0.006
Model ROC-AUC over intervened graphs for r=0.9 =  0.762
NEC for r=0.9 class 0.0 = 0.029 +- 0.084 (in-sample avg dev_std = 0.113)
NEC for r=0.9 class 1.0 = 0.071 +- 0.084 (in-sample avg dev_std = 0.113)
NEC for r=0.9 all KL = 0.035 +- 0.084 (in-sample avg dev_std = 0.113)
NEC for r=0.9 all L1 = 0.05 +- 0.094 (in-sample avg dev_std = 0.113)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.763
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 252
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.764
NEC for r=1.0 class 0.0 = 0.025 +- 0.100 (in-sample avg dev_std = 0.109)
NEC for r=1.0 class 1.0 = 0.074 +- 0.100 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all KL = 0.038 +- 0.100 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all L1 = 0.05 +- 0.098 (in-sample avg dev_std = 0.109)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.566
NEC for r=0.3 class 0.0 = 0.006 +- 0.050 (in-sample avg dev_std = 0.057)
NEC for r=0.3 class 1.0 = 0.019 +- 0.050 (in-sample avg dev_std = 0.057)
NEC for r=0.3 all KL = 0.01 +- 0.050 (in-sample avg dev_std = 0.057)
NEC for r=0.3 all L1 = 0.013 +- 0.038 (in-sample avg dev_std = 0.057)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
NEC for r=0.6 class 0.0 = 0.016 +- 0.067 (in-sample avg dev_std = 0.074)
NEC for r=0.6 class 1.0 = 0.046 +- 0.067 (in-sample avg dev_std = 0.074)
NEC for r=0.6 all KL = 0.019 +- 0.067 (in-sample avg dev_std = 0.074)
NEC for r=0.6 all L1 = 0.031 +- 0.087 (in-sample avg dev_std = 0.074)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.691
NEC for r=0.9 class 0.0 = 0.015 +- 0.073 (in-sample avg dev_std = 0.111)
NEC for r=0.9 class 1.0 = 0.072 +- 0.073 (in-sample avg dev_std = 0.111)
NEC for r=0.9 all KL = 0.028 +- 0.073 (in-sample avg dev_std = 0.111)
NEC for r=0.9 all L1 = 0.043 +- 0.103 (in-sample avg dev_std = 0.111)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.676
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.684
NEC for r=1.0 class 0.0 = 0.019 +- 0.078 (in-sample avg dev_std = 0.123)
NEC for r=1.0 class 1.0 = 0.068 +- 0.078 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all KL = 0.029 +- 0.078 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all L1 = 0.044 +- 0.104 (in-sample avg dev_std = 0.123)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.955, 0.919, 0.964, 1.0], 'all_L1': [0.956, 0.903, 0.926, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.948, 0.887, 0.95, 1.0], 'all_L1': [0.954, 0.873, 0.91, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.802, 0.919, 1.0], 'all_L1': [0.941, 0.842, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.02, 0.039, 0.021, 0.02], 'all_L1': [0.031, 0.067, 0.058, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.049, 0.057, 0.056], 'all_L1': [0.033, 0.087, 0.099, 0.097]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.061, 0.05, 0.048], 'all_L1': [0.033, 0.086, 0.078, 0.074]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.964, 0.934, 0.971, 1.0], 'all_L1': [0.957, 0.916, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.961, 0.894, 0.962, 1.0], 'all_L1': [0.965, 0.874, 0.925, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.925, 0.835, 0.963, 1.0], 'all_L1': [0.934, 0.869, 0.949, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.025, 0.045, 0.031, 0.017], 'all_L1': [0.036, 0.067, 0.071, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.039, 0.047, 0.038], 'all_L1': [0.029, 0.076, 0.091, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.045, 0.035, 0.038], 'all_L1': [0.059, 0.064, 0.05, 0.05]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.989, 0.96, 0.976, 1.0], 'all_L1': [0.984, 0.955, 0.949, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.992, 0.973, 0.986, 1.0], 'all_L1': [0.989, 0.967, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.93, 0.975, 1.0], 'all_L1': [0.987, 0.94, 0.958, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.011, 0.022, 0.018, 0.012], 'all_L1': [0.018, 0.032, 0.047, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.015, 0.024, 0.024], 'all_L1': [0.009, 0.025, 0.037, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.019, 0.028, 0.029], 'all_L1': [0.013, 0.031, 0.043, 0.044]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.950 +- 0.007, 0.873 +- 0.025, 0.913 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.941 +- 0.016, 0.869 +- 0.049, 0.944 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.586 +- 0.021, 0.706 +- 0.003, 0.761 +- 0.029
nec class all_L1  =  0.032 +- 0.001, 0.080 +- 0.009, 0.078 +- 0.017, 0.076 +- 0.016
nec class all_KL  =  0.025 +- 0.005, 0.050 +- 0.009, 0.043 +- 0.016, 0.041 +- 0.015
nec_acc_int  =  0.634 +- 0.033, 0.739 +- 0.016, 0.761 +- 0.022, 0.764 +- 0.019

Eval split val
suff++ class all_L1  =  0.952 +- 0.013, 0.886 +- 0.021, 0.935 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.950 +- 0.018, 0.888 +- 0.041, 0.965 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.611 +- 0.019, 0.695 +- 0.015, 0.734 +- 0.028
nec class all_L1  =  0.041 +- 0.013, 0.069 +- 0.005, 0.071 +- 0.017, 0.062 +- 0.015
nec class all_KL  =  0.036 +- 0.015, 0.043 +- 0.003, 0.038 +- 0.007, 0.031 +- 0.010
nec_acc_int  =  0.668 +- 0.008, 0.717 +- 0.029, 0.732 +- 0.025, 0.736 +- 0.024

Eval split test
suff++ class all_L1  =  0.987 +- 0.002, 0.954 +- 0.011, 0.960 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.990 +- 0.001, 0.954 +- 0.018, 0.979 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.543 +- 0.031, 0.588 +- 0.023, 0.631 +- 0.065
nec class all_L1  =  0.013 +- 0.004, 0.029 +- 0.003, 0.042 +- 0.004, 0.039 +- 0.004
nec class all_KL  =  0.009 +- 0.002, 0.019 +- 0.003, 0.023 +- 0.004, 0.022 +- 0.007
nec_acc_int  =  0.561 +- 0.005, 0.589 +- 0.043, 0.639 +- 0.067, 0.645 +- 0.067


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.491 +- 0.003, 0.476 +- 0.009, 0.496 +- 0.006, 0.538 +- 0.008
Faith. Armon (L1)= 		  =  0.063 +- 0.002, 0.146 +- 0.015, 0.144 +- 0.028, 0.141 +- 0.028
Faith. GMean (L1)= 	  =  0.175 +- 0.002, 0.264 +- 0.013, 0.266 +- 0.028, 0.274 +- 0.030
Faith. Aritm (KL)= 		  =  0.483 +- 0.005, 0.459 +- 0.020, 0.493 +- 0.008, 0.521 +- 0.008
Faith. Armon (KL)= 		  =  0.048 +- 0.009, 0.094 +- 0.016, 0.081 +- 0.029, 0.079 +- 0.029
Faith. GMean (KL)= 	  =  0.152 +- 0.013, 0.206 +- 0.013, 0.196 +- 0.039, 0.199 +- 0.041

Eval split val
Faith. Aritm (L1)= 		  =  0.497 +- 0.000, 0.478 +- 0.010, 0.503 +- 0.004, 0.531 +- 0.007
Faith. Armon (L1)= 		  =  0.079 +- 0.023, 0.128 +- 0.009, 0.131 +- 0.029, 0.117 +- 0.026
Faith. GMean (L1)= 	  =  0.196 +- 0.028, 0.247 +- 0.009, 0.255 +- 0.030, 0.248 +- 0.029
Faith. Aritm (KL)= 		  =  0.493 +- 0.001, 0.465 +- 0.020, 0.502 +- 0.002, 0.516 +- 0.005
Faith. Armon (KL)= 		  =  0.069 +- 0.027, 0.082 +- 0.005, 0.072 +- 0.013, 0.060 +- 0.019
Faith. GMean (KL)= 	  =  0.181 +- 0.034, 0.195 +- 0.008, 0.190 +- 0.017, 0.173 +- 0.030

Eval split test
Faith. Aritm (L1)= 		  =  0.500 +- 0.001, 0.492 +- 0.004, 0.501 +- 0.003, 0.519 +- 0.002
Faith. Armon (L1)= 		  =  0.026 +- 0.007, 0.057 +- 0.006, 0.081 +- 0.008, 0.074 +- 0.007
Faith. GMean (L1)= 	  =  0.114 +- 0.016, 0.167 +- 0.008, 0.201 +- 0.009, 0.196 +- 0.010
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.487 +- 0.009, 0.501 +- 0.003, 0.511 +- 0.004
Faith. Armon (KL)= 		  =  0.018 +- 0.004, 0.037 +- 0.006, 0.046 +- 0.008, 0.042 +- 0.014
Faith. GMean (KL)= 	  =  0.094 +- 0.012, 0.133 +- 0.010, 0.151 +- 0.014, 0.145 +- 0.026
Computed for split load_split = id



Completed in  0:04:31.697645  for GSATvGIN GOODHIV/scaffold



DONE GSAT GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 12:17:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 12:17:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9577
Train Loss: 0.1191
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3648
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3804
OOD Validation ACCURACY: 0.7797
OOD Validation Loss: 0.8828
OOD Test ACCURACY: 0.2677
OOD Test Loss: 6.4566

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9471
Train Loss: 0.1505
ID Validation ACCURACY: 0.8906
ID Validation Loss: 0.3662
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3755
OOD Validation ACCURACY: 0.8057
OOD Validation Loss: 0.7317
OOD Test ACCURACY: 0.3631
OOD Test Loss: 4.0084

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.2677 0.8890 0.3631 0.8906 0.8057[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
[1;31mERROR[0m: 04/22/2024 12:17:20 PM - utils.py - line 52 : [1mCUDA out of memory. Tried to allocate 1.60 GiB. GPU 0 has a total capacty of 11.77 GiB of which 474.25 MiB is free. Process 2952675 has 3.92 GiB memory in use. Including non-PyTorch memory, this process has 7.38 GiB memory in use. Of the allocated memory 6.44 GiB is allocated by PyTorch, and 42.56 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 602, in goodtg
    print(f'#E#{e}')

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 15:14:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 03:14:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9577
Train Loss: 0.1191
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3648
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3804
OOD Validation ACCURACY: 0.7797
OOD Validation Loss: 0.8828
OOD Test ACCURACY: 0.2677
OOD Test Loss: 6.4566

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9471
Train Loss: 0.1505
ID Validation ACCURACY: 0.8906
ID Validation Loss: 0.3662
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3755
OOD Validation ACCURACY: 0.8057
OOD Validation Loss: 0.7317
OOD Test ACCURACY: 0.3631
OOD Test Loss: 4.0084

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.2677 0.8890 0.3631 0.8906 0.8057[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
[1;31mERROR[0m: 04/22/2024 03:14:46 PM - utils.py - line 52 : [1mCUDA out of memory. Tried to allocate 1.60 GiB. GPU 1 has a total capacty of 11.77 GiB of which 1.06 GiB is free. Process 2969000 has 1.62 GiB memory in use. Process 2969128 has 3.29 GiB memory in use. Including non-PyTorch memory, this process has 5.79 GiB memory in use. Of the allocated memory 4.85 GiB is allocated by PyTorch, and 44.03 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 609, in goodtg
    print(f'#E#{e}')
Time to compute metrics!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 15:35:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 03:35:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9577
Train Loss: 0.1191
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3648
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3804
OOD Validation ACCURACY: 0.7797
OOD Validation Loss: 0.8828
OOD Test ACCURACY: 0.2677
OOD Test Loss: 6.4566

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9471
Train Loss: 0.1505
ID Validation ACCURACY: 0.8906
ID Validation Loss: 0.3662
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3755
OOD Validation ACCURACY: 0.8057
OOD Validation Loss: 0.7317
OOD Test ACCURACY: 0.3631
OOD Test Loss: 4.0084

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.2677 0.8890 0.3631 0.8906 0.8057[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.453 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 1 = 0.514 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 2 = 0.405 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 3 = 0.474 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 4 = 0.461 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 5 = 0.42 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 6 = 0.477 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 7 = 0.519 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 8 = 0.516 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 9 = 0.513 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all KL = 0.452 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all L1 = 0.477 +- 0.179 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.177
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
SUFF++ for r=0.6 class 0 = 0.291 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1 = 0.299 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 2 = 0.355 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 3 = 0.367 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 4 = 0.275 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 5 = 0.304 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 6 = 0.313 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 7 = 0.294 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 8 = 0.294 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 9 = 0.291 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.206 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.309 +- 0.106 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.39
SUFF++ for r=0.9 class 0 = 0.274 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 1 = 0.324 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 2 = 0.314 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 3 = 0.317 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 4 = 0.302 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 5 = 0.293 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 6 = 0.305 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 7 = 0.639 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 8 = 0.321 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 9 = 0.328 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 all KL = 0.113 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 all L1 = 0.345 +- 0.157 (in-sample avg dev_std = 0.737)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.511 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 1 = 0.504 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 2 = 0.392 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 3 = 0.48 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 4 = 0.429 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 5 = 0.456 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 6 = 0.504 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 7 = 0.529 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 8 = 0.464 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 9 = 0.542 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all KL = 0.46 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all L1 = 0.482 +- 0.188 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.269 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 1 = 0.264 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 2 = 0.284 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 3 = 0.271 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 4 = 0.269 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 5 = 0.282 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 6 = 0.283 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 7 = 0.265 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 8 = 0.285 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 9 = 0.27 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all KL = 0.122 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all L1 = 0.274 +- 0.079 (in-sample avg dev_std = 0.510)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.27
SUFF++ for r=0.9 class 0 = 0.265 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 1 = 0.318 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 2 = 0.332 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 3 = 0.297 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 4 = 0.301 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 5 = 0.291 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 6 = 0.288 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 7 = 0.418 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 8 = 0.279 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 9 = 0.321 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 all KL = 0.101 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 all L1 = 0.312 +- 0.115 (in-sample avg dev_std = 0.649)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.471 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 1 = 0.511 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 2 = 0.399 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 3 = 0.402 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 4 = 0.41 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 5 = 0.445 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 6 = 0.421 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 7 = 0.454 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 8 = 0.43 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 9 = 0.443 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all KL = 0.379 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all L1 = 0.439 +- 0.177 (in-sample avg dev_std = 0.465)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.1
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.103
SUFF++ for r=0.6 class 0 = 0.275 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1 = 0.348 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 2 = 0.275 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 3 = 0.265 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 4 = 0.272 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 5 = 0.282 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 6 = 0.281 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 7 = 0.295 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 8 = 0.277 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 9 = 0.265 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.128 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.284 +- 0.092 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.159
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.138
SUFF++ for r=0.9 class 0 = 0.339 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 1 = 0.325 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 2 = 0.395 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 3 = 0.371 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 4 = 0.3 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 5 = 0.309 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 6 = 0.303 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 7 = 0.295 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 8 = 0.28 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 9 = 0.282 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 all KL = 0.149 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 all L1 = 0.321 +- 0.151 (in-sample avg dev_std = 0.492)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.611 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 1 = 0.474 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 2 = 0.578 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 3 = 0.535 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 4 = 0.494 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 5 = 0.571 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 6 = 0.496 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 7 = 0.512 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 8 = 0.495 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 9 = 0.435 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 all KL = 0.549 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 all L1 = 0.52 +- 0.204 (in-sample avg dev_std = 0.406)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.177
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.671 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 1 = 0.7 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 2 = 0.626 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 3 = 0.608 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 4 = 0.675 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 5 = 0.642 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 6 = 0.643 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 7 = 0.641 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 8 = 0.687 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 9 = 0.642 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 all KL = 0.728 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 all L1 = 0.654 +- 0.120 (in-sample avg dev_std = 0.380)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.668
NEC for r=0.9 class 0 = 0.483 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 1 = 0.364 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 2 = 0.396 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 3 = 0.432 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 4 = 0.409 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 5 = 0.459 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 6 = 0.525 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 7 = 0.398 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 8 = 0.321 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 9 = 0.526 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all KL = 0.578 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all L1 = 0.429 +- 0.245 (in-sample avg dev_std = 0.467)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.098 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 1 = 0.061 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 2 = 0.301 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 3 = 0.252 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 4 = 0.175 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 5 = 0.308 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 6 = 0.282 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 7 = 0.2 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 8 = 0.214 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 9 = 0.266 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all KL = 0.296 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all L1 = 0.212 +- 0.231 (in-sample avg dev_std = 0.342)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
NEC for r=0.3 class 0 = 0.547 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 1 = 0.522 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 2 = 0.622 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 3 = 0.556 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 4 = 0.552 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 5 = 0.573 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 6 = 0.501 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 7 = 0.481 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 8 = 0.508 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 9 = 0.465 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all KL = 0.563 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all L1 = 0.531 +- 0.186 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.121
NEC for r=0.6 class 0 = 0.662 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 1 = 0.68 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 2 = 0.593 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 3 = 0.638 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 4 = 0.628 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 5 = 0.581 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 6 = 0.66 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 7 = 0.654 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 8 = 0.637 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 9 = 0.617 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all KL = 0.743 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all L1 = 0.637 +- 0.154 (in-sample avg dev_std = 0.420)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.465
NEC for r=0.9 class 0 = 0.566 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 1 = 0.356 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 2 = 0.445 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 3 = 0.499 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 4 = 0.479 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 5 = 0.558 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 6 = 0.675 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 7 = 0.477 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 8 = 0.599 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 9 = 0.61 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 all KL = 0.634 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 all L1 = 0.523 +- 0.233 (in-sample avg dev_std = 0.452)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.803
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.71
NEC for r=1.0 class 0 = 0.237 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 1 = 0.112 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 2 = 0.26 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 3 = 0.35 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 4 = 0.284 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 5 = 0.406 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 6 = 0.45 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 7 = 0.21 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 8 = 0.49 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 9 = 0.429 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all KL = 0.383 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all L1 = 0.318 +- 0.258 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
NEC for r=0.3 class 0 = 0.535 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 1 = 0.501 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 2 = 0.594 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 3 = 0.55 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 4 = 0.516 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 5 = 0.54 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 6 = 0.557 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 7 = 0.525 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 8 = 0.554 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 9 = 0.53 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all KL = 0.573 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all L1 = 0.54 +- 0.195 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.1
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.11
NEC for r=0.6 class 0 = 0.712 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 1 = 0.652 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 2 = 0.676 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 3 = 0.677 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 4 = 0.63 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 5 = 0.654 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 6 = 0.667 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 7 = 0.632 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 8 = 0.702 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 9 = 0.627 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all KL = 0.776 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all L1 = 0.663 +- 0.162 (in-sample avg dev_std = 0.378)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.159
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.226
NEC for r=0.9 class 0 = 0.671 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 1 = 0.579 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 2 = 0.61 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 3 = 0.608 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 4 = 0.733 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 5 = 0.666 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 6 = 0.701 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 7 = 0.723 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 8 = 0.699 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 9 = 0.748 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all KL = 0.786 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all L1 = 0.672 +- 0.199 (in-sample avg dev_std = 0.397)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.273
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.327
NEC for r=1.0 class 0 = 0.474 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 1 = 0.459 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 2 = 0.601 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 3 = 0.589 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 4 = 0.652 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 5 = 0.644 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 6 = 0.683 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 7 = 0.667 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 8 = 0.649 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 9 = 0.71 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all KL = 0.692 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all L1 = 0.61 +- 0.241 (in-sample avg dev_std = 0.325)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 15:58:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 03:58:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 03:58:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 0.9525
Train Loss: 0.1347
ID Validation ACCURACY: 0.8934
ID Validation Loss: 0.3753
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4006
OOD Validation ACCURACY: 0.7796
OOD Validation Loss: 0.9275
OOD Test ACCURACY: 0.2351
OOD Test Loss: 6.0508

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9504
Train Loss: 0.1404
ID Validation ACCURACY: 0.8880
ID Validation Loss: 0.3623
ID Test ACCURACY: 0.8880
ID Test Loss: 0.3744
OOD Validation ACCURACY: 0.8044
OOD Validation Loss: 0.7478
OOD Test ACCURACY: 0.2784
OOD Test Loss: 5.7807

[0m[1;37mINFO[0m: [1mChartInfo 0.8850 0.2351 0.8880 0.2784 0.8880 0.8044[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.123
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.589 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 1 = 0.554 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 2 = 0.678 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 3 = 0.653 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 4 = 0.588 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 5 = 0.647 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 6 = 0.581 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 7 = 0.643 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 8 = 0.558 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 9 = 0.573 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 all KL = 0.651 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 all L1 = 0.606 +- 0.199 (in-sample avg dev_std = 0.352)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.149
SUFF++ for r=0.6 class 0 = 0.308 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 1 = 0.302 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 2 = 0.466 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 3 = 0.421 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 4 = 0.417 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 5 = 0.464 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 6 = 0.347 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 7 = 0.476 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 8 = 0.314 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 9 = 0.382 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all KL = 0.309 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all L1 = 0.389 +- 0.171 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.396
SUFF++ for r=0.9 class 0 = 0.292 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 1 = 0.367 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 2 = 0.313 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 3 = 0.354 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 4 = 0.3 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 5 = 0.289 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 6 = 0.322 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 7 = 0.554 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 8 = 0.32 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 9 = 0.464 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 all KL = 0.119 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 all L1 = 0.361 +- 0.155 (in-sample avg dev_std = 0.719)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.472 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 1 = 0.592 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 3 = 0.515 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 4 = 0.505 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 5 = 0.543 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 6 = 0.474 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 7 = 0.534 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 8 = 0.495 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 9 = 0.532 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all KL = 0.55 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all L1 = 0.522 +- 0.176 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.137
SUFF++ for r=0.6 class 0 = 0.272 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 1 = 0.318 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 2 = 0.305 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 3 = 0.318 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 4 = 0.301 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 5 = 0.335 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 6 = 0.306 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 7 = 0.369 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 8 = 0.284 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 9 = 0.293 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all KL = 0.2 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all L1 = 0.31 +- 0.132 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.303
SUFF++ for r=0.9 class 0 = 0.26 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 1 = 0.473 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 2 = 0.298 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 3 = 0.295 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 4 = 0.268 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 5 = 0.266 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 6 = 0.298 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 7 = 0.4 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 8 = 0.297 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 9 = 0.323 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 all KL = 0.081 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 all L1 = 0.321 +- 0.130 (in-sample avg dev_std = 0.657)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.387 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 1 = 0.439 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 2 = 0.405 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 3 = 0.399 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 4 = 0.33 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 5 = 0.374 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 6 = 0.368 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 7 = 0.421 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 8 = 0.409 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 9 = 0.376 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all KL = 0.336 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all L1 = 0.392 +- 0.182 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.157
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.126
SUFF++ for r=0.6 class 0 = 0.266 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 1 = 0.307 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 2 = 0.273 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 3 = 0.273 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 4 = 0.238 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 5 = 0.278 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 6 = 0.257 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 7 = 0.257 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 8 = 0.273 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 9 = 0.253 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all KL = 0.112 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all L1 = 0.268 +- 0.128 (in-sample avg dev_std = 0.539)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.228
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.172
SUFF++ for r=0.9 class 0 = 0.257 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 1 = 0.445 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 2 = 0.28 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 3 = 0.287 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 4 = 0.333 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 5 = 0.283 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 6 = 0.287 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 7 = 0.303 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 8 = 0.27 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 9 = 0.286 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 all KL = 0.064 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 all L1 = 0.305 +- 0.124 (in-sample avg dev_std = 0.632)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.123
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.359 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.383 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.281 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 3 = 0.347 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 4 = 0.39 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 5 = 0.321 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 6 = 0.389 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 7 = 0.324 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 8 = 0.449 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 9 = 0.424 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.311 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.366 +- 0.235 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.158
NEC for r=0.6 class 0 = 0.659 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.613 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.53 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 3 = 0.562 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 4 = 0.504 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 5 = 0.472 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 6 = 0.586 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 7 = 0.43 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 8 = 0.677 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 9 = 0.562 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.62 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.56 +- 0.209 (in-sample avg dev_std = 0.399)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.676
NEC for r=0.9 class 0 = 0.419 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 1 = 0.165 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 2 = 0.49 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 3 = 0.394 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 4 = 0.412 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 5 = 0.574 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 6 = 0.497 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 7 = 0.243 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 8 = 0.295 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 9 = 0.538 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all KL = 0.52 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all L1 = 0.395 +- 0.261 (in-sample avg dev_std = 0.443)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0 = 0.098 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 1 = 0.019 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 2 = 0.317 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 3 = 0.333 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 4 = 0.174 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 5 = 0.384 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 6 = 0.255 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 7 = 0.181 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 8 = 0.182 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 9 = 0.342 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all KL = 0.311 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all L1 = 0.224 +- 0.248 (in-sample avg dev_std = 0.345)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
NEC for r=0.3 class 0 = 0.49 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1 = 0.379 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 2 = 0.399 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 3 = 0.472 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 4 = 0.447 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 5 = 0.345 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 6 = 0.485 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 7 = 0.432 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 8 = 0.455 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 9 = 0.435 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.395 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.434 +- 0.227 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 0 = 0.634 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.608 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.652 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 3 = 0.629 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 4 = 0.623 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 5 = 0.649 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 6 = 0.641 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 7 = 0.61 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 8 = 0.651 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 9 = 0.655 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.744 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.634 +- 0.173 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.524
NEC for r=0.9 class 0 = 0.461 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 1 = 0.158 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 2 = 0.487 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 3 = 0.489 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 4 = 0.569 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 5 = 0.576 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 6 = 0.624 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 7 = 0.417 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 8 = 0.516 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 9 = 0.612 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 all KL = 0.604 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 all L1 = 0.485 +- 0.249 (in-sample avg dev_std = 0.449)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.788
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.724
NEC for r=1.0 class 0 = 0.207 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 1 = 0.044 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 2 = 0.357 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 3 = 0.425 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 4 = 0.365 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 5 = 0.364 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 6 = 0.36 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 7 = 0.23 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 8 = 0.355 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 9 = 0.399 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all KL = 0.364 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all L1 = 0.307 +- 0.261 (in-sample avg dev_std = 0.367)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.127
NEC for r=0.3 class 0 = 0.616 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1 = 0.508 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 2 = 0.585 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 3 = 0.617 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 4 = 0.673 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 5 = 0.603 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 6 = 0.638 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 7 = 0.601 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 8 = 0.55 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 9 = 0.632 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.65 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.601 +- 0.214 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.157
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.166
NEC for r=0.6 class 0 = 0.706 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.365 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.706 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 3 = 0.724 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 4 = 0.739 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 5 = 0.663 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 6 = 0.664 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 7 = 0.705 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 8 = 0.692 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 9 = 0.717 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.823 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.665 +- 0.212 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.228
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.278
NEC for r=0.9 class 0 = 0.708 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.3 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.576 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 3 = 0.648 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 4 = 0.493 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 5 = 0.612 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 6 = 0.636 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 7 = 0.642 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 8 = 0.616 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 9 = 0.629 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.767 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.583 +- 0.239 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.237
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.326
NEC for r=1.0 class 0 = 0.598 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 1 = 0.463 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 2 = 0.539 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 3 = 0.605 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 4 = 0.494 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 5 = 0.515 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 6 = 0.588 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 7 = 0.6 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 8 = 0.592 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 9 = 0.561 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all KL = 0.685 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all L1 = 0.555 +- 0.216 (in-sample avg dev_std = 0.381)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:20:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:20:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9563
Train Loss: 0.1251
ID Validation ACCURACY: 0.8953
ID Validation Loss: 0.3825
ID Test ACCURACY: 0.8890
ID Test Loss: 0.4034
OOD Validation ACCURACY: 0.7610
OOD Validation Loss: 1.0349
OOD Test ACCURACY: 0.3757
OOD Test Loss: 4.5211

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 165...
[0m[1;37mINFO[0m: [1mCheckpoint 165: 
-----------------------------------
Train ACCURACY: 0.9359
Train Loss: 0.1833
ID Validation ACCURACY: 0.8829
ID Validation Loss: 0.4135
ID Test ACCURACY: 0.8829
ID Test Loss: 0.4120
OOD Validation ACCURACY: 0.8049
OOD Validation Loss: 0.7120
OOD Test ACCURACY: 0.3070
OOD Test Loss: 5.3571

[0m[1;37mINFO[0m: [1mChartInfo 0.8890 0.3757 0.8829 0.3070 0.8829 0.8049[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.409 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 1 = 0.466 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 2 = 0.403 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 3 = 0.47 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 4 = 0.46 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 5 = 0.495 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 6 = 0.445 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 7 = 0.484 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 8 = 0.486 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 9 = 0.507 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all KL = 0.387 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all L1 = 0.462 +- 0.156 (in-sample avg dev_std = 0.523)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
SUFF++ for r=0.6 class 0 = 0.31 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 1 = 0.473 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 2 = 0.408 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 3 = 0.458 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 4 = 0.369 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 5 = 0.509 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 6 = 0.367 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 7 = 0.425 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 8 = 0.363 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 9 = 0.43 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 all KL = 0.285 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 all L1 = 0.411 +- 0.203 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.786
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.37
SUFF++ for r=0.9 class 0 = 0.296 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 1 = 0.305 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 2 = 0.36 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 3 = 0.285 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 4 = 0.323 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 5 = 0.29 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 6 = 0.312 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 7 = 0.718 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 8 = 0.303 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 9 = 0.363 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 all KL = 0.137 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 all L1 = 0.359 +- 0.187 (in-sample avg dev_std = 0.704)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.456 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 1 = 0.463 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 2 = 0.452 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 3 = 0.472 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 4 = 0.472 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 5 = 0.506 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 6 = 0.481 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 7 = 0.517 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 8 = 0.487 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 9 = 0.535 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all KL = 0.483 +- 0.265 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all L1 = 0.484 +- 0.154 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.166
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.298 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.322 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.288 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 3 = 0.32 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 4 = 0.272 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 5 = 0.312 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 6 = 0.296 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 7 = 0.296 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 8 = 0.326 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 9 = 0.293 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.158 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.302 +- 0.135 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.555
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.293
SUFF++ for r=0.9 class 0 = 0.292 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 1 = 0.451 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 2 = 0.343 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 3 = 0.295 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 4 = 0.319 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 5 = 0.3 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 6 = 0.331 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 7 = 0.527 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 8 = 0.27 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 9 = 0.321 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 all KL = 0.145 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 all L1 = 0.348 +- 0.166 (in-sample avg dev_std = 0.621)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.519 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 1 = 0.407 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 2 = 0.508 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 3 = 0.499 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 4 = 0.485 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 5 = 0.484 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 6 = 0.494 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 7 = 0.513 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 8 = 0.541 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 9 = 0.447 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 all KL = 0.503 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 all L1 = 0.489 +- 0.164 (in-sample avg dev_std = 0.457)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
SUFF++ for r=0.6 class 0 = 0.319 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 1 = 0.325 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 2 = 0.271 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 3 = 0.306 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 4 = 0.27 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 5 = 0.296 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 6 = 0.32 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 7 = 0.299 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 8 = 0.325 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 9 = 0.303 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all KL = 0.146 +- 0.171 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all L1 = 0.304 +- 0.138 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.235
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.202
SUFF++ for r=0.9 class 0 = 0.333 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 1 = 0.691 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 2 = 0.438 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 3 = 0.414 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 4 = 0.398 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 5 = 0.432 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 6 = 0.371 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 7 = 0.411 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 8 = 0.37 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 9 = 0.351 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 all KL = 0.22 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 all L1 = 0.424 +- 0.211 (in-sample avg dev_std = 0.531)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.121
NEC for r=0.3 class 0 = 0.519 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 1 = 0.424 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 2 = 0.493 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 3 = 0.517 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 4 = 0.509 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 5 = 0.384 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 6 = 0.492 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 7 = 0.42 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 8 = 0.544 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 9 = 0.456 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all KL = 0.538 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all L1 = 0.476 +- 0.248 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
NEC for r=0.6 class 0 = 0.62 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.461 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.496 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 3 = 0.497 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 4 = 0.599 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 5 = 0.392 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 6 = 0.55 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 7 = 0.505 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 8 = 0.578 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 9 = 0.527 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.601 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.523 +- 0.241 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.786
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0 = 0.448 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 1 = 0.201 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 2 = 0.301 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 3 = 0.519 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 4 = 0.453 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 5 = 0.563 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 6 = 0.496 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 7 = 0.299 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 8 = 0.36 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 9 = 0.556 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 all KL = 0.558 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 all L1 = 0.413 +- 0.260 (in-sample avg dev_std = 0.462)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.855
NEC for r=1.0 class 0 = 0.063 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 1 = 0.008 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 2 = 0.235 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 3 = 0.282 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 4 = 0.224 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 5 = 0.365 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 6 = 0.206 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 7 = 0.161 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 8 = 0.169 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 9 = 0.298 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all KL = 0.285 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all L1 = 0.196 +- 0.232 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
NEC for r=0.3 class 0 = 0.504 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 1 = 0.499 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 2 = 0.51 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 3 = 0.516 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 4 = 0.486 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 5 = 0.45 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 6 = 0.484 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 7 = 0.473 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 8 = 0.522 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 9 = 0.454 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 all KL = 0.49 +- 0.299 (in-sample avg dev_std = 0.392)
NEC for r=0.3 all L1 = 0.49 +- 0.214 (in-sample avg dev_std = 0.392)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.166
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
NEC for r=0.6 class 0 = 0.676 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 1 = 0.608 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 2 = 0.603 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 3 = 0.582 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 4 = 0.669 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 5 = 0.629 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 6 = 0.628 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 7 = 0.625 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 8 = 0.637 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 9 = 0.654 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all KL = 0.748 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all L1 = 0.631 +- 0.168 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.555
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.473
NEC for r=0.9 class 0 = 0.531 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 1 = 0.248 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 2 = 0.454 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 3 = 0.564 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 4 = 0.575 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 5 = 0.542 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 6 = 0.602 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 7 = 0.455 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 8 = 0.593 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 9 = 0.615 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 all KL = 0.643 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 all L1 = 0.514 +- 0.242 (in-sample avg dev_std = 0.459)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.78
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.716
NEC for r=1.0 class 0 = 0.199 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 1 = 0.033 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 2 = 0.304 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 3 = 0.384 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 4 = 0.356 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 5 = 0.43 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 6 = 0.384 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 7 = 0.194 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 8 = 0.391 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 9 = 0.428 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 all KL = 0.379 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 all L1 = 0.305 +- 0.264 (in-sample avg dev_std = 0.389)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.478 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 1 = 0.487 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 2 = 0.469 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 3 = 0.496 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 4 = 0.473 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 5 = 0.497 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 6 = 0.447 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 7 = 0.473 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 8 = 0.485 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 9 = 0.488 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all KL = 0.448 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all L1 = 0.479 +- 0.196 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.141
NEC for r=0.6 class 0 = 0.633 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 1 = 0.447 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 2 = 0.661 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 3 = 0.606 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 4 = 0.628 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 5 = 0.617 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 6 = 0.565 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 7 = 0.594 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 8 = 0.566 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 9 = 0.518 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 all KL = 0.703 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 all L1 = 0.582 +- 0.209 (in-sample avg dev_std = 0.454)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.235
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.257
NEC for r=0.9 class 0 = 0.646 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.153 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.478 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.513 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.513 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.556 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.538 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.568 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.56 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.567 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.625 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.505 +- 0.268 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.382
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.386
NEC for r=1.0 class 0 = 0.522 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 1 = 0.057 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 2 = 0.299 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 3 = 0.472 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 4 = 0.505 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 5 = 0.518 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 6 = 0.51 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 7 = 0.421 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 8 = 0.485 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 9 = 0.508 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all KL = 0.504 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all L1 = 0.423 +- 0.284 (in-sample avg dev_std = 0.380)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:43:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:07 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:43:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;31mERROR[0m: 04/22/2024 04:43:08 PM - utils.py - line 52 : [1mCheckpoint not found at /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/checkpoints/round4/GOODCMNIST_color_covariate/repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.7/best.ckpt
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 606, in goodtg
    def goodtg():
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 506, in main
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 283, in evaluate_metric
    ood_algorithm = load_ood_alg(config.ood.ood_alg, config)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1364, in load_task
    test_score, test_loss = self.config_model('test', load_param=load_param, load_split=load_split)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1394, in config_model
    print(f'#E#Checkpoint not found at {os.path.abspath(self.config.test_ckpt)}')
Time to compute metrics!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 16:47:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 04:47:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9577
Train Loss: 0.1191
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3648
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3804
OOD Validation ACCURACY: 0.7797
OOD Validation Loss: 0.8828
OOD Test ACCURACY: 0.2677
OOD Test Loss: 6.4566

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9471
Train Loss: 0.1505
ID Validation ACCURACY: 0.8906
ID Validation Loss: 0.3662
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3755
OOD Validation ACCURACY: 0.8057
OOD Validation Loss: 0.7317
OOD Test ACCURACY: 0.3631
OOD Test Loss: 4.0084

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.2677 0.8890 0.3631 0.8906 0.8057[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.453 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 1 = 0.514 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 2 = 0.405 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 3 = 0.474 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 4 = 0.461 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 5 = 0.42 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 6 = 0.477 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 7 = 0.519 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 8 = 0.516 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 9 = 0.513 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all KL = 0.452 +- 0.256 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all L1 = 0.477 +- 0.179 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.177
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
SUFF++ for r=0.6 class 0 = 0.291 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1 = 0.299 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 2 = 0.355 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 3 = 0.367 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 4 = 0.275 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 5 = 0.304 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 6 = 0.313 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 7 = 0.294 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 8 = 0.294 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 9 = 0.291 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.206 +- 0.172 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.309 +- 0.106 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.39
SUFF++ for r=0.9 class 0 = 0.274 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 1 = 0.324 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 2 = 0.314 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 3 = 0.317 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 4 = 0.302 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 5 = 0.293 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 6 = 0.305 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 7 = 0.639 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 8 = 0.321 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 class 9 = 0.328 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 all KL = 0.113 +- 0.207 (in-sample avg dev_std = 0.737)
SUFF++ for r=0.9 all L1 = 0.345 +- 0.157 (in-sample avg dev_std = 0.737)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.511 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 1 = 0.504 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 2 = 0.392 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 3 = 0.48 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 4 = 0.429 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 5 = 0.456 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 6 = 0.504 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 7 = 0.529 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 8 = 0.464 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 9 = 0.542 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all KL = 0.46 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all L1 = 0.482 +- 0.188 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.269 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 1 = 0.264 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 2 = 0.284 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 3 = 0.271 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 4 = 0.269 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 5 = 0.282 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 6 = 0.283 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 7 = 0.265 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 8 = 0.285 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 9 = 0.27 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all KL = 0.122 +- 0.122 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all L1 = 0.274 +- 0.079 (in-sample avg dev_std = 0.510)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.27
SUFF++ for r=0.9 class 0 = 0.265 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 1 = 0.318 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 2 = 0.332 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 3 = 0.297 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 4 = 0.301 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 5 = 0.291 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 6 = 0.288 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 7 = 0.418 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 8 = 0.279 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 class 9 = 0.321 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 all KL = 0.101 +- 0.134 (in-sample avg dev_std = 0.649)
SUFF++ for r=0.9 all L1 = 0.312 +- 0.115 (in-sample avg dev_std = 0.649)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.471 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 1 = 0.511 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 2 = 0.399 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 3 = 0.402 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 4 = 0.41 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 5 = 0.445 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 6 = 0.421 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 7 = 0.454 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 8 = 0.43 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 9 = 0.443 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all KL = 0.379 +- 0.260 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all L1 = 0.439 +- 0.177 (in-sample avg dev_std = 0.465)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.1
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.103
SUFF++ for r=0.6 class 0 = 0.275 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1 = 0.348 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 2 = 0.275 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 3 = 0.265 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 4 = 0.272 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 5 = 0.282 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 6 = 0.281 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 7 = 0.295 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 8 = 0.277 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 9 = 0.265 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.128 +- 0.135 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.284 +- 0.092 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.159
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.138
SUFF++ for r=0.9 class 0 = 0.339 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 1 = 0.325 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 2 = 0.395 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 3 = 0.371 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 4 = 0.3 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 5 = 0.309 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 6 = 0.303 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 7 = 0.295 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 8 = 0.28 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 9 = 0.282 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 all KL = 0.149 +- 0.172 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 all L1 = 0.321 +- 0.151 (in-sample avg dev_std = 0.492)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.611 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 1 = 0.474 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 2 = 0.578 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 3 = 0.535 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 4 = 0.494 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 5 = 0.571 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 6 = 0.496 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 7 = 0.512 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 8 = 0.495 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 9 = 0.435 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 all KL = 0.549 +- 0.288 (in-sample avg dev_std = 0.406)
NEC for r=0.3 all L1 = 0.52 +- 0.204 (in-sample avg dev_std = 0.406)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.177
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.671 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 1 = 0.7 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 2 = 0.626 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 3 = 0.608 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 4 = 0.675 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 5 = 0.642 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 6 = 0.643 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 7 = 0.641 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 8 = 0.687 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 9 = 0.642 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 all KL = 0.728 +- 0.193 (in-sample avg dev_std = 0.380)
NEC for r=0.6 all L1 = 0.654 +- 0.120 (in-sample avg dev_std = 0.380)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.668
NEC for r=0.9 class 0 = 0.483 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 1 = 0.364 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 2 = 0.396 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 3 = 0.432 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 4 = 0.409 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 5 = 0.459 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 6 = 0.525 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 7 = 0.398 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 8 = 0.321 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 9 = 0.526 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all KL = 0.578 +- 0.298 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all L1 = 0.429 +- 0.245 (in-sample avg dev_std = 0.467)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.098 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 1 = 0.061 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 2 = 0.301 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 3 = 0.252 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 4 = 0.175 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 5 = 0.308 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 6 = 0.282 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 7 = 0.2 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 8 = 0.214 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 9 = 0.266 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all KL = 0.296 +- 0.301 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all L1 = 0.212 +- 0.231 (in-sample avg dev_std = 0.342)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
NEC for r=0.3 class 0 = 0.547 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 1 = 0.522 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 2 = 0.622 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 3 = 0.556 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 4 = 0.552 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 5 = 0.573 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 6 = 0.501 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 7 = 0.481 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 8 = 0.508 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 9 = 0.465 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all KL = 0.563 +- 0.280 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all L1 = 0.531 +- 0.186 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.121
NEC for r=0.6 class 0 = 0.662 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 1 = 0.68 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 2 = 0.593 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 3 = 0.638 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 4 = 0.628 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 5 = 0.581 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 6 = 0.66 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 7 = 0.654 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 8 = 0.637 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 9 = 0.617 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all KL = 0.743 +- 0.208 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all L1 = 0.637 +- 0.154 (in-sample avg dev_std = 0.420)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.465
NEC for r=0.9 class 0 = 0.566 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 1 = 0.356 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 2 = 0.445 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 3 = 0.499 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 4 = 0.479 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 5 = 0.558 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 6 = 0.675 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 7 = 0.477 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 8 = 0.599 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 9 = 0.61 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 all KL = 0.634 +- 0.287 (in-sample avg dev_std = 0.452)
NEC for r=0.9 all L1 = 0.523 +- 0.233 (in-sample avg dev_std = 0.452)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.803
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.71
NEC for r=1.0 class 0 = 0.237 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 1 = 0.112 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 2 = 0.26 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 3 = 0.35 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 4 = 0.284 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 5 = 0.406 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 6 = 0.45 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 7 = 0.21 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 8 = 0.49 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 9 = 0.429 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all KL = 0.383 +- 0.314 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all L1 = 0.318 +- 0.258 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
NEC for r=0.3 class 0 = 0.535 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 1 = 0.501 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 2 = 0.594 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 3 = 0.55 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 4 = 0.516 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 5 = 0.54 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 6 = 0.557 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 7 = 0.525 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 8 = 0.554 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 9 = 0.53 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all KL = 0.573 +- 0.284 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all L1 = 0.54 +- 0.195 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.1
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.11
NEC for r=0.6 class 0 = 0.712 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 1 = 0.652 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 2 = 0.676 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 3 = 0.677 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 4 = 0.63 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 5 = 0.654 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 6 = 0.667 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 7 = 0.632 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 8 = 0.702 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 9 = 0.627 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all KL = 0.776 +- 0.222 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all L1 = 0.663 +- 0.162 (in-sample avg dev_std = 0.378)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.159
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.226
NEC for r=0.9 class 0 = 0.671 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 1 = 0.579 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 2 = 0.61 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 3 = 0.608 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 4 = 0.733 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 5 = 0.666 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 6 = 0.701 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 7 = 0.723 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 8 = 0.699 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 9 = 0.748 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all KL = 0.786 +- 0.252 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all L1 = 0.672 +- 0.199 (in-sample avg dev_std = 0.397)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.273
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.327
NEC for r=1.0 class 0 = 0.474 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 1 = 0.459 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 2 = 0.601 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 3 = 0.589 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 4 = 0.652 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 5 = 0.644 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 6 = 0.683 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 7 = 0.667 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 8 = 0.649 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 9 = 0.71 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all KL = 0.692 +- 0.310 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all L1 = 0.61 +- 0.241 (in-sample avg dev_std = 0.325)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 17:10:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:00 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 05:11:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 0.9525
Train Loss: 0.1347
ID Validation ACCURACY: 0.8934
ID Validation Loss: 0.3753
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4006
OOD Validation ACCURACY: 0.7796
OOD Validation Loss: 0.9275
OOD Test ACCURACY: 0.2351
OOD Test Loss: 6.0508

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9504
Train Loss: 0.1404
ID Validation ACCURACY: 0.8880
ID Validation Loss: 0.3623
ID Test ACCURACY: 0.8880
ID Test Loss: 0.3744
OOD Validation ACCURACY: 0.8044
OOD Validation Loss: 0.7478
OOD Test ACCURACY: 0.2784
OOD Test Loss: 5.7807

[0m[1;37mINFO[0m: [1mChartInfo 0.8850 0.2351 0.8880 0.2784 0.8880 0.8044[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.123
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.589 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 1 = 0.554 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 2 = 0.678 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 3 = 0.653 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 4 = 0.588 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 5 = 0.647 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 6 = 0.581 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 7 = 0.643 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 8 = 0.558 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 9 = 0.573 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 all KL = 0.651 +- 0.241 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 all L1 = 0.606 +- 0.199 (in-sample avg dev_std = 0.352)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.149
SUFF++ for r=0.6 class 0 = 0.308 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 1 = 0.302 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 2 = 0.466 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 3 = 0.421 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 4 = 0.417 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 5 = 0.464 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 6 = 0.347 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 7 = 0.476 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 8 = 0.314 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 class 9 = 0.382 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all KL = 0.309 +- 0.247 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.6 all L1 = 0.389 +- 0.171 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.396
SUFF++ for r=0.9 class 0 = 0.292 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 1 = 0.367 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 2 = 0.313 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 3 = 0.354 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 4 = 0.3 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 5 = 0.289 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 6 = 0.322 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 7 = 0.554 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 8 = 0.32 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 class 9 = 0.464 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 all KL = 0.119 +- 0.181 (in-sample avg dev_std = 0.719)
SUFF++ for r=0.9 all L1 = 0.361 +- 0.155 (in-sample avg dev_std = 0.719)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.472 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 1 = 0.592 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 3 = 0.515 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 4 = 0.505 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 5 = 0.543 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 6 = 0.474 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 7 = 0.534 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 8 = 0.495 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 9 = 0.532 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all KL = 0.55 +- 0.260 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all L1 = 0.522 +- 0.176 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.137
SUFF++ for r=0.6 class 0 = 0.272 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 1 = 0.318 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 2 = 0.305 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 3 = 0.318 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 4 = 0.301 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 5 = 0.335 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 6 = 0.306 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 7 = 0.369 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 8 = 0.284 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 9 = 0.293 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all KL = 0.2 +- 0.199 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all L1 = 0.31 +- 0.132 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.303
SUFF++ for r=0.9 class 0 = 0.26 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 1 = 0.473 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 2 = 0.298 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 3 = 0.295 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 4 = 0.268 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 5 = 0.266 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 6 = 0.298 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 7 = 0.4 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 8 = 0.297 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 class 9 = 0.323 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 all KL = 0.081 +- 0.118 (in-sample avg dev_std = 0.657)
SUFF++ for r=0.9 all L1 = 0.321 +- 0.130 (in-sample avg dev_std = 0.657)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.387 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 1 = 0.439 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 2 = 0.405 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 3 = 0.399 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 4 = 0.33 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 5 = 0.374 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 6 = 0.368 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 7 = 0.421 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 8 = 0.409 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 9 = 0.376 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all KL = 0.336 +- 0.290 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all L1 = 0.392 +- 0.182 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.157
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.126
SUFF++ for r=0.6 class 0 = 0.266 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 1 = 0.307 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 2 = 0.273 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 3 = 0.273 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 4 = 0.238 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 5 = 0.278 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 6 = 0.257 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 7 = 0.257 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 8 = 0.273 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 9 = 0.253 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all KL = 0.112 +- 0.177 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all L1 = 0.268 +- 0.128 (in-sample avg dev_std = 0.539)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.228
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.172
SUFF++ for r=0.9 class 0 = 0.257 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 1 = 0.445 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 2 = 0.28 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 3 = 0.287 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 4 = 0.333 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 5 = 0.283 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 6 = 0.287 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 7 = 0.303 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 8 = 0.27 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 class 9 = 0.286 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 all KL = 0.064 +- 0.091 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.9 all L1 = 0.305 +- 0.124 (in-sample avg dev_std = 0.632)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.123
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.359 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.383 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.281 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 3 = 0.347 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 4 = 0.39 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 5 = 0.321 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 6 = 0.389 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 7 = 0.324 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 8 = 0.449 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 9 = 0.424 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.311 +- 0.270 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.366 +- 0.235 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.158
NEC for r=0.6 class 0 = 0.659 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.613 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.53 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 3 = 0.562 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 4 = 0.504 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 5 = 0.472 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 6 = 0.586 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 7 = 0.43 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 8 = 0.677 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 9 = 0.562 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.62 +- 0.281 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.56 +- 0.209 (in-sample avg dev_std = 0.399)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.676
NEC for r=0.9 class 0 = 0.419 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 1 = 0.165 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 2 = 0.49 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 3 = 0.394 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 4 = 0.412 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 5 = 0.574 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 6 = 0.497 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 7 = 0.243 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 8 = 0.295 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 9 = 0.538 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all KL = 0.52 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all L1 = 0.395 +- 0.261 (in-sample avg dev_std = 0.443)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0 = 0.098 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 1 = 0.019 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 2 = 0.317 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 3 = 0.333 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 4 = 0.174 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 5 = 0.384 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 6 = 0.255 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 7 = 0.181 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 8 = 0.182 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 9 = 0.342 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all KL = 0.311 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all L1 = 0.224 +- 0.248 (in-sample avg dev_std = 0.345)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
NEC for r=0.3 class 0 = 0.49 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1 = 0.379 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 2 = 0.399 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 3 = 0.472 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 4 = 0.447 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 5 = 0.345 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 6 = 0.485 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 7 = 0.432 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 8 = 0.455 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 9 = 0.435 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.395 +- 0.296 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.434 +- 0.227 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 0 = 0.634 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.608 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.652 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 3 = 0.629 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 4 = 0.623 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 5 = 0.649 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 6 = 0.641 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 7 = 0.61 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 8 = 0.651 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 9 = 0.655 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.744 +- 0.236 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.634 +- 0.173 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.524
NEC for r=0.9 class 0 = 0.461 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 1 = 0.158 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 2 = 0.487 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 3 = 0.489 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 4 = 0.569 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 5 = 0.576 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 6 = 0.624 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 7 = 0.417 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 8 = 0.516 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 class 9 = 0.612 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 all KL = 0.604 +- 0.300 (in-sample avg dev_std = 0.449)
NEC for r=0.9 all L1 = 0.485 +- 0.249 (in-sample avg dev_std = 0.449)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.788
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.724
NEC for r=1.0 class 0 = 0.207 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 1 = 0.044 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 2 = 0.357 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 3 = 0.425 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 4 = 0.365 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 5 = 0.364 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 6 = 0.36 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 7 = 0.23 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 8 = 0.355 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 9 = 0.399 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all KL = 0.364 +- 0.309 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all L1 = 0.307 +- 0.261 (in-sample avg dev_std = 0.367)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.127
NEC for r=0.3 class 0 = 0.616 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1 = 0.508 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 2 = 0.585 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 3 = 0.617 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 4 = 0.673 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 5 = 0.603 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 6 = 0.638 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 7 = 0.601 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 8 = 0.55 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 9 = 0.632 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.65 +- 0.316 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.601 +- 0.214 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.157
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.166
NEC for r=0.6 class 0 = 0.705 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.365 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.706 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 3 = 0.724 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 4 = 0.739 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 5 = 0.663 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 6 = 0.664 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 7 = 0.705 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 8 = 0.692 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 9 = 0.717 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.823 +- 0.248 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.665 +- 0.212 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.228
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.278
NEC for r=0.9 class 0 = 0.708 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.3 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.576 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 3 = 0.648 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 4 = 0.493 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 5 = 0.612 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 6 = 0.636 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 7 = 0.642 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 8 = 0.616 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 9 = 0.629 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.767 +- 0.283 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.583 +- 0.239 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.237
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.326
NEC for r=1.0 class 0 = 0.598 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 1 = 0.463 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 2 = 0.539 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 3 = 0.605 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 4 = 0.494 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 5 = 0.515 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 6 = 0.588 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 7 = 0.6 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 8 = 0.592 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 9 = 0.561 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all KL = 0.685 +- 0.288 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all L1 = 0.555 +- 0.216 (in-sample avg dev_std = 0.381)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 22 17:35:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/22/2024 05:35:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9563
Train Loss: 0.1251
ID Validation ACCURACY: 0.8953
ID Validation Loss: 0.3825
ID Test ACCURACY: 0.8890
ID Test Loss: 0.4034
OOD Validation ACCURACY: 0.7610
OOD Validation Loss: 1.0349
OOD Test ACCURACY: 0.3757
OOD Test Loss: 4.5211

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 165...
[0m[1;37mINFO[0m: [1mCheckpoint 165: 
-----------------------------------
Train ACCURACY: 0.9359
Train Loss: 0.1833
ID Validation ACCURACY: 0.8829
ID Validation Loss: 0.4135
ID Test ACCURACY: 0.8829
ID Test Loss: 0.4120
OOD Validation ACCURACY: 0.8049
OOD Validation Loss: 0.7120
OOD Test ACCURACY: 0.3070
OOD Test Loss: 5.3571

[0m[1;37mINFO[0m: [1mChartInfo 0.8890 0.3757 0.8829 0.3070 0.8829 0.8049[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.409 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 1 = 0.466 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 2 = 0.403 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 3 = 0.47 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 4 = 0.46 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 5 = 0.495 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 6 = 0.445 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 7 = 0.484 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 8 = 0.486 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 9 = 0.507 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all KL = 0.387 +- 0.275 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all L1 = 0.462 +- 0.156 (in-sample avg dev_std = 0.523)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
SUFF++ for r=0.6 class 0 = 0.31 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 1 = 0.473 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 2 = 0.408 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 3 = 0.458 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 4 = 0.369 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 5 = 0.509 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 6 = 0.367 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 7 = 0.425 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 8 = 0.363 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 class 9 = 0.43 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 all KL = 0.285 +- 0.248 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.6 all L1 = 0.411 +- 0.203 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.786
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.37
SUFF++ for r=0.9 class 0 = 0.296 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 1 = 0.305 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 2 = 0.36 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 3 = 0.285 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 4 = 0.323 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 5 = 0.29 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 6 = 0.312 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 7 = 0.718 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 8 = 0.303 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 class 9 = 0.363 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 all KL = 0.137 +- 0.238 (in-sample avg dev_std = 0.704)
SUFF++ for r=0.9 all L1 = 0.359 +- 0.187 (in-sample avg dev_std = 0.704)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.459 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 1 = 0.461 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 2 = 0.454 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 3 = 0.474 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 4 = 0.482 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 5 = 0.502 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 6 = 0.482 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 7 = 0.52 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 8 = 0.485 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 9 = 0.544 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 all KL = 0.485 +- 0.263 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 all L1 = 0.486 +- 0.153 (in-sample avg dev_std = 0.478)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.166
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.298 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.322 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.288 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 3 = 0.32 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 4 = 0.272 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 5 = 0.312 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 6 = 0.296 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 7 = 0.296 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 8 = 0.326 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 9 = 0.293 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.158 +- 0.175 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.302 +- 0.135 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.555
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.293
SUFF++ for r=0.9 class 0 = 0.292 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 1 = 0.451 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 2 = 0.343 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 3 = 0.295 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 4 = 0.319 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 5 = 0.3 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 6 = 0.331 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 7 = 0.527 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 8 = 0.27 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 class 9 = 0.321 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 all KL = 0.145 +- 0.188 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.9 all L1 = 0.348 +- 0.166 (in-sample avg dev_std = 0.621)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.519 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 1 = 0.408 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 2 = 0.508 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 3 = 0.499 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 4 = 0.485 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 5 = 0.484 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 6 = 0.494 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 7 = 0.513 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 8 = 0.541 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 9 = 0.447 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 all KL = 0.503 +- 0.276 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 all L1 = 0.489 +- 0.164 (in-sample avg dev_std = 0.457)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
SUFF++ for r=0.6 class 0 = 0.316 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 1 = 0.326 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 2 = 0.274 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 3 = 0.309 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 4 = 0.274 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 5 = 0.297 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 6 = 0.321 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 7 = 0.302 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 8 = 0.331 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 9 = 0.297 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all KL = 0.148 +- 0.174 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all L1 = 0.305 +- 0.138 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.235
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.202
SUFF++ for r=0.9 class 0 = 0.333 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 1 = 0.691 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 2 = 0.438 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 3 = 0.414 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 4 = 0.398 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 5 = 0.432 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 6 = 0.371 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 7 = 0.411 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 8 = 0.37 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 class 9 = 0.351 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 all KL = 0.22 +- 0.235 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.9 all L1 = 0.424 +- 0.211 (in-sample avg dev_std = 0.531)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.121
NEC for r=0.3 class 0 = 0.519 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 1 = 0.424 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 2 = 0.493 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 3 = 0.517 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 4 = 0.509 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 5 = 0.384 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 6 = 0.492 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 7 = 0.42 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 8 = 0.544 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 9 = 0.456 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all KL = 0.538 +- 0.333 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all L1 = 0.476 +- 0.248 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
NEC for r=0.6 class 0 = 0.62 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.461 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.496 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 3 = 0.497 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 4 = 0.599 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 5 = 0.392 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 6 = 0.55 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 7 = 0.505 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 8 = 0.578 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 9 = 0.527 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.601 +- 0.306 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.523 +- 0.241 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.786
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0 = 0.448 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 1 = 0.201 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 2 = 0.301 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 3 = 0.519 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 4 = 0.453 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 5 = 0.563 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 6 = 0.496 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 7 = 0.299 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 8 = 0.36 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 class 9 = 0.556 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 all KL = 0.558 +- 0.324 (in-sample avg dev_std = 0.462)
NEC for r=0.9 all L1 = 0.413 +- 0.260 (in-sample avg dev_std = 0.462)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.855
NEC for r=1.0 class 0 = 0.063 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 1 = 0.008 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 2 = 0.235 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 3 = 0.282 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 4 = 0.224 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 5 = 0.365 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 6 = 0.206 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 7 = 0.161 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 8 = 0.169 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 9 = 0.298 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all KL = 0.285 +- 0.309 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all L1 = 0.196 +- 0.232 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
NEC for r=0.3 class 0 = 0.505 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 1 = 0.495 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 2 = 0.512 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 3 = 0.517 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 4 = 0.489 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 5 = 0.45 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 6 = 0.485 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 7 = 0.463 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 8 = 0.513 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 9 = 0.459 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all KL = 0.487 +- 0.299 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all L1 = 0.489 +- 0.214 (in-sample avg dev_std = 0.388)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.166
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
NEC for r=0.6 class 0 = 0.676 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 1 = 0.608 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 2 = 0.603 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 3 = 0.582 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 4 = 0.669 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 5 = 0.629 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 6 = 0.628 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 7 = 0.625 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 8 = 0.637 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 9 = 0.654 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all KL = 0.748 +- 0.230 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all L1 = 0.631 +- 0.168 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.555
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.473
NEC for r=0.9 class 0 = 0.531 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 1 = 0.248 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 2 = 0.454 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 3 = 0.564 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 4 = 0.575 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 5 = 0.542 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 6 = 0.602 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 7 = 0.455 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 8 = 0.593 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 class 9 = 0.615 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 all KL = 0.643 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.9 all L1 = 0.514 +- 0.242 (in-sample avg dev_std = 0.459)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.78
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.716
NEC for r=1.0 class 0 = 0.199 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 1 = 0.033 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 2 = 0.304 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 3 = 0.384 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 4 = 0.356 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 5 = 0.43 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 6 = 0.384 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 7 = 0.194 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 8 = 0.391 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 9 = 0.428 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 all KL = 0.379 +- 0.324 (in-sample avg dev_std = 0.389)
NEC for r=1.0 all L1 = 0.305 +- 0.264 (in-sample avg dev_std = 0.389)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.478 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 1 = 0.489 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 2 = 0.469 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 3 = 0.496 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 4 = 0.473 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 5 = 0.497 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 6 = 0.447 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 7 = 0.473 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 8 = 0.485 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 9 = 0.488 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all KL = 0.448 +- 0.290 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all L1 = 0.479 +- 0.196 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.143
NEC for r=0.6 class 0 = 0.642 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 1 = 0.449 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 2 = 0.658 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 3 = 0.604 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 4 = 0.619 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 5 = 0.617 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 6 = 0.564 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 7 = 0.597 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 8 = 0.579 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 9 = 0.511 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 all KL = 0.703 +- 0.258 (in-sample avg dev_std = 0.454)
NEC for r=0.6 all L1 = 0.583 +- 0.209 (in-sample avg dev_std = 0.454)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.235
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.257
NEC for r=0.9 class 0 = 0.646 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.153 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.478 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.513 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.513 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.556 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.538 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.568 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.56 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.567 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.625 +- 0.336 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.505 +- 0.268 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.382
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.386
NEC for r=1.0 class 0 = 0.522 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 1 = 0.057 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 2 = 0.299 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 3 = 0.472 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 4 = 0.505 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 5 = 0.518 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 6 = 0.51 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 7 = 0.421 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 8 = 0.485 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 9 = 0.508 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all KL = 0.504 +- 0.355 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all L1 = 0.423 +- 0.284 (in-sample avg dev_std = 0.380)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.452, 0.206, 0.113, 1.0], 'all_L1': [0.477, 0.309, 0.345, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.651, 0.309, 0.119, 1.0], 'all_L1': [0.606, 0.389, 0.361, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.285, 0.137, 1.0], 'all_L1': [0.462, 0.411, 0.359, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.549, 0.728, 0.578, 0.296], 'all_L1': [0.52, 0.654, 0.429, 0.212]}), defaultdict(<class 'list'>, {'all_KL': [0.311, 0.62, 0.52, 0.311], 'all_L1': [0.366, 0.56, 0.395, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.601, 0.558, 0.285], 'all_L1': [0.476, 0.523, 0.413, 0.196]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.46, 0.122, 0.101, 1.0], 'all_L1': [0.482, 0.274, 0.312, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.2, 0.081, 1.0], 'all_L1': [0.522, 0.31, 0.321, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.485, 0.158, 0.145, 1.0], 'all_L1': [0.486, 0.302, 0.348, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.563, 0.743, 0.634, 0.383], 'all_L1': [0.531, 0.637, 0.523, 0.318]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.744, 0.604, 0.364], 'all_L1': [0.434, 0.634, 0.485, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.748, 0.643, 0.379], 'all_L1': [0.489, 0.631, 0.514, 0.305]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.379, 0.128, 0.149, 1.0], 'all_L1': [0.439, 0.284, 0.321, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.336, 0.112, 0.064, 1.0], 'all_L1': [0.392, 0.268, 0.305, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.503, 0.148, 0.22, 1.0], 'all_L1': [0.489, 0.305, 0.424, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.573, 0.776, 0.786, 0.692], 'all_L1': [0.54, 0.663, 0.672, 0.61]}), defaultdict(<class 'list'>, {'all_KL': [0.65, 0.823, 0.767, 0.685], 'all_L1': [0.601, 0.665, 0.583, 0.555]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.703, 0.625, 0.504], 'all_L1': [0.479, 0.583, 0.505, 0.423]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.515 +- 0.065, 0.370 +- 0.044, 0.355 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.497 +- 0.112, 0.267 +- 0.044, 0.123 +- 0.010, 1.000 +- 0.000
suff++_acc_int  =  0.102 +- 0.007, 0.129 +- 0.014, 0.385 +- 0.011
nec class all_L1  =  0.454 +- 0.065, 0.579 +- 0.055, 0.412 +- 0.014, 0.211 +- 0.011
nec class all_KL  =  0.466 +- 0.110, 0.650 +- 0.056, 0.552 +- 0.024, 0.297 +- 0.011
nec_acc_int  =  0.114 +- 0.011, 0.139 +- 0.014, 0.666 +- 0.009, 0.842 +- 0.010

Eval split val
suff++ class all_L1  =  0.497 +- 0.018, 0.295 +- 0.015, 0.327 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.498 +- 0.038, 0.160 +- 0.032, 0.109 +- 0.027, 1.000 +- 0.000
suff++_acc_int  =  0.112 +- 0.001, 0.127 +- 0.007, 0.289 +- 0.014
nec class all_L1  =  0.485 +- 0.040, 0.634 +- 0.002, 0.507 +- 0.016, 0.310 +- 0.006
nec class all_KL  =  0.482 +- 0.069, 0.745 +- 0.002, 0.627 +- 0.017, 0.375 +- 0.008
nec_acc_int  =  0.116 +- 0.002, 0.125 +- 0.008, 0.487 +- 0.026, 0.717 +- 0.006

Eval split test
suff++ class all_L1  =  0.440 +- 0.040, 0.286 +- 0.015, 0.350 +- 0.053, 1.000 +- 0.000
suff++ class all_KL  =  0.406 +- 0.071, 0.129 +- 0.015, 0.144 +- 0.064, 1.000 +- 0.000
suff++_acc_int  =  0.105 +- 0.006, 0.122 +- 0.014, 0.171 +- 0.026
nec class all_L1  =  0.540 +- 0.050, 0.637 +- 0.038, 0.587 +- 0.068, 0.529 +- 0.078
nec class all_KL  =  0.557 +- 0.083, 0.767 +- 0.049, 0.726 +- 0.072, 0.627 +- 0.087
nec_acc_int  =  0.117 +- 0.007, 0.139 +- 0.023, 0.254 +- 0.022, 0.346 +- 0.028


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.485 +- 0.012, 0.474 +- 0.006, 0.384 +- 0.004, 0.605 +- 0.006
Faith. Armon (L1)= 		  =  0.474 +- 0.017, 0.446 +- 0.019, 0.381 +- 0.003, 0.348 +- 0.016
Faith. GMean (L1)= 	  =  0.479 +- 0.013, 0.460 +- 0.007, 0.382 +- 0.003, 0.459 +- 0.013
Faith. Aritm (KL)= 		  =  0.481 +- 0.016, 0.458 +- 0.011, 0.338 +- 0.013, 0.649 +- 0.005
Faith. Armon (KL)= 		  =  0.456 +- 0.031, 0.373 +- 0.038, 0.201 +- 0.014, 0.458 +- 0.013
Faith. GMean (KL)= 	  =  0.468 +- 0.021, 0.413 +- 0.021, 0.260 +- 0.012, 0.545 +- 0.010

Eval split val
Faith. Aritm (L1)= 		  =  0.491 +- 0.012, 0.465 +- 0.007, 0.417 +- 0.011, 0.655 +- 0.003
Faith. Armon (L1)= 		  =  0.489 +- 0.013, 0.403 +- 0.014, 0.397 +- 0.013, 0.473 +- 0.007
Faith. GMean (L1)= 	  =  0.490 +- 0.012, 0.433 +- 0.011, 0.407 +- 0.012, 0.557 +- 0.005
Faith. Aritm (KL)= 		  =  0.490 +- 0.016, 0.453 +- 0.016, 0.368 +- 0.021, 0.688 +- 0.004
Faith. Armon (KL)= 		  =  0.484 +- 0.019, 0.262 +- 0.043, 0.185 +- 0.039, 0.546 +- 0.009
Faith. GMean (KL)= 	  =  0.487 +- 0.017, 0.344 +- 0.035, 0.260 +- 0.035, 0.613 +- 0.007

Eval split test
Faith. Aritm (L1)= 		  =  0.490 +- 0.005, 0.461 +- 0.013, 0.468 +- 0.022, 0.765 +- 0.039
Faith. Armon (L1)= 		  =  0.481 +- 0.005, 0.393 +- 0.008, 0.432 +- 0.025, 0.689 +- 0.069
Faith. GMean (L1)= 	  =  0.485 +- 0.001, 0.426 +- 0.006, 0.450 +- 0.020, 0.725 +- 0.055
Faith. Aritm (KL)= 		  =  0.481 +- 0.008, 0.448 +- 0.017, 0.435 +- 0.023, 0.813 +- 0.044
Faith. Armon (KL)= 		  =  0.458 +- 0.013, 0.220 +- 0.019, 0.231 +- 0.086, 0.767 +- 0.069
Faith. GMean (KL)= 	  =  0.469 +- 0.004, 0.314 +- 0.008, 0.312 +- 0.065, 0.790 +- 0.057
Computed for split load_split = id



Completed in  1:13:35.424052  for GSATvGIN GOODCMNIST/color



DONE GSAT GOODCMNIST/color
DONE all :)
