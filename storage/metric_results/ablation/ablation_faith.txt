nohup: ignoring input

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:09:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:09:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.08
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
SUFF++ for r=0.3 class 0 = 0.592 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 1 = 0.546 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 2 = 0.58 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 3 = 0.6 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 4 = 0.703 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 5 = 0.562 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 6 = 0.62 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 7 = 0.638 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 8 = 0.638 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 class 9 = 0.567 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 all KL = 0.738 +- 0.140 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.3 all L1 = 0.605 +- 0.113 (in-sample avg dev_std = 0.225)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.32
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.17
SUFF++ for r=0.6 class 0 = 0.435 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 1 = 0.421 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 2 = 0.397 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 3 = 0.402 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 4 = 0.377 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 5 = 0.325 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 6 = 0.401 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 7 = 0.392 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 8 = 0.376 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 9 = 0.519 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all KL = 0.37 +- 0.212 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all L1 = 0.405 +- 0.125 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.776
SUFF++ for r=0.9 class 0 = 0.964 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 1 = 0.978 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 2 = 0.696 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 3 = 0.661 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 4 = 0.8 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 5 = 0.636 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 6 = 0.862 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 7 = 0.826 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 8 = 0.924 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 9 = 0.78 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 all KL = 0.83 +- 0.247 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 all L1 = 0.817 +- 0.211 (in-sample avg dev_std = 0.297)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.06
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.075
SUFF++ for r=0.3 class 0 = 0.629 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 1 = 0.556 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 2 = 0.643 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 3 = 0.602 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 4 = 0.664 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 5 = 0.58 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 6 = 0.524 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 7 = 0.563 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 8 = 0.601 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 9 = 0.602 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 all KL = 0.733 +- 0.136 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 all L1 = 0.596 +- 0.103 (in-sample avg dev_std = 0.235)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.2
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.124
SUFF++ for r=0.6 class 0 = 0.362 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 1 = 0.515 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 2 = 0.45 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 3 = 0.417 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 4 = 0.418 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 5 = 0.388 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 6 = 0.369 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 7 = 0.404 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 8 = 0.38 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 9 = 0.434 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all KL = 0.35 +- 0.218 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all L1 = 0.415 +- 0.145 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.666
SUFF++ for r=0.9 class 0 = 0.821 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 1 = 0.977 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 2 = 0.605 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 3 = 0.765 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 4 = 0.787 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 5 = 0.605 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 6 = 0.746 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 7 = 0.791 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 8 = 0.821 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 9 = 0.716 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all KL = 0.781 +- 0.268 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all L1 = 0.767 +- 0.224 (in-sample avg dev_std = 0.322)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.63 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 1 = 0.568 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 2 = 0.636 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 3 = 0.572 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 4 = 0.585 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 5 = 0.591 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 6 = 0.592 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 7 = 0.599 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 8 = 0.61 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 9 = 0.583 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all KL = 0.696 +- 0.162 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all L1 = 0.597 +- 0.126 (in-sample avg dev_std = 0.259)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.2
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.151
SUFF++ for r=0.6 class 0 = 0.455 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1 = 0.441 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 2 = 0.535 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 3 = 0.535 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 4 = 0.486 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 5 = 0.414 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 6 = 0.521 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 7 = 0.492 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 8 = 0.585 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 9 = 0.515 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.507 +- 0.258 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.499 +- 0.171 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.32
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.305
SUFF++ for r=0.9 class 0 = 0.644 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 1 = 0.86 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 2 = 0.823 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 3 = 0.629 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 4 = 0.753 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 5 = 0.658 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 6 = 0.652 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 7 = 0.661 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 8 = 0.759 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 9 = 0.719 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all KL = 0.78 +- 0.213 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all L1 = 0.719 +- 0.190 (in-sample avg dev_std = 0.321)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.08
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.086
NEC for r=0.3 class 0 = 0.396 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 1 = 0.487 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 2 = 0.41 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 3 = 0.422 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 4 = 0.426 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 5 = 0.381 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 6 = 0.405 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 7 = 0.291 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 8 = 0.414 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 9 = 0.432 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 all KL = 0.248 +- 0.158 (in-sample avg dev_std = 0.228)
NEC for r=0.3 all L1 = 0.406 +- 0.111 (in-sample avg dev_std = 0.228)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.32
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.2
NEC for r=0.6 class 0 = 0.53 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 1 = 0.446 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 2 = 0.458 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 3 = 0.464 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 4 = 0.501 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 5 = 0.492 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 6 = 0.513 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 7 = 0.53 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 8 = 0.572 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 class 9 = 0.486 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 all KL = 0.443 +- 0.208 (in-sample avg dev_std = 0.329)
NEC for r=0.6 all L1 = 0.499 +- 0.130 (in-sample avg dev_std = 0.329)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.181 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 1 = 0.096 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 2 = 0.455 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 3 = 0.431 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 4 = 0.444 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 5 = 0.544 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 6 = 0.368 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 7 = 0.42 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 8 = 0.262 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 9 = 0.444 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 all KL = 0.475 +- 0.290 (in-sample avg dev_std = 0.408)
NEC for r=0.9 all L1 = 0.359 +- 0.253 (in-sample avg dev_std = 0.408)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.94
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.827
NEC for r=1.0 class 0 = 0.13 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 1 = 0.02 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 2 = 0.277 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 3 = 0.186 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 4 = 0.286 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 5 = 0.345 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 6 = 0.2 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 7 = 0.237 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 8 = 0.198 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 9 = 0.503 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 all KL = 0.341 +- 0.328 (in-sample avg dev_std = 0.375)
NEC for r=1.0 all L1 = 0.231 +- 0.252 (in-sample avg dev_std = 0.375)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.06
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.083
NEC for r=0.3 class 0 = 0.332 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 1 = 0.333 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 2 = 0.404 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 3 = 0.364 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 4 = 0.337 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 5 = 0.359 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 6 = 0.372 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 7 = 0.427 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 8 = 0.37 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 9 = 0.39 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 all KL = 0.192 +- 0.119 (in-sample avg dev_std = 0.184)
NEC for r=0.3 all L1 = 0.369 +- 0.101 (in-sample avg dev_std = 0.184)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.2
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.169
NEC for r=0.6 class 0 = 0.383 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 1 = 0.245 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 2 = 0.434 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 3 = 0.396 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 4 = 0.512 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 5 = 0.314 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 6 = 0.436 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 7 = 0.485 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 8 = 0.482 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 9 = 0.557 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 all KL = 0.36 +- 0.209 (in-sample avg dev_std = 0.278)
NEC for r=0.6 all L1 = 0.424 +- 0.179 (in-sample avg dev_std = 0.278)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.575
NEC for r=0.9 class 0 = 0.389 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 1 = 0.048 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 2 = 0.376 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 3 = 0.561 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 4 = 0.374 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 5 = 0.607 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 6 = 0.431 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 7 = 0.336 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 8 = 0.371 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 9 = 0.501 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 all KL = 0.49 +- 0.313 (in-sample avg dev_std = 0.446)
NEC for r=0.9 all L1 = 0.394 +- 0.266 (in-sample avg dev_std = 0.446)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.82
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.717
NEC for r=1.0 class 0 = 0.208 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 1 = 0.0 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 2 = 0.341 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 3 = 0.354 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 4 = 0.244 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 5 = 0.43 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 6 = 0.285 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 7 = 0.203 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 8 = 0.283 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 9 = 0.418 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all KL = 0.345 +- 0.310 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all L1 = 0.271 +- 0.244 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
NEC for r=0.3 class 0 = 0.327 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1 = 0.346 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 2 = 0.306 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 3 = 0.403 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 4 = 0.331 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 5 = 0.383 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 6 = 0.343 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 7 = 0.355 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 8 = 0.397 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 9 = 0.336 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.181 +- 0.106 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.352 +- 0.101 (in-sample avg dev_std = 0.194)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.2
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.194
NEC for r=0.6 class 0 = 0.374 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 1 = 0.154 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 2 = 0.417 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 3 = 0.344 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 4 = 0.424 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 5 = 0.537 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 6 = 0.411 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 7 = 0.418 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 8 = 0.368 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 9 = 0.376 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all KL = 0.291 +- 0.195 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all L1 = 0.378 +- 0.188 (in-sample avg dev_std = 0.270)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.32
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.276
NEC for r=0.9 class 0 = 0.634 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 1 = 0.238 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 2 = 0.408 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 3 = 0.56 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 4 = 0.373 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 5 = 0.373 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 6 = 0.514 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 7 = 0.397 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 8 = 0.544 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 class 9 = 0.438 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 all KL = 0.458 +- 0.290 (in-sample avg dev_std = 0.341)
NEC for r=0.9 all L1 = 0.447 +- 0.244 (in-sample avg dev_std = 0.341)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.34
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.314
NEC for r=1.0 class 0 = 0.553 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 1 = 0.168 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 2 = 0.49 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 3 = 0.582 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 4 = 0.57 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 5 = 0.597 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 6 = 0.704 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 7 = 0.583 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 8 = 0.596 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 9 = 0.476 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 all KL = 0.61 +- 0.331 (in-sample avg dev_std = 0.302)
NEC for r=1.0 all L1 = 0.527 +- 0.277 (in-sample avg dev_std = 0.302)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:12:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:12:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
SUFF++ for r=0.3 class 0 = 0.563 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 1 = 0.544 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 2 = 0.564 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 3 = 0.561 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 4 = 0.621 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 5 = 0.618 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 6 = 0.519 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 7 = 0.575 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 8 = 0.616 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 class 9 = 0.523 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 all KL = 0.669 +- 0.139 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.3 all L1 = 0.57 +- 0.090 (in-sample avg dev_std = 0.335)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.23
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.271
SUFF++ for r=0.6 class 0 = 0.422 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 1 = 0.531 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 2 = 0.445 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 3 = 0.479 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 4 = 0.453 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 5 = 0.417 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 6 = 0.448 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 7 = 0.461 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 8 = 0.453 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 class 9 = 0.425 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 all KL = 0.488 +- 0.209 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.6 all L1 = 0.456 +- 0.136 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.86
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.739
SUFF++ for r=0.9 class 0 = 0.981 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 1 = 0.963 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 2 = 0.72 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 3 = 0.657 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 4 = 0.768 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 5 = 0.712 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 6 = 0.74 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 7 = 0.789 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 8 = 0.648 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 9 = 0.711 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 all KL = 0.725 +- 0.307 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 all L1 = 0.772 +- 0.226 (in-sample avg dev_std = 0.342)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
SUFF++ for r=0.3 class 0 = 0.556 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 1 = 0.521 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 2 = 0.575 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 3 = 0.578 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 4 = 0.592 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 5 = 0.585 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 6 = 0.539 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 7 = 0.564 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 8 = 0.561 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 9 = 0.519 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all KL = 0.692 +- 0.111 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all L1 = 0.558 +- 0.066 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.33
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.209
SUFF++ for r=0.6 class 0 = 0.538 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 1 = 0.654 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 2 = 0.493 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 3 = 0.615 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 4 = 0.518 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 5 = 0.456 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 6 = 0.493 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 7 = 0.42 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 8 = 0.485 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 9 = 0.47 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all KL = 0.559 +- 0.219 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all L1 = 0.516 +- 0.165 (in-sample avg dev_std = 0.256)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.669
SUFF++ for r=0.9 class 0 = 0.877 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 1 = 0.978 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 2 = 0.612 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 3 = 0.736 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 4 = 0.767 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 5 = 0.659 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 6 = 0.608 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 7 = 0.752 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 8 = 0.611 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 9 = 0.791 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 all KL = 0.701 +- 0.301 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 all L1 = 0.744 +- 0.228 (in-sample avg dev_std = 0.359)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.588 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 1 = 0.558 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 2 = 0.55 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 3 = 0.582 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 4 = 0.568 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 5 = 0.589 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 6 = 0.557 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 7 = 0.537 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 8 = 0.601 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 9 = 0.556 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 all KL = 0.68 +- 0.118 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 all L1 = 0.568 +- 0.079 (in-sample avg dev_std = 0.322)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.204
SUFF++ for r=0.6 class 0 = 0.496 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 1 = 0.497 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 2 = 0.513 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 3 = 0.514 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 4 = 0.46 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 5 = 0.457 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 6 = 0.461 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 7 = 0.562 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 8 = 0.473 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 9 = 0.381 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all KL = 0.51 +- 0.224 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all L1 = 0.483 +- 0.143 (in-sample avg dev_std = 0.311)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.395
SUFF++ for r=0.9 class 0 = 0.785 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 2 = 0.641 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 3 = 0.765 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 4 = 0.793 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 5 = 0.641 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 6 = 0.819 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 7 = 0.645 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 8 = 0.721 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 9 = 0.655 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all KL = 0.823 +- 0.185 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all L1 = 0.744 +- 0.195 (in-sample avg dev_std = 0.269)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
NEC for r=0.3 class 0 = 0.377 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 1 = 0.386 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 2 = 0.351 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 3 = 0.335 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 4 = 0.374 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 5 = 0.322 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 6 = 0.446 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 7 = 0.364 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 8 = 0.323 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 9 = 0.376 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all KL = 0.193 +- 0.133 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all L1 = 0.366 +- 0.115 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.23
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.27
NEC for r=0.6 class 0 = 0.456 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 1 = 0.453 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 2 = 0.491 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 3 = 0.428 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 4 = 0.437 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 5 = 0.43 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 6 = 0.515 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 7 = 0.452 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 8 = 0.496 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 9 = 0.507 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all KL = 0.398 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all L1 = 0.466 +- 0.131 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.86
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.714
NEC for r=0.9 class 0 = 0.238 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 1 = 0.047 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 2 = 0.452 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 3 = 0.462 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 4 = 0.401 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 5 = 0.427 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 6 = 0.425 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 7 = 0.328 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 8 = 0.557 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 class 9 = 0.462 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 all KL = 0.531 +- 0.325 (in-sample avg dev_std = 0.405)
NEC for r=0.9 all L1 = 0.375 +- 0.262 (in-sample avg dev_std = 0.405)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.97
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0 = 0.081 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 1 = 0.005 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 2 = 0.23 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 3 = 0.248 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 4 = 0.102 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 5 = 0.209 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 6 = 0.26 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 7 = 0.223 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 8 = 0.326 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 9 = 0.46 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 all KL = 0.344 +- 0.325 (in-sample avg dev_std = 0.351)
NEC for r=1.0 all L1 = 0.21 +- 0.235 (in-sample avg dev_std = 0.351)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.125
NEC for r=0.3 class 0 = 0.391 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 1 = 0.351 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 2 = 0.349 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 3 = 0.347 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 4 = 0.355 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 5 = 0.354 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 6 = 0.376 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 7 = 0.366 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 8 = 0.411 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 9 = 0.351 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all KL = 0.172 +- 0.086 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all L1 = 0.365 +- 0.084 (in-sample avg dev_std = 0.176)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.33
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.234
NEC for r=0.6 class 0 = 0.395 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 1 = 0.262 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 2 = 0.411 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 3 = 0.414 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 4 = 0.435 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 5 = 0.414 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 6 = 0.53 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 7 = 0.49 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 8 = 0.517 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 9 = 0.492 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all KL = 0.331 +- 0.182 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all L1 = 0.434 +- 0.143 (in-sample avg dev_std = 0.254)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.54
NEC for r=0.9 class 0 = 0.416 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 1 = 0.002 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 2 = 0.45 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 3 = 0.634 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 4 = 0.313 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 5 = 0.495 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 6 = 0.63 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 7 = 0.437 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 8 = 0.627 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 9 = 0.383 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all KL = 0.53 +- 0.337 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all L1 = 0.432 +- 0.270 (in-sample avg dev_std = 0.413)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.723
NEC for r=1.0 class 0 = 0.158 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 1 = 0.0 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 2 = 0.346 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 3 = 0.394 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 4 = 0.231 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 5 = 0.354 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 6 = 0.375 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 7 = 0.203 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 8 = 0.558 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 class 9 = 0.311 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 all KL = 0.386 +- 0.333 (in-sample avg dev_std = 0.384)
NEC for r=1.0 all L1 = 0.286 +- 0.260 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.339 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 1 = 0.334 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 2 = 0.325 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 3 = 0.361 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 4 = 0.341 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 5 = 0.34 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 6 = 0.386 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 7 = 0.356 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 8 = 0.366 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 9 = 0.304 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all KL = 0.172 +- 0.125 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all L1 = 0.345 +- 0.105 (in-sample avg dev_std = 0.187)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.245
NEC for r=0.6 class 0 = 0.373 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.246 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.416 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 3 = 0.395 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 4 = 0.488 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 5 = 0.409 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 6 = 0.428 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 7 = 0.477 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 8 = 0.53 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 9 = 0.501 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.334 +- 0.194 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.424 +- 0.148 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.355
NEC for r=0.9 class 0 = 0.555 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 1 = 0.066 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 2 = 0.523 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 3 = 0.522 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 4 = 0.307 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 5 = 0.517 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 6 = 0.386 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 7 = 0.463 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 8 = 0.506 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 9 = 0.53 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 all KL = 0.432 +- 0.281 (in-sample avg dev_std = 0.336)
NEC for r=0.9 all L1 = 0.435 +- 0.230 (in-sample avg dev_std = 0.336)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.37
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.376
NEC for r=1.0 class 0 = 0.544 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 1 = 0.153 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 2 = 0.585 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 3 = 0.477 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 4 = 0.466 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 5 = 0.459 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 6 = 0.434 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 7 = 0.41 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 8 = 0.666 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 9 = 0.54 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 all KL = 0.483 +- 0.287 (in-sample avg dev_std = 0.327)
NEC for r=1.0 all L1 = 0.472 +- 0.248 (in-sample avg dev_std = 0.327)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:15:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:31 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:15:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
SUFF++ for r=0.3 class 0 = 0.443 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 1 = 0.307 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 2 = 0.441 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 3 = 0.411 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 4 = 0.506 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 5 = 0.461 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 6 = 0.442 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 7 = 0.462 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 8 = 0.468 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 9 = 0.484 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 all KL = 0.476 +- 0.180 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 all L1 = 0.44 +- 0.092 (in-sample avg dev_std = 0.451)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.3
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.179
SUFF++ for r=0.6 class 0 = 0.305 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 1 = 0.477 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 2 = 0.311 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 3 = 0.301 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 4 = 0.357 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 5 = 0.343 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 6 = 0.297 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 7 = 0.362 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 8 = 0.331 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 9 = 0.391 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all KL = 0.196 +- 0.184 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all L1 = 0.348 +- 0.111 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF++ for r=0.9 class 0 = 0.282 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 1 = 0.942 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 2 = 0.278 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 3 = 0.236 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 4 = 0.291 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 5 = 0.264 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 6 = 0.249 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 7 = 0.242 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 8 = 0.271 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 class 9 = 0.262 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 all KL = 0.145 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.9 all L1 = 0.338 +- 0.253 (in-sample avg dev_std = 0.530)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.17
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.422 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 1 = 0.319 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 2 = 0.419 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 3 = 0.409 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 4 = 0.441 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 5 = 0.466 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 6 = 0.428 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 7 = 0.404 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 8 = 0.457 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 9 = 0.425 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all KL = 0.419 +- 0.180 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all L1 = 0.417 +- 0.089 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.22
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.154
SUFF++ for r=0.6 class 0 = 0.277 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 1 = 0.692 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 2 = 0.316 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 3 = 0.32 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 4 = 0.381 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 5 = 0.29 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 6 = 0.351 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 7 = 0.339 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 8 = 0.307 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 9 = 0.335 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 all KL = 0.21 +- 0.200 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 all L1 = 0.365 +- 0.158 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.44
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.181
SUFF++ for r=0.9 class 0 = 0.212 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 1 = 0.976 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 2 = 0.305 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 3 = 0.236 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 4 = 0.308 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 5 = 0.242 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 6 = 0.319 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 7 = 0.282 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 8 = 0.317 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 class 9 = 0.489 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 all KL = 0.213 +- 0.367 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.9 all L1 = 0.375 +- 0.291 (in-sample avg dev_std = 0.480)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
SUFF++ for r=0.3 class 0 = 0.495 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 1 = 0.273 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 2 = 0.428 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 3 = 0.422 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 4 = 0.36 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 5 = 0.335 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 6 = 0.397 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 7 = 0.366 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 8 = 0.375 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 9 = 0.288 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 all KL = 0.367 +- 0.263 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 all L1 = 0.374 +- 0.148 (in-sample avg dev_std = 0.370)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.12
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.104
SUFF++ for r=0.6 class 0 = 0.274 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 1 = 0.375 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 2 = 0.272 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 3 = 0.413 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 4 = 0.334 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 5 = 0.342 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 6 = 0.32 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 7 = 0.272 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 8 = 0.313 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 class 9 = 0.282 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 all KL = 0.125 +- 0.139 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.6 all L1 = 0.32 +- 0.107 (in-sample avg dev_std = 0.580)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.17
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.126
SUFF++ for r=0.9 class 0 = 0.331 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 1 = 0.38 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 2 = 0.285 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 3 = 0.238 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 4 = 0.287 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 5 = 0.225 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 6 = 0.256 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 7 = 0.29 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 8 = 0.317 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 class 9 = 0.318 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 all KL = 0.029 +- 0.087 (in-sample avg dev_std = 0.627)
SUFF++ for r=0.9 all L1 = 0.294 +- 0.125 (in-sample avg dev_std = 0.627)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.584 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 1 = 0.668 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 2 = 0.577 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 3 = 0.49 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 4 = 0.48 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 5 = 0.484 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 6 = 0.565 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 7 = 0.482 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 8 = 0.579 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 9 = 0.545 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 all KL = 0.451 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 all L1 = 0.547 +- 0.119 (in-sample avg dev_std = 0.206)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.3
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.196
NEC for r=0.6 class 0 = 0.727 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 1 = 0.556 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 2 = 0.704 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 3 = 0.676 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 4 = 0.657 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 5 = 0.656 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 6 = 0.718 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 7 = 0.671 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 8 = 0.636 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 9 = 0.662 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 all KL = 0.78 +- 0.220 (in-sample avg dev_std = 0.369)
NEC for r=0.6 all L1 = 0.666 +- 0.134 (in-sample avg dev_std = 0.369)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.417 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.006 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.373 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 3 = 0.552 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 4 = 0.661 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 5 = 0.51 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 6 = 0.612 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 7 = 0.436 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 8 = 0.399 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 9 = 0.704 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.591 +- 0.312 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.46 +- 0.265 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.96
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.851
NEC for r=1.0 class 0 = 0.16 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 1 = 0.0 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 2 = 0.162 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 3 = 0.17 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 4 = 0.221 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 5 = 0.288 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 6 = 0.294 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 7 = 0.329 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 8 = 0.163 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 9 = 0.491 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all KL = 0.362 +- 0.358 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all L1 = 0.222 +- 0.255 (in-sample avg dev_std = 0.387)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.17
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
NEC for r=0.3 class 0 = 0.573 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.605 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.524 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 3 = 0.557 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 4 = 0.453 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 5 = 0.52 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 6 = 0.493 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 7 = 0.599 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 8 = 0.538 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 9 = 0.467 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.441 +- 0.225 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.534 +- 0.130 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.22
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.149
NEC for r=0.6 class 0 = 0.752 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 1 = 0.248 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 2 = 0.638 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 3 = 0.614 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 4 = 0.595 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 5 = 0.736 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 6 = 0.665 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 7 = 0.667 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 8 = 0.641 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 9 = 0.639 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all KL = 0.725 +- 0.279 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all L1 = 0.615 +- 0.212 (in-sample avg dev_std = 0.353)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.44
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.368
NEC for r=0.9 class 0 = 0.663 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 1 = 0.009 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 2 = 0.427 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 3 = 0.502 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 4 = 0.515 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 5 = 0.565 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 6 = 0.606 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 7 = 0.545 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 8 = 0.542 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 9 = 0.551 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all KL = 0.54 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all L1 = 0.487 +- 0.254 (in-sample avg dev_std = 0.421)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.67
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.606
NEC for r=1.0 class 0 = 0.487 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 1 = 0.0 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 2 = 0.308 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 3 = 0.495 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 4 = 0.251 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 5 = 0.396 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 6 = 0.452 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 7 = 0.279 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 8 = 0.498 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 class 9 = 0.345 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 all KL = 0.473 +- 0.366 (in-sample avg dev_std = 0.410)
NEC for r=1.0 all L1 = 0.345 +- 0.288 (in-sample avg dev_std = 0.410)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.16
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.139
NEC for r=0.3 class 0 = 0.498 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 1 = 0.709 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 2 = 0.511 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 3 = 0.59 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 4 = 0.564 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 5 = 0.65 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 6 = 0.597 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 7 = 0.601 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 8 = 0.606 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 9 = 0.678 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all KL = 0.576 +- 0.304 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all L1 = 0.6 +- 0.175 (in-sample avg dev_std = 0.198)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.12
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.144
NEC for r=0.6 class 0 = 0.707 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 1 = 0.484 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 2 = 0.668 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 3 = 0.536 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 4 = 0.689 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 5 = 0.602 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 6 = 0.615 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 7 = 0.711 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 8 = 0.683 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 9 = 0.781 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 all KL = 0.783 +- 0.258 (in-sample avg dev_std = 0.357)
NEC for r=0.6 all L1 = 0.646 +- 0.209 (in-sample avg dev_std = 0.357)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.17
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.157
NEC for r=0.9 class 0 = 0.392 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 1 = 0.502 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 2 = 0.527 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 3 = 0.494 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 4 = 0.459 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 5 = 0.536 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 6 = 0.458 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 7 = 0.424 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 8 = 0.57 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 class 9 = 0.692 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 all KL = 0.577 +- 0.335 (in-sample avg dev_std = 0.351)
NEC for r=0.9 all L1 = 0.506 +- 0.271 (in-sample avg dev_std = 0.351)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.23
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.205
NEC for r=1.0 class 0 = 0.44 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 1 = 0.346 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 2 = 0.462 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 3 = 0.448 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 4 = 0.471 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 5 = 0.49 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 6 = 0.45 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 7 = 0.357 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 8 = 0.419 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 9 = 0.57 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 all KL = 0.505 +- 0.332 (in-sample avg dev_std = 0.376)
NEC for r=1.0 all L1 = 0.444 +- 0.266 (in-sample avg dev_std = 0.376)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:18:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:18:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.14
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.091
SUFF++ for r=0.3 class 0 = 0.516 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 1 = 0.537 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 2 = 0.499 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 3 = 0.546 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 4 = 0.552 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 5 = 0.528 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 6 = 0.537 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 7 = 0.503 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 8 = 0.529 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 9 = 0.486 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 all KL = 0.622 +- 0.149 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 all L1 = 0.524 +- 0.100 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.201
SUFF++ for r=0.6 class 0 = 0.392 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 1 = 0.464 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 2 = 0.427 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 3 = 0.413 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 4 = 0.434 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 5 = 0.36 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 6 = 0.372 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 7 = 0.401 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 8 = 0.417 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 9 = 0.369 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all KL = 0.373 +- 0.232 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all L1 = 0.407 +- 0.157 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.77
SUFF++ for r=0.9 class 0 = 0.994 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 1 = 0.998 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 2 = 0.73 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 3 = 0.746 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 4 = 0.847 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 5 = 0.579 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 6 = 0.869 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 7 = 0.797 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 8 = 0.833 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 9 = 0.795 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all KL = 0.823 +- 0.251 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.215 (in-sample avg dev_std = 0.273)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.134
SUFF++ for r=0.3 class 0 = 0.546 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 1 = 0.563 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 2 = 0.492 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 3 = 0.56 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 4 = 0.504 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 5 = 0.581 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 6 = 0.513 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 7 = 0.568 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 8 = 0.533 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 9 = 0.504 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 all KL = 0.635 +- 0.168 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 all L1 = 0.537 +- 0.115 (in-sample avg dev_std = 0.346)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.2
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
SUFF++ for r=0.6 class 0 = 0.556 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1 = 0.372 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 2 = 0.456 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 3 = 0.594 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 4 = 0.457 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 5 = 0.581 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 6 = 0.362 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 7 = 0.379 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 8 = 0.505 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 9 = 0.405 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.385 +- 0.231 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.463 +- 0.185 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.67
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.621
SUFF++ for r=0.9 class 0 = 0.88 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 2 = 0.679 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 3 = 0.785 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 4 = 0.818 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 5 = 0.693 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 6 = 0.682 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 7 = 0.761 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 8 = 0.789 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 9 = 0.722 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 all KL = 0.792 +- 0.261 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 all L1 = 0.779 +- 0.220 (in-sample avg dev_std = 0.295)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
SUFF++ for r=0.3 class 0 = 0.547 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 1 = 0.599 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 2 = 0.602 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 3 = 0.598 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 4 = 0.589 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 5 = 0.549 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 6 = 0.55 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 7 = 0.634 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 8 = 0.567 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 9 = 0.512 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all KL = 0.683 +- 0.143 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all L1 = 0.575 +- 0.097 (in-sample avg dev_std = 0.362)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.19
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.139
SUFF++ for r=0.6 class 0 = 0.604 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 1 = 0.401 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 2 = 0.494 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 3 = 0.548 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 4 = 0.536 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 5 = 0.546 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 6 = 0.573 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 7 = 0.542 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 8 = 0.484 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 class 9 = 0.525 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 all KL = 0.384 +- 0.199 (in-sample avg dev_std = 0.490)
SUFF++ for r=0.6 all L1 = 0.523 +- 0.149 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.2
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF++ for r=0.9 class 0 = 0.755 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 1 = 0.884 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 2 = 0.74 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 3 = 0.702 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 4 = 0.707 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 5 = 0.803 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 6 = 0.758 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 7 = 0.705 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 8 = 0.838 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 9 = 0.689 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 all KL = 0.759 +- 0.282 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 all L1 = 0.759 +- 0.238 (in-sample avg dev_std = 0.337)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.14
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
NEC for r=0.3 class 0 = 0.417 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 1 = 0.419 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 2 = 0.447 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 3 = 0.353 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 4 = 0.441 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 5 = 0.352 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 6 = 0.407 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 7 = 0.409 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 8 = 0.376 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 class 9 = 0.404 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 all KL = 0.24 +- 0.159 (in-sample avg dev_std = 0.225)
NEC for r=0.3 all L1 = 0.403 +- 0.131 (in-sample avg dev_std = 0.225)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.203
NEC for r=0.6 class 0 = 0.535 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 1 = 0.384 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 2 = 0.532 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 3 = 0.456 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 4 = 0.425 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 5 = 0.582 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 6 = 0.497 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 7 = 0.576 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 8 = 0.505 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 9 = 0.526 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 all KL = 0.466 +- 0.250 (in-sample avg dev_std = 0.318)
NEC for r=0.6 all L1 = 0.499 +- 0.183 (in-sample avg dev_std = 0.318)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.647
NEC for r=0.9 class 0 = 0.188 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 1 = 0.027 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 2 = 0.454 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 3 = 0.442 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 4 = 0.327 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 5 = 0.53 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 6 = 0.386 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 7 = 0.44 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 8 = 0.46 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 9 = 0.445 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 all KL = 0.517 +- 0.337 (in-sample avg dev_std = 0.444)
NEC for r=0.9 all L1 = 0.364 +- 0.250 (in-sample avg dev_std = 0.444)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.95
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.845
NEC for r=1.0 class 0 = 0.094 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 1 = 0.0 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 2 = 0.301 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 3 = 0.14 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 4 = 0.182 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 5 = 0.233 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 6 = 0.228 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 7 = 0.229 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 8 = 0.287 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 9 = 0.527 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 all KL = 0.366 +- 0.337 (in-sample avg dev_std = 0.368)
NEC for r=1.0 all L1 = 0.216 +- 0.242 (in-sample avg dev_std = 0.368)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.138
NEC for r=0.3 class 0 = 0.351 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 1 = 0.335 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 2 = 0.38 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 3 = 0.266 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 4 = 0.306 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 5 = 0.351 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 6 = 0.307 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 7 = 0.395 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 8 = 0.285 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 class 9 = 0.388 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 all KL = 0.188 +- 0.144 (in-sample avg dev_std = 0.226)
NEC for r=0.3 all L1 = 0.337 +- 0.120 (in-sample avg dev_std = 0.226)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.2
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.157
NEC for r=0.6 class 0 = 0.296 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 1 = 0.316 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 2 = 0.356 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 3 = 0.241 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 4 = 0.343 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 5 = 0.203 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 6 = 0.482 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 7 = 0.487 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 8 = 0.448 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 9 = 0.496 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 all KL = 0.318 +- 0.245 (in-sample avg dev_std = 0.280)
NEC for r=0.6 all L1 = 0.368 +- 0.225 (in-sample avg dev_std = 0.280)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.67
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.524
NEC for r=0.9 class 0 = 0.61 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 1 = 0.07 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 2 = 0.486 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 3 = 0.519 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 4 = 0.283 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 5 = 0.511 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 6 = 0.556 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 7 = 0.419 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 8 = 0.572 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 9 = 0.473 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all KL = 0.558 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all L1 = 0.444 +- 0.258 (in-sample avg dev_std = 0.447)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.77
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.685
NEC for r=1.0 class 0 = 0.178 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 1 = 0.057 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 2 = 0.352 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 3 = 0.344 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 4 = 0.212 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 5 = 0.318 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 6 = 0.442 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 7 = 0.356 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 8 = 0.389 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 class 9 = 0.449 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 all KL = 0.445 +- 0.328 (in-sample avg dev_std = 0.406)
NEC for r=1.0 all L1 = 0.307 +- 0.255 (in-sample avg dev_std = 0.406)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.329 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 1 = 0.33 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 2 = 0.337 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 3 = 0.352 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 4 = 0.29 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 5 = 0.363 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 6 = 0.305 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 7 = 0.372 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 8 = 0.335 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 9 = 0.311 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 all KL = 0.195 +- 0.143 (in-sample avg dev_std = 0.243)
NEC for r=0.3 all L1 = 0.333 +- 0.128 (in-sample avg dev_std = 0.243)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.19
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.16
NEC for r=0.6 class 0 = 0.116 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 1 = 0.296 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 2 = 0.149 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 3 = 0.272 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 4 = 0.167 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 5 = 0.279 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 6 = 0.171 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 7 = 0.219 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 8 = 0.267 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 9 = 0.23 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 all KL = 0.17 +- 0.189 (in-sample avg dev_std = 0.195)
NEC for r=0.6 all L1 = 0.217 +- 0.192 (in-sample avg dev_std = 0.195)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.2
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.165
NEC for r=0.9 class 0 = 0.679 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 1 = 0.155 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 2 = 0.358 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 3 = 0.559 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 4 = 0.658 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 5 = 0.386 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 6 = 0.538 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 7 = 0.524 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 8 = 0.668 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 9 = 0.404 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 all KL = 0.583 +- 0.384 (in-sample avg dev_std = 0.303)
NEC for r=0.9 all L1 = 0.487 +- 0.331 (in-sample avg dev_std = 0.303)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.2
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.206
NEC for r=1.0 class 0 = 0.524 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 1 = 0.044 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 2 = 0.387 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 3 = 0.609 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 4 = 0.429 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 5 = 0.287 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 6 = 0.202 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 7 = 0.319 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 8 = 0.327 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 class 9 = 0.264 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 all KL = 0.472 +- 0.444 (in-sample avg dev_std = 0.296)
NEC for r=1.0 all L1 = 0.336 +- 0.349 (in-sample avg dev_std = 0.296)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:21:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:21:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:21:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.124
SUFF++ for r=0.3 class 0 = 0.489 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 1 = 0.444 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 2 = 0.457 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 3 = 0.435 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 4 = 0.472 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 5 = 0.556 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 6 = 0.494 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 7 = 0.493 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 8 = 0.488 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 9 = 0.408 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all KL = 0.462 +- 0.238 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all L1 = 0.472 +- 0.145 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.14
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.146
SUFF++ for r=0.6 class 0 = 0.353 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.397 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.392 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 3 = 0.48 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 4 = 0.372 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 5 = 0.384 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 6 = 0.443 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 7 = 0.403 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 8 = 0.626 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 9 = 0.427 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.261 +- 0.275 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.428 +- 0.229 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.709
SUFF++ for r=0.9 class 0 = 0.941 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 1 = 0.953 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 2 = 0.618 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 3 = 0.574 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 4 = 0.828 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 5 = 0.746 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 6 = 0.696 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 7 = 0.811 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 8 = 0.86 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 9 = 0.786 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all KL = 0.772 +- 0.301 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all L1 = 0.782 +- 0.251 (in-sample avg dev_std = 0.338)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.08
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.533 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 1 = 0.622 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 2 = 0.581 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 3 = 0.549 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 4 = 0.555 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 5 = 0.533 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 6 = 0.413 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 7 = 0.429 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 8 = 0.586 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 9 = 0.553 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all KL = 0.577 +- 0.255 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all L1 = 0.535 +- 0.181 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.23
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.159
SUFF++ for r=0.6 class 0 = 0.38 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 1 = 0.528 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 2 = 0.526 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 3 = 0.538 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 4 = 0.461 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 5 = 0.606 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 6 = 0.382 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 7 = 0.416 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 8 = 0.433 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 9 = 0.466 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all KL = 0.364 +- 0.310 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all L1 = 0.473 +- 0.236 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.58
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.504
SUFF++ for r=0.9 class 0 = 0.81 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 1 = 1.0 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 2 = 0.533 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 3 = 0.566 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 4 = 0.786 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 5 = 0.684 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 6 = 0.649 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 7 = 0.792 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 8 = 0.672 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 9 = 0.68 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 all KL = 0.726 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 all L1 = 0.722 +- 0.234 (in-sample avg dev_std = 0.349)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.489 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 1 = 0.414 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 2 = 0.494 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 3 = 0.495 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 4 = 0.551 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 5 = 0.453 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 6 = 0.424 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 7 = 0.489 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 8 = 0.592 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 9 = 0.504 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all KL = 0.397 +- 0.281 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all L1 = 0.49 +- 0.179 (in-sample avg dev_std = 0.594)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.17
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.161
SUFF++ for r=0.6 class 0 = 0.615 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 1 = 0.658 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 2 = 0.693 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 3 = 0.713 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 4 = 0.661 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 5 = 0.673 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 6 = 0.605 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 7 = 0.617 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 8 = 0.739 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 9 = 0.474 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 all KL = 0.578 +- 0.355 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 all L1 = 0.645 +- 0.283 (in-sample avg dev_std = 0.402)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.12
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.125
SUFF++ for r=0.9 class 0 = 0.864 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 1 = 1.0 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 2 = 0.866 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 3 = 0.828 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 4 = 0.804 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 5 = 0.933 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 6 = 0.943 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 7 = 0.959 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 8 = 0.924 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 9 = 0.854 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all KL = 0.899 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.163 (in-sample avg dev_std = 0.193)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.481 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 1 = 0.54 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 2 = 0.493 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 3 = 0.438 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 4 = 0.493 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 5 = 0.449 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 6 = 0.522 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 7 = 0.468 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 8 = 0.466 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 9 = 0.518 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all KL = 0.4 +- 0.228 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all L1 = 0.487 +- 0.151 (in-sample avg dev_std = 0.300)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.14
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.134
NEC for r=0.6 class 0 = 0.37 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.56 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.448 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 3 = 0.305 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 4 = 0.375 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 5 = 0.425 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 6 = 0.409 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 7 = 0.466 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 8 = 0.293 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 9 = 0.428 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.454 +- 0.313 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.408 +- 0.252 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.619
NEC for r=0.9 class 0 = 0.148 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 1 = 0.166 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 2 = 0.482 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 3 = 0.656 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 4 = 0.396 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 5 = 0.427 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 6 = 0.435 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 7 = 0.305 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 8 = 0.305 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 9 = 0.402 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all KL = 0.534 +- 0.334 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all L1 = 0.371 +- 0.263 (in-sample avg dev_std = 0.450)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.96
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0 = 0.099 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 1 = 0.012 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 2 = 0.328 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 3 = 0.275 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 4 = 0.249 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 5 = 0.305 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 6 = 0.194 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 7 = 0.182 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 8 = 0.188 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 class 9 = 0.532 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 all KL = 0.393 +- 0.352 (in-sample avg dev_std = 0.389)
NEC for r=1.0 all L1 = 0.23 +- 0.254 (in-sample avg dev_std = 0.389)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.08
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.12
NEC for r=0.3 class 0 = 0.483 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 1 = 0.372 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 2 = 0.365 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 3 = 0.424 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 4 = 0.445 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 5 = 0.448 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 6 = 0.467 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 7 = 0.592 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 8 = 0.365 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 class 9 = 0.404 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 all KL = 0.344 +- 0.212 (in-sample avg dev_std = 0.302)
NEC for r=0.3 all L1 = 0.438 +- 0.159 (in-sample avg dev_std = 0.302)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.23
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.165
NEC for r=0.6 class 0 = 0.484 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 1 = 0.402 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 2 = 0.45 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 3 = 0.35 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 4 = 0.493 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 5 = 0.339 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 6 = 0.428 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 7 = 0.493 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 8 = 0.457 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 class 9 = 0.478 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 all KL = 0.445 +- 0.270 (in-sample avg dev_std = 0.382)
NEC for r=0.6 all L1 = 0.438 +- 0.223 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.58
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.45
NEC for r=0.9 class 0 = 0.467 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 1 = 0.004 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 2 = 0.468 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 3 = 0.52 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 4 = 0.343 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 5 = 0.511 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 6 = 0.635 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 7 = 0.447 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 8 = 0.573 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 9 = 0.493 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 all KL = 0.536 +- 0.333 (in-sample avg dev_std = 0.433)
NEC for r=0.9 all L1 = 0.44 +- 0.267 (in-sample avg dev_std = 0.433)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.69
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.56
NEC for r=1.0 class 0 = 0.395 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 1 = 0.0 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 2 = 0.327 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 3 = 0.589 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 4 = 0.339 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 5 = 0.381 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 6 = 0.539 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 7 = 0.307 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 8 = 0.45 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 9 = 0.314 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 all KL = 0.472 +- 0.346 (in-sample avg dev_std = 0.442)
NEC for r=1.0 all L1 = 0.359 +- 0.263 (in-sample avg dev_std = 0.442)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 100
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
NEC for r=0.3 class 0 = 0.413 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 1 = 0.275 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 2 = 0.29 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 3 = 0.422 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 4 = 0.361 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 5 = 0.368 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 6 = 0.349 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 7 = 0.374 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 8 = 0.385 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 9 = 0.465 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 all KL = 0.326 +- 0.253 (in-sample avg dev_std = 0.351)
NEC for r=0.3 all L1 = 0.369 +- 0.181 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.17
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 100
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.171
NEC for r=0.6 class 0 = 0.336 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 1 = 0.218 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 2 = 0.326 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 3 = 0.318 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 4 = 0.241 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 5 = 0.333 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 6 = 0.346 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 7 = 0.327 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 8 = 0.273 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 9 = 0.424 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all KL = 0.358 +- 0.307 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all L1 = 0.314 +- 0.258 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.12
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 100
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.147
NEC for r=0.9 class 0 = 0.253 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 1 = 0.001 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 2 = 0.31 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 3 = 0.242 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 4 = 0.463 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 5 = 0.1 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 6 = 0.101 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 7 = 0.156 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 8 = 0.059 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 9 = 0.18 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 all KL = 0.23 +- 0.332 (in-sample avg dev_std = 0.251)
NEC for r=0.9 all L1 = 0.184 +- 0.263 (in-sample avg dev_std = 0.251)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.11
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.136
NEC for r=1.0 class 0 = 0.368 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 1 = 0.0 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 2 = 0.251 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 3 = 0.213 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 4 = 0.139 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 5 = 0.152 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 6 = 0.069 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 7 = 0.196 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 8 = 0.148 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 9 = 0.068 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all KL = 0.265 +- 0.371 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all L1 = 0.16 +- 0.250 (in-sample avg dev_std = 0.243)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.738, 0.37, 0.83, 1.0], 'all_L1': [0.605, 0.405, 0.817, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.488, 0.725, 1.0], 'all_L1': [0.57, 0.456, 0.772, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.476, 0.196, 0.145, 1.0], 'all_L1': [0.44, 0.348, 0.338, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.373, 0.823, 1.0], 'all_L1': [0.524, 0.407, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.462, 0.261, 0.772, 1.0], 'all_L1': [0.472, 0.428, 0.782, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.248, 0.443, 0.475, 0.341], 'all_L1': [0.406, 0.499, 0.359, 0.231]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.398, 0.531, 0.344], 'all_L1': [0.366, 0.466, 0.375, 0.21]}), defaultdict(<class 'list'>, {'all_KL': [0.451, 0.78, 0.591, 0.362], 'all_L1': [0.547, 0.666, 0.46, 0.222]}), defaultdict(<class 'list'>, {'all_KL': [0.24, 0.466, 0.517, 0.366], 'all_L1': [0.403, 0.499, 0.364, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.454, 0.534, 0.393], 'all_L1': [0.487, 0.408, 0.371, 0.23]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.733, 0.35, 0.781, 1.0], 'all_L1': [0.596, 0.415, 0.767, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.692, 0.559, 0.701, 1.0], 'all_L1': [0.558, 0.516, 0.744, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.21, 0.213, 1.0], 'all_L1': [0.417, 0.365, 0.375, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.635, 0.385, 0.792, 1.0], 'all_L1': [0.537, 0.463, 0.779, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.364, 0.726, 1.0], 'all_L1': [0.535, 0.473, 0.722, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.192, 0.36, 0.49, 0.345], 'all_L1': [0.369, 0.424, 0.394, 0.271]}), defaultdict(<class 'list'>, {'all_KL': [0.172, 0.331, 0.53, 0.386], 'all_L1': [0.365, 0.434, 0.432, 0.286]}), defaultdict(<class 'list'>, {'all_KL': [0.441, 0.725, 0.54, 0.473], 'all_L1': [0.534, 0.615, 0.487, 0.345]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.318, 0.558, 0.445], 'all_L1': [0.337, 0.368, 0.444, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.445, 0.536, 0.472], 'all_L1': [0.438, 0.438, 0.44, 0.359]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.696, 0.507, 0.78, 1.0], 'all_L1': [0.597, 0.499, 0.719, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.51, 0.823, 1.0], 'all_L1': [0.568, 0.483, 0.744, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.367, 0.125, 0.029, 1.0], 'all_L1': [0.374, 0.32, 0.294, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.384, 0.759, 1.0], 'all_L1': [0.575, 0.523, 0.759, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.397, 0.578, 0.899, 1.0], 'all_L1': [0.49, 0.645, 0.899, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.181, 0.291, 0.458, 0.61], 'all_L1': [0.352, 0.378, 0.447, 0.527]}), defaultdict(<class 'list'>, {'all_KL': [0.172, 0.334, 0.432, 0.483], 'all_L1': [0.345, 0.424, 0.435, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.783, 0.577, 0.505], 'all_L1': [0.6, 0.646, 0.506, 0.444]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.17, 0.583, 0.472], 'all_L1': [0.333, 0.217, 0.487, 0.336]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.358, 0.23, 0.265], 'all_L1': [0.369, 0.314, 0.184, 0.16]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.522 +- 0.061, 0.409 +- 0.036, 0.707 +- 0.185, 1.000 +- 0.000
suff++ class all_KL  =  0.593 +- 0.108, 0.338 +- 0.101, 0.659 +- 0.260, 1.000 +- 0.000
suff++_acc_int  =  0.111 +- 0.011, 0.194 +- 0.043, 0.655 +- 0.187
nec class all_L1  =  0.442 +- 0.066, 0.508 +- 0.086, 0.386 +- 0.038, 0.222 +- 0.008
nec class all_KL  =  0.306 +- 0.100, 0.508 +- 0.138, 0.530 +- 0.037, 0.361 +- 0.019
nec_acc_int  =  0.104 +- 0.012, 0.201 +- 0.043, 0.649 +- 0.039, 0.847 +- 0.013

Eval split val
suff++ class all_L1  =  0.529 +- 0.060, 0.446 +- 0.052, 0.677 +- 0.152, 1.000 +- 0.000
suff++ class all_KL  =  0.611 +- 0.110, 0.374 +- 0.111, 0.643 +- 0.217, 1.000 +- 0.000
suff++_acc_int  =  0.109 +- 0.019, 0.153 +- 0.032, 0.528 +- 0.184
nec class all_L1  =  0.409 +- 0.071, 0.456 +- 0.083, 0.439 +- 0.030, 0.314 +- 0.034
nec class all_KL  =  0.267 +- 0.107, 0.436 +- 0.151, 0.531 +- 0.022, 0.424 +- 0.051
nec_acc_int  =  0.116 +- 0.018, 0.175 +- 0.030, 0.491 +- 0.074, 0.658 +- 0.064

Eval split test
suff++ class all_L1  =  0.521 +- 0.082, 0.494 +- 0.104, 0.683 +- 0.204, 1.000 +- 0.000
suff++ class all_KL  =  0.565 +- 0.149, 0.421 +- 0.161, 0.658 +- 0.318, 1.000 +- 0.000
suff++_acc_int  =  0.108 +- 0.007, 0.152 +- 0.032, 0.230 +- 0.106
nec class all_L1  =  0.400 +- 0.101, 0.396 +- 0.143, 0.412 +- 0.117, 0.388 +- 0.130
nec class all_KL  =  0.290 +- 0.154, 0.387 +- 0.208, 0.456 +- 0.128, 0.467 +- 0.112
nec_acc_int  =  0.116 +- 0.012, 0.183 +- 0.035, 0.220 +- 0.082, 0.247 +- 0.086


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.482 +- 0.016, 0.458 +- 0.029, 0.546 +- 0.074, 0.611 +- 0.004
Faith. Armon (L1)= 		  =  0.471 +- 0.017, 0.446 +- 0.015, 0.480 +- 0.045, 0.363 +- 0.011
Faith. GMean (L1)= 	  =  0.476 +- 0.016, 0.452 +- 0.021, 0.512 +- 0.059, 0.471 +- 0.009
Faith. Aritm (KL)= 		  =  0.450 +- 0.025, 0.423 +- 0.043, 0.594 +- 0.114, 0.681 +- 0.009
Faith. Armon (KL)= 		  =  0.382 +- 0.058, 0.380 +- 0.049, 0.543 +- 0.156, 0.530 +- 0.020
Faith. GMean (KL)= 	  =  0.413 +- 0.036, 0.400 +- 0.032, 0.567 +- 0.138, 0.601 +- 0.015

Eval split val
Faith. Aritm (L1)= 		  =  0.469 +- 0.018, 0.451 +- 0.030, 0.558 +- 0.065, 0.657 +- 0.017
Faith. Armon (L1)= 		  =  0.452 +- 0.023, 0.443 +- 0.024, 0.521 +- 0.051, 0.476 +- 0.039
Faith. GMean (L1)= 	  =  0.460 +- 0.020, 0.447 +- 0.026, 0.539 +- 0.057, 0.559 +- 0.030
Faith. Aritm (KL)= 		  =  0.439 +- 0.019, 0.405 +- 0.047, 0.587 +- 0.107, 0.712 +- 0.025
Faith. Armon (KL)= 		  =  0.346 +- 0.069, 0.369 +- 0.034, 0.557 +- 0.127, 0.594 +- 0.051
Faith. GMean (KL)= 	  =  0.388 +- 0.042, 0.386 +- 0.030, 0.571 +- 0.118, 0.650 +- 0.040

Eval split test
Faith. Aritm (L1)= 		  =  0.460 +- 0.020, 0.445 +- 0.041, 0.547 +- 0.078, 0.694 +- 0.065
Faith. Armon (L1)= 		  =  0.435 +- 0.015, 0.408 +- 0.051, 0.474 +- 0.114, 0.545 +- 0.148
Faith. GMean (L1)= 	  =  0.448 +- 0.017, 0.426 +- 0.045, 0.507 +- 0.092, 0.612 +- 0.116
Faith. Aritm (KL)= 		  =  0.427 +- 0.036, 0.404 +- 0.068, 0.557 +- 0.131, 0.734 +- 0.056
Faith. Armon (KL)= 		  =  0.334 +- 0.064, 0.333 +- 0.091, 0.445 +- 0.217, 0.628 +- 0.112
Faith. GMean (KL)= 	  =  0.376 +- 0.042, 0.364 +- 0.071, 0.489 +- 0.192, 0.678 +- 0.088
Computed for split load_split = id



Completed in  0:14:14.754533  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:24:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:24:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.612 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 1 = 0.557 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 2 = 0.599 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 3 = 0.596 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 4 = 0.611 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 5 = 0.585 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 6 = 0.609 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 7 = 0.586 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 8 = 0.602 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 9 = 0.584 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 all KL = 0.732 +- 0.133 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 all L1 = 0.594 +- 0.106 (in-sample avg dev_std = 0.240)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.266
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.177
SUFF++ for r=0.6 class 0 = 0.393 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 1 = 0.4 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 2 = 0.374 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 3 = 0.414 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 4 = 0.395 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 5 = 0.386 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 6 = 0.414 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 7 = 0.392 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 8 = 0.381 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 9 = 0.416 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all KL = 0.349 +- 0.220 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all L1 = 0.397 +- 0.129 (in-sample avg dev_std = 0.412)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.838
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.779
SUFF++ for r=0.9 class 0 = 0.938 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 1 = 0.94 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 2 = 0.789 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 3 = 0.752 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 4 = 0.825 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 5 = 0.688 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 6 = 0.847 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 7 = 0.818 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 8 = 0.903 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 9 = 0.798 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all KL = 0.844 +- 0.230 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.200 (in-sample avg dev_std = 0.255)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.616 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 1 = 0.584 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 2 = 0.601 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 3 = 0.616 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 4 = 0.587 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 5 = 0.595 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 6 = 0.587 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 7 = 0.607 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 8 = 0.593 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 9 = 0.607 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all KL = 0.723 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all L1 = 0.599 +- 0.119 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.232
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.16
SUFF++ for r=0.6 class 0 = 0.409 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 1 = 0.432 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 2 = 0.428 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 3 = 0.431 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 4 = 0.44 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 5 = 0.42 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 6 = 0.383 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 7 = 0.43 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 8 = 0.405 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 9 = 0.403 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 all KL = 0.363 +- 0.222 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 all L1 = 0.418 +- 0.141 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.742
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.721
SUFF++ for r=0.9 class 0 = 0.915 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.967 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.75 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 3 = 0.851 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 4 = 0.739 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 5 = 0.701 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 6 = 0.748 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 7 = 0.841 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 8 = 0.834 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 9 = 0.734 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.843 +- 0.210 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.811 +- 0.201 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.122
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
SUFF++ for r=0.3 class 0 = 0.61 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 1 = 0.59 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 2 = 0.618 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 3 = 0.59 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 4 = 0.598 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 5 = 0.621 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 6 = 0.582 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 7 = 0.585 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 8 = 0.594 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 9 = 0.562 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all KL = 0.693 +- 0.163 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all L1 = 0.595 +- 0.124 (in-sample avg dev_std = 0.272)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.15
SUFF++ for r=0.6 class 0 = 0.467 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 1 = 0.475 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 2 = 0.51 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 3 = 0.493 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 4 = 0.51 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 5 = 0.462 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 6 = 0.518 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 7 = 0.542 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 8 = 0.499 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 9 = 0.47 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all KL = 0.51 +- 0.250 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all L1 = 0.495 +- 0.178 (in-sample avg dev_std = 0.366)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.354
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.344
SUFF++ for r=0.9 class 0 = 0.684 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 1 = 0.791 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 2 = 0.785 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 3 = 0.659 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 4 = 0.726 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 5 = 0.672 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 6 = 0.66 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 7 = 0.753 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 8 = 0.691 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 9 = 0.694 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all KL = 0.759 +- 0.226 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all L1 = 0.714 +- 0.187 (in-sample avg dev_std = 0.341)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.369 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 1 = 0.439 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 2 = 0.418 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 3 = 0.403 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 4 = 0.409 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 5 = 0.4 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 6 = 0.425 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 7 = 0.38 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 8 = 0.419 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 9 = 0.42 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 all KL = 0.248 +- 0.155 (in-sample avg dev_std = 0.220)
NEC for r=0.3 all L1 = 0.408 +- 0.118 (in-sample avg dev_std = 0.220)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.266
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.226
NEC for r=0.6 class 0 = 0.496 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 1 = 0.437 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 2 = 0.454 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 3 = 0.471 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 4 = 0.494 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 5 = 0.475 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 6 = 0.511 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 7 = 0.519 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 8 = 0.503 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 9 = 0.505 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 all KL = 0.436 +- 0.202 (in-sample avg dev_std = 0.332)
NEC for r=0.6 all L1 = 0.486 +- 0.145 (in-sample avg dev_std = 0.332)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.838
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.657
NEC for r=0.9 class 0 = 0.296 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 1 = 0.181 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 2 = 0.342 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 3 = 0.474 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 4 = 0.402 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 5 = 0.551 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 6 = 0.378 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 7 = 0.422 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 8 = 0.283 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 9 = 0.437 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 all KL = 0.51 +- 0.308 (in-sample avg dev_std = 0.423)
NEC for r=0.9 all L1 = 0.373 +- 0.248 (in-sample avg dev_std = 0.423)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.94
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.827
NEC for r=1.0 class 0 = 0.088 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 1 = 0.032 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 2 = 0.298 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 3 = 0.302 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 4 = 0.211 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 5 = 0.362 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 6 = 0.27 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 7 = 0.259 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 8 = 0.144 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 9 = 0.323 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all KL = 0.346 +- 0.324 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all L1 = 0.225 +- 0.245 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.394 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 1 = 0.395 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 2 = 0.387 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 3 = 0.356 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 4 = 0.39 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 5 = 0.382 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 6 = 0.375 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 7 = 0.381 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 8 = 0.387 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 9 = 0.382 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 all KL = 0.215 +- 0.141 (in-sample avg dev_std = 0.208)
NEC for r=0.3 all L1 = 0.383 +- 0.113 (in-sample avg dev_std = 0.208)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.232
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.2
NEC for r=0.6 class 0 = 0.401 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 1 = 0.359 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 2 = 0.438 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 3 = 0.498 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 4 = 0.48 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 5 = 0.426 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 6 = 0.488 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 7 = 0.454 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 8 = 0.502 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 9 = 0.459 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 all KL = 0.399 +- 0.214 (in-sample avg dev_std = 0.305)
NEC for r=0.6 all L1 = 0.45 +- 0.174 (in-sample avg dev_std = 0.305)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.742
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.617
NEC for r=0.9 class 0 = 0.403 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 1 = 0.091 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 2 = 0.381 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 3 = 0.444 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 4 = 0.471 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 5 = 0.528 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 6 = 0.458 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 7 = 0.306 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 8 = 0.327 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 9 = 0.506 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 all KL = 0.501 +- 0.313 (in-sample avg dev_std = 0.428)
NEC for r=0.9 all L1 = 0.386 +- 0.256 (in-sample avg dev_std = 0.428)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.842
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.744
NEC for r=1.0 class 0 = 0.164 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 1 = 0.027 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 2 = 0.312 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 3 = 0.349 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 4 = 0.33 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 5 = 0.384 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 6 = 0.348 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 7 = 0.203 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 8 = 0.23 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 9 = 0.436 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 all KL = 0.361 +- 0.316 (in-sample avg dev_std = 0.379)
NEC for r=1.0 all L1 = 0.275 +- 0.250 (in-sample avg dev_std = 0.379)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.122
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.372 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 1 = 0.354 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 2 = 0.362 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 3 = 0.364 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 4 = 0.346 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 5 = 0.347 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 6 = 0.399 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 7 = 0.36 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 8 = 0.371 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 9 = 0.382 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all KL = 0.198 +- 0.130 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all L1 = 0.366 +- 0.112 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.18
NEC for r=0.6 class 0 = 0.395 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 1 = 0.325 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 2 = 0.416 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 3 = 0.431 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 4 = 0.48 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 5 = 0.46 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 6 = 0.426 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 7 = 0.413 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 8 = 0.447 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 9 = 0.46 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 all KL = 0.351 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=0.6 all L1 = 0.423 +- 0.180 (in-sample avg dev_std = 0.293)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.354
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.305
NEC for r=0.9 class 0 = 0.527 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 1 = 0.382 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 2 = 0.406 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 3 = 0.536 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 4 = 0.428 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 5 = 0.497 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 6 = 0.505 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 7 = 0.376 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 8 = 0.529 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 9 = 0.514 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 all KL = 0.508 +- 0.281 (in-sample avg dev_std = 0.372)
NEC for r=0.9 all L1 = 0.468 +- 0.221 (in-sample avg dev_std = 0.372)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.336
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.354
NEC for r=1.0 class 0 = 0.532 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 1 = 0.126 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 2 = 0.353 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 3 = 0.494 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 4 = 0.57 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 5 = 0.508 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 6 = 0.609 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 7 = 0.511 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 8 = 0.589 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 9 = 0.488 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all KL = 0.549 +- 0.320 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all L1 = 0.471 +- 0.269 (in-sample avg dev_std = 0.345)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:37:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:37:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.122
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.587 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 1 = 0.529 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 2 = 0.561 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 3 = 0.564 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 4 = 0.584 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 5 = 0.575 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 6 = 0.553 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 7 = 0.545 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 8 = 0.587 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 9 = 0.549 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 all KL = 0.678 +- 0.134 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 all L1 = 0.563 +- 0.083 (in-sample avg dev_std = 0.312)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.284
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.225
SUFF++ for r=0.6 class 0 = 0.472 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 1 = 0.508 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 2 = 0.453 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 3 = 0.429 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 4 = 0.469 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 5 = 0.456 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 6 = 0.449 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 7 = 0.458 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 8 = 0.415 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 9 = 0.424 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 all KL = 0.468 +- 0.222 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 all L1 = 0.454 +- 0.146 (in-sample avg dev_std = 0.284)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.776
SUFF++ for r=0.9 class 0 = 0.936 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 1 = 0.988 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 2 = 0.791 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 3 = 0.701 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 4 = 0.849 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 5 = 0.746 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 6 = 0.81 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 7 = 0.77 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 8 = 0.769 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 9 = 0.741 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all KL = 0.796 +- 0.256 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all L1 = 0.812 +- 0.212 (in-sample avg dev_std = 0.275)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
SUFF++ for r=0.3 class 0 = 0.557 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 1 = 0.529 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 3 = 0.597 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 4 = 0.558 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 5 = 0.576 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 6 = 0.535 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 7 = 0.559 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 8 = 0.568 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 9 = 0.562 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 all KL = 0.686 +- 0.119 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 all L1 = 0.561 +- 0.080 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.264
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.202
SUFF++ for r=0.6 class 0 = 0.532 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 1 = 0.559 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 2 = 0.523 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 3 = 0.508 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 4 = 0.472 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 5 = 0.5 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 6 = 0.465 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 7 = 0.511 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 8 = 0.476 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 9 = 0.445 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all KL = 0.553 +- 0.213 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all L1 = 0.5 +- 0.154 (in-sample avg dev_std = 0.250)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.726
SUFF++ for r=0.9 class 0 = 0.918 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 1 = 0.97 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 2 = 0.734 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 3 = 0.722 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 4 = 0.765 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 5 = 0.741 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 6 = 0.701 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 7 = 0.821 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 8 = 0.675 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 class 9 = 0.726 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 all KL = 0.764 +- 0.266 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.9 all L1 = 0.78 +- 0.213 (in-sample avg dev_std = 0.327)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.57 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 1 = 0.54 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 3 = 0.551 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 4 = 0.543 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 5 = 0.564 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 6 = 0.544 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 7 = 0.54 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 8 = 0.566 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 class 9 = 0.56 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 all KL = 0.666 +- 0.120 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.3 all L1 = 0.552 +- 0.079 (in-sample avg dev_std = 0.329)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.248
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.208
SUFF++ for r=0.6 class 0 = 0.512 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 1 = 0.482 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 2 = 0.521 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 3 = 0.515 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 4 = 0.471 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 5 = 0.496 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 6 = 0.477 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 7 = 0.497 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 8 = 0.465 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 9 = 0.402 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 all KL = 0.523 +- 0.235 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 all L1 = 0.484 +- 0.157 (in-sample avg dev_std = 0.260)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.436
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.424
SUFF++ for r=0.9 class 0 = 0.688 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 1 = 0.852 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 2 = 0.672 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 3 = 0.732 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 4 = 0.763 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 5 = 0.753 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 6 = 0.737 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 7 = 0.695 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 8 = 0.694 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 9 = 0.682 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all KL = 0.803 +- 0.199 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all L1 = 0.727 +- 0.187 (in-sample avg dev_std = 0.287)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.122
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.357 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 1 = 0.366 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 2 = 0.322 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 3 = 0.365 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 4 = 0.352 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 5 = 0.333 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 6 = 0.364 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 7 = 0.369 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 8 = 0.351 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 9 = 0.357 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 all KL = 0.182 +- 0.126 (in-sample avg dev_std = 0.182)
NEC for r=0.3 all L1 = 0.354 +- 0.109 (in-sample avg dev_std = 0.182)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.284
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.24
NEC for r=0.6 class 0 = 0.449 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 1 = 0.416 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 2 = 0.477 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 3 = 0.502 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 4 = 0.469 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 5 = 0.471 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 6 = 0.492 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 7 = 0.502 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 8 = 0.53 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 9 = 0.534 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all KL = 0.415 +- 0.206 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all L1 = 0.483 +- 0.135 (in-sample avg dev_std = 0.295)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.68
NEC for r=0.9 class 0 = 0.268 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.049 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.388 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 3 = 0.501 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 4 = 0.364 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 5 = 0.477 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 6 = 0.366 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 7 = 0.391 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 8 = 0.487 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 9 = 0.481 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.53 +- 0.321 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.372 +- 0.255 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.952
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.852
NEC for r=1.0 class 0 = 0.087 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 1 = 0.007 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 2 = 0.237 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 3 = 0.29 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 4 = 0.174 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 5 = 0.3 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 6 = 0.246 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 7 = 0.233 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 8 = 0.244 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 class 9 = 0.355 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 all KL = 0.351 +- 0.340 (in-sample avg dev_std = 0.372)
NEC for r=1.0 all L1 = 0.214 +- 0.240 (in-sample avg dev_std = 0.372)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.361 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 1 = 0.388 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 2 = 0.372 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 3 = 0.341 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 4 = 0.366 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 5 = 0.375 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 6 = 0.359 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 7 = 0.384 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 8 = 0.369 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 9 = 0.337 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all KL = 0.183 +- 0.110 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all L1 = 0.365 +- 0.100 (in-sample avg dev_std = 0.185)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.264
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.219
NEC for r=0.6 class 0 = 0.388 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 1 = 0.368 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 2 = 0.403 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 3 = 0.431 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 4 = 0.492 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 5 = 0.416 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 6 = 0.503 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 7 = 0.419 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 8 = 0.478 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 9 = 0.476 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all KL = 0.343 +- 0.200 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all L1 = 0.437 +- 0.142 (in-sample avg dev_std = 0.266)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0 = 0.416 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 1 = 0.046 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 2 = 0.392 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 3 = 0.555 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 4 = 0.409 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 5 = 0.456 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 6 = 0.525 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 7 = 0.345 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 8 = 0.555 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 9 = 0.486 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all KL = 0.535 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all L1 = 0.412 +- 0.254 (in-sample avg dev_std = 0.421)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.771
NEC for r=1.0 class 0 = 0.163 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 1 = 0.022 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 2 = 0.325 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 3 = 0.382 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 4 = 0.29 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 5 = 0.299 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 6 = 0.334 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 7 = 0.21 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 8 = 0.421 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 9 = 0.329 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 all KL = 0.386 +- 0.320 (in-sample avg dev_std = 0.391)
NEC for r=1.0 all L1 = 0.273 +- 0.247 (in-sample avg dev_std = 0.391)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.362 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 1 = 0.351 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 2 = 0.348 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 3 = 0.337 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 4 = 0.362 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 5 = 0.355 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 6 = 0.374 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 7 = 0.366 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 8 = 0.369 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 9 = 0.369 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 all KL = 0.182 +- 0.125 (in-sample avg dev_std = 0.179)
NEC for r=0.3 all L1 = 0.359 +- 0.107 (in-sample avg dev_std = 0.179)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.248
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.226
NEC for r=0.6 class 0 = 0.379 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1 = 0.382 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 2 = 0.416 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 3 = 0.43 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 4 = 0.484 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 5 = 0.439 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 6 = 0.458 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 7 = 0.47 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 8 = 0.49 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 9 = 0.533 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.364 +- 0.216 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.447 +- 0.155 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.436
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.378
NEC for r=0.9 class 0 = 0.595 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 1 = 0.218 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 2 = 0.496 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 3 = 0.541 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 4 = 0.354 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 5 = 0.438 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 6 = 0.487 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 7 = 0.458 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 8 = 0.514 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 9 = 0.481 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 all KL = 0.462 +- 0.266 (in-sample avg dev_std = 0.345)
NEC for r=0.9 all L1 = 0.456 +- 0.220 (in-sample avg dev_std = 0.345)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.418
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.404
NEC for r=1.0 class 0 = 0.531 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 1 = 0.158 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 2 = 0.474 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 3 = 0.512 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 4 = 0.442 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 5 = 0.401 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 6 = 0.451 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 7 = 0.449 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 8 = 0.532 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 class 9 = 0.499 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 all KL = 0.465 +- 0.279 (in-sample avg dev_std = 0.355)
NEC for r=1.0 all L1 = 0.442 +- 0.232 (in-sample avg dev_std = 0.355)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 21:50:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 09:50:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.446 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 1 = 0.337 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 2 = 0.45 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 3 = 0.447 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 4 = 0.451 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 5 = 0.469 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 6 = 0.435 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 7 = 0.439 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 8 = 0.458 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 9 = 0.421 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 all KL = 0.48 +- 0.188 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 all L1 = 0.434 +- 0.093 (in-sample avg dev_std = 0.442)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.276
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.176
SUFF++ for r=0.6 class 0 = 0.285 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 1 = 0.549 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 2 = 0.325 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 3 = 0.317 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 4 = 0.351 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 5 = 0.332 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 6 = 0.324 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 7 = 0.334 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 8 = 0.344 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 9 = 0.346 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all KL = 0.195 +- 0.178 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all L1 = 0.353 +- 0.132 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.281
SUFF++ for r=0.9 class 0 = 0.252 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 1 = 0.952 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 2 = 0.288 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 3 = 0.246 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 4 = 0.227 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 5 = 0.26 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 6 = 0.252 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 7 = 0.237 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 8 = 0.262 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 class 9 = 0.232 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 all KL = 0.135 +- 0.312 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.9 all L1 = 0.329 +- 0.249 (in-sample avg dev_std = 0.500)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.156
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.434 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 1 = 0.322 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 2 = 0.417 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 3 = 0.436 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 4 = 0.404 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 5 = 0.44 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 6 = 0.434 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 7 = 0.426 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 8 = 0.442 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 9 = 0.409 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all KL = 0.418 +- 0.180 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all L1 = 0.415 +- 0.094 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.212
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.161
SUFF++ for r=0.6 class 0 = 0.279 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 1 = 0.607 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 2 = 0.312 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 3 = 0.316 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 4 = 0.364 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 5 = 0.317 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 6 = 0.343 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 7 = 0.355 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 8 = 0.301 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 class 9 = 0.347 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 all KL = 0.211 +- 0.197 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.6 all L1 = 0.359 +- 0.155 (in-sample avg dev_std = 0.496)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.506
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.205
SUFF++ for r=0.9 class 0 = 0.243 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 1 = 0.965 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 2 = 0.328 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 3 = 0.265 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 4 = 0.358 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 5 = 0.282 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 6 = 0.326 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 7 = 0.276 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 8 = 0.26 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 9 = 0.378 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 all KL = 0.215 +- 0.363 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 all L1 = 0.378 +- 0.286 (in-sample avg dev_std = 0.482)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.152
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.139
SUFF++ for r=0.3 class 0 = 0.481 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 1 = 0.253 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 2 = 0.443 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 3 = 0.412 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 4 = 0.343 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 5 = 0.371 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 6 = 0.405 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 7 = 0.393 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 8 = 0.376 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 9 = 0.332 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all KL = 0.368 +- 0.241 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all L1 = 0.38 +- 0.135 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.132
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
SUFF++ for r=0.6 class 0 = 0.286 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 1 = 0.33 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 2 = 0.295 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 3 = 0.331 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 4 = 0.31 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 5 = 0.329 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 6 = 0.321 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 7 = 0.329 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 8 = 0.331 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 9 = 0.319 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all KL = 0.133 +- 0.157 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all L1 = 0.318 +- 0.116 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.168
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.124
SUFF++ for r=0.9 class 0 = 0.308 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 1 = 0.401 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 2 = 0.306 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 3 = 0.29 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 4 = 0.289 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 5 = 0.283 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 6 = 0.31 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 7 = 0.264 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 8 = 0.308 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 class 9 = 0.33 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 all KL = 0.051 +- 0.153 (in-sample avg dev_std = 0.671)
SUFF++ for r=0.9 all L1 = 0.31 +- 0.151 (in-sample avg dev_std = 0.671)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
NEC for r=0.3 class 0 = 0.562 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 1 = 0.623 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 2 = 0.551 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 3 = 0.545 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 4 = 0.506 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 5 = 0.508 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 6 = 0.531 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 7 = 0.515 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 8 = 0.533 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 class 9 = 0.523 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 all KL = 0.444 +- 0.213 (in-sample avg dev_std = 0.215)
NEC for r=0.3 all L1 = 0.541 +- 0.122 (in-sample avg dev_std = 0.215)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.276
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.172
NEC for r=0.6 class 0 = 0.708 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 1 = 0.489 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 2 = 0.684 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 3 = 0.68 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 4 = 0.666 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 5 = 0.678 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 6 = 0.653 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 7 = 0.674 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 8 = 0.636 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 9 = 0.646 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all KL = 0.766 +- 0.225 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all L1 = 0.65 +- 0.142 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.59
NEC for r=0.9 class 0 = 0.479 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 1 = 0.052 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 2 = 0.361 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 3 = 0.509 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 4 = 0.579 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 5 = 0.551 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 6 = 0.598 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 7 = 0.518 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 8 = 0.381 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 class 9 = 0.682 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 all KL = 0.609 +- 0.318 (in-sample avg dev_std = 0.444)
NEC for r=0.9 all L1 = 0.463 +- 0.259 (in-sample avg dev_std = 0.444)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.954
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.835
NEC for r=1.0 class 0 = 0.125 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 1 = 0.02 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 2 = 0.226 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 3 = 0.28 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 4 = 0.161 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 5 = 0.313 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 6 = 0.328 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 7 = 0.271 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 8 = 0.157 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 class 9 = 0.337 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 all KL = 0.37 +- 0.356 (in-sample avg dev_std = 0.391)
NEC for r=1.0 all L1 = 0.218 +- 0.250 (in-sample avg dev_std = 0.391)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.156
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.562 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1 = 0.614 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 2 = 0.546 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 3 = 0.541 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 4 = 0.505 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 5 = 0.537 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 6 = 0.531 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 7 = 0.534 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 8 = 0.505 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 9 = 0.512 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.449 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.54 +- 0.134 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.212
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.143
NEC for r=0.6 class 0 = 0.729 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 1 = 0.381 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 2 = 0.687 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 3 = 0.69 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 4 = 0.656 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 5 = 0.696 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 6 = 0.674 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 7 = 0.66 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 8 = 0.643 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 9 = 0.634 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 all KL = 0.753 +- 0.263 (in-sample avg dev_std = 0.366)
NEC for r=0.6 all L1 = 0.64 +- 0.188 (in-sample avg dev_std = 0.366)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.506
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.409
NEC for r=0.9 class 0 = 0.633 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 1 = 0.062 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 2 = 0.394 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 3 = 0.555 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 4 = 0.56 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 5 = 0.473 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 6 = 0.624 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 7 = 0.512 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 8 = 0.584 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 9 = 0.609 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all KL = 0.585 +- 0.307 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all L1 = 0.495 +- 0.250 (in-sample avg dev_std = 0.396)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.766
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.66
NEC for r=1.0 class 0 = 0.456 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 1 = 0.026 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 2 = 0.364 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 3 = 0.306 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 4 = 0.32 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 5 = 0.364 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 6 = 0.434 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 7 = 0.253 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 8 = 0.45 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 9 = 0.443 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all KL = 0.466 +- 0.348 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all L1 = 0.336 +- 0.270 (in-sample avg dev_std = 0.416)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.152
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.135
NEC for r=0.3 class 0 = 0.492 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 1 = 0.725 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 2 = 0.531 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 3 = 0.561 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 4 = 0.65 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 5 = 0.572 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 6 = 0.575 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 7 = 0.568 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 8 = 0.589 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 9 = 0.65 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all KL = 0.558 +- 0.297 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all L1 = 0.592 +- 0.172 (in-sample avg dev_std = 0.192)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.132
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.116
NEC for r=0.6 class 0 = 0.691 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 1 = 0.663 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 2 = 0.662 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 3 = 0.658 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 4 = 0.709 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 5 = 0.665 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 6 = 0.613 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 7 = 0.637 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 8 = 0.683 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 9 = 0.716 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 all KL = 0.803 +- 0.251 (in-sample avg dev_std = 0.361)
NEC for r=0.6 all L1 = 0.67 +- 0.189 (in-sample avg dev_std = 0.361)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.168
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.155
NEC for r=0.9 class 0 = 0.304 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 1 = 0.6 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 2 = 0.343 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 3 = 0.412 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 4 = 0.522 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 5 = 0.46 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 6 = 0.505 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 7 = 0.464 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 8 = 0.535 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 9 = 0.554 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 all KL = 0.541 +- 0.357 (in-sample avg dev_std = 0.355)
NEC for r=0.9 all L1 = 0.47 +- 0.288 (in-sample avg dev_std = 0.355)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.216
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.186
NEC for r=1.0 class 0 = 0.389 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 1 = 0.43 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 2 = 0.357 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 3 = 0.416 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 4 = 0.453 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 5 = 0.445 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 6 = 0.47 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 7 = 0.401 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 8 = 0.441 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 9 = 0.498 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all KL = 0.489 +- 0.344 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all L1 = 0.429 +- 0.283 (in-sample avg dev_std = 0.345)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 22:05:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:15 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:05:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.578 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 1 = 0.514 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 2 = 0.542 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 3 = 0.557 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 4 = 0.549 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 5 = 0.539 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 6 = 0.519 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 7 = 0.513 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 8 = 0.553 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 9 = 0.537 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 all KL = 0.631 +- 0.153 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 all L1 = 0.54 +- 0.103 (in-sample avg dev_std = 0.307)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.26
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.188
SUFF++ for r=0.6 class 0 = 0.388 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 1 = 0.398 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 2 = 0.424 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 3 = 0.39 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 4 = 0.395 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 5 = 0.382 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 6 = 0.41 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 7 = 0.429 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 8 = 0.376 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 9 = 0.42 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all KL = 0.35 +- 0.222 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all L1 = 0.402 +- 0.142 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.791
SUFF++ for r=0.9 class 0 = 0.944 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 1 = 0.982 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 2 = 0.779 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 3 = 0.78 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 4 = 0.87 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 5 = 0.682 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 6 = 0.855 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 7 = 0.811 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 8 = 0.847 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 9 = 0.757 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all KL = 0.832 +- 0.248 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all L1 = 0.834 +- 0.210 (in-sample avg dev_std = 0.260)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.566 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 1 = 0.543 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 2 = 0.518 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 3 = 0.57 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 4 = 0.541 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 5 = 0.572 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 6 = 0.541 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 7 = 0.541 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 8 = 0.552 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 9 = 0.552 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 all KL = 0.649 +- 0.154 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 all L1 = 0.549 +- 0.107 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.194
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.135
SUFF++ for r=0.6 class 0 = 0.541 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 1 = 0.391 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 2 = 0.574 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 3 = 0.556 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 4 = 0.451 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 5 = 0.544 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 6 = 0.459 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 7 = 0.525 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 8 = 0.523 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 class 9 = 0.402 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 all KL = 0.418 +- 0.231 (in-sample avg dev_std = 0.398)
SUFF++ for r=0.6 all L1 = 0.494 +- 0.185 (in-sample avg dev_std = 0.398)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.736
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.692
SUFF++ for r=0.9 class 0 = 0.862 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1 = 0.963 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 2 = 0.743 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 3 = 0.81 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 4 = 0.793 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 5 = 0.725 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 6 = 0.705 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 7 = 0.793 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 8 = 0.791 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 9 = 0.714 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.816 +- 0.238 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.213 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.565 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 1 = 0.575 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 2 = 0.575 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 3 = 0.561 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 4 = 0.567 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 5 = 0.58 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 6 = 0.56 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 7 = 0.546 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 8 = 0.568 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 9 = 0.567 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 all KL = 0.671 +- 0.158 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 all L1 = 0.566 +- 0.101 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.162
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
SUFF++ for r=0.6 class 0 = 0.565 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 1 = 0.372 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 2 = 0.514 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 3 = 0.553 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 4 = 0.51 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 5 = 0.535 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 6 = 0.561 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 7 = 0.525 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 8 = 0.538 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 9 = 0.487 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all KL = 0.362 +- 0.202 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all L1 = 0.514 +- 0.152 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.234
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.24
SUFF++ for r=0.9 class 0 = 0.715 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 1 = 0.969 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 2 = 0.719 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 3 = 0.736 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 4 = 0.675 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 5 = 0.742 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 6 = 0.751 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 7 = 0.766 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 8 = 0.727 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 9 = 0.751 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 all KL = 0.764 +- 0.283 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.237 (in-sample avg dev_std = 0.340)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.372 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.385 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.405 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 3 = 0.372 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 4 = 0.374 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 5 = 0.397 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 6 = 0.393 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 7 = 0.385 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 8 = 0.402 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 9 = 0.369 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.225 +- 0.148 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.385 +- 0.124 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.26
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.217
NEC for r=0.6 class 0 = 0.457 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 1 = 0.398 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 2 = 0.472 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 3 = 0.515 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 4 = 0.482 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 5 = 0.51 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 6 = 0.523 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 7 = 0.528 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 8 = 0.518 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 9 = 0.492 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 all KL = 0.456 +- 0.231 (in-sample avg dev_std = 0.314)
NEC for r=0.6 all L1 = 0.488 +- 0.176 (in-sample avg dev_std = 0.314)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0 = 0.264 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 1 = 0.038 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 2 = 0.405 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 3 = 0.485 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 4 = 0.257 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 5 = 0.545 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 6 = 0.413 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 7 = 0.401 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 8 = 0.318 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 9 = 0.491 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all KL = 0.523 +- 0.333 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all L1 = 0.356 +- 0.263 (in-sample avg dev_std = 0.435)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.964
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.858
NEC for r=1.0 class 0 = 0.089 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 1 = 0.016 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 2 = 0.299 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 3 = 0.262 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 4 = 0.158 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 5 = 0.32 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 6 = 0.249 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 7 = 0.19 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 8 = 0.191 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 9 = 0.326 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all KL = 0.351 +- 0.348 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all L1 = 0.206 +- 0.238 (in-sample avg dev_std = 0.381)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.094
NEC for r=0.3 class 0 = 0.342 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 1 = 0.312 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 2 = 0.398 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 3 = 0.326 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 4 = 0.343 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 5 = 0.346 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 6 = 0.329 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 7 = 0.351 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 8 = 0.366 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 9 = 0.36 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 all KL = 0.195 +- 0.138 (in-sample avg dev_std = 0.227)
NEC for r=0.3 all L1 = 0.347 +- 0.128 (in-sample avg dev_std = 0.227)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.194
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.159
NEC for r=0.6 class 0 = 0.234 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 1 = 0.421 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 2 = 0.261 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 3 = 0.31 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 4 = 0.416 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 5 = 0.306 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 6 = 0.411 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 7 = 0.336 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 8 = 0.372 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 9 = 0.477 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all KL = 0.303 +- 0.237 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all L1 = 0.357 +- 0.225 (in-sample avg dev_std = 0.248)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.736
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0 = 0.594 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 1 = 0.089 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 2 = 0.395 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 3 = 0.461 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 4 = 0.42 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 5 = 0.495 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 6 = 0.558 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 7 = 0.364 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 8 = 0.447 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 9 = 0.506 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 all KL = 0.545 +- 0.336 (in-sample avg dev_std = 0.417)
NEC for r=0.9 all L1 = 0.427 +- 0.268 (in-sample avg dev_std = 0.417)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.828
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.711
NEC for r=1.0 class 0 = 0.228 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 1 = 0.053 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 2 = 0.392 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 3 = 0.305 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 4 = 0.273 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 5 = 0.336 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 6 = 0.406 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 7 = 0.241 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 8 = 0.341 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 9 = 0.472 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 all KL = 0.425 +- 0.335 (in-sample avg dev_std = 0.399)
NEC for r=1.0 all L1 = 0.301 +- 0.262 (in-sample avg dev_std = 0.399)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
NEC for r=0.3 class 0 = 0.336 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 1 = 0.301 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 2 = 0.332 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 3 = 0.347 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 4 = 0.312 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 5 = 0.343 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 6 = 0.34 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 7 = 0.324 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 8 = 0.309 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 9 = 0.352 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 all KL = 0.193 +- 0.144 (in-sample avg dev_std = 0.251)
NEC for r=0.3 all L1 = 0.329 +- 0.132 (in-sample avg dev_std = 0.251)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.162
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.134
NEC for r=0.6 class 0 = 0.101 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 1 = 0.394 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 2 = 0.172 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 3 = 0.164 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 4 = 0.236 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 5 = 0.219 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 6 = 0.195 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 7 = 0.267 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 8 = 0.248 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 9 = 0.288 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all KL = 0.181 +- 0.209 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all L1 = 0.23 +- 0.210 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.234
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.241
NEC for r=0.9 class 0 = 0.588 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 1 = 0.068 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 2 = 0.51 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 3 = 0.544 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 4 = 0.574 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 5 = 0.461 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 6 = 0.489 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 7 = 0.443 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 8 = 0.589 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 9 = 0.395 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all KL = 0.559 +- 0.374 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all L1 = 0.462 +- 0.319 (in-sample avg dev_std = 0.298)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.19
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.228
NEC for r=1.0 class 0 = 0.502 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 1 = 0.065 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 2 = 0.45 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 3 = 0.456 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 4 = 0.342 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 5 = 0.462 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 6 = 0.343 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 7 = 0.246 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 8 = 0.449 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 class 9 = 0.346 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 all KL = 0.504 +- 0.437 (in-sample avg dev_std = 0.308)
NEC for r=1.0 all L1 = 0.363 +- 0.349 (in-sample avg dev_std = 0.308)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 22:18:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:18:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.499 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 1 = 0.472 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 2 = 0.472 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 3 = 0.49 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 4 = 0.459 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 5 = 0.489 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 6 = 0.453 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 7 = 0.476 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 8 = 0.457 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 9 = 0.437 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all KL = 0.467 +- 0.236 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all L1 = 0.471 +- 0.145 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.176
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.161
SUFF++ for r=0.6 class 0 = 0.398 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 1 = 0.392 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 2 = 0.445 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 3 = 0.515 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 4 = 0.485 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 5 = 0.397 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 6 = 0.494 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 7 = 0.365 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 8 = 0.702 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 9 = 0.452 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all KL = 0.325 +- 0.304 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all L1 = 0.463 +- 0.245 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.852
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.767
SUFF++ for r=0.9 class 0 = 0.957 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 1 = 0.954 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 2 = 0.724 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 3 = 0.637 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 4 = 0.849 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 5 = 0.679 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 6 = 0.738 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 7 = 0.797 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 8 = 0.878 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 9 = 0.752 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 all KL = 0.789 +- 0.277 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.228 (in-sample avg dev_std = 0.314)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.521 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 1 = 0.591 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 2 = 0.549 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 3 = 0.551 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 4 = 0.503 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 5 = 0.555 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 6 = 0.489 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 7 = 0.498 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 8 = 0.522 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 9 = 0.506 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 all KL = 0.571 +- 0.245 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 all L1 = 0.529 +- 0.171 (in-sample avg dev_std = 0.382)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.188
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.152
SUFF++ for r=0.6 class 0 = 0.482 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 1 = 0.427 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 2 = 0.559 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 3 = 0.478 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 4 = 0.487 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 5 = 0.43 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 6 = 0.471 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 7 = 0.475 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 8 = 0.465 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 9 = 0.465 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all KL = 0.394 +- 0.304 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all L1 = 0.473 +- 0.226 (in-sample avg dev_std = 0.438)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.638
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.6
SUFF++ for r=0.9 class 0 = 0.787 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 1 = 0.958 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 2 = 0.715 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 3 = 0.705 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 4 = 0.738 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 5 = 0.744 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 6 = 0.674 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 7 = 0.824 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 8 = 0.675 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 9 = 0.696 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 all KL = 0.762 +- 0.264 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 all L1 = 0.755 +- 0.220 (in-sample avg dev_std = 0.339)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.441 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 1 = 0.429 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 2 = 0.46 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 3 = 0.468 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 4 = 0.522 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 5 = 0.485 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 6 = 0.519 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 7 = 0.497 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 8 = 0.53 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 9 = 0.52 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all KL = 0.407 +- 0.281 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all L1 = 0.486 +- 0.177 (in-sample avg dev_std = 0.588)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.19
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.183
SUFF++ for r=0.6 class 0 = 0.637 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 1 = 0.735 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 2 = 0.756 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 3 = 0.71 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 4 = 0.641 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 5 = 0.705 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 6 = 0.572 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 7 = 0.572 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 8 = 0.648 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 9 = 0.536 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all KL = 0.586 +- 0.359 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.287 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.174
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.179
SUFF++ for r=0.9 class 0 = 0.859 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 1 = 0.995 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 2 = 0.845 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 3 = 0.86 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 4 = 0.85 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 5 = 0.866 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 6 = 0.893 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 7 = 0.903 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 8 = 0.863 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 9 = 0.873 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 all KL = 0.892 +- 0.204 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 all L1 = 0.882 +- 0.182 (in-sample avg dev_std = 0.227)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.4 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 1 = 0.489 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 2 = 0.494 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 3 = 0.464 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 4 = 0.454 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 5 = 0.466 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 6 = 0.519 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 7 = 0.439 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 8 = 0.485 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 9 = 0.532 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 all KL = 0.388 +- 0.232 (in-sample avg dev_std = 0.298)
NEC for r=0.3 all L1 = 0.474 +- 0.161 (in-sample avg dev_std = 0.298)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.176
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.145
NEC for r=0.6 class 0 = 0.488 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 1 = 0.538 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 2 = 0.443 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 3 = 0.335 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 4 = 0.401 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 5 = 0.446 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 6 = 0.409 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 7 = 0.511 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 8 = 0.267 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 9 = 0.446 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 all KL = 0.465 +- 0.300 (in-sample avg dev_std = 0.405)
NEC for r=0.6 all L1 = 0.43 +- 0.247 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.852
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.627
NEC for r=0.9 class 0 = 0.231 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 1 = 0.173 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 2 = 0.496 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 3 = 0.661 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 4 = 0.3 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 5 = 0.541 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 6 = 0.422 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 7 = 0.385 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 8 = 0.271 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 9 = 0.464 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all KL = 0.565 +- 0.336 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all L1 = 0.393 +- 0.269 (in-sample avg dev_std = 0.454)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.954
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.832
NEC for r=1.0 class 0 = 0.074 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 1 = 0.022 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 2 = 0.304 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 3 = 0.395 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 4 = 0.141 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 5 = 0.37 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 6 = 0.251 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 7 = 0.182 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 8 = 0.187 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 9 = 0.367 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 all KL = 0.376 +- 0.361 (in-sample avg dev_std = 0.398)
NEC for r=1.0 all L1 = 0.226 +- 0.253 (in-sample avg dev_std = 0.398)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
NEC for r=0.3 class 0 = 0.426 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 1 = 0.371 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 2 = 0.412 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 3 = 0.392 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 4 = 0.441 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 5 = 0.416 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 6 = 0.461 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 7 = 0.436 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 8 = 0.446 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 9 = 0.42 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all KL = 0.326 +- 0.205 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all L1 = 0.421 +- 0.164 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.188
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.154
NEC for r=0.6 class 0 = 0.455 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 1 = 0.452 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 2 = 0.43 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 3 = 0.455 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 4 = 0.466 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 5 = 0.441 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 6 = 0.46 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 7 = 0.444 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 8 = 0.458 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 9 = 0.402 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all KL = 0.445 +- 0.267 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all L1 = 0.446 +- 0.216 (in-sample avg dev_std = 0.378)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.638
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.486
NEC for r=0.9 class 0 = 0.567 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.079 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.393 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 3 = 0.559 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 4 = 0.444 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 5 = 0.445 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 6 = 0.58 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 7 = 0.386 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 8 = 0.509 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 9 = 0.474 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.539 +- 0.336 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.438 +- 0.272 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.742
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.622
NEC for r=1.0 class 0 = 0.403 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 1 = 0.029 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 2 = 0.373 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 3 = 0.485 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 4 = 0.358 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 5 = 0.38 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 6 = 0.423 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 7 = 0.248 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 8 = 0.465 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 9 = 0.413 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 all KL = 0.463 +- 0.351 (in-sample avg dev_std = 0.431)
NEC for r=1.0 all L1 = 0.352 +- 0.277 (in-sample avg dev_std = 0.431)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.36 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 1 = 0.365 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 2 = 0.326 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 3 = 0.381 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 4 = 0.354 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 5 = 0.397 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 6 = 0.381 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 7 = 0.422 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 8 = 0.44 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 9 = 0.373 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 all KL = 0.328 +- 0.261 (in-sample avg dev_std = 0.336)
NEC for r=0.3 all L1 = 0.379 +- 0.197 (in-sample avg dev_std = 0.336)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.19
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.197
NEC for r=0.6 class 0 = 0.29 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 1 = 0.123 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 2 = 0.247 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 3 = 0.27 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 4 = 0.323 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 5 = 0.289 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 6 = 0.293 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 7 = 0.361 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 8 = 0.357 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 class 9 = 0.34 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 all KL = 0.317 +- 0.289 (in-sample avg dev_std = 0.341)
NEC for r=0.6 all L1 = 0.287 +- 0.249 (in-sample avg dev_std = 0.341)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.174
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.184
NEC for r=0.9 class 0 = 0.272 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 1 = 0.011 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 2 = 0.234 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 3 = 0.234 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 4 = 0.288 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 5 = 0.244 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 6 = 0.158 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 7 = 0.202 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 8 = 0.228 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 9 = 0.171 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all KL = 0.24 +- 0.318 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all L1 = 0.202 +- 0.260 (in-sample avg dev_std = 0.263)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.156
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.172
NEC for r=1.0 class 0 = 0.306 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 1 = 0.001 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 2 = 0.267 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 3 = 0.247 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 4 = 0.188 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 5 = 0.314 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 6 = 0.135 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 7 = 0.134 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 8 = 0.182 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 9 = 0.126 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all KL = 0.266 +- 0.358 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all L1 = 0.188 +- 0.271 (in-sample avg dev_std = 0.246)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.732, 0.349, 0.844, 1.0], 'all_L1': [0.594, 0.397, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.678, 0.468, 0.796, 1.0], 'all_L1': [0.563, 0.454, 0.812, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.48, 0.195, 0.135, 1.0], 'all_L1': [0.434, 0.353, 0.329, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.35, 0.832, 1.0], 'all_L1': [0.54, 0.402, 0.834, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.467, 0.325, 0.789, 1.0], 'all_L1': [0.471, 0.463, 0.798, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.248, 0.436, 0.51, 0.346], 'all_L1': [0.408, 0.486, 0.373, 0.225]}), defaultdict(<class 'list'>, {'all_KL': [0.182, 0.415, 0.53, 0.351], 'all_L1': [0.354, 0.483, 0.372, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.766, 0.609, 0.37], 'all_L1': [0.541, 0.65, 0.463, 0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.225, 0.456, 0.523, 0.351], 'all_L1': [0.385, 0.488, 0.356, 0.206]}), defaultdict(<class 'list'>, {'all_KL': [0.388, 0.465, 0.565, 0.376], 'all_L1': [0.474, 0.43, 0.393, 0.226]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.723, 0.363, 0.843, 1.0], 'all_L1': [0.599, 0.418, 0.811, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.686, 0.553, 0.764, 1.0], 'all_L1': [0.561, 0.5, 0.78, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.211, 0.215, 1.0], 'all_L1': [0.415, 0.359, 0.378, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.649, 0.418, 0.816, 1.0], 'all_L1': [0.549, 0.494, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.571, 0.394, 0.762, 1.0], 'all_L1': [0.529, 0.473, 0.755, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.215, 0.399, 0.501, 0.361], 'all_L1': [0.383, 0.45, 0.386, 0.275]}), defaultdict(<class 'list'>, {'all_KL': [0.183, 0.343, 0.535, 0.386], 'all_L1': [0.365, 0.437, 0.412, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.753, 0.585, 0.466], 'all_L1': [0.54, 0.64, 0.495, 0.336]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.303, 0.545, 0.425], 'all_L1': [0.347, 0.357, 0.427, 0.301]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.445, 0.539, 0.463], 'all_L1': [0.421, 0.446, 0.438, 0.352]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.693, 0.51, 0.759, 1.0], 'all_L1': [0.595, 0.495, 0.714, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.666, 0.523, 0.803, 1.0], 'all_L1': [0.552, 0.484, 0.727, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.368, 0.133, 0.051, 1.0], 'all_L1': [0.38, 0.318, 0.31, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.671, 0.362, 0.764, 1.0], 'all_L1': [0.566, 0.514, 0.758, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.586, 0.892, 1.0], 'all_L1': [0.486, 0.653, 0.882, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.198, 0.351, 0.508, 0.549], 'all_L1': [0.366, 0.423, 0.468, 0.471]}), defaultdict(<class 'list'>, {'all_KL': [0.182, 0.364, 0.462, 0.465], 'all_L1': [0.359, 0.447, 0.456, 0.442]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.803, 0.541, 0.489], 'all_L1': [0.592, 0.67, 0.47, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.181, 0.559, 0.504], 'all_L1': [0.329, 0.23, 0.462, 0.363]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.317, 0.24, 0.266], 'all_L1': [0.379, 0.287, 0.202, 0.188]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.520 +- 0.059, 0.414 +- 0.040, 0.721 +- 0.196, 1.000 +- 0.000
suff++ class all_KL  =  0.598 +- 0.106, 0.337 +- 0.087, 0.679 +- 0.273, 1.000 +- 0.000
suff++_acc_int  =  0.104 +- 0.005, 0.185 +- 0.021, 0.679 +- 0.199
nec class all_L1  =  0.432 +- 0.067, 0.507 +- 0.075, 0.391 +- 0.038, 0.218 +- 0.007
nec class all_KL  =  0.297 +- 0.101, 0.508 +- 0.130, 0.547 +- 0.036, 0.359 +- 0.012
nec_acc_int  =  0.104 +- 0.005, 0.200 +- 0.036, 0.645 +- 0.033, 0.841 +- 0.012

Eval split val
suff++ class all_L1  =  0.531 +- 0.062, 0.449 +- 0.053, 0.703 +- 0.164, 1.000 +- 0.000
suff++ class all_KL  =  0.609 +- 0.108, 0.388 +- 0.110, 0.680 +- 0.235, 1.000 +- 0.000
suff++_acc_int  =  0.101 +- 0.005, 0.162 +- 0.022, 0.589 +- 0.197
nec class all_L1  =  0.411 +- 0.069, 0.466 +- 0.093, 0.432 +- 0.036, 0.307 +- 0.032
nec class all_KL  =  0.274 +- 0.101, 0.449 +- 0.160, 0.541 +- 0.027, 0.420 +- 0.042
nec_acc_int  =  0.100 +- 0.004, 0.175 +- 0.029, 0.535 +- 0.079, 0.702 +- 0.055

Eval split test
suff++ class all_L1  =  0.516 +- 0.077, 0.493 +- 0.107, 0.678 +- 0.193, 1.000 +- 0.000
suff++ class all_KL  =  0.561 +- 0.142, 0.423 +- 0.162, 0.654 +- 0.305, 1.000 +- 0.000
suff++_acc_int  =  0.110 +- 0.016, 0.154 +- 0.038, 0.262 +- 0.109
nec class all_L1  =  0.405 +- 0.095, 0.411 +- 0.153, 0.412 +- 0.105, 0.379 +- 0.102
nec class all_KL  =  0.292 +- 0.143, 0.403 +- 0.210, 0.462 +- 0.116, 0.455 +- 0.098
nec_acc_int  =  0.111 +- 0.012, 0.171 +- 0.040, 0.253 +- 0.081, 0.269 +- 0.093


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.476 +- 0.016, 0.461 +- 0.023, 0.556 +- 0.080, 0.609 +- 0.004
Faith. Armon (L1)= 		  =  0.464 +- 0.019, 0.450 +- 0.011, 0.487 +- 0.052, 0.358 +- 0.010
Faith. GMean (L1)= 	  =  0.470 +- 0.017, 0.455 +- 0.016, 0.520 +- 0.065, 0.467 +- 0.008
Faith. Aritm (KL)= 		  =  0.447 +- 0.025, 0.422 +- 0.034, 0.613 +- 0.121, 0.679 +- 0.006
Faith. Armon (KL)= 		  =  0.375 +- 0.062, 0.383 +- 0.042, 0.559 +- 0.169, 0.528 +- 0.013
Faith. GMean (KL)= 	  =  0.408 +- 0.039, 0.401 +- 0.020, 0.584 +- 0.149, 0.599 +- 0.010

Eval split val
Faith. Aritm (L1)= 		  =  0.471 +- 0.014, 0.457 +- 0.026, 0.567 +- 0.066, 0.654 +- 0.016
Faith. Armon (L1)= 		  =  0.455 +- 0.018, 0.447 +- 0.020, 0.520 +- 0.047, 0.469 +- 0.037
Faith. GMean (L1)= 	  =  0.463 +- 0.016, 0.452 +- 0.022, 0.543 +- 0.056, 0.554 +- 0.029
Faith. Aritm (KL)= 		  =  0.441 +- 0.016, 0.418 +- 0.044, 0.610 +- 0.106, 0.710 +- 0.021
Faith. Armon (KL)= 		  =  0.354 +- 0.059, 0.380 +- 0.037, 0.571 +- 0.129, 0.591 +- 0.041
Faith. GMean (KL)= 	  =  0.394 +- 0.035, 0.398 +- 0.028, 0.590 +- 0.118, 0.647 +- 0.032

Eval split test
Faith. Aritm (L1)= 		  =  0.460 +- 0.020, 0.452 +- 0.042, 0.545 +- 0.081, 0.689 +- 0.051
Faith. Armon (L1)= 		  =  0.439 +- 0.017, 0.414 +- 0.053, 0.480 +- 0.107, 0.541 +- 0.118
Faith. GMean (L1)= 	  =  0.449 +- 0.018, 0.432 +- 0.046, 0.510 +- 0.089, 0.608 +- 0.092
Faith. Aritm (KL)= 		  =  0.426 +- 0.032, 0.413 +- 0.072, 0.558 +- 0.135, 0.727 +- 0.049
Faith. Armon (KL)= 		  =  0.340 +- 0.058, 0.345 +- 0.090, 0.462 +- 0.207, 0.618 +- 0.102
Faith. GMean (KL)= 	  =  0.379 +- 0.038, 0.375 +- 0.072, 0.502 +- 0.181, 0.670 +- 0.079
Computed for split load_split = id



Completed in  1:06:55.061355  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 22:32:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:32:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.621 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 1 = 0.561 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 2 = 0.594 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 3 = 0.588 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 4 = 0.592 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 5 = 0.587 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 6 = 0.606 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 7 = 0.587 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 8 = 0.593 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 9 = 0.582 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all KL = 0.728 +- 0.137 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all L1 = 0.591 +- 0.106 (in-sample avg dev_std = 0.247)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.264
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.169
SUFF++ for r=0.6 class 0 = 0.384 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 1 = 0.388 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 2 = 0.372 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 3 = 0.406 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 4 = 0.391 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 5 = 0.393 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 6 = 0.412 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 7 = 0.394 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 8 = 0.393 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 9 = 0.393 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all KL = 0.345 +- 0.218 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all L1 = 0.393 +- 0.129 (in-sample avg dev_std = 0.401)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.772
SUFF++ for r=0.9 class 0 = 0.947 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 1 = 0.946 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 2 = 0.805 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 3 = 0.769 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 4 = 0.808 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 5 = 0.71 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 6 = 0.824 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 7 = 0.828 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 8 = 0.876 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 9 = 0.783 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all KL = 0.844 +- 0.231 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all L1 = 0.833 +- 0.198 (in-sample avg dev_std = 0.258)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.607 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 1 = 0.589 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 2 = 0.606 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 3 = 0.619 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 4 = 0.593 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 5 = 0.612 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 6 = 0.586 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 7 = 0.594 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 8 = 0.597 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 9 = 0.601 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 all KL = 0.727 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 all L1 = 0.6 +- 0.114 (in-sample avg dev_std = 0.251)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.234
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.152
SUFF++ for r=0.6 class 0 = 0.387 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 1 = 0.423 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 2 = 0.415 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 3 = 0.425 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 4 = 0.431 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 5 = 0.423 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 6 = 0.392 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 7 = 0.43 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 8 = 0.391 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 9 = 0.403 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all KL = 0.365 +- 0.223 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all L1 = 0.412 +- 0.137 (in-sample avg dev_std = 0.438)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.748
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.726
SUFF++ for r=0.9 class 0 = 0.903 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 2 = 0.755 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 3 = 0.827 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 4 = 0.755 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 5 = 0.718 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 6 = 0.751 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 7 = 0.862 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 8 = 0.815 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 9 = 0.737 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all KL = 0.841 +- 0.212 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all L1 = 0.811 +- 0.202 (in-sample avg dev_std = 0.243)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.612 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 1 = 0.587 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 2 = 0.606 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 3 = 0.603 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 4 = 0.602 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 5 = 0.602 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 6 = 0.595 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 7 = 0.579 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 8 = 0.589 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 class 9 = 0.564 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 all KL = 0.69 +- 0.169 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.3 all L1 = 0.594 +- 0.126 (in-sample avg dev_std = 0.279)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.157
SUFF++ for r=0.6 class 0 = 0.46 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 1 = 0.482 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 2 = 0.524 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 3 = 0.516 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 4 = 0.495 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 5 = 0.474 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 6 = 0.518 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 7 = 0.548 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 8 = 0.48 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 9 = 0.457 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 all KL = 0.508 +- 0.256 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 all L1 = 0.496 +- 0.180 (in-sample avg dev_std = 0.375)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.366
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.354
SUFF++ for r=0.9 class 0 = 0.674 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 1 = 0.791 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 2 = 0.78 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 3 = 0.677 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 4 = 0.734 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 5 = 0.678 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 6 = 0.686 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 7 = 0.745 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 8 = 0.694 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 9 = 0.694 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all KL = 0.77 +- 0.217 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all L1 = 0.717 +- 0.187 (in-sample avg dev_std = 0.329)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.392 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 1 = 0.43 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 2 = 0.423 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 3 = 0.415 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 4 = 0.402 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 5 = 0.408 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 6 = 0.432 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 7 = 0.389 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 8 = 0.43 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 class 9 = 0.42 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 all KL = 0.253 +- 0.157 (in-sample avg dev_std = 0.221)
NEC for r=0.3 all L1 = 0.414 +- 0.118 (in-sample avg dev_std = 0.221)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.264
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.221
NEC for r=0.6 class 0 = 0.493 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 1 = 0.452 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 2 = 0.479 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 3 = 0.48 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 4 = 0.515 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 5 = 0.469 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 6 = 0.503 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 7 = 0.508 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 8 = 0.505 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 9 = 0.525 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all KL = 0.443 +- 0.194 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all L1 = 0.492 +- 0.138 (in-sample avg dev_std = 0.334)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.653
NEC for r=0.9 class 0 = 0.302 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 1 = 0.174 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 2 = 0.332 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 3 = 0.461 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 4 = 0.367 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 5 = 0.553 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 6 = 0.392 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 7 = 0.42 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 8 = 0.29 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 9 = 0.423 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 all KL = 0.504 +- 0.309 (in-sample avg dev_std = 0.429)
NEC for r=0.9 all L1 = 0.367 +- 0.249 (in-sample avg dev_std = 0.429)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.946
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.836
NEC for r=1.0 class 0 = 0.09 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 1 = 0.029 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 2 = 0.262 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 3 = 0.322 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 4 = 0.202 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 5 = 0.397 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 6 = 0.265 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 7 = 0.213 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 8 = 0.171 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 9 = 0.321 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all KL = 0.345 +- 0.328 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all L1 = 0.222 +- 0.240 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.373 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.395 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.389 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 3 = 0.376 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 4 = 0.372 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 5 = 0.363 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 6 = 0.381 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 7 = 0.397 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 8 = 0.383 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 9 = 0.389 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.213 +- 0.137 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.382 +- 0.111 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.234
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.202
NEC for r=0.6 class 0 = 0.418 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 1 = 0.368 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 2 = 0.425 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 3 = 0.482 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 4 = 0.497 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 5 = 0.439 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 6 = 0.488 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 7 = 0.468 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 8 = 0.506 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 9 = 0.485 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 all KL = 0.406 +- 0.221 (in-sample avg dev_std = 0.315)
NEC for r=0.6 all L1 = 0.457 +- 0.174 (in-sample avg dev_std = 0.315)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.748
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.613
NEC for r=0.9 class 0 = 0.416 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 1 = 0.086 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 2 = 0.41 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 3 = 0.482 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 4 = 0.458 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 5 = 0.522 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 6 = 0.482 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 7 = 0.296 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 8 = 0.338 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 9 = 0.504 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all KL = 0.513 +- 0.307 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all L1 = 0.394 +- 0.254 (in-sample avg dev_std = 0.426)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.759
NEC for r=1.0 class 0 = 0.159 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 1 = 0.022 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 2 = 0.297 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 3 = 0.331 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 4 = 0.332 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 5 = 0.365 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 6 = 0.359 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 7 = 0.155 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 8 = 0.224 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 class 9 = 0.443 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 all KL = 0.355 +- 0.308 (in-sample avg dev_std = 0.376)
NEC for r=1.0 all L1 = 0.265 +- 0.244 (in-sample avg dev_std = 0.376)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.347 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 1 = 0.354 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 2 = 0.368 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 3 = 0.363 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 4 = 0.363 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 5 = 0.358 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 6 = 0.389 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 7 = 0.354 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 8 = 0.374 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 9 = 0.371 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all KL = 0.202 +- 0.142 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all L1 = 0.364 +- 0.118 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.21
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.192
NEC for r=0.6 class 0 = 0.385 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 1 = 0.293 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 2 = 0.432 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 3 = 0.428 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 4 = 0.479 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 5 = 0.421 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 6 = 0.432 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 7 = 0.426 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 8 = 0.455 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 9 = 0.473 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all KL = 0.35 +- 0.212 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all L1 = 0.421 +- 0.179 (in-sample avg dev_std = 0.297)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.366
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.311
NEC for r=0.9 class 0 = 0.548 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 1 = 0.374 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 2 = 0.455 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 3 = 0.529 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 4 = 0.44 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 5 = 0.494 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 6 = 0.517 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 7 = 0.398 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 8 = 0.53 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 class 9 = 0.504 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 all KL = 0.517 +- 0.274 (in-sample avg dev_std = 0.372)
NEC for r=0.9 all L1 = 0.478 +- 0.215 (in-sample avg dev_std = 0.372)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.33
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.366
NEC for r=1.0 class 0 = 0.562 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 1 = 0.122 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 2 = 0.335 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 3 = 0.507 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 4 = 0.587 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 5 = 0.52 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 6 = 0.584 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 7 = 0.49 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 8 = 0.588 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 class 9 = 0.525 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 all KL = 0.56 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=1.0 all L1 = 0.476 +- 0.266 (in-sample avg dev_std = 0.348)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 22:53:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:11 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 10:53:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.123
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
SUFF++ for r=0.3 class 0 = 0.57 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 1 = 0.538 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 3 = 0.558 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 4 = 0.575 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 5 = 0.57 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 6 = 0.545 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 7 = 0.547 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 8 = 0.583 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 class 9 = 0.549 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 all KL = 0.67 +- 0.136 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.3 all L1 = 0.56 +- 0.083 (in-sample avg dev_std = 0.323)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.287
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.223
SUFF++ for r=0.6 class 0 = 0.475 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 1 = 0.525 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 2 = 0.457 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 3 = 0.432 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 4 = 0.462 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 5 = 0.454 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 6 = 0.449 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 7 = 0.454 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 8 = 0.432 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 9 = 0.423 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 all KL = 0.477 +- 0.222 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 all L1 = 0.457 +- 0.148 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.772
SUFF++ for r=0.9 class 0 = 0.933 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 1 = 0.977 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 2 = 0.78 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 3 = 0.702 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 4 = 0.82 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 5 = 0.752 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 6 = 0.812 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 7 = 0.791 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 8 = 0.747 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 9 = 0.77 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 all KL = 0.787 +- 0.265 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 all L1 = 0.811 +- 0.207 (in-sample avg dev_std = 0.299)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.566 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 1 = 0.545 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 2 = 0.579 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 3 = 0.585 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 4 = 0.55 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 5 = 0.569 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 6 = 0.558 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 7 = 0.557 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 8 = 0.58 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 class 9 = 0.556 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 all KL = 0.69 +- 0.112 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.3 all L1 = 0.564 +- 0.076 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.251
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.197
SUFF++ for r=0.6 class 0 = 0.507 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 1 = 0.553 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 2 = 0.504 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 3 = 0.506 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 4 = 0.458 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 5 = 0.49 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 6 = 0.475 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 7 = 0.508 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 8 = 0.458 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 9 = 0.458 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 all KL = 0.544 +- 0.215 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 all L1 = 0.493 +- 0.149 (in-sample avg dev_std = 0.260)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.791
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.726
SUFF++ for r=0.9 class 0 = 0.903 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 1 = 0.955 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 2 = 0.748 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 3 = 0.752 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 4 = 0.783 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 5 = 0.749 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 6 = 0.695 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 7 = 0.848 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 8 = 0.678 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 9 = 0.72 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all KL = 0.775 +- 0.261 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all L1 = 0.786 +- 0.214 (in-sample avg dev_std = 0.303)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.565 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 1 = 0.543 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 2 = 0.554 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 3 = 0.569 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 4 = 0.543 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 5 = 0.56 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 6 = 0.543 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 7 = 0.536 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 8 = 0.552 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 9 = 0.563 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all KL = 0.669 +- 0.120 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all L1 = 0.553 +- 0.078 (in-sample avg dev_std = 0.324)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.231
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.198
SUFF++ for r=0.6 class 0 = 0.505 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 1 = 0.511 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 2 = 0.519 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 3 = 0.514 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 4 = 0.464 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 5 = 0.489 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 6 = 0.487 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 7 = 0.493 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 8 = 0.477 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 class 9 = 0.417 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 all KL = 0.534 +- 0.230 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.6 all L1 = 0.488 +- 0.160 (in-sample avg dev_std = 0.257)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.423
SUFF++ for r=0.9 class 0 = 0.661 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 1 = 0.853 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 2 = 0.677 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 3 = 0.712 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 4 = 0.758 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 5 = 0.753 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 6 = 0.738 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 7 = 0.671 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 8 = 0.672 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 9 = 0.671 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all KL = 0.791 +- 0.200 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all L1 = 0.717 +- 0.186 (in-sample avg dev_std = 0.305)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.123
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.356 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 1 = 0.354 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 2 = 0.344 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 3 = 0.36 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 4 = 0.332 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 5 = 0.347 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 6 = 0.351 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 7 = 0.371 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 8 = 0.354 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 9 = 0.358 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all KL = 0.18 +- 0.123 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all L1 = 0.353 +- 0.108 (in-sample avg dev_std = 0.188)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.287
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.251
NEC for r=0.6 class 0 = 0.432 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 1 = 0.386 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 2 = 0.474 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 3 = 0.498 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 4 = 0.484 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 5 = 0.475 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 6 = 0.489 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 7 = 0.485 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 8 = 0.523 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 9 = 0.509 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 all KL = 0.399 +- 0.204 (in-sample avg dev_std = 0.285)
NEC for r=0.6 all L1 = 0.474 +- 0.138 (in-sample avg dev_std = 0.285)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0 = 0.269 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 1 = 0.044 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 2 = 0.363 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 3 = 0.519 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 4 = 0.368 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 5 = 0.452 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 6 = 0.398 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 7 = 0.366 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 8 = 0.485 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 class 9 = 0.491 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 all KL = 0.521 +- 0.325 (in-sample avg dev_std = 0.422)
NEC for r=0.9 all L1 = 0.37 +- 0.259 (in-sample avg dev_std = 0.422)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.954
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.858
NEC for r=1.0 class 0 = 0.085 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 1 = 0.008 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 2 = 0.233 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 3 = 0.294 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 4 = 0.181 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 5 = 0.327 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 6 = 0.258 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 7 = 0.207 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 8 = 0.252 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 9 = 0.32 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 all KL = 0.345 +- 0.335 (in-sample avg dev_std = 0.370)
NEC for r=1.0 all L1 = 0.212 +- 0.234 (in-sample avg dev_std = 0.370)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.362 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1 = 0.377 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 2 = 0.376 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 3 = 0.344 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 4 = 0.354 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 5 = 0.368 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 6 = 0.358 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 7 = 0.377 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 8 = 0.34 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 9 = 0.356 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.18 +- 0.114 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.361 +- 0.102 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.251
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.21
NEC for r=0.6 class 0 = 0.42 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 1 = 0.366 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 2 = 0.412 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 3 = 0.446 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 4 = 0.491 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 5 = 0.427 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 6 = 0.496 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 7 = 0.429 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 8 = 0.483 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 9 = 0.493 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all KL = 0.351 +- 0.201 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all L1 = 0.446 +- 0.142 (in-sample avg dev_std = 0.265)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.791
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.433 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.049 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.39 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.542 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.393 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.464 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.524 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.334 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.571 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.518 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.544 +- 0.317 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.416 +- 0.255 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.886
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.783
NEC for r=1.0 class 0 = 0.195 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 1 = 0.022 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 2 = 0.292 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 3 = 0.365 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 4 = 0.252 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 5 = 0.278 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 6 = 0.361 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 7 = 0.175 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 8 = 0.394 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 9 = 0.342 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all KL = 0.368 +- 0.318 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all L1 = 0.264 +- 0.244 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
NEC for r=0.3 class 0 = 0.342 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1 = 0.355 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 2 = 0.351 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 3 = 0.337 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 4 = 0.365 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 5 = 0.333 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 6 = 0.375 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 7 = 0.359 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 8 = 0.36 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 9 = 0.347 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.177 +- 0.121 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.353 +- 0.106 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.231
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.213
NEC for r=0.6 class 0 = 0.399 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1 = 0.38 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 2 = 0.433 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 3 = 0.437 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 4 = 0.469 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 5 = 0.433 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 6 = 0.463 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 7 = 0.466 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 8 = 0.479 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 9 = 0.527 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.36 +- 0.206 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.448 +- 0.151 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.379
NEC for r=0.9 class 0 = 0.553 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 1 = 0.223 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 2 = 0.486 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 3 = 0.525 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 4 = 0.385 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 5 = 0.449 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 6 = 0.485 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 7 = 0.478 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 8 = 0.522 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 class 9 = 0.515 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 all KL = 0.462 +- 0.260 (in-sample avg dev_std = 0.350)
NEC for r=0.9 all L1 = 0.46 +- 0.216 (in-sample avg dev_std = 0.350)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.399
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.403
NEC for r=1.0 class 0 = 0.544 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 1 = 0.179 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 2 = 0.47 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 3 = 0.537 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 4 = 0.431 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 5 = 0.382 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 6 = 0.482 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 7 = 0.436 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 8 = 0.525 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 9 = 0.52 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 all KL = 0.471 +- 0.277 (in-sample avg dev_std = 0.356)
NEC for r=1.0 all L1 = 0.449 +- 0.230 (in-sample avg dev_std = 0.356)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 23:14:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:14:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.149
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.449 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 1 = 0.341 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 2 = 0.446 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 3 = 0.448 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 4 = 0.451 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 5 = 0.465 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 6 = 0.43 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 7 = 0.436 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 8 = 0.451 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 9 = 0.432 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all KL = 0.478 +- 0.185 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all L1 = 0.433 +- 0.091 (in-sample avg dev_std = 0.445)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.276
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.186
SUFF++ for r=0.6 class 0 = 0.288 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 1 = 0.549 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 2 = 0.337 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 3 = 0.325 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 4 = 0.347 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 5 = 0.332 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 6 = 0.326 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 7 = 0.337 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 8 = 0.333 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 9 = 0.339 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all KL = 0.189 +- 0.181 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all L1 = 0.354 +- 0.133 (in-sample avg dev_std = 0.472)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.277
SUFF++ for r=0.9 class 0 = 0.253 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 1 = 0.941 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 2 = 0.297 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 3 = 0.23 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 4 = 0.225 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 5 = 0.272 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 6 = 0.254 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 7 = 0.233 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 8 = 0.273 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 class 9 = 0.231 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 all KL = 0.133 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.9 all L1 = 0.329 +- 0.246 (in-sample avg dev_std = 0.506)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.153
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.44 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 1 = 0.303 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 2 = 0.434 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 3 = 0.434 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 4 = 0.409 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 5 = 0.44 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 6 = 0.429 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 7 = 0.422 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 8 = 0.43 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 9 = 0.411 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 all KL = 0.415 +- 0.190 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 all L1 = 0.413 +- 0.099 (in-sample avg dev_std = 0.475)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.207
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.156
SUFF++ for r=0.6 class 0 = 0.273 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 1 = 0.625 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 2 = 0.3 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 3 = 0.313 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 4 = 0.367 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 5 = 0.309 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 6 = 0.34 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 7 = 0.342 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 8 = 0.319 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 9 = 0.353 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all KL = 0.204 +- 0.196 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all L1 = 0.359 +- 0.158 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.2
SUFF++ for r=0.9 class 0 = 0.231 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 1 = 0.947 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 2 = 0.299 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 3 = 0.249 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 4 = 0.375 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 5 = 0.294 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 6 = 0.328 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 7 = 0.283 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 8 = 0.27 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 9 = 0.366 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 all KL = 0.214 +- 0.358 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 all L1 = 0.374 +- 0.285 (in-sample avg dev_std = 0.468)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.147
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.131
SUFF++ for r=0.3 class 0 = 0.469 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 1 = 0.25 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 2 = 0.459 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 3 = 0.411 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 4 = 0.353 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 5 = 0.384 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 6 = 0.396 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 7 = 0.398 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 8 = 0.378 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 9 = 0.325 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all KL = 0.37 +- 0.244 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all L1 = 0.382 +- 0.135 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.138
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
SUFF++ for r=0.6 class 0 = 0.279 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 1 = 0.328 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 2 = 0.295 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 3 = 0.33 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 4 = 0.305 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 5 = 0.322 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 6 = 0.301 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 7 = 0.327 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 8 = 0.33 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 9 = 0.322 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all KL = 0.129 +- 0.154 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all L1 = 0.314 +- 0.117 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.171
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.122
SUFF++ for r=0.9 class 0 = 0.325 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 1 = 0.391 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 2 = 0.304 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 3 = 0.311 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 4 = 0.31 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 5 = 0.276 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 6 = 0.32 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 7 = 0.292 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 8 = 0.322 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 9 = 0.327 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 all KL = 0.055 +- 0.170 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 all L1 = 0.319 +- 0.162 (in-sample avg dev_std = 0.679)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.149
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.561 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.617 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.543 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 3 = 0.534 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 4 = 0.524 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 5 = 0.506 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 6 = 0.542 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 7 = 0.527 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 8 = 0.54 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 9 = 0.528 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.449 +- 0.214 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.544 +- 0.121 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.276
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.175
NEC for r=0.6 class 0 = 0.719 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 1 = 0.486 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 2 = 0.685 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 3 = 0.673 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 4 = 0.654 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 5 = 0.672 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 6 = 0.646 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 7 = 0.657 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 8 = 0.673 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 9 = 0.662 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all KL = 0.768 +- 0.231 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all L1 = 0.651 +- 0.154 (in-sample avg dev_std = 0.353)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.523 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 1 = 0.06 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 2 = 0.371 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 3 = 0.513 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 4 = 0.568 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 5 = 0.546 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 6 = 0.611 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 7 = 0.541 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 8 = 0.384 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 9 = 0.687 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all KL = 0.621 +- 0.315 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all L1 = 0.473 +- 0.256 (in-sample avg dev_std = 0.447)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.956
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.847
NEC for r=1.0 class 0 = 0.107 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 1 = 0.007 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 2 = 0.235 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 3 = 0.264 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 4 = 0.162 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 5 = 0.337 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 6 = 0.312 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 7 = 0.266 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 8 = 0.172 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 class 9 = 0.333 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 all KL = 0.371 +- 0.354 (in-sample avg dev_std = 0.399)
NEC for r=1.0 all L1 = 0.215 +- 0.239 (in-sample avg dev_std = 0.399)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.153
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.551 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 1 = 0.641 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 2 = 0.543 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 3 = 0.538 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 4 = 0.524 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 5 = 0.515 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 6 = 0.53 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 7 = 0.53 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 8 = 0.514 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 9 = 0.517 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 all KL = 0.454 +- 0.233 (in-sample avg dev_std = 0.206)
NEC for r=0.3 all L1 = 0.542 +- 0.136 (in-sample avg dev_std = 0.206)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.207
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.139
NEC for r=0.6 class 0 = 0.733 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 1 = 0.389 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 2 = 0.676 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 3 = 0.658 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 4 = 0.652 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 5 = 0.686 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 6 = 0.669 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 7 = 0.662 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 8 = 0.664 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 9 = 0.642 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all KL = 0.749 +- 0.259 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all L1 = 0.638 +- 0.189 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.408
NEC for r=0.9 class 0 = 0.637 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 1 = 0.066 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 2 = 0.373 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 3 = 0.536 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 4 = 0.559 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 5 = 0.47 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 6 = 0.617 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 7 = 0.522 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 8 = 0.575 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 9 = 0.631 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all KL = 0.579 +- 0.314 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all L1 = 0.493 +- 0.252 (in-sample avg dev_std = 0.393)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.765
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.67
NEC for r=1.0 class 0 = 0.489 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 1 = 0.021 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 2 = 0.34 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 3 = 0.302 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 4 = 0.32 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 5 = 0.337 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 6 = 0.425 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 7 = 0.238 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 8 = 0.455 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 9 = 0.475 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 all KL = 0.456 +- 0.344 (in-sample avg dev_std = 0.402)
NEC for r=1.0 all L1 = 0.334 +- 0.273 (in-sample avg dev_std = 0.402)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.147
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.137
NEC for r=0.3 class 0 = 0.51 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 1 = 0.729 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 2 = 0.519 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 3 = 0.555 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 4 = 0.635 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 5 = 0.565 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 6 = 0.577 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 7 = 0.554 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 8 = 0.593 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 9 = 0.653 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.556 +- 0.295 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.59 +- 0.171 (in-sample avg dev_std = 0.193)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.138
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
NEC for r=0.6 class 0 = 0.715 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 1 = 0.648 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 2 = 0.661 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 3 = 0.646 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 4 = 0.718 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 5 = 0.646 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 6 = 0.637 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 7 = 0.632 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 8 = 0.689 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 9 = 0.709 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 all KL = 0.801 +- 0.252 (in-sample avg dev_std = 0.362)
NEC for r=0.6 all L1 = 0.67 +- 0.190 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.171
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.165
NEC for r=0.9 class 0 = 0.318 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 1 = 0.605 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 2 = 0.28 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 3 = 0.412 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 4 = 0.53 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 5 = 0.476 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 6 = 0.51 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 7 = 0.492 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 8 = 0.551 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 9 = 0.552 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 all KL = 0.543 +- 0.354 (in-sample avg dev_std = 0.358)
NEC for r=0.9 all L1 = 0.472 +- 0.284 (in-sample avg dev_std = 0.358)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.214
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.19
NEC for r=1.0 class 0 = 0.37 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 1 = 0.382 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 2 = 0.304 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 3 = 0.407 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 4 = 0.428 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 5 = 0.438 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 6 = 0.486 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 7 = 0.421 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 8 = 0.455 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 9 = 0.468 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all KL = 0.473 +- 0.347 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all L1 = 0.414 +- 0.284 (in-sample avg dev_std = 0.341)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 23:37:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:37:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.556 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 1 = 0.514 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 2 = 0.546 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 3 = 0.541 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 4 = 0.529 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 5 = 0.53 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 6 = 0.532 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 7 = 0.534 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 8 = 0.548 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 9 = 0.531 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 all KL = 0.628 +- 0.157 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 all L1 = 0.536 +- 0.103 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.244
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.178
SUFF++ for r=0.6 class 0 = 0.381 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1 = 0.384 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 2 = 0.431 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 3 = 0.381 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 4 = 0.399 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 5 = 0.389 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 6 = 0.39 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 7 = 0.408 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 8 = 0.392 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 9 = 0.4 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.336 +- 0.220 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.396 +- 0.136 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.782
SUFF++ for r=0.9 class 0 = 0.933 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 1 = 0.982 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 2 = 0.779 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 3 = 0.768 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 4 = 0.86 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 5 = 0.689 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 6 = 0.843 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 7 = 0.815 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 8 = 0.85 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 9 = 0.763 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all KL = 0.832 +- 0.247 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.211 (in-sample avg dev_std = 0.270)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
SUFF++ for r=0.3 class 0 = 0.56 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 1 = 0.552 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 2 = 0.536 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 3 = 0.567 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 4 = 0.535 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 5 = 0.557 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 6 = 0.556 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 7 = 0.546 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 8 = 0.54 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 class 9 = 0.553 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 all KL = 0.642 +- 0.152 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.3 all L1 = 0.55 +- 0.104 (in-sample avg dev_std = 0.366)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.192
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.137
SUFF++ for r=0.6 class 0 = 0.517 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 1 = 0.395 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 2 = 0.567 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 3 = 0.551 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 4 = 0.439 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 5 = 0.555 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 6 = 0.479 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 7 = 0.493 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 8 = 0.498 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 9 = 0.399 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 all KL = 0.421 +- 0.229 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 all L1 = 0.487 +- 0.180 (in-sample avg dev_std = 0.390)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.683
SUFF++ for r=0.9 class 0 = 0.836 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1 = 0.946 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 2 = 0.752 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 3 = 0.824 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 4 = 0.78 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 5 = 0.757 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 6 = 0.733 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 7 = 0.818 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 8 = 0.771 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 9 = 0.708 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.817 +- 0.237 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.795 +- 0.211 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.099
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.566 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 1 = 0.581 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 3 = 0.56 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 4 = 0.556 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 5 = 0.573 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 6 = 0.559 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 7 = 0.547 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 8 = 0.551 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 class 9 = 0.568 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 all KL = 0.669 +- 0.159 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.3 all L1 = 0.563 +- 0.104 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.161
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.542 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 1 = 0.386 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 2 = 0.524 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 3 = 0.537 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 4 = 0.507 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 5 = 0.515 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 6 = 0.566 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 7 = 0.511 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 8 = 0.544 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 9 = 0.499 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 all KL = 0.359 +- 0.210 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 all L1 = 0.512 +- 0.152 (in-sample avg dev_std = 0.519)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.229
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.243
SUFF++ for r=0.9 class 0 = 0.711 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 1 = 0.971 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 2 = 0.722 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 3 = 0.737 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 4 = 0.716 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 5 = 0.726 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 6 = 0.742 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 7 = 0.775 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 8 = 0.743 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 9 = 0.749 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all KL = 0.763 +- 0.283 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all L1 = 0.762 +- 0.236 (in-sample avg dev_std = 0.341)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.381 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 1 = 0.383 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 2 = 0.392 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 3 = 0.387 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 4 = 0.389 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 5 = 0.386 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 6 = 0.403 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 7 = 0.379 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 8 = 0.411 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 9 = 0.374 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all KL = 0.227 +- 0.147 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all L1 = 0.388 +- 0.121 (in-sample avg dev_std = 0.213)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.244
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.218
NEC for r=0.6 class 0 = 0.495 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 1 = 0.389 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 2 = 0.463 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 3 = 0.491 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 4 = 0.487 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 5 = 0.514 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 6 = 0.522 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 7 = 0.529 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 8 = 0.501 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 9 = 0.498 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 all KL = 0.454 +- 0.235 (in-sample avg dev_std = 0.316)
NEC for r=0.6 all L1 = 0.487 +- 0.177 (in-sample avg dev_std = 0.316)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.314 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.045 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.428 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 3 = 0.451 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 4 = 0.284 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 5 = 0.534 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 6 = 0.437 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 7 = 0.378 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 8 = 0.319 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 9 = 0.483 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.521 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.361 +- 0.266 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.961
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.855
NEC for r=1.0 class 0 = 0.102 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 1 = 0.015 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 2 = 0.301 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 3 = 0.247 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 4 = 0.167 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 5 = 0.343 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 6 = 0.24 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 7 = 0.198 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 8 = 0.191 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 9 = 0.321 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all KL = 0.358 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all L1 = 0.208 +- 0.232 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.086
NEC for r=0.3 class 0 = 0.354 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 1 = 0.314 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 2 = 0.396 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 3 = 0.329 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 4 = 0.338 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 5 = 0.326 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 6 = 0.345 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 7 = 0.333 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 8 = 0.38 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 9 = 0.341 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.193 +- 0.134 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.345 +- 0.126 (in-sample avg dev_std = 0.231)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.192
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.155
NEC for r=0.6 class 0 = 0.266 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.41 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.267 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 3 = 0.335 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 4 = 0.453 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 5 = 0.31 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 6 = 0.413 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 7 = 0.373 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 8 = 0.401 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 9 = 0.489 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.317 +- 0.238 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.374 +- 0.222 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.554
NEC for r=0.9 class 0 = 0.564 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 1 = 0.106 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 2 = 0.41 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 3 = 0.488 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 4 = 0.419 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 5 = 0.495 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 6 = 0.524 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 7 = 0.327 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 8 = 0.465 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 9 = 0.522 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 all KL = 0.558 +- 0.325 (in-sample avg dev_std = 0.433)
NEC for r=0.9 all L1 = 0.426 +- 0.260 (in-sample avg dev_std = 0.433)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.826
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.72
NEC for r=1.0 class 0 = 0.278 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 1 = 0.058 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 2 = 0.358 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 3 = 0.312 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 4 = 0.27 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 5 = 0.357 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 6 = 0.387 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 7 = 0.219 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 8 = 0.331 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 9 = 0.461 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all KL = 0.42 +- 0.340 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all L1 = 0.299 +- 0.264 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.099
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.092
NEC for r=0.3 class 0 = 0.349 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 1 = 0.314 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 2 = 0.338 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 3 = 0.341 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 4 = 0.32 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 5 = 0.318 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 6 = 0.342 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 7 = 0.329 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 8 = 0.323 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 9 = 0.321 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all KL = 0.191 +- 0.144 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all L1 = 0.33 +- 0.134 (in-sample avg dev_std = 0.242)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.161
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
NEC for r=0.6 class 0 = 0.123 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 1 = 0.409 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 2 = 0.157 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 3 = 0.184 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 4 = 0.203 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 5 = 0.201 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 6 = 0.166 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 7 = 0.274 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 8 = 0.25 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 9 = 0.255 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.174 +- 0.204 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.224 +- 0.209 (in-sample avg dev_std = 0.191)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.229
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.239
NEC for r=0.9 class 0 = 0.539 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 1 = 0.062 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 2 = 0.513 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 3 = 0.518 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 4 = 0.544 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 5 = 0.486 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 6 = 0.499 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 7 = 0.41 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 8 = 0.544 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 9 = 0.437 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 all KL = 0.545 +- 0.378 (in-sample avg dev_std = 0.303)
NEC for r=0.9 all L1 = 0.451 +- 0.321 (in-sample avg dev_std = 0.303)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.183
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.226
NEC for r=1.0 class 0 = 0.5 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 1 = 0.065 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 2 = 0.463 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 3 = 0.449 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 4 = 0.322 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 5 = 0.46 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 6 = 0.355 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 7 = 0.276 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 8 = 0.494 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 9 = 0.323 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 all KL = 0.506 +- 0.437 (in-sample avg dev_std = 0.312)
NEC for r=1.0 all L1 = 0.368 +- 0.350 (in-sample avg dev_std = 0.312)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Apr 14 23:59:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/14/2024 11:59:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.483 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 1 = 0.462 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 2 = 0.461 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 3 = 0.469 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 4 = 0.445 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 5 = 0.482 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 6 = 0.451 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 7 = 0.49 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 8 = 0.465 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 9 = 0.437 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all KL = 0.458 +- 0.238 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all L1 = 0.465 +- 0.146 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.172
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.153
SUFF++ for r=0.6 class 0 = 0.374 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.411 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.436 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 3 = 0.487 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 4 = 0.497 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 5 = 0.419 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 6 = 0.485 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 7 = 0.375 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 8 = 0.616 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 9 = 0.479 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.31 +- 0.298 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.457 +- 0.240 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.756
SUFF++ for r=0.9 class 0 = 0.948 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 1 = 0.956 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 2 = 0.738 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 3 = 0.67 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 4 = 0.841 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 5 = 0.716 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 6 = 0.756 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 7 = 0.81 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 8 = 0.886 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 9 = 0.739 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all KL = 0.799 +- 0.270 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all L1 = 0.808 +- 0.225 (in-sample avg dev_std = 0.305)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.515 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 1 = 0.574 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 2 = 0.545 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 3 = 0.549 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 4 = 0.52 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 5 = 0.56 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 6 = 0.51 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 7 = 0.509 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 8 = 0.521 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 9 = 0.526 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all KL = 0.568 +- 0.243 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all L1 = 0.533 +- 0.171 (in-sample avg dev_std = 0.385)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.189
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.142
SUFF++ for r=0.6 class 0 = 0.472 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 1 = 0.413 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 2 = 0.513 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 3 = 0.465 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 4 = 0.461 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 5 = 0.411 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 6 = 0.469 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 7 = 0.452 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 8 = 0.445 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 9 = 0.424 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all KL = 0.363 +- 0.295 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all L1 = 0.452 +- 0.218 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.639
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.604
SUFF++ for r=0.9 class 0 = 0.787 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 1 = 0.973 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 2 = 0.73 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 3 = 0.7 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 4 = 0.765 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 5 = 0.738 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 6 = 0.705 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 7 = 0.847 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 8 = 0.665 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 9 = 0.68 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all KL = 0.774 +- 0.255 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all L1 = 0.763 +- 0.218 (in-sample avg dev_std = 0.324)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.427 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 1 = 0.433 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 2 = 0.44 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 3 = 0.493 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 4 = 0.523 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 5 = 0.493 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 6 = 0.515 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 7 = 0.474 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 8 = 0.509 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 class 9 = 0.538 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 all KL = 0.402 +- 0.281 (in-sample avg dev_std = 0.593)
SUFF++ for r=0.3 all L1 = 0.483 +- 0.179 (in-sample avg dev_std = 0.593)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.189
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.185
SUFF++ for r=0.6 class 0 = 0.627 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 1 = 0.746 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 2 = 0.727 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 3 = 0.701 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 4 = 0.631 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 5 = 0.686 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 6 = 0.586 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 7 = 0.59 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 8 = 0.679 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 9 = 0.544 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all KL = 0.586 +- 0.362 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.289 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.172
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.181
SUFF++ for r=0.9 class 0 = 0.849 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 1 = 0.992 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 2 = 0.863 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 3 = 0.866 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 4 = 0.851 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 5 = 0.849 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 6 = 0.883 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 7 = 0.889 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 8 = 0.843 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 9 = 0.891 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 all KL = 0.889 +- 0.207 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 all L1 = 0.879 +- 0.188 (in-sample avg dev_std = 0.226)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.427 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 1 = 0.497 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 2 = 0.505 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 3 = 0.447 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 4 = 0.476 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 5 = 0.442 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 6 = 0.498 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 7 = 0.437 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 8 = 0.479 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 9 = 0.508 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all KL = 0.389 +- 0.233 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all L1 = 0.472 +- 0.159 (in-sample avg dev_std = 0.293)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.172
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.137
NEC for r=0.6 class 0 = 0.487 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 1 = 0.538 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 2 = 0.461 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 3 = 0.361 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 4 = 0.387 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 5 = 0.397 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 6 = 0.422 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 7 = 0.522 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 8 = 0.322 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 9 = 0.442 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all KL = 0.472 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all L1 = 0.437 +- 0.252 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.605
NEC for r=0.9 class 0 = 0.274 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 1 = 0.174 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 2 = 0.507 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 3 = 0.64 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 4 = 0.33 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 5 = 0.551 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 6 = 0.45 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 7 = 0.378 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 8 = 0.302 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 class 9 = 0.477 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 all KL = 0.586 +- 0.336 (in-sample avg dev_std = 0.468)
NEC for r=0.9 all L1 = 0.405 +- 0.270 (in-sample avg dev_std = 0.468)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.952
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.833
NEC for r=1.0 class 0 = 0.095 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 1 = 0.016 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 2 = 0.287 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 3 = 0.386 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 4 = 0.159 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 5 = 0.373 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 6 = 0.285 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 7 = 0.18 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 8 = 0.191 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 9 = 0.358 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 all KL = 0.384 +- 0.360 (in-sample avg dev_std = 0.402)
NEC for r=1.0 all L1 = 0.228 +- 0.251 (in-sample avg dev_std = 0.402)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
NEC for r=0.3 class 0 = 0.444 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 1 = 0.372 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 2 = 0.423 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 3 = 0.401 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 4 = 0.438 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 5 = 0.416 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 6 = 0.462 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 7 = 0.453 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 8 = 0.448 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 9 = 0.444 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all KL = 0.338 +- 0.205 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all L1 = 0.429 +- 0.161 (in-sample avg dev_std = 0.303)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.189
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.156
NEC for r=0.6 class 0 = 0.42 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 1 = 0.459 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 2 = 0.451 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 3 = 0.448 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 4 = 0.453 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 5 = 0.47 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 6 = 0.48 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 7 = 0.475 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 8 = 0.472 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 9 = 0.474 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 all KL = 0.459 +- 0.270 (in-sample avg dev_std = 0.381)
NEC for r=0.6 all L1 = 0.46 +- 0.219 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.639
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.503
NEC for r=0.9 class 0 = 0.527 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 1 = 0.061 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 2 = 0.393 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 3 = 0.575 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 4 = 0.417 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 5 = 0.447 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 6 = 0.539 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 7 = 0.298 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 8 = 0.537 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 9 = 0.492 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 all KL = 0.533 +- 0.336 (in-sample avg dev_std = 0.431)
NEC for r=0.9 all L1 = 0.422 +- 0.271 (in-sample avg dev_std = 0.431)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.621
NEC for r=1.0 class 0 = 0.439 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 1 = 0.024 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 2 = 0.366 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 3 = 0.497 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 4 = 0.313 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 5 = 0.336 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 6 = 0.446 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 7 = 0.208 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 8 = 0.451 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 9 = 0.445 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all KL = 0.457 +- 0.347 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all L1 = 0.347 +- 0.277 (in-sample avg dev_std = 0.426)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
NEC for r=0.3 class 0 = 0.362 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 1 = 0.347 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 2 = 0.367 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 3 = 0.373 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 4 = 0.362 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 5 = 0.376 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 6 = 0.394 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 7 = 0.411 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 8 = 0.413 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 9 = 0.38 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 all KL = 0.326 +- 0.258 (in-sample avg dev_std = 0.333)
NEC for r=0.3 all L1 = 0.378 +- 0.193 (in-sample avg dev_std = 0.333)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.189
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.188
NEC for r=0.6 class 0 = 0.311 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 1 = 0.124 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 2 = 0.292 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 3 = 0.283 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 4 = 0.28 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 5 = 0.287 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 6 = 0.286 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 7 = 0.344 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 8 = 0.298 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 9 = 0.382 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 all KL = 0.318 +- 0.292 (in-sample avg dev_std = 0.352)
NEC for r=0.6 all L1 = 0.287 +- 0.250 (in-sample avg dev_std = 0.352)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.172
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.182
NEC for r=0.9 class 0 = 0.253 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.013 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.202 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 3 = 0.23 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 4 = 0.265 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 5 = 0.25 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 6 = 0.175 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 7 = 0.205 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 8 = 0.259 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 9 = 0.168 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.238 +- 0.315 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.199 +- 0.260 (in-sample avg dev_std = 0.259)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.147
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.164
NEC for r=1.0 class 0 = 0.289 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 1 = 0.009 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 2 = 0.295 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 3 = 0.257 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 4 = 0.185 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 5 = 0.303 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 6 = 0.137 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 7 = 0.119 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 8 = 0.219 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 9 = 0.127 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all KL = 0.271 +- 0.363 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all L1 = 0.192 +- 0.272 (in-sample avg dev_std = 0.257)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.728, 0.345, 0.844, 1.0], 'all_L1': [0.591, 0.393, 0.833, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.477, 0.787, 1.0], 'all_L1': [0.56, 0.457, 0.811, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.189, 0.133, 1.0], 'all_L1': [0.433, 0.354, 0.329, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.628, 0.336, 0.832, 1.0], 'all_L1': [0.536, 0.396, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.31, 0.799, 1.0], 'all_L1': [0.465, 0.457, 0.808, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.253, 0.443, 0.504, 0.345], 'all_L1': [0.414, 0.492, 0.367, 0.222]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.399, 0.521, 0.345], 'all_L1': [0.353, 0.474, 0.37, 0.212]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.768, 0.621, 0.371], 'all_L1': [0.544, 0.651, 0.473, 0.215]}), defaultdict(<class 'list'>, {'all_KL': [0.227, 0.454, 0.521, 0.358], 'all_L1': [0.388, 0.487, 0.361, 0.208]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.472, 0.586, 0.384], 'all_L1': [0.472, 0.437, 0.405, 0.228]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.727, 0.365, 0.841, 1.0], 'all_L1': [0.6, 0.412, 0.811, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.69, 0.544, 0.775, 1.0], 'all_L1': [0.564, 0.493, 0.786, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.415, 0.204, 0.214, 1.0], 'all_L1': [0.413, 0.359, 0.374, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.642, 0.421, 0.817, 1.0], 'all_L1': [0.55, 0.487, 0.795, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.363, 0.774, 1.0], 'all_L1': [0.533, 0.452, 0.763, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.213, 0.406, 0.513, 0.355], 'all_L1': [0.382, 0.457, 0.394, 0.265]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.351, 0.544, 0.368], 'all_L1': [0.361, 0.446, 0.416, 0.264]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.749, 0.579, 0.456], 'all_L1': [0.542, 0.638, 0.493, 0.334]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.317, 0.558, 0.42], 'all_L1': [0.345, 0.374, 0.426, 0.299]}), defaultdict(<class 'list'>, {'all_KL': [0.338, 0.459, 0.533, 0.457], 'all_L1': [0.429, 0.46, 0.422, 0.347]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.69, 0.508, 0.77, 1.0], 'all_L1': [0.594, 0.496, 0.717, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.534, 0.791, 1.0], 'all_L1': [0.553, 0.488, 0.717, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.129, 0.055, 1.0], 'all_L1': [0.382, 0.314, 0.319, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.359, 0.763, 1.0], 'all_L1': [0.563, 0.512, 0.762, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.586, 0.889, 1.0], 'all_L1': [0.483, 0.653, 0.879, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.202, 0.35, 0.517, 0.56], 'all_L1': [0.364, 0.421, 0.478, 0.476]}), defaultdict(<class 'list'>, {'all_KL': [0.177, 0.36, 0.462, 0.471], 'all_L1': [0.353, 0.448, 0.46, 0.449]}), defaultdict(<class 'list'>, {'all_KL': [0.556, 0.801, 0.543, 0.473], 'all_L1': [0.59, 0.67, 0.472, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.174, 0.545, 0.506], 'all_L1': [0.33, 0.224, 0.451, 0.368]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.318, 0.238, 0.271], 'all_L1': [0.378, 0.287, 0.199, 0.192]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.517 +- 0.059, 0.411 +- 0.040, 0.723 +- 0.197, 1.000 +- 0.000
suff++ class all_KL  =  0.592 +- 0.107, 0.331 +- 0.092, 0.679 +- 0.274, 1.000 +- 0.000
suff++_acc_int  =  0.103 +- 0.004, 0.182 +- 0.023, 0.672 +- 0.197
nec class all_L1  =  0.434 +- 0.067, 0.508 +- 0.074, 0.395 +- 0.042, 0.217 +- 0.007
nec class all_KL  =  0.300 +- 0.102, 0.507 +- 0.133, 0.551 +- 0.045, 0.361 +- 0.015
nec_acc_int  =  0.104 +- 0.005, 0.200 +- 0.040, 0.634 +- 0.036, 0.846 +- 0.010

Eval split val
suff++ class all_L1  =  0.532 +- 0.063, 0.441 +- 0.050, 0.706 +- 0.167, 1.000 +- 0.000
suff++ class all_KL  =  0.608 +- 0.110, 0.379 +- 0.110, 0.684 +- 0.236, 1.000 +- 0.000
suff++_acc_int  =  0.103 +- 0.004, 0.157 +- 0.021, 0.588 +- 0.199
nec class all_L1  =  0.412 +- 0.071, 0.475 +- 0.087, 0.430 +- 0.033, 0.302 +- 0.034
nec class all_KL  =  0.276 +- 0.105, 0.456 +- 0.154, 0.545 +- 0.022, 0.411 +- 0.043
nec_acc_int  =  0.098 +- 0.007, 0.173 +- 0.028, 0.538 +- 0.077, 0.710 +- 0.059

Eval split test
suff++ class all_L1  =  0.515 +- 0.076, 0.493 +- 0.108, 0.679 +- 0.189, 1.000 +- 0.000
suff++ class all_KL  =  0.560 +- 0.143, 0.423 +- 0.165, 0.654 +- 0.303, 1.000 +- 0.000
suff++_acc_int  =  0.110 +- 0.010, 0.154 +- 0.035, 0.264 +- 0.110
nec class all_L1  =  0.403 +- 0.095, 0.410 +- 0.154, 0.412 +- 0.107, 0.380 +- 0.101
nec class all_KL  =  0.290 +- 0.143, 0.401 +- 0.211, 0.461 +- 0.115, 0.456 +- 0.098
nec_acc_int  =  0.112 +- 0.015, 0.168 +- 0.038, 0.255 +- 0.080, 0.270 +- 0.097


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.476 +- 0.017, 0.460 +- 0.023, 0.559 +- 0.079, 0.609 +- 0.004
Faith. Armon (L1)= 		  =  0.464 +- 0.020, 0.449 +- 0.011, 0.490 +- 0.052, 0.357 +- 0.010
Faith. GMean (L1)= 	  =  0.470 +- 0.018, 0.454 +- 0.016, 0.523 +- 0.065, 0.466 +- 0.008
Faith. Aritm (KL)= 		  =  0.446 +- 0.027, 0.419 +- 0.034, 0.615 +- 0.120, 0.680 +- 0.008
Faith. Armon (KL)= 		  =  0.375 +- 0.063, 0.377 +- 0.042, 0.559 +- 0.171, 0.530 +- 0.016
Faith. GMean (KL)= 	  =  0.408 +- 0.041, 0.396 +- 0.020, 0.585 +- 0.149, 0.600 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.472 +- 0.015, 0.458 +- 0.025, 0.568 +- 0.067, 0.651 +- 0.017
Faith. Armon (L1)= 		  =  0.455 +- 0.020, 0.448 +- 0.017, 0.520 +- 0.048, 0.463 +- 0.040
Faith. GMean (L1)= 	  =  0.463 +- 0.017, 0.453 +- 0.020, 0.543 +- 0.057, 0.548 +- 0.031
Faith. Aritm (KL)= 		  =  0.442 +- 0.018, 0.418 +- 0.039, 0.615 +- 0.110, 0.706 +- 0.021
Faith. Armon (KL)= 		  =  0.354 +- 0.063, 0.380 +- 0.037, 0.577 +- 0.133, 0.581 +- 0.043
Faith. GMean (KL)= 	  =  0.394 +- 0.038, 0.397 +- 0.024, 0.595 +- 0.122, 0.640 +- 0.034

Eval split test
Faith. Aritm (L1)= 		  =  0.459 +- 0.021, 0.451 +- 0.043, 0.545 +- 0.079, 0.690 +- 0.050
Faith. Armon (L1)= 		  =  0.437 +- 0.018, 0.412 +- 0.056, 0.481 +- 0.107, 0.542 +- 0.116
Faith. GMean (L1)= 	  =  0.448 +- 0.019, 0.431 +- 0.048, 0.510 +- 0.088, 0.610 +- 0.090
Faith. Aritm (KL)= 		  =  0.425 +- 0.034, 0.412 +- 0.074, 0.557 +- 0.133, 0.728 +- 0.049
Faith. Armon (KL)= 		  =  0.339 +- 0.059, 0.343 +- 0.094, 0.463 +- 0.204, 0.620 +- 0.101
Faith. GMean (KL)= 	  =  0.378 +- 0.039, 0.373 +- 0.075, 0.503 +- 0.178, 0.671 +- 0.078
Computed for split load_split = id



Completed in  1:48:43.733433  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 00:21:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.598 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 1 = 0.558 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 2 = 0.597 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 3 = 0.601 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 4 = 0.588 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 5 = 0.587 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 6 = 0.602 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 7 = 0.59 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 8 = 0.582 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 9 = 0.588 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all KL = 0.724 +- 0.143 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all L1 = 0.589 +- 0.108 (in-sample avg dev_std = 0.250)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.257
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.173
SUFF++ for r=0.6 class 0 = 0.393 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 1 = 0.391 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 2 = 0.374 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 3 = 0.394 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 4 = 0.396 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 5 = 0.392 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 6 = 0.425 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 7 = 0.399 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 8 = 0.381 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 9 = 0.405 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all KL = 0.351 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all L1 = 0.395 +- 0.129 (in-sample avg dev_std = 0.397)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.779
SUFF++ for r=0.9 class 0 = 0.932 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 1 = 0.926 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 3 = 0.752 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 4 = 0.816 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 5 = 0.748 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 6 = 0.825 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 7 = 0.839 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 8 = 0.866 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 9 = 0.777 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all KL = 0.843 +- 0.226 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.198 (in-sample avg dev_std = 0.251)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.621 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 1 = 0.569 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 2 = 0.604 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 3 = 0.613 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 4 = 0.592 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 5 = 0.605 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 6 = 0.602 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 7 = 0.602 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 8 = 0.589 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 9 = 0.589 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all KL = 0.723 +- 0.143 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.114 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.164
SUFF++ for r=0.6 class 0 = 0.403 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.415 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.406 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 3 = 0.427 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 4 = 0.423 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 5 = 0.411 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 6 = 0.398 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 7 = 0.43 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 8 = 0.398 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 9 = 0.41 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.368 +- 0.226 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.413 +- 0.140 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.757
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.726
SUFF++ for r=0.9 class 0 = 0.914 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 1 = 0.951 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 2 = 0.768 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 3 = 0.814 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 4 = 0.751 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 5 = 0.736 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 6 = 0.771 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 7 = 0.861 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 8 = 0.802 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 9 = 0.725 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all KL = 0.843 +- 0.211 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all L1 = 0.812 +- 0.205 (in-sample avg dev_std = 0.241)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.122
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.612 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 1 = 0.565 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 2 = 0.617 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 3 = 0.601 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 4 = 0.606 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 5 = 0.612 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 6 = 0.592 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 7 = 0.589 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 8 = 0.579 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 9 = 0.577 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 all KL = 0.695 +- 0.163 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 all L1 = 0.595 +- 0.125 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.207
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.163
SUFF++ for r=0.6 class 0 = 0.457 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 1 = 0.476 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 2 = 0.521 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 3 = 0.499 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 4 = 0.509 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 5 = 0.475 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 6 = 0.496 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 7 = 0.534 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 8 = 0.474 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 9 = 0.452 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all KL = 0.504 +- 0.247 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all L1 = 0.489 +- 0.173 (in-sample avg dev_std = 0.366)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.376
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.36
SUFF++ for r=0.9 class 0 = 0.674 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 1 = 0.802 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 2 = 0.781 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 3 = 0.69 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 4 = 0.744 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 5 = 0.669 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 6 = 0.687 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 7 = 0.741 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 8 = 0.697 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 9 = 0.689 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 all KL = 0.775 +- 0.217 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 all L1 = 0.719 +- 0.185 (in-sample avg dev_std = 0.326)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.114
NEC for r=0.3 class 0 = 0.378 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 1 = 0.419 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 2 = 0.402 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 3 = 0.402 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 4 = 0.411 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 5 = 0.403 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 6 = 0.415 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 7 = 0.394 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 8 = 0.416 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 9 = 0.404 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 all KL = 0.244 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 all L1 = 0.404 +- 0.117 (in-sample avg dev_std = 0.223)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.257
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.218
NEC for r=0.6 class 0 = 0.512 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 1 = 0.458 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 2 = 0.479 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 3 = 0.497 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 4 = 0.511 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 5 = 0.488 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 6 = 0.495 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 7 = 0.509 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 8 = 0.507 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 9 = 0.525 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all KL = 0.448 +- 0.203 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all L1 = 0.498 +- 0.140 (in-sample avg dev_std = 0.333)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.661
NEC for r=0.9 class 0 = 0.267 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 1 = 0.194 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 2 = 0.346 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 3 = 0.473 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 4 = 0.394 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 5 = 0.531 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 6 = 0.381 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 7 = 0.397 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 8 = 0.313 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 9 = 0.463 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all KL = 0.515 +- 0.308 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all L1 = 0.372 +- 0.249 (in-sample avg dev_std = 0.434)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.943
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.84
NEC for r=1.0 class 0 = 0.083 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 1 = 0.042 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 2 = 0.261 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 3 = 0.314 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 4 = 0.214 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 5 = 0.363 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 6 = 0.243 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 7 = 0.216 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 8 = 0.165 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 class 9 = 0.347 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all KL = 0.344 +- 0.323 (in-sample avg dev_std = 0.367)
NEC for r=1.0 all L1 = 0.22 +- 0.236 (in-sample avg dev_std = 0.367)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
NEC for r=0.3 class 0 = 0.373 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 1 = 0.393 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 2 = 0.386 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 3 = 0.392 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 4 = 0.383 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 5 = 0.365 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 6 = 0.382 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 7 = 0.379 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 8 = 0.381 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 9 = 0.393 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all KL = 0.214 +- 0.144 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all L1 = 0.383 +- 0.114 (in-sample avg dev_std = 0.204)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.218
NEC for r=0.6 class 0 = 0.416 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 1 = 0.361 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 2 = 0.444 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 3 = 0.482 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 4 = 0.492 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 5 = 0.448 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 6 = 0.497 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 7 = 0.463 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 8 = 0.483 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 class 9 = 0.506 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 all KL = 0.405 +- 0.215 (in-sample avg dev_std = 0.318)
NEC for r=0.6 all L1 = 0.458 +- 0.169 (in-sample avg dev_std = 0.318)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.757
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0 = 0.423 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.09 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.376 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 3 = 0.455 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 4 = 0.449 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 5 = 0.496 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 6 = 0.492 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 7 = 0.291 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 8 = 0.334 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 9 = 0.51 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.5 +- 0.311 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.387 +- 0.255 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.841
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.755
NEC for r=1.0 class 0 = 0.169 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 1 = 0.021 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 2 = 0.295 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 3 = 0.321 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 4 = 0.316 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 5 = 0.392 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 6 = 0.376 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 7 = 0.147 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 8 = 0.255 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 9 = 0.466 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all KL = 0.364 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all L1 = 0.272 +- 0.250 (in-sample avg dev_std = 0.378)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.122
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
NEC for r=0.3 class 0 = 0.354 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 1 = 0.365 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 2 = 0.372 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 3 = 0.363 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 4 = 0.35 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 5 = 0.355 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 6 = 0.38 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 7 = 0.362 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 8 = 0.372 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 9 = 0.379 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all KL = 0.201 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all L1 = 0.365 +- 0.119 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.207
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.193
NEC for r=0.6 class 0 = 0.412 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 1 = 0.278 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 2 = 0.419 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 3 = 0.416 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 4 = 0.456 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 5 = 0.441 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 6 = 0.452 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 7 = 0.42 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 8 = 0.471 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 9 = 0.482 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 all KL = 0.344 +- 0.204 (in-sample avg dev_std = 0.290)
NEC for r=0.6 all L1 = 0.423 +- 0.175 (in-sample avg dev_std = 0.290)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.376
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.312
NEC for r=0.9 class 0 = 0.559 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 1 = 0.368 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 2 = 0.447 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 3 = 0.555 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 4 = 0.423 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 5 = 0.513 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 6 = 0.532 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 7 = 0.408 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 8 = 0.519 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 class 9 = 0.516 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 all KL = 0.517 +- 0.272 (in-sample avg dev_std = 0.378)
NEC for r=0.9 all L1 = 0.482 +- 0.215 (in-sample avg dev_std = 0.378)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.342
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.366
NEC for r=1.0 class 0 = 0.577 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 1 = 0.116 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 2 = 0.353 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 3 = 0.5 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 4 = 0.558 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 5 = 0.547 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 6 = 0.59 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 7 = 0.503 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 8 = 0.574 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 class 9 = 0.544 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 all KL = 0.56 +- 0.316 (in-sample avg dev_std = 0.349)
NEC for r=1.0 all L1 = 0.48 +- 0.266 (in-sample avg dev_std = 0.349)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 01:03:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
SUFF++ for r=0.3 class 0 = 0.576 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 1 = 0.531 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 3 = 0.562 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 4 = 0.561 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 5 = 0.561 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 6 = 0.558 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 7 = 0.554 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 8 = 0.578 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 class 9 = 0.545 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 all KL = 0.67 +- 0.135 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.3 all L1 = 0.559 +- 0.085 (in-sample avg dev_std = 0.317)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.283
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.209
SUFF++ for r=0.6 class 0 = 0.514 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 1 = 0.509 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 2 = 0.456 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 3 = 0.44 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 4 = 0.449 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 5 = 0.463 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 6 = 0.455 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 7 = 0.47 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 8 = 0.431 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 9 = 0.428 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all KL = 0.489 +- 0.222 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all L1 = 0.462 +- 0.147 (in-sample avg dev_std = 0.274)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.784
SUFF++ for r=0.9 class 0 = 0.94 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 1 = 0.96 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 2 = 0.787 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 3 = 0.716 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 4 = 0.827 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 5 = 0.771 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 6 = 0.819 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 7 = 0.819 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 8 = 0.767 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 class 9 = 0.752 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all KL = 0.804 +- 0.253 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.9 all L1 = 0.818 +- 0.205 (in-sample avg dev_std = 0.283)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.575 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 1 = 0.535 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 2 = 0.576 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 3 = 0.581 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 4 = 0.56 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 5 = 0.566 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 6 = 0.563 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 7 = 0.565 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 8 = 0.576 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 9 = 0.56 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all KL = 0.69 +- 0.122 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all L1 = 0.565 +- 0.081 (in-sample avg dev_std = 0.294)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.271
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.202
SUFF++ for r=0.6 class 0 = 0.529 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 1 = 0.544 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 2 = 0.512 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 3 = 0.477 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 4 = 0.458 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 5 = 0.496 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 6 = 0.476 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 7 = 0.495 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 8 = 0.454 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 9 = 0.457 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all KL = 0.538 +- 0.218 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all L1 = 0.49 +- 0.153 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.725
SUFF++ for r=0.9 class 0 = 0.896 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 1 = 0.961 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 2 = 0.762 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 3 = 0.746 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 4 = 0.78 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 5 = 0.731 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 6 = 0.725 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 7 = 0.832 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 8 = 0.682 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 9 = 0.717 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all KL = 0.776 +- 0.260 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all L1 = 0.786 +- 0.210 (in-sample avg dev_std = 0.304)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.56 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 1 = 0.531 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 2 = 0.562 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 3 = 0.57 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 4 = 0.543 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 5 = 0.567 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 6 = 0.553 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 7 = 0.548 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 8 = 0.554 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 9 = 0.563 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all KL = 0.675 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.082 (in-sample avg dev_std = 0.314)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.238
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.203
SUFF++ for r=0.6 class 0 = 0.506 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 1 = 0.512 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 2 = 0.535 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 3 = 0.503 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 4 = 0.473 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 5 = 0.494 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 6 = 0.489 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 7 = 0.491 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 8 = 0.484 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 class 9 = 0.432 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all KL = 0.54 +- 0.228 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.6 all L1 = 0.493 +- 0.157 (in-sample avg dev_std = 0.250)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.429
SUFF++ for r=0.9 class 0 = 0.687 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 1 = 0.87 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 2 = 0.7 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 3 = 0.685 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 4 = 0.774 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 5 = 0.754 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 6 = 0.729 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 7 = 0.699 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 8 = 0.665 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 9 = 0.689 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all KL = 0.795 +- 0.205 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all L1 = 0.726 +- 0.190 (in-sample avg dev_std = 0.301)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.364 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 1 = 0.362 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 2 = 0.341 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 3 = 0.35 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 4 = 0.342 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 5 = 0.351 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 6 = 0.361 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 7 = 0.365 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 8 = 0.352 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 9 = 0.357 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 all KL = 0.179 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 all L1 = 0.355 +- 0.108 (in-sample avg dev_std = 0.183)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.283
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.244
NEC for r=0.6 class 0 = 0.418 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 1 = 0.398 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 2 = 0.48 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 3 = 0.507 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 4 = 0.496 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 5 = 0.47 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 6 = 0.493 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 7 = 0.474 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 8 = 0.522 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 9 = 0.522 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 all KL = 0.397 +- 0.202 (in-sample avg dev_std = 0.285)
NEC for r=0.6 all L1 = 0.477 +- 0.135 (in-sample avg dev_std = 0.285)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.678
NEC for r=0.9 class 0 = 0.257 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 1 = 0.06 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 2 = 0.361 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 3 = 0.547 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 4 = 0.358 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 5 = 0.459 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 6 = 0.378 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 7 = 0.351 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 8 = 0.487 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 class 9 = 0.5 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 all KL = 0.53 +- 0.324 (in-sample avg dev_std = 0.428)
NEC for r=0.9 all L1 = 0.37 +- 0.257 (in-sample avg dev_std = 0.428)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.949
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.856
NEC for r=1.0 class 0 = 0.079 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 1 = 0.017 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 2 = 0.256 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 3 = 0.293 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 4 = 0.208 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 5 = 0.29 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 6 = 0.239 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 7 = 0.195 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 8 = 0.246 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 class 9 = 0.349 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 all KL = 0.351 +- 0.336 (in-sample avg dev_std = 0.370)
NEC for r=1.0 all L1 = 0.213 +- 0.235 (in-sample avg dev_std = 0.370)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.351 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 1 = 0.379 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 2 = 0.362 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 3 = 0.35 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 4 = 0.351 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 5 = 0.37 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 6 = 0.359 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 7 = 0.366 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 8 = 0.347 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 9 = 0.361 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all KL = 0.179 +- 0.116 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all L1 = 0.36 +- 0.102 (in-sample avg dev_std = 0.177)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.271
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.226
NEC for r=0.6 class 0 = 0.404 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 1 = 0.342 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 2 = 0.416 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 3 = 0.442 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 4 = 0.487 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 5 = 0.441 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 6 = 0.491 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 7 = 0.448 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 8 = 0.479 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 9 = 0.493 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 all KL = 0.349 +- 0.202 (in-sample avg dev_std = 0.267)
NEC for r=0.6 all L1 = 0.443 +- 0.146 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.615
NEC for r=0.9 class 0 = 0.428 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 1 = 0.039 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 2 = 0.378 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 3 = 0.537 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 4 = 0.384 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 5 = 0.476 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 6 = 0.496 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 7 = 0.326 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 8 = 0.561 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 9 = 0.513 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 all KL = 0.53 +- 0.320 (in-sample avg dev_std = 0.408)
NEC for r=0.9 all L1 = 0.407 +- 0.257 (in-sample avg dev_std = 0.408)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.887
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.781
NEC for r=1.0 class 0 = 0.174 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 1 = 0.017 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 2 = 0.298 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 3 = 0.361 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 4 = 0.263 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 5 = 0.296 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 6 = 0.352 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 7 = 0.184 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 8 = 0.428 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 9 = 0.39 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 all KL = 0.375 +- 0.318 (in-sample avg dev_std = 0.377)
NEC for r=1.0 all L1 = 0.272 +- 0.247 (in-sample avg dev_std = 0.377)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.341 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 1 = 0.36 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 2 = 0.349 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 3 = 0.345 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 4 = 0.368 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 5 = 0.341 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 6 = 0.362 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 7 = 0.349 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 8 = 0.361 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 9 = 0.348 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 all KL = 0.174 +- 0.118 (in-sample avg dev_std = 0.180)
NEC for r=0.3 all L1 = 0.352 +- 0.105 (in-sample avg dev_std = 0.180)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.238
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.217
NEC for r=0.6 class 0 = 0.416 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 1 = 0.377 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 2 = 0.409 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 3 = 0.432 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 4 = 0.481 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 5 = 0.435 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 6 = 0.478 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 7 = 0.467 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 8 = 0.475 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 9 = 0.529 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.356 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.449 +- 0.149 (in-sample avg dev_std = 0.259)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.382
NEC for r=0.9 class 0 = 0.569 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 1 = 0.186 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 2 = 0.475 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 3 = 0.526 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 4 = 0.375 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 5 = 0.455 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 6 = 0.491 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 7 = 0.468 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 8 = 0.54 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 9 = 0.498 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all KL = 0.464 +- 0.265 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all L1 = 0.456 +- 0.220 (in-sample avg dev_std = 0.349)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.413
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.415
NEC for r=1.0 class 0 = 0.532 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 1 = 0.163 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 2 = 0.468 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 3 = 0.523 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 4 = 0.407 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 5 = 0.372 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 6 = 0.476 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 7 = 0.462 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 8 = 0.545 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 9 = 0.497 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 all KL = 0.46 +- 0.278 (in-sample avg dev_std = 0.352)
NEC for r=1.0 all L1 = 0.442 +- 0.234 (in-sample avg dev_std = 0.352)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 01:45:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:42 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:42 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:42 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:43 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:45:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.151
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.441 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 1 = 0.354 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 2 = 0.447 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 3 = 0.452 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 4 = 0.448 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 5 = 0.461 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 6 = 0.439 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 7 = 0.442 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 8 = 0.45 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 9 = 0.447 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all KL = 0.486 +- 0.182 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all L1 = 0.437 +- 0.092 (in-sample avg dev_std = 0.439)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.279
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.179
SUFF++ for r=0.6 class 0 = 0.287 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.537 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.335 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 3 = 0.329 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 4 = 0.35 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 5 = 0.336 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 6 = 0.326 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 7 = 0.343 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 8 = 0.328 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 9 = 0.344 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.191 +- 0.178 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.354 +- 0.133 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.282
SUFF++ for r=0.9 class 0 = 0.255 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 1 = 0.954 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 2 = 0.299 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 3 = 0.251 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 4 = 0.233 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 5 = 0.268 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 6 = 0.255 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 7 = 0.225 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 8 = 0.269 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 9 = 0.241 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 all KL = 0.135 +- 0.310 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 all L1 = 0.334 +- 0.248 (in-sample avg dev_std = 0.511)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.435 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 1 = 0.287 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 2 = 0.432 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 3 = 0.434 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 4 = 0.423 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 5 = 0.433 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 6 = 0.426 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 7 = 0.42 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 8 = 0.444 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 class 9 = 0.405 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 all KL = 0.418 +- 0.189 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.3 all L1 = 0.412 +- 0.097 (in-sample avg dev_std = 0.469)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.208
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.16
SUFF++ for r=0.6 class 0 = 0.265 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 1 = 0.633 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 2 = 0.309 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 3 = 0.329 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 4 = 0.349 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 5 = 0.327 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 6 = 0.338 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 7 = 0.353 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 8 = 0.324 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 9 = 0.348 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 all KL = 0.205 +- 0.195 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 all L1 = 0.362 +- 0.158 (in-sample avg dev_std = 0.502)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.514
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.197
SUFF++ for r=0.9 class 0 = 0.242 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 1 = 0.956 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 2 = 0.295 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 3 = 0.26 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 4 = 0.33 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 5 = 0.289 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 6 = 0.313 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 7 = 0.294 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 8 = 0.292 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 class 9 = 0.4 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 all KL = 0.216 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.9 all L1 = 0.377 +- 0.285 (in-sample avg dev_std = 0.471)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.147
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.129
SUFF++ for r=0.3 class 0 = 0.459 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 1 = 0.258 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 2 = 0.447 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 3 = 0.415 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 4 = 0.357 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 5 = 0.399 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 6 = 0.392 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 7 = 0.408 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 8 = 0.38 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 class 9 = 0.334 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all KL = 0.372 +- 0.242 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.3 all L1 = 0.384 +- 0.136 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.108
SUFF++ for r=0.6 class 0 = 0.28 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 1 = 0.324 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 2 = 0.303 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 3 = 0.329 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 4 = 0.33 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 5 = 0.339 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 6 = 0.3 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 7 = 0.336 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 8 = 0.339 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 9 = 0.315 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all KL = 0.137 +- 0.156 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all L1 = 0.319 +- 0.115 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.174
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.126
SUFF++ for r=0.9 class 0 = 0.333 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 1 = 0.414 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 2 = 0.305 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 3 = 0.304 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 4 = 0.294 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 5 = 0.292 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 6 = 0.299 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 7 = 0.283 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 8 = 0.308 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 class 9 = 0.341 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 all KL = 0.056 +- 0.169 (in-sample avg dev_std = 0.683)
SUFF++ for r=0.9 all L1 = 0.319 +- 0.160 (in-sample avg dev_std = 0.683)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.151
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
NEC for r=0.3 class 0 = 0.563 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.587 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.544 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 3 = 0.539 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 4 = 0.522 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 5 = 0.526 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 6 = 0.54 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 7 = 0.524 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 8 = 0.54 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 9 = 0.516 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.444 +- 0.210 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.541 +- 0.120 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.279
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.175
NEC for r=0.6 class 0 = 0.714 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 1 = 0.511 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 2 = 0.684 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 3 = 0.684 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 4 = 0.667 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 5 = 0.672 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 6 = 0.639 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 7 = 0.655 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 8 = 0.672 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 9 = 0.634 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all KL = 0.768 +- 0.220 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all L1 = 0.652 +- 0.147 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.584
NEC for r=0.9 class 0 = 0.491 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.052 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.391 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 3 = 0.499 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 4 = 0.564 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 5 = 0.55 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 6 = 0.594 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 7 = 0.541 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 8 = 0.394 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 9 = 0.654 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.613 +- 0.317 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.465 +- 0.255 (in-sample avg dev_std = 0.445)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.953
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0 = 0.103 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 1 = 0.012 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 2 = 0.257 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 3 = 0.241 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 4 = 0.182 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 5 = 0.321 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 6 = 0.306 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 7 = 0.233 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 8 = 0.171 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 9 = 0.335 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 all KL = 0.364 +- 0.351 (in-sample avg dev_std = 0.388)
NEC for r=1.0 all L1 = 0.211 +- 0.239 (in-sample avg dev_std = 0.388)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.15
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.556 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 1 = 0.653 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 2 = 0.547 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 3 = 0.541 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 4 = 0.52 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 5 = 0.529 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 6 = 0.526 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 7 = 0.515 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 8 = 0.523 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 9 = 0.518 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all KL = 0.459 +- 0.231 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all L1 = 0.544 +- 0.133 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.208
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.14
NEC for r=0.6 class 0 = 0.744 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 1 = 0.397 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 2 = 0.673 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 3 = 0.644 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 4 = 0.651 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 5 = 0.656 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 6 = 0.668 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 7 = 0.66 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 8 = 0.648 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 9 = 0.641 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 all KL = 0.747 +- 0.260 (in-sample avg dev_std = 0.362)
NEC for r=0.6 all L1 = 0.634 +- 0.190 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.514
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.401
NEC for r=0.9 class 0 = 0.626 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 1 = 0.068 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 2 = 0.383 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 3 = 0.534 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 4 = 0.561 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 5 = 0.495 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 6 = 0.618 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 7 = 0.556 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 8 = 0.579 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 class 9 = 0.631 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 all KL = 0.589 +- 0.307 (in-sample avg dev_std = 0.403)
NEC for r=0.9 all L1 = 0.5 +- 0.252 (in-sample avg dev_std = 0.403)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.771
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.655
NEC for r=1.0 class 0 = 0.513 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 1 = 0.029 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 2 = 0.346 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 3 = 0.303 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 4 = 0.306 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 5 = 0.36 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 6 = 0.448 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 7 = 0.244 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 8 = 0.475 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 9 = 0.493 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 all KL = 0.472 +- 0.347 (in-sample avg dev_std = 0.405)
NEC for r=1.0 all L1 = 0.346 +- 0.276 (in-sample avg dev_std = 0.405)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.147
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.14
NEC for r=0.3 class 0 = 0.518 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 1 = 0.7 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 2 = 0.521 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 3 = 0.551 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 4 = 0.615 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 5 = 0.551 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 6 = 0.585 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 7 = 0.542 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 8 = 0.599 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 9 = 0.642 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.546 +- 0.291 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.583 +- 0.169 (in-sample avg dev_std = 0.193)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.108
NEC for r=0.6 class 0 = 0.686 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 1 = 0.651 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 2 = 0.672 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 3 = 0.641 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 4 = 0.674 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 5 = 0.629 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 6 = 0.683 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 7 = 0.633 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 8 = 0.679 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 9 = 0.687 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all KL = 0.787 +- 0.263 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all L1 = 0.664 +- 0.192 (in-sample avg dev_std = 0.356)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.174
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.163
NEC for r=0.9 class 0 = 0.312 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 1 = 0.591 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 2 = 0.261 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 3 = 0.423 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 4 = 0.514 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 5 = 0.452 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 6 = 0.491 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 7 = 0.469 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 8 = 0.534 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 class 9 = 0.537 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 all KL = 0.526 +- 0.352 (in-sample avg dev_std = 0.355)
NEC for r=0.9 all L1 = 0.458 +- 0.284 (in-sample avg dev_std = 0.355)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.219
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.195
NEC for r=1.0 class 0 = 0.385 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 1 = 0.395 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 2 = 0.268 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 3 = 0.411 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 4 = 0.444 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 5 = 0.405 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 6 = 0.455 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 7 = 0.402 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 8 = 0.471 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 class 9 = 0.466 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all KL = 0.467 +- 0.347 (in-sample avg dev_std = 0.342)
NEC for r=1.0 all L1 = 0.409 +- 0.285 (in-sample avg dev_std = 0.342)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 02:31:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:31:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.557 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 1 = 0.523 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 2 = 0.531 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 3 = 0.542 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 4 = 0.531 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 5 = 0.533 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 6 = 0.538 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 7 = 0.535 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 8 = 0.543 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 9 = 0.533 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 all KL = 0.624 +- 0.155 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 all L1 = 0.537 +- 0.103 (in-sample avg dev_std = 0.319)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.245
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.173
SUFF++ for r=0.6 class 0 = 0.376 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 1 = 0.394 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 2 = 0.426 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 3 = 0.393 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 4 = 0.4 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 5 = 0.399 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 6 = 0.388 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 7 = 0.415 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 8 = 0.389 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 9 = 0.405 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 all KL = 0.333 +- 0.215 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 all L1 = 0.399 +- 0.140 (in-sample avg dev_std = 0.413)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.795
SUFF++ for r=0.9 class 0 = 0.94 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.972 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.773 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 3 = 0.788 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 4 = 0.86 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 5 = 0.752 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 6 = 0.836 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 7 = 0.838 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 8 = 0.859 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 9 = 0.767 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.846 +- 0.234 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.842 +- 0.205 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.566 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 1 = 0.547 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 2 = 0.54 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 3 = 0.558 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 4 = 0.535 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 5 = 0.552 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 6 = 0.554 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 7 = 0.548 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 8 = 0.543 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 9 = 0.556 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 all KL = 0.644 +- 0.152 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 all L1 = 0.55 +- 0.101 (in-sample avg dev_std = 0.369)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.202
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.143
SUFF++ for r=0.6 class 0 = 0.54 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 1 = 0.409 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 2 = 0.557 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 3 = 0.517 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 4 = 0.441 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 5 = 0.518 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 6 = 0.47 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 7 = 0.494 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 8 = 0.484 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 9 = 0.422 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all KL = 0.419 +- 0.228 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all L1 = 0.483 +- 0.177 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.682
SUFF++ for r=0.9 class 0 = 0.835 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1 = 0.944 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 2 = 0.777 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 3 = 0.811 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 4 = 0.777 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 5 = 0.754 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 6 = 0.746 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 7 = 0.838 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 8 = 0.777 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 9 = 0.703 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.822 +- 0.228 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.211 (in-sample avg dev_std = 0.265)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.56 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 1 = 0.575 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 3 = 0.551 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 4 = 0.551 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 5 = 0.563 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 6 = 0.553 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 7 = 0.565 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 8 = 0.552 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 9 = 0.561 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all KL = 0.662 +- 0.161 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all L1 = 0.56 +- 0.104 (in-sample avg dev_std = 0.392)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.159
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.124
SUFF++ for r=0.6 class 0 = 0.528 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 1 = 0.395 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 2 = 0.557 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 3 = 0.538 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 4 = 0.516 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 5 = 0.537 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 6 = 0.55 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 7 = 0.518 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 8 = 0.547 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 class 9 = 0.496 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 all KL = 0.368 +- 0.210 (in-sample avg dev_std = 0.508)
SUFF++ for r=0.6 all L1 = 0.517 +- 0.153 (in-sample avg dev_std = 0.508)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.237
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.241
SUFF++ for r=0.9 class 0 = 0.713 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 1 = 0.966 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 2 = 0.748 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 3 = 0.736 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 4 = 0.712 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 5 = 0.681 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 6 = 0.722 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 7 = 0.774 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 8 = 0.724 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 9 = 0.769 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 all KL = 0.754 +- 0.289 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.236 (in-sample avg dev_std = 0.345)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.371 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 1 = 0.387 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 2 = 0.386 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 3 = 0.375 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 4 = 0.396 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 5 = 0.384 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 6 = 0.388 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 7 = 0.379 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 8 = 0.393 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 9 = 0.375 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all KL = 0.223 +- 0.145 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all L1 = 0.383 +- 0.121 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.245
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.214
NEC for r=0.6 class 0 = 0.497 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 1 = 0.393 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 2 = 0.452 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 3 = 0.51 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 4 = 0.494 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 5 = 0.499 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 6 = 0.539 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 7 = 0.514 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 8 = 0.503 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 class 9 = 0.509 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 all KL = 0.463 +- 0.237 (in-sample avg dev_std = 0.328)
NEC for r=0.6 all L1 = 0.49 +- 0.180 (in-sample avg dev_std = 0.328)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.286 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 1 = 0.056 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 2 = 0.43 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 3 = 0.459 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 4 = 0.291 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 5 = 0.494 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 6 = 0.426 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 7 = 0.355 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 8 = 0.33 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 9 = 0.48 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 all KL = 0.523 +- 0.342 (in-sample avg dev_std = 0.438)
NEC for r=0.9 all L1 = 0.355 +- 0.265 (in-sample avg dev_std = 0.438)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.956
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.852
NEC for r=1.0 class 0 = 0.107 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 1 = 0.01 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 2 = 0.312 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 3 = 0.242 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 4 = 0.176 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 5 = 0.348 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 6 = 0.241 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 7 = 0.178 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 8 = 0.203 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 9 = 0.341 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all KL = 0.362 +- 0.351 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all L1 = 0.21 +- 0.238 (in-sample avg dev_std = 0.387)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.091
NEC for r=0.3 class 0 = 0.353 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 1 = 0.309 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 2 = 0.378 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 3 = 0.336 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 4 = 0.348 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 5 = 0.332 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 6 = 0.36 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 7 = 0.324 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 8 = 0.37 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 9 = 0.339 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.193 +- 0.139 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.344 +- 0.127 (in-sample avg dev_std = 0.231)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.202
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.167
NEC for r=0.6 class 0 = 0.244 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.394 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.285 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 3 = 0.352 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 4 = 0.457 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 5 = 0.34 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 6 = 0.421 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 7 = 0.405 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 8 = 0.43 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 9 = 0.477 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.326 +- 0.243 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.382 +- 0.222 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.56
NEC for r=0.9 class 0 = 0.554 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 1 = 0.106 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 2 = 0.38 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 3 = 0.478 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 4 = 0.416 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 5 = 0.492 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 6 = 0.544 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 7 = 0.314 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 8 = 0.466 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 class 9 = 0.549 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 all KL = 0.549 +- 0.324 (in-sample avg dev_std = 0.431)
NEC for r=0.9 all L1 = 0.424 +- 0.262 (in-sample avg dev_std = 0.431)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.834
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.731
NEC for r=1.0 class 0 = 0.298 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 1 = 0.054 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 2 = 0.331 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 3 = 0.262 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 4 = 0.269 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 5 = 0.357 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 6 = 0.414 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 7 = 0.204 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 8 = 0.352 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 9 = 0.459 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 all KL = 0.417 +- 0.337 (in-sample avg dev_std = 0.394)
NEC for r=1.0 all L1 = 0.296 +- 0.260 (in-sample avg dev_std = 0.394)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.347 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 1 = 0.315 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 2 = 0.339 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 3 = 0.33 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 4 = 0.312 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 5 = 0.325 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 6 = 0.328 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 7 = 0.319 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 8 = 0.323 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 9 = 0.335 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all KL = 0.189 +- 0.145 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all L1 = 0.327 +- 0.134 (in-sample avg dev_std = 0.242)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.159
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.135
NEC for r=0.6 class 0 = 0.146 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1 = 0.403 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 2 = 0.137 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 3 = 0.199 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 4 = 0.22 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 5 = 0.2 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 6 = 0.177 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 7 = 0.268 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 8 = 0.244 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 9 = 0.241 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.173 +- 0.201 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.225 +- 0.209 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.237
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.244
NEC for r=0.9 class 0 = 0.551 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 1 = 0.066 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 2 = 0.49 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 3 = 0.514 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 4 = 0.542 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 5 = 0.535 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 6 = 0.541 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 7 = 0.437 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 8 = 0.564 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 9 = 0.463 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 all KL = 0.562 +- 0.380 (in-sample avg dev_std = 0.309)
NEC for r=0.9 all L1 = 0.465 +- 0.320 (in-sample avg dev_std = 0.309)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.183
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.227
NEC for r=1.0 class 0 = 0.51 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 1 = 0.073 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 2 = 0.466 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 3 = 0.466 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 4 = 0.349 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 5 = 0.481 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 6 = 0.339 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 7 = 0.3 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 8 = 0.476 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 9 = 0.304 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 all KL = 0.518 +- 0.433 (in-sample avg dev_std = 0.310)
NEC for r=1.0 all L1 = 0.373 +- 0.347 (in-sample avg dev_std = 0.310)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 03:14:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:30 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:30 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:14:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
SUFF++ for r=0.3 class 0 = 0.473 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 1 = 0.458 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 2 = 0.469 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 3 = 0.491 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 4 = 0.455 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 5 = 0.464 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 6 = 0.449 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 7 = 0.463 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 8 = 0.452 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 9 = 0.431 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all KL = 0.453 +- 0.234 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all L1 = 0.461 +- 0.143 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.183
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.149
SUFF++ for r=0.6 class 0 = 0.396 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.402 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.444 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 3 = 0.475 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 4 = 0.505 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 5 = 0.421 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 6 = 0.469 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 7 = 0.377 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 8 = 0.562 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 9 = 0.501 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.305 +- 0.294 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.453 +- 0.233 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.762
SUFF++ for r=0.9 class 0 = 0.949 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 1 = 0.945 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 2 = 0.752 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 3 = 0.642 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 4 = 0.85 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 5 = 0.726 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 6 = 0.778 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 7 = 0.844 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 8 = 0.859 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 9 = 0.734 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all KL = 0.796 +- 0.276 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all L1 = 0.81 +- 0.224 (in-sample avg dev_std = 0.304)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.536 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 1 = 0.57 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 3 = 0.534 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 4 = 0.519 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 5 = 0.534 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 6 = 0.532 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 7 = 0.521 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 8 = 0.504 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 9 = 0.522 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 all KL = 0.569 +- 0.240 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 all L1 = 0.532 +- 0.169 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.186
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
SUFF++ for r=0.6 class 0 = 0.504 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.412 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.482 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 3 = 0.443 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 4 = 0.445 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 5 = 0.407 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 6 = 0.452 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 7 = 0.434 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 8 = 0.431 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 9 = 0.44 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.351 +- 0.295 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.445 +- 0.217 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.627
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.601
SUFF++ for r=0.9 class 0 = 0.768 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 1 = 0.972 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 2 = 0.724 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 3 = 0.684 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 4 = 0.761 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 5 = 0.729 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 6 = 0.704 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 7 = 0.843 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 8 = 0.658 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 9 = 0.684 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all KL = 0.769 +- 0.258 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all L1 = 0.757 +- 0.223 (in-sample avg dev_std = 0.324)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.443 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 1 = 0.426 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 2 = 0.452 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 3 = 0.479 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 4 = 0.507 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 5 = 0.49 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 6 = 0.51 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 7 = 0.48 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 8 = 0.496 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 9 = 0.518 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all KL = 0.404 +- 0.272 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all L1 = 0.479 +- 0.172 (in-sample avg dev_std = 0.586)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.193
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.183
SUFF++ for r=0.6 class 0 = 0.611 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 2 = 0.725 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 3 = 0.724 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 4 = 0.632 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 5 = 0.688 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 6 = 0.595 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 7 = 0.603 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 8 = 0.691 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 9 = 0.571 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all KL = 0.591 +- 0.359 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all L1 = 0.656 +- 0.290 (in-sample avg dev_std = 0.367)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.175
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.182
SUFF++ for r=0.9 class 0 = 0.837 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1 = 0.995 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 2 = 0.846 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 3 = 0.847 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 4 = 0.864 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 5 = 0.832 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 6 = 0.887 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 7 = 0.888 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 8 = 0.827 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 9 = 0.88 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.881 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.872 +- 0.193 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.423 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.494 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.458 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 3 = 0.441 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 4 = 0.476 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 5 = 0.453 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 6 = 0.492 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 7 = 0.46 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 8 = 0.473 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 9 = 0.521 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.383 +- 0.234 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.469 +- 0.162 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.183
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.142
NEC for r=0.6 class 0 = 0.488 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 1 = 0.519 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 2 = 0.443 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 3 = 0.394 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 4 = 0.392 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 5 = 0.395 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 6 = 0.429 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 7 = 0.498 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 8 = 0.361 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 class 9 = 0.41 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all KL = 0.471 +- 0.301 (in-sample avg dev_std = 0.387)
NEC for r=0.6 all L1 = 0.436 +- 0.247 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.623
NEC for r=0.9 class 0 = 0.223 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 1 = 0.195 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 2 = 0.493 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 3 = 0.668 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 4 = 0.324 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 5 = 0.534 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 6 = 0.411 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 7 = 0.34 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 8 = 0.308 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 9 = 0.462 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 all KL = 0.575 +- 0.343 (in-sample avg dev_std = 0.460)
NEC for r=0.9 all L1 = 0.393 +- 0.275 (in-sample avg dev_std = 0.460)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.952
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.834
NEC for r=1.0 class 0 = 0.082 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 1 = 0.028 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 2 = 0.296 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 3 = 0.408 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 4 = 0.175 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 5 = 0.329 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 6 = 0.25 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 7 = 0.164 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 8 = 0.188 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 class 9 = 0.391 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 all KL = 0.377 +- 0.359 (in-sample avg dev_std = 0.400)
NEC for r=1.0 all L1 = 0.227 +- 0.253 (in-sample avg dev_std = 0.400)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.426 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.371 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.419 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 3 = 0.42 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 4 = 0.437 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 5 = 0.422 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 6 = 0.447 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 7 = 0.426 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 8 = 0.451 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 9 = 0.449 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.333 +- 0.209 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.426 +- 0.164 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.186
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.15
NEC for r=0.6 class 0 = 0.42 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 1 = 0.441 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 2 = 0.434 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 3 = 0.458 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 4 = 0.445 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 5 = 0.48 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 6 = 0.462 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 7 = 0.462 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 8 = 0.469 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 9 = 0.463 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all KL = 0.453 +- 0.262 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all L1 = 0.453 +- 0.212 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.627
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.55 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 1 = 0.064 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 2 = 0.399 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 3 = 0.607 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 4 = 0.401 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 5 = 0.479 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 6 = 0.528 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 7 = 0.323 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 8 = 0.554 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 9 = 0.519 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all KL = 0.542 +- 0.336 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all L1 = 0.436 +- 0.273 (in-sample avg dev_std = 0.434)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.616
NEC for r=1.0 class 0 = 0.433 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 1 = 0.021 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 2 = 0.356 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 3 = 0.47 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 4 = 0.327 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 5 = 0.34 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 6 = 0.439 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 7 = 0.208 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 8 = 0.471 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 class 9 = 0.459 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 all KL = 0.455 +- 0.344 (in-sample avg dev_std = 0.422)
NEC for r=1.0 all L1 = 0.347 +- 0.274 (in-sample avg dev_std = 0.422)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 1500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.118
NEC for r=0.3 class 0 = 0.358 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 1 = 0.359 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 2 = 0.376 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 3 = 0.372 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 4 = 0.386 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 5 = 0.407 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 6 = 0.401 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 7 = 0.383 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 8 = 0.411 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 9 = 0.392 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all KL = 0.329 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all L1 = 0.384 +- 0.189 (in-sample avg dev_std = 0.339)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.193
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 1500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.187
NEC for r=0.6 class 0 = 0.309 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 1 = 0.157 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 2 = 0.276 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 3 = 0.278 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 4 = 0.3 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 5 = 0.273 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 6 = 0.337 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 7 = 0.328 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 8 = 0.277 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 class 9 = 0.366 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all KL = 0.317 +- 0.291 (in-sample avg dev_std = 0.353)
NEC for r=0.6 all L1 = 0.289 +- 0.249 (in-sample avg dev_std = 0.353)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.175
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 1500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.184
NEC for r=0.9 class 0 = 0.267 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 1 = 0.008 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 2 = 0.216 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 3 = 0.232 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 4 = 0.242 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 5 = 0.276 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 6 = 0.179 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 7 = 0.176 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 8 = 0.305 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 9 = 0.183 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 all KL = 0.245 +- 0.317 (in-sample avg dev_std = 0.262)
NEC for r=0.9 all L1 = 0.206 +- 0.264 (in-sample avg dev_std = 0.262)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.147
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.166
NEC for r=1.0 class 0 = 0.32 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 1 = 0.005 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 2 = 0.304 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 3 = 0.292 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 4 = 0.171 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 5 = 0.286 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 6 = 0.124 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 7 = 0.112 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 8 = 0.23 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 9 = 0.127 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all KL = 0.274 +- 0.366 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all L1 = 0.195 +- 0.276 (in-sample avg dev_std = 0.257)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.724, 0.351, 0.843, 1.0], 'all_L1': [0.589, 0.395, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.489, 0.804, 1.0], 'all_L1': [0.559, 0.462, 0.818, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.486, 0.191, 0.135, 1.0], 'all_L1': [0.437, 0.354, 0.334, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.333, 0.846, 1.0], 'all_L1': [0.537, 0.399, 0.842, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.453, 0.305, 0.796, 1.0], 'all_L1': [0.461, 0.453, 0.81, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.448, 0.515, 0.344], 'all_L1': [0.404, 0.498, 0.372, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.397, 0.53, 0.351], 'all_L1': [0.355, 0.477, 0.37, 0.213]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.768, 0.613, 0.364], 'all_L1': [0.541, 0.652, 0.465, 0.211]}), defaultdict(<class 'list'>, {'all_KL': [0.223, 0.463, 0.523, 0.362], 'all_L1': [0.383, 0.49, 0.355, 0.21]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.471, 0.575, 0.377], 'all_L1': [0.469, 0.436, 0.393, 0.227]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.723, 0.368, 0.843, 1.0], 'all_L1': [0.598, 0.413, 0.812, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.69, 0.538, 0.776, 1.0], 'all_L1': [0.565, 0.49, 0.786, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.205, 0.216, 1.0], 'all_L1': [0.412, 0.362, 0.377, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.644, 0.419, 0.822, 1.0], 'all_L1': [0.55, 0.483, 0.799, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.351, 0.769, 1.0], 'all_L1': [0.532, 0.445, 0.757, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.214, 0.405, 0.5, 0.364], 'all_L1': [0.383, 0.458, 0.387, 0.272]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.349, 0.53, 0.375], 'all_L1': [0.36, 0.443, 0.407, 0.272]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.747, 0.589, 0.472], 'all_L1': [0.544, 0.634, 0.5, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.326, 0.549, 0.417], 'all_L1': [0.344, 0.382, 0.424, 0.296]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.453, 0.542, 0.455], 'all_L1': [0.426, 0.453, 0.436, 0.347]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.695, 0.504, 0.775, 1.0], 'all_L1': [0.595, 0.489, 0.719, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.675, 0.54, 0.795, 1.0], 'all_L1': [0.555, 0.493, 0.726, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.372, 0.137, 0.056, 1.0], 'all_L1': [0.384, 0.319, 0.319, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.368, 0.754, 1.0], 'all_L1': [0.56, 0.517, 0.758, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.591, 0.881, 1.0], 'all_L1': [0.479, 0.656, 0.872, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.201, 0.344, 0.517, 0.56], 'all_L1': [0.365, 0.423, 0.482, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.174, 0.356, 0.464, 0.46], 'all_L1': [0.352, 0.449, 0.456, 0.442]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.787, 0.526, 0.467], 'all_L1': [0.583, 0.664, 0.458, 0.409]}), defaultdict(<class 'list'>, {'all_KL': [0.189, 0.173, 0.562, 0.518], 'all_L1': [0.327, 0.225, 0.465, 0.373]}), defaultdict(<class 'list'>, {'all_KL': [0.329, 0.317, 0.245, 0.274], 'all_L1': [0.384, 0.289, 0.206, 0.195]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.517 +- 0.058, 0.413 +- 0.040, 0.727 +- 0.197, 1.000 +- 0.000
suff++ class all_KL  =  0.591 +- 0.105, 0.334 +- 0.096, 0.685 +- 0.276, 1.000 +- 0.000
suff++_acc_int  =  0.103 +- 0.006, 0.177 +- 0.019, 0.680 +- 0.200
nec class all_L1  =  0.430 +- 0.067, 0.511 +- 0.074, 0.391 +- 0.039, 0.216 +- 0.006
nec class all_KL  =  0.295 +- 0.101, 0.509 +- 0.132, 0.551 +- 0.037, 0.360 +- 0.011
nec_acc_int  =  0.104 +- 0.007, 0.199 +- 0.036, 0.646 +- 0.037, 0.846 +- 0.008

Eval split val
suff++ class all_L1  =  0.531 +- 0.064, 0.439 +- 0.047, 0.706 +- 0.166, 1.000 +- 0.000
suff++ class all_KL  =  0.609 +- 0.109, 0.376 +- 0.108, 0.685 +- 0.236, 1.000 +- 0.000
suff++_acc_int  =  0.105 +- 0.003, 0.161 +- 0.023, 0.586 +- 0.200
nec class all_L1  =  0.411 +- 0.072, 0.474 +- 0.085, 0.431 +- 0.038, 0.307 +- 0.034
nec class all_KL  =  0.276 +- 0.107, 0.456 +- 0.152, 0.542 +- 0.029, 0.417 +- 0.043
nec_acc_int  =  0.099 +- 0.005, 0.180 +- 0.035, 0.536 +- 0.081, 0.707 +- 0.062

Eval split test
suff++ class all_L1  =  0.515 +- 0.075, 0.495 +- 0.107, 0.679 +- 0.188, 1.000 +- 0.000
suff++ class all_KL  =  0.562 +- 0.142, 0.428 +- 0.163, 0.652 +- 0.301, 1.000 +- 0.000
suff++_acc_int  =  0.110 +- 0.010, 0.156 +- 0.036, 0.267 +- 0.112
nec class all_L1  =  0.402 +- 0.092, 0.410 +- 0.152, 0.413 +- 0.104, 0.380 +- 0.099
nec class all_KL  =  0.288 +- 0.140, 0.395 +- 0.206, 0.463 +- 0.113, 0.456 +- 0.098
nec_acc_int  =  0.114 +- 0.014, 0.168 +- 0.040, 0.257 +- 0.081, 0.274 +- 0.098


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.016, 0.462 +- 0.023, 0.559 +- 0.080, 0.608 +- 0.003
Faith. Armon (L1)= 		  =  0.462 +- 0.019, 0.451 +- 0.012, 0.488 +- 0.051, 0.355 +- 0.009
Faith. GMean (L1)= 	  =  0.468 +- 0.017, 0.456 +- 0.016, 0.522 +- 0.064, 0.465 +- 0.007
Faith. Aritm (KL)= 		  =  0.443 +- 0.027, 0.422 +- 0.035, 0.618 +- 0.122, 0.680 +- 0.006
Faith. Armon (KL)= 		  =  0.371 +- 0.064, 0.379 +- 0.043, 0.563 +- 0.171, 0.529 +- 0.012
Faith. GMean (KL)= 	  =  0.404 +- 0.041, 0.398 +- 0.022, 0.588 +- 0.150, 0.600 +- 0.009

Eval split val
Faith. Aritm (L1)= 		  =  0.471 +- 0.015, 0.456 +- 0.024, 0.569 +- 0.065, 0.653 +- 0.017
Faith. Armon (L1)= 		  =  0.454 +- 0.019, 0.447 +- 0.015, 0.520 +- 0.046, 0.468 +- 0.039
Faith. GMean (L1)= 	  =  0.463 +- 0.017, 0.452 +- 0.019, 0.543 +- 0.055, 0.553 +- 0.030
Faith. Aritm (KL)= 		  =  0.442 +- 0.017, 0.416 +- 0.038, 0.614 +- 0.106, 0.708 +- 0.021
Faith. Armon (KL)= 		  =  0.354 +- 0.063, 0.379 +- 0.034, 0.574 +- 0.129, 0.587 +- 0.042
Faith. GMean (KL)= 	  =  0.394 +- 0.038, 0.396 +- 0.021, 0.593 +- 0.119, 0.645 +- 0.033

Eval split test
Faith. Aritm (L1)= 		  =  0.458 +- 0.020, 0.452 +- 0.042, 0.546 +- 0.083, 0.690 +- 0.049
Faith. Armon (L1)= 		  =  0.437 +- 0.018, 0.414 +- 0.055, 0.485 +- 0.107, 0.542 +- 0.113
Faith. GMean (L1)= 	  =  0.448 +- 0.019, 0.432 +- 0.047, 0.513 +- 0.091, 0.610 +- 0.088
Faith. Aritm (KL)= 		  =  0.425 +- 0.032, 0.412 +- 0.072, 0.558 +- 0.137, 0.728 +- 0.049
Faith. Armon (KL)= 		  =  0.338 +- 0.060, 0.344 +- 0.090, 0.467 +- 0.205, 0.619 +- 0.100
Faith. GMean (KL)= 	  =  0.377 +- 0.038, 0.374 +- 0.073, 0.506 +- 0.179, 0.671 +- 0.078
Computed for split load_split = id



Completed in  3:35:07.791486  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 03:57:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:18 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:18 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:18 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:18 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:57:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.607 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 1 = 0.559 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 2 = 0.601 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 3 = 0.601 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 4 = 0.594 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 5 = 0.589 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 6 = 0.604 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 7 = 0.589 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 8 = 0.588 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 9 = 0.589 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all KL = 0.727 +- 0.144 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.109 (in-sample avg dev_std = 0.246)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.167
SUFF++ for r=0.6 class 0 = 0.403 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 1 = 0.384 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 2 = 0.378 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 3 = 0.396 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 4 = 0.399 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 5 = 0.386 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 6 = 0.42 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 7 = 0.404 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 8 = 0.383 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 9 = 0.407 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all KL = 0.354 +- 0.218 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all L1 = 0.396 +- 0.127 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.787
SUFF++ for r=0.9 class 0 = 0.938 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 1 = 0.928 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 2 = 0.806 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 3 = 0.792 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 4 = 0.797 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 5 = 0.741 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 6 = 0.833 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 7 = 0.843 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 8 = 0.874 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 9 = 0.765 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 all KL = 0.847 +- 0.222 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 all L1 = 0.835 +- 0.198 (in-sample avg dev_std = 0.244)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.622 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 1 = 0.57 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 2 = 0.602 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 3 = 0.605 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 4 = 0.599 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 5 = 0.599 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 6 = 0.604 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 7 = 0.605 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 8 = 0.582 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 9 = 0.586 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 all KL = 0.724 +- 0.149 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 all L1 = 0.597 +- 0.116 (in-sample avg dev_std = 0.252)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.168
SUFF++ for r=0.6 class 0 = 0.403 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 1 = 0.415 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 2 = 0.408 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 3 = 0.425 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 4 = 0.439 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 5 = 0.416 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 6 = 0.397 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 7 = 0.44 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 8 = 0.402 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 9 = 0.412 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all KL = 0.375 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all L1 = 0.416 +- 0.139 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.725
SUFF++ for r=0.9 class 0 = 0.92 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 1 = 0.952 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 2 = 0.77 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 3 = 0.801 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 4 = 0.769 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 5 = 0.736 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 6 = 0.778 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 7 = 0.867 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 8 = 0.824 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 9 = 0.719 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all KL = 0.845 +- 0.211 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.202 (in-sample avg dev_std = 0.243)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.61 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 1 = 0.562 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 2 = 0.612 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 3 = 0.593 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 4 = 0.597 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 5 = 0.6 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 6 = 0.587 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 7 = 0.595 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 8 = 0.587 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 9 = 0.58 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 all KL = 0.694 +- 0.164 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.125 (in-sample avg dev_std = 0.277)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.193
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.155
SUFF++ for r=0.6 class 0 = 0.448 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 1 = 0.474 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 2 = 0.519 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 3 = 0.507 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 4 = 0.506 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 5 = 0.463 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 6 = 0.486 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 7 = 0.538 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 8 = 0.471 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 9 = 0.458 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 all KL = 0.498 +- 0.250 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 all L1 = 0.487 +- 0.173 (in-sample avg dev_std = 0.365)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.373
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.363
SUFF++ for r=0.9 class 0 = 0.655 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 1 = 0.813 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 2 = 0.773 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 3 = 0.695 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 4 = 0.736 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 5 = 0.678 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 6 = 0.687 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 7 = 0.747 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 8 = 0.686 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 9 = 0.688 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 all KL = 0.775 +- 0.217 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 all L1 = 0.718 +- 0.190 (in-sample avg dev_std = 0.319)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.113
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.385 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 1 = 0.405 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 2 = 0.395 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 3 = 0.392 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 4 = 0.398 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 5 = 0.405 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 6 = 0.412 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 7 = 0.404 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 8 = 0.416 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 class 9 = 0.416 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 all KL = 0.241 +- 0.156 (in-sample avg dev_std = 0.223)
NEC for r=0.3 all L1 = 0.403 +- 0.117 (in-sample avg dev_std = 0.223)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.254
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.218
NEC for r=0.6 class 0 = 0.493 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 1 = 0.457 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 2 = 0.476 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 3 = 0.477 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 4 = 0.511 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 5 = 0.501 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 6 = 0.5 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 7 = 0.511 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 8 = 0.527 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 9 = 0.515 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all KL = 0.446 +- 0.201 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all L1 = 0.496 +- 0.140 (in-sample avg dev_std = 0.333)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.831
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.291 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 2 = 0.356 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 3 = 0.441 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 4 = 0.415 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 5 = 0.527 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 6 = 0.365 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 7 = 0.401 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 8 = 0.303 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 class 9 = 0.463 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 all KL = 0.515 +- 0.310 (in-sample avg dev_std = 0.433)
NEC for r=0.9 all L1 = 0.369 +- 0.248 (in-sample avg dev_std = 0.433)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.949
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.085 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 1 = 0.037 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 2 = 0.267 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 3 = 0.294 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 4 = 0.229 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 5 = 0.37 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 6 = 0.228 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 7 = 0.206 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 8 = 0.161 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 9 = 0.365 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all KL = 0.345 +- 0.329 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all L1 = 0.219 +- 0.238 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
NEC for r=0.3 class 0 = 0.362 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 1 = 0.384 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 2 = 0.377 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 3 = 0.384 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 4 = 0.386 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 5 = 0.374 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 6 = 0.382 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 7 = 0.384 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 8 = 0.396 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 9 = 0.395 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all KL = 0.213 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all L1 = 0.383 +- 0.111 (in-sample avg dev_std = 0.205)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.221
NEC for r=0.6 class 0 = 0.412 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 1 = 0.349 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 2 = 0.448 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 3 = 0.462 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 4 = 0.479 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 5 = 0.453 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 6 = 0.498 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 7 = 0.46 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 8 = 0.478 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 9 = 0.497 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 all KL = 0.395 +- 0.209 (in-sample avg dev_std = 0.315)
NEC for r=0.6 all L1 = 0.452 +- 0.168 (in-sample avg dev_std = 0.315)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.616
NEC for r=0.9 class 0 = 0.378 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.091 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.376 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.486 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.444 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.512 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.467 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.304 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.306 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.503 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.499 +- 0.311 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.382 +- 0.253 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.842
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.766
NEC for r=1.0 class 0 = 0.134 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 1 = 0.024 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 2 = 0.281 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 3 = 0.321 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 4 = 0.31 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 5 = 0.389 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 6 = 0.349 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 7 = 0.157 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 8 = 0.24 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 9 = 0.463 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all KL = 0.355 +- 0.308 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all L1 = 0.263 +- 0.246 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.35 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 1 = 0.365 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 2 = 0.356 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 3 = 0.365 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 4 = 0.361 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 5 = 0.36 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 6 = 0.38 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 7 = 0.367 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 8 = 0.373 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 9 = 0.383 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.201 +- 0.140 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.366 +- 0.118 (in-sample avg dev_std = 0.200)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.193
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.185
NEC for r=0.6 class 0 = 0.415 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 1 = 0.32 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 2 = 0.418 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 3 = 0.419 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 4 = 0.464 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 5 = 0.445 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 6 = 0.444 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 7 = 0.403 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 8 = 0.472 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 9 = 0.476 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all KL = 0.351 +- 0.208 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all L1 = 0.425 +- 0.173 (in-sample avg dev_std = 0.297)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.373
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.311
NEC for r=0.9 class 0 = 0.568 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 1 = 0.373 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 2 = 0.459 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 3 = 0.55 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 4 = 0.452 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 5 = 0.496 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 6 = 0.533 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 7 = 0.412 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 8 = 0.513 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 9 = 0.521 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 all KL = 0.526 +- 0.272 (in-sample avg dev_std = 0.377)
NEC for r=0.9 all L1 = 0.486 +- 0.215 (in-sample avg dev_std = 0.377)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.34
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.366
NEC for r=1.0 class 0 = 0.588 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 1 = 0.117 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 2 = 0.372 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 3 = 0.504 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 4 = 0.553 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 5 = 0.535 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 6 = 0.589 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 7 = 0.49 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 8 = 0.585 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 class 9 = 0.553 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 all KL = 0.564 +- 0.320 (in-sample avg dev_std = 0.352)
NEC for r=1.0 all L1 = 0.482 +- 0.265 (in-sample avg dev_std = 0.352)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 05:07:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:50 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:50 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 05:07:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.573 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 1 = 0.528 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 2 = 0.571 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 3 = 0.567 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 4 = 0.567 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 5 = 0.569 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 6 = 0.56 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 7 = 0.563 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 8 = 0.576 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 9 = 0.551 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all KL = 0.673 +- 0.132 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all L1 = 0.562 +- 0.085 (in-sample avg dev_std = 0.314)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.267
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.203
SUFF++ for r=0.6 class 0 = 0.51 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 1 = 0.497 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 2 = 0.452 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 3 = 0.438 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 4 = 0.44 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 5 = 0.454 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 6 = 0.45 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 7 = 0.47 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 8 = 0.428 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 class 9 = 0.422 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 all KL = 0.48 +- 0.222 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.6 all L1 = 0.457 +- 0.146 (in-sample avg dev_std = 0.279)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.786
SUFF++ for r=0.9 class 0 = 0.934 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 1 = 0.955 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 2 = 0.795 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 3 = 0.745 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 4 = 0.816 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 5 = 0.762 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 6 = 0.833 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 7 = 0.827 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 8 = 0.777 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 9 = 0.732 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all KL = 0.805 +- 0.255 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all L1 = 0.82 +- 0.206 (in-sample avg dev_std = 0.279)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.571 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 1 = 0.536 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 3 = 0.57 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 4 = 0.565 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 5 = 0.572 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 6 = 0.564 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 7 = 0.565 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 8 = 0.561 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 class 9 = 0.558 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 all KL = 0.688 +- 0.124 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.3 all L1 = 0.563 +- 0.082 (in-sample avg dev_std = 0.293)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.271
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.209
SUFF++ for r=0.6 class 0 = 0.531 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 1 = 0.543 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 2 = 0.504 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 3 = 0.473 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 4 = 0.469 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 5 = 0.487 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 6 = 0.476 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 7 = 0.491 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 8 = 0.44 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 9 = 0.464 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 all KL = 0.538 +- 0.216 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 all L1 = 0.488 +- 0.152 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0 = 0.907 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 1 = 0.964 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 2 = 0.762 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 3 = 0.718 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 4 = 0.786 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 5 = 0.731 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 6 = 0.739 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 7 = 0.819 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 8 = 0.689 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 class 9 = 0.72 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 all KL = 0.781 +- 0.258 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.9 all L1 = 0.786 +- 0.210 (in-sample avg dev_std = 0.307)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.118
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.563 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 1 = 0.535 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 2 = 0.559 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 3 = 0.563 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 4 = 0.548 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 5 = 0.558 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 6 = 0.553 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 7 = 0.547 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 8 = 0.557 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 9 = 0.56 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all KL = 0.676 +- 0.119 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all L1 = 0.554 +- 0.080 (in-sample avg dev_std = 0.314)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.238
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.205
SUFF++ for r=0.6 class 0 = 0.515 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 1 = 0.539 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 2 = 0.533 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 3 = 0.504 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 4 = 0.474 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 5 = 0.483 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 6 = 0.483 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 7 = 0.498 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 8 = 0.483 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 9 = 0.434 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 all KL = 0.543 +- 0.227 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 all L1 = 0.496 +- 0.160 (in-sample avg dev_std = 0.244)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.424
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.412
SUFF++ for r=0.9 class 0 = 0.684 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 1 = 0.863 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 2 = 0.7 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 3 = 0.681 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 4 = 0.772 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 5 = 0.745 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 6 = 0.722 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 7 = 0.701 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 8 = 0.676 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 9 = 0.689 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 all KL = 0.797 +- 0.198 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 all L1 = 0.724 +- 0.187 (in-sample avg dev_std = 0.297)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.358 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 1 = 0.374 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 2 = 0.342 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 3 = 0.351 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 4 = 0.348 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 5 = 0.352 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 6 = 0.357 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 7 = 0.36 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 8 = 0.351 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 class 9 = 0.357 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 all KL = 0.179 +- 0.122 (in-sample avg dev_std = 0.183)
NEC for r=0.3 all L1 = 0.355 +- 0.107 (in-sample avg dev_std = 0.183)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.267
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.231
NEC for r=0.6 class 0 = 0.424 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 1 = 0.405 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 2 = 0.468 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 3 = 0.497 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 4 = 0.499 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 5 = 0.474 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 6 = 0.492 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 7 = 0.473 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 8 = 0.522 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 9 = 0.524 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all KL = 0.399 +- 0.200 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all L1 = 0.476 +- 0.136 (in-sample avg dev_std = 0.284)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.267 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 1 = 0.064 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 2 = 0.362 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 3 = 0.511 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 4 = 0.354 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 5 = 0.45 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 6 = 0.361 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 7 = 0.363 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 8 = 0.469 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 9 = 0.507 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all KL = 0.522 +- 0.325 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all L1 = 0.366 +- 0.257 (in-sample avg dev_std = 0.421)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.954
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.856
NEC for r=1.0 class 0 = 0.079 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 1 = 0.021 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 2 = 0.24 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 3 = 0.28 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 4 = 0.209 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 5 = 0.296 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 6 = 0.22 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 7 = 0.185 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 8 = 0.252 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 9 = 0.371 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 all KL = 0.343 +- 0.336 (in-sample avg dev_std = 0.366)
NEC for r=1.0 all L1 = 0.211 +- 0.237 (in-sample avg dev_std = 0.366)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
NEC for r=0.3 class 0 = 0.356 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 1 = 0.374 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 2 = 0.355 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 3 = 0.352 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 4 = 0.354 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 5 = 0.364 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 6 = 0.357 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 7 = 0.365 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 8 = 0.359 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 9 = 0.367 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all KL = 0.18 +- 0.119 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all L1 = 0.36 +- 0.104 (in-sample avg dev_std = 0.176)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.271
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.229
NEC for r=0.6 class 0 = 0.413 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 1 = 0.358 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 2 = 0.423 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 3 = 0.449 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 4 = 0.482 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 5 = 0.433 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 6 = 0.48 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 7 = 0.447 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 8 = 0.491 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 9 = 0.496 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all KL = 0.353 +- 0.201 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all L1 = 0.446 +- 0.142 (in-sample avg dev_std = 0.270)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.613
NEC for r=0.9 class 0 = 0.412 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.038 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.395 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 3 = 0.535 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 4 = 0.39 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 5 = 0.475 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 6 = 0.494 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 7 = 0.341 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 8 = 0.542 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 9 = 0.529 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.532 +- 0.317 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.409 +- 0.255 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.885
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.78
NEC for r=1.0 class 0 = 0.167 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 1 = 0.014 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 2 = 0.304 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 3 = 0.36 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 4 = 0.267 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 5 = 0.308 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 6 = 0.336 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 7 = 0.175 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 8 = 0.424 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 9 = 0.382 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all KL = 0.374 +- 0.318 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all L1 = 0.27 +- 0.246 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.118
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.339 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 1 = 0.359 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 2 = 0.344 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 3 = 0.341 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 4 = 0.361 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 5 = 0.347 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 6 = 0.363 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 7 = 0.358 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 8 = 0.356 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 9 = 0.354 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 all KL = 0.174 +- 0.116 (in-sample avg dev_std = 0.179)
NEC for r=0.3 all L1 = 0.352 +- 0.103 (in-sample avg dev_std = 0.179)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.238
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.22
NEC for r=0.6 class 0 = 0.414 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1 = 0.351 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 2 = 0.407 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 3 = 0.439 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 4 = 0.472 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 5 = 0.441 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 6 = 0.478 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 7 = 0.458 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 8 = 0.475 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 9 = 0.513 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.353 +- 0.206 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.443 +- 0.152 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.424
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.368
NEC for r=0.9 class 0 = 0.55 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 1 = 0.196 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 2 = 0.475 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 3 = 0.522 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 4 = 0.37 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 5 = 0.452 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 6 = 0.487 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 7 = 0.471 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 8 = 0.533 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 9 = 0.508 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all KL = 0.459 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all L1 = 0.454 +- 0.217 (in-sample avg dev_std = 0.349)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.406
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.41
NEC for r=1.0 class 0 = 0.549 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 1 = 0.161 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 2 = 0.48 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 3 = 0.516 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 4 = 0.397 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 5 = 0.391 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 6 = 0.479 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 7 = 0.473 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 8 = 0.535 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 class 9 = 0.504 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 all KL = 0.467 +- 0.279 (in-sample avg dev_std = 0.356)
NEC for r=1.0 all L1 = 0.446 +- 0.233 (in-sample avg dev_std = 0.356)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 06:18:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 06:18:58 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 06:18:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.148
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.444 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 1 = 0.349 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 2 = 0.457 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 3 = 0.45 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 4 = 0.45 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 5 = 0.454 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 6 = 0.441 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 7 = 0.445 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 8 = 0.456 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 9 = 0.445 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all KL = 0.489 +- 0.185 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all L1 = 0.438 +- 0.093 (in-sample avg dev_std = 0.439)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.276
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.184
SUFF++ for r=0.6 class 0 = 0.29 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.55 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.325 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 3 = 0.323 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 4 = 0.347 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 5 = 0.336 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 6 = 0.333 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 7 = 0.353 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 8 = 0.324 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 9 = 0.34 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.192 +- 0.184 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.355 +- 0.136 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.279
SUFF++ for r=0.9 class 0 = 0.256 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 1 = 0.953 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 2 = 0.305 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 3 = 0.261 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 4 = 0.237 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 5 = 0.262 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 6 = 0.253 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 7 = 0.229 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 8 = 0.271 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 class 9 = 0.243 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 all KL = 0.137 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.9 all L1 = 0.336 +- 0.250 (in-sample avg dev_std = 0.511)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.144
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.435 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 1 = 0.291 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 2 = 0.436 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 3 = 0.434 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 4 = 0.413 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 5 = 0.437 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 6 = 0.425 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 7 = 0.422 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 8 = 0.44 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 9 = 0.409 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 all KL = 0.417 +- 0.189 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 all L1 = 0.412 +- 0.096 (in-sample avg dev_std = 0.473)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.214
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.158
SUFF++ for r=0.6 class 0 = 0.274 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 1 = 0.632 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 2 = 0.311 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 3 = 0.326 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 4 = 0.358 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 5 = 0.335 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 6 = 0.336 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 7 = 0.354 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 8 = 0.334 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 9 = 0.355 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all KL = 0.209 +- 0.193 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all L1 = 0.366 +- 0.158 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.526
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.192
SUFF++ for r=0.9 class 0 = 0.246 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 1 = 0.935 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 2 = 0.287 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 3 = 0.264 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 4 = 0.331 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 5 = 0.285 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 6 = 0.31 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 7 = 0.267 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 8 = 0.287 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 9 = 0.405 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 all KL = 0.208 +- 0.352 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 all L1 = 0.371 +- 0.280 (in-sample avg dev_std = 0.474)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.149
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.128
SUFF++ for r=0.3 class 0 = 0.46 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 1 = 0.25 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 2 = 0.441 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 3 = 0.417 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 4 = 0.355 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 5 = 0.401 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 6 = 0.372 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 7 = 0.398 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 8 = 0.386 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 class 9 = 0.324 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 all KL = 0.365 +- 0.240 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.3 all L1 = 0.379 +- 0.135 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
SUFF++ for r=0.6 class 0 = 0.285 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 1 = 0.33 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 2 = 0.306 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 3 = 0.331 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 4 = 0.332 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 5 = 0.333 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 6 = 0.305 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 7 = 0.336 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 8 = 0.348 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 9 = 0.307 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 all KL = 0.142 +- 0.162 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 all L1 = 0.321 +- 0.122 (in-sample avg dev_std = 0.540)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.169
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.121
SUFF++ for r=0.9 class 0 = 0.335 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 1 = 0.405 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 2 = 0.303 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 3 = 0.302 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 4 = 0.292 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 5 = 0.302 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 6 = 0.321 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 7 = 0.305 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 8 = 0.31 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 class 9 = 0.33 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 all KL = 0.06 +- 0.178 (in-sample avg dev_std = 0.679)
SUFF++ for r=0.9 all L1 = 0.322 +- 0.166 (in-sample avg dev_std = 0.679)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.148
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.562 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 1 = 0.59 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 2 = 0.54 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 3 = 0.534 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 4 = 0.526 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 5 = 0.528 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 6 = 0.529 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 7 = 0.517 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 8 = 0.538 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 class 9 = 0.525 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all KL = 0.438 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.3 all L1 = 0.54 +- 0.120 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.276
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.176
NEC for r=0.6 class 0 = 0.714 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 1 = 0.518 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 2 = 0.694 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 3 = 0.682 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 4 = 0.67 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 5 = 0.67 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 6 = 0.634 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 7 = 0.642 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 8 = 0.68 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 9 = 0.643 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all KL = 0.769 +- 0.222 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all L1 = 0.653 +- 0.145 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.584
NEC for r=0.9 class 0 = 0.507 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.052 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.385 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 3 = 0.507 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 4 = 0.578 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 5 = 0.535 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 6 = 0.601 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 7 = 0.517 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 8 = 0.395 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 9 = 0.659 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.611 +- 0.314 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.466 +- 0.255 (in-sample avg dev_std = 0.445)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.954
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.849
NEC for r=1.0 class 0 = 0.097 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 1 = 0.014 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 2 = 0.253 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 3 = 0.244 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 4 = 0.194 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 5 = 0.319 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 6 = 0.287 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 7 = 0.253 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 8 = 0.172 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 class 9 = 0.358 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 all KL = 0.368 +- 0.348 (in-sample avg dev_std = 0.390)
NEC for r=1.0 all L1 = 0.214 +- 0.240 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.144
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
NEC for r=0.3 class 0 = 0.561 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1 = 0.637 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 2 = 0.543 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 3 = 0.536 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 4 = 0.522 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 5 = 0.525 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 6 = 0.536 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 7 = 0.509 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 8 = 0.529 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 9 = 0.52 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.458 +- 0.231 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.543 +- 0.135 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.214
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.142
NEC for r=0.6 class 0 = 0.742 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 1 = 0.4 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 2 = 0.673 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 3 = 0.655 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 4 = 0.652 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 5 = 0.654 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 6 = 0.661 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 7 = 0.646 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 8 = 0.644 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 9 = 0.643 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all KL = 0.741 +- 0.264 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all L1 = 0.633 +- 0.190 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.526
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.41
NEC for r=0.9 class 0 = 0.633 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 1 = 0.066 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 2 = 0.398 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 3 = 0.536 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 4 = 0.572 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 5 = 0.491 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 6 = 0.627 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 7 = 0.545 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 8 = 0.574 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 9 = 0.616 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all KL = 0.585 +- 0.306 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all L1 = 0.5 +- 0.252 (in-sample avg dev_std = 0.396)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.777
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.663
NEC for r=1.0 class 0 = 0.51 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 1 = 0.024 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 2 = 0.369 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 3 = 0.302 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 4 = 0.29 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 5 = 0.384 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 6 = 0.432 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 7 = 0.236 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 8 = 0.456 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 class 9 = 0.491 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 all KL = 0.465 +- 0.345 (in-sample avg dev_std = 0.412)
NEC for r=1.0 all L1 = 0.343 +- 0.274 (in-sample avg dev_std = 0.412)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.149
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.141
NEC for r=0.3 class 0 = 0.529 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1 = 0.696 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 2 = 0.522 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 3 = 0.541 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 4 = 0.611 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 5 = 0.554 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 6 = 0.601 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 7 = 0.553 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 8 = 0.587 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 9 = 0.65 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.549 +- 0.291 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.585 +- 0.170 (in-sample avg dev_std = 0.195)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
NEC for r=0.6 class 0 = 0.676 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 1 = 0.65 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 2 = 0.649 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 3 = 0.637 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 4 = 0.675 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 5 = 0.632 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 6 = 0.692 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 7 = 0.645 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 8 = 0.656 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 class 9 = 0.711 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 all KL = 0.784 +- 0.262 (in-sample avg dev_std = 0.349)
NEC for r=0.6 all L1 = 0.662 +- 0.192 (in-sample avg dev_std = 0.349)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.169
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.162
NEC for r=0.9 class 0 = 0.316 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 1 = 0.565 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 2 = 0.268 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 3 = 0.438 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 4 = 0.515 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 5 = 0.433 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 6 = 0.504 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 7 = 0.475 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 8 = 0.512 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 9 = 0.545 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all KL = 0.529 +- 0.356 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all L1 = 0.456 +- 0.289 (in-sample avg dev_std = 0.349)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.218
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.201
NEC for r=1.0 class 0 = 0.381 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 1 = 0.372 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 2 = 0.281 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 3 = 0.4 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 4 = 0.463 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 5 = 0.376 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 6 = 0.467 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 7 = 0.427 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 8 = 0.466 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 class 9 = 0.47 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all KL = 0.468 +- 0.347 (in-sample avg dev_std = 0.345)
NEC for r=1.0 all L1 = 0.409 +- 0.284 (in-sample avg dev_std = 0.345)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 07:36:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 07:36:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 07:36:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.554 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 1 = 0.524 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 2 = 0.535 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 3 = 0.548 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 4 = 0.542 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 5 = 0.541 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 6 = 0.53 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 7 = 0.537 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 8 = 0.538 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 9 = 0.534 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all KL = 0.627 +- 0.156 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all L1 = 0.538 +- 0.103 (in-sample avg dev_std = 0.324)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.251
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.176
SUFF++ for r=0.6 class 0 = 0.384 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 1 = 0.388 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 2 = 0.428 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 3 = 0.389 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 4 = 0.404 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 5 = 0.396 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 6 = 0.384 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 7 = 0.412 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 8 = 0.388 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 9 = 0.395 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all KL = 0.33 +- 0.215 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all L1 = 0.397 +- 0.139 (in-sample avg dev_std = 0.412)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.796
SUFF++ for r=0.9 class 0 = 0.939 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 1 = 0.97 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 2 = 0.777 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 3 = 0.81 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 4 = 0.852 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 5 = 0.744 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 6 = 0.84 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 7 = 0.836 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 8 = 0.854 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 9 = 0.761 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 all KL = 0.847 +- 0.233 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 all L1 = 0.842 +- 0.206 (in-sample avg dev_std = 0.246)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.563 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 1 = 0.547 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 2 = 0.549 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 3 = 0.554 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 4 = 0.54 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 5 = 0.552 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 6 = 0.562 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 7 = 0.544 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 8 = 0.545 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 class 9 = 0.554 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 all KL = 0.645 +- 0.153 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.102 (in-sample avg dev_std = 0.370)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.204
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.15
SUFF++ for r=0.6 class 0 = 0.534 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 1 = 0.407 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 2 = 0.564 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 3 = 0.519 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 4 = 0.445 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 5 = 0.506 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 6 = 0.473 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 7 = 0.5 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 8 = 0.47 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 class 9 = 0.424 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 all KL = 0.418 +- 0.232 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.6 all L1 = 0.482 +- 0.178 (in-sample avg dev_std = 0.395)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.695
SUFF++ for r=0.9 class 0 = 0.841 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 1 = 0.95 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 2 = 0.766 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 3 = 0.8 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 4 = 0.777 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 5 = 0.748 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 6 = 0.758 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 7 = 0.831 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 8 = 0.781 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 9 = 0.712 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all KL = 0.823 +- 0.227 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.210 (in-sample avg dev_std = 0.263)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.559 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 1 = 0.577 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 2 = 0.563 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 3 = 0.549 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 4 = 0.549 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 5 = 0.56 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 6 = 0.564 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 7 = 0.552 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 8 = 0.555 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 9 = 0.551 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all KL = 0.66 +- 0.162 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all L1 = 0.558 +- 0.106 (in-sample avg dev_std = 0.392)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.159
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.547 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 1 = 0.393 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 2 = 0.552 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 3 = 0.539 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 4 = 0.515 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 5 = 0.532 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 6 = 0.54 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 7 = 0.511 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 8 = 0.532 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 9 = 0.494 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all KL = 0.371 +- 0.210 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all L1 = 0.514 +- 0.155 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.229
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF++ for r=0.9 class 0 = 0.728 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 1 = 0.966 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 2 = 0.749 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 3 = 0.729 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 4 = 0.714 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 5 = 0.696 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 6 = 0.74 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 7 = 0.78 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 8 = 0.708 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 9 = 0.768 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all KL = 0.754 +- 0.290 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.235 (in-sample avg dev_std = 0.347)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.376 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.381 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.383 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 3 = 0.374 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 4 = 0.382 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 5 = 0.387 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 6 = 0.393 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 7 = 0.379 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 8 = 0.393 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 9 = 0.387 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.223 +- 0.145 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.383 +- 0.122 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.251
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.215
NEC for r=0.6 class 0 = 0.5 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 1 = 0.414 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 2 = 0.443 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 3 = 0.512 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 4 = 0.497 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 5 = 0.494 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 6 = 0.534 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 7 = 0.51 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 8 = 0.49 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 9 = 0.519 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 all KL = 0.462 +- 0.234 (in-sample avg dev_std = 0.325)
NEC for r=0.6 all L1 = 0.49 +- 0.180 (in-sample avg dev_std = 0.325)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0 = 0.308 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 1 = 0.059 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 2 = 0.422 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 3 = 0.431 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 4 = 0.311 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 5 = 0.508 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 6 = 0.41 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 7 = 0.361 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 8 = 0.335 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 9 = 0.505 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all KL = 0.528 +- 0.338 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all L1 = 0.359 +- 0.265 (in-sample avg dev_std = 0.442)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.956
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.858
NEC for r=1.0 class 0 = 0.093 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 1 = 0.013 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 2 = 0.303 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 3 = 0.229 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 4 = 0.189 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 5 = 0.325 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 6 = 0.222 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 7 = 0.186 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 8 = 0.206 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 9 = 0.338 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 all KL = 0.35 +- 0.347 (in-sample avg dev_std = 0.377)
NEC for r=1.0 all L1 = 0.205 +- 0.236 (in-sample avg dev_std = 0.377)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.091
NEC for r=0.3 class 0 = 0.344 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 1 = 0.317 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 2 = 0.37 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 3 = 0.333 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 4 = 0.352 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 5 = 0.342 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 6 = 0.347 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 7 = 0.325 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 8 = 0.368 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 9 = 0.341 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 all KL = 0.191 +- 0.137 (in-sample avg dev_std = 0.232)
NEC for r=0.3 all L1 = 0.343 +- 0.125 (in-sample avg dev_std = 0.232)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.204
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.175
NEC for r=0.6 class 0 = 0.254 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 1 = 0.397 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 2 = 0.278 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 3 = 0.355 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 4 = 0.438 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 5 = 0.36 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 6 = 0.424 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 7 = 0.397 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 8 = 0.435 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 9 = 0.476 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all KL = 0.325 +- 0.240 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all L1 = 0.383 +- 0.222 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.527 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 1 = 0.107 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 2 = 0.396 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 3 = 0.483 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 4 = 0.405 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 5 = 0.505 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 6 = 0.526 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 7 = 0.324 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 8 = 0.433 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 9 = 0.544 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all KL = 0.545 +- 0.324 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all L1 = 0.419 +- 0.260 (in-sample avg dev_std = 0.426)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.837
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.735
NEC for r=1.0 class 0 = 0.268 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 1 = 0.064 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 2 = 0.348 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 3 = 0.269 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 4 = 0.268 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 5 = 0.385 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 6 = 0.4 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 7 = 0.204 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 8 = 0.344 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 class 9 = 0.464 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 all KL = 0.422 +- 0.340 (in-sample avg dev_std = 0.401)
NEC for r=1.0 all L1 = 0.297 +- 0.262 (in-sample avg dev_std = 0.401)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
NEC for r=0.3 class 0 = 0.342 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 1 = 0.311 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 2 = 0.345 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 3 = 0.328 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 4 = 0.321 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 5 = 0.334 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 6 = 0.334 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 7 = 0.323 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 8 = 0.331 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 9 = 0.336 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 all KL = 0.191 +- 0.146 (in-sample avg dev_std = 0.249)
NEC for r=0.3 all L1 = 0.33 +- 0.132 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.159
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
NEC for r=0.6 class 0 = 0.129 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 1 = 0.42 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 2 = 0.152 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 3 = 0.213 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 4 = 0.244 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 5 = 0.205 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 6 = 0.202 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 7 = 0.249 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 8 = 0.24 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 class 9 = 0.246 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 all KL = 0.177 +- 0.203 (in-sample avg dev_std = 0.188)
NEC for r=0.6 all L1 = 0.232 +- 0.211 (in-sample avg dev_std = 0.188)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.229
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.245
NEC for r=0.9 class 0 = 0.513 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 1 = 0.065 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 2 = 0.5 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 3 = 0.516 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 4 = 0.528 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 5 = 0.542 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 6 = 0.526 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 7 = 0.449 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 8 = 0.556 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 9 = 0.477 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 all KL = 0.558 +- 0.385 (in-sample avg dev_std = 0.311)
NEC for r=0.9 all L1 = 0.462 +- 0.321 (in-sample avg dev_std = 0.311)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.183
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.227
NEC for r=1.0 class 0 = 0.516 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 1 = 0.071 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 2 = 0.44 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 3 = 0.46 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 4 = 0.36 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 5 = 0.488 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 6 = 0.326 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 7 = 0.316 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 8 = 0.47 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 9 = 0.307 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 all KL = 0.519 +- 0.432 (in-sample avg dev_std = 0.314)
NEC for r=1.0 all L1 = 0.372 +- 0.347 (in-sample avg dev_std = 0.314)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 08:49:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:15 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:15 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:15 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 08:49:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from val: Data(x=[75, 3], edge_index=[2, 1422], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1422], node_perm=[75])
Label distribution from val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([670, 794, 681, 716, 699, 616, 708, 732, 655, 729]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.48 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 1 = 0.445 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 2 = 0.488 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 3 = 0.485 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 4 = 0.457 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 5 = 0.465 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 6 = 0.445 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 7 = 0.457 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 8 = 0.453 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 9 = 0.434 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all KL = 0.454 +- 0.234 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all L1 = 0.461 +- 0.141 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.178
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.151
SUFF++ for r=0.6 class 0 = 0.392 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 1 = 0.409 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 2 = 0.43 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 3 = 0.47 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 4 = 0.526 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 5 = 0.423 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 6 = 0.465 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 7 = 0.396 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 8 = 0.572 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 9 = 0.489 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 all KL = 0.303 +- 0.294 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 all L1 = 0.456 +- 0.233 (in-sample avg dev_std = 0.454)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.77
SUFF++ for r=0.9 class 0 = 0.952 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 1 = 0.939 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 2 = 0.756 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 3 = 0.665 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 4 = 0.835 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 5 = 0.73 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 6 = 0.792 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 7 = 0.847 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 8 = 0.87 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 9 = 0.725 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 all KL = 0.798 +- 0.276 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 all L1 = 0.813 +- 0.224 (in-sample avg dev_std = 0.300)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.532 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 1 = 0.564 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 3 = 0.544 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 4 = 0.526 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 5 = 0.537 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 6 = 0.539 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 7 = 0.531 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 8 = 0.502 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 9 = 0.526 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 all KL = 0.572 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 all L1 = 0.535 +- 0.169 (in-sample avg dev_std = 0.386)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.182
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.139
SUFF++ for r=0.6 class 0 = 0.511 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.413 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.48 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 3 = 0.453 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 4 = 0.444 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 5 = 0.424 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 6 = 0.447 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 7 = 0.45 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 8 = 0.438 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 9 = 0.418 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.352 +- 0.293 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.447 +- 0.216 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.628
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.597
SUFF++ for r=0.9 class 0 = 0.779 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 1 = 0.977 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 2 = 0.725 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 3 = 0.681 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 4 = 0.761 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 5 = 0.73 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 6 = 0.693 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 7 = 0.837 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 8 = 0.674 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 9 = 0.703 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all KL = 0.773 +- 0.257 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all L1 = 0.76 +- 0.222 (in-sample avg dev_std = 0.322)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.434 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 1 = 0.437 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 2 = 0.454 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 3 = 0.49 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 4 = 0.492 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 5 = 0.493 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 6 = 0.509 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 7 = 0.485 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 8 = 0.495 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 9 = 0.523 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all KL = 0.405 +- 0.271 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all L1 = 0.48 +- 0.168 (in-sample avg dev_std = 0.586)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.188
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.18
SUFF++ for r=0.6 class 0 = 0.639 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 1 = 0.72 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 2 = 0.688 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 3 = 0.703 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 4 = 0.637 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 5 = 0.655 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 6 = 0.597 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 7 = 0.604 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 8 = 0.694 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 9 = 0.588 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all KL = 0.588 +- 0.358 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all L1 = 0.654 +- 0.289 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.17
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.178
SUFF++ for r=0.9 class 0 = 0.834 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 1 = 0.995 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 2 = 0.852 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 3 = 0.846 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 4 = 0.855 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 5 = 0.843 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 6 = 0.881 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 7 = 0.898 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 8 = 0.829 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 9 = 0.888 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all KL = 0.88 +- 0.217 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all L1 = 0.874 +- 0.191 (in-sample avg dev_std = 0.240)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.429 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.482 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.444 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 3 = 0.45 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 4 = 0.471 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 5 = 0.463 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 6 = 0.493 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 7 = 0.464 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 8 = 0.475 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 9 = 0.505 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.381 +- 0.230 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.467 +- 0.158 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.178
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.141
NEC for r=0.6 class 0 = 0.48 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 1 = 0.513 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 2 = 0.458 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 3 = 0.399 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 4 = 0.368 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 5 = 0.411 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 6 = 0.42 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 7 = 0.477 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 8 = 0.343 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 9 = 0.416 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all KL = 0.467 +- 0.296 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all L1 = 0.431 +- 0.248 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.627
NEC for r=0.9 class 0 = 0.227 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 1 = 0.202 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 2 = 0.464 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 3 = 0.662 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 4 = 0.348 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 5 = 0.532 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 6 = 0.423 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 7 = 0.33 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 8 = 0.3 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 9 = 0.501 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 all KL = 0.581 +- 0.340 (in-sample avg dev_std = 0.463)
NEC for r=0.9 all L1 = 0.396 +- 0.275 (in-sample avg dev_std = 0.463)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.956
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.838
NEC for r=1.0 class 0 = 0.086 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 1 = 0.03 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 2 = 0.293 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 3 = 0.391 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 4 = 0.178 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 5 = 0.318 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 6 = 0.254 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 7 = 0.166 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 8 = 0.19 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 class 9 = 0.38 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 all KL = 0.383 +- 0.360 (in-sample avg dev_std = 0.403)
NEC for r=1.0 all L1 = 0.225 +- 0.249 (in-sample avg dev_std = 0.403)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.102
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.413 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 1 = 0.386 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 2 = 0.418 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 3 = 0.427 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 4 = 0.445 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 5 = 0.43 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 6 = 0.443 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 7 = 0.428 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 8 = 0.451 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 9 = 0.444 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all KL = 0.335 +- 0.210 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all L1 = 0.428 +- 0.164 (in-sample avg dev_std = 0.293)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.182
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.154
NEC for r=0.6 class 0 = 0.419 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 1 = 0.434 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 2 = 0.439 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 3 = 0.454 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 4 = 0.446 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 5 = 0.46 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 6 = 0.472 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 7 = 0.449 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 8 = 0.464 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 9 = 0.481 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all KL = 0.453 +- 0.262 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all L1 = 0.452 +- 0.213 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.628
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 0 = 0.528 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 1 = 0.057 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 2 = 0.403 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 3 = 0.594 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 4 = 0.402 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 5 = 0.484 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 6 = 0.535 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 7 = 0.34 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 8 = 0.536 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 9 = 0.505 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 all KL = 0.539 +- 0.335 (in-sample avg dev_std = 0.430)
NEC for r=0.9 all L1 = 0.432 +- 0.272 (in-sample avg dev_std = 0.430)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.717
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.621
NEC for r=1.0 class 0 = 0.425 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 1 = 0.018 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 2 = 0.353 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 3 = 0.47 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 4 = 0.328 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 5 = 0.347 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 6 = 0.429 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 7 = 0.202 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 8 = 0.466 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 class 9 = 0.45 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 all KL = 0.453 +- 0.342 (in-sample avg dev_std = 0.421)
NEC for r=1.0 all L1 = 0.343 +- 0.272 (in-sample avg dev_std = 0.421)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.11
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 2500
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.118
NEC for r=0.3 class 0 = 0.369 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 1 = 0.359 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 2 = 0.383 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 3 = 0.39 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 4 = 0.402 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 5 = 0.411 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 6 = 0.417 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 7 = 0.387 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 8 = 0.417 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 9 = 0.394 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all KL = 0.337 +- 0.251 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all L1 = 0.392 +- 0.191 (in-sample avg dev_std = 0.339)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.188
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 2500
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.184
NEC for r=0.6 class 0 = 0.327 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 1 = 0.14 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 2 = 0.294 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 3 = 0.281 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 4 = 0.307 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 5 = 0.312 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 6 = 0.334 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 7 = 0.333 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 8 = 0.275 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 9 = 0.35 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all KL = 0.325 +- 0.292 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all L1 = 0.293 +- 0.250 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.17
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 2500
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.179
NEC for r=0.9 class 0 = 0.251 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 1 = 0.009 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 2 = 0.227 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 3 = 0.255 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 4 = 0.253 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 5 = 0.269 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 6 = 0.197 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 7 = 0.184 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 8 = 0.297 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 class 9 = 0.185 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 all KL = 0.254 +- 0.322 (in-sample avg dev_std = 0.275)
NEC for r=0.9 all L1 = 0.21 +- 0.263 (in-sample avg dev_std = 0.275)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.146
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.162
NEC for r=1.0 class 0 = 0.314 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 1 = 0.005 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 2 = 0.276 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 3 = 0.284 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 4 = 0.189 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 5 = 0.273 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 6 = 0.138 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 7 = 0.118 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 8 = 0.218 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 class 9 = 0.132 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 all KL = 0.271 +- 0.362 (in-sample avg dev_std = 0.260)
NEC for r=1.0 all L1 = 0.193 +- 0.275 (in-sample avg dev_std = 0.260)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.727, 0.354, 0.847, 1.0], 'all_L1': [0.592, 0.396, 0.835, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.48, 0.805, 1.0], 'all_L1': [0.562, 0.457, 0.82, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.192, 0.137, 1.0], 'all_L1': [0.438, 0.355, 0.336, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.627, 0.33, 0.847, 1.0], 'all_L1': [0.538, 0.397, 0.842, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.303, 0.798, 1.0], 'all_L1': [0.461, 0.456, 0.813, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.241, 0.446, 0.515, 0.345], 'all_L1': [0.403, 0.496, 0.369, 0.219]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.399, 0.522, 0.343], 'all_L1': [0.355, 0.476, 0.366, 0.211]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.769, 0.611, 0.368], 'all_L1': [0.54, 0.653, 0.466, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.223, 0.462, 0.528, 0.35], 'all_L1': [0.383, 0.49, 0.359, 0.205]}), defaultdict(<class 'list'>, {'all_KL': [0.381, 0.467, 0.581, 0.383], 'all_L1': [0.467, 0.431, 0.396, 0.225]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.724, 0.375, 0.845, 1.0], 'all_L1': [0.597, 0.416, 0.816, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.688, 0.538, 0.781, 1.0], 'all_L1': [0.563, 0.488, 0.786, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.417, 0.209, 0.208, 1.0], 'all_L1': [0.412, 0.366, 0.371, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.645, 0.418, 0.823, 1.0], 'all_L1': [0.551, 0.482, 0.799, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.352, 0.773, 1.0], 'all_L1': [0.535, 0.447, 0.76, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.213, 0.395, 0.499, 0.355], 'all_L1': [0.383, 0.452, 0.382, 0.263]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.353, 0.532, 0.374], 'all_L1': [0.36, 0.446, 0.409, 0.27]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.741, 0.585, 0.465], 'all_L1': [0.543, 0.633, 0.5, 0.343]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.325, 0.545, 0.422], 'all_L1': [0.343, 0.383, 0.419, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.335, 0.453, 0.539, 0.453], 'all_L1': [0.428, 0.452, 0.432, 0.343]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.694, 0.498, 0.775, 1.0], 'all_L1': [0.592, 0.487, 0.718, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.543, 0.797, 1.0], 'all_L1': [0.554, 0.496, 0.724, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.365, 0.142, 0.06, 1.0], 'all_L1': [0.379, 0.321, 0.322, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.371, 0.754, 1.0], 'all_L1': [0.558, 0.514, 0.761, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.588, 0.88, 1.0], 'all_L1': [0.48, 0.654, 0.874, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.201, 0.351, 0.526, 0.564], 'all_L1': [0.366, 0.425, 0.486, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.174, 0.353, 0.459, 0.467], 'all_L1': [0.352, 0.443, 0.454, 0.446]}), defaultdict(<class 'list'>, {'all_KL': [0.549, 0.784, 0.529, 0.468], 'all_L1': [0.585, 0.662, 0.456, 0.409]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.177, 0.558, 0.519], 'all_L1': [0.33, 0.232, 0.462, 0.372]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.325, 0.254, 0.271], 'all_L1': [0.392, 0.293, 0.21, 0.193]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.518 +- 0.059, 0.412 +- 0.039, 0.729 +- 0.197, 1.000 +- 0.000
suff++ class all_KL  =  0.594 +- 0.105, 0.332 +- 0.093, 0.687 +- 0.276, 1.000 +- 0.000
suff++_acc_int  =  0.106 +- 0.004, 0.176 +- 0.017, 0.684 +- 0.202
nec class all_L1  =  0.430 +- 0.066, 0.509 +- 0.075, 0.391 +- 0.039, 0.215 +- 0.007
nec class all_KL  =  0.292 +- 0.099, 0.509 +- 0.132, 0.551 +- 0.038, 0.358 +- 0.015
nec_acc_int  =  0.105 +- 0.006, 0.196 +- 0.033, 0.646 +- 0.036, 0.848 +- 0.008

Eval split val
suff++ class all_L1  =  0.532 +- 0.063, 0.440 +- 0.045, 0.706 +- 0.169, 1.000 +- 0.000
suff++ class all_KL  =  0.609 +- 0.109, 0.378 +- 0.106, 0.686 +- 0.240, 1.000 +- 0.000
suff++_acc_int  =  0.104 +- 0.003, 0.165 +- 0.024, 0.587 +- 0.203
nec class all_L1  =  0.411 +- 0.072, 0.473 +- 0.084, 0.428 +- 0.039, 0.303 +- 0.034
nec class all_KL  =  0.275 +- 0.107, 0.453 +- 0.150, 0.540 +- 0.028, 0.414 +- 0.043
nec_acc_int  =  0.102 +- 0.006, 0.184 +- 0.035, 0.540 +- 0.079, 0.713 +- 0.061

Eval split test
suff++ class all_L1  =  0.513 +- 0.076, 0.494 +- 0.106, 0.680 +- 0.187, 1.000 +- 0.000
suff++ class all_KL  =  0.560 +- 0.144, 0.428 +- 0.160, 0.653 +- 0.300, 1.000 +- 0.000
suff++_acc_int  =  0.111 +- 0.009, 0.154 +- 0.035, 0.263 +- 0.110
nec class all_L1  =  0.405 +- 0.092, 0.411 +- 0.148, 0.414 +- 0.102, 0.380 +- 0.101
nec class all_KL  =  0.290 +- 0.142, 0.398 +- 0.204, 0.465 +- 0.110, 0.458 +- 0.100
nec_acc_int  =  0.116 +- 0.014, 0.166 +- 0.040, 0.253 +- 0.078, 0.273 +- 0.097


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.016, 0.461 +- 0.023, 0.560 +- 0.080, 0.607 +- 0.003
Faith. Armon (L1)= 		  =  0.462 +- 0.019, 0.450 +- 0.011, 0.489 +- 0.050, 0.354 +- 0.009
Faith. GMean (L1)= 	  =  0.468 +- 0.017, 0.455 +- 0.016, 0.523 +- 0.064, 0.463 +- 0.007
Faith. Aritm (KL)= 		  =  0.443 +- 0.026, 0.420 +- 0.035, 0.619 +- 0.123, 0.679 +- 0.008
Faith. Armon (KL)= 		  =  0.370 +- 0.063, 0.378 +- 0.042, 0.564 +- 0.171, 0.527 +- 0.017
Faith. GMean (KL)= 	  =  0.404 +- 0.040, 0.397 +- 0.021, 0.590 +- 0.150, 0.598 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.472 +- 0.015, 0.456 +- 0.025, 0.567 +- 0.066, 0.652 +- 0.017
Faith. Armon (L1)= 		  =  0.455 +- 0.020, 0.448 +- 0.016, 0.517 +- 0.047, 0.464 +- 0.040
Faith. GMean (L1)= 	  =  0.463 +- 0.018, 0.452 +- 0.020, 0.542 +- 0.056, 0.550 +- 0.031
Faith. Aritm (KL)= 		  =  0.442 +- 0.017, 0.416 +- 0.039, 0.613 +- 0.109, 0.707 +- 0.022
Faith. Armon (KL)= 		  =  0.354 +- 0.064, 0.380 +- 0.033, 0.572 +- 0.133, 0.584 +- 0.043
Faith. GMean (KL)= 	  =  0.394 +- 0.038, 0.396 +- 0.022, 0.592 +- 0.122, 0.642 +- 0.034

Eval split test
Faith. Aritm (L1)= 		  =  0.459 +- 0.019, 0.453 +- 0.041, 0.547 +- 0.082, 0.690 +- 0.050
Faith. Armon (L1)= 		  =  0.438 +- 0.016, 0.416 +- 0.053, 0.486 +- 0.105, 0.543 +- 0.115
Faith. GMean (L1)= 	  =  0.448 +- 0.017, 0.434 +- 0.045, 0.514 +- 0.090, 0.610 +- 0.090
Faith. Aritm (KL)= 		  =  0.425 +- 0.030, 0.413 +- 0.071, 0.559 +- 0.136, 0.729 +- 0.050
Faith. Armon (KL)= 		  =  0.338 +- 0.059, 0.348 +- 0.088, 0.471 +- 0.202, 0.621 +- 0.102
Faith. GMean (KL)= 	  =  0.378 +- 0.037, 0.377 +- 0.071, 0.509 +- 0.177, 0.672 +- 0.080
Computed for split load_split = id



Completed in  6:06:31.733498  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:04:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3019) +- tensor(0.1589)
F1 for r=0.3 = 0.733
WIoU for r=0.3 = 0.694
F1 for r=0.6 = 0.617
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.746
F1 for r=1.0 = 0.442
WIoU for r=1.0 = 0.746
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1630) +- tensor(0.0462)
F1 for r=0.3 = 0.682
WIoU for r=0.3 = 0.991
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.991
F1 for r=0.9 = 0.302
WIoU for r=0.9 = 0.991
F1 for r=1.0 = 0.278
WIoU for r=1.0 = 0.991
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2657) +- tensor(0.1006)
F1 for r=0.3 = 0.796
WIoU for r=0.3 = 0.894
F1 for r=0.6 = 0.588
WIoU for r=0.6 = 0.946
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.944
F1 for r=1.0 = 0.410
WIoU for r=1.0 = 0.944


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.7333400000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.6939000000000002
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.507
SUFF++ for r=0.3 class 0 = 0.503 +- 0.302 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 class 1 = 0.515 +- 0.302 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 class 2 = 0.526 +- 0.302 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 all KL = 0.458 +- 0.302 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 all L1 = 0.515 +- 0.200 (in-sample avg dev_std = 0.539)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.61713
Model XAI WIoU of binarized graphs for r=0.6 =  0.75396
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.803
SUFF++ for r=0.6 class 0 = 0.67 +- 0.220 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 1 = 0.719 +- 0.220 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.220 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all KL = 0.745 +- 0.220 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all L1 = 0.701 +- 0.180 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.74575
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.778 +- 0.182 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 1 = 0.782 +- 0.182 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 2 = 0.795 +- 0.182 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all KL = 0.866 +- 0.182 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all L1 = 0.785 +- 0.179 (in-sample avg dev_std = 0.251)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.9
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99127
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.678
SUFF++ for r=0.3 class 0 = 0.508 +- 0.292 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 class 1 = 0.59 +- 0.292 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 class 2 = 0.518 +- 0.292 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 all KL = 0.503 +- 0.292 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 all L1 = 0.538 +- 0.161 (in-sample avg dev_std = 0.545)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.99127
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.752
SUFF++ for r=0.6 class 0 = 0.636 +- 0.182 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 1 = 0.58 +- 0.182 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 2 = 0.58 +- 0.182 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all KL = 0.701 +- 0.182 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all L1 = 0.599 +- 0.128 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.99127
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0 = 0.779 +- 0.131 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1 = 0.735 +- 0.131 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 2 = 0.767 +- 0.131 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.892 +- 0.131 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.156 (in-sample avg dev_std = 0.197)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.71
Model XAI F1 of binarized graphs for r=0.3 =  0.7956400000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8938299999999999
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.665
SUFF++ for r=0.3 class 0 = 0.573 +- 0.342 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 class 1 = 0.691 +- 0.342 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 class 2 = 0.575 +- 0.342 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 all KL = 0.531 +- 0.342 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 all L1 = 0.614 +- 0.219 (in-sample avg dev_std = 0.574)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.5879800000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.9463699999999998
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.86
SUFF++ for r=0.6 class 0 = 0.764 +- 0.218 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.218 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 2 = 0.827 +- 0.218 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all KL = 0.78 +- 0.218 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all L1 = 0.761 +- 0.155 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.9438500000000001
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.913
SUFF++ for r=0.9 class 0 = 0.922 +- 0.113 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 class 1 = 0.786 +- 0.113 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 class 2 = 0.87 +- 0.113 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 all KL = 0.922 +- 0.113 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 all L1 = 0.858 +- 0.148 (in-sample avg dev_std = 0.139)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  0.7333400000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.6939000000000002
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.354
NEC for r=0.3 class 0 = 0.645 +- 0.300 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 1 = 0.501 +- 0.300 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 2 = 0.575 +- 0.300 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all KL = 0.614 +- 0.300 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all L1 = 0.573 +- 0.179 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.61713
Model XAI WIoU of binarized graphs for r=0.6 =  0.75396
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.535
NEC for r=0.6 class 0 = 0.585 +- 0.319 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 1 = 0.381 +- 0.319 (in-sample avg dev_std = 0.496)
NEC for r=0.6 class 2 = 0.583 +- 0.319 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all KL = 0.521 +- 0.319 (in-sample avg dev_std = 0.496)
NEC for r=0.6 all L1 = 0.515 +- 0.187 (in-sample avg dev_std = 0.496)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.74575
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.58
NEC for r=0.9 class 0 = 0.546 +- 0.308 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 1 = 0.343 +- 0.308 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 2 = 0.54 +- 0.308 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all KL = 0.461 +- 0.308 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all L1 = 0.475 +- 0.189 (in-sample avg dev_std = 0.498)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.89
Model XAI F1 of binarized graphs for r=1.0 =  0.4424199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.74575
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.609
NEC for r=1.0 class 0 = 0.512 +- 0.295 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 1 = 0.355 +- 0.295 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 2 = 0.535 +- 0.295 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all KL = 0.448 +- 0.295 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all L1 = 0.466 +- 0.167 (in-sample avg dev_std = 0.511)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.9
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99127
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.354
NEC for r=0.3 class 0 = 0.672 +- 0.264 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 1 = 0.53 +- 0.264 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 2 = 0.729 +- 0.264 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all KL = 0.676 +- 0.264 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all L1 = 0.646 +- 0.130 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.99127
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.551
NEC for r=0.6 class 0 = 0.521 +- 0.218 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 1 = 0.487 +- 0.218 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 2 = 0.562 +- 0.218 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all KL = 0.457 +- 0.218 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all L1 = 0.524 +- 0.109 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.99127
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.467 +- 0.194 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 1 = 0.457 +- 0.194 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 2 = 0.515 +- 0.194 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all KL = 0.372 +- 0.194 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all L1 = 0.48 +- 0.114 (in-sample avg dev_std = 0.448)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.9
Model XAI F1 of binarized graphs for r=1.0 =  0.27769
Model XAI WIoU of binarized graphs for r=1.0 =  0.99127
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.46 +- 0.179 (in-sample avg dev_std = 0.448)
NEC for r=1.0 class 1 = 0.469 +- 0.179 (in-sample avg dev_std = 0.448)
NEC for r=1.0 class 2 = 0.486 +- 0.179 (in-sample avg dev_std = 0.448)
NEC for r=1.0 all KL = 0.361 +- 0.179 (in-sample avg dev_std = 0.448)
NEC for r=1.0 all L1 = 0.472 +- 0.107 (in-sample avg dev_std = 0.448)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.71
Model XAI F1 of binarized graphs for r=0.3 =  0.7956400000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8938299999999999
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.393
NEC for r=0.3 class 0 = 0.676 +- 0.305 (in-sample avg dev_std = 0.481)
NEC for r=0.3 class 1 = 0.473 +- 0.305 (in-sample avg dev_std = 0.481)
NEC for r=0.3 class 2 = 0.625 +- 0.305 (in-sample avg dev_std = 0.481)
NEC for r=0.3 all KL = 0.67 +- 0.305 (in-sample avg dev_std = 0.481)
NEC for r=0.3 all L1 = 0.59 +- 0.157 (in-sample avg dev_std = 0.481)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.5879800000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.9463699999999998
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0 = 0.528 +- 0.365 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 1 = 0.336 +- 0.365 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 2 = 0.569 +- 0.365 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all KL = 0.522 +- 0.365 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all L1 = 0.477 +- 0.220 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.9438500000000001
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0 = 0.418 +- 0.321 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 1 = 0.289 +- 0.321 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 2 = 0.439 +- 0.321 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all KL = 0.412 +- 0.321 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all L1 = 0.381 +- 0.196 (in-sample avg dev_std = 0.532)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.40979
Model XAI WIoU of binarized graphs for r=1.0 =  0.9438500000000001
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.683
NEC for r=1.0 class 0 = 0.391 +- 0.324 (in-sample avg dev_std = 0.528)
NEC for r=1.0 class 1 = 0.302 +- 0.324 (in-sample avg dev_std = 0.528)
NEC for r=1.0 class 2 = 0.48 +- 0.324 (in-sample avg dev_std = 0.528)
NEC for r=1.0 all KL = 0.42 +- 0.324 (in-sample avg dev_std = 0.528)
NEC for r=1.0 all L1 = 0.391 +- 0.196 (in-sample avg dev_std = 0.528)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:04:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:04:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3019) +- tensor(0.1589)
F1 for r=0.3 = 0.753
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.784
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.780
F1 for r=1.0 = 0.442
WIoU for r=1.0 = 0.780
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1630) +- tensor(0.0462)
F1 for r=0.3 = 0.682
WIoU for r=0.3 = 0.998
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.998
F1 for r=0.9 = 0.302
WIoU for r=0.9 = 0.998
F1 for r=1.0 = 0.278
WIoU for r=1.0 = 0.998
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2657) +- tensor(0.1006)
F1 for r=0.3 = 0.735
WIoU for r=0.3 = 0.825
F1 for r=0.6 = 0.588
WIoU for r=0.6 = 0.823
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.766
F1 for r=1.0 = 0.410
WIoU for r=1.0 = 0.760


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.7
Model XAI F1 of binarized graphs for r=0.3 =  0.7525400000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.7335800000000002
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.545
SUFF++ for r=0.3 class 0 = 0.477 +- 0.274 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 1 = 0.668 +- 0.274 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 2 = 0.495 +- 0.274 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all KL = 0.473 +- 0.274 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all L1 = 0.548 +- 0.159 (in-sample avg dev_std = 0.547)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.61645
Model XAI WIoU of binarized graphs for r=0.6 =  0.78388
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.764
SUFF++ for r=0.6 class 0 = 0.625 +- 0.247 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 1 = 0.711 +- 0.247 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 2 = 0.663 +- 0.247 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 all KL = 0.662 +- 0.247 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 all L1 = 0.667 +- 0.179 (in-sample avg dev_std = 0.454)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.7798299999999999
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0 = 0.809 +- 0.169 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.839 +- 0.169 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.799 +- 0.169 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.883 +- 0.169 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.168 (in-sample avg dev_std = 0.256)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.92
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9981
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.611
SUFF++ for r=0.3 class 0 = 0.473 +- 0.282 (in-sample avg dev_std = 0.607)
SUFF++ for r=0.3 class 1 = 0.603 +- 0.282 (in-sample avg dev_std = 0.607)
SUFF++ for r=0.3 class 2 = 0.477 +- 0.282 (in-sample avg dev_std = 0.607)
SUFF++ for r=0.3 all KL = 0.444 +- 0.282 (in-sample avg dev_std = 0.607)
SUFF++ for r=0.3 all L1 = 0.516 +- 0.161 (in-sample avg dev_std = 0.607)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.92
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.9981
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.697
SUFF++ for r=0.6 class 0 = 0.561 +- 0.193 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1 = 0.609 +- 0.193 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 2 = 0.632 +- 0.193 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.698 +- 0.193 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.6 +- 0.120 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.9981
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.757
SUFF++ for r=0.9 class 0 = 0.772 +- 0.166 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.166 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 2 = 0.594 +- 0.166 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 all KL = 0.84 +- 0.166 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 all L1 = 0.706 +- 0.161 (in-sample avg dev_std = 0.290)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  0.73488
Model XAI WIoU of binarized graphs for r=0.3 =  0.82536
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.603
SUFF++ for r=0.3 class 0 = 0.587 +- 0.222 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 1 = 0.58 +- 0.222 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 2 = 0.597 +- 0.222 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all KL = 0.637 +- 0.222 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all L1 = 0.588 +- 0.179 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.95
Model XAI F1 of binarized graphs for r=0.6 =  0.5879800000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8234300000000002
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.786
SUFF++ for r=0.6 class 0 = 0.676 +- 0.286 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 class 1 = 0.572 +- 0.286 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 class 2 = 0.672 +- 0.286 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 all KL = 0.621 +- 0.286 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 all L1 = 0.639 +- 0.172 (in-sample avg dev_std = 0.526)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.95
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.7662600000000002
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0 = 0.576 +- 0.399 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.9 class 1 = 0.624 +- 0.399 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.9 class 2 = 0.852 +- 0.399 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.9 all KL = 0.64 +- 0.399 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.9 all L1 = 0.686 +- 0.296 (in-sample avg dev_std = 0.522)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.7
Model XAI F1 of binarized graphs for r=0.3 =  0.7525400000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.7335800000000002
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.357
NEC for r=0.3 class 0 = 0.62 +- 0.295 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 1 = 0.489 +- 0.295 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 2 = 0.588 +- 0.295 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all KL = 0.623 +- 0.295 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all L1 = 0.565 +- 0.156 (in-sample avg dev_std = 0.371)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.61645
Model XAI WIoU of binarized graphs for r=0.6 =  0.78388
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.428
NEC for r=0.6 class 0 = 0.588 +- 0.312 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.497 +- 0.312 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.636 +- 0.312 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.607 +- 0.312 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.573 +- 0.174 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.7798299999999999
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.507 +- 0.297 (in-sample avg dev_std = 0.479)
NEC for r=0.9 class 1 = 0.452 +- 0.297 (in-sample avg dev_std = 0.479)
NEC for r=0.9 class 2 = 0.54 +- 0.297 (in-sample avg dev_std = 0.479)
NEC for r=0.9 all KL = 0.491 +- 0.297 (in-sample avg dev_std = 0.479)
NEC for r=0.9 all L1 = 0.499 +- 0.177 (in-sample avg dev_std = 0.479)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.4424199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7798299999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.521 +- 0.286 (in-sample avg dev_std = 0.476)
NEC for r=1.0 class 1 = 0.42 +- 0.286 (in-sample avg dev_std = 0.476)
NEC for r=1.0 class 2 = 0.534 +- 0.286 (in-sample avg dev_std = 0.476)
NEC for r=1.0 all KL = 0.478 +- 0.286 (in-sample avg dev_std = 0.476)
NEC for r=1.0 all L1 = 0.491 +- 0.171 (in-sample avg dev_std = 0.476)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.92
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9981
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.4
NEC for r=0.3 class 0 = 0.663 +- 0.263 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 1 = 0.542 +- 0.263 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 2 = 0.737 +- 0.263 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all KL = 0.71 +- 0.263 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all L1 = 0.65 +- 0.139 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.92
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.9981
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.509
NEC for r=0.6 class 0 = 0.55 +- 0.225 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.5 +- 0.225 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.538 +- 0.225 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.454 +- 0.225 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.53 +- 0.123 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.9981
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.564
NEC for r=0.9 class 0 = 0.464 +- 0.199 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 1 = 0.475 +- 0.199 (in-sample avg dev_std = 0.447)
NEC for r=0.9 class 2 = 0.481 +- 0.199 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all KL = 0.36 +- 0.199 (in-sample avg dev_std = 0.447)
NEC for r=0.9 all L1 = 0.473 +- 0.120 (in-sample avg dev_std = 0.447)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.27769
Model XAI WIoU of binarized graphs for r=1.0 =  0.9981
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.565
NEC for r=1.0 class 0 = 0.467 +- 0.202 (in-sample avg dev_std = 0.452)
NEC for r=1.0 class 1 = 0.491 +- 0.202 (in-sample avg dev_std = 0.452)
NEC for r=1.0 class 2 = 0.444 +- 0.202 (in-sample avg dev_std = 0.452)
NEC for r=1.0 all KL = 0.354 +- 0.202 (in-sample avg dev_std = 0.452)
NEC for r=1.0 all L1 = 0.467 +- 0.126 (in-sample avg dev_std = 0.452)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  0.73488
Model XAI WIoU of binarized graphs for r=0.3 =  0.82536
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.45
NEC for r=0.3 class 0 = 0.45 +- 0.226 (in-sample avg dev_std = 0.444)
NEC for r=0.3 class 1 = 0.51 +- 0.226 (in-sample avg dev_std = 0.444)
NEC for r=0.3 class 2 = 0.589 +- 0.226 (in-sample avg dev_std = 0.444)
NEC for r=0.3 all KL = 0.463 +- 0.226 (in-sample avg dev_std = 0.444)
NEC for r=0.3 all L1 = 0.518 +- 0.130 (in-sample avg dev_std = 0.444)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.95
Model XAI F1 of binarized graphs for r=0.6 =  0.5879800000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8234300000000002
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.529
NEC for r=0.6 class 0 = 0.464 +- 0.351 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 1 = 0.513 +- 0.351 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 2 = 0.51 +- 0.351 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all KL = 0.497 +- 0.351 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all L1 = 0.496 +- 0.207 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.95
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.7662600000000002
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.428 +- 0.323 (in-sample avg dev_std = 0.616)
NEC for r=0.9 class 1 = 0.504 +- 0.323 (in-sample avg dev_std = 0.616)
NEC for r=0.9 class 2 = 0.446 +- 0.323 (in-sample avg dev_std = 0.616)
NEC for r=0.9 all KL = 0.489 +- 0.323 (in-sample avg dev_std = 0.616)
NEC for r=0.9 all L1 = 0.46 +- 0.181 (in-sample avg dev_std = 0.616)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.95
Model XAI F1 of binarized graphs for r=1.0 =  0.40979
Model XAI WIoU of binarized graphs for r=1.0 =  0.7595800000000001
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.615
NEC for r=1.0 class 0 = 0.439 +- 0.325 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 1 = 0.491 +- 0.325 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 2 = 0.471 +- 0.325 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all KL = 0.493 +- 0.325 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all L1 = 0.468 +- 0.180 (in-sample avg dev_std = 0.606)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:05:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3019) +- tensor(0.1589)
F1 for r=0.3 = 0.688
WIoU for r=0.3 = 0.604
F1 for r=0.6 = 0.604
WIoU for r=0.6 = 0.685
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.694
F1 for r=1.0 = 0.442
WIoU for r=1.0 = 0.694
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1630) +- tensor(0.0462)
F1 for r=0.3 = 0.682
WIoU for r=0.3 = 0.999
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.999
F1 for r=0.9 = 0.302
WIoU for r=0.9 = 0.999
F1 for r=1.0 = 0.278
WIoU for r=1.0 = 0.999
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2657) +- tensor(0.1006)
F1 for r=0.3 = 0.793
WIoU for r=0.3 = 0.870
F1 for r=0.6 = 0.558
WIoU for r=0.6 = 0.712
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.651
F1 for r=1.0 = 0.410
WIoU for r=1.0 = 0.648


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.6881800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6036999999999999
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.425
SUFF++ for r=0.3 class 0 = 0.467 +- 0.260 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 class 1 = 0.519 +- 0.260 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 class 2 = 0.498 +- 0.260 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 all KL = 0.461 +- 0.260 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.3 all L1 = 0.495 +- 0.157 (in-sample avg dev_std = 0.528)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.6036300000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.6850700000000001
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.767
SUFF++ for r=0.6 class 0 = 0.639 +- 0.281 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.698 +- 0.281 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.704 +- 0.281 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.643 +- 0.281 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.681 +- 0.199 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.6943799999999999
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.865
SUFF++ for r=0.9 class 0 = 0.811 +- 0.148 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 class 1 = 0.833 +- 0.148 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 class 2 = 0.85 +- 0.148 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all KL = 0.886 +- 0.148 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.147 (in-sample avg dev_std = 0.208)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.94
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99883
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.623
SUFF++ for r=0.3 class 0 = 0.489 +- 0.258 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 class 1 = 0.613 +- 0.258 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 class 2 = 0.407 +- 0.258 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 all KL = 0.349 +- 0.258 (in-sample avg dev_std = 0.660)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.162 (in-sample avg dev_std = 0.660)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.99883
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0 = 0.569 +- 0.215 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 1 = 0.577 +- 0.215 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 2 = 0.645 +- 0.215 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all KL = 0.63 +- 0.215 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all L1 = 0.597 +- 0.137 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.99883
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.851
SUFF++ for r=0.9 class 0 = 0.79 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 1 = 0.756 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 2 = 0.815 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all KL = 0.871 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all L1 = 0.788 +- 0.154 (in-sample avg dev_std = 0.313)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.43
Model XAI F1 of binarized graphs for r=0.3 =  0.7927000000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.8697000000000003
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.571
SUFF++ for r=0.3 class 0 = 0.578 +- 0.291 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 1 = 0.632 +- 0.291 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 2 = 0.516 +- 0.291 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all KL = 0.554 +- 0.291 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all L1 = 0.575 +- 0.173 (in-sample avg dev_std = 0.543)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.55798
Model XAI WIoU of binarized graphs for r=0.6 =  0.7124799999999999
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.756
SUFF++ for r=0.6 class 0 = 0.567 +- 0.352 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 1 = 0.688 +- 0.352 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 class 2 = 0.632 +- 0.352 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 all KL = 0.558 +- 0.352 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.6 all L1 = 0.63 +- 0.206 (in-sample avg dev_std = 0.592)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.65086
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.866
SUFF++ for r=0.9 class 0 = 0.569 +- 0.332 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 1 = 0.698 +- 0.332 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 2 = 0.904 +- 0.332 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all KL = 0.704 +- 0.332 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all L1 = 0.727 +- 0.309 (in-sample avg dev_std = 0.338)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.6881800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6036999999999999
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.648 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 1 = 0.528 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 2 = 0.55 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all KL = 0.59 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all L1 = 0.575 +- 0.162 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.6036300000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.6850700000000001
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.444
NEC for r=0.6 class 0 = 0.553 +- 0.300 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 1 = 0.484 +- 0.300 (in-sample avg dev_std = 0.535)
NEC for r=0.6 class 2 = 0.676 +- 0.300 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all KL = 0.623 +- 0.300 (in-sample avg dev_std = 0.535)
NEC for r=0.6 all L1 = 0.57 +- 0.180 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.6943799999999999
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.551
NEC for r=0.9 class 0 = 0.474 +- 0.294 (in-sample avg dev_std = 0.574)
NEC for r=0.9 class 1 = 0.462 +- 0.294 (in-sample avg dev_std = 0.574)
NEC for r=0.9 class 2 = 0.595 +- 0.294 (in-sample avg dev_std = 0.574)
NEC for r=0.9 all KL = 0.538 +- 0.294 (in-sample avg dev_std = 0.574)
NEC for r=0.9 all L1 = 0.51 +- 0.164 (in-sample avg dev_std = 0.574)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.94
Model XAI F1 of binarized graphs for r=1.0 =  0.4424199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.6943799999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.589
NEC for r=1.0 class 0 = 0.502 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=1.0 class 1 = 0.425 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=1.0 class 2 = 0.57 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=1.0 all KL = 0.523 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=1.0 all L1 = 0.499 +- 0.166 (in-sample avg dev_std = 0.567)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.94
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99883
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.663 +- 0.202 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 1 = 0.573 +- 0.202 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 2 = 0.773 +- 0.202 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all KL = 0.796 +- 0.202 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all L1 = 0.671 +- 0.122 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.99883
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.516
NEC for r=0.6 class 0 = 0.547 +- 0.236 (in-sample avg dev_std = 0.574)
NEC for r=0.6 class 1 = 0.499 +- 0.236 (in-sample avg dev_std = 0.574)
NEC for r=0.6 class 2 = 0.592 +- 0.236 (in-sample avg dev_std = 0.574)
NEC for r=0.6 all KL = 0.541 +- 0.236 (in-sample avg dev_std = 0.574)
NEC for r=0.6 all L1 = 0.547 +- 0.139 (in-sample avg dev_std = 0.574)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.99883
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.483 +- 0.193 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 1 = 0.502 +- 0.193 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 2 = 0.5 +- 0.193 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all KL = 0.43 +- 0.193 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all L1 = 0.495 +- 0.111 (in-sample avg dev_std = 0.546)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.94
Model XAI F1 of binarized graphs for r=1.0 =  0.27769
Model XAI WIoU of binarized graphs for r=1.0 =  0.99883
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.463 +- 0.199 (in-sample avg dev_std = 0.549)
NEC for r=1.0 class 1 = 0.523 +- 0.199 (in-sample avg dev_std = 0.549)
NEC for r=1.0 class 2 = 0.524 +- 0.199 (in-sample avg dev_std = 0.549)
NEC for r=1.0 all KL = 0.438 +- 0.199 (in-sample avg dev_std = 0.549)
NEC for r=1.0 all L1 = 0.503 +- 0.114 (in-sample avg dev_std = 0.549)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.43
Model XAI F1 of binarized graphs for r=0.3 =  0.7927000000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.8697000000000003
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.382
NEC for r=0.3 class 0 = 0.546 +- 0.287 (in-sample avg dev_std = 0.532)
NEC for r=0.3 class 1 = 0.448 +- 0.287 (in-sample avg dev_std = 0.532)
NEC for r=0.3 class 2 = 0.626 +- 0.287 (in-sample avg dev_std = 0.532)
NEC for r=0.3 all KL = 0.57 +- 0.287 (in-sample avg dev_std = 0.532)
NEC for r=0.3 all L1 = 0.54 +- 0.143 (in-sample avg dev_std = 0.532)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.55798
Model XAI WIoU of binarized graphs for r=0.6 =  0.7124799999999999
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.556
NEC for r=0.6 class 0 = 0.455 +- 0.344 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 1 = 0.532 +- 0.344 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 2 = 0.562 +- 0.344 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all KL = 0.588 +- 0.344 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all L1 = 0.517 +- 0.216 (in-sample avg dev_std = 0.631)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.64
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.65086
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.613
NEC for r=0.9 class 0 = 0.451 +- 0.312 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.471 +- 0.312 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.368 +- 0.312 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.495 +- 0.312 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.43 +- 0.200 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.69
Model XAI F1 of binarized graphs for r=1.0 =  0.40979
Model XAI WIoU of binarized graphs for r=1.0 =  0.64753
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.616
NEC for r=1.0 class 0 = 0.41 +- 0.301 (in-sample avg dev_std = 0.557)
NEC for r=1.0 class 1 = 0.493 +- 0.301 (in-sample avg dev_std = 0.557)
NEC for r=1.0 class 2 = 0.325 +- 0.301 (in-sample avg dev_std = 0.557)
NEC for r=1.0 all KL = 0.471 +- 0.301 (in-sample avg dev_std = 0.557)
NEC for r=1.0 all L1 = 0.409 +- 0.210 (in-sample avg dev_std = 0.557)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:05:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:05:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3019) +- tensor(0.1589)
F1 for r=0.3 = 0.756
WIoU for r=0.3 = 0.848
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.907
F1 for r=0.9 = 0.471
WIoU for r=0.9 = 0.908
F1 for r=1.0 = 0.442
WIoU for r=1.0 = 0.908
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1630) +- tensor(0.0462)
F1 for r=0.3 = 0.682
WIoU for r=0.3 = 0.999
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.999
F1 for r=0.9 = 0.302
WIoU for r=0.9 = 0.999
F1 for r=1.0 = 0.278
WIoU for r=1.0 = 0.999
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2657) +- tensor(0.1006)
F1 for r=0.3 = 0.752
WIoU for r=0.3 = 0.835
F1 for r=0.6 = 0.573
WIoU for r=0.6 = 0.842
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.842
F1 for r=1.0 = 0.410
WIoU for r=1.0 = 0.842


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.7563700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8478699999999999
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.521
SUFF++ for r=0.3 class 0 = 0.534 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 class 1 = 0.657 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 class 2 = 0.486 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 all KL = 0.543 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.3 all L1 = 0.56 +- 0.156 (in-sample avg dev_std = 0.483)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60807
Model XAI WIoU of binarized graphs for r=0.6 =  0.90705
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.776
SUFF++ for r=0.6 class 0 = 0.626 +- 0.174 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 class 1 = 0.772 +- 0.174 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 class 2 = 0.781 +- 0.174 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 all KL = 0.81 +- 0.174 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 all L1 = 0.727 +- 0.177 (in-sample avg dev_std = 0.314)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47111
Model XAI WIoU of binarized graphs for r=0.9 =  0.90776
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.846
SUFF++ for r=0.9 class 0 = 0.832 +- 0.137 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.137 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.9 class 2 = 0.849 +- 0.137 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.9 all KL = 0.927 +- 0.137 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.9 all L1 = 0.851 +- 0.145 (in-sample avg dev_std = 0.196)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.94
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9991500000000001
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.675
SUFF++ for r=0.3 class 0 = 0.534 +- 0.290 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 class 1 = 0.709 +- 0.290 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 class 2 = 0.67 +- 0.290 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 all KL = 0.655 +- 0.290 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.3 all L1 = 0.636 +- 0.198 (in-sample avg dev_std = 0.422)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.9991500000000001
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.77
SUFF++ for r=0.6 class 0 = 0.674 +- 0.134 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 1 = 0.734 +- 0.134 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 2 = 0.726 +- 0.134 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all KL = 0.848 +- 0.134 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all L1 = 0.711 +- 0.120 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.9991500000000001
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.83
SUFF++ for r=0.9 class 0 = 0.785 +- 0.124 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 1 = 0.755 +- 0.124 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.124 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all KL = 0.915 +- 0.124 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all L1 = 0.8 +- 0.126 (in-sample avg dev_std = 0.245)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.77
Model XAI F1 of binarized graphs for r=0.3 =  0.75196
Model XAI WIoU of binarized graphs for r=0.3 =  0.8352100000000001
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.544
SUFF++ for r=0.3 class 0 = 0.498 +- 0.312 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 1 = 0.657 +- 0.312 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.312 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all KL = 0.573 +- 0.312 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all L1 = 0.569 +- 0.168 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.92
Model XAI F1 of binarized graphs for r=0.6 =  0.57298
Model XAI WIoU of binarized graphs for r=0.6 =  0.8415699999999999
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.714
SUFF++ for r=0.6 class 0 = 0.538 +- 0.206 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 1 = 0.8 +- 0.206 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 2 = 0.789 +- 0.206 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all KL = 0.774 +- 0.206 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all L1 = 0.713 +- 0.185 (in-sample avg dev_std = 0.376)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.8415699999999999
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.808
SUFF++ for r=0.9 class 0 = 0.722 +- 0.103 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 1 = 0.834 +- 0.103 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 2 = 0.912 +- 0.103 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all KL = 0.908 +- 0.103 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.155 (in-sample avg dev_std = 0.211)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.7563700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8478699999999999
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.479 +- 0.346 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1 = 0.463 +- 0.346 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 2 = 0.612 +- 0.346 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.525 +- 0.346 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.518 +- 0.173 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60807
Model XAI WIoU of binarized graphs for r=0.6 =  0.90705
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.454
NEC for r=0.6 class 0 = 0.429 +- 0.313 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.441 +- 0.313 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.644 +- 0.313 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.46 +- 0.313 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.504 +- 0.179 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47111
Model XAI WIoU of binarized graphs for r=0.9 =  0.90776
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.414 +- 0.302 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 1 = 0.369 +- 0.302 (in-sample avg dev_std = 0.454)
NEC for r=0.9 class 2 = 0.545 +- 0.302 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all KL = 0.375 +- 0.302 (in-sample avg dev_std = 0.454)
NEC for r=0.9 all L1 = 0.442 +- 0.188 (in-sample avg dev_std = 0.454)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.4424199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.90776
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.566
NEC for r=1.0 class 0 = 0.377 +- 0.286 (in-sample avg dev_std = 0.477)
NEC for r=1.0 class 1 = 0.359 +- 0.286 (in-sample avg dev_std = 0.477)
NEC for r=1.0 class 2 = 0.524 +- 0.286 (in-sample avg dev_std = 0.477)
NEC for r=1.0 all KL = 0.353 +- 0.286 (in-sample avg dev_std = 0.477)
NEC for r=1.0 all L1 = 0.42 +- 0.169 (in-sample avg dev_std = 0.477)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.94
Model XAI F1 of binarized graphs for r=0.3 =  0.6818500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9991500000000001
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.463 +- 0.316 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 1 = 0.55 +- 0.316 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 2 = 0.754 +- 0.316 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all KL = 0.593 +- 0.316 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all L1 = 0.59 +- 0.181 (in-sample avg dev_std = 0.382)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.9991500000000001
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.531
NEC for r=0.6 class 0 = 0.379 +- 0.249 (in-sample avg dev_std = 0.437)
NEC for r=0.6 class 1 = 0.403 +- 0.249 (in-sample avg dev_std = 0.437)
NEC for r=0.6 class 2 = 0.572 +- 0.249 (in-sample avg dev_std = 0.437)
NEC for r=0.6 all KL = 0.35 +- 0.249 (in-sample avg dev_std = 0.437)
NEC for r=0.6 all L1 = 0.452 +- 0.159 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.9991500000000001
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.559
NEC for r=0.9 class 0 = 0.335 +- 0.199 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 1 = 0.37 +- 0.199 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 2 = 0.488 +- 0.199 (in-sample avg dev_std = 0.384)
NEC for r=0.9 all KL = 0.252 +- 0.199 (in-sample avg dev_std = 0.384)
NEC for r=0.9 all L1 = 0.398 +- 0.145 (in-sample avg dev_std = 0.384)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.27769
Model XAI WIoU of binarized graphs for r=1.0 =  0.9991500000000001
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.614
NEC for r=1.0 class 0 = 0.334 +- 0.182 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 1 = 0.349 +- 0.182 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 2 = 0.431 +- 0.182 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all KL = 0.225 +- 0.182 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all L1 = 0.372 +- 0.132 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.77
Model XAI F1 of binarized graphs for r=0.3 =  0.75196
Model XAI WIoU of binarized graphs for r=0.3 =  0.8352100000000001
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.298
NEC for r=0.3 class 0 = 0.51 +- 0.328 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 1 = 0.484 +- 0.328 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 2 = 0.576 +- 0.328 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all KL = 0.523 +- 0.328 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all L1 = 0.524 +- 0.160 (in-sample avg dev_std = 0.385)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.92
Model XAI F1 of binarized graphs for r=0.6 =  0.57298
Model XAI WIoU of binarized graphs for r=0.6 =  0.8415699999999999
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.519
NEC for r=0.6 class 0 = 0.382 +- 0.345 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 1 = 0.429 +- 0.345 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 2 = 0.545 +- 0.345 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all KL = 0.427 +- 0.345 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all L1 = 0.454 +- 0.204 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.8415699999999999
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.586
NEC for r=0.9 class 0 = 0.379 +- 0.297 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 1 = 0.38 +- 0.297 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 2 = 0.467 +- 0.297 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all KL = 0.379 +- 0.297 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all L1 = 0.409 +- 0.170 (in-sample avg dev_std = 0.522)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.40979
Model XAI WIoU of binarized graphs for r=1.0 =  0.8415699999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.618
NEC for r=1.0 class 0 = 0.416 +- 0.286 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 1 = 0.369 +- 0.286 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 2 = 0.411 +- 0.286 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all KL = 0.371 +- 0.286 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all L1 = 0.399 +- 0.174 (in-sample avg dev_std = 0.504)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:06:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:06:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3019) +- tensor(0.1589)
F1 for r=0.3 = 0.727
WIoU for r=0.3 = 0.678
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.739
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.734
F1 for r=1.0 = 0.442
WIoU for r=1.0 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1630) +- tensor(0.0462)
F1 for r=0.3 = 0.679
WIoU for r=0.3 = 0.922
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.916
F1 for r=0.9 = 0.302
WIoU for r=0.9 = 0.916
F1 for r=1.0 = 0.278
WIoU for r=1.0 = 0.916
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2657) +- tensor(0.1006)
F1 for r=0.3 = 0.773
WIoU for r=0.3 = 0.879
F1 for r=0.6 = 0.558
WIoU for r=0.6 = 0.819
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.797
F1 for r=1.0 = 0.410
WIoU for r=1.0 = 0.797


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.65
Model XAI F1 of binarized graphs for r=0.3 =  0.7270400000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.67756
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.574
SUFF++ for r=0.3 class 0 = 0.501 +- 0.303 (in-sample avg dev_std = 0.635)
SUFF++ for r=0.3 class 1 = 0.521 +- 0.303 (in-sample avg dev_std = 0.635)
SUFF++ for r=0.3 class 2 = 0.466 +- 0.303 (in-sample avg dev_std = 0.635)
SUFF++ for r=0.3 all KL = 0.333 +- 0.303 (in-sample avg dev_std = 0.635)
SUFF++ for r=0.3 all L1 = 0.496 +- 0.185 (in-sample avg dev_std = 0.635)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.6084700000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.73856
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.786
SUFF++ for r=0.6 class 0 = 0.633 +- 0.309 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 1 = 0.718 +- 0.309 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 2 = 0.711 +- 0.309 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all KL = 0.634 +- 0.309 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all L1 = 0.688 +- 0.215 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.7343999999999999
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0 = 0.758 +- 0.230 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1 = 0.823 +- 0.230 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 2 = 0.861 +- 0.230 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.842 +- 0.230 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.814 +- 0.203 (in-sample avg dev_std = 0.261)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.89
Model XAI F1 of binarized graphs for r=0.3 =  0.6786500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.92212
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.66
SUFF++ for r=0.3 class 0 = 0.48 +- 0.314 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.623 +- 0.314 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.623 +- 0.314 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.459 +- 0.314 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.574 +- 0.199 (in-sample avg dev_std = 0.608)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.9157900000000001
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF++ for r=0.6 class 0 = 0.601 +- 0.237 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 1 = 0.6 +- 0.237 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 2 = 0.649 +- 0.237 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all KL = 0.66 +- 0.237 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all L1 = 0.617 +- 0.161 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.9157900000000001
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0 = 0.755 +- 0.189 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 1 = 0.728 +- 0.189 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 2 = 0.823 +- 0.189 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all KL = 0.862 +- 0.189 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all L1 = 0.769 +- 0.167 (in-sample avg dev_std = 0.264)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.91
Model XAI F1 of binarized graphs for r=0.3 =  0.7726800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8791700000000001
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.724
SUFF++ for r=0.3 class 0 = 0.549 +- 0.279 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 1 = 0.616 +- 0.279 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 2 = 0.536 +- 0.279 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all KL = 0.52 +- 0.279 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all L1 = 0.567 +- 0.188 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.55798
Model XAI WIoU of binarized graphs for r=0.6 =  0.8191299999999999
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.793
SUFF++ for r=0.6 class 0 = 0.576 +- 0.325 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 1 = 0.757 +- 0.325 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 2 = 0.67 +- 0.325 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 all KL = 0.647 +- 0.325 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 all L1 = 0.67 +- 0.183 (in-sample avg dev_std = 0.513)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.7973499999999999
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.921
SUFF++ for r=0.9 class 0 = 0.809 +- 0.114 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 1 = 0.944 +- 0.114 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 2 = 0.921 +- 0.114 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all KL = 0.944 +- 0.114 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all L1 = 0.893 +- 0.144 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.64
Model XAI F1 of binarized graphs for r=0.3 =  0.7270400000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.67756
len(reference) = 100
Effective ratio: 0.312 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.648 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.3 class 1 = 0.52 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.3 class 2 = 0.681 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.3 all KL = 0.744 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.3 all L1 = 0.615 +- 0.157 (in-sample avg dev_std = 0.568)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.6084700000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.73856
len(reference) = 100
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.522
NEC for r=0.6 class 0 = 0.5 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 1 = 0.465 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 2 = 0.623 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all KL = 0.625 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all L1 = 0.529 +- 0.178 (in-sample avg dev_std = 0.536)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.47179999999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.7343999999999999
len(reference) = 100
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.425 +- 0.317 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 1 = 0.407 +- 0.317 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 2 = 0.566 +- 0.317 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all KL = 0.522 +- 0.317 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all L1 = 0.465 +- 0.163 (in-sample avg dev_std = 0.585)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.4424199999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.7343999999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.586
NEC for r=1.0 class 0 = 0.451 +- 0.314 (in-sample avg dev_std = 0.568)
NEC for r=1.0 class 1 = 0.416 +- 0.314 (in-sample avg dev_std = 0.568)
NEC for r=1.0 class 2 = 0.572 +- 0.314 (in-sample avg dev_std = 0.568)
NEC for r=1.0 all KL = 0.526 +- 0.314 (in-sample avg dev_std = 0.568)
NEC for r=1.0 all L1 = 0.479 +- 0.165 (in-sample avg dev_std = 0.568)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.89
Model XAI F1 of binarized graphs for r=0.3 =  0.6786500000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.92212
len(reference) = 100
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.406
NEC for r=0.3 class 0 = 0.591 +- 0.259 (in-sample avg dev_std = 0.522)
NEC for r=0.3 class 1 = 0.59 +- 0.259 (in-sample avg dev_std = 0.522)
NEC for r=0.3 class 2 = 0.72 +- 0.259 (in-sample avg dev_std = 0.522)
NEC for r=0.3 all KL = 0.736 +- 0.259 (in-sample avg dev_std = 0.522)
NEC for r=0.3 all L1 = 0.635 +- 0.121 (in-sample avg dev_std = 0.522)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.4178099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.9157900000000001
len(reference) = 100
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.591
NEC for r=0.6 class 0 = 0.409 +- 0.274 (in-sample avg dev_std = 0.528)
NEC for r=0.6 class 1 = 0.457 +- 0.274 (in-sample avg dev_std = 0.528)
NEC for r=0.6 class 2 = 0.535 +- 0.274 (in-sample avg dev_std = 0.528)
NEC for r=0.6 all KL = 0.438 +- 0.274 (in-sample avg dev_std = 0.528)
NEC for r=0.6 all L1 = 0.467 +- 0.139 (in-sample avg dev_std = 0.528)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.30172
Model XAI WIoU of binarized graphs for r=0.9 =  0.9157900000000001
len(reference) = 100
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.4 +- 0.242 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.44 +- 0.242 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.47 +- 0.242 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.378 +- 0.242 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.436 +- 0.127 (in-sample avg dev_std = 0.508)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.9
Model XAI F1 of binarized graphs for r=1.0 =  0.27769
Model XAI WIoU of binarized graphs for r=1.0 =  0.9157900000000001
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.635
NEC for r=1.0 class 0 = 0.389 +- 0.233 (in-sample avg dev_std = 0.500)
NEC for r=1.0 class 1 = 0.436 +- 0.233 (in-sample avg dev_std = 0.500)
NEC for r=1.0 class 2 = 0.422 +- 0.233 (in-sample avg dev_std = 0.500)
NEC for r=1.0 all KL = 0.358 +- 0.233 (in-sample avg dev_std = 0.500)
NEC for r=1.0 all L1 = 0.415 +- 0.129 (in-sample avg dev_std = 0.500)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.91
Model XAI F1 of binarized graphs for r=0.3 =  0.7726800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8791700000000001
len(reference) = 100
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.412
NEC for r=0.3 class 0 = 0.63 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.3 class 1 = 0.517 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.3 class 2 = 0.621 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.3 all KL = 0.643 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.3 all L1 = 0.589 +- 0.126 (in-sample avg dev_std = 0.525)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.55798
Model XAI WIoU of binarized graphs for r=0.6 =  0.8191299999999999
len(reference) = 100
Effective ratio: 0.609 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.63
NEC for r=0.6 class 0 = 0.458 +- 0.327 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.413 +- 0.327 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.535 +- 0.327 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.508 +- 0.327 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.469 +- 0.191 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.44282
Model XAI WIoU of binarized graphs for r=0.9 =  0.7973499999999999
len(reference) = 100
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0 = 0.405 +- 0.322 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.37 +- 0.322 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.511 +- 0.322 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.486 +- 0.322 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.429 +- 0.190 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.40979
Model XAI WIoU of binarized graphs for r=1.0 =  0.7973499999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.724
NEC for r=1.0 class 0 = 0.405 +- 0.308 (in-sample avg dev_std = 0.571)
NEC for r=1.0 class 1 = 0.335 +- 0.308 (in-sample avg dev_std = 0.571)
NEC for r=1.0 class 2 = 0.41 +- 0.308 (in-sample avg dev_std = 0.571)
NEC for r=1.0 all KL = 0.441 +- 0.308 (in-sample avg dev_std = 0.571)
NEC for r=1.0 all L1 = 0.383 +- 0.175 (in-sample avg dev_std = 0.571)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.458, 0.745, 0.866, 1.0], 'all_L1': [0.515, 0.701, 0.785, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.473, 0.662, 0.883, 1.0], 'all_L1': [0.548, 0.667, 0.816, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.461, 0.643, 0.886, 1.0], 'all_L1': [0.495, 0.681, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.81, 0.927, 1.0], 'all_L1': [0.56, 0.727, 0.851, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.634, 0.842, 1.0], 'all_L1': [0.496, 0.688, 0.814, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.614, 0.521, 0.461, 0.448], 'all_L1': [0.573, 0.515, 0.475, 0.466]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.607, 0.491, 0.478], 'all_L1': [0.565, 0.573, 0.499, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.59, 0.623, 0.538, 0.523], 'all_L1': [0.575, 0.57, 0.51, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.525, 0.46, 0.375, 0.353], 'all_L1': [0.518, 0.504, 0.442, 0.42]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.625, 0.522, 0.526], 'all_L1': [0.615, 0.529, 0.465, 0.479]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.503, 0.701, 0.892, 1.0], 'all_L1': [0.538, 0.599, 0.761, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.698, 0.84, 1.0], 'all_L1': [0.516, 0.6, 0.706, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.349, 0.63, 0.871, 1.0], 'all_L1': [0.501, 0.597, 0.788, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.655, 0.848, 0.915, 1.0], 'all_L1': [0.636, 0.711, 0.8, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.66, 0.862, 1.0], 'all_L1': [0.574, 0.617, 0.769, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.676, 0.457, 0.372, 0.361], 'all_L1': [0.646, 0.524, 0.48, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.71, 0.454, 0.36, 0.354], 'all_L1': [0.65, 0.53, 0.473, 0.467]}), defaultdict(<class 'list'>, {'all_KL': [0.796, 0.541, 0.43, 0.438], 'all_L1': [0.671, 0.547, 0.495, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.593, 0.35, 0.252, 0.225], 'all_L1': [0.59, 0.452, 0.398, 0.372]}), defaultdict(<class 'list'>, {'all_KL': [0.736, 0.438, 0.378, 0.358], 'all_L1': [0.635, 0.467, 0.436, 0.415]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.531, 0.78, 0.922, 1.0], 'all_L1': [0.614, 0.761, 0.858, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.621, 0.64, 1.0], 'all_L1': [0.588, 0.639, 0.686, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.558, 0.704, 1.0], 'all_L1': [0.575, 0.63, 0.727, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.774, 0.908, 1.0], 'all_L1': [0.569, 0.713, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.647, 0.944, 1.0], 'all_L1': [0.567, 0.67, 0.893, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.67, 0.522, 0.412, 0.42], 'all_L1': [0.59, 0.477, 0.381, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.497, 0.489, 0.493], 'all_L1': [0.518, 0.496, 0.46, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.57, 0.588, 0.495, 0.471], 'all_L1': [0.54, 0.517, 0.43, 0.409]}), defaultdict(<class 'list'>, {'all_KL': [0.523, 0.427, 0.379, 0.371], 'all_L1': [0.524, 0.454, 0.409, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.508, 0.486, 0.441], 'all_L1': [0.589, 0.469, 0.429, 0.383]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.523 +- 0.027, 0.693 +- 0.020, 0.820 +- 0.022, 1.000 +- 0.000
suff++ class all_KL  =  0.454 +- 0.068, 0.699 +- 0.068, 0.881 +- 0.028, 1.000 +- 0.000
suff++_acc_int  =  0.515 +- 0.050, 0.779 +- 0.014, 0.862 +- 0.011
nec class all_L1  =  0.569 +- 0.031, 0.538 +- 0.028, 0.478 +- 0.024, 0.471 +- 0.028
nec class all_KL  =  0.619 +- 0.071, 0.567 +- 0.066, 0.477 +- 0.058, 0.466 +- 0.063
nec_acc_int  =  0.358 +- 0.024, 0.476 +- 0.044, 0.559 +- 0.027, 0.580 +- 0.021

Eval split val
suff++ class all_L1  =  0.553 +- 0.048, 0.625 +- 0.044, 0.765 +- 0.032, 1.000 +- 0.000
suff++ class all_KL  =  0.482 +- 0.100, 0.707 +- 0.075, 0.876 +- 0.026, 1.000 +- 0.000
suff++_acc_int  =  0.649 +- 0.027, 0.735 +- 0.025, 0.811 +- 0.032
nec class all_L1  =  0.638 +- 0.027, 0.504 +- 0.037, 0.456 +- 0.035, 0.446 +- 0.046
nec class all_KL  =  0.702 +- 0.067, 0.448 +- 0.061, 0.358 +- 0.058, 0.347 +- 0.069
nec_acc_int  =  0.386 +- 0.020, 0.540 +- 0.030, 0.570 +- 0.026, 0.586 +- 0.033

Eval split test
suff++ class all_L1  =  0.583 +- 0.017, 0.683 +- 0.049, 0.798 +- 0.079, 1.000 +- 0.000
suff++ class all_KL  =  0.563 +- 0.041, 0.676 +- 0.087, 0.824 +- 0.126, 1.000 +- 0.000
suff++_acc_int  =  0.621 +- 0.065, 0.782 +- 0.048, 0.846 +- 0.073
nec class all_L1  =  0.552 +- 0.031, 0.483 +- 0.022, 0.422 +- 0.026, 0.410 +- 0.030
nec class all_KL  =  0.574 +- 0.076, 0.508 +- 0.052, 0.452 +- 0.048, 0.439 +- 0.042
nec_acc_int  =  0.387 +- 0.050, 0.562 +- 0.040, 0.627 +- 0.030, 0.651 +- 0.045


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.546 +- 0.009, 0.615 +- 0.007, 0.649 +- 0.014, 0.735 +- 0.014
Faith. Armon (L1)= 		  =  0.544 +- 0.008, 0.605 +- 0.011, 0.603 +- 0.019, 0.640 +- 0.026
Faith. GMean (L1)= 	  =  0.545 +- 0.008, 0.610 +- 0.009, 0.626 +- 0.016, 0.686 +- 0.021
Faith. Aritm (KL)= 		  =  0.536 +- 0.007, 0.633 +- 0.002, 0.679 +- 0.021, 0.733 +- 0.032
Faith. Armon (KL)= 		  =  0.515 +- 0.028, 0.619 +- 0.018, 0.616 +- 0.047, 0.633 +- 0.061
Faith. GMean (KL)= 	  =  0.525 +- 0.015, 0.626 +- 0.009, 0.647 +- 0.034, 0.681 +- 0.048

Eval split val
Faith. Aritm (L1)= 		  =  0.596 +- 0.011, 0.564 +- 0.013, 0.611 +- 0.018, 0.723 +- 0.023
Faith. Armon (L1)= 		  =  0.590 +- 0.015, 0.555 +- 0.013, 0.570 +- 0.026, 0.615 +- 0.045
Faith. GMean (L1)= 	  =  0.593 +- 0.013, 0.560 +- 0.012, 0.590 +- 0.022, 0.667 +- 0.035
Faith. Aritm (KL)= 		  =  0.592 +- 0.018, 0.578 +- 0.016, 0.617 +- 0.024, 0.674 +- 0.034
Faith. Armon (KL)= 		  =  0.559 +- 0.045, 0.542 +- 0.029, 0.505 +- 0.060, 0.511 +- 0.079
Faith. GMean (KL)= 	  =  0.575 +- 0.031, 0.559 +- 0.016, 0.558 +- 0.044, 0.586 +- 0.061

Eval split test
Faith. Aritm (L1)= 		  =  0.567 +- 0.020, 0.583 +- 0.019, 0.610 +- 0.032, 0.705 +- 0.015
Faith. Armon (L1)= 		  =  0.567 +- 0.021, 0.564 +- 0.013, 0.549 +- 0.017, 0.581 +- 0.030
Faith. GMean (L1)= 	  =  0.567 +- 0.020, 0.573 +- 0.015, 0.578 +- 0.022, 0.640 +- 0.023
Faith. Aritm (KL)= 		  =  0.568 +- 0.020, 0.592 +- 0.032, 0.638 +- 0.052, 0.720 +- 0.021
Faith. Armon (KL)= 		  =  0.562 +- 0.020, 0.574 +- 0.027, 0.576 +- 0.036, 0.609 +- 0.041
Faith. GMean (KL)= 	  =  0.565 +- 0.020, 0.583 +- 0.028, 0.606 +- 0.040, 0.662 +- 0.032
Computed for split load_split = id



Completed in  0:02:26.689889  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:07:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:07:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3054) +- tensor(0.1599)
F1 for r=0.3 = 0.717
WIoU for r=0.3 = 0.671
F1 for r=0.6 = 0.618
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.742
F1 for r=1.0 = 0.446
WIoU for r=1.0 = 0.741
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1583) +- tensor(0.0458)
F1 for r=0.3 = 0.666
WIoU for r=0.3 = 0.986
F1 for r=0.6 = 0.407
WIoU for r=0.6 = 0.986
F1 for r=0.9 = 0.294
WIoU for r=0.9 = 0.986
F1 for r=1.0 = 0.271
WIoU for r=1.0 = 0.986
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2519) +- tensor(0.0995)
F1 for r=0.3 = 0.784
WIoU for r=0.3 = 0.907
F1 for r=0.6 = 0.566
WIoU for r=0.6 = 0.955
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.953
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.953


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.717266
Model XAI WIoU of binarized graphs for r=0.3 =  0.670974
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.525
SUFF++ for r=0.3 class 0 = 0.582 +- 0.293 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.527 +- 0.293 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.521 +- 0.293 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.502 +- 0.293 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.543 +- 0.200 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  0.6181
Model XAI WIoU of binarized graphs for r=0.6 =  0.7465579999999999
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.773
SUFF++ for r=0.6 class 0 = 0.7 +- 0.251 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 1 = 0.673 +- 0.251 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 2 = 0.671 +- 0.251 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all KL = 0.717 +- 0.251 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all L1 = 0.681 +- 0.201 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.47550400000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.7416280000000001
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0 = 0.802 +- 0.198 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.728 +- 0.198 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.789 +- 0.198 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.853 +- 0.198 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.773 +- 0.192 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.876
Model XAI F1 of binarized graphs for r=0.3 =  0.666088
Model XAI WIoU of binarized graphs for r=0.3 =  0.9862000000000001
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.647
SUFF++ for r=0.3 class 0 = 0.475 +- 0.296 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 class 1 = 0.587 +- 0.296 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 class 2 = 0.5 +- 0.296 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 all KL = 0.498 +- 0.296 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 all L1 = 0.52 +- 0.154 (in-sample avg dev_std = 0.549)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.407296
Model XAI WIoU of binarized graphs for r=0.6 =  0.9862000000000001
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF++ for r=0.6 class 0 = 0.605 +- 0.186 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 1 = 0.601 +- 0.186 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 2 = 0.601 +- 0.186 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all KL = 0.717 +- 0.186 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all L1 = 0.602 +- 0.133 (in-sample avg dev_std = 0.366)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.294308
Model XAI WIoU of binarized graphs for r=0.9 =  0.986206
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.801
SUFF++ for r=0.9 class 0 = 0.732 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 class 1 = 0.728 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 class 2 = 0.772 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all KL = 0.878 +- 0.143 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.9 all L1 = 0.744 +- 0.155 (in-sample avg dev_std = 0.224)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  0.783556
Model XAI WIoU of binarized graphs for r=0.3 =  0.9069840000000001
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.668
SUFF++ for r=0.3 class 0 = 0.604 +- 0.329 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 1 = 0.688 +- 0.329 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 2 = 0.641 +- 0.329 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all KL = 0.583 +- 0.329 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all L1 = 0.645 +- 0.209 (in-sample avg dev_std = 0.553)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.916
Model XAI F1 of binarized graphs for r=0.6 =  0.566192
Model XAI WIoU of binarized graphs for r=0.6 =  0.955494
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.846
SUFF++ for r=0.6 class 0 = 0.793 +- 0.195 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.195 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 class 2 = 0.81 +- 0.195 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all KL = 0.798 +- 0.195 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all L1 = 0.764 +- 0.148 (in-sample avg dev_std = 0.374)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.953422
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.9
SUFF++ for r=0.9 class 0 = 0.909 +- 0.117 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 1 = 0.794 +- 0.117 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 2 = 0.877 +- 0.117 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all KL = 0.928 +- 0.117 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all L1 = 0.859 +- 0.154 (in-sample avg dev_std = 0.123)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.717266
Model XAI WIoU of binarized graphs for r=0.3 =  0.670974
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.574 +- 0.291 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 1 = 0.515 +- 0.291 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 2 = 0.58 +- 0.291 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all KL = 0.595 +- 0.291 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all L1 = 0.556 +- 0.169 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  0.6181
Model XAI WIoU of binarized graphs for r=0.6 =  0.7465579999999999
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.506
NEC for r=0.6 class 0 = 0.587 +- 0.321 (in-sample avg dev_std = 0.473)
NEC for r=0.6 class 1 = 0.418 +- 0.321 (in-sample avg dev_std = 0.473)
NEC for r=0.6 class 2 = 0.603 +- 0.321 (in-sample avg dev_std = 0.473)
NEC for r=0.6 all KL = 0.542 +- 0.321 (in-sample avg dev_std = 0.473)
NEC for r=0.6 all L1 = 0.536 +- 0.186 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.47550400000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.7416280000000001
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.507 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 1 = 0.377 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 2 = 0.516 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all KL = 0.456 +- 0.301 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all L1 = 0.467 +- 0.169 (in-sample avg dev_std = 0.512)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.904
Model XAI F1 of binarized graphs for r=1.0 =  0.446202
Model XAI WIoU of binarized graphs for r=1.0 =  0.7414980000000001
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.607
NEC for r=1.0 class 0 = 0.516 +- 0.306 (in-sample avg dev_std = 0.508)
NEC for r=1.0 class 1 = 0.379 +- 0.306 (in-sample avg dev_std = 0.508)
NEC for r=1.0 class 2 = 0.518 +- 0.306 (in-sample avg dev_std = 0.508)
NEC for r=1.0 all KL = 0.458 +- 0.306 (in-sample avg dev_std = 0.508)
NEC for r=1.0 all L1 = 0.471 +- 0.172 (in-sample avg dev_std = 0.508)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.876
Model XAI F1 of binarized graphs for r=0.3 =  0.666088
Model XAI WIoU of binarized graphs for r=0.3 =  0.9862000000000001
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.387
NEC for r=0.3 class 0 = 0.674 +- 0.278 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 1 = 0.512 +- 0.278 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 2 = 0.707 +- 0.278 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all KL = 0.648 +- 0.278 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all L1 = 0.632 +- 0.130 (in-sample avg dev_std = 0.422)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.407296
Model XAI WIoU of binarized graphs for r=0.6 =  0.9862000000000001
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.509
NEC for r=0.6 class 0 = 0.523 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.462 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.559 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.435 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.515 +- 0.112 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.294308
Model XAI WIoU of binarized graphs for r=0.9 =  0.986206
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.556
NEC for r=0.9 class 0 = 0.453 +- 0.200 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 1 = 0.425 +- 0.200 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 2 = 0.504 +- 0.200 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all KL = 0.344 +- 0.200 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all L1 = 0.461 +- 0.124 (in-sample avg dev_std = 0.426)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  0.27068400000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.986206
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.572
NEC for r=1.0 class 0 = 0.461 +- 0.192 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 1 = 0.435 +- 0.192 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 2 = 0.482 +- 0.192 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all KL = 0.339 +- 0.192 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all L1 = 0.46 +- 0.116 (in-sample avg dev_std = 0.426)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  0.783556
Model XAI WIoU of binarized graphs for r=0.3 =  0.9069840000000001
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.378
NEC for r=0.3 class 0 = 0.654 +- 0.295 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 1 = 0.485 +- 0.295 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 2 = 0.612 +- 0.295 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all KL = 0.653 +- 0.295 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all L1 = 0.582 +- 0.147 (in-sample avg dev_std = 0.485)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.916
Model XAI F1 of binarized graphs for r=0.6 =  0.566192
Model XAI WIoU of binarized graphs for r=0.6 =  0.955494
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.561
NEC for r=0.6 class 0 = 0.513 +- 0.347 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 1 = 0.353 +- 0.347 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 2 = 0.538 +- 0.347 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all KL = 0.496 +- 0.347 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all L1 = 0.467 +- 0.202 (in-sample avg dev_std = 0.497)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.953422
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0 = 0.392 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 1 = 0.284 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 2 = 0.43 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all KL = 0.386 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all L1 = 0.368 +- 0.187 (in-sample avg dev_std = 0.523)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  0.39236
Model XAI WIoU of binarized graphs for r=1.0 =  0.953422
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.683
NEC for r=1.0 class 0 = 0.398 +- 0.312 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 1 = 0.29 +- 0.312 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 2 = 0.414 +- 0.312 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all KL = 0.385 +- 0.312 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all L1 = 0.366 +- 0.187 (in-sample avg dev_std = 0.525)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:09:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:09:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3054) +- tensor(0.1599)
F1 for r=0.3 = 0.738
WIoU for r=0.3 = 0.712
F1 for r=0.6 = 0.619
WIoU for r=0.6 = 0.775
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.773
F1 for r=1.0 = 0.446
WIoU for r=1.0 = 0.773
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1583) +- tensor(0.0458)
F1 for r=0.3 = 0.667
WIoU for r=0.3 = 0.993
F1 for r=0.6 = 0.408
WIoU for r=0.6 = 0.993
F1 for r=0.9 = 0.294
WIoU for r=0.9 = 0.993
F1 for r=1.0 = 0.271
WIoU for r=1.0 = 0.993
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2519) +- tensor(0.0995)
F1 for r=0.3 = 0.728
WIoU for r=0.3 = 0.842
F1 for r=0.6 = 0.566
WIoU for r=0.6 = 0.844
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.793
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.786


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.662
Model XAI F1 of binarized graphs for r=0.3 =  0.7379739999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.712
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.529
SUFF++ for r=0.3 class 0 = 0.484 +- 0.260 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 class 1 = 0.656 +- 0.260 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 class 2 = 0.522 +- 0.260 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 all KL = 0.492 +- 0.260 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 all L1 = 0.554 +- 0.163 (in-sample avg dev_std = 0.526)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.894
Model XAI F1 of binarized graphs for r=0.6 =  0.618896
Model XAI WIoU of binarized graphs for r=0.6 =  0.775028
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.74
SUFF++ for r=0.6 class 0 = 0.641 +- 0.254 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 1 = 0.653 +- 0.254 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 2 = 0.669 +- 0.254 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all KL = 0.646 +- 0.254 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all L1 = 0.654 +- 0.186 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.475152
Model XAI WIoU of binarized graphs for r=0.9 =  0.77274
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.8 +- 0.191 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 1 = 0.819 +- 0.191 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 2 = 0.794 +- 0.191 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all KL = 0.863 +- 0.191 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.181 (in-sample avg dev_std = 0.271)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.892
Model XAI F1 of binarized graphs for r=0.3 =  0.666888
Model XAI WIoU of binarized graphs for r=0.3 =  0.9929100000000001
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0 = 0.429 +- 0.279 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 class 1 = 0.609 +- 0.279 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 class 2 = 0.479 +- 0.279 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 all KL = 0.458 +- 0.279 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.161 (in-sample avg dev_std = 0.576)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.40807
Model XAI WIoU of binarized graphs for r=0.6 =  0.993066
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.699
SUFF++ for r=0.6 class 0 = 0.583 +- 0.172 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1 = 0.618 +- 0.172 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 2 = 0.599 +- 0.172 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.714 +- 0.172 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.6 +- 0.110 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.892
Model XAI F1 of binarized graphs for r=0.9 =  0.294222
Model XAI WIoU of binarized graphs for r=0.9 =  0.993036
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.731
SUFF++ for r=0.9 class 0 = 0.711 +- 0.175 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 class 1 = 0.736 +- 0.175 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 class 2 = 0.57 +- 0.175 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 all KL = 0.817 +- 0.175 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 all L1 = 0.671 +- 0.160 (in-sample avg dev_std = 0.291)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.588
Model XAI F1 of binarized graphs for r=0.3 =  0.728356
Model XAI WIoU of binarized graphs for r=0.3 =  0.842218
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.615
SUFF++ for r=0.3 class 0 = 0.589 +- 0.230 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 1 = 0.595 +- 0.230 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 2 = 0.594 +- 0.230 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all KL = 0.631 +- 0.230 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all L1 = 0.593 +- 0.183 (in-sample avg dev_std = 0.481)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.566192
Model XAI WIoU of binarized graphs for r=0.6 =  0.843676
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.804
SUFF++ for r=0.6 class 0 = 0.68 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 1 = 0.631 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 2 = 0.715 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all KL = 0.683 +- 0.247 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all L1 = 0.675 +- 0.161 (in-sample avg dev_std = 0.463)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.792914
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.749
SUFF++ for r=0.9 class 0 = 0.645 +- 0.374 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.9 class 1 = 0.677 +- 0.374 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.374 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.9 all KL = 0.703 +- 0.374 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.9 all L1 = 0.734 +- 0.276 (in-sample avg dev_std = 0.485)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.664
Model XAI F1 of binarized graphs for r=0.3 =  0.7379739999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.712
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.375
NEC for r=0.3 class 0 = 0.57 +- 0.282 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 1 = 0.509 +- 0.282 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 2 = 0.592 +- 0.282 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all KL = 0.614 +- 0.282 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all L1 = 0.557 +- 0.151 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.894
Model XAI F1 of binarized graphs for r=0.6 =  0.618896
Model XAI WIoU of binarized graphs for r=0.6 =  0.775028
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.427
NEC for r=0.6 class 0 = 0.559 +- 0.312 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 1 = 0.527 +- 0.312 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 2 = 0.612 +- 0.312 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all KL = 0.601 +- 0.312 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all L1 = 0.566 +- 0.168 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.475152
Model XAI WIoU of binarized graphs for r=0.9 =  0.77274
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.532
NEC for r=0.9 class 0 = 0.515 +- 0.282 (in-sample avg dev_std = 0.509)
NEC for r=0.9 class 1 = 0.472 +- 0.282 (in-sample avg dev_std = 0.509)
NEC for r=0.9 class 2 = 0.552 +- 0.282 (in-sample avg dev_std = 0.509)
NEC for r=0.9 all KL = 0.514 +- 0.282 (in-sample avg dev_std = 0.509)
NEC for r=0.9 all L1 = 0.513 +- 0.157 (in-sample avg dev_std = 0.509)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.446202
Model XAI WIoU of binarized graphs for r=1.0 =  0.7729280000000001
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.552
NEC for r=1.0 class 0 = 0.501 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=1.0 class 1 = 0.45 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=1.0 class 2 = 0.546 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=1.0 all KL = 0.494 +- 0.280 (in-sample avg dev_std = 0.497)
NEC for r=1.0 all L1 = 0.499 +- 0.159 (in-sample avg dev_std = 0.497)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.892
Model XAI F1 of binarized graphs for r=0.3 =  0.666888
Model XAI WIoU of binarized graphs for r=0.3 =  0.9929100000000001
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.383
NEC for r=0.3 class 0 = 0.651 +- 0.278 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 1 = 0.513 +- 0.278 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 2 = 0.735 +- 0.278 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all KL = 0.669 +- 0.278 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all L1 = 0.634 +- 0.144 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.40807
Model XAI WIoU of binarized graphs for r=0.6 =  0.993066
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.486
NEC for r=0.6 class 0 = 0.54 +- 0.222 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 1 = 0.465 +- 0.222 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 2 = 0.57 +- 0.222 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all KL = 0.44 +- 0.222 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all L1 = 0.526 +- 0.123 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.892
Model XAI F1 of binarized graphs for r=0.9 =  0.294222
Model XAI WIoU of binarized graphs for r=0.9 =  0.993036
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.479 +- 0.191 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 1 = 0.425 +- 0.191 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 2 = 0.482 +- 0.191 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all KL = 0.339 +- 0.191 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all L1 = 0.463 +- 0.116 (in-sample avg dev_std = 0.443)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.892
Model XAI F1 of binarized graphs for r=1.0 =  0.27068400000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.99303
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.462 +- 0.189 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 1 = 0.417 +- 0.189 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 2 = 0.464 +- 0.189 (in-sample avg dev_std = 0.435)
NEC for r=1.0 all KL = 0.319 +- 0.189 (in-sample avg dev_std = 0.435)
NEC for r=1.0 all L1 = 0.448 +- 0.113 (in-sample avg dev_std = 0.435)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.584
Model XAI F1 of binarized graphs for r=0.3 =  0.728356
Model XAI WIoU of binarized graphs for r=0.3 =  0.842218
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.461
NEC for r=0.3 class 0 = 0.472 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 1 = 0.498 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 2 = 0.594 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all KL = 0.472 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all L1 = 0.522 +- 0.130 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.566192
Model XAI WIoU of binarized graphs for r=0.6 =  0.843676
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.538
NEC for r=0.6 class 0 = 0.426 +- 0.341 (in-sample avg dev_std = 0.522)
NEC for r=0.6 class 1 = 0.473 +- 0.341 (in-sample avg dev_std = 0.522)
NEC for r=0.6 class 2 = 0.532 +- 0.341 (in-sample avg dev_std = 0.522)
NEC for r=0.6 all KL = 0.47 +- 0.341 (in-sample avg dev_std = 0.522)
NEC for r=0.6 all L1 = 0.478 +- 0.203 (in-sample avg dev_std = 0.522)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.792914
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.604
NEC for r=0.9 class 0 = 0.407 +- 0.328 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 1 = 0.461 +- 0.328 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 2 = 0.437 +- 0.328 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all KL = 0.444 +- 0.328 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all L1 = 0.436 +- 0.191 (in-sample avg dev_std = 0.583)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.39236
Model XAI WIoU of binarized graphs for r=1.0 =  0.786202
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.409 +- 0.329 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.456 +- 0.329 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.441 +- 0.329 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.446 +- 0.329 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.436 +- 0.187 (in-sample avg dev_std = 0.576)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:12:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:12:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3054) +- tensor(0.1599)
F1 for r=0.3 = 0.684
WIoU for r=0.3 = 0.605
F1 for r=0.6 = 0.604
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.703
F1 for r=1.0 = 0.446
WIoU for r=1.0 = 0.703
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1583) +- tensor(0.0458)
F1 for r=0.3 = 0.668
WIoU for r=0.3 = 0.992
F1 for r=0.6 = 0.408
WIoU for r=0.6 = 0.992
F1 for r=0.9 = 0.294
WIoU for r=0.9 = 0.992
F1 for r=1.0 = 0.271
WIoU for r=1.0 = 0.992
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2519) +- tensor(0.0995)
F1 for r=0.3 = 0.784
WIoU for r=0.3 = 0.876
F1 for r=0.6 = 0.545
WIoU for r=0.6 = 0.744
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.687
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.684


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.508
Model XAI F1 of binarized graphs for r=0.3 =  0.6840899999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.605268
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.427
SUFF++ for r=0.3 class 0 = 0.505 +- 0.259 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 class 1 = 0.536 +- 0.259 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 class 2 = 0.465 +- 0.259 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 all KL = 0.451 +- 0.259 (in-sample avg dev_std = 0.545)
SUFF++ for r=0.3 all L1 = 0.502 +- 0.158 (in-sample avg dev_std = 0.545)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.872
Model XAI F1 of binarized graphs for r=0.6 =  0.6035499999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.69128
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.748
SUFF++ for r=0.6 class 0 = 0.65 +- 0.291 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1 = 0.686 +- 0.291 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 2 = 0.67 +- 0.291 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.638 +- 0.291 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.669 +- 0.213 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.475328
Model XAI WIoU of binarized graphs for r=0.9 =  0.7029719999999999
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0 = 0.808 +- 0.198 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 1 = 0.794 +- 0.198 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 2 = 0.817 +- 0.198 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all KL = 0.844 +- 0.198 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all L1 = 0.806 +- 0.173 (in-sample avg dev_std = 0.262)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.934
Model XAI F1 of binarized graphs for r=0.3 =  0.6676880000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.992298
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.604
SUFF++ for r=0.3 class 0 = 0.467 +- 0.293 (in-sample avg dev_std = 0.645)
SUFF++ for r=0.3 class 1 = 0.631 +- 0.293 (in-sample avg dev_std = 0.645)
SUFF++ for r=0.3 class 2 = 0.424 +- 0.293 (in-sample avg dev_std = 0.645)
SUFF++ for r=0.3 all KL = 0.377 +- 0.293 (in-sample avg dev_std = 0.645)
SUFF++ for r=0.3 all L1 = 0.506 +- 0.177 (in-sample avg dev_std = 0.645)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.934
Model XAI F1 of binarized graphs for r=0.6 =  0.408188
Model XAI WIoU of binarized graphs for r=0.6 =  0.992298
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF++ for r=0.6 class 0 = 0.59 +- 0.202 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 class 1 = 0.605 +- 0.202 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 class 2 = 0.648 +- 0.202 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all KL = 0.665 +- 0.202 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all L1 = 0.615 +- 0.138 (in-sample avg dev_std = 0.464)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.936
Model XAI F1 of binarized graphs for r=0.9 =  0.294308
Model XAI WIoU of binarized graphs for r=0.9 =  0.992298
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.754 +- 0.177 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 1 = 0.761 +- 0.177 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 2 = 0.808 +- 0.177 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all KL = 0.872 +- 0.177 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all L1 = 0.774 +- 0.149 (in-sample avg dev_std = 0.284)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.783936
Model XAI WIoU of binarized graphs for r=0.3 =  0.8760300000000002
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.596
SUFF++ for r=0.3 class 0 = 0.589 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 class 1 = 0.646 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 all KL = 0.565 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.171 (in-sample avg dev_std = 0.539)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  0.545192
Model XAI WIoU of binarized graphs for r=0.6 =  0.743518
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.752
SUFF++ for r=0.6 class 0 = 0.602 +- 0.340 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.340 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.6 class 2 = 0.658 +- 0.340 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.6 all KL = 0.599 +- 0.340 (in-sample avg dev_std = 0.567)
SUFF++ for r=0.6 all L1 = 0.651 +- 0.197 (in-sample avg dev_std = 0.567)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.658
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.68695
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0 = 0.652 +- 0.318 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 class 1 = 0.695 +- 0.318 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 class 2 = 0.916 +- 0.318 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 all KL = 0.737 +- 0.318 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 all L1 = 0.755 +- 0.295 (in-sample avg dev_std = 0.309)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.508
Model XAI F1 of binarized graphs for r=0.3 =  0.6840899999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.605268
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.574 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.3 class 1 = 0.545 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.3 class 2 = 0.573 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.3 all KL = 0.6 +- 0.288 (in-sample avg dev_std = 0.459)
NEC for r=0.3 all L1 = 0.564 +- 0.168 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.872
Model XAI F1 of binarized graphs for r=0.6 =  0.6035499999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.69128
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.449
NEC for r=0.6 class 0 = 0.576 +- 0.286 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 1 = 0.519 +- 0.286 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 2 = 0.634 +- 0.286 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all KL = 0.636 +- 0.286 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all L1 = 0.576 +- 0.167 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.475328
Model XAI WIoU of binarized graphs for r=0.9 =  0.7029719999999999
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.525 +- 0.299 (in-sample avg dev_std = 0.578)
NEC for r=0.9 class 1 = 0.464 +- 0.299 (in-sample avg dev_std = 0.578)
NEC for r=0.9 class 2 = 0.556 +- 0.299 (in-sample avg dev_std = 0.578)
NEC for r=0.9 all KL = 0.555 +- 0.299 (in-sample avg dev_std = 0.578)
NEC for r=0.9 all L1 = 0.515 +- 0.169 (in-sample avg dev_std = 0.578)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.446202
Model XAI WIoU of binarized graphs for r=1.0 =  0.7030239999999999
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.566
NEC for r=1.0 class 0 = 0.514 +- 0.294 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 1 = 0.454 +- 0.294 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 2 = 0.541 +- 0.294 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all KL = 0.538 +- 0.294 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all L1 = 0.503 +- 0.166 (in-sample avg dev_std = 0.578)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.934
Model XAI F1 of binarized graphs for r=0.3 =  0.6676880000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.992298
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.394
NEC for r=0.3 class 0 = 0.657 +- 0.227 (in-sample avg dev_std = 0.504)
NEC for r=0.3 class 1 = 0.571 +- 0.227 (in-sample avg dev_std = 0.504)
NEC for r=0.3 class 2 = 0.763 +- 0.227 (in-sample avg dev_std = 0.504)
NEC for r=0.3 all KL = 0.77 +- 0.227 (in-sample avg dev_std = 0.504)
NEC for r=0.3 all L1 = 0.665 +- 0.130 (in-sample avg dev_std = 0.504)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.934
Model XAI F1 of binarized graphs for r=0.6 =  0.408188
Model XAI WIoU of binarized graphs for r=0.6 =  0.992298
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.514
NEC for r=0.6 class 0 = 0.539 +- 0.243 (in-sample avg dev_std = 0.568)
NEC for r=0.6 class 1 = 0.472 +- 0.243 (in-sample avg dev_std = 0.568)
NEC for r=0.6 class 2 = 0.621 +- 0.243 (in-sample avg dev_std = 0.568)
NEC for r=0.6 all KL = 0.527 +- 0.243 (in-sample avg dev_std = 0.568)
NEC for r=0.6 all L1 = 0.545 +- 0.135 (in-sample avg dev_std = 0.568)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.936
Model XAI F1 of binarized graphs for r=0.9 =  0.294308
Model XAI WIoU of binarized graphs for r=0.9 =  0.992298
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.58
NEC for r=0.9 class 0 = 0.457 +- 0.207 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 1 = 0.46 +- 0.207 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 2 = 0.505 +- 0.207 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all KL = 0.393 +- 0.207 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all L1 = 0.474 +- 0.119 (in-sample avg dev_std = 0.517)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.936
Model XAI F1 of binarized graphs for r=1.0 =  0.27068400000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.992298
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.47 +- 0.209 (in-sample avg dev_std = 0.514)
NEC for r=1.0 class 1 = 0.464 +- 0.209 (in-sample avg dev_std = 0.514)
NEC for r=1.0 class 2 = 0.497 +- 0.209 (in-sample avg dev_std = 0.514)
NEC for r=1.0 all KL = 0.398 +- 0.209 (in-sample avg dev_std = 0.514)
NEC for r=1.0 all L1 = 0.477 +- 0.121 (in-sample avg dev_std = 0.514)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.783936
Model XAI WIoU of binarized graphs for r=0.3 =  0.8760300000000002
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.55 +- 0.270 (in-sample avg dev_std = 0.548)
NEC for r=0.3 class 1 = 0.439 +- 0.270 (in-sample avg dev_std = 0.548)
NEC for r=0.3 class 2 = 0.621 +- 0.270 (in-sample avg dev_std = 0.548)
NEC for r=0.3 all KL = 0.579 +- 0.270 (in-sample avg dev_std = 0.548)
NEC for r=0.3 all L1 = 0.536 +- 0.134 (in-sample avg dev_std = 0.548)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.89
Model XAI F1 of binarized graphs for r=0.6 =  0.545192
Model XAI WIoU of binarized graphs for r=0.6 =  0.743518
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.587
NEC for r=0.6 class 0 = 0.392 +- 0.360 (in-sample avg dev_std = 0.593)
NEC for r=0.6 class 1 = 0.485 +- 0.360 (in-sample avg dev_std = 0.593)
NEC for r=0.6 class 2 = 0.524 +- 0.360 (in-sample avg dev_std = 0.593)
NEC for r=0.6 all KL = 0.518 +- 0.360 (in-sample avg dev_std = 0.593)
NEC for r=0.6 all L1 = 0.468 +- 0.233 (in-sample avg dev_std = 0.593)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.68695
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.422 +- 0.318 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 1 = 0.423 +- 0.318 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 2 = 0.339 +- 0.318 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all KL = 0.442 +- 0.318 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all L1 = 0.395 +- 0.209 (in-sample avg dev_std = 0.528)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.706
Model XAI F1 of binarized graphs for r=1.0 =  0.39236
Model XAI WIoU of binarized graphs for r=1.0 =  0.6842120000000002
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.65
NEC for r=1.0 class 0 = 0.395 +- 0.302 (in-sample avg dev_std = 0.523)
NEC for r=1.0 class 1 = 0.434 +- 0.302 (in-sample avg dev_std = 0.523)
NEC for r=1.0 class 2 = 0.318 +- 0.302 (in-sample avg dev_std = 0.523)
NEC for r=1.0 all KL = 0.424 +- 0.302 (in-sample avg dev_std = 0.523)
NEC for r=1.0 all L1 = 0.383 +- 0.211 (in-sample avg dev_std = 0.523)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:14:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:14:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3054) +- tensor(0.1599)
F1 for r=0.3 = 0.747
WIoU for r=0.3 = 0.850
F1 for r=0.6 = 0.608
WIoU for r=0.6 = 0.905
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.908
F1 for r=1.0 = 0.446
WIoU for r=1.0 = 0.908
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1583) +- tensor(0.0458)
F1 for r=0.3 = 0.668
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.408
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.294
WIoU for r=0.9 = 0.995
F1 for r=1.0 = 0.271
WIoU for r=1.0 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2519) +- tensor(0.0995)
F1 for r=0.3 = 0.753
WIoU for r=0.3 = 0.834
F1 for r=0.6 = 0.556
WIoU for r=0.6 = 0.832
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.832
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.832


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.68
Model XAI F1 of binarized graphs for r=0.3 =  0.746992
Model XAI WIoU of binarized graphs for r=0.3 =  0.85
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.531
SUFF++ for r=0.3 class 0 = 0.542 +- 0.297 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 1 = 0.668 +- 0.297 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 class 2 = 0.513 +- 0.297 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 all KL = 0.581 +- 0.297 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.3 all L1 = 0.575 +- 0.158 (in-sample avg dev_std = 0.478)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.607642
Model XAI WIoU of binarized graphs for r=0.6 =  0.904936
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.761
SUFF++ for r=0.6 class 0 = 0.622 +- 0.188 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 1 = 0.759 +- 0.188 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 2 = 0.783 +- 0.188 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all KL = 0.809 +- 0.188 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all L1 = 0.721 +- 0.176 (in-sample avg dev_std = 0.311)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.47456
Model XAI WIoU of binarized graphs for r=0.9 =  0.9077000000000001
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.864
SUFF++ for r=0.9 class 0 = 0.832 +- 0.098 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 1 = 0.857 +- 0.098 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 2 = 0.891 +- 0.098 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all KL = 0.939 +- 0.098 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.129 (in-sample avg dev_std = 0.174)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.9
Model XAI F1 of binarized graphs for r=0.3 =  0.667792
Model XAI WIoU of binarized graphs for r=0.3 =  0.995242
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.649
SUFF++ for r=0.3 class 0 = 0.552 +- 0.287 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 class 1 = 0.7 +- 0.287 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 class 2 = 0.66 +- 0.287 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 all KL = 0.67 +- 0.287 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.3 all L1 = 0.637 +- 0.191 (in-sample avg dev_std = 0.416)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.408188
Model XAI WIoU of binarized graphs for r=0.6 =  0.995242
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.756
SUFF++ for r=0.6 class 0 = 0.697 +- 0.142 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 class 1 = 0.724 +- 0.142 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.142 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 all KL = 0.851 +- 0.142 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 all L1 = 0.719 +- 0.121 (in-sample avg dev_std = 0.281)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  0.294308
Model XAI WIoU of binarized graphs for r=0.9 =  0.995242
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0 = 0.744 +- 0.109 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.778 +- 0.109 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.853 +- 0.109 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.914 +- 0.109 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.792 +- 0.118 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.76
Model XAI F1 of binarized graphs for r=0.3 =  0.753108
Model XAI WIoU of binarized graphs for r=0.3 =  0.83364
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.553
SUFF++ for r=0.3 class 0 = 0.512 +- 0.307 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 1 = 0.649 +- 0.307 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 2 = 0.594 +- 0.307 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all KL = 0.595 +- 0.307 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all L1 = 0.586 +- 0.173 (in-sample avg dev_std = 0.479)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.902
Model XAI F1 of binarized graphs for r=0.6 =  0.555692
Model XAI WIoU of binarized graphs for r=0.6 =  0.8317239999999999
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0 = 0.564 +- 0.211 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 1 = 0.78 +- 0.211 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 2 = 0.801 +- 0.211 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all KL = 0.779 +- 0.211 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all L1 = 0.717 +- 0.186 (in-sample avg dev_std = 0.370)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.8317239999999999
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.812
SUFF++ for r=0.9 class 0 = 0.769 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1 = 0.861 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 2 = 0.933 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.927 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.855 +- 0.149 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.682
Model XAI F1 of binarized graphs for r=0.3 =  0.746992
Model XAI WIoU of binarized graphs for r=0.3 =  0.85
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.452 +- 0.343 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1 = 0.466 +- 0.343 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 2 = 0.59 +- 0.343 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.482 +- 0.343 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.502 +- 0.178 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.607642
Model XAI WIoU of binarized graphs for r=0.6 =  0.904936
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.48
NEC for r=0.6 class 0 = 0.404 +- 0.308 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1 = 0.441 +- 0.308 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 2 = 0.589 +- 0.308 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.428 +- 0.308 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.477 +- 0.178 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.47456
Model XAI WIoU of binarized graphs for r=0.9 =  0.9077000000000001
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.537
NEC for r=0.9 class 0 = 0.372 +- 0.294 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 1 = 0.375 +- 0.294 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 2 = 0.52 +- 0.294 (in-sample avg dev_std = 0.463)
NEC for r=0.9 all KL = 0.35 +- 0.294 (in-sample avg dev_std = 0.463)
NEC for r=0.9 all L1 = 0.422 +- 0.171 (in-sample avg dev_std = 0.463)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.904
Model XAI F1 of binarized graphs for r=1.0 =  0.446202
Model XAI WIoU of binarized graphs for r=1.0 =  0.9077000000000001
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.56
NEC for r=1.0 class 0 = 0.371 +- 0.293 (in-sample avg dev_std = 0.465)
NEC for r=1.0 class 1 = 0.354 +- 0.293 (in-sample avg dev_std = 0.465)
NEC for r=1.0 class 2 = 0.511 +- 0.293 (in-sample avg dev_std = 0.465)
NEC for r=1.0 all KL = 0.339 +- 0.293 (in-sample avg dev_std = 0.465)
NEC for r=1.0 all L1 = 0.411 +- 0.171 (in-sample avg dev_std = 0.465)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.898
Model XAI F1 of binarized graphs for r=0.3 =  0.667792
Model XAI WIoU of binarized graphs for r=0.3 =  0.995242
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.385
NEC for r=0.3 class 0 = 0.437 +- 0.333 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 1 = 0.49 +- 0.333 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 2 = 0.731 +- 0.333 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all KL = 0.535 +- 0.333 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all L1 = 0.554 +- 0.187 (in-sample avg dev_std = 0.397)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.408188
Model XAI WIoU of binarized graphs for r=0.6 =  0.995242
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.518
NEC for r=0.6 class 0 = 0.359 +- 0.267 (in-sample avg dev_std = 0.427)
NEC for r=0.6 class 1 = 0.371 +- 0.267 (in-sample avg dev_std = 0.427)
NEC for r=0.6 class 2 = 0.579 +- 0.267 (in-sample avg dev_std = 0.427)
NEC for r=0.6 all KL = 0.335 +- 0.267 (in-sample avg dev_std = 0.427)
NEC for r=0.6 all L1 = 0.437 +- 0.169 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  0.294308
Model XAI WIoU of binarized graphs for r=0.9 =  0.995242
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.321 +- 0.198 (in-sample avg dev_std = 0.391)
NEC for r=0.9 class 1 = 0.314 +- 0.198 (in-sample avg dev_std = 0.391)
NEC for r=0.9 class 2 = 0.468 +- 0.198 (in-sample avg dev_std = 0.391)
NEC for r=0.9 all KL = 0.231 +- 0.198 (in-sample avg dev_std = 0.391)
NEC for r=0.9 all L1 = 0.369 +- 0.144 (in-sample avg dev_std = 0.391)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.872
Model XAI F1 of binarized graphs for r=1.0 =  0.27068400000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.995242
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.613
NEC for r=1.0 class 0 = 0.331 +- 0.177 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 1 = 0.314 +- 0.177 (in-sample avg dev_std = 0.388)
NEC for r=1.0 class 2 = 0.431 +- 0.177 (in-sample avg dev_std = 0.388)
NEC for r=1.0 all KL = 0.217 +- 0.177 (in-sample avg dev_std = 0.388)
NEC for r=1.0 all L1 = 0.359 +- 0.128 (in-sample avg dev_std = 0.388)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.76
Model XAI F1 of binarized graphs for r=0.3 =  0.753108
Model XAI WIoU of binarized graphs for r=0.3 =  0.83364
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.485 +- 0.324 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.467 +- 0.324 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.592 +- 0.324 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.516 +- 0.324 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.515 +- 0.154 (in-sample avg dev_std = 0.421)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.902
Model XAI F1 of binarized graphs for r=0.6 =  0.555692
Model XAI WIoU of binarized graphs for r=0.6 =  0.8317239999999999
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.529
NEC for r=0.6 class 0 = 0.345 +- 0.343 (in-sample avg dev_std = 0.461)
NEC for r=0.6 class 1 = 0.414 +- 0.343 (in-sample avg dev_std = 0.461)
NEC for r=0.6 class 2 = 0.523 +- 0.343 (in-sample avg dev_std = 0.461)
NEC for r=0.6 all KL = 0.396 +- 0.343 (in-sample avg dev_std = 0.461)
NEC for r=0.6 all L1 = 0.428 +- 0.206 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.8317239999999999
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.357 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.9 class 1 = 0.367 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.9 class 2 = 0.451 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.9 all KL = 0.355 +- 0.298 (in-sample avg dev_std = 0.506)
NEC for r=0.9 all L1 = 0.391 +- 0.178 (in-sample avg dev_std = 0.506)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.39236
Model XAI WIoU of binarized graphs for r=1.0 =  0.8317239999999999
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.368 +- 0.296 (in-sample avg dev_std = 0.508)
NEC for r=1.0 class 1 = 0.36 +- 0.296 (in-sample avg dev_std = 0.508)
NEC for r=1.0 class 2 = 0.459 +- 0.296 (in-sample avg dev_std = 0.508)
NEC for r=1.0 all KL = 0.362 +- 0.296 (in-sample avg dev_std = 0.508)
NEC for r=1.0 all L1 = 0.396 +- 0.177 (in-sample avg dev_std = 0.508)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:16:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:16:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3054) +- tensor(0.1599)
F1 for r=0.3 = 0.708
WIoU for r=0.3 = 0.663
F1 for r=0.6 = 0.606
WIoU for r=0.6 = 0.725
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.719
F1 for r=1.0 = 0.446
WIoU for r=1.0 = 0.718
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1583) +- tensor(0.0458)
F1 for r=0.3 = 0.663
WIoU for r=0.3 = 0.932
F1 for r=0.6 = 0.407
WIoU for r=0.6 = 0.929
F1 for r=0.9 = 0.294
WIoU for r=0.9 = 0.929
F1 for r=1.0 = 0.271
WIoU for r=1.0 = 0.929
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2519) +- tensor(0.0995)
F1 for r=0.3 = 0.769
WIoU for r=0.3 = 0.894
F1 for r=0.6 = 0.545
WIoU for r=0.6 = 0.843
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.822
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.822


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  0.7079139999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6630219999999999
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.549
SUFF++ for r=0.3 class 0 = 0.461 +- 0.287 (in-sample avg dev_std = 0.620)
SUFF++ for r=0.3 class 1 = 0.516 +- 0.287 (in-sample avg dev_std = 0.620)
SUFF++ for r=0.3 class 2 = 0.472 +- 0.287 (in-sample avg dev_std = 0.620)
SUFF++ for r=0.3 all KL = 0.343 +- 0.287 (in-sample avg dev_std = 0.620)
SUFF++ for r=0.3 all L1 = 0.483 +- 0.182 (in-sample avg dev_std = 0.620)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.6064060000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.725404
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.775
SUFF++ for r=0.6 class 0 = 0.585 +- 0.305 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 1 = 0.712 +- 0.305 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 2 = 0.733 +- 0.305 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all KL = 0.629 +- 0.305 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all L1 = 0.676 +- 0.224 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.475184
Model XAI WIoU of binarized graphs for r=0.9 =  0.7185519999999999
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.851
SUFF++ for r=0.9 class 0 = 0.738 +- 0.235 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 1 = 0.805 +- 0.235 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.235 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all KL = 0.836 +- 0.235 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all L1 = 0.8 +- 0.201 (in-sample avg dev_std = 0.279)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.866
Model XAI F1 of binarized graphs for r=0.3 =  0.6625160000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.93164
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.639
SUFF++ for r=0.3 class 0 = 0.492 +- 0.313 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 1 = 0.634 +- 0.313 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 2 = 0.568 +- 0.313 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all KL = 0.474 +- 0.313 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all L1 = 0.564 +- 0.189 (in-sample avg dev_std = 0.586)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.902
Model XAI F1 of binarized graphs for r=0.6 =  0.40721
Model XAI WIoU of binarized graphs for r=0.6 =  0.928548
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.695
SUFF++ for r=0.6 class 0 = 0.605 +- 0.238 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 class 1 = 0.636 +- 0.238 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 class 2 = 0.646 +- 0.238 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all KL = 0.691 +- 0.238 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all L1 = 0.629 +- 0.166 (in-sample avg dev_std = 0.411)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.29421600000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.928548
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.752
SUFF++ for r=0.9 class 0 = 0.727 +- 0.200 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 1 = 0.713 +- 0.200 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 2 = 0.825 +- 0.200 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all KL = 0.848 +- 0.200 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all L1 = 0.756 +- 0.171 (in-sample avg dev_std = 0.303)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.876
Model XAI F1 of binarized graphs for r=0.3 =  0.7690119999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.894002
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.709
SUFF++ for r=0.3 class 0 = 0.545 +- 0.304 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 1 = 0.641 +- 0.304 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 2 = 0.529 +- 0.304 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all KL = 0.543 +- 0.304 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all L1 = 0.573 +- 0.206 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.545192
Model XAI WIoU of binarized graphs for r=0.6 =  0.8426959999999999
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF++ for r=0.6 class 0 = 0.571 +- 0.298 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 1 = 0.758 +- 0.298 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 2 = 0.69 +- 0.298 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all KL = 0.664 +- 0.298 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all L1 = 0.675 +- 0.189 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.8215119999999999
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.885
SUFF++ for r=0.9 class 0 = 0.824 +- 0.127 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 1 = 0.935 +- 0.127 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 class 2 = 0.914 +- 0.127 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all KL = 0.938 +- 0.127 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.147 (in-sample avg dev_std = 0.234)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  0.7079139999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6630219999999999
len(reference) = 500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.401
NEC for r=0.3 class 0 = 0.616 +- 0.293 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 1 = 0.543 +- 0.293 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 2 = 0.662 +- 0.293 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all KL = 0.721 +- 0.293 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all L1 = 0.607 +- 0.158 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.838
Model XAI F1 of binarized graphs for r=0.6 =  0.6064060000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.725404
len(reference) = 500
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.493
NEC for r=0.6 class 0 = 0.509 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 class 1 = 0.475 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 class 2 = 0.618 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 all KL = 0.618 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 all L1 = 0.534 +- 0.178 (in-sample avg dev_std = 0.553)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.475184
Model XAI WIoU of binarized graphs for r=0.9 =  0.7185519999999999
len(reference) = 500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.584
NEC for r=0.9 class 0 = 0.463 +- 0.302 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.431 +- 0.302 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.541 +- 0.302 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.526 +- 0.302 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.478 +- 0.160 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.446202
Model XAI WIoU of binarized graphs for r=1.0 =  0.718366
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.469 +- 0.311 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 1 = 0.429 +- 0.311 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 2 = 0.543 +- 0.311 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all KL = 0.53 +- 0.311 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all L1 = 0.48 +- 0.164 (in-sample avg dev_std = 0.569)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.866
Model XAI F1 of binarized graphs for r=0.3 =  0.6625160000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.93164
len(reference) = 500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.415
NEC for r=0.3 class 0 = 0.563 +- 0.308 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.531 +- 0.308 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.724 +- 0.308 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.672 +- 0.308 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.607 +- 0.154 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.902
Model XAI F1 of binarized graphs for r=0.6 =  0.40721
Model XAI WIoU of binarized graphs for r=0.6 =  0.928548
len(reference) = 500
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.568
NEC for r=0.6 class 0 = 0.437 +- 0.289 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 1 = 0.409 +- 0.289 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 2 = 0.556 +- 0.289 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all KL = 0.436 +- 0.289 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all L1 = 0.468 +- 0.148 (in-sample avg dev_std = 0.512)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.29421600000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.928548
len(reference) = 500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.39 +- 0.261 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.389 +- 0.261 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.497 +- 0.261 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.365 +- 0.261 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.426 +- 0.141 (in-sample avg dev_std = 0.496)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.904
Model XAI F1 of binarized graphs for r=1.0 =  0.27068400000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.928548
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.623
NEC for r=1.0 class 0 = 0.405 +- 0.245 (in-sample avg dev_std = 0.506)
NEC for r=1.0 class 1 = 0.396 +- 0.245 (in-sample avg dev_std = 0.506)
NEC for r=1.0 class 2 = 0.462 +- 0.245 (in-sample avg dev_std = 0.506)
NEC for r=1.0 all KL = 0.36 +- 0.245 (in-sample avg dev_std = 0.506)
NEC for r=1.0 all L1 = 0.421 +- 0.123 (in-sample avg dev_std = 0.506)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.876
Model XAI F1 of binarized graphs for r=0.3 =  0.7690119999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.894002
len(reference) = 500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.412
NEC for r=0.3 class 0 = 0.594 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 class 1 = 0.536 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 class 2 = 0.63 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 all KL = 0.629 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 all L1 = 0.586 +- 0.136 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.545192
Model XAI WIoU of binarized graphs for r=0.6 =  0.8426959999999999
len(reference) = 500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.594
NEC for r=0.6 class 0 = 0.429 +- 0.332 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 1 = 0.425 +- 0.332 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 2 = 0.537 +- 0.332 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all KL = 0.491 +- 0.332 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all L1 = 0.463 +- 0.189 (in-sample avg dev_std = 0.549)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.4243680000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.8215119999999999
len(reference) = 500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.647
NEC for r=0.9 class 0 = 0.385 +- 0.323 (in-sample avg dev_std = 0.563)
NEC for r=0.9 class 1 = 0.374 +- 0.323 (in-sample avg dev_std = 0.563)
NEC for r=0.9 class 2 = 0.477 +- 0.323 (in-sample avg dev_std = 0.563)
NEC for r=0.9 all KL = 0.455 +- 0.323 (in-sample avg dev_std = 0.563)
NEC for r=0.9 all L1 = 0.412 +- 0.184 (in-sample avg dev_std = 0.563)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.88
Model XAI F1 of binarized graphs for r=1.0 =  0.39236
Model XAI WIoU of binarized graphs for r=1.0 =  0.8215119999999999
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.645
NEC for r=1.0 class 0 = 0.383 +- 0.325 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 1 = 0.374 +- 0.325 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 2 = 0.46 +- 0.325 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all KL = 0.455 +- 0.325 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all L1 = 0.406 +- 0.183 (in-sample avg dev_std = 0.578)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.502, 0.717, 0.853, 1.0], 'all_L1': [0.543, 0.681, 0.773, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.492, 0.646, 0.863, 1.0], 'all_L1': [0.554, 0.654, 0.804, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.451, 0.638, 0.844, 1.0], 'all_L1': [0.502, 0.669, 0.806, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.809, 0.939, 1.0], 'all_L1': [0.575, 0.721, 0.86, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.629, 0.836, 1.0], 'all_L1': [0.483, 0.676, 0.8, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.595, 0.542, 0.456, 0.458], 'all_L1': [0.556, 0.536, 0.467, 0.471]}), defaultdict(<class 'list'>, {'all_KL': [0.614, 0.601, 0.514, 0.494], 'all_L1': [0.557, 0.566, 0.513, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.636, 0.555, 0.538], 'all_L1': [0.564, 0.576, 0.515, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.428, 0.35, 0.339], 'all_L1': [0.502, 0.477, 0.422, 0.411]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.618, 0.526, 0.53], 'all_L1': [0.607, 0.534, 0.478, 0.48]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.498, 0.717, 0.878, 1.0], 'all_L1': [0.52, 0.602, 0.744, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.714, 0.817, 1.0], 'all_L1': [0.505, 0.6, 0.671, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.665, 0.872, 1.0], 'all_L1': [0.506, 0.615, 0.774, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.851, 0.914, 1.0], 'all_L1': [0.637, 0.719, 0.792, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.691, 0.848, 1.0], 'all_L1': [0.564, 0.629, 0.756, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.648, 0.435, 0.344, 0.339], 'all_L1': [0.632, 0.515, 0.461, 0.46]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.44, 0.339, 0.319], 'all_L1': [0.634, 0.526, 0.463, 0.448]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.527, 0.393, 0.398], 'all_L1': [0.665, 0.545, 0.474, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.535, 0.335, 0.231, 0.217], 'all_L1': [0.554, 0.437, 0.369, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.672, 0.436, 0.365, 0.36], 'all_L1': [0.607, 0.468, 0.426, 0.421]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.583, 0.798, 0.928, 1.0], 'all_L1': [0.645, 0.764, 0.859, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.683, 0.703, 1.0], 'all_L1': [0.593, 0.675, 0.734, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.599, 0.737, 1.0], 'all_L1': [0.603, 0.651, 0.755, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.595, 0.779, 0.927, 1.0], 'all_L1': [0.586, 0.717, 0.855, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.664, 0.938, 1.0], 'all_L1': [0.573, 0.675, 0.892, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.653, 0.496, 0.386, 0.385], 'all_L1': [0.582, 0.467, 0.368, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.47, 0.444, 0.446], 'all_L1': [0.522, 0.478, 0.436, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.518, 0.442, 0.424], 'all_L1': [0.536, 0.468, 0.395, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.396, 0.355, 0.362], 'all_L1': [0.515, 0.428, 0.391, 0.396]}), defaultdict(<class 'list'>, {'all_KL': [0.629, 0.491, 0.455, 0.455], 'all_L1': [0.586, 0.463, 0.412, 0.406]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.531 +- 0.034, 0.680 +- 0.022, 0.809 +- 0.028, 1.000 +- 0.000
suff++ class all_KL  =  0.474 +- 0.078, 0.688 +- 0.068, 0.867 +- 0.037, 1.000 +- 0.000
suff++_acc_int  =  0.512 +- 0.044, 0.759 +- 0.013, 0.854 +- 0.008
nec class all_L1  =  0.557 +- 0.033, 0.538 +- 0.035, 0.479 +- 0.034, 0.473 +- 0.033
nec class all_KL  =  0.602 +- 0.076, 0.565 +- 0.075, 0.480 +- 0.073, 0.472 +- 0.072
nec_acc_int  =  0.369 +- 0.021, 0.471 +- 0.029, 0.561 +- 0.028, 0.572 +- 0.019

Eval split val
suff++ class all_L1  =  0.546 +- 0.050, 0.633 +- 0.044, 0.747 +- 0.042, 1.000 +- 0.000
suff++ class all_KL  =  0.495 +- 0.096, 0.728 +- 0.064, 0.866 +- 0.032, 1.000 +- 0.000
suff++_acc_int  =  0.625 +- 0.025, 0.720 +- 0.022, 0.786 +- 0.042
nec class all_L1  =  0.618 +- 0.037, 0.498 +- 0.040, 0.439 +- 0.038, 0.433 +- 0.041
nec class all_KL  =  0.659 +- 0.075, 0.435 +- 0.061, 0.334 +- 0.055, 0.327 +- 0.061
nec_acc_int  =  0.393 +- 0.012, 0.519 +- 0.027, 0.573 +- 0.019, 0.589 +- 0.024

Eval split test
suff++ class all_L1  =  0.600 +- 0.025, 0.696 +- 0.040, 0.819 +- 0.063, 1.000 +- 0.000
suff++ class all_KL  =  0.583 +- 0.030, 0.705 +- 0.074, 0.847 +- 0.104, 1.000 +- 0.000
suff++_acc_int  =  0.628 +- 0.054, 0.782 +- 0.041, 0.837 +- 0.054
nec class all_L1  =  0.548 +- 0.030, 0.461 +- 0.017, 0.400 +- 0.023, 0.397 +- 0.023
nec class all_KL  =  0.570 +- 0.068, 0.474 +- 0.042, 0.416 +- 0.039, 0.414 +- 0.036
nec_acc_int  =  0.398 +- 0.040, 0.562 +- 0.026, 0.635 +- 0.025, 0.639 +- 0.028


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.544 +- 0.008, 0.609 +- 0.008, 0.644 +- 0.015, 0.736 +- 0.017
Faith. Armon (L1)= 		  =  0.542 +- 0.009, 0.599 +- 0.015, 0.600 +- 0.024, 0.641 +- 0.031
Faith. GMean (L1)= 	  =  0.543 +- 0.008, 0.604 +- 0.011, 0.622 +- 0.019, 0.687 +- 0.025
Faith. Aritm (KL)= 		  =  0.538 +- 0.011, 0.626 +- 0.006, 0.674 +- 0.021, 0.736 +- 0.036
Faith. Armon (KL)= 		  =  0.520 +- 0.030, 0.612 +- 0.027, 0.613 +- 0.057, 0.638 +- 0.070
Faith. GMean (KL)= 	  =  0.529 +- 0.019, 0.619 +- 0.016, 0.642 +- 0.040, 0.685 +- 0.055

Eval split val
Faith. Aritm (L1)= 		  =  0.582 +- 0.009, 0.566 +- 0.012, 0.593 +- 0.019, 0.717 +- 0.021
Faith. Armon (L1)= 		  =  0.577 +- 0.011, 0.555 +- 0.014, 0.551 +- 0.028, 0.603 +- 0.041
Faith. GMean (L1)= 	  =  0.580 +- 0.010, 0.560 +- 0.012, 0.571 +- 0.023, 0.657 +- 0.032
Faith. Aritm (KL)= 		  =  0.577 +- 0.013, 0.581 +- 0.012, 0.600 +- 0.022, 0.663 +- 0.030
Faith. Armon (KL)= 		  =  0.553 +- 0.029, 0.538 +- 0.034, 0.479 +- 0.059, 0.489 +- 0.072
Faith. GMean (KL)= 	  =  0.565 +- 0.020, 0.559 +- 0.019, 0.535 +- 0.042, 0.569 +- 0.056

Eval split test
Faith. Aritm (L1)= 		  =  0.574 +- 0.022, 0.579 +- 0.019, 0.610 +- 0.028, 0.699 +- 0.012
Faith. Armon (L1)= 		  =  0.572 +- 0.022, 0.554 +- 0.015, 0.536 +- 0.018, 0.568 +- 0.024
Faith. GMean (L1)= 	  =  0.573 +- 0.022, 0.566 +- 0.017, 0.572 +- 0.020, 0.630 +- 0.019
Faith. Aritm (KL)= 		  =  0.577 +- 0.024, 0.589 +- 0.030, 0.632 +- 0.045, 0.707 +- 0.018
Faith. Armon (KL)= 		  =  0.573 +- 0.026, 0.563 +- 0.028, 0.554 +- 0.032, 0.585 +- 0.036
Faith. GMean (KL)= 	  =  0.575 +- 0.025, 0.576 +- 0.027, 0.591 +- 0.034, 0.643 +- 0.028
Computed for split load_split = id



Completed in  0:12:00.782388  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:19:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:19:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.714
WIoU for r=0.3 = 0.664
F1 for r=0.6 = 0.624
WIoU for r=0.6 = 0.746
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.741
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.741
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.668
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.409
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.989
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.989
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.782
WIoU for r=0.3 = 0.908
F1 for r=0.6 = 0.565
WIoU for r=0.6 = 0.958
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.956
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.956


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.529
Model XAI F1 of binarized graphs for r=0.3 =  0.71368375
Model XAI WIoU of binarized graphs for r=0.3 =  0.6644225
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.525
SUFF++ for r=0.3 class 0 = 0.572 +- 0.297 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 class 1 = 0.54 +- 0.297 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 class 2 = 0.533 +- 0.297 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 all KL = 0.502 +- 0.297 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 all L1 = 0.548 +- 0.201 (in-sample avg dev_std = 0.521)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.6244812500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.74646
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.776
SUFF++ for r=0.6 class 0 = 0.705 +- 0.243 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 1 = 0.663 +- 0.243 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 2 = 0.695 +- 0.243 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all KL = 0.724 +- 0.243 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all L1 = 0.687 +- 0.202 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.4814387499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.7407374999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.834
SUFF++ for r=0.9 class 0 = 0.797 +- 0.202 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 1 = 0.718 +- 0.202 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 2 = 0.803 +- 0.202 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all KL = 0.85 +- 0.202 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all L1 = 0.773 +- 0.197 (in-sample avg dev_std = 0.264)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  0.668295
Model XAI WIoU of binarized graphs for r=0.3 =  0.9887725
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.648
SUFF++ for r=0.3 class 0 = 0.473 +- 0.293 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 1 = 0.586 +- 0.293 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 2 = 0.499 +- 0.293 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all KL = 0.496 +- 0.293 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all L1 = 0.519 +- 0.151 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.40889125
Model XAI WIoU of binarized graphs for r=0.6 =  0.9887725
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.726
SUFF++ for r=0.6 class 0 = 0.617 +- 0.186 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 1 = 0.598 +- 0.186 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 2 = 0.599 +- 0.186 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all KL = 0.718 +- 0.186 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all L1 = 0.605 +- 0.131 (in-sample avg dev_std = 0.370)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.29531124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.9887762500000001
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0 = 0.745 +- 0.144 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 1 = 0.72 +- 0.144 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 2 = 0.777 +- 0.144 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all KL = 0.88 +- 0.144 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all L1 = 0.748 +- 0.155 (in-sample avg dev_std = 0.223)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.699
Model XAI F1 of binarized graphs for r=0.3 =  0.7824275
Model XAI WIoU of binarized graphs for r=0.3 =  0.90822125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.651
SUFF++ for r=0.3 class 0 = 0.622 +- 0.328 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 1 = 0.679 +- 0.328 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 class 2 = 0.642 +- 0.328 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all KL = 0.587 +- 0.328 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.3 all L1 = 0.649 +- 0.213 (in-sample avg dev_std = 0.554)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.899
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.95768625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.831
SUFF++ for r=0.6 class 0 = 0.785 +- 0.192 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 1 = 0.698 +- 0.192 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 2 = 0.823 +- 0.192 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 all KL = 0.804 +- 0.192 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 all L1 = 0.768 +- 0.147 (in-sample avg dev_std = 0.365)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.95569125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0 = 0.908 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 class 1 = 0.804 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 class 2 = 0.875 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 all KL = 0.929 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 all L1 = 0.862 +- 0.156 (in-sample avg dev_std = 0.120)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.529
Model XAI F1 of binarized graphs for r=0.3 =  0.71368375
Model XAI WIoU of binarized graphs for r=0.3 =  0.6644225
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.561 +- 0.295 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 1 = 0.506 +- 0.295 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 2 = 0.581 +- 0.295 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all KL = 0.586 +- 0.295 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all L1 = 0.549 +- 0.174 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.6244812500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.74646
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.502
NEC for r=0.6 class 0 = 0.581 +- 0.318 (in-sample avg dev_std = 0.472)
NEC for r=0.6 class 1 = 0.425 +- 0.318 (in-sample avg dev_std = 0.472)
NEC for r=0.6 class 2 = 0.601 +- 0.318 (in-sample avg dev_std = 0.472)
NEC for r=0.6 all KL = 0.544 +- 0.318 (in-sample avg dev_std = 0.472)
NEC for r=0.6 all L1 = 0.535 +- 0.183 (in-sample avg dev_std = 0.472)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.4814387499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.7407374999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.515 +- 0.304 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 1 = 0.389 +- 0.304 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 2 = 0.511 +- 0.304 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all KL = 0.465 +- 0.304 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all L1 = 0.471 +- 0.173 (in-sample avg dev_std = 0.514)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.9
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7406275
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.603
NEC for r=1.0 class 0 = 0.51 +- 0.296 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 1 = 0.396 +- 0.296 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 2 = 0.512 +- 0.296 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all KL = 0.463 +- 0.296 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all L1 = 0.472 +- 0.161 (in-sample avg dev_std = 0.516)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  0.668295
Model XAI WIoU of binarized graphs for r=0.3 =  0.9887725
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.669 +- 0.282 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 1 = 0.507 +- 0.282 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 2 = 0.711 +- 0.282 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all KL = 0.645 +- 0.282 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all L1 = 0.63 +- 0.132 (in-sample avg dev_std = 0.423)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  0.40889125
Model XAI WIoU of binarized graphs for r=0.6 =  0.9887725
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.527 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.472 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.568 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.446 +- 0.219 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.523 +- 0.114 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.29531124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.9887762500000001
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.55
NEC for r=0.9 class 0 = 0.465 +- 0.192 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.427 +- 0.192 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.494 +- 0.192 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.345 +- 0.192 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.462 +- 0.115 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.9887762500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.569
NEC for r=1.0 class 0 = 0.448 +- 0.195 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 1 = 0.425 +- 0.195 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 2 = 0.485 +- 0.195 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all KL = 0.334 +- 0.195 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all L1 = 0.453 +- 0.118 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.699
Model XAI F1 of binarized graphs for r=0.3 =  0.7824275
Model XAI WIoU of binarized graphs for r=0.3 =  0.90822125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.661 +- 0.298 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 1 = 0.477 +- 0.298 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 2 = 0.623 +- 0.298 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all KL = 0.657 +- 0.298 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all L1 = 0.585 +- 0.151 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.899
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.95768625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.556
NEC for r=0.6 class 0 = 0.507 +- 0.351 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 1 = 0.343 +- 0.351 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 2 = 0.54 +- 0.351 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all KL = 0.498 +- 0.351 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all L1 = 0.462 +- 0.204 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.95569125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.65
NEC for r=0.9 class 0 = 0.421 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 1 = 0.286 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 2 = 0.439 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all KL = 0.405 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all L1 = 0.381 +- 0.190 (in-sample avg dev_std = 0.531)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.95569125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.678
NEC for r=1.0 class 0 = 0.395 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 class 1 = 0.284 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 class 2 = 0.432 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 all KL = 0.393 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 all L1 = 0.369 +- 0.190 (in-sample avg dev_std = 0.527)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:23:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:23:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.736
WIoU for r=0.3 = 0.706
F1 for r=0.6 = 0.625
WIoU for r=0.6 = 0.774
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.771
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.771
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.669
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.409
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.994
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.726
WIoU for r=0.3 = 0.842
F1 for r=0.6 = 0.565
WIoU for r=0.6 = 0.846
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.795
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.788


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.65
Model XAI F1 of binarized graphs for r=0.3 =  0.7359749999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.705805
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.513
SUFF++ for r=0.3 class 0 = 0.492 +- 0.262 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 class 1 = 0.641 +- 0.262 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 class 2 = 0.505 +- 0.262 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 all KL = 0.488 +- 0.262 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.3 all L1 = 0.547 +- 0.158 (in-sample avg dev_std = 0.527)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.6250312499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7738725
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.73
SUFF++ for r=0.6 class 0 = 0.645 +- 0.252 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.655 +- 0.252 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.666 +- 0.252 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.644 +- 0.252 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.655 +- 0.190 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.48110875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7711312499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0 = 0.789 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 1 = 0.795 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 2 = 0.798 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all KL = 0.849 +- 0.204 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all L1 = 0.794 +- 0.190 (in-sample avg dev_std = 0.282)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.894
Model XAI F1 of binarized graphs for r=0.3 =  0.6689275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99412375
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.589
SUFF++ for r=0.3 class 0 = 0.428 +- 0.283 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 1 = 0.61 +- 0.283 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 2 = 0.469 +- 0.283 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all KL = 0.448 +- 0.283 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.156 (in-sample avg dev_std = 0.582)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.892
Model XAI F1 of binarized graphs for r=0.6 =  0.40945499999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.99422125
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.707
SUFF++ for r=0.6 class 0 = 0.572 +- 0.165 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.6 class 1 = 0.617 +- 0.165 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.6 class 2 = 0.62 +- 0.165 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.6 all KL = 0.718 +- 0.165 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.6 all L1 = 0.603 +- 0.109 (in-sample avg dev_std = 0.399)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.295315
Model XAI WIoU of binarized graphs for r=0.9 =  0.9942025000000001
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.736
SUFF++ for r=0.9 class 0 = 0.715 +- 0.171 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 1 = 0.738 +- 0.171 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 2 = 0.582 +- 0.171 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all KL = 0.82 +- 0.171 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all L1 = 0.678 +- 0.159 (in-sample avg dev_std = 0.293)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.553
Model XAI F1 of binarized graphs for r=0.3 =  0.7263150000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8424875000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.598 +- 0.234 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 class 1 = 0.606 +- 0.234 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 class 2 = 0.593 +- 0.234 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 all KL = 0.627 +- 0.234 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 all L1 = 0.599 +- 0.178 (in-sample avg dev_std = 0.495)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8456575000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.784
SUFF++ for r=0.6 class 0 = 0.671 +- 0.251 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.639 +- 0.251 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.717 +- 0.251 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.678 +- 0.251 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.675 +- 0.165 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7951375000000002
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0 = 0.645 +- 0.373 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 class 1 = 0.689 +- 0.373 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 class 2 = 0.891 +- 0.373 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 all KL = 0.717 +- 0.373 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 all L1 = 0.742 +- 0.280 (in-sample avg dev_std = 0.465)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.7359749999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.705805
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.555 +- 0.286 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 1 = 0.511 +- 0.286 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 2 = 0.586 +- 0.286 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all KL = 0.607 +- 0.286 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all L1 = 0.551 +- 0.155 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.6250312499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7738725
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.426
NEC for r=0.6 class 0 = 0.564 +- 0.307 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 1 = 0.529 +- 0.307 (in-sample avg dev_std = 0.454)
NEC for r=0.6 class 2 = 0.619 +- 0.307 (in-sample avg dev_std = 0.454)
NEC for r=0.6 all KL = 0.613 +- 0.307 (in-sample avg dev_std = 0.454)
NEC for r=0.6 all L1 = 0.57 +- 0.162 (in-sample avg dev_std = 0.454)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.48110875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7711312499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.506 +- 0.282 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 1 = 0.475 +- 0.282 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 2 = 0.56 +- 0.282 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all KL = 0.519 +- 0.282 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all L1 = 0.514 +- 0.158 (in-sample avg dev_std = 0.505)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.77129875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.525
NEC for r=1.0 class 0 = 0.51 +- 0.279 (in-sample avg dev_std = 0.499)
NEC for r=1.0 class 1 = 0.482 +- 0.279 (in-sample avg dev_std = 0.499)
NEC for r=1.0 class 2 = 0.543 +- 0.279 (in-sample avg dev_std = 0.499)
NEC for r=1.0 all KL = 0.515 +- 0.279 (in-sample avg dev_std = 0.499)
NEC for r=1.0 all L1 = 0.511 +- 0.158 (in-sample avg dev_std = 0.499)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.894
Model XAI F1 of binarized graphs for r=0.3 =  0.6689275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.99412375
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.37
NEC for r=0.3 class 0 = 0.659 +- 0.276 (in-sample avg dev_std = 0.440)
NEC for r=0.3 class 1 = 0.523 +- 0.276 (in-sample avg dev_std = 0.440)
NEC for r=0.3 class 2 = 0.734 +- 0.276 (in-sample avg dev_std = 0.440)
NEC for r=0.3 all KL = 0.681 +- 0.276 (in-sample avg dev_std = 0.440)
NEC for r=0.3 all L1 = 0.64 +- 0.142 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.892
Model XAI F1 of binarized graphs for r=0.6 =  0.40945499999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.99422125
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.497
NEC for r=0.6 class 0 = 0.542 +- 0.217 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.462 +- 0.217 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.567 +- 0.217 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.44 +- 0.217 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.525 +- 0.119 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.295315
Model XAI WIoU of binarized graphs for r=0.9 =  0.9942025000000001
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0 = 0.473 +- 0.187 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 1 = 0.443 +- 0.187 (in-sample avg dev_std = 0.438)
NEC for r=0.9 class 2 = 0.471 +- 0.187 (in-sample avg dev_std = 0.438)
NEC for r=0.9 all KL = 0.34 +- 0.187 (in-sample avg dev_std = 0.438)
NEC for r=0.9 all L1 = 0.463 +- 0.112 (in-sample avg dev_std = 0.438)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.9941987499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.47 +- 0.192 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 1 = 0.423 +- 0.192 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 2 = 0.478 +- 0.192 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all KL = 0.334 +- 0.192 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all L1 = 0.457 +- 0.115 (in-sample avg dev_std = 0.441)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  0.7263150000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8424875000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.44
NEC for r=0.3 class 0 = 0.493 +- 0.220 (in-sample avg dev_std = 0.477)
NEC for r=0.3 class 1 = 0.505 +- 0.220 (in-sample avg dev_std = 0.477)
NEC for r=0.3 class 2 = 0.58 +- 0.220 (in-sample avg dev_std = 0.477)
NEC for r=0.3 all KL = 0.483 +- 0.220 (in-sample avg dev_std = 0.477)
NEC for r=0.3 all L1 = 0.526 +- 0.127 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8456575000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.522
NEC for r=0.6 class 0 = 0.434 +- 0.340 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 1 = 0.471 +- 0.340 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 2 = 0.526 +- 0.340 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all KL = 0.475 +- 0.340 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all L1 = 0.477 +- 0.199 (in-sample avg dev_std = 0.527)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7951375000000002
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.414 +- 0.331 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.443 +- 0.331 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.444 +- 0.331 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.446 +- 0.331 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.434 +- 0.194 (in-sample avg dev_std = 0.576)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7882975000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.603
NEC for r=1.0 class 0 = 0.419 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.435 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.44 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.444 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.431 +- 0.186 (in-sample avg dev_std = 0.576)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:27:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:27:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.678
WIoU for r=0.3 = 0.597
F1 for r=0.6 = 0.610
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.703
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.703
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.669
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.410
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.994
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.782
WIoU for r=0.3 = 0.880
F1 for r=0.6 = 0.544
WIoU for r=0.6 = 0.750
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.694
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.691


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.6778687499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5967024999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.42
SUFF++ for r=0.3 class 0 = 0.505 +- 0.253 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 1 = 0.526 +- 0.253 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 2 = 0.458 +- 0.253 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all KL = 0.441 +- 0.253 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all L1 = 0.497 +- 0.155 (in-sample avg dev_std = 0.553)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.6101525
Model XAI WIoU of binarized graphs for r=0.6 =  0.6905475
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.754
SUFF++ for r=0.6 class 0 = 0.641 +- 0.286 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 1 = 0.676 +- 0.286 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 2 = 0.701 +- 0.286 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all KL = 0.642 +- 0.286 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all L1 = 0.673 +- 0.212 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.48117374999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.70282375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0 = 0.801 +- 0.196 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.797 +- 0.196 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.824 +- 0.196 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.846 +- 0.196 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.807 +- 0.176 (in-sample avg dev_std = 0.256)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.6694275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9939325
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.608
SUFF++ for r=0.3 class 0 = 0.474 +- 0.288 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.3 class 1 = 0.621 +- 0.288 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.3 class 2 = 0.429 +- 0.288 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.3 all KL = 0.371 +- 0.288 (in-sample avg dev_std = 0.659)
SUFF++ for r=0.3 all L1 = 0.507 +- 0.174 (in-sample avg dev_std = 0.659)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.40952875000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.9939325
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0 = 0.587 +- 0.203 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.597 +- 0.203 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.663 +- 0.203 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.664 +- 0.203 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.616 +- 0.140 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.29536875
Model XAI WIoU of binarized graphs for r=0.9 =  0.9939325
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.842
SUFF++ for r=0.9 class 0 = 0.745 +- 0.183 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 1 = 0.761 +- 0.183 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.183 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all KL = 0.867 +- 0.183 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all L1 = 0.772 +- 0.150 (in-sample avg dev_std = 0.296)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.782
Model XAI WIoU of binarized graphs for r=0.3 =  0.8802100000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0 = 0.607 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 1 = 0.657 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 2 = 0.558 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all KL = 0.563 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all L1 = 0.608 +- 0.180 (in-sample avg dev_std = 0.543)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7503025
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.734
SUFF++ for r=0.6 class 0 = 0.599 +- 0.345 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 class 1 = 0.702 +- 0.345 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 class 2 = 0.633 +- 0.345 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 all KL = 0.589 +- 0.345 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 all L1 = 0.646 +- 0.203 (in-sample avg dev_std = 0.577)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.668
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6935862500000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.659 +- 0.312 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 1 = 0.738 +- 0.312 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 2 = 0.911 +- 0.312 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all KL = 0.746 +- 0.312 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.288 (in-sample avg dev_std = 0.304)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.6778687499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5967024999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.585 +- 0.284 (in-sample avg dev_std = 0.457)
NEC for r=0.3 class 1 = 0.541 +- 0.284 (in-sample avg dev_std = 0.457)
NEC for r=0.3 class 2 = 0.575 +- 0.284 (in-sample avg dev_std = 0.457)
NEC for r=0.3 all KL = 0.604 +- 0.284 (in-sample avg dev_std = 0.457)
NEC for r=0.3 all L1 = 0.567 +- 0.166 (in-sample avg dev_std = 0.457)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.6101525
Model XAI WIoU of binarized graphs for r=0.6 =  0.6905475
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.447
NEC for r=0.6 class 0 = 0.577 +- 0.282 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 1 = 0.521 +- 0.282 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 2 = 0.63 +- 0.282 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all KL = 0.639 +- 0.282 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all L1 = 0.576 +- 0.164 (in-sample avg dev_std = 0.545)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.48117374999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.70282375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.527
NEC for r=0.9 class 0 = 0.54 +- 0.293 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 1 = 0.474 +- 0.293 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 2 = 0.567 +- 0.293 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all KL = 0.569 +- 0.293 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all L1 = 0.527 +- 0.167 (in-sample avg dev_std = 0.577)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7028725
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.552
NEC for r=1.0 class 0 = 0.527 +- 0.285 (in-sample avg dev_std = 0.577)
NEC for r=1.0 class 1 = 0.469 +- 0.285 (in-sample avg dev_std = 0.577)
NEC for r=1.0 class 2 = 0.553 +- 0.285 (in-sample avg dev_std = 0.577)
NEC for r=1.0 all KL = 0.555 +- 0.285 (in-sample avg dev_std = 0.577)
NEC for r=1.0 all L1 = 0.516 +- 0.163 (in-sample avg dev_std = 0.577)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.6694275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9939325
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.674 +- 0.215 (in-sample avg dev_std = 0.492)
NEC for r=0.3 class 1 = 0.575 +- 0.215 (in-sample avg dev_std = 0.492)
NEC for r=0.3 class 2 = 0.771 +- 0.215 (in-sample avg dev_std = 0.492)
NEC for r=0.3 all KL = 0.784 +- 0.215 (in-sample avg dev_std = 0.492)
NEC for r=0.3 all L1 = 0.674 +- 0.123 (in-sample avg dev_std = 0.492)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.40952875000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.9939325
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.526
NEC for r=0.6 class 0 = 0.534 +- 0.247 (in-sample avg dev_std = 0.557)
NEC for r=0.6 class 1 = 0.46 +- 0.247 (in-sample avg dev_std = 0.557)
NEC for r=0.6 class 2 = 0.623 +- 0.247 (in-sample avg dev_std = 0.557)
NEC for r=0.6 all KL = 0.521 +- 0.247 (in-sample avg dev_std = 0.557)
NEC for r=0.6 all L1 = 0.54 +- 0.140 (in-sample avg dev_std = 0.557)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.29536875
Model XAI WIoU of binarized graphs for r=0.9 =  0.9939325
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.58
NEC for r=0.9 class 0 = 0.473 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 class 1 = 0.451 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 class 2 = 0.503 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 all KL = 0.397 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 all L1 = 0.476 +- 0.119 (in-sample avg dev_std = 0.519)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.9939325
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.585
NEC for r=1.0 class 0 = 0.469 +- 0.204 (in-sample avg dev_std = 0.518)
NEC for r=1.0 class 1 = 0.47 +- 0.204 (in-sample avg dev_std = 0.518)
NEC for r=1.0 class 2 = 0.482 +- 0.204 (in-sample avg dev_std = 0.518)
NEC for r=1.0 all KL = 0.397 +- 0.204 (in-sample avg dev_std = 0.518)
NEC for r=1.0 all L1 = 0.474 +- 0.121 (in-sample avg dev_std = 0.518)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.782
Model XAI WIoU of binarized graphs for r=0.3 =  0.8802100000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.547 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 1 = 0.444 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 2 = 0.608 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all KL = 0.587 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all L1 = 0.533 +- 0.134 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7503025
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.571
NEC for r=0.6 class 0 = 0.423 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 1 = 0.477 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 2 = 0.542 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all KL = 0.53 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all L1 = 0.482 +- 0.229 (in-sample avg dev_std = 0.595)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6935862500000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.634
NEC for r=0.9 class 0 = 0.41 +- 0.309 (in-sample avg dev_std = 0.540)
NEC for r=0.9 class 1 = 0.407 +- 0.309 (in-sample avg dev_std = 0.540)
NEC for r=0.9 class 2 = 0.35 +- 0.309 (in-sample avg dev_std = 0.540)
NEC for r=0.9 all KL = 0.441 +- 0.309 (in-sample avg dev_std = 0.540)
NEC for r=0.9 all L1 = 0.389 +- 0.195 (in-sample avg dev_std = 0.540)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.71
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.69095
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.638
NEC for r=1.0 class 0 = 0.403 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 1 = 0.427 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 2 = 0.326 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all KL = 0.441 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all L1 = 0.386 +- 0.199 (in-sample avg dev_std = 0.536)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:31:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:31:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.750
WIoU for r=0.3 = 0.849
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.907
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.910
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.910
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.669
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.410
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.995
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.752
WIoU for r=0.3 = 0.847
F1 for r=0.6 = 0.555
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.845
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.845


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  0.7502987499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.8490125000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.522
SUFF++ for r=0.3 class 0 = 0.534 +- 0.300 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1 = 0.666 +- 0.300 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 2 = 0.52 +- 0.300 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.58 +- 0.300 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.574 +- 0.165 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.61597625
Model XAI WIoU of binarized graphs for r=0.6 =  0.90689125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.76
SUFF++ for r=0.6 class 0 = 0.63 +- 0.195 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 class 1 = 0.748 +- 0.195 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 class 2 = 0.779 +- 0.195 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 all KL = 0.804 +- 0.195 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.6 all L1 = 0.719 +- 0.176 (in-sample avg dev_std = 0.314)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.48057625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.90993125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0 = 0.83 +- 0.098 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.098 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 class 2 = 0.898 +- 0.098 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 all KL = 0.938 +- 0.098 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 all L1 = 0.859 +- 0.130 (in-sample avg dev_std = 0.173)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.904
Model XAI F1 of binarized graphs for r=0.3 =  0.6692275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9953387499999999
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.646
SUFF++ for r=0.3 class 0 = 0.542 +- 0.293 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 class 1 = 0.702 +- 0.293 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 class 2 = 0.648 +- 0.293 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 all KL = 0.657 +- 0.293 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 all L1 = 0.63 +- 0.190 (in-sample avg dev_std = 0.431)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.40952875000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.9953387499999999
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0 = 0.68 +- 0.141 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.6 class 1 = 0.722 +- 0.141 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.6 class 2 = 0.738 +- 0.141 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.6 all KL = 0.846 +- 0.141 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.6 all L1 = 0.713 +- 0.124 (in-sample avg dev_std = 0.283)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.868
Model XAI F1 of binarized graphs for r=0.9 =  0.29536875
Model XAI WIoU of binarized graphs for r=0.9 =  0.9953387499999999
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0 = 0.739 +- 0.110 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 class 1 = 0.779 +- 0.110 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 class 2 = 0.847 +- 0.110 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all KL = 0.913 +- 0.110 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all L1 = 0.788 +- 0.120 (in-sample avg dev_std = 0.238)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.744
Model XAI F1 of binarized graphs for r=0.3 =  0.7515675000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8466300000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.542
SUFF++ for r=0.3 class 0 = 0.519 +- 0.311 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 1 = 0.666 +- 0.311 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 2 = 0.59 +- 0.311 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all KL = 0.592 +- 0.311 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all L1 = 0.593 +- 0.174 (in-sample avg dev_std = 0.487)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5545187500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.84512
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF++ for r=0.6 class 0 = 0.579 +- 0.215 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 1 = 0.775 +- 0.215 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 2 = 0.797 +- 0.215 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all KL = 0.777 +- 0.215 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all L1 = 0.719 +- 0.182 (in-sample avg dev_std = 0.373)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.84512
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.811
SUFF++ for r=0.9 class 0 = 0.771 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1 = 0.862 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 2 = 0.935 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.928 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.148 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  0.7502987499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.8490125000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.452 +- 0.346 (in-sample avg dev_std = 0.380)
NEC for r=0.3 class 1 = 0.473 +- 0.346 (in-sample avg dev_std = 0.380)
NEC for r=0.3 class 2 = 0.59 +- 0.346 (in-sample avg dev_std = 0.380)
NEC for r=0.3 all KL = 0.488 +- 0.346 (in-sample avg dev_std = 0.380)
NEC for r=0.3 all L1 = 0.505 +- 0.179 (in-sample avg dev_std = 0.380)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.61597625
Model XAI WIoU of binarized graphs for r=0.6 =  0.90689125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.462
NEC for r=0.6 class 0 = 0.411 +- 0.308 (in-sample avg dev_std = 0.450)
NEC for r=0.6 class 1 = 0.443 +- 0.308 (in-sample avg dev_std = 0.450)
NEC for r=0.6 class 2 = 0.588 +- 0.308 (in-sample avg dev_std = 0.450)
NEC for r=0.6 all KL = 0.436 +- 0.308 (in-sample avg dev_std = 0.450)
NEC for r=0.6 all L1 = 0.48 +- 0.176 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.48057625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.90993125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0 = 0.362 +- 0.293 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 1 = 0.383 +- 0.293 (in-sample avg dev_std = 0.461)
NEC for r=0.9 class 2 = 0.524 +- 0.293 (in-sample avg dev_std = 0.461)
NEC for r=0.9 all KL = 0.352 +- 0.293 (in-sample avg dev_std = 0.461)
NEC for r=0.9 all L1 = 0.423 +- 0.168 (in-sample avg dev_std = 0.461)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.90993125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.556
NEC for r=1.0 class 0 = 0.372 +- 0.295 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 1 = 0.371 +- 0.295 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 2 = 0.511 +- 0.295 (in-sample avg dev_std = 0.462)
NEC for r=1.0 all KL = 0.347 +- 0.295 (in-sample avg dev_std = 0.462)
NEC for r=1.0 all L1 = 0.417 +- 0.171 (in-sample avg dev_std = 0.462)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.6692275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9953387499999999
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.406
NEC for r=0.3 class 0 = 0.44 +- 0.332 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.481 +- 0.332 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.722 +- 0.332 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.534 +- 0.332 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.548 +- 0.189 (in-sample avg dev_std = 0.403)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.40952875000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.9953387499999999
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.521
NEC for r=0.6 class 0 = 0.374 +- 0.261 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 1 = 0.369 +- 0.261 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 2 = 0.573 +- 0.261 (in-sample avg dev_std = 0.436)
NEC for r=0.6 all KL = 0.337 +- 0.261 (in-sample avg dev_std = 0.436)
NEC for r=0.6 all L1 = 0.44 +- 0.160 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.868
Model XAI F1 of binarized graphs for r=0.9 =  0.29536875
Model XAI WIoU of binarized graphs for r=0.9 =  0.9953387499999999
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.329 +- 0.201 (in-sample avg dev_std = 0.381)
NEC for r=0.9 class 1 = 0.312 +- 0.201 (in-sample avg dev_std = 0.381)
NEC for r=0.9 class 2 = 0.461 +- 0.201 (in-sample avg dev_std = 0.381)
NEC for r=0.9 all KL = 0.229 +- 0.201 (in-sample avg dev_std = 0.381)
NEC for r=0.9 all L1 = 0.368 +- 0.147 (in-sample avg dev_std = 0.381)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.868
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.9953387499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.595
NEC for r=1.0 class 0 = 0.335 +- 0.190 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 1 = 0.311 +- 0.190 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 2 = 0.45 +- 0.190 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all KL = 0.225 +- 0.190 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all L1 = 0.366 +- 0.137 (in-sample avg dev_std = 0.387)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.744
Model XAI F1 of binarized graphs for r=0.3 =  0.7515675000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8466300000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.483 +- 0.321 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 1 = 0.479 +- 0.321 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 2 = 0.585 +- 0.321 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all KL = 0.525 +- 0.321 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all L1 = 0.516 +- 0.152 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5545187500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.84512
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.533
NEC for r=0.6 class 0 = 0.355 +- 0.344 (in-sample avg dev_std = 0.461)
NEC for r=0.6 class 1 = 0.408 +- 0.344 (in-sample avg dev_std = 0.461)
NEC for r=0.6 class 2 = 0.534 +- 0.344 (in-sample avg dev_std = 0.461)
NEC for r=0.6 all KL = 0.404 +- 0.344 (in-sample avg dev_std = 0.461)
NEC for r=0.6 all L1 = 0.433 +- 0.203 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.84512
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.602
NEC for r=0.9 class 0 = 0.355 +- 0.306 (in-sample avg dev_std = 0.509)
NEC for r=0.9 class 1 = 0.349 +- 0.306 (in-sample avg dev_std = 0.509)
NEC for r=0.9 class 2 = 0.46 +- 0.306 (in-sample avg dev_std = 0.509)
NEC for r=0.9 all KL = 0.36 +- 0.306 (in-sample avg dev_std = 0.509)
NEC for r=0.9 all L1 = 0.388 +- 0.182 (in-sample avg dev_std = 0.509)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.84512
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.598
NEC for r=1.0 class 0 = 0.369 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 1 = 0.355 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 2 = 0.458 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all KL = 0.366 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all L1 = 0.394 +- 0.182 (in-sample avg dev_std = 0.511)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:34:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:34:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.711
WIoU for r=0.3 = 0.661
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.726
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.719
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.719
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1589) +- tensor(0.0458)
F1 for r=0.3 = 0.664
WIoU for r=0.3 = 0.929
F1 for r=0.6 = 0.409
WIoU for r=0.6 = 0.926
F1 for r=0.9 = 0.295
WIoU for r=0.9 = 0.926
F1 for r=1.0 = 0.272
WIoU for r=1.0 = 0.926
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.769
WIoU for r=0.3 = 0.900
F1 for r=0.6 = 0.544
WIoU for r=0.6 = 0.849
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.827
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.827


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  0.7105624999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6608125000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.541
SUFF++ for r=0.3 class 0 = 0.449 +- 0.293 (in-sample avg dev_std = 0.613)
SUFF++ for r=0.3 class 1 = 0.526 +- 0.293 (in-sample avg dev_std = 0.613)
SUFF++ for r=0.3 class 2 = 0.473 +- 0.293 (in-sample avg dev_std = 0.613)
SUFF++ for r=0.3 all KL = 0.341 +- 0.293 (in-sample avg dev_std = 0.613)
SUFF++ for r=0.3 all L1 = 0.483 +- 0.188 (in-sample avg dev_std = 0.613)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.837
Model XAI F1 of binarized graphs for r=0.6 =  0.61280625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7261012499999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.777
SUFF++ for r=0.6 class 0 = 0.61 +- 0.307 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.307 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.734 +- 0.307 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.634 +- 0.307 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.684 +- 0.221 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.48108249999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.71949875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0 = 0.742 +- 0.245 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 1 = 0.81 +- 0.245 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.245 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all KL = 0.832 +- 0.245 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all L1 = 0.803 +- 0.203 (in-sample avg dev_std = 0.276)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.873
Model XAI F1 of binarized graphs for r=0.3 =  0.66378375
Model XAI WIoU of binarized graphs for r=0.3 =  0.9293250000000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.656
SUFF++ for r=0.3 class 0 = 0.524 +- 0.314 (in-sample avg dev_std = 0.583)
SUFF++ for r=0.3 class 1 = 0.626 +- 0.314 (in-sample avg dev_std = 0.583)
SUFF++ for r=0.3 class 2 = 0.581 +- 0.314 (in-sample avg dev_std = 0.583)
SUFF++ for r=0.3 all KL = 0.489 +- 0.314 (in-sample avg dev_std = 0.583)
SUFF++ for r=0.3 all L1 = 0.576 +- 0.188 (in-sample avg dev_std = 0.583)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.9
Model XAI F1 of binarized graphs for r=0.6 =  0.40876375
Model XAI WIoU of binarized graphs for r=0.6 =  0.92616625
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.694
SUFF++ for r=0.6 class 0 = 0.608 +- 0.233 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1 = 0.627 +- 0.233 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 2 = 0.655 +- 0.233 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.696 +- 0.233 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.63 +- 0.165 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.29531125
Model XAI WIoU of binarized graphs for r=0.9 =  0.92616625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.754
SUFF++ for r=0.9 class 0 = 0.714 +- 0.193 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 1 = 0.701 +- 0.193 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 2 = 0.821 +- 0.193 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 all KL = 0.843 +- 0.193 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 all L1 = 0.746 +- 0.172 (in-sample avg dev_std = 0.299)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.863
Model XAI F1 of binarized graphs for r=0.3 =  0.7685775000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8999287499999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.697
SUFF++ for r=0.3 class 0 = 0.557 +- 0.315 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 1 = 0.661 +- 0.315 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 2 = 0.527 +- 0.315 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all KL = 0.55 +- 0.315 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all L1 = 0.583 +- 0.218 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8493262500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.77
SUFF++ for r=0.6 class 0 = 0.582 +- 0.305 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 class 1 = 0.756 +- 0.305 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 class 2 = 0.697 +- 0.305 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 all KL = 0.661 +- 0.305 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 all L1 = 0.68 +- 0.184 (in-sample avg dev_std = 0.498)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.865
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.827495
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0 = 0.822 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.936 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.924 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.94 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.895 +- 0.147 (in-sample avg dev_std = 0.229)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  0.7105624999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6608125000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.387
NEC for r=0.3 class 0 = 0.607 +- 0.295 (in-sample avg dev_std = 0.549)
NEC for r=0.3 class 1 = 0.535 +- 0.295 (in-sample avg dev_std = 0.549)
NEC for r=0.3 class 2 = 0.658 +- 0.295 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all KL = 0.714 +- 0.295 (in-sample avg dev_std = 0.549)
NEC for r=0.3 all L1 = 0.6 +- 0.164 (in-sample avg dev_std = 0.549)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.837
Model XAI F1 of binarized graphs for r=0.6 =  0.61280625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7261012499999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.516 +- 0.309 (in-sample avg dev_std = 0.573)
NEC for r=0.6 class 1 = 0.481 +- 0.309 (in-sample avg dev_std = 0.573)
NEC for r=0.6 class 2 = 0.627 +- 0.309 (in-sample avg dev_std = 0.573)
NEC for r=0.6 all KL = 0.636 +- 0.309 (in-sample avg dev_std = 0.573)
NEC for r=0.6 all L1 = 0.541 +- 0.164 (in-sample avg dev_std = 0.573)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.48108249999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.71949875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.462 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 1 = 0.438 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 2 = 0.553 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all KL = 0.537 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all L1 = 0.484 +- 0.166 (in-sample avg dev_std = 0.569)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.905
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.719315
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.581
NEC for r=1.0 class 0 = 0.459 +- 0.308 (in-sample avg dev_std = 0.568)
NEC for r=1.0 class 1 = 0.422 +- 0.308 (in-sample avg dev_std = 0.568)
NEC for r=1.0 class 2 = 0.545 +- 0.308 (in-sample avg dev_std = 0.568)
NEC for r=1.0 all KL = 0.528 +- 0.308 (in-sample avg dev_std = 0.568)
NEC for r=1.0 all L1 = 0.475 +- 0.169 (in-sample avg dev_std = 0.568)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.873
Model XAI F1 of binarized graphs for r=0.3 =  0.66378375
Model XAI WIoU of binarized graphs for r=0.3 =  0.9293250000000001
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.402
NEC for r=0.3 class 0 = 0.578 +- 0.302 (in-sample avg dev_std = 0.488)
NEC for r=0.3 class 1 = 0.535 +- 0.302 (in-sample avg dev_std = 0.488)
NEC for r=0.3 class 2 = 0.713 +- 0.302 (in-sample avg dev_std = 0.488)
NEC for r=0.3 all KL = 0.678 +- 0.302 (in-sample avg dev_std = 0.488)
NEC for r=0.3 all L1 = 0.61 +- 0.150 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.40876375
Model XAI WIoU of binarized graphs for r=0.6 =  0.92616625
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.562
NEC for r=0.6 class 0 = 0.438 +- 0.285 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.415 +- 0.285 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.565 +- 0.285 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.437 +- 0.285 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.474 +- 0.143 (in-sample avg dev_std = 0.508)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.29531125
Model XAI WIoU of binarized graphs for r=0.9 =  0.92616625
len(reference) = 800
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.609
NEC for r=0.9 class 0 = 0.395 +- 0.253 (in-sample avg dev_std = 0.491)
NEC for r=0.9 class 1 = 0.389 +- 0.253 (in-sample avg dev_std = 0.491)
NEC for r=0.9 class 2 = 0.486 +- 0.253 (in-sample avg dev_std = 0.491)
NEC for r=0.9 all KL = 0.361 +- 0.253 (in-sample avg dev_std = 0.491)
NEC for r=0.9 all L1 = 0.424 +- 0.134 (in-sample avg dev_std = 0.491)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.27168375
Model XAI WIoU of binarized graphs for r=1.0 =  0.92616625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.61
NEC for r=1.0 class 0 = 0.402 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=1.0 class 1 = 0.398 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=1.0 class 2 = 0.468 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=1.0 all KL = 0.358 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=1.0 all L1 = 0.423 +- 0.127 (in-sample avg dev_std = 0.493)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.863
Model XAI F1 of binarized graphs for r=0.3 =  0.7685775000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8999287499999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.418
NEC for r=0.3 class 0 = 0.606 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 class 1 = 0.525 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 class 2 = 0.644 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 all KL = 0.643 +- 0.279 (in-sample avg dev_std = 0.517)
NEC for r=0.3 all L1 = 0.591 +- 0.135 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8493262500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.592
NEC for r=0.6 class 0 = 0.438 +- 0.332 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 1 = 0.394 +- 0.332 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 2 = 0.538 +- 0.332 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all KL = 0.486 +- 0.332 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all L1 = 0.456 +- 0.192 (in-sample avg dev_std = 0.545)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.865
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.827495
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.642
NEC for r=0.9 class 0 = 0.395 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.356 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.464 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.452 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.405 +- 0.189 (in-sample avg dev_std = 0.566)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.865
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.827495
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.648
NEC for r=1.0 class 0 = 0.388 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 1 = 0.349 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 2 = 0.457 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all KL = 0.449 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all L1 = 0.397 +- 0.174 (in-sample avg dev_std = 0.583)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.502, 0.724, 0.85, 1.0], 'all_L1': [0.548, 0.687, 0.773, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.644, 0.849, 1.0], 'all_L1': [0.547, 0.655, 0.794, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.441, 0.642, 0.846, 1.0], 'all_L1': [0.497, 0.673, 0.807, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.58, 0.804, 0.938, 1.0], 'all_L1': [0.574, 0.719, 0.859, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.634, 0.832, 1.0], 'all_L1': [0.483, 0.684, 0.803, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.586, 0.544, 0.465, 0.463], 'all_L1': [0.549, 0.535, 0.471, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.607, 0.613, 0.519, 0.515], 'all_L1': [0.551, 0.57, 0.514, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.639, 0.569, 0.555], 'all_L1': [0.567, 0.576, 0.527, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.436, 0.352, 0.347], 'all_L1': [0.505, 0.48, 0.423, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.714, 0.636, 0.537, 0.528], 'all_L1': [0.6, 0.541, 0.484, 0.475]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.496, 0.718, 0.88, 1.0], 'all_L1': [0.519, 0.605, 0.748, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.718, 0.82, 1.0], 'all_L1': [0.501, 0.603, 0.678, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.371, 0.664, 0.867, 1.0], 'all_L1': [0.507, 0.616, 0.772, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.846, 0.913, 1.0], 'all_L1': [0.63, 0.713, 0.788, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.696, 0.843, 1.0], 'all_L1': [0.576, 0.63, 0.746, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.645, 0.446, 0.345, 0.334], 'all_L1': [0.63, 0.523, 0.462, 0.453]}), defaultdict(<class 'list'>, {'all_KL': [0.681, 0.44, 0.34, 0.334], 'all_L1': [0.64, 0.525, 0.463, 0.457]}), defaultdict(<class 'list'>, {'all_KL': [0.784, 0.521, 0.397, 0.397], 'all_L1': [0.674, 0.54, 0.476, 0.474]}), defaultdict(<class 'list'>, {'all_KL': [0.534, 0.337, 0.229, 0.225], 'all_L1': [0.548, 0.44, 0.368, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.678, 0.437, 0.361, 0.358], 'all_L1': [0.61, 0.474, 0.424, 0.423]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.587, 0.804, 0.929, 1.0], 'all_L1': [0.649, 0.768, 0.862, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.627, 0.678, 0.717, 1.0], 'all_L1': [0.599, 0.675, 0.742, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.589, 0.746, 1.0], 'all_L1': [0.608, 0.646, 0.77, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.592, 0.777, 0.928, 1.0], 'all_L1': [0.593, 0.719, 0.857, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.661, 0.94, 1.0], 'all_L1': [0.583, 0.68, 0.895, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.657, 0.498, 0.405, 0.393], 'all_L1': [0.585, 0.462, 0.381, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.475, 0.446, 0.444], 'all_L1': [0.526, 0.477, 0.434, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.587, 0.53, 0.441, 0.441], 'all_L1': [0.533, 0.482, 0.389, 0.386]}), defaultdict(<class 'list'>, {'all_KL': [0.525, 0.404, 0.36, 0.366], 'all_L1': [0.516, 0.433, 0.388, 0.394]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.486, 0.452, 0.449], 'all_L1': [0.591, 0.456, 0.405, 0.397]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.530 +- 0.034, 0.684 +- 0.021, 0.807 +- 0.028, 1.000 +- 0.000
suff++ class all_KL  =  0.470 +- 0.079, 0.690 +- 0.066, 0.863 +- 0.038, 1.000 +- 0.000
suff++_acc_int  =  0.504 +- 0.043, 0.759 +- 0.017, 0.851 +- 0.013
nec class all_L1  =  0.554 +- 0.031, 0.540 +- 0.034, 0.484 +- 0.036, 0.478 +- 0.035
nec class all_KL  =  0.600 +- 0.072, 0.574 +- 0.077, 0.488 +- 0.076, 0.482 +- 0.074
nec_acc_int  =  0.363 +- 0.017, 0.466 +- 0.029, 0.556 +- 0.030, 0.563 +- 0.027

Eval split val
suff++ class all_L1  =  0.547 +- 0.049, 0.633 +- 0.041, 0.746 +- 0.038, 1.000 +- 0.000
suff++ class all_KL  =  0.492 +- 0.094, 0.728 +- 0.062, 0.865 +- 0.032, 1.000 +- 0.000
suff++_acc_int  =  0.629 +- 0.026, 0.722 +- 0.021, 0.785 +- 0.037
nec class all_L1  =  0.620 +- 0.042, 0.500 +- 0.037, 0.439 +- 0.039, 0.435 +- 0.038
nec class all_KL  =  0.664 +- 0.080, 0.436 +- 0.059, 0.334 +- 0.056, 0.330 +- 0.057
nec_acc_int  =  0.385 +- 0.016, 0.520 +- 0.024, 0.576 +- 0.024, 0.583 +- 0.019

Eval split test
suff++ class all_L1  =  0.606 +- 0.023, 0.698 +- 0.042, 0.825 +- 0.059, 1.000 +- 0.000
suff++ class all_KL  =  0.584 +- 0.027, 0.702 +- 0.079, 0.852 +- 0.099, 1.000 +- 0.000
suff++_acc_int  =  0.613 +- 0.054, 0.768 +- 0.039, 0.827 +- 0.056
nec class all_L1  =  0.550 +- 0.031, 0.462 +- 0.017, 0.399 +- 0.019, 0.395 +- 0.020
nec class all_KL  =  0.579 +- 0.067, 0.479 +- 0.042, 0.421 +- 0.035, 0.419 +- 0.033
nec_acc_int  =  0.393 +- 0.038, 0.555 +- 0.025, 0.626 +- 0.020, 0.633 +- 0.030


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.542 +- 0.006, 0.612 +- 0.008, 0.646 +- 0.015, 0.739 +- 0.018
Faith. Armon (L1)= 		  =  0.540 +- 0.008, 0.602 +- 0.015, 0.604 +- 0.026, 0.646 +- 0.033
Faith. GMean (L1)= 	  =  0.541 +- 0.007, 0.607 +- 0.011, 0.624 +- 0.019, 0.691 +- 0.026
Faith. Aritm (KL)= 		  =  0.535 +- 0.009, 0.632 +- 0.007, 0.676 +- 0.022, 0.741 +- 0.037
Faith. Armon (KL)= 		  =  0.517 +- 0.030, 0.618 +- 0.027, 0.618 +- 0.059, 0.647 +- 0.071
Faith. GMean (KL)= 	  =  0.526 +- 0.019, 0.625 +- 0.017, 0.646 +- 0.041, 0.692 +- 0.055

Eval split val
Faith. Aritm (L1)= 		  =  0.584 +- 0.009, 0.567 +- 0.010, 0.593 +- 0.019, 0.717 +- 0.019
Faith. Armon (L1)= 		  =  0.578 +- 0.011, 0.557 +- 0.013, 0.551 +- 0.030, 0.605 +- 0.038
Faith. GMean (L1)= 	  =  0.581 +- 0.010, 0.562 +- 0.010, 0.571 +- 0.024, 0.659 +- 0.029
Faith. Aritm (KL)= 		  =  0.578 +- 0.011, 0.582 +- 0.009, 0.600 +- 0.022, 0.665 +- 0.029
Faith. Armon (KL)= 		  =  0.552 +- 0.029, 0.540 +- 0.033, 0.479 +- 0.060, 0.493 +- 0.067
Faith. GMean (KL)= 	  =  0.565 +- 0.018, 0.560 +- 0.018, 0.535 +- 0.043, 0.572 +- 0.052

Eval split test
Faith. Aritm (L1)= 		  =  0.578 +- 0.022, 0.580 +- 0.018, 0.612 +- 0.026, 0.698 +- 0.010
Faith. Armon (L1)= 		  =  0.576 +- 0.023, 0.555 +- 0.013, 0.537 +- 0.014, 0.566 +- 0.021
Faith. GMean (L1)= 	  =  0.577 +- 0.022, 0.567 +- 0.015, 0.573 +- 0.018, 0.629 +- 0.016
Faith. Aritm (KL)= 		  =  0.581 +- 0.025, 0.590 +- 0.032, 0.636 +- 0.043, 0.709 +- 0.017
Faith. Armon (KL)= 		  =  0.578 +- 0.026, 0.565 +- 0.027, 0.560 +- 0.030, 0.589 +- 0.033
Faith. GMean (KL)= 	  =  0.580 +- 0.026, 0.577 +- 0.028, 0.596 +- 0.032, 0.646 +- 0.026
Computed for split load_split = id



Completed in  0:19:16.334876  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:39:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:39:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3041) +- tensor(0.1587)
F1 for r=0.3 = 0.705
WIoU for r=0.3 = 0.659
F1 for r=0.6 = 0.617
WIoU for r=0.6 = 0.739
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.732
F1 for r=1.0 = 0.445
WIoU for r=1.0 = 0.732
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1600) +- tensor(0.0464)
F1 for r=0.3 = 0.671
WIoU for r=0.3 = 0.990
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.990
F1 for r=0.9 = 0.297
WIoU for r=0.9 = 0.990
F1 for r=1.0 = 0.273
WIoU for r=1.0 = 0.990
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2522) +- tensor(0.0995)
F1 for r=0.3 = 0.783
WIoU for r=0.3 = 0.906
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.956
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.953
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.953


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.537
Model XAI F1 of binarized graphs for r=0.3 =  0.7052793333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.658764
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.527
SUFF++ for r=0.3 class 0 = 0.566 +- 0.297 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 class 1 = 0.542 +- 0.297 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 class 2 = 0.53 +- 0.297 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 all KL = 0.504 +- 0.297 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 all L1 = 0.546 +- 0.197 (in-sample avg dev_std = 0.525)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.6165653333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.7385246666666668
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.764
SUFF++ for r=0.6 class 0 = 0.7 +- 0.244 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 1 = 0.661 +- 0.244 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 2 = 0.689 +- 0.244 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all KL = 0.72 +- 0.244 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all L1 = 0.683 +- 0.202 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.47456266666666663
Model XAI WIoU of binarized graphs for r=0.9 =  0.7324093333333332
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0 = 0.792 +- 0.196 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 1 = 0.721 +- 0.196 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 class 2 = 0.804 +- 0.196 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all KL = 0.853 +- 0.196 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.9 all L1 = 0.772 +- 0.194 (in-sample avg dev_std = 0.263)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.869
Model XAI F1 of binarized graphs for r=0.3 =  0.6707919999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.9898626666666668
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.642
SUFF++ for r=0.3 class 0 = 0.471 +- 0.297 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 class 1 = 0.585 +- 0.297 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 class 2 = 0.491 +- 0.297 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 all KL = 0.49 +- 0.297 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 all L1 = 0.515 +- 0.153 (in-sample avg dev_std = 0.555)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  0.41089000000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.9898639999999999
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0 = 0.612 +- 0.183 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 1 = 0.601 +- 0.183 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 2 = 0.598 +- 0.183 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all KL = 0.717 +- 0.183 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all L1 = 0.604 +- 0.130 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.29694266666666663
Model XAI WIoU of binarized graphs for r=0.9 =  0.9898666666666667
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.798
SUFF++ for r=0.9 class 0 = 0.744 +- 0.143 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.731 +- 0.143 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.778 +- 0.143 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.882 +- 0.143 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.751 +- 0.152 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.701
Model XAI F1 of binarized graphs for r=0.3 =  0.7829613333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.9058360000000001
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.66
SUFF++ for r=0.3 class 0 = 0.628 +- 0.324 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 class 1 = 0.665 +- 0.324 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 class 2 = 0.634 +- 0.324 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 all KL = 0.585 +- 0.324 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 all L1 = 0.643 +- 0.210 (in-sample avg dev_std = 0.557)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.896
Model XAI F1 of binarized graphs for r=0.6 =  0.5665880000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.9557000000000001
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.823
SUFF++ for r=0.6 class 0 = 0.779 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 1 = 0.687 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 class 2 = 0.824 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all KL = 0.798 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.6 all L1 = 0.762 +- 0.152 (in-sample avg dev_std = 0.376)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.4247593333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.9534973333333334
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.876
SUFF++ for r=0.9 class 0 = 0.905 +- 0.121 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 class 1 = 0.8 +- 0.121 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.121 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 all KL = 0.925 +- 0.121 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.156 (in-sample avg dev_std = 0.127)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.537
Model XAI F1 of binarized graphs for r=0.3 =  0.7052793333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.658764
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
NEC for r=0.3 class 0 = 0.577 +- 0.289 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 1 = 0.506 +- 0.289 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 2 = 0.575 +- 0.289 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all KL = 0.587 +- 0.289 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all L1 = 0.552 +- 0.170 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.6165653333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.7385246666666668
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.507
NEC for r=0.6 class 0 = 0.577 +- 0.317 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 1 = 0.429 +- 0.317 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 2 = 0.604 +- 0.317 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all KL = 0.541 +- 0.317 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all L1 = 0.536 +- 0.180 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.47456266666666663
Model XAI WIoU of binarized graphs for r=0.9 =  0.7324093333333332
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.596
NEC for r=0.9 class 0 = 0.495 +- 0.302 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.395 +- 0.302 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.513 +- 0.302 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.455 +- 0.302 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.468 +- 0.170 (in-sample avg dev_std = 0.508)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  0.44498600000000005
Model XAI WIoU of binarized graphs for r=1.0 =  0.7323013333333334
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.601
NEC for r=1.0 class 0 = 0.498 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 1 = 0.387 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 2 = 0.516 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all KL = 0.453 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all L1 = 0.467 +- 0.168 (in-sample avg dev_std = 0.505)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.869
Model XAI F1 of binarized graphs for r=0.3 =  0.6707919999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.9898626666666668
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.375
NEC for r=0.3 class 0 = 0.675 +- 0.281 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 1 = 0.512 +- 0.281 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 2 = 0.707 +- 0.281 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all KL = 0.648 +- 0.281 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all L1 = 0.633 +- 0.132 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  0.41089000000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.9898639999999999
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.493
NEC for r=0.6 class 0 = 0.534 +- 0.222 (in-sample avg dev_std = 0.469)
NEC for r=0.6 class 1 = 0.466 +- 0.222 (in-sample avg dev_std = 0.469)
NEC for r=0.6 class 2 = 0.566 +- 0.222 (in-sample avg dev_std = 0.469)
NEC for r=0.6 all KL = 0.444 +- 0.222 (in-sample avg dev_std = 0.469)
NEC for r=0.6 all L1 = 0.523 +- 0.115 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.29694266666666663
Model XAI WIoU of binarized graphs for r=0.9 =  0.9898666666666667
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.454 +- 0.198 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 1 = 0.429 +- 0.198 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 2 = 0.505 +- 0.198 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all KL = 0.347 +- 0.198 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all L1 = 0.463 +- 0.117 (in-sample avg dev_std = 0.434)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.875
Model XAI F1 of binarized graphs for r=1.0 =  0.27315799999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.9898673333333333
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.571
NEC for r=1.0 class 0 = 0.454 +- 0.195 (in-sample avg dev_std = 0.429)
NEC for r=1.0 class 1 = 0.427 +- 0.195 (in-sample avg dev_std = 0.429)
NEC for r=1.0 class 2 = 0.484 +- 0.195 (in-sample avg dev_std = 0.429)
NEC for r=1.0 all KL = 0.339 +- 0.195 (in-sample avg dev_std = 0.429)
NEC for r=1.0 all L1 = 0.455 +- 0.120 (in-sample avg dev_std = 0.429)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.701
Model XAI F1 of binarized graphs for r=0.3 =  0.7829613333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.9058360000000001
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.652 +- 0.294 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 1 = 0.489 +- 0.294 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 2 = 0.612 +- 0.294 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all KL = 0.65 +- 0.294 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all L1 = 0.583 +- 0.148 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.896
Model XAI F1 of binarized graphs for r=0.6 =  0.5665880000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.9557000000000001
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.55
NEC for r=0.6 class 0 = 0.518 +- 0.353 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 1 = 0.357 +- 0.353 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 2 = 0.544 +- 0.353 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all KL = 0.503 +- 0.353 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all L1 = 0.472 +- 0.206 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.4247593333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.9534973333333334
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.664
NEC for r=0.9 class 0 = 0.395 +- 0.311 (in-sample avg dev_std = 0.518)
NEC for r=0.9 class 1 = 0.29 +- 0.311 (in-sample avg dev_std = 0.518)
NEC for r=0.9 class 2 = 0.436 +- 0.311 (in-sample avg dev_std = 0.518)
NEC for r=0.9 all KL = 0.391 +- 0.311 (in-sample avg dev_std = 0.518)
NEC for r=0.9 all L1 = 0.373 +- 0.188 (in-sample avg dev_std = 0.518)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.3927106666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.9534973333333334
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.668
NEC for r=1.0 class 0 = 0.401 +- 0.309 (in-sample avg dev_std = 0.520)
NEC for r=1.0 class 1 = 0.292 +- 0.309 (in-sample avg dev_std = 0.520)
NEC for r=1.0 class 2 = 0.415 +- 0.309 (in-sample avg dev_std = 0.520)
NEC for r=1.0 all KL = 0.387 +- 0.309 (in-sample avg dev_std = 0.520)
NEC for r=1.0 all L1 = 0.368 +- 0.184 (in-sample avg dev_std = 0.520)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:46:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:46:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3041) +- tensor(0.1587)
F1 for r=0.3 = 0.730
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.618
WIoU for r=0.6 = 0.768
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.765
F1 for r=1.0 = 0.445
WIoU for r=1.0 = 0.765
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1600) +- tensor(0.0464)
F1 for r=0.3 = 0.672
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.297
WIoU for r=0.9 = 0.994
F1 for r=1.0 = 0.273
WIoU for r=1.0 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2522) +- tensor(0.0995)
F1 for r=0.3 = 0.728
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.566
WIoU for r=0.6 = 0.844
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.792
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.785


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  0.7301906666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.7015326666666667
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF++ for r=0.3 class 0 = 0.488 +- 0.260 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 class 1 = 0.644 +- 0.260 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 class 2 = 0.509 +- 0.260 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 all KL = 0.489 +- 0.260 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 all L1 = 0.547 +- 0.160 (in-sample avg dev_std = 0.529)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.879
Model XAI F1 of binarized graphs for r=0.6 =  0.6175579999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7676673333333334
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.729
SUFF++ for r=0.6 class 0 = 0.644 +- 0.247 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1 = 0.653 +- 0.247 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 2 = 0.67 +- 0.247 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.651 +- 0.247 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.656 +- 0.187 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  0.4743066666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.7645333333333335
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0 = 0.783 +- 0.203 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 class 1 = 0.796 +- 0.203 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 class 2 = 0.795 +- 0.203 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 all KL = 0.849 +- 0.203 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 all L1 = 0.791 +- 0.188 (in-sample avg dev_std = 0.281)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.885
Model XAI F1 of binarized graphs for r=0.3 =  0.67162
Model XAI WIoU of binarized graphs for r=0.3 =  0.9941700000000001
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.597
SUFF++ for r=0.3 class 0 = 0.436 +- 0.292 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 1 = 0.62 +- 0.292 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 class 2 = 0.478 +- 0.292 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all KL = 0.454 +- 0.292 (in-sample avg dev_std = 0.584)
SUFF++ for r=0.3 all L1 = 0.51 +- 0.162 (in-sample avg dev_std = 0.584)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.41138133333333343
Model XAI WIoU of binarized graphs for r=0.6 =  0.9942400000000001
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.706
SUFF++ for r=0.6 class 0 = 0.572 +- 0.177 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 1 = 0.619 +- 0.177 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 class 2 = 0.619 +- 0.177 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all KL = 0.713 +- 0.177 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.6 all L1 = 0.603 +- 0.119 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.2969753333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.994222
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.745
SUFF++ for r=0.9 class 0 = 0.714 +- 0.175 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 1 = 0.748 +- 0.175 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 2 = 0.585 +- 0.175 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all KL = 0.821 +- 0.175 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all L1 = 0.682 +- 0.162 (in-sample avg dev_std = 0.293)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  0.7281506666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.8407506666666665
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.602
SUFF++ for r=0.3 class 0 = 0.594 +- 0.229 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 1 = 0.591 +- 0.229 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 2 = 0.581 +- 0.229 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all KL = 0.621 +- 0.229 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all L1 = 0.589 +- 0.176 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.888
Model XAI F1 of binarized graphs for r=0.6 =  0.5664893333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.8437319999999999
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.781
SUFF++ for r=0.6 class 0 = 0.686 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 1 = 0.624 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 2 = 0.708 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all KL = 0.674 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all L1 = 0.672 +- 0.166 (in-sample avg dev_std = 0.474)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  0.424688
Model XAI WIoU of binarized graphs for r=0.9 =  0.7922113333333334
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.727
SUFF++ for r=0.9 class 0 = 0.668 +- 0.373 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 class 1 = 0.667 +- 0.373 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.373 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 all KL = 0.712 +- 0.373 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 all L1 = 0.739 +- 0.277 (in-sample avg dev_std = 0.476)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.7301906666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.7015326666666667
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.375
NEC for r=0.3 class 0 = 0.563 +- 0.282 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.502 +- 0.282 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.584 +- 0.282 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.604 +- 0.282 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.55 +- 0.155 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.879
Model XAI F1 of binarized graphs for r=0.6 =  0.6175579999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7676673333333334
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.44
NEC for r=0.6 class 0 = 0.551 +- 0.311 (in-sample avg dev_std = 0.450)
NEC for r=0.6 class 1 = 0.528 +- 0.311 (in-sample avg dev_std = 0.450)
NEC for r=0.6 class 2 = 0.611 +- 0.311 (in-sample avg dev_std = 0.450)
NEC for r=0.6 all KL = 0.597 +- 0.311 (in-sample avg dev_std = 0.450)
NEC for r=0.6 all L1 = 0.563 +- 0.165 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  0.4743066666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.7645333333333335
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.488 +- 0.284 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 1 = 0.478 +- 0.284 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 2 = 0.551 +- 0.284 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all KL = 0.504 +- 0.284 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all L1 = 0.505 +- 0.160 (in-sample avg dev_std = 0.500)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.44498600000000005
Model XAI WIoU of binarized graphs for r=1.0 =  0.7646326666666665
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.487 +- 0.287 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 1 = 0.47 +- 0.287 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 2 = 0.556 +- 0.287 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all KL = 0.502 +- 0.287 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all L1 = 0.504 +- 0.163 (in-sample avg dev_std = 0.492)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.885
Model XAI F1 of binarized graphs for r=0.3 =  0.67162
Model XAI WIoU of binarized graphs for r=0.3 =  0.9941700000000001
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.374
NEC for r=0.3 class 0 = 0.656 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 1 = 0.512 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 2 = 0.741 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all KL = 0.679 +- 0.284 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all L1 = 0.638 +- 0.146 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.41138133333333343
Model XAI WIoU of binarized graphs for r=0.6 =  0.9942400000000001
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.493
NEC for r=0.6 class 0 = 0.546 +- 0.219 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 1 = 0.477 +- 0.219 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 2 = 0.557 +- 0.219 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all KL = 0.447 +- 0.219 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all L1 = 0.527 +- 0.119 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  0.2969753333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.994222
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0 = 0.477 +- 0.199 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 1 = 0.437 +- 0.199 (in-sample avg dev_std = 0.442)
NEC for r=0.9 class 2 = 0.478 +- 0.199 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all KL = 0.346 +- 0.199 (in-sample avg dev_std = 0.442)
NEC for r=0.9 all L1 = 0.464 +- 0.120 (in-sample avg dev_std = 0.442)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  0.27315799999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.9942186666666667
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.47 +- 0.195 (in-sample avg dev_std = 0.444)
NEC for r=1.0 class 1 = 0.428 +- 0.195 (in-sample avg dev_std = 0.444)
NEC for r=1.0 class 2 = 0.469 +- 0.195 (in-sample avg dev_std = 0.444)
NEC for r=1.0 all KL = 0.336 +- 0.195 (in-sample avg dev_std = 0.444)
NEC for r=1.0 all L1 = 0.456 +- 0.117 (in-sample avg dev_std = 0.444)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.575
Model XAI F1 of binarized graphs for r=0.3 =  0.7281506666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.8407506666666665
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.447
NEC for r=0.3 class 0 = 0.489 +- 0.217 (in-sample avg dev_std = 0.465)
NEC for r=0.3 class 1 = 0.509 +- 0.217 (in-sample avg dev_std = 0.465)
NEC for r=0.3 class 2 = 0.578 +- 0.217 (in-sample avg dev_std = 0.465)
NEC for r=0.3 all KL = 0.478 +- 0.217 (in-sample avg dev_std = 0.465)
NEC for r=0.3 all L1 = 0.526 +- 0.126 (in-sample avg dev_std = 0.465)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.888
Model XAI F1 of binarized graphs for r=0.6 =  0.5664893333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.8437319999999999
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.525
NEC for r=0.6 class 0 = 0.434 +- 0.345 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 1 = 0.486 +- 0.345 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 2 = 0.529 +- 0.345 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all KL = 0.483 +- 0.345 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all L1 = 0.484 +- 0.199 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  0.424688
Model XAI WIoU of binarized graphs for r=0.9 =  0.7922113333333334
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.586
NEC for r=0.9 class 0 = 0.41 +- 0.336 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 1 = 0.461 +- 0.336 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 2 = 0.45 +- 0.336 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all KL = 0.457 +- 0.336 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all L1 = 0.441 +- 0.196 (in-sample avg dev_std = 0.581)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  0.3927106666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.7852193333333335
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.402 +- 0.330 (in-sample avg dev_std = 0.574)
NEC for r=1.0 class 1 = 0.448 +- 0.330 (in-sample avg dev_std = 0.574)
NEC for r=1.0 class 2 = 0.428 +- 0.330 (in-sample avg dev_std = 0.574)
NEC for r=1.0 all KL = 0.444 +- 0.330 (in-sample avg dev_std = 0.574)
NEC for r=1.0 all L1 = 0.427 +- 0.191 (in-sample avg dev_std = 0.574)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 10:53:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 10:53:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3041) +- tensor(0.1587)
F1 for r=0.3 = 0.674
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.604
WIoU for r=0.6 = 0.686
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.697
F1 for r=1.0 = 0.445
WIoU for r=1.0 = 0.697
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1600) +- tensor(0.0464)
F1 for r=0.3 = 0.672
WIoU for r=0.3 = 0.993
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.993
F1 for r=0.9 = 0.297
WIoU for r=0.9 = 0.993
F1 for r=1.0 = 0.273
WIoU for r=1.0 = 0.993
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2522) +- tensor(0.0995)
F1 for r=0.3 = 0.786
WIoU for r=0.3 = 0.876
F1 for r=0.6 = 0.548
WIoU for r=0.6 = 0.745
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.686
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.683


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.514
Model XAI F1 of binarized graphs for r=0.3 =  0.6744846666666666
Model XAI WIoU of binarized graphs for r=0.3 =  0.595148
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.423
SUFF++ for r=0.3 class 0 = 0.488 +- 0.252 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 1 = 0.544 +- 0.252 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 2 = 0.469 +- 0.252 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all KL = 0.446 +- 0.252 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.155 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.6038833333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.6856493333333333
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.74
SUFF++ for r=0.6 class 0 = 0.642 +- 0.284 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 1 = 0.658 +- 0.284 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 2 = 0.674 +- 0.284 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all KL = 0.622 +- 0.284 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all L1 = 0.658 +- 0.209 (in-sample avg dev_std = 0.474)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.47444533333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.6966260000000001
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.849
SUFF++ for r=0.9 class 0 = 0.789 +- 0.201 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.789 +- 0.201 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.816 +- 0.201 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.839 +- 0.201 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.184 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.921
Model XAI F1 of binarized graphs for r=0.3 =  0.6718873333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.617
SUFF++ for r=0.3 class 0 = 0.477 +- 0.291 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 class 1 = 0.642 +- 0.291 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 class 2 = 0.431 +- 0.291 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 all KL = 0.379 +- 0.291 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 all L1 = 0.515 +- 0.171 (in-sample avg dev_std = 0.654)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.922
Model XAI F1 of binarized graphs for r=0.6 =  0.4114206666666667
Model XAI WIoU of binarized graphs for r=0.6 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF++ for r=0.6 class 0 = 0.594 +- 0.208 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 1 = 0.602 +- 0.208 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 2 = 0.651 +- 0.208 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all KL = 0.659 +- 0.208 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all L1 = 0.616 +- 0.139 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.297004
Model XAI WIoU of binarized graphs for r=0.9 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0 = 0.738 +- 0.188 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 1 = 0.745 +- 0.188 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 2 = 0.816 +- 0.188 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all KL = 0.86 +- 0.188 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all L1 = 0.767 +- 0.155 (in-sample avg dev_std = 0.306)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.496
Model XAI F1 of binarized graphs for r=0.3 =  0.7861413333333334
Model XAI WIoU of binarized graphs for r=0.3 =  0.8761613333333335
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.604 +- 0.300 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 1 = 0.643 +- 0.300 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 2 = 0.546 +- 0.300 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all KL = 0.557 +- 0.300 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.183 (in-sample avg dev_std = 0.543)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.866
Model XAI F1 of binarized graphs for r=0.6 =  0.548088
Model XAI WIoU of binarized graphs for r=0.6 =  0.745056
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.729
SUFF++ for r=0.6 class 0 = 0.612 +- 0.338 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.6 class 1 = 0.681 +- 0.338 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.6 class 2 = 0.637 +- 0.338 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.6 all KL = 0.586 +- 0.338 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.6 all L1 = 0.644 +- 0.194 (in-sample avg dev_std = 0.582)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.67
Model XAI F1 of binarized graphs for r=0.9 =  0.4247593333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.6862046666666667
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0 = 0.677 +- 0.309 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 1 = 0.716 +- 0.309 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 2 = 0.91 +- 0.309 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all KL = 0.746 +- 0.309 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all L1 = 0.768 +- 0.286 (in-sample avg dev_std = 0.303)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.513
Model XAI F1 of binarized graphs for r=0.3 =  0.6744846666666666
Model XAI WIoU of binarized graphs for r=0.3 =  0.595148
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.586 +- 0.280 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 1 = 0.532 +- 0.280 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 2 = 0.585 +- 0.280 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all KL = 0.608 +- 0.280 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all L1 = 0.567 +- 0.164 (in-sample avg dev_std = 0.468)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.6038833333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.6856493333333333
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.457
NEC for r=0.6 class 0 = 0.575 +- 0.281 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 1 = 0.516 +- 0.281 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 2 = 0.623 +- 0.281 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all KL = 0.631 +- 0.281 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all L1 = 0.571 +- 0.165 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.47444533333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.6966260000000001
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.528
NEC for r=0.9 class 0 = 0.529 +- 0.296 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 1 = 0.477 +- 0.296 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 2 = 0.578 +- 0.296 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all KL = 0.566 +- 0.296 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all L1 = 0.528 +- 0.167 (in-sample avg dev_std = 0.573)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.917
Model XAI F1 of binarized graphs for r=1.0 =  0.44498600000000005
Model XAI WIoU of binarized graphs for r=1.0 =  0.6966486666666666
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.522 +- 0.287 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.474 +- 0.287 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.56 +- 0.287 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.553 +- 0.287 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.519 +- 0.161 (in-sample avg dev_std = 0.576)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.921
Model XAI F1 of binarized graphs for r=0.3 =  0.6718873333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.382
NEC for r=0.3 class 0 = 0.671 +- 0.220 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 1 = 0.572 +- 0.220 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 2 = 0.767 +- 0.220 (in-sample avg dev_std = 0.489)
NEC for r=0.3 all KL = 0.781 +- 0.220 (in-sample avg dev_std = 0.489)
NEC for r=0.3 all L1 = 0.671 +- 0.124 (in-sample avg dev_std = 0.489)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.922
Model XAI F1 of binarized graphs for r=0.6 =  0.4114206666666667
Model XAI WIoU of binarized graphs for r=0.6 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.52
NEC for r=0.6 class 0 = 0.539 +- 0.248 (in-sample avg dev_std = 0.563)
NEC for r=0.6 class 1 = 0.472 +- 0.248 (in-sample avg dev_std = 0.563)
NEC for r=0.6 class 2 = 0.621 +- 0.248 (in-sample avg dev_std = 0.563)
NEC for r=0.6 all KL = 0.531 +- 0.248 (in-sample avg dev_std = 0.563)
NEC for r=0.6 all L1 = 0.545 +- 0.137 (in-sample avg dev_std = 0.563)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.297004
Model XAI WIoU of binarized graphs for r=0.9 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.472 +- 0.210 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 1 = 0.464 +- 0.210 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 2 = 0.516 +- 0.210 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all KL = 0.408 +- 0.210 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all L1 = 0.484 +- 0.121 (in-sample avg dev_std = 0.522)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.27315799999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.9934440000000001
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.568
NEC for r=1.0 class 0 = 0.467 +- 0.211 (in-sample avg dev_std = 0.524)
NEC for r=1.0 class 1 = 0.475 +- 0.211 (in-sample avg dev_std = 0.524)
NEC for r=1.0 class 2 = 0.501 +- 0.211 (in-sample avg dev_std = 0.524)
NEC for r=1.0 all KL = 0.408 +- 0.211 (in-sample avg dev_std = 0.524)
NEC for r=1.0 all L1 = 0.481 +- 0.123 (in-sample avg dev_std = 0.524)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.496
Model XAI F1 of binarized graphs for r=0.3 =  0.7861413333333334
Model XAI WIoU of binarized graphs for r=0.3 =  0.8761613333333335
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.4
NEC for r=0.3 class 0 = 0.549 +- 0.271 (in-sample avg dev_std = 0.561)
NEC for r=0.3 class 1 = 0.449 +- 0.271 (in-sample avg dev_std = 0.561)
NEC for r=0.3 class 2 = 0.607 +- 0.271 (in-sample avg dev_std = 0.561)
NEC for r=0.3 all KL = 0.589 +- 0.271 (in-sample avg dev_std = 0.561)
NEC for r=0.3 all L1 = 0.535 +- 0.132 (in-sample avg dev_std = 0.561)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.869
Model XAI F1 of binarized graphs for r=0.6 =  0.548088
Model XAI WIoU of binarized graphs for r=0.6 =  0.745056
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.568
NEC for r=0.6 class 0 = 0.404 +- 0.358 (in-sample avg dev_std = 0.594)
NEC for r=0.6 class 1 = 0.502 +- 0.358 (in-sample avg dev_std = 0.594)
NEC for r=0.6 class 2 = 0.542 +- 0.358 (in-sample avg dev_std = 0.594)
NEC for r=0.6 all KL = 0.532 +- 0.358 (in-sample avg dev_std = 0.594)
NEC for r=0.6 all L1 = 0.484 +- 0.234 (in-sample avg dev_std = 0.594)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.669
Model XAI F1 of binarized graphs for r=0.9 =  0.4247593333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.6862046666666667
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.634
NEC for r=0.9 class 0 = 0.411 +- 0.310 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.431 +- 0.310 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.341 +- 0.310 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.447 +- 0.310 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.394 +- 0.199 (in-sample avg dev_std = 0.533)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.713
Model XAI F1 of binarized graphs for r=1.0 =  0.3927106666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.6832940000000001
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.648
NEC for r=1.0 class 0 = 0.394 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 1 = 0.445 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 2 = 0.314 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all KL = 0.436 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all L1 = 0.385 +- 0.207 (in-sample avg dev_std = 0.521)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 11:00:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:00:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3041) +- tensor(0.1587)
F1 for r=0.3 = 0.746
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.609
WIoU for r=0.6 = 0.900
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.904
F1 for r=1.0 = 0.445
WIoU for r=1.0 = 0.904
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1600) +- tensor(0.0464)
F1 for r=0.3 = 0.671
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.297
WIoU for r=0.9 = 0.996
F1 for r=1.0 = 0.273
WIoU for r=1.0 = 0.996
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2522) +- tensor(0.0995)
F1 for r=0.3 = 0.756
WIoU for r=0.3 = 0.843
F1 for r=0.6 = 0.557
WIoU for r=0.6 = 0.844
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.844
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.844


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.663
Model XAI F1 of binarized graphs for r=0.3 =  0.7460673333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.8406313333333334
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.52
SUFF++ for r=0.3 class 0 = 0.533 +- 0.290 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 1 = 0.665 +- 0.290 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.290 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all KL = 0.59 +- 0.290 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all L1 = 0.581 +- 0.165 (in-sample avg dev_std = 0.465)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.6094853333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.9003213333333333
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0 = 0.629 +- 0.197 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 class 1 = 0.746 +- 0.197 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 class 2 = 0.769 +- 0.197 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 all KL = 0.8 +- 0.197 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.6 all L1 = 0.714 +- 0.175 (in-sample avg dev_std = 0.312)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.4737733333333334
Model XAI WIoU of binarized graphs for r=0.9 =  0.9037453333333333
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0 = 0.828 +- 0.115 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 1 = 0.844 +- 0.115 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 2 = 0.888 +- 0.115 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all KL = 0.932 +- 0.115 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all L1 = 0.853 +- 0.140 (in-sample avg dev_std = 0.183)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.904
Model XAI F1 of binarized graphs for r=0.3 =  0.671124
Model XAI WIoU of binarized graphs for r=0.3 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.65
SUFF++ for r=0.3 class 0 = 0.545 +- 0.285 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 1 = 0.688 +- 0.285 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 2 = 0.647 +- 0.285 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all KL = 0.657 +- 0.285 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all L1 = 0.626 +- 0.188 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  0.411378
Model XAI WIoU of binarized graphs for r=0.6 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.746
SUFF++ for r=0.6 class 0 = 0.68 +- 0.147 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.6 class 1 = 0.72 +- 0.147 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.6 class 2 = 0.732 +- 0.147 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.6 all KL = 0.843 +- 0.147 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.6 all L1 = 0.711 +- 0.127 (in-sample avg dev_std = 0.285)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.854
Model XAI F1 of binarized graphs for r=0.9 =  0.297004
Model XAI WIoU of binarized graphs for r=0.9 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.784
SUFF++ for r=0.9 class 0 = 0.746 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.78 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.84 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.912 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.789 +- 0.121 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.749
Model XAI F1 of binarized graphs for r=0.3 =  0.7561533333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.842966
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0 = 0.524 +- 0.312 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 1 = 0.665 +- 0.312 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 2 = 0.584 +- 0.312 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all KL = 0.591 +- 0.312 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.173 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.899
Model XAI F1 of binarized graphs for r=0.6 =  0.557338
Model XAI WIoU of binarized graphs for r=0.6 =  0.8440093333333333
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.72
SUFF++ for r=0.6 class 0 = 0.585 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 1 = 0.796 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 2 = 0.798 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all KL = 0.784 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all L1 = 0.728 +- 0.182 (in-sample avg dev_std = 0.372)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.4247593333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.8440093333333333
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.812
SUFF++ for r=0.9 class 0 = 0.781 +- 0.094 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 class 1 = 0.853 +- 0.094 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 class 2 = 0.934 +- 0.094 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 all KL = 0.926 +- 0.094 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.146 (in-sample avg dev_std = 0.191)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.662
Model XAI F1 of binarized graphs for r=0.3 =  0.7460673333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.8406313333333334
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.464 +- 0.338 (in-sample avg dev_std = 0.386)
NEC for r=0.3 class 1 = 0.462 +- 0.338 (in-sample avg dev_std = 0.386)
NEC for r=0.3 class 2 = 0.585 +- 0.338 (in-sample avg dev_std = 0.386)
NEC for r=0.3 all KL = 0.484 +- 0.338 (in-sample avg dev_std = 0.386)
NEC for r=0.3 all L1 = 0.503 +- 0.176 (in-sample avg dev_std = 0.386)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.6094853333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.9003213333333333
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.469
NEC for r=0.6 class 0 = 0.409 +- 0.308 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 1 = 0.434 +- 0.308 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 2 = 0.596 +- 0.308 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all KL = 0.432 +- 0.308 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all L1 = 0.479 +- 0.175 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.4737733333333334
Model XAI WIoU of binarized graphs for r=0.9 =  0.9037453333333333
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.545
NEC for r=0.9 class 0 = 0.373 +- 0.298 (in-sample avg dev_std = 0.456)
NEC for r=0.9 class 1 = 0.375 +- 0.298 (in-sample avg dev_std = 0.456)
NEC for r=0.9 class 2 = 0.526 +- 0.298 (in-sample avg dev_std = 0.456)
NEC for r=0.9 all KL = 0.351 +- 0.298 (in-sample avg dev_std = 0.456)
NEC for r=0.9 all L1 = 0.424 +- 0.173 (in-sample avg dev_std = 0.456)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.44498600000000005
Model XAI WIoU of binarized graphs for r=1.0 =  0.9037453333333333
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.362 +- 0.298 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 1 = 0.369 +- 0.298 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 2 = 0.522 +- 0.298 (in-sample avg dev_std = 0.459)
NEC for r=1.0 all KL = 0.346 +- 0.298 (in-sample avg dev_std = 0.459)
NEC for r=1.0 all L1 = 0.417 +- 0.173 (in-sample avg dev_std = 0.459)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.905
Model XAI F1 of binarized graphs for r=0.3 =  0.671124
Model XAI WIoU of binarized graphs for r=0.3 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.392
NEC for r=0.3 class 0 = 0.449 +- 0.333 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 1 = 0.475 +- 0.333 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 2 = 0.717 +- 0.333 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all KL = 0.533 +- 0.333 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all L1 = 0.548 +- 0.189 (in-sample avg dev_std = 0.399)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  0.411378
Model XAI WIoU of binarized graphs for r=0.6 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.521
NEC for r=0.6 class 0 = 0.381 +- 0.264 (in-sample avg dev_std = 0.431)
NEC for r=0.6 class 1 = 0.36 +- 0.264 (in-sample avg dev_std = 0.431)
NEC for r=0.6 class 2 = 0.566 +- 0.264 (in-sample avg dev_std = 0.431)
NEC for r=0.6 all KL = 0.335 +- 0.264 (in-sample avg dev_std = 0.431)
NEC for r=0.6 all L1 = 0.436 +- 0.166 (in-sample avg dev_std = 0.431)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.854
Model XAI F1 of binarized graphs for r=0.9 =  0.297004
Model XAI WIoU of binarized graphs for r=0.9 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.581
NEC for r=0.9 class 0 = 0.329 +- 0.196 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 1 = 0.312 +- 0.196 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 2 = 0.465 +- 0.196 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all KL = 0.228 +- 0.196 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all L1 = 0.369 +- 0.142 (in-sample avg dev_std = 0.383)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.854
Model XAI F1 of binarized graphs for r=1.0 =  0.27315799999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.9956779999999998
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.589
NEC for r=1.0 class 0 = 0.335 +- 0.185 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 1 = 0.311 +- 0.185 (in-sample avg dev_std = 0.381)
NEC for r=1.0 class 2 = 0.447 +- 0.185 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all KL = 0.223 +- 0.185 (in-sample avg dev_std = 0.381)
NEC for r=1.0 all L1 = 0.365 +- 0.135 (in-sample avg dev_std = 0.381)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.749
Model XAI F1 of binarized graphs for r=0.3 =  0.7561533333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.842966
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.481 +- 0.322 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 1 = 0.482 +- 0.322 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 2 = 0.586 +- 0.322 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all KL = 0.529 +- 0.322 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all L1 = 0.517 +- 0.156 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.899
Model XAI F1 of binarized graphs for r=0.6 =  0.557338
Model XAI WIoU of binarized graphs for r=0.6 =  0.8440093333333333
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.543
NEC for r=0.6 class 0 = 0.349 +- 0.348 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.418 +- 0.348 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.537 +- 0.348 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.413 +- 0.348 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.436 +- 0.206 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.4247593333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.8440093333333333
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.357 +- 0.307 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 1 = 0.357 +- 0.307 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 2 = 0.466 +- 0.307 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all KL = 0.366 +- 0.307 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all L1 = 0.394 +- 0.181 (in-sample avg dev_std = 0.507)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.3927106666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.8440093333333333
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.606
NEC for r=1.0 class 0 = 0.357 +- 0.306 (in-sample avg dev_std = 0.517)
NEC for r=1.0 class 1 = 0.367 +- 0.306 (in-sample avg dev_std = 0.517)
NEC for r=1.0 class 2 = 0.457 +- 0.306 (in-sample avg dev_std = 0.517)
NEC for r=1.0 all KL = 0.371 +- 0.306 (in-sample avg dev_std = 0.517)
NEC for r=1.0 all L1 = 0.394 +- 0.181 (in-sample avg dev_std = 0.517)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 11:07:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:57 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:07:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3041) +- tensor(0.1587)
F1 for r=0.3 = 0.708
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.606
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.716
F1 for r=1.0 = 0.445
WIoU for r=1.0 = 0.715
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1600) +- tensor(0.0464)
F1 for r=0.3 = 0.667
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.297
WIoU for r=0.9 = 0.927
F1 for r=1.0 = 0.273
WIoU for r=1.0 = 0.927
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2522) +- tensor(0.0995)
F1 for r=0.3 = 0.771
WIoU for r=0.3 = 0.894
F1 for r=0.6 = 0.548
WIoU for r=0.6 = 0.844
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.822
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.822


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  0.7082013333333332
Model XAI WIoU of binarized graphs for r=0.3 =  0.6564220000000001
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.537
SUFF++ for r=0.3 class 0 = 0.462 +- 0.299 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.539 +- 0.299 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.482 +- 0.299 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.363 +- 0.299 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.494 +- 0.191 (in-sample avg dev_std = 0.608)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.833
Model XAI F1 of binarized graphs for r=0.6 =  0.6059793333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.7213920000000001
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.762
SUFF++ for r=0.6 class 0 = 0.613 +- 0.306 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.306 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.719 +- 0.306 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.632 +- 0.306 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.68 +- 0.220 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.474058
Model XAI WIoU of binarized graphs for r=0.9 =  0.7155926666666668
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.851
SUFF++ for r=0.9 class 0 = 0.745 +- 0.236 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 1 = 0.811 +- 0.236 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.236 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all KL = 0.838 +- 0.236 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.200 (in-sample avg dev_std = 0.280)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.876
Model XAI F1 of binarized graphs for r=0.3 =  0.6670626666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.9298353333333335
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.655
SUFF++ for r=0.3 class 0 = 0.517 +- 0.312 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 1 = 0.636 +- 0.312 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 2 = 0.58 +- 0.312 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all KL = 0.492 +- 0.312 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all L1 = 0.577 +- 0.181 (in-sample avg dev_std = 0.582)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  0.41085600000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.9274986666666667
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.684
SUFF++ for r=0.6 class 0 = 0.604 +- 0.229 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 class 1 = 0.624 +- 0.229 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 class 2 = 0.645 +- 0.229 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 all KL = 0.689 +- 0.229 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 all L1 = 0.624 +- 0.157 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.2969733333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.9274986666666667
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.747
SUFF++ for r=0.9 class 0 = 0.719 +- 0.199 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 class 1 = 0.701 +- 0.199 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 class 2 = 0.796 +- 0.199 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 all KL = 0.835 +- 0.199 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 all L1 = 0.739 +- 0.173 (in-sample avg dev_std = 0.312)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.853
Model XAI F1 of binarized graphs for r=0.3 =  0.7714200000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8942853333333333
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.691
SUFF++ for r=0.3 class 0 = 0.555 +- 0.316 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 1 = 0.646 +- 0.316 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 2 = 0.525 +- 0.316 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all KL = 0.544 +- 0.316 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all L1 = 0.576 +- 0.220 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.5479893333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.8444686666666666
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.771
SUFF++ for r=0.6 class 0 = 0.591 +- 0.302 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 class 1 = 0.757 +- 0.302 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 class 2 = 0.697 +- 0.302 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 all KL = 0.661 +- 0.302 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 all L1 = 0.683 +- 0.184 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.855
Model XAI F1 of binarized graphs for r=0.9 =  0.42468799999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.8221406666666666
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF++ for r=0.9 class 0 = 0.832 +- 0.123 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 1 = 0.936 +- 0.123 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 2 = 0.923 +- 0.123 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all KL = 0.942 +- 0.123 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all L1 = 0.898 +- 0.145 (in-sample avg dev_std = 0.222)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  0.7082013333333332
Model XAI WIoU of binarized graphs for r=0.3 =  0.6564220000000001
len(reference) = 1500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.396
NEC for r=0.3 class 0 = 0.603 +- 0.298 (in-sample avg dev_std = 0.559)
NEC for r=0.3 class 1 = 0.533 +- 0.298 (in-sample avg dev_std = 0.559)
NEC for r=0.3 class 2 = 0.658 +- 0.298 (in-sample avg dev_std = 0.559)
NEC for r=0.3 all KL = 0.707 +- 0.298 (in-sample avg dev_std = 0.559)
NEC for r=0.3 all L1 = 0.598 +- 0.162 (in-sample avg dev_std = 0.559)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.833
Model XAI F1 of binarized graphs for r=0.6 =  0.6059793333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.7213920000000001
len(reference) = 1500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.487
NEC for r=0.6 class 0 = 0.51 +- 0.320 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 1 = 0.487 +- 0.320 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 2 = 0.623 +- 0.320 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all KL = 0.621 +- 0.320 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all L1 = 0.539 +- 0.174 (in-sample avg dev_std = 0.558)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.474058
Model XAI WIoU of binarized graphs for r=0.9 =  0.7155926666666668
len(reference) = 1500
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.573
NEC for r=0.9 class 0 = 0.454 +- 0.312 (in-sample avg dev_std = 0.556)
NEC for r=0.9 class 1 = 0.436 +- 0.312 (in-sample avg dev_std = 0.556)
NEC for r=0.9 class 2 = 0.557 +- 0.312 (in-sample avg dev_std = 0.556)
NEC for r=0.9 all KL = 0.526 +- 0.312 (in-sample avg dev_std = 0.556)
NEC for r=0.9 all L1 = 0.482 +- 0.170 (in-sample avg dev_std = 0.556)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.44498600000000005
Model XAI WIoU of binarized graphs for r=1.0 =  0.7154153333333332
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.59
NEC for r=1.0 class 0 = 0.452 +- 0.311 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 1 = 0.422 +- 0.311 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 2 = 0.536 +- 0.311 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all KL = 0.517 +- 0.311 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all L1 = 0.47 +- 0.166 (in-sample avg dev_std = 0.570)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.876
Model XAI F1 of binarized graphs for r=0.3 =  0.6670626666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.9298353333333335
len(reference) = 1500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.401
NEC for r=0.3 class 0 = 0.576 +- 0.305 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 1 = 0.53 +- 0.305 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 2 = 0.711 +- 0.305 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all KL = 0.669 +- 0.305 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all L1 = 0.606 +- 0.152 (in-sample avg dev_std = 0.483)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  0.41085600000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.9274986666666667
len(reference) = 1500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.558
NEC for r=0.6 class 0 = 0.431 +- 0.283 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 1 = 0.413 +- 0.283 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 2 = 0.556 +- 0.283 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all KL = 0.427 +- 0.283 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all L1 = 0.468 +- 0.145 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.2969733333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.9274986666666667
len(reference) = 1500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.597
NEC for r=0.9 class 0 = 0.399 +- 0.245 (in-sample avg dev_std = 0.490)
NEC for r=0.9 class 1 = 0.392 +- 0.245 (in-sample avg dev_std = 0.490)
NEC for r=0.9 class 2 = 0.479 +- 0.245 (in-sample avg dev_std = 0.490)
NEC for r=0.9 all KL = 0.356 +- 0.245 (in-sample avg dev_std = 0.490)
NEC for r=0.9 all L1 = 0.424 +- 0.129 (in-sample avg dev_std = 0.490)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.27315799999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.9274986666666667
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.604
NEC for r=1.0 class 0 = 0.398 +- 0.242 (in-sample avg dev_std = 0.485)
NEC for r=1.0 class 1 = 0.392 +- 0.242 (in-sample avg dev_std = 0.485)
NEC for r=1.0 class 2 = 0.471 +- 0.242 (in-sample avg dev_std = 0.485)
NEC for r=1.0 all KL = 0.352 +- 0.242 (in-sample avg dev_std = 0.485)
NEC for r=1.0 all L1 = 0.421 +- 0.129 (in-sample avg dev_std = 0.485)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.853
Model XAI F1 of binarized graphs for r=0.3 =  0.7714200000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8942853333333333
len(reference) = 1500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.421
NEC for r=0.3 class 0 = 0.596 +- 0.276 (in-sample avg dev_std = 0.525)
NEC for r=0.3 class 1 = 0.536 +- 0.276 (in-sample avg dev_std = 0.525)
NEC for r=0.3 class 2 = 0.629 +- 0.276 (in-sample avg dev_std = 0.525)
NEC for r=0.3 all KL = 0.636 +- 0.276 (in-sample avg dev_std = 0.525)
NEC for r=0.3 all L1 = 0.586 +- 0.133 (in-sample avg dev_std = 0.525)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.855
Model XAI F1 of binarized graphs for r=0.6 =  0.5479893333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.8444686666666666
len(reference) = 1500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.589
NEC for r=0.6 class 0 = 0.435 +- 0.333 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 1 = 0.406 +- 0.333 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 2 = 0.537 +- 0.333 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.489 +- 0.333 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.459 +- 0.196 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.855
Model XAI F1 of binarized graphs for r=0.9 =  0.42468799999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.8221406666666666
len(reference) = 1500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.628
NEC for r=0.9 class 0 = 0.389 +- 0.327 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 1 = 0.38 +- 0.327 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 2 = 0.474 +- 0.327 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all KL = 0.467 +- 0.327 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all L1 = 0.414 +- 0.186 (in-sample avg dev_std = 0.575)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.855
Model XAI F1 of binarized graphs for r=1.0 =  0.3927106666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.8221406666666666
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.639
NEC for r=1.0 class 0 = 0.383 +- 0.325 (in-sample avg dev_std = 0.579)
NEC for r=1.0 class 1 = 0.37 +- 0.325 (in-sample avg dev_std = 0.579)
NEC for r=1.0 class 2 = 0.465 +- 0.325 (in-sample avg dev_std = 0.579)
NEC for r=1.0 all KL = 0.461 +- 0.325 (in-sample avg dev_std = 0.579)
NEC for r=1.0 all L1 = 0.406 +- 0.181 (in-sample avg dev_std = 0.579)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.504, 0.72, 0.853, 1.0], 'all_L1': [0.546, 0.683, 0.772, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.651, 0.849, 1.0], 'all_L1': [0.547, 0.656, 0.791, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.622, 0.839, 1.0], 'all_L1': [0.501, 0.658, 0.798, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.59, 0.8, 0.932, 1.0], 'all_L1': [0.581, 0.714, 0.853, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.632, 0.838, 1.0], 'all_L1': [0.494, 0.68, 0.804, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.587, 0.541, 0.455, 0.453], 'all_L1': [0.552, 0.536, 0.468, 0.467]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.597, 0.504, 0.502], 'all_L1': [0.55, 0.563, 0.505, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.608, 0.631, 0.566, 0.553], 'all_L1': [0.567, 0.571, 0.528, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.484, 0.432, 0.351, 0.346], 'all_L1': [0.503, 0.479, 0.424, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.621, 0.526, 0.517], 'all_L1': [0.598, 0.539, 0.482, 0.47]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.49, 0.717, 0.882, 1.0], 'all_L1': [0.515, 0.604, 0.751, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.713, 0.821, 1.0], 'all_L1': [0.51, 0.603, 0.682, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.659, 0.86, 1.0], 'all_L1': [0.515, 0.616, 0.767, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.843, 0.912, 1.0], 'all_L1': [0.626, 0.711, 0.789, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.492, 0.689, 0.835, 1.0], 'all_L1': [0.577, 0.624, 0.739, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.648, 0.444, 0.347, 0.339], 'all_L1': [0.633, 0.523, 0.463, 0.455]}), defaultdict(<class 'list'>, {'all_KL': [0.679, 0.447, 0.346, 0.336], 'all_L1': [0.638, 0.527, 0.464, 0.456]}), defaultdict(<class 'list'>, {'all_KL': [0.781, 0.531, 0.408, 0.408], 'all_L1': [0.671, 0.545, 0.484, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.335, 0.228, 0.223], 'all_L1': [0.548, 0.436, 0.369, 0.365]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.427, 0.356, 0.352], 'all_L1': [0.606, 0.468, 0.424, 0.421]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.585, 0.798, 0.925, 1.0], 'all_L1': [0.643, 0.762, 0.857, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.621, 0.674, 0.712, 1.0], 'all_L1': [0.589, 0.672, 0.739, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.586, 0.746, 1.0], 'all_L1': [0.598, 0.644, 0.768, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.591, 0.784, 0.926, 1.0], 'all_L1': [0.592, 0.728, 0.857, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.544, 0.661, 0.942, 1.0], 'all_L1': [0.576, 0.683, 0.898, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.65, 0.503, 0.391, 0.387], 'all_L1': [0.583, 0.472, 0.373, 0.368]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.483, 0.457, 0.444], 'all_L1': [0.526, 0.484, 0.441, 0.427]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.532, 0.447, 0.436], 'all_L1': [0.535, 0.484, 0.394, 0.385]}), defaultdict(<class 'list'>, {'all_KL': [0.529, 0.413, 0.366, 0.371], 'all_L1': [0.517, 0.436, 0.394, 0.394]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.489, 0.467, 0.461], 'all_L1': [0.586, 0.459, 0.414, 0.406]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.534 +- 0.032, 0.678 +- 0.021, 0.804 +- 0.027, 1.000 +- 0.000
suff++ class all_KL  =  0.478 +- 0.074, 0.685 +- 0.067, 0.862 +- 0.035, 1.000 +- 0.000
suff++_acc_int  =  0.504 +- 0.041, 0.750 +- 0.014, 0.841 +- 0.014
nec class all_L1  =  0.554 +- 0.031, 0.538 +- 0.032, 0.481 +- 0.035, 0.475 +- 0.035
nec class all_KL  =  0.598 +- 0.071, 0.564 +- 0.073, 0.480 +- 0.074, 0.474 +- 0.072
nec_acc_int  =  0.368 +- 0.021, 0.472 +- 0.023, 0.556 +- 0.025, 0.566 +- 0.025

Eval split val
suff++ class all_L1  =  0.549 +- 0.046, 0.632 +- 0.040, 0.746 +- 0.036, 1.000 +- 0.000
suff++ class all_KL  =  0.494 +- 0.091, 0.724 +- 0.063, 0.862 +- 0.033, 1.000 +- 0.000
suff++_acc_int  =  0.632 +- 0.022, 0.717 +- 0.021, 0.782 +- 0.034
nec class all_L1  =  0.619 +- 0.041, 0.500 +- 0.041, 0.441 +- 0.041, 0.436 +- 0.040
nec class all_KL  =  0.662 +- 0.079, 0.437 +- 0.062, 0.337 +- 0.059, 0.332 +- 0.060
nec_acc_int  =  0.385 +- 0.010, 0.517 +- 0.024, 0.568 +- 0.019, 0.580 +- 0.015

Eval split test
suff++ class all_L1  =  0.600 +- 0.023, 0.698 +- 0.042, 0.824 +- 0.060, 1.000 +- 0.000
suff++ class all_KL  =  0.580 +- 0.027, 0.701 +- 0.080, 0.850 +- 0.100, 1.000 +- 0.000
suff++_acc_int  =  0.620 +- 0.048, 0.765 +- 0.037, 0.823 +- 0.053
nec class all_L1  =  0.549 +- 0.029, 0.467 +- 0.018, 0.403 +- 0.023, 0.396 +- 0.020
nec class all_KL  =  0.576 +- 0.065, 0.484 +- 0.039, 0.426 +- 0.040, 0.420 +- 0.035
nec_acc_int  =  0.395 +- 0.038, 0.555 +- 0.022, 0.623 +- 0.027, 0.634 +- 0.024


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.544 +- 0.006, 0.608 +- 0.006, 0.643 +- 0.014, 0.738 +- 0.018
Faith. Armon (L1)= 		  =  0.542 +- 0.006, 0.599 +- 0.013, 0.601 +- 0.024, 0.644 +- 0.033
Faith. GMean (L1)= 	  =  0.543 +- 0.006, 0.603 +- 0.010, 0.621 +- 0.018, 0.689 +- 0.026
Faith. Aritm (KL)= 		  =  0.538 +- 0.007, 0.625 +- 0.005, 0.671 +- 0.021, 0.737 +- 0.036
Faith. Armon (KL)= 		  =  0.522 +- 0.023, 0.611 +- 0.025, 0.612 +- 0.057, 0.640 +- 0.069
Faith. GMean (KL)= 	  =  0.530 +- 0.014, 0.618 +- 0.015, 0.640 +- 0.040, 0.686 +- 0.054

Eval split val
Faith. Aritm (L1)= 		  =  0.584 +- 0.008, 0.566 +- 0.012, 0.593 +- 0.020, 0.718 +- 0.020
Faith. Armon (L1)= 		  =  0.579 +- 0.010, 0.555 +- 0.016, 0.552 +- 0.031, 0.606 +- 0.040
Faith. GMean (L1)= 	  =  0.581 +- 0.009, 0.560 +- 0.013, 0.572 +- 0.024, 0.659 +- 0.031
Faith. Aritm (KL)= 		  =  0.578 +- 0.010, 0.581 +- 0.013, 0.600 +- 0.023, 0.666 +- 0.030
Faith. Armon (KL)= 		  =  0.554 +- 0.026, 0.539 +- 0.035, 0.480 +- 0.062, 0.495 +- 0.071
Faith. GMean (KL)= 	  =  0.566 +- 0.016, 0.559 +- 0.021, 0.536 +- 0.045, 0.573 +- 0.055

Eval split test
Faith. Aritm (L1)= 		  =  0.574 +- 0.021, 0.582 +- 0.018, 0.613 +- 0.027, 0.698 +- 0.010
Faith. Armon (L1)= 		  =  0.573 +- 0.022, 0.559 +- 0.013, 0.540 +- 0.018, 0.567 +- 0.020
Faith. GMean (L1)= 	  =  0.574 +- 0.022, 0.570 +- 0.015, 0.575 +- 0.020, 0.629 +- 0.016
Faith. Aritm (KL)= 		  =  0.578 +- 0.024, 0.592 +- 0.032, 0.638 +- 0.044, 0.710 +- 0.017
Faith. Armon (KL)= 		  =  0.575 +- 0.026, 0.568 +- 0.026, 0.563 +- 0.033, 0.591 +- 0.035
Faith. GMean (KL)= 	  =  0.576 +- 0.025, 0.580 +- 0.027, 0.599 +- 0.034, 0.647 +- 0.027
Computed for split load_split = id



Completed in  0:35:53.821940  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 11:15:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:15:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3062) +- tensor(0.1605)
F1 for r=0.3 = 0.707
WIoU for r=0.3 = 0.659
F1 for r=0.6 = 0.619
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.477
WIoU for r=0.9 = 0.735
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.735
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1610) +- tensor(0.0468)
F1 for r=0.3 = 0.674
WIoU for r=0.3 = 0.990
F1 for r=0.6 = 0.413
WIoU for r=0.6 = 0.990
F1 for r=0.9 = 0.299
WIoU for r=0.9 = 0.990
F1 for r=1.0 = 0.275
WIoU for r=1.0 = 0.990
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2524) +- tensor(0.0996)
F1 for r=0.3 = 0.784
WIoU for r=0.3 = 0.906
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.957
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.955
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.955


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.7065852
Model XAI WIoU of binarized graphs for r=0.3 =  0.6594264
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.522
SUFF++ for r=0.3 class 0 = 0.566 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 1 = 0.546 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 2 = 0.528 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all KL = 0.507 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all L1 = 0.547 +- 0.198 (in-sample avg dev_std = 0.519)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.618584
Model XAI WIoU of binarized graphs for r=0.6 =  0.7410232
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.756
SUFF++ for r=0.6 class 0 = 0.689 +- 0.248 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 1 = 0.656 +- 0.248 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 2 = 0.678 +- 0.248 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all KL = 0.71 +- 0.248 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all L1 = 0.674 +- 0.202 (in-sample avg dev_std = 0.391)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.47665799999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7347136000000001
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0 = 0.792 +- 0.197 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.197 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 class 2 = 0.794 +- 0.197 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all KL = 0.85 +- 0.197 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.195 (in-sample avg dev_std = 0.264)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  0.6737156
Model XAI WIoU of binarized graphs for r=0.3 =  0.9895688000000001
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.644
SUFF++ for r=0.3 class 0 = 0.468 +- 0.300 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 class 1 = 0.589 +- 0.300 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 class 2 = 0.492 +- 0.300 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 all KL = 0.493 +- 0.300 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.3 all L1 = 0.515 +- 0.156 (in-sample avg dev_std = 0.550)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.4128024
Model XAI WIoU of binarized graphs for r=0.6 =  0.9895696000000002
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.729
SUFF++ for r=0.6 class 0 = 0.609 +- 0.187 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 class 1 = 0.597 +- 0.187 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 class 2 = 0.601 +- 0.187 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 all KL = 0.716 +- 0.187 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 all L1 = 0.602 +- 0.133 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.298616
Model XAI WIoU of binarized graphs for r=0.9 =  0.9895732
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.806
SUFF++ for r=0.9 class 0 = 0.74 +- 0.141 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.141 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.78 +- 0.141 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.881 +- 0.141 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.748 +- 0.152 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.699
Model XAI F1 of binarized graphs for r=0.3 =  0.7836552000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9058560000000001
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.657
SUFF++ for r=0.3 class 0 = 0.625 +- 0.320 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 class 1 = 0.667 +- 0.320 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 class 2 = 0.64 +- 0.320 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 all KL = 0.585 +- 0.320 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.3 all L1 = 0.644 +- 0.205 (in-sample avg dev_std = 0.559)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  0.5669416
Model XAI WIoU of binarized graphs for r=0.6 =  0.9567620000000001
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.828
SUFF++ for r=0.6 class 0 = 0.786 +- 0.186 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.186 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 2 = 0.824 +- 0.186 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all KL = 0.806 +- 0.186 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all L1 = 0.766 +- 0.150 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  0.4250544
Model XAI WIoU of binarized graphs for r=0.9 =  0.9546228000000001
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.876
SUFF++ for r=0.9 class 0 = 0.907 +- 0.117 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1 = 0.797 +- 0.117 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 2 = 0.875 +- 0.117 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.929 +- 0.117 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.859 +- 0.156 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.531
Model XAI F1 of binarized graphs for r=0.3 =  0.7065852
Model XAI WIoU of binarized graphs for r=0.3 =  0.6594264
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.579 +- 0.288 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 1 = 0.508 +- 0.288 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 2 = 0.582 +- 0.288 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all KL = 0.586 +- 0.288 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all L1 = 0.556 +- 0.170 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  0.618584
Model XAI WIoU of binarized graphs for r=0.6 =  0.7410232
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.492
NEC for r=0.6 class 0 = 0.584 +- 0.314 (in-sample avg dev_std = 0.473)
NEC for r=0.6 class 1 = 0.432 +- 0.314 (in-sample avg dev_std = 0.473)
NEC for r=0.6 class 2 = 0.604 +- 0.314 (in-sample avg dev_std = 0.473)
NEC for r=0.6 all KL = 0.542 +- 0.314 (in-sample avg dev_std = 0.473)
NEC for r=0.6 all L1 = 0.539 +- 0.177 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.47665799999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7347136000000001
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.596
NEC for r=0.9 class 0 = 0.505 +- 0.300 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.391 +- 0.300 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.51 +- 0.300 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.455 +- 0.300 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.468 +- 0.168 (in-sample avg dev_std = 0.508)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  0.44712080000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.7346
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.589
NEC for r=1.0 class 0 = 0.503 +- 0.300 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 1 = 0.393 +- 0.300 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 2 = 0.518 +- 0.300 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all KL = 0.457 +- 0.300 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all L1 = 0.471 +- 0.168 (in-sample avg dev_std = 0.507)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  0.6737156
Model XAI WIoU of binarized graphs for r=0.3 =  0.9895688000000001
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.372
NEC for r=0.3 class 0 = 0.677 +- 0.280 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 1 = 0.508 +- 0.280 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 2 = 0.705 +- 0.280 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all KL = 0.645 +- 0.280 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all L1 = 0.631 +- 0.132 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.4128024
Model XAI WIoU of binarized graphs for r=0.6 =  0.9895696000000002
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.532 +- 0.224 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 1 = 0.465 +- 0.224 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 2 = 0.568 +- 0.224 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all KL = 0.443 +- 0.224 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all L1 = 0.522 +- 0.116 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.298616
Model XAI WIoU of binarized graphs for r=0.9 =  0.9895732
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.462 +- 0.193 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 1 = 0.433 +- 0.193 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 2 = 0.505 +- 0.193 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all KL = 0.35 +- 0.193 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all L1 = 0.467 +- 0.112 (in-sample avg dev_std = 0.435)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.88
Model XAI F1 of binarized graphs for r=1.0 =  0.2746664
Model XAI WIoU of binarized graphs for r=1.0 =  0.9895732
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.573
NEC for r=1.0 class 0 = 0.45 +- 0.192 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 1 = 0.431 +- 0.192 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 2 = 0.488 +- 0.192 (in-sample avg dev_std = 0.431)
NEC for r=1.0 all KL = 0.339 +- 0.192 (in-sample avg dev_std = 0.431)
NEC for r=1.0 all L1 = 0.457 +- 0.115 (in-sample avg dev_std = 0.431)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.699
Model XAI F1 of binarized graphs for r=0.3 =  0.7836552000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.9058560000000001
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.651 +- 0.295 (in-sample avg dev_std = 0.475)
NEC for r=0.3 class 1 = 0.484 +- 0.295 (in-sample avg dev_std = 0.475)
NEC for r=0.3 class 2 = 0.616 +- 0.295 (in-sample avg dev_std = 0.475)
NEC for r=0.3 all KL = 0.649 +- 0.295 (in-sample avg dev_std = 0.475)
NEC for r=0.3 all L1 = 0.582 +- 0.149 (in-sample avg dev_std = 0.475)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  0.5669416
Model XAI WIoU of binarized graphs for r=0.6 =  0.9567620000000001
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.552
NEC for r=0.6 class 0 = 0.506 +- 0.355 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 1 = 0.35 +- 0.355 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 2 = 0.537 +- 0.355 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all KL = 0.495 +- 0.355 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all L1 = 0.463 +- 0.207 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  0.4250544
Model XAI WIoU of binarized graphs for r=0.9 =  0.9546228000000001
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.658
NEC for r=0.9 class 0 = 0.409 +- 0.314 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 1 = 0.29 +- 0.314 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 2 = 0.432 +- 0.314 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all KL = 0.396 +- 0.314 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all L1 = 0.376 +- 0.189 (in-sample avg dev_std = 0.522)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.898
Model XAI F1 of binarized graphs for r=1.0 =  0.39298640000000007
Model XAI WIoU of binarized graphs for r=1.0 =  0.9546228000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.671
NEC for r=1.0 class 0 = 0.39 +- 0.312 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 1 = 0.29 +- 0.312 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 2 = 0.423 +- 0.312 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all KL = 0.385 +- 0.312 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all L1 = 0.367 +- 0.187 (in-sample avg dev_std = 0.515)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 11:27:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:27:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3062) +- tensor(0.1605)
F1 for r=0.3 = 0.731
WIoU for r=0.3 = 0.701
F1 for r=0.6 = 0.620
WIoU for r=0.6 = 0.769
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.766
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.766
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1610) +- tensor(0.0468)
F1 for r=0.3 = 0.675
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.413
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.299
WIoU for r=0.9 = 0.995
F1 for r=1.0 = 0.275
WIoU for r=1.0 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2524) +- tensor(0.0996)
F1 for r=0.3 = 0.726
WIoU for r=0.3 = 0.838
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.842
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.790
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.782


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.653
Model XAI F1 of binarized graphs for r=0.3 =  0.7312879999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.700862
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.506
SUFF++ for r=0.3 class 0 = 0.492 +- 0.266 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 1 = 0.648 +- 0.266 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 class 2 = 0.516 +- 0.266 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all KL = 0.497 +- 0.266 (in-sample avg dev_std = 0.523)
SUFF++ for r=0.3 all L1 = 0.552 +- 0.161 (in-sample avg dev_std = 0.523)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  0.619762
Model XAI WIoU of binarized graphs for r=0.6 =  0.7687428
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF++ for r=0.6 class 0 = 0.64 +- 0.253 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1 = 0.655 +- 0.253 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 2 = 0.664 +- 0.253 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.648 +- 0.253 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.653 +- 0.189 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.4764308
Model XAI WIoU of binarized graphs for r=0.9 =  0.765926
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.819
SUFF++ for r=0.9 class 0 = 0.784 +- 0.201 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 1 = 0.8 +- 0.201 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 2 = 0.792 +- 0.201 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all KL = 0.851 +- 0.201 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all L1 = 0.792 +- 0.189 (in-sample avg dev_std = 0.280)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.891
Model XAI F1 of binarized graphs for r=0.3 =  0.6745968
Model XAI WIoU of binarized graphs for r=0.3 =  0.9946596000000001
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.597
SUFF++ for r=0.3 class 0 = 0.436 +- 0.287 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 class 1 = 0.622 +- 0.287 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 class 2 = 0.478 +- 0.287 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 all KL = 0.456 +- 0.287 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 all L1 = 0.511 +- 0.157 (in-sample avg dev_std = 0.587)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.887
Model XAI F1 of binarized graphs for r=0.6 =  0.4133740000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.9946959999999999
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.709
SUFF++ for r=0.6 class 0 = 0.574 +- 0.174 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1 = 0.616 +- 0.174 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 2 = 0.616 +- 0.174 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.711 +- 0.174 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.602 +- 0.115 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  0.29860159999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.9946804
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.744
SUFF++ for r=0.9 class 0 = 0.716 +- 0.175 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 1 = 0.75 +- 0.175 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 2 = 0.583 +- 0.175 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all KL = 0.821 +- 0.175 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all L1 = 0.682 +- 0.161 (in-sample avg dev_std = 0.294)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.572
Model XAI F1 of binarized graphs for r=0.3 =  0.7264944000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8375959999999999
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.594
SUFF++ for r=0.3 class 0 = 0.598 +- 0.230 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 1 = 0.592 +- 0.230 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 2 = 0.579 +- 0.230 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all KL = 0.622 +- 0.230 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all L1 = 0.59 +- 0.175 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.887
Model XAI F1 of binarized graphs for r=0.6 =  0.5668232
Model XAI WIoU of binarized graphs for r=0.6 =  0.8417188
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.783
SUFF++ for r=0.6 class 0 = 0.681 +- 0.252 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 class 1 = 0.631 +- 0.252 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 class 2 = 0.706 +- 0.252 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all KL = 0.674 +- 0.252 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all L1 = 0.672 +- 0.163 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.887
Model XAI F1 of binarized graphs for r=0.9 =  0.42496880000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.7895544
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0 = 0.667 +- 0.374 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 class 1 = 0.673 +- 0.374 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 class 2 = 0.877 +- 0.374 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 all KL = 0.711 +- 0.374 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 all L1 = 0.739 +- 0.276 (in-sample avg dev_std = 0.476)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.7312879999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.700862
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.562 +- 0.281 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 1 = 0.507 +- 0.281 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 2 = 0.577 +- 0.281 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all KL = 0.602 +- 0.281 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all L1 = 0.549 +- 0.153 (in-sample avg dev_std = 0.404)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  0.619762
Model XAI WIoU of binarized graphs for r=0.6 =  0.7687428
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.432
NEC for r=0.6 class 0 = 0.562 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 1 = 0.53 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 2 = 0.607 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all KL = 0.6 +- 0.308 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all L1 = 0.566 +- 0.163 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.4764308
Model XAI WIoU of binarized graphs for r=0.9 =  0.765926
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.496 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.474 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.554 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.506 +- 0.285 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.508 +- 0.161 (in-sample avg dev_std = 0.496)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.889
Model XAI F1 of binarized graphs for r=1.0 =  0.44712080000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.7660416000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.535
NEC for r=1.0 class 0 = 0.499 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=1.0 class 1 = 0.471 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=1.0 class 2 = 0.551 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=1.0 all KL = 0.504 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=1.0 all L1 = 0.507 +- 0.159 (in-sample avg dev_std = 0.497)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.891
Model XAI F1 of binarized graphs for r=0.3 =  0.6745968
Model XAI WIoU of binarized graphs for r=0.3 =  0.9946596000000001
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.659 +- 0.284 (in-sample avg dev_std = 0.441)
NEC for r=0.3 class 1 = 0.503 +- 0.284 (in-sample avg dev_std = 0.441)
NEC for r=0.3 class 2 = 0.735 +- 0.284 (in-sample avg dev_std = 0.441)
NEC for r=0.3 all KL = 0.674 +- 0.284 (in-sample avg dev_std = 0.441)
NEC for r=0.3 all L1 = 0.634 +- 0.147 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.887
Model XAI F1 of binarized graphs for r=0.6 =  0.4133740000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.9946959999999999
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.493
NEC for r=0.6 class 0 = 0.548 +- 0.220 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 1 = 0.473 +- 0.220 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 2 = 0.563 +- 0.220 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all KL = 0.45 +- 0.220 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all L1 = 0.529 +- 0.118 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  0.29860159999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.9946804
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.549
NEC for r=0.9 class 0 = 0.479 +- 0.196 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.44 +- 0.196 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.475 +- 0.196 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.348 +- 0.196 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.465 +- 0.119 (in-sample avg dev_std = 0.445)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  0.2746664
Model XAI WIoU of binarized graphs for r=1.0 =  0.9946779999999998
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.564
NEC for r=1.0 class 0 = 0.474 +- 0.194 (in-sample avg dev_std = 0.444)
NEC for r=1.0 class 1 = 0.423 +- 0.194 (in-sample avg dev_std = 0.444)
NEC for r=1.0 class 2 = 0.475 +- 0.194 (in-sample avg dev_std = 0.444)
NEC for r=1.0 all KL = 0.338 +- 0.194 (in-sample avg dev_std = 0.444)
NEC for r=1.0 all L1 = 0.458 +- 0.118 (in-sample avg dev_std = 0.444)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.57
Model XAI F1 of binarized graphs for r=0.3 =  0.7264944000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8375959999999999
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.444
NEC for r=0.3 class 0 = 0.479 +- 0.220 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 1 = 0.506 +- 0.220 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 2 = 0.57 +- 0.220 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all KL = 0.469 +- 0.220 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all L1 = 0.519 +- 0.129 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.887
Model XAI F1 of binarized graphs for r=0.6 =  0.5668232
Model XAI WIoU of binarized graphs for r=0.6 =  0.8417188
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.527
NEC for r=0.6 class 0 = 0.433 +- 0.348 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 1 = 0.487 +- 0.348 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 2 = 0.524 +- 0.348 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all KL = 0.482 +- 0.348 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all L1 = 0.482 +- 0.200 (in-sample avg dev_std = 0.527)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.887
Model XAI F1 of binarized graphs for r=0.9 =  0.42496880000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.7895544
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.403 +- 0.334 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 1 = 0.459 +- 0.334 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 2 = 0.449 +- 0.334 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all KL = 0.453 +- 0.334 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all L1 = 0.438 +- 0.194 (in-sample avg dev_std = 0.580)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.887
Model XAI F1 of binarized graphs for r=1.0 =  0.39298640000000007
Model XAI WIoU of binarized graphs for r=1.0 =  0.78222
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.605
NEC for r=1.0 class 0 = 0.404 +- 0.330 (in-sample avg dev_std = 0.579)
NEC for r=1.0 class 1 = 0.452 +- 0.330 (in-sample avg dev_std = 0.579)
NEC for r=1.0 class 2 = 0.44 +- 0.330 (in-sample avg dev_std = 0.579)
NEC for r=1.0 all KL = 0.45 +- 0.330 (in-sample avg dev_std = 0.579)
NEC for r=1.0 all L1 = 0.432 +- 0.188 (in-sample avg dev_std = 0.579)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 11:39:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:39:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3062) +- tensor(0.1605)
F1 for r=0.3 = 0.673
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.604
WIoU for r=0.6 = 0.683
F1 for r=0.9 = 0.477
WIoU for r=0.9 = 0.696
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.696
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1610) +- tensor(0.0468)
F1 for r=0.3 = 0.675
WIoU for r=0.3 = 0.993
F1 for r=0.6 = 0.413
WIoU for r=0.6 = 0.993
F1 for r=0.9 = 0.299
WIoU for r=0.9 = 0.993
F1 for r=1.0 = 0.275
WIoU for r=1.0 = 0.993
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2524) +- tensor(0.0996)
F1 for r=0.3 = 0.787
WIoU for r=0.3 = 0.876
F1 for r=0.6 = 0.549
WIoU for r=0.6 = 0.745
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.685
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.683


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.6732739999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5931112
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF++ for r=0.3 class 0 = 0.483 +- 0.259 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 1 = 0.541 +- 0.259 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 2 = 0.459 +- 0.259 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all KL = 0.443 +- 0.259 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all L1 = 0.494 +- 0.157 (in-sample avg dev_std = 0.551)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.845
Model XAI F1 of binarized graphs for r=0.6 =  0.6038324
Model XAI WIoU of binarized graphs for r=0.6 =  0.6832964
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.729
SUFF++ for r=0.6 class 0 = 0.638 +- 0.284 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.658 +- 0.284 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.675 +- 0.284 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.624 +- 0.284 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.657 +- 0.210 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.4765028
Model XAI WIoU of binarized graphs for r=0.9 =  0.6958476
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.847
SUFF++ for r=0.9 class 0 = 0.789 +- 0.202 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 1 = 0.796 +- 0.202 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 2 = 0.813 +- 0.202 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all KL = 0.839 +- 0.202 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.181 (in-sample avg dev_std = 0.255)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.6748831999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.9934776
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.618
SUFF++ for r=0.3 class 0 = 0.485 +- 0.289 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 class 1 = 0.638 +- 0.289 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 class 2 = 0.435 +- 0.289 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 all KL = 0.384 +- 0.289 (in-sample avg dev_std = 0.654)
SUFF++ for r=0.3 all L1 = 0.518 +- 0.170 (in-sample avg dev_std = 0.654)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.4134192
Model XAI WIoU of binarized graphs for r=0.6 =  0.9934776
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.719
SUFF++ for r=0.6 class 0 = 0.585 +- 0.209 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 1 = 0.6 +- 0.209 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 class 2 = 0.645 +- 0.209 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all KL = 0.651 +- 0.209 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.6 all L1 = 0.61 +- 0.139 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.2986344
Model XAI WIoU of binarized graphs for r=0.9 =  0.9934776
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.738 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 1 = 0.742 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 2 = 0.811 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all KL = 0.855 +- 0.196 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all L1 = 0.764 +- 0.160 (in-sample avg dev_std = 0.313)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.786552
Model XAI WIoU of binarized graphs for r=0.3 =  0.876308
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.586
SUFF++ for r=0.3 class 0 = 0.599 +- 0.294 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 class 1 = 0.64 +- 0.294 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 class 2 = 0.55 +- 0.294 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 all KL = 0.553 +- 0.294 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 all L1 = 0.597 +- 0.177 (in-sample avg dev_std = 0.549)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  0.5487416
Model XAI WIoU of binarized graphs for r=0.6 =  0.7447819999999999
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.732
SUFF++ for r=0.6 class 0 = 0.608 +- 0.340 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.340 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 class 2 = 0.641 +- 0.340 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 all KL = 0.59 +- 0.340 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.6 all L1 = 0.647 +- 0.195 (in-sample avg dev_std = 0.577)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  0.4250544
Model XAI WIoU of binarized graphs for r=0.9 =  0.6854496000000001
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0 = 0.671 +- 0.311 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 1 = 0.714 +- 0.311 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 2 = 0.905 +- 0.311 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 all KL = 0.741 +- 0.311 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 all L1 = 0.764 +- 0.289 (in-sample avg dev_std = 0.300)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.52
Model XAI F1 of binarized graphs for r=0.3 =  0.6732739999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5931112
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.592 +- 0.280 (in-sample avg dev_std = 0.459)
NEC for r=0.3 class 1 = 0.532 +- 0.280 (in-sample avg dev_std = 0.459)
NEC for r=0.3 class 2 = 0.584 +- 0.280 (in-sample avg dev_std = 0.459)
NEC for r=0.3 all KL = 0.606 +- 0.280 (in-sample avg dev_std = 0.459)
NEC for r=0.3 all L1 = 0.569 +- 0.163 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.845
Model XAI F1 of binarized graphs for r=0.6 =  0.6038324
Model XAI WIoU of binarized graphs for r=0.6 =  0.6832964
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.449
NEC for r=0.6 class 0 = 0.573 +- 0.281 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 1 = 0.514 +- 0.281 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 2 = 0.627 +- 0.281 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.629 +- 0.281 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.571 +- 0.165 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.4765028
Model XAI WIoU of binarized graphs for r=0.9 =  0.6958476
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.526
NEC for r=0.9 class 0 = 0.539 +- 0.291 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.476 +- 0.291 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.579 +- 0.291 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.57 +- 0.291 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.531 +- 0.163 (in-sample avg dev_std = 0.576)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.914
Model XAI F1 of binarized graphs for r=1.0 =  0.44712080000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.6958724000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.547
NEC for r=1.0 class 0 = 0.525 +- 0.285 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 1 = 0.473 +- 0.285 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 2 = 0.552 +- 0.285 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all KL = 0.552 +- 0.285 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all L1 = 0.517 +- 0.162 (in-sample avg dev_std = 0.572)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.6748831999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.9934776
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.382
NEC for r=0.3 class 0 = 0.669 +- 0.219 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.568 +- 0.219 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.766 +- 0.219 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.778 +- 0.219 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.669 +- 0.125 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.4134192
Model XAI WIoU of binarized graphs for r=0.6 =  0.9934776
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.518
NEC for r=0.6 class 0 = 0.541 +- 0.241 (in-sample avg dev_std = 0.568)
NEC for r=0.6 class 1 = 0.476 +- 0.241 (in-sample avg dev_std = 0.568)
NEC for r=0.6 class 2 = 0.62 +- 0.241 (in-sample avg dev_std = 0.568)
NEC for r=0.6 all KL = 0.534 +- 0.241 (in-sample avg dev_std = 0.568)
NEC for r=0.6 all L1 = 0.547 +- 0.132 (in-sample avg dev_std = 0.568)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.2986344
Model XAI WIoU of binarized graphs for r=0.9 =  0.9934776
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.565
NEC for r=0.9 class 0 = 0.47 +- 0.211 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 1 = 0.471 +- 0.211 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 2 = 0.517 +- 0.211 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all KL = 0.413 +- 0.211 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all L1 = 0.486 +- 0.122 (in-sample avg dev_std = 0.523)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.2746664
Model XAI WIoU of binarized graphs for r=1.0 =  0.9934776
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.467 +- 0.210 (in-sample avg dev_std = 0.526)
NEC for r=1.0 class 1 = 0.479 +- 0.210 (in-sample avg dev_std = 0.526)
NEC for r=1.0 class 2 = 0.502 +- 0.210 (in-sample avg dev_std = 0.526)
NEC for r=1.0 all KL = 0.411 +- 0.210 (in-sample avg dev_std = 0.526)
NEC for r=1.0 all L1 = 0.483 +- 0.122 (in-sample avg dev_std = 0.526)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.786552
Model XAI WIoU of binarized graphs for r=0.3 =  0.876308
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.543 +- 0.271 (in-sample avg dev_std = 0.552)
NEC for r=0.3 class 1 = 0.443 +- 0.271 (in-sample avg dev_std = 0.552)
NEC for r=0.3 class 2 = 0.612 +- 0.271 (in-sample avg dev_std = 0.552)
NEC for r=0.3 all KL = 0.584 +- 0.271 (in-sample avg dev_std = 0.552)
NEC for r=0.3 all L1 = 0.532 +- 0.133 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.868
Model XAI F1 of binarized graphs for r=0.6 =  0.5487416
Model XAI WIoU of binarized graphs for r=0.6 =  0.7447819999999999
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.573
NEC for r=0.6 class 0 = 0.414 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 1 = 0.497 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 2 = 0.543 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all KL = 0.534 +- 0.357 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all L1 = 0.486 +- 0.232 (in-sample avg dev_std = 0.595)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  0.4250544
Model XAI WIoU of binarized graphs for r=0.9 =  0.6854496000000001
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.641
NEC for r=0.9 class 0 = 0.409 +- 0.308 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 1 = 0.423 +- 0.308 (in-sample avg dev_std = 0.530)
NEC for r=0.9 class 2 = 0.338 +- 0.308 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all KL = 0.44 +- 0.308 (in-sample avg dev_std = 0.530)
NEC for r=0.9 all L1 = 0.39 +- 0.200 (in-sample avg dev_std = 0.530)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.708
Model XAI F1 of binarized graphs for r=1.0 =  0.39298640000000007
Model XAI WIoU of binarized graphs for r=1.0 =  0.6826228000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.644
NEC for r=1.0 class 0 = 0.403 +- 0.299 (in-sample avg dev_std = 0.524)
NEC for r=1.0 class 1 = 0.443 +- 0.299 (in-sample avg dev_std = 0.524)
NEC for r=1.0 class 2 = 0.315 +- 0.299 (in-sample avg dev_std = 0.524)
NEC for r=1.0 all KL = 0.436 +- 0.299 (in-sample avg dev_std = 0.524)
NEC for r=1.0 all L1 = 0.387 +- 0.205 (in-sample avg dev_std = 0.524)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 11:51:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 11:51:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3062) +- tensor(0.1605)
F1 for r=0.3 = 0.745
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.610
WIoU for r=0.6 = 0.900
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.903
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.903
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1610) +- tensor(0.0468)
F1 for r=0.3 = 0.674
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.413
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.299
WIoU for r=0.9 = 0.996
F1 for r=1.0 = 0.275
WIoU for r=1.0 = 0.996
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2524) +- tensor(0.0996)
F1 for r=0.3 = 0.757
WIoU for r=0.3 = 0.850
F1 for r=0.6 = 0.558
WIoU for r=0.6 = 0.847
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.847
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.847


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.74484
Model XAI WIoU of binarized graphs for r=0.3 =  0.8411124
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.517
SUFF++ for r=0.3 class 0 = 0.529 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1 = 0.657 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 2 = 0.541 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.586 +- 0.291 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.576 +- 0.160 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.885
Model XAI F1 of binarized graphs for r=0.6 =  0.6095828
Model XAI WIoU of binarized graphs for r=0.6 =  0.8999527999999999
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.742
SUFF++ for r=0.6 class 0 = 0.625 +- 0.198 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 class 1 = 0.744 +- 0.198 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 class 2 = 0.76 +- 0.198 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 all KL = 0.795 +- 0.198 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 all L1 = 0.71 +- 0.176 (in-sample avg dev_std = 0.319)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.47583000000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.9032236000000001
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.847
SUFF++ for r=0.9 class 0 = 0.824 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 class 1 = 0.847 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 all KL = 0.93 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.9 all L1 = 0.85 +- 0.142 (in-sample avg dev_std = 0.191)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.903
Model XAI F1 of binarized graphs for r=0.3 =  0.673964
Model XAI WIoU of binarized graphs for r=0.3 =  0.9956263999999999
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.645
SUFF++ for r=0.3 class 0 = 0.541 +- 0.289 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 class 1 = 0.69 +- 0.289 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 class 2 = 0.65 +- 0.289 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 all KL = 0.658 +- 0.289 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.3 all L1 = 0.627 +- 0.190 (in-sample avg dev_std = 0.427)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.872
Model XAI F1 of binarized graphs for r=0.6 =  0.4134192
Model XAI WIoU of binarized graphs for r=0.6 =  0.9956252
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.748
SUFF++ for r=0.6 class 0 = 0.681 +- 0.148 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.6 class 1 = 0.712 +- 0.148 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.6 class 2 = 0.729 +- 0.148 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.6 all KL = 0.84 +- 0.148 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.6 all L1 = 0.707 +- 0.125 (in-sample avg dev_std = 0.289)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  0.2986344
Model XAI WIoU of binarized graphs for r=0.9 =  0.9956252
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.778
SUFF++ for r=0.9 class 0 = 0.746 +- 0.115 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 1 = 0.77 +- 0.115 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 class 2 = 0.84 +- 0.115 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 all KL = 0.91 +- 0.115 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.9 all L1 = 0.786 +- 0.122 (in-sample avg dev_std = 0.244)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.754
Model XAI F1 of binarized graphs for r=0.3 =  0.7572584000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8496140000000001
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.548
SUFF++ for r=0.3 class 0 = 0.518 +- 0.313 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.663 +- 0.313 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.589 +- 0.313 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.588 +- 0.313 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.176 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.903
Model XAI F1 of binarized graphs for r=0.6 =  0.5578416
Model XAI WIoU of binarized graphs for r=0.6 =  0.8468184
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.725
SUFF++ for r=0.6 class 0 = 0.578 +- 0.213 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 1 = 0.792 +- 0.213 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 2 = 0.806 +- 0.213 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all KL = 0.782 +- 0.213 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all L1 = 0.727 +- 0.182 (in-sample avg dev_std = 0.372)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.903
Model XAI F1 of binarized graphs for r=0.9 =  0.4250544
Model XAI WIoU of binarized graphs for r=0.9 =  0.8468184
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.813
SUFF++ for r=0.9 class 0 = 0.776 +- 0.093 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 1 = 0.858 +- 0.093 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 2 = 0.935 +- 0.093 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all KL = 0.927 +- 0.093 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.147 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.662
Model XAI F1 of binarized graphs for r=0.3 =  0.74484
Model XAI WIoU of binarized graphs for r=0.3 =  0.8411124
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.353
NEC for r=0.3 class 0 = 0.463 +- 0.340 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 1 = 0.464 +- 0.340 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 2 = 0.582 +- 0.340 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all KL = 0.481 +- 0.340 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all L1 = 0.502 +- 0.176 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.885
Model XAI F1 of binarized graphs for r=0.6 =  0.6095828
Model XAI WIoU of binarized graphs for r=0.6 =  0.8999527999999999
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.463
NEC for r=0.6 class 0 = 0.421 +- 0.306 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 1 = 0.441 +- 0.306 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 2 = 0.592 +- 0.306 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all KL = 0.434 +- 0.306 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all L1 = 0.484 +- 0.174 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.47583000000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.9032236000000001
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.373 +- 0.295 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 1 = 0.372 +- 0.295 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 2 = 0.526 +- 0.295 (in-sample avg dev_std = 0.455)
NEC for r=0.9 all KL = 0.349 +- 0.295 (in-sample avg dev_std = 0.455)
NEC for r=0.9 all L1 = 0.423 +- 0.173 (in-sample avg dev_std = 0.455)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  0.44712080000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.9032236000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.552
NEC for r=1.0 class 0 = 0.374 +- 0.291 (in-sample avg dev_std = 0.458)
NEC for r=1.0 class 1 = 0.371 +- 0.291 (in-sample avg dev_std = 0.458)
NEC for r=1.0 class 2 = 0.513 +- 0.291 (in-sample avg dev_std = 0.458)
NEC for r=1.0 all KL = 0.345 +- 0.291 (in-sample avg dev_std = 0.458)
NEC for r=1.0 all L1 = 0.419 +- 0.168 (in-sample avg dev_std = 0.458)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.904
Model XAI F1 of binarized graphs for r=0.3 =  0.673964
Model XAI WIoU of binarized graphs for r=0.3 =  0.9956263999999999
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.396
NEC for r=0.3 class 0 = 0.443 +- 0.336 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 1 = 0.469 +- 0.336 (in-sample avg dev_std = 0.392)
NEC for r=0.3 class 2 = 0.716 +- 0.336 (in-sample avg dev_std = 0.392)
NEC for r=0.3 all KL = 0.527 +- 0.336 (in-sample avg dev_std = 0.392)
NEC for r=0.3 all L1 = 0.544 +- 0.192 (in-sample avg dev_std = 0.392)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.872
Model XAI F1 of binarized graphs for r=0.6 =  0.4134192
Model XAI WIoU of binarized graphs for r=0.6 =  0.9956252
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.517
NEC for r=0.6 class 0 = 0.382 +- 0.263 (in-sample avg dev_std = 0.429)
NEC for r=0.6 class 1 = 0.354 +- 0.263 (in-sample avg dev_std = 0.429)
NEC for r=0.6 class 2 = 0.571 +- 0.263 (in-sample avg dev_std = 0.429)
NEC for r=0.6 all KL = 0.333 +- 0.263 (in-sample avg dev_std = 0.429)
NEC for r=0.6 all L1 = 0.437 +- 0.163 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  0.2986344
Model XAI WIoU of binarized graphs for r=0.9 =  0.9956252
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.591
NEC for r=0.9 class 0 = 0.329 +- 0.197 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 1 = 0.31 +- 0.197 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 2 = 0.462 +- 0.197 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all KL = 0.227 +- 0.197 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all L1 = 0.368 +- 0.143 (in-sample avg dev_std = 0.379)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.85
Model XAI F1 of binarized graphs for r=1.0 =  0.2746664
Model XAI WIoU of binarized graphs for r=1.0 =  0.9956252
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.596
NEC for r=1.0 class 0 = 0.338 +- 0.188 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 1 = 0.321 +- 0.188 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 2 = 0.44 +- 0.188 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all KL = 0.225 +- 0.188 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all L1 = 0.367 +- 0.135 (in-sample avg dev_std = 0.382)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.754
Model XAI F1 of binarized graphs for r=0.3 =  0.7572584000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8496140000000001
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.49 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 1 = 0.481 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 2 = 0.59 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all KL = 0.536 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all L1 = 0.521 +- 0.155 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.903
Model XAI F1 of binarized graphs for r=0.6 =  0.5578416
Model XAI WIoU of binarized graphs for r=0.6 =  0.8468184
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.536
NEC for r=0.6 class 0 = 0.366 +- 0.345 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 1 = 0.414 +- 0.345 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 2 = 0.54 +- 0.345 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all KL = 0.418 +- 0.345 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all L1 = 0.441 +- 0.203 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.903
Model XAI F1 of binarized graphs for r=0.9 =  0.4250544
Model XAI WIoU of binarized graphs for r=0.9 =  0.8468184
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.602
NEC for r=0.9 class 0 = 0.355 +- 0.307 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.362 +- 0.307 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.465 +- 0.307 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.369 +- 0.307 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.394 +- 0.183 (in-sample avg dev_std = 0.508)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.903
Model XAI F1 of binarized graphs for r=1.0 =  0.39298640000000007
Model XAI WIoU of binarized graphs for r=1.0 =  0.8468184
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.365 +- 0.304 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 1 = 0.363 +- 0.304 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 2 = 0.454 +- 0.304 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all KL = 0.37 +- 0.304 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all L1 = 0.394 +- 0.181 (in-sample avg dev_std = 0.516)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:03:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:03:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3062) +- tensor(0.1605)
F1 for r=0.3 = 0.706
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.606
WIoU for r=0.6 = 0.720
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.713
F1 for r=1.0 = 0.447
WIoU for r=1.0 = 0.713
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1610) +- tensor(0.0468)
F1 for r=0.3 = 0.671
WIoU for r=0.3 = 0.931
F1 for r=0.6 = 0.413
WIoU for r=0.6 = 0.929
F1 for r=0.9 = 0.299
WIoU for r=0.9 = 0.929
F1 for r=1.0 = 0.275
WIoU for r=1.0 = 0.929
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2524) +- tensor(0.0996)
F1 for r=0.3 = 0.773
WIoU for r=0.3 = 0.897
F1 for r=0.6 = 0.549
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.425
WIoU for r=0.9 = 0.822
F1 for r=1.0 = 0.393
WIoU for r=1.0 = 0.822


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  0.7056004
Model XAI WIoU of binarized graphs for r=0.3 =  0.6557248
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.541
SUFF++ for r=0.3 class 0 = 0.466 +- 0.300 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 class 1 = 0.538 +- 0.300 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 class 2 = 0.487 +- 0.300 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 all KL = 0.367 +- 0.300 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 all L1 = 0.497 +- 0.188 (in-sample avg dev_std = 0.603)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.6059644000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7196172
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.759
SUFF++ for r=0.6 class 0 = 0.601 +- 0.303 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 1 = 0.702 +- 0.303 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 2 = 0.714 +- 0.303 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all KL = 0.626 +- 0.303 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all L1 = 0.672 +- 0.219 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  0.4762076
Model XAI WIoU of binarized graphs for r=0.9 =  0.7133976000000001
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.841
SUFF++ for r=0.9 class 0 = 0.741 +- 0.238 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 1 = 0.81 +- 0.238 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 2 = 0.844 +- 0.238 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all KL = 0.832 +- 0.238 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.200 (in-sample avg dev_std = 0.287)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  0.6708288
Model XAI WIoU of binarized graphs for r=0.3 =  0.9314636000000001
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.65
SUFF++ for r=0.3 class 0 = 0.51 +- 0.307 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 1 = 0.623 +- 0.307 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 2 = 0.585 +- 0.307 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all KL = 0.482 +- 0.307 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all L1 = 0.572 +- 0.182 (in-sample avg dev_std = 0.588)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  0.4129544
Model XAI WIoU of binarized graphs for r=0.6 =  0.9287164000000001
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.688
SUFF++ for r=0.6 class 0 = 0.6 +- 0.232 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1 = 0.62 +- 0.232 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 2 = 0.65 +- 0.232 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.69 +- 0.232 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.623 +- 0.161 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  0.2985988
Model XAI WIoU of binarized graphs for r=0.9 =  0.9287164000000001
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.754
SUFF++ for r=0.9 class 0 = 0.724 +- 0.198 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 class 1 = 0.696 +- 0.198 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 class 2 = 0.8 +- 0.198 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 all KL = 0.838 +- 0.198 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 all L1 = 0.741 +- 0.173 (in-sample avg dev_std = 0.309)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.86
Model XAI F1 of binarized graphs for r=0.3 =  0.7733512
Model XAI WIoU of binarized graphs for r=0.3 =  0.8971508000000001
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.695
SUFF++ for r=0.3 class 0 = 0.557 +- 0.316 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 1 = 0.649 +- 0.316 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 2 = 0.536 +- 0.316 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all KL = 0.548 +- 0.316 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all L1 = 0.582 +- 0.219 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.5486824
Model XAI WIoU of binarized graphs for r=0.6 =  0.8453296
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0 = 0.605 +- 0.299 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 1 = 0.759 +- 0.299 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 class 2 = 0.707 +- 0.299 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 all KL = 0.668 +- 0.299 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.6 all L1 = 0.692 +- 0.179 (in-sample avg dev_std = 0.487)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  0.4250116
Model XAI WIoU of binarized graphs for r=0.9 =  0.8224495999999999
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF++ for r=0.9 class 0 = 0.839 +- 0.113 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 1 = 0.936 +- 0.113 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 2 = 0.93 +- 0.113 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all KL = 0.947 +- 0.113 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.139 (in-sample avg dev_std = 0.211)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.561
Model XAI F1 of binarized graphs for r=0.3 =  0.7056004
Model XAI WIoU of binarized graphs for r=0.3 =  0.6557248
len(reference) = 2500
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.403
NEC for r=0.3 class 0 = 0.596 +- 0.301 (in-sample avg dev_std = 0.554)
NEC for r=0.3 class 1 = 0.53 +- 0.301 (in-sample avg dev_std = 0.554)
NEC for r=0.3 class 2 = 0.664 +- 0.301 (in-sample avg dev_std = 0.554)
NEC for r=0.3 all KL = 0.704 +- 0.301 (in-sample avg dev_std = 0.554)
NEC for r=0.3 all L1 = 0.596 +- 0.165 (in-sample avg dev_std = 0.554)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  0.6059644000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7196172
len(reference) = 2500
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.496
NEC for r=0.6 class 0 = 0.514 +- 0.316 (in-sample avg dev_std = 0.560)
NEC for r=0.6 class 1 = 0.477 +- 0.316 (in-sample avg dev_std = 0.560)
NEC for r=0.6 class 2 = 0.624 +- 0.316 (in-sample avg dev_std = 0.560)
NEC for r=0.6 all KL = 0.619 +- 0.316 (in-sample avg dev_std = 0.560)
NEC for r=0.6 all L1 = 0.538 +- 0.169 (in-sample avg dev_std = 0.560)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.89
Model XAI F1 of binarized graphs for r=0.9 =  0.4762076
Model XAI WIoU of binarized graphs for r=0.9 =  0.7133976000000001
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.572
NEC for r=0.9 class 0 = 0.464 +- 0.309 (in-sample avg dev_std = 0.562)
NEC for r=0.9 class 1 = 0.43 +- 0.309 (in-sample avg dev_std = 0.562)
NEC for r=0.9 class 2 = 0.552 +- 0.309 (in-sample avg dev_std = 0.562)
NEC for r=0.9 all KL = 0.524 +- 0.309 (in-sample avg dev_std = 0.562)
NEC for r=0.9 all L1 = 0.481 +- 0.165 (in-sample avg dev_std = 0.562)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.89
Model XAI F1 of binarized graphs for r=1.0 =  0.44712080000000004
Model XAI WIoU of binarized graphs for r=1.0 =  0.7132208000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.578
NEC for r=1.0 class 0 = 0.454 +- 0.307 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 1 = 0.429 +- 0.307 (in-sample avg dev_std = 0.565)
NEC for r=1.0 class 2 = 0.541 +- 0.307 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all KL = 0.519 +- 0.307 (in-sample avg dev_std = 0.565)
NEC for r=1.0 all L1 = 0.474 +- 0.162 (in-sample avg dev_std = 0.565)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.877
Model XAI F1 of binarized graphs for r=0.3 =  0.6708288
Model XAI WIoU of binarized graphs for r=0.3 =  0.9314636000000001
len(reference) = 2500
Effective ratio: 0.307 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.402
NEC for r=0.3 class 0 = 0.577 +- 0.303 (in-sample avg dev_std = 0.476)
NEC for r=0.3 class 1 = 0.533 +- 0.303 (in-sample avg dev_std = 0.476)
NEC for r=0.3 class 2 = 0.71 +- 0.303 (in-sample avg dev_std = 0.476)
NEC for r=0.3 all KL = 0.669 +- 0.303 (in-sample avg dev_std = 0.476)
NEC for r=0.3 all L1 = 0.608 +- 0.150 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.4129544
Model XAI WIoU of binarized graphs for r=0.6 =  0.9287164000000001
len(reference) = 2500
Effective ratio: 0.607 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.558
NEC for r=0.6 class 0 = 0.439 +- 0.284 (in-sample avg dev_std = 0.502)
NEC for r=0.6 class 1 = 0.413 +- 0.284 (in-sample avg dev_std = 0.502)
NEC for r=0.6 class 2 = 0.562 +- 0.284 (in-sample avg dev_std = 0.502)
NEC for r=0.6 all KL = 0.431 +- 0.284 (in-sample avg dev_std = 0.502)
NEC for r=0.6 all L1 = 0.472 +- 0.146 (in-sample avg dev_std = 0.502)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  0.2985988
Model XAI WIoU of binarized graphs for r=0.9 =  0.9287164000000001
len(reference) = 2500
Effective ratio: 0.906 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.404 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=0.9 class 1 = 0.389 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=0.9 class 2 = 0.478 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=0.9 all KL = 0.358 +- 0.244 (in-sample avg dev_std = 0.493)
NEC for r=0.9 all L1 = 0.424 +- 0.128 (in-sample avg dev_std = 0.493)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.898
Model XAI F1 of binarized graphs for r=1.0 =  0.2746664
Model XAI WIoU of binarized graphs for r=1.0 =  0.9287164000000001
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.612
NEC for r=1.0 class 0 = 0.402 +- 0.244 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 1 = 0.391 +- 0.244 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 2 = 0.471 +- 0.244 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all KL = 0.354 +- 0.244 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all L1 = 0.422 +- 0.130 (in-sample avg dev_std = 0.486)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.86
Model XAI F1 of binarized graphs for r=0.3 =  0.7733512
Model XAI WIoU of binarized graphs for r=0.3 =  0.8971508000000001
len(reference) = 2500
Effective ratio: 0.305 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.424
NEC for r=0.3 class 0 = 0.597 +- 0.281 (in-sample avg dev_std = 0.520)
NEC for r=0.3 class 1 = 0.534 +- 0.281 (in-sample avg dev_std = 0.520)
NEC for r=0.3 class 2 = 0.641 +- 0.281 (in-sample avg dev_std = 0.520)
NEC for r=0.3 all KL = 0.646 +- 0.281 (in-sample avg dev_std = 0.520)
NEC for r=0.3 all L1 = 0.59 +- 0.136 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.5486824
Model XAI WIoU of binarized graphs for r=0.6 =  0.8453296
len(reference) = 2500
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.59
NEC for r=0.6 class 0 = 0.427 +- 0.334 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.411 +- 0.334 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.537 +- 0.334 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.495 +- 0.334 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.458 +- 0.196 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  0.4250116
Model XAI WIoU of binarized graphs for r=0.9 =  0.8224495999999999
len(reference) = 2500
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.645
NEC for r=0.9 class 0 = 0.381 +- 0.327 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.366 +- 0.327 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.467 +- 0.327 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.46 +- 0.327 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.405 +- 0.187 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.863
Model XAI F1 of binarized graphs for r=1.0 =  0.39298640000000007
Model XAI WIoU of binarized graphs for r=1.0 =  0.8224495999999999
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.646
NEC for r=1.0 class 0 = 0.381 +- 0.326 (in-sample avg dev_std = 0.580)
NEC for r=1.0 class 1 = 0.363 +- 0.326 (in-sample avg dev_std = 0.580)
NEC for r=1.0 class 2 = 0.459 +- 0.326 (in-sample avg dev_std = 0.580)
NEC for r=1.0 all KL = 0.459 +- 0.326 (in-sample avg dev_std = 0.580)
NEC for r=1.0 all L1 = 0.401 +- 0.184 (in-sample avg dev_std = 0.580)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.507, 0.71, 0.85, 1.0], 'all_L1': [0.547, 0.674, 0.77, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.648, 0.851, 1.0], 'all_L1': [0.552, 0.653, 0.792, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.443, 0.624, 0.839, 1.0], 'all_L1': [0.494, 0.657, 0.799, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.795, 0.93, 1.0], 'all_L1': [0.576, 0.71, 0.85, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.367, 0.626, 0.832, 1.0], 'all_L1': [0.497, 0.672, 0.798, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.586, 0.542, 0.455, 0.457], 'all_L1': [0.556, 0.539, 0.468, 0.471]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.6, 0.506, 0.504], 'all_L1': [0.549, 0.566, 0.508, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.606, 0.629, 0.57, 0.552], 'all_L1': [0.569, 0.571, 0.531, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.434, 0.349, 0.345], 'all_L1': [0.502, 0.484, 0.423, 0.419]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.619, 0.524, 0.519], 'all_L1': [0.596, 0.538, 0.481, 0.474]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.493, 0.716, 0.881, 1.0], 'all_L1': [0.515, 0.602, 0.748, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.711, 0.821, 1.0], 'all_L1': [0.511, 0.602, 0.682, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.651, 0.855, 1.0], 'all_L1': [0.518, 0.61, 0.764, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.84, 0.91, 1.0], 'all_L1': [0.627, 0.707, 0.786, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.69, 0.838, 1.0], 'all_L1': [0.572, 0.623, 0.741, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.645, 0.443, 0.35, 0.339], 'all_L1': [0.631, 0.522, 0.467, 0.457]}), defaultdict(<class 'list'>, {'all_KL': [0.674, 0.45, 0.348, 0.338], 'all_L1': [0.634, 0.529, 0.465, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.778, 0.534, 0.413, 0.411], 'all_L1': [0.669, 0.547, 0.486, 0.483]}), defaultdict(<class 'list'>, {'all_KL': [0.527, 0.333, 0.227, 0.225], 'all_L1': [0.544, 0.437, 0.368, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.431, 0.358, 0.354], 'all_L1': [0.608, 0.472, 0.424, 0.422]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.585, 0.806, 0.929, 1.0], 'all_L1': [0.644, 0.766, 0.859, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.674, 0.711, 1.0], 'all_L1': [0.59, 0.672, 0.739, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.59, 0.741, 1.0], 'all_L1': [0.597, 0.647, 0.764, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.588, 0.782, 0.927, 1.0], 'all_L1': [0.592, 0.727, 0.857, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.668, 0.947, 1.0], 'all_L1': [0.582, 0.692, 0.903, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.649, 0.495, 0.396, 0.385], 'all_L1': [0.582, 0.463, 0.376, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.469, 0.482, 0.453, 0.45], 'all_L1': [0.519, 0.482, 0.438, 0.432]}), defaultdict(<class 'list'>, {'all_KL': [0.584, 0.534, 0.44, 0.436], 'all_L1': [0.532, 0.486, 0.39, 0.387]}), defaultdict(<class 'list'>, {'all_KL': [0.536, 0.418, 0.369, 0.37], 'all_L1': [0.521, 0.441, 0.394, 0.394]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.495, 0.46, 0.459], 'all_L1': [0.59, 0.458, 0.405, 0.401]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.533 +- 0.032, 0.673 +- 0.020, 0.802 +- 0.026, 1.000 +- 0.000
suff++ class all_KL  =  0.480 +- 0.073, 0.681 +- 0.065, 0.860 +- 0.036, 1.000 +- 0.000
suff++_acc_int  =  0.499 +- 0.045, 0.741 +- 0.015, 0.834 +- 0.014
nec class all_L1  =  0.554 +- 0.031, 0.540 +- 0.031, 0.482 +- 0.037, 0.478 +- 0.034
nec class all_KL  =  0.596 +- 0.071, 0.565 +- 0.072, 0.481 +- 0.075, 0.475 +- 0.072
nec_acc_int  =  0.368 +- 0.021, 0.467 +- 0.025, 0.553 +- 0.027, 0.560 +- 0.020

Eval split val
suff++ class all_L1  =  0.549 +- 0.045, 0.629 +- 0.040, 0.744 +- 0.035, 1.000 +- 0.000
suff++ class all_KL  =  0.495 +- 0.090, 0.722 +- 0.063, 0.861 +- 0.032, 1.000 +- 0.000
suff++_acc_int  =  0.631 +- 0.020, 0.718 +- 0.020, 0.784 +- 0.034
nec class all_L1  =  0.617 +- 0.041, 0.501 +- 0.041, 0.442 +- 0.042, 0.437 +- 0.040
nec class all_KL  =  0.659 +- 0.080, 0.438 +- 0.064, 0.339 +- 0.061, 0.333 +- 0.060
nec_acc_int  =  0.386 +- 0.012, 0.516 +- 0.023, 0.572 +- 0.025, 0.583 +- 0.018

Eval split test
suff++ class all_L1  =  0.601 +- 0.022, 0.701 +- 0.042, 0.824 +- 0.062, 1.000 +- 0.000
suff++ class all_KL  =  0.579 +- 0.027, 0.704 +- 0.080, 0.851 +- 0.103, 1.000 +- 0.000
suff++_acc_int  =  0.616 +- 0.053, 0.769 +- 0.037, 0.825 +- 0.054
nec class all_L1  =  0.549 +- 0.031, 0.466 +- 0.016, 0.401 +- 0.021, 0.396 +- 0.021
nec class all_KL  =  0.577 +- 0.068, 0.485 +- 0.038, 0.424 +- 0.035, 0.420 +- 0.036
nec_acc_int  =  0.394 +- 0.038, 0.555 +- 0.023, 0.628 +- 0.026, 0.635 +- 0.025


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.544 +- 0.008, 0.606 +- 0.006, 0.642 +- 0.015, 0.739 +- 0.017
Faith. Armon (L1)= 		  =  0.542 +- 0.009, 0.598 +- 0.012, 0.601 +- 0.026, 0.646 +- 0.032
Faith. GMean (L1)= 	  =  0.543 +- 0.008, 0.602 +- 0.009, 0.621 +- 0.020, 0.691 +- 0.025
Faith. Aritm (KL)= 		  =  0.538 +- 0.009, 0.623 +- 0.004, 0.671 +- 0.023, 0.738 +- 0.036
Faith. Armon (KL)= 		  =  0.522 +- 0.023, 0.610 +- 0.024, 0.611 +- 0.059, 0.641 +- 0.070
Faith. GMean (KL)= 	  =  0.530 +- 0.015, 0.616 +- 0.014, 0.640 +- 0.041, 0.687 +- 0.054

Eval split val
Faith. Aritm (L1)= 		  =  0.583 +- 0.009, 0.565 +- 0.010, 0.593 +- 0.020, 0.719 +- 0.020
Faith. Armon (L1)= 		  =  0.578 +- 0.009, 0.555 +- 0.015, 0.553 +- 0.032, 0.607 +- 0.040
Faith. GMean (L1)= 	  =  0.580 +- 0.009, 0.560 +- 0.012, 0.572 +- 0.025, 0.661 +- 0.031
Faith. Aritm (KL)= 		  =  0.577 +- 0.010, 0.580 +- 0.011, 0.600 +- 0.023, 0.667 +- 0.030
Faith. Armon (KL)= 		  =  0.553 +- 0.023, 0.539 +- 0.036, 0.482 +- 0.064, 0.497 +- 0.071
Faith. GMean (KL)= 	  =  0.564 +- 0.014, 0.559 +- 0.020, 0.537 +- 0.046, 0.575 +- 0.055

Eval split test
Faith. Aritm (L1)= 		  =  0.575 +- 0.022, 0.583 +- 0.017, 0.613 +- 0.027, 0.698 +- 0.011
Faith. Armon (L1)= 		  =  0.573 +- 0.023, 0.559 +- 0.010, 0.538 +- 0.016, 0.567 +- 0.022
Faith. GMean (L1)= 	  =  0.574 +- 0.022, 0.571 +- 0.013, 0.574 +- 0.019, 0.629 +- 0.017
Faith. Aritm (KL)= 		  =  0.578 +- 0.026, 0.594 +- 0.031, 0.637 +- 0.046, 0.710 +- 0.018
Faith. Armon (KL)= 		  =  0.574 +- 0.028, 0.570 +- 0.023, 0.562 +- 0.031, 0.591 +- 0.036
Faith. GMean (KL)= 	  =  0.576 +- 0.027, 0.582 +- 0.025, 0.598 +- 0.034, 0.647 +- 0.028
Computed for split load_split = id



Completed in  0:59:39.536444  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:15:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:15:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:08 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:16:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3639) +- tensor(0.1838)
F1 for r=0.3 = 0.515
WIoU for r=0.3 = 0.391
F1 for r=0.6 = 0.595
WIoU for r=0.6 = 0.485
F1 for r=0.9 = 0.537
WIoU for r=0.9 = 0.438
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.422
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1298) +- tensor(0.0660)
F1 for r=0.3 = 0.349
WIoU for r=0.3 = 0.285
F1 for r=0.6 = 0.297
WIoU for r=0.6 = 0.235
F1 for r=0.9 = 0.243
WIoU for r=0.9 = 0.194
F1 for r=1.0 = 0.224
WIoU for r=1.0 = 0.181
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0594) +- tensor(0.0246)
F1 for r=0.3 = 0.185
WIoU for r=0.3 = 0.122
F1 for r=0.6 = 0.143
WIoU for r=0.6 = 0.091
F1 for r=0.9 = 0.119
WIoU for r=0.9 = 0.075
F1 for r=1.0 = 0.111
WIoU for r=1.0 = 0.070


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.371
Model XAI F1 of binarized graphs for r=0.3 =  0.5152100000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.39119
len(reference) = 97
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.347
SUFF++ for r=0.3 class 0 = 0.758 +- 0.143 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 class 1 = 0.791 +- 0.143 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 class 2 = 0.788 +- 0.143 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 all KL = 0.896 +- 0.143 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 all L1 = 0.779 +- 0.144 (in-sample avg dev_std = 0.257)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.5952200000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.4846199999999999
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.526
SUFF++ for r=0.6 class 0 = 0.72 +- 0.205 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 1 = 0.877 +- 0.205 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 2 = 0.806 +- 0.205 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all KL = 0.84 +- 0.205 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all L1 = 0.799 +- 0.190 (in-sample avg dev_std = 0.338)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.53705
Model XAI WIoU of binarized graphs for r=0.9 =  0.43835
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.786
SUFF++ for r=0.9 class 0 = 0.787 +- 0.232 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 class 1 = 0.866 +- 0.232 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 class 2 = 0.817 +- 0.232 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 all KL = 0.863 +- 0.232 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.9 all L1 = 0.823 +- 0.219 (in-sample avg dev_std = 0.288)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.5
Model XAI F1 of binarized graphs for r=0.3 =  0.34875999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.28506000000000004
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.475
SUFF++ for r=0.3 class 0 = 0.881 +- 0.098 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.3 class 1 = 0.912 +- 0.098 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.3 class 2 = 0.854 +- 0.098 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.3 all KL = 0.941 +- 0.098 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.3 all L1 = 0.883 +- 0.084 (in-sample avg dev_std = 0.226)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.29718
Model XAI WIoU of binarized graphs for r=0.6 =  0.23542000000000002
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.546
SUFF++ for r=0.6 class 0 = 0.643 +- 0.268 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 class 1 = 0.83 +- 0.268 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 class 2 = 0.578 +- 0.268 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 all KL = 0.709 +- 0.268 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.6 all L1 = 0.686 +- 0.228 (in-sample avg dev_std = 0.467)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  0.24256
Model XAI WIoU of binarized graphs for r=0.9 =  0.19422999999999996
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.645
SUFF++ for r=0.9 class 0 = 0.62 +- 0.239 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 class 1 = 0.781 +- 0.239 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 class 2 = 0.768 +- 0.239 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 all KL = 0.775 +- 0.239 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 all L1 = 0.722 +- 0.213 (in-sample avg dev_std = 0.328)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.394
Model XAI F1 of binarized graphs for r=0.3 =  0.18544999999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.12215
len(reference) = 99
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.388
SUFF++ for r=0.3 class 0 = 0.861 +- 0.179 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.3 class 1 = 0.888 +- 0.179 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.3 class 2 = 0.813 +- 0.179 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.3 all KL = 0.906 +- 0.179 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.3 all L1 = 0.855 +- 0.165 (in-sample avg dev_std = 0.208)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.4
Model XAI F1 of binarized graphs for r=0.6 =  0.14338
Model XAI WIoU of binarized graphs for r=0.6 =  0.09111000000000001
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.415
SUFF++ for r=0.6 class 0 = 0.569 +- 0.415 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 1 = 0.637 +- 0.415 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 class 2 = 0.651 +- 0.415 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all KL = 0.551 +- 0.415 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.6 all L1 = 0.618 +- 0.296 (in-sample avg dev_std = 0.515)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  0.11935000000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.07485999999999998
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.391
SUFF++ for r=0.9 class 0 = 0.713 +- 0.435 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 class 1 = 0.689 +- 0.435 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 class 2 = 0.701 +- 0.435 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 all KL = 0.553 +- 0.435 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 all L1 = 0.701 +- 0.288 (in-sample avg dev_std = 0.453)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.37
Model XAI F1 of binarized graphs for r=0.3 =  0.5152100000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.39119
len(reference) = 100
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.258 +- 0.190 (in-sample avg dev_std = 0.199)
NEC for r=0.3 class 1 = 0.193 +- 0.190 (in-sample avg dev_std = 0.199)
NEC for r=0.3 class 2 = 0.256 +- 0.190 (in-sample avg dev_std = 0.199)
NEC for r=0.3 all KL = 0.119 +- 0.190 (in-sample avg dev_std = 0.199)
NEC for r=0.3 all L1 = 0.236 +- 0.183 (in-sample avg dev_std = 0.199)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.5952200000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.4846199999999999
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.41
NEC for r=0.6 class 0 = 0.431 +- 0.297 (in-sample avg dev_std = 0.465)
NEC for r=0.6 class 1 = 0.26 +- 0.297 (in-sample avg dev_std = 0.465)
NEC for r=0.6 class 2 = 0.429 +- 0.297 (in-sample avg dev_std = 0.465)
NEC for r=0.6 all KL = 0.359 +- 0.297 (in-sample avg dev_std = 0.465)
NEC for r=0.6 all L1 = 0.376 +- 0.244 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.53705
Model XAI WIoU of binarized graphs for r=0.9 =  0.43835
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.56 +- 0.286 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 1 = 0.342 +- 0.286 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 2 = 0.583 +- 0.286 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all KL = 0.501 +- 0.286 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all L1 = 0.498 +- 0.210 (in-sample avg dev_std = 0.546)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.89
Model XAI F1 of binarized graphs for r=1.0 =  0.50909
Model XAI WIoU of binarized graphs for r=1.0 =  0.42196
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.52
NEC for r=1.0 class 0 = 0.542 +- 0.311 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 1 = 0.324 +- 0.311 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 2 = 0.582 +- 0.311 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all KL = 0.491 +- 0.311 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all L1 = 0.486 +- 0.221 (in-sample avg dev_std = 0.562)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.5
Model XAI F1 of binarized graphs for r=0.3 =  0.34875999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.28506000000000004
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.352
NEC for r=0.3 class 0 = 0.169 +- 0.301 (in-sample avg dev_std = 0.168)
NEC for r=0.3 class 1 = 0.142 +- 0.301 (in-sample avg dev_std = 0.168)
NEC for r=0.3 class 2 = 0.324 +- 0.301 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all KL = 0.162 +- 0.301 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all L1 = 0.209 +- 0.260 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.29718
Model XAI WIoU of binarized graphs for r=0.6 =  0.23542000000000002
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.345 +- 0.257 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.097 +- 0.257 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.439 +- 0.257 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.22 +- 0.257 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.291 +- 0.244 (in-sample avg dev_std = 0.292)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.24256
Model XAI WIoU of binarized graphs for r=0.9 =  0.19422999999999996
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.506
NEC for r=0.9 class 0 = 0.463 +- 0.270 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.238 +- 0.270 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.493 +- 0.270 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.354 +- 0.270 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.396 +- 0.241 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.79
Model XAI F1 of binarized graphs for r=1.0 =  0.22392999999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.18112000000000003
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.408 +- 0.304 (in-sample avg dev_std = 0.482)
NEC for r=1.0 class 1 = 0.182 +- 0.304 (in-sample avg dev_std = 0.482)
NEC for r=1.0 class 2 = 0.439 +- 0.304 (in-sample avg dev_std = 0.482)
NEC for r=1.0 all KL = 0.334 +- 0.304 (in-sample avg dev_std = 0.482)
NEC for r=1.0 all L1 = 0.341 +- 0.260 (in-sample avg dev_std = 0.482)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.39
Model XAI F1 of binarized graphs for r=0.3 =  0.18544999999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.12215
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.146 +- 0.215 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1 = 0.128 +- 0.215 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 2 = 0.18 +- 0.215 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.1 +- 0.215 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.151 +- 0.188 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.4
Model XAI F1 of binarized graphs for r=0.6 =  0.14338
Model XAI WIoU of binarized graphs for r=0.6 =  0.09111000000000001
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.364 +- 0.424 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 1 = 0.266 +- 0.424 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 2 = 0.362 +- 0.424 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all KL = 0.362 +- 0.424 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all L1 = 0.33 +- 0.328 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  0.11935000000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.07485999999999998
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.385
NEC for r=0.9 class 0 = 0.304 +- 0.429 (in-sample avg dev_std = 0.364)
NEC for r=0.9 class 1 = 0.294 +- 0.429 (in-sample avg dev_std = 0.364)
NEC for r=0.9 class 2 = 0.334 +- 0.429 (in-sample avg dev_std = 0.364)
NEC for r=0.9 all KL = 0.425 +- 0.429 (in-sample avg dev_std = 0.364)
NEC for r=0.9 all L1 = 0.31 +- 0.311 (in-sample avg dev_std = 0.364)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.34
Model XAI F1 of binarized graphs for r=1.0 =  0.11126000000000001
Model XAI WIoU of binarized graphs for r=1.0 =  0.07045
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.376
NEC for r=1.0 class 0 = 0.285 +- 0.441 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 1 = 0.33 +- 0.441 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 2 = 0.308 +- 0.441 (in-sample avg dev_std = 0.329)
NEC for r=1.0 all KL = 0.48 +- 0.441 (in-sample avg dev_std = 0.329)
NEC for r=1.0 all L1 = 0.307 +- 0.291 (in-sample avg dev_std = 0.329)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:17:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:17:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3639) +- tensor(0.1838)
F1 for r=0.3 = 0.507
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.575
WIoU for r=0.6 = 0.463
F1 for r=0.9 = 0.536
WIoU for r=0.9 = 0.441
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.426
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1298) +- tensor(0.0660)
F1 for r=0.3 = 0.357
WIoU for r=0.3 = 0.326
F1 for r=0.6 = 0.298
WIoU for r=0.6 = 0.329
F1 for r=0.9 = 0.243
WIoU for r=0.9 = 0.322
F1 for r=1.0 = 0.224
WIoU for r=1.0 = 0.316
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0594) +- tensor(0.0246)
F1 for r=0.3 = 0.238
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.150
WIoU for r=0.6 = 0.247
F1 for r=0.9 = 0.119
WIoU for r=0.9 = 0.248
F1 for r=1.0 = 0.111
WIoU for r=1.0 = 0.247


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.351
Model XAI F1 of binarized graphs for r=0.3 =  0.5065000000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.3821899999999999
len(reference) = 94
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF++ for r=0.3 class 0 = 0.795 +- 0.124 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 class 1 = 0.822 +- 0.124 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 class 2 = 0.818 +- 0.124 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 all KL = 0.92 +- 0.124 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 all L1 = 0.811 +- 0.115 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.57528
Model XAI WIoU of binarized graphs for r=0.6 =  0.46307000000000004
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.505
SUFF++ for r=0.6 class 0 = 0.642 +- 0.265 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 1 = 0.819 +- 0.265 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 2 = 0.703 +- 0.265 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all KL = 0.744 +- 0.265 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all L1 = 0.719 +- 0.203 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.5357
Model XAI WIoU of binarized graphs for r=0.9 =  0.44131
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.779
SUFF++ for r=0.9 class 0 = 0.855 +- 0.199 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 1 = 0.88 +- 0.199 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 2 = 0.819 +- 0.199 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 all KL = 0.881 +- 0.199 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 all L1 = 0.851 +- 0.193 (in-sample avg dev_std = 0.267)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.35674
Model XAI WIoU of binarized graphs for r=0.3 =  0.3263100000000001
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.517
SUFF++ for r=0.3 class 0 = 0.764 +- 0.175 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 1 = 0.84 +- 0.175 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 2 = 0.81 +- 0.175 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 all KL = 0.867 +- 0.175 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 all L1 = 0.804 +- 0.167 (in-sample avg dev_std = 0.334)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.67
Model XAI F1 of binarized graphs for r=0.6 =  0.29812
Model XAI WIoU of binarized graphs for r=0.6 =  0.32852999999999993
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.629
SUFF++ for r=0.6 class 0 = 0.649 +- 0.257 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.257 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.75 +- 0.257 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.729 +- 0.257 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.701 +- 0.202 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.64
Model XAI F1 of binarized graphs for r=0.9 =  0.24254999999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.32242000000000004
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.668
SUFF++ for r=0.9 class 0 = 0.616 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 1 = 0.751 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 2 = 0.644 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 all KL = 0.75 +- 0.215 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 all L1 = 0.671 +- 0.214 (in-sample avg dev_std = 0.372)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.48
Model XAI F1 of binarized graphs for r=0.3 =  0.23778
Model XAI WIoU of binarized graphs for r=0.3 =  0.26617999999999997
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.514
SUFF++ for r=0.3 class 0 = 0.563 +- 0.303 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.303 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 class 2 = 0.522 +- 0.303 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 all KL = 0.538 +- 0.303 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 all L1 = 0.569 +- 0.179 (in-sample avg dev_std = 0.525)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.32
Model XAI F1 of binarized graphs for r=0.6 =  0.14967000000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.24660999999999997
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.37
SUFF++ for r=0.6 class 0 = 0.753 +- 0.362 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 1 = 0.691 +- 0.362 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 class 2 = 0.661 +- 0.362 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all KL = 0.667 +- 0.362 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.6 all L1 = 0.702 +- 0.289 (in-sample avg dev_std = 0.426)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.41
Model XAI F1 of binarized graphs for r=0.9 =  0.1192
Model XAI WIoU of binarized graphs for r=0.9 =  0.24799999999999997
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.376
SUFF++ for r=0.9 class 0 = 0.866 +- 0.273 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 1 = 0.846 +- 0.273 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 2 = 0.92 +- 0.273 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all KL = 0.836 +- 0.273 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all L1 = 0.877 +- 0.215 (in-sample avg dev_std = 0.241)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.36
Model XAI F1 of binarized graphs for r=0.3 =  0.5065000000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.3821899999999999
len(reference) = 100
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.213 +- 0.164 (in-sample avg dev_std = 0.174)
NEC for r=0.3 class 1 = 0.173 +- 0.164 (in-sample avg dev_std = 0.174)
NEC for r=0.3 class 2 = 0.198 +- 0.164 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all KL = 0.084 +- 0.164 (in-sample avg dev_std = 0.174)
NEC for r=0.3 all L1 = 0.195 +- 0.158 (in-sample avg dev_std = 0.174)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.57528
Model XAI WIoU of binarized graphs for r=0.6 =  0.46307000000000004
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.377
NEC for r=0.6 class 0 = 0.47 +- 0.327 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 1 = 0.298 +- 0.327 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 2 = 0.476 +- 0.327 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all KL = 0.398 +- 0.327 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all L1 = 0.417 +- 0.239 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.5357
Model XAI WIoU of binarized graphs for r=0.9 =  0.44131
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.446
NEC for r=0.9 class 0 = 0.552 +- 0.282 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.386 +- 0.282 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.573 +- 0.282 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.536 +- 0.282 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.506 +- 0.202 (in-sample avg dev_std = 0.576)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.50909
Model XAI WIoU of binarized graphs for r=1.0 =  0.4256599999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.52
NEC for r=1.0 class 0 = 0.568 +- 0.294 (in-sample avg dev_std = 0.603)
NEC for r=1.0 class 1 = 0.383 +- 0.294 (in-sample avg dev_std = 0.603)
NEC for r=1.0 class 2 = 0.582 +- 0.294 (in-sample avg dev_std = 0.603)
NEC for r=1.0 all KL = 0.546 +- 0.294 (in-sample avg dev_std = 0.603)
NEC for r=1.0 all L1 = 0.513 +- 0.204 (in-sample avg dev_std = 0.603)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.35674
Model XAI WIoU of binarized graphs for r=0.3 =  0.3263100000000001
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.294 +- 0.325 (in-sample avg dev_std = 0.262)
NEC for r=0.3 class 1 = 0.264 +- 0.325 (in-sample avg dev_std = 0.262)
NEC for r=0.3 class 2 = 0.38 +- 0.325 (in-sample avg dev_std = 0.262)
NEC for r=0.3 all KL = 0.252 +- 0.325 (in-sample avg dev_std = 0.262)
NEC for r=0.3 all L1 = 0.311 +- 0.263 (in-sample avg dev_std = 0.262)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.67
Model XAI F1 of binarized graphs for r=0.6 =  0.29812
Model XAI WIoU of binarized graphs for r=0.6 =  0.32852999999999993
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.511
NEC for r=0.6 class 0 = 0.494 +- 0.296 (in-sample avg dev_std = 0.518)
NEC for r=0.6 class 1 = 0.301 +- 0.296 (in-sample avg dev_std = 0.518)
NEC for r=0.6 class 2 = 0.531 +- 0.296 (in-sample avg dev_std = 0.518)
NEC for r=0.6 all KL = 0.453 +- 0.296 (in-sample avg dev_std = 0.518)
NEC for r=0.6 all L1 = 0.44 +- 0.201 (in-sample avg dev_std = 0.518)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.24254999999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.32242000000000004
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.477
NEC for r=0.9 class 0 = 0.5 +- 0.226 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 1 = 0.409 +- 0.226 (in-sample avg dev_std = 0.470)
NEC for r=0.9 class 2 = 0.553 +- 0.226 (in-sample avg dev_std = 0.470)
NEC for r=0.9 all KL = 0.449 +- 0.226 (in-sample avg dev_std = 0.470)
NEC for r=0.9 all L1 = 0.486 +- 0.165 (in-sample avg dev_std = 0.470)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.7
Model XAI F1 of binarized graphs for r=1.0 =  0.22392999999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.31649
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.565
NEC for r=1.0 class 0 = 0.378 +- 0.287 (in-sample avg dev_std = 0.456)
NEC for r=1.0 class 1 = 0.359 +- 0.287 (in-sample avg dev_std = 0.456)
NEC for r=1.0 class 2 = 0.455 +- 0.287 (in-sample avg dev_std = 0.456)
NEC for r=1.0 all KL = 0.383 +- 0.287 (in-sample avg dev_std = 0.456)
NEC for r=1.0 all L1 = 0.396 +- 0.216 (in-sample avg dev_std = 0.456)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.47
Model XAI F1 of binarized graphs for r=0.3 =  0.23778
Model XAI WIoU of binarized graphs for r=0.3 =  0.26617999999999997
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.324
NEC for r=0.3 class 0 = 0.41 +- 0.316 (in-sample avg dev_std = 0.294)
NEC for r=0.3 class 1 = 0.366 +- 0.316 (in-sample avg dev_std = 0.294)
NEC for r=0.3 class 2 = 0.438 +- 0.316 (in-sample avg dev_std = 0.294)
NEC for r=0.3 all KL = 0.359 +- 0.316 (in-sample avg dev_std = 0.294)
NEC for r=0.3 all L1 = 0.404 +- 0.263 (in-sample avg dev_std = 0.294)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.32
Model XAI F1 of binarized graphs for r=0.6 =  0.14967000000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.24660999999999997
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.205 +- 0.279 (in-sample avg dev_std = 0.291)
NEC for r=0.6 class 1 = 0.267 +- 0.279 (in-sample avg dev_std = 0.291)
NEC for r=0.6 class 2 = 0.221 +- 0.279 (in-sample avg dev_std = 0.291)
NEC for r=0.6 all KL = 0.252 +- 0.279 (in-sample avg dev_std = 0.291)
NEC for r=0.6 all L1 = 0.231 +- 0.258 (in-sample avg dev_std = 0.291)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.41
Model XAI F1 of binarized graphs for r=0.9 =  0.1192
Model XAI WIoU of binarized graphs for r=0.9 =  0.24799999999999997
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.35
NEC for r=0.9 class 0 = 0.172 +- 0.366 (in-sample avg dev_std = 0.318)
NEC for r=0.9 class 1 = 0.154 +- 0.366 (in-sample avg dev_std = 0.318)
NEC for r=0.9 class 2 = 0.166 +- 0.366 (in-sample avg dev_std = 0.318)
NEC for r=0.9 all KL = 0.219 +- 0.366 (in-sample avg dev_std = 0.318)
NEC for r=0.9 all L1 = 0.164 +- 0.271 (in-sample avg dev_std = 0.318)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.39
Model XAI F1 of binarized graphs for r=1.0 =  0.11126000000000001
Model XAI WIoU of binarized graphs for r=1.0 =  0.24718
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.351
NEC for r=1.0 class 0 = 0.145 +- 0.333 (in-sample avg dev_std = 0.283)
NEC for r=1.0 class 1 = 0.127 +- 0.333 (in-sample avg dev_std = 0.283)
NEC for r=1.0 class 2 = 0.146 +- 0.333 (in-sample avg dev_std = 0.283)
NEC for r=1.0 all KL = 0.194 +- 0.333 (in-sample avg dev_std = 0.283)
NEC for r=1.0 all L1 = 0.139 +- 0.238 (in-sample avg dev_std = 0.283)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:18:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:33 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:18:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3639) +- tensor(0.1838)
F1 for r=0.3 = 0.617
WIoU for r=0.3 = 0.508
F1 for r=0.6 = 0.637
WIoU for r=0.6 = 0.615
F1 for r=0.9 = 0.531
WIoU for r=0.9 = 0.615
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.617
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1298) +- tensor(0.0660)
F1 for r=0.3 = 0.450
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.326
WIoU for r=0.6 = 0.412
F1 for r=0.9 = 0.242
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.224
WIoU for r=1.0 = 0.402
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0594) +- tensor(0.0246)
F1 for r=0.3 = 0.273
WIoU for r=0.3 = 0.208
F1 for r=0.6 = 0.171
WIoU for r=0.6 = 0.162
F1 for r=0.9 = 0.121
WIoU for r=0.9 = 0.145
F1 for r=1.0 = 0.111
WIoU for r=1.0 = 0.142


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.371
Model XAI F1 of binarized graphs for r=0.3 =  0.61661
Model XAI WIoU of binarized graphs for r=0.3 =  0.5078099999999999
len(reference) = 97
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.356
SUFF++ for r=0.3 class 0 = 0.792 +- 0.207 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 1 = 0.92 +- 0.207 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 2 = 0.859 +- 0.207 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 all KL = 0.885 +- 0.207 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 all L1 = 0.855 +- 0.191 (in-sample avg dev_std = 0.296)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  0.6371600000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.61515
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.684
SUFF++ for r=0.6 class 0 = 0.779 +- 0.229 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 1 = 0.899 +- 0.229 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.229 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all KL = 0.807 +- 0.229 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all L1 = 0.809 +- 0.187 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  0.53109
Model XAI WIoU of binarized graphs for r=0.9 =  0.61517
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.82
SUFF++ for r=0.9 class 0 = 0.895 +- 0.179 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 1 = 0.91 +- 0.179 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.179 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all KL = 0.912 +- 0.179 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.159 (in-sample avg dev_std = 0.262)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  0.4500400000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.43553
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.559
SUFF++ for r=0.3 class 0 = 0.847 +- 0.221 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 1 = 0.894 +- 0.221 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 2 = 0.841 +- 0.221 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 all KL = 0.865 +- 0.221 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 all L1 = 0.861 +- 0.174 (in-sample avg dev_std = 0.361)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.32558
Model XAI WIoU of binarized graphs for r=0.6 =  0.41151
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.654
SUFF++ for r=0.6 class 0 = 0.675 +- 0.192 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 1 = 0.792 +- 0.192 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 class 2 = 0.728 +- 0.192 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all KL = 0.803 +- 0.192 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.6 all L1 = 0.732 +- 0.204 (in-sample avg dev_std = 0.373)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.63
Model XAI F1 of binarized graphs for r=0.9 =  0.24181999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.4036
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.651
SUFF++ for r=0.9 class 0 = 0.633 +- 0.313 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 class 1 = 0.786 +- 0.313 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 class 2 = 0.8 +- 0.313 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 all KL = 0.728 +- 0.313 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 all L1 = 0.738 +- 0.259 (in-sample avg dev_std = 0.473)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  0.27293999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.20816
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.585
SUFF++ for r=0.3 class 0 = 0.715 +- 0.182 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 1 = 0.763 +- 0.182 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 class 2 = 0.652 +- 0.182 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 all KL = 0.782 +- 0.182 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.3 all L1 = 0.712 +- 0.151 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.45
Model XAI F1 of binarized graphs for r=0.6 =  0.17086
Model XAI WIoU of binarized graphs for r=0.6 =  0.16212
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.516
SUFF++ for r=0.6 class 0 = 0.662 +- 0.267 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1 = 0.766 +- 0.267 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.267 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.68 +- 0.267 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.726 +- 0.204 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  0.1213
Model XAI WIoU of binarized graphs for r=0.9 =  0.14500999999999997
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF++ for r=0.9 class 0 = 0.794 +- 0.249 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.9 class 1 = 0.816 +- 0.249 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.249 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.9 all KL = 0.805 +- 0.249 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.9 all L1 = 0.807 +- 0.203 (in-sample avg dev_std = 0.381)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.37
Model XAI F1 of binarized graphs for r=0.3 =  0.61661
Model XAI WIoU of binarized graphs for r=0.3 =  0.5078099999999999
len(reference) = 100
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.324
NEC for r=0.3 class 0 = 0.26 +- 0.246 (in-sample avg dev_std = 0.123)
NEC for r=0.3 class 1 = 0.126 +- 0.246 (in-sample avg dev_std = 0.123)
NEC for r=0.3 class 2 = 0.127 +- 0.246 (in-sample avg dev_std = 0.123)
NEC for r=0.3 all KL = 0.117 +- 0.246 (in-sample avg dev_std = 0.123)
NEC for r=0.3 all L1 = 0.172 +- 0.235 (in-sample avg dev_std = 0.123)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  0.6371600000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.61515
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.54 +- 0.380 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 1 = 0.241 +- 0.380 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 2 = 0.507 +- 0.380 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all KL = 0.447 +- 0.380 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all L1 = 0.433 +- 0.298 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  0.53109
Model XAI WIoU of binarized graphs for r=0.9 =  0.61517
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.484
NEC for r=0.9 class 0 = 0.598 +- 0.324 (in-sample avg dev_std = 0.643)
NEC for r=0.9 class 1 = 0.277 +- 0.324 (in-sample avg dev_std = 0.643)
NEC for r=0.9 class 2 = 0.612 +- 0.324 (in-sample avg dev_std = 0.643)
NEC for r=0.9 all KL = 0.567 +- 0.324 (in-sample avg dev_std = 0.643)
NEC for r=0.9 all L1 = 0.5 +- 0.251 (in-sample avg dev_std = 0.643)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.96
Model XAI F1 of binarized graphs for r=1.0 =  0.50909
Model XAI WIoU of binarized graphs for r=1.0 =  0.61662
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.533
NEC for r=1.0 class 0 = 0.663 +- 0.336 (in-sample avg dev_std = 0.640)
NEC for r=1.0 class 1 = 0.205 +- 0.336 (in-sample avg dev_std = 0.640)
NEC for r=1.0 class 2 = 0.622 +- 0.336 (in-sample avg dev_std = 0.640)
NEC for r=1.0 all KL = 0.58 +- 0.336 (in-sample avg dev_std = 0.640)
NEC for r=1.0 all L1 = 0.503 +- 0.264 (in-sample avg dev_std = 0.640)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  0.4500400000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.43553
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.29 +- 0.418 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 1 = 0.102 +- 0.418 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 2 = 0.43 +- 0.418 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all KL = 0.283 +- 0.418 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all L1 = 0.271 +- 0.354 (in-sample avg dev_std = 0.177)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.32558
Model XAI WIoU of binarized graphs for r=0.6 =  0.41151
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.488
NEC for r=0.6 class 0 = 0.525 +- 0.324 (in-sample avg dev_std = 0.457)
NEC for r=0.6 class 1 = 0.173 +- 0.324 (in-sample avg dev_std = 0.457)
NEC for r=0.6 class 2 = 0.58 +- 0.324 (in-sample avg dev_std = 0.457)
NEC for r=0.6 all KL = 0.383 +- 0.324 (in-sample avg dev_std = 0.457)
NEC for r=0.6 all L1 = 0.423 +- 0.260 (in-sample avg dev_std = 0.457)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.24181999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.4036
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.521
NEC for r=0.9 class 0 = 0.478 +- 0.310 (in-sample avg dev_std = 0.493)
NEC for r=0.9 class 1 = 0.165 +- 0.310 (in-sample avg dev_std = 0.493)
NEC for r=0.9 class 2 = 0.534 +- 0.310 (in-sample avg dev_std = 0.493)
NEC for r=0.9 all KL = 0.396 +- 0.310 (in-sample avg dev_std = 0.493)
NEC for r=0.9 all L1 = 0.389 +- 0.266 (in-sample avg dev_std = 0.493)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.88
Model XAI F1 of binarized graphs for r=1.0 =  0.22392999999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.40194
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.644 +- 0.344 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 1 = 0.153 +- 0.344 (in-sample avg dev_std = 0.516)
NEC for r=1.0 class 2 = 0.606 +- 0.344 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all KL = 0.487 +- 0.344 (in-sample avg dev_std = 0.516)
NEC for r=1.0 all L1 = 0.465 +- 0.279 (in-sample avg dev_std = 0.516)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  0.27293999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.20816
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.343
NEC for r=0.3 class 0 = 0.475 +- 0.422 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 1 = 0.19 +- 0.422 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 2 = 0.532 +- 0.422 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all KL = 0.368 +- 0.422 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all L1 = 0.396 +- 0.340 (in-sample avg dev_std = 0.160)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.45
Model XAI F1 of binarized graphs for r=0.6 =  0.17086
Model XAI WIoU of binarized graphs for r=0.6 =  0.16212
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.33
NEC for r=0.6 class 0 = 0.299 +- 0.304 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 1 = 0.158 +- 0.304 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 2 = 0.415 +- 0.304 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.302 +- 0.304 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.288 +- 0.259 (in-sample avg dev_std = 0.302)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.41
Model XAI F1 of binarized graphs for r=0.9 =  0.1213
Model XAI WIoU of binarized graphs for r=0.9 =  0.14500999999999997
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.346
NEC for r=0.9 class 0 = 0.269 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.9 class 1 = 0.167 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.9 class 2 = 0.361 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.9 all KL = 0.229 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.9 all L1 = 0.264 +- 0.224 (in-sample avg dev_std = 0.272)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.49
Model XAI F1 of binarized graphs for r=1.0 =  0.11126000000000001
Model XAI WIoU of binarized graphs for r=1.0 =  0.14159
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.375
NEC for r=1.0 class 0 = 0.399 +- 0.263 (in-sample avg dev_std = 0.300)
NEC for r=1.0 class 1 = 0.347 +- 0.263 (in-sample avg dev_std = 0.300)
NEC for r=1.0 class 2 = 0.356 +- 0.263 (in-sample avg dev_std = 0.300)
NEC for r=1.0 all KL = 0.355 +- 0.263 (in-sample avg dev_std = 0.300)
NEC for r=1.0 all L1 = 0.368 +- 0.214 (in-sample avg dev_std = 0.300)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:19:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:39 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:41 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:19:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3639) +- tensor(0.1838)
F1 for r=0.3 = 0.390
WIoU for r=0.3 = 0.334
F1 for r=0.6 = 0.426
WIoU for r=0.6 = 0.375
F1 for r=0.9 = 0.475
WIoU for r=0.9 = 0.418
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.421
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1298) +- tensor(0.0660)
F1 for r=0.3 = 0.309
WIoU for r=0.3 = 0.316
F1 for r=0.6 = 0.242
WIoU for r=0.6 = 0.314
F1 for r=0.9 = 0.203
WIoU for r=0.9 = 0.320
F1 for r=1.0 = 0.224
WIoU for r=1.0 = 0.324
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0594) +- tensor(0.0246)
F1 for r=0.3 = 0.148
WIoU for r=0.3 = 0.218
F1 for r=0.6 = 0.126
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.097
WIoU for r=0.9 = 0.230
F1 for r=1.0 = 0.111
WIoU for r=1.0 = 0.236


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.434
Model XAI F1 of binarized graphs for r=0.3 =  0.38975000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.3344700000000001
len(reference) = 99
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.394
SUFF++ for r=0.3 class 0 = 0.646 +- 0.301 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 class 1 = 0.792 +- 0.301 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 class 2 = 0.756 +- 0.301 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 all KL = 0.726 +- 0.301 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.3 all L1 = 0.73 +- 0.260 (in-sample avg dev_std = 0.431)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.61
Model XAI F1 of binarized graphs for r=0.6 =  0.42644
Model XAI WIoU of binarized graphs for r=0.6 =  0.37467
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.486
SUFF++ for r=0.6 class 0 = 0.393 +- 0.270 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 1 = 0.616 +- 0.270 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 2 = 0.562 +- 0.270 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all KL = 0.535 +- 0.270 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all L1 = 0.522 +- 0.223 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.4749399999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.4176
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.716
SUFF++ for r=0.9 class 0 = 0.571 +- 0.329 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.9 class 1 = 0.747 +- 0.329 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.9 class 2 = 0.667 +- 0.329 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.9 all KL = 0.631 +- 0.329 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.9 all L1 = 0.66 +- 0.267 (in-sample avg dev_std = 0.534)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  0.30867000000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.3155
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.538
SUFF++ for r=0.3 class 0 = 0.476 +- 0.318 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 1 = 0.715 +- 0.318 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 2 = 0.696 +- 0.318 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all KL = 0.563 +- 0.318 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all L1 = 0.628 +- 0.263 (in-sample avg dev_std = 0.542)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.69
Model XAI F1 of binarized graphs for r=0.6 =  0.24206999999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.3139300000000001
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.558
SUFF++ for r=0.6 class 0 = 0.517 +- 0.256 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1 = 0.626 +- 0.256 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 2 = 0.623 +- 0.256 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.65 +- 0.256 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.588 +- 0.221 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  0.20346999999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.31964
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.618
SUFF++ for r=0.9 class 0 = 0.468 +- 0.324 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 class 1 = 0.6 +- 0.324 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 class 2 = 0.674 +- 0.324 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 all KL = 0.569 +- 0.324 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 all L1 = 0.579 +- 0.275 (in-sample avg dev_std = 0.465)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.36
Model XAI F1 of binarized graphs for r=0.3 =  0.14801999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.21849999999999997
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.39
SUFF++ for r=0.3 class 0 = 0.524 +- 0.321 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 class 1 = 0.54 +- 0.321 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 class 2 = 0.582 +- 0.321 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 all KL = 0.456 +- 0.321 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 all L1 = 0.548 +- 0.247 (in-sample avg dev_std = 0.603)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.31
Model XAI F1 of binarized graphs for r=0.6 =  0.12606
Model XAI WIoU of binarized graphs for r=0.6 =  0.22845
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.36
SUFF++ for r=0.6 class 0 = 0.528 +- 0.283 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 class 1 = 0.556 +- 0.283 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 class 2 = 0.468 +- 0.283 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 all KL = 0.482 +- 0.283 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 all L1 = 0.518 +- 0.206 (in-sample avg dev_std = 0.518)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.37
Model XAI F1 of binarized graphs for r=0.9 =  0.09726999999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.23004999999999998
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.369
SUFF++ for r=0.9 class 0 = 0.646 +- 0.228 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.9 class 1 = 0.765 +- 0.228 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.9 class 2 = 0.671 +- 0.228 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.9 all KL = 0.734 +- 0.228 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.9 all L1 = 0.694 +- 0.216 (in-sample avg dev_std = 0.364)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.43
Model XAI F1 of binarized graphs for r=0.3 =  0.38975000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.3344700000000001
len(reference) = 100
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.39 +- 0.353 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 1 = 0.173 +- 0.353 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 2 = 0.31 +- 0.353 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all KL = 0.301 +- 0.353 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all L1 = 0.293 +- 0.304 (in-sample avg dev_std = 0.379)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.61
Model XAI F1 of binarized graphs for r=0.6 =  0.42644
Model XAI WIoU of binarized graphs for r=0.6 =  0.37467
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.44
NEC for r=0.6 class 0 = 0.572 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 1 = 0.337 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 2 = 0.597 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all KL = 0.493 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all L1 = 0.505 +- 0.248 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.4749399999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.4176
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.541
NEC for r=0.9 class 0 = 0.571 +- 0.318 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 1 = 0.237 +- 0.318 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 2 = 0.646 +- 0.318 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all KL = 0.562 +- 0.318 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all L1 = 0.49 +- 0.256 (in-sample avg dev_std = 0.627)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.95
Model XAI F1 of binarized graphs for r=1.0 =  0.50909
Model XAI WIoU of binarized graphs for r=1.0 =  0.42077000000000003
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.539
NEC for r=1.0 class 0 = 0.592 +- 0.288 (in-sample avg dev_std = 0.683)
NEC for r=1.0 class 1 = 0.284 +- 0.288 (in-sample avg dev_std = 0.683)
NEC for r=1.0 class 2 = 0.616 +- 0.288 (in-sample avg dev_std = 0.683)
NEC for r=1.0 all KL = 0.593 +- 0.288 (in-sample avg dev_std = 0.683)
NEC for r=1.0 all L1 = 0.502 +- 0.229 (in-sample avg dev_std = 0.683)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  0.30867000000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.3155
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.403
NEC for r=0.3 class 0 = 0.512 +- 0.413 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.202 +- 0.413 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.576 +- 0.413 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.466 +- 0.413 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.427 +- 0.348 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.7
Model XAI F1 of binarized graphs for r=0.6 =  0.24206999999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.3139300000000001
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.526
NEC for r=0.6 class 0 = 0.544 +- 0.363 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.318 +- 0.363 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.6 +- 0.363 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.486 +- 0.363 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.485 +- 0.264 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.68
Model XAI F1 of binarized graphs for r=0.9 =  0.20346999999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.31964
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.591
NEC for r=0.9 class 0 = 0.599 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 1 = 0.451 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 2 = 0.637 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all KL = 0.606 +- 0.293 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all L1 = 0.561 +- 0.233 (in-sample avg dev_std = 0.531)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.79
Model XAI F1 of binarized graphs for r=1.0 =  0.22392999999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.32396
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.565
NEC for r=1.0 class 0 = 0.586 +- 0.251 (in-sample avg dev_std = 0.597)
NEC for r=1.0 class 1 = 0.486 +- 0.251 (in-sample avg dev_std = 0.597)
NEC for r=1.0 class 2 = 0.653 +- 0.251 (in-sample avg dev_std = 0.597)
NEC for r=1.0 all KL = 0.639 +- 0.251 (in-sample avg dev_std = 0.597)
NEC for r=1.0 all L1 = 0.573 +- 0.203 (in-sample avg dev_std = 0.597)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.35
Model XAI F1 of binarized graphs for r=0.3 =  0.14801999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.21849999999999997
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.343
NEC for r=0.3 class 0 = 0.512 +- 0.389 (in-sample avg dev_std = 0.360)
NEC for r=0.3 class 1 = 0.458 +- 0.389 (in-sample avg dev_std = 0.360)
NEC for r=0.3 class 2 = 0.475 +- 0.389 (in-sample avg dev_std = 0.360)
NEC for r=0.3 all KL = 0.51 +- 0.389 (in-sample avg dev_std = 0.360)
NEC for r=0.3 all L1 = 0.482 +- 0.326 (in-sample avg dev_std = 0.360)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.31
Model XAI F1 of binarized graphs for r=0.6 =  0.12606
Model XAI WIoU of binarized graphs for r=0.6 =  0.22845
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.326
NEC for r=0.6 class 0 = 0.563 +- 0.372 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 1 = 0.572 +- 0.372 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 2 = 0.621 +- 0.372 (in-sample avg dev_std = 0.410)
NEC for r=0.6 all KL = 0.633 +- 0.372 (in-sample avg dev_std = 0.410)
NEC for r=0.6 all L1 = 0.585 +- 0.255 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.37
Model XAI F1 of binarized graphs for r=0.9 =  0.09726999999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.23004999999999998
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.298
NEC for r=0.9 class 0 = 0.473 +- 0.349 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 1 = 0.458 +- 0.349 (in-sample avg dev_std = 0.429)
NEC for r=0.9 class 2 = 0.452 +- 0.349 (in-sample avg dev_std = 0.429)
NEC for r=0.9 all KL = 0.464 +- 0.349 (in-sample avg dev_std = 0.429)
NEC for r=0.9 all L1 = 0.461 +- 0.230 (in-sample avg dev_std = 0.429)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.43
Model XAI F1 of binarized graphs for r=1.0 =  0.11126000000000001
Model XAI WIoU of binarized graphs for r=1.0 =  0.23578000000000002
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.336
NEC for r=1.0 class 0 = 0.49 +- 0.332 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 1 = 0.528 +- 0.332 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 2 = 0.438 +- 0.332 (in-sample avg dev_std = 0.460)
NEC for r=1.0 all KL = 0.545 +- 0.332 (in-sample avg dev_std = 0.460)
NEC for r=1.0 all L1 = 0.486 +- 0.238 (in-sample avg dev_std = 0.460)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:20:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:20:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:20:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:20:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:20:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:20:56 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:02 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:02 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:21:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3639) +- tensor(0.1838)
F1 for r=0.3 = 0.299
WIoU for r=0.3 = 0.226
F1 for r=0.6 = 0.397
WIoU for r=0.6 = 0.294
F1 for r=0.9 = 0.504
WIoU for r=0.9 = 0.390
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.396
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1298) +- tensor(0.0660)
F1 for r=0.3 = 0.253
WIoU for r=0.3 = 0.248
F1 for r=0.6 = 0.208
WIoU for r=0.6 = 0.216
F1 for r=0.9 = 0.200
WIoU for r=0.9 = 0.211
F1 for r=1.0 = 0.224
WIoU for r=1.0 = 0.218
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0594) +- tensor(0.0246)
F1 for r=0.3 = 0.173
WIoU for r=0.3 = 0.231
F1 for r=0.6 = 0.133
WIoU for r=0.6 = 0.220
F1 for r=0.9 = 0.112
WIoU for r=0.9 = 0.213
F1 for r=1.0 = 0.111
WIoU for r=1.0 = 0.213


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.31
Model XAI F1 of binarized graphs for r=0.3 =  0.29933000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.22603
len(reference) = 100
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF++ for r=0.3 class 0 = 0.765 +- 0.144 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 1 = 0.744 +- 0.144 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 class 2 = 0.756 +- 0.144 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 all KL = 0.869 +- 0.144 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.142 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.38
Model XAI F1 of binarized graphs for r=0.6 =  0.39727999999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.29417000000000004
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.394
SUFF++ for r=0.6 class 0 = 0.57 +- 0.259 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 1 = 0.625 +- 0.259 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 2 = 0.587 +- 0.259 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all KL = 0.655 +- 0.259 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all L1 = 0.594 +- 0.193 (in-sample avg dev_std = 0.507)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  0.50388
Model XAI WIoU of binarized graphs for r=0.9 =  0.39041999999999993
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.644
SUFF++ for r=0.9 class 0 = 0.556 +- 0.315 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.9 class 1 = 0.806 +- 0.315 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.9 class 2 = 0.59 +- 0.315 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.9 all KL = 0.659 +- 0.315 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.9 all L1 = 0.648 +- 0.279 (in-sample avg dev_std = 0.455)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.25276000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.24761000000000005
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.452
SUFF++ for r=0.3 class 0 = 0.719 +- 0.250 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 class 1 = 0.856 +- 0.250 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 class 2 = 0.655 +- 0.250 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 all KL = 0.781 +- 0.250 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.3 all L1 = 0.745 +- 0.198 (in-sample avg dev_std = 0.430)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.59
Model XAI F1 of binarized graphs for r=0.6 =  0.20754999999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.21616999999999997
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.499
SUFF++ for r=0.6 class 0 = 0.623 +- 0.269 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 class 1 = 0.781 +- 0.269 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 class 2 = 0.638 +- 0.269 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all KL = 0.683 +- 0.269 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.6 all L1 = 0.682 +- 0.238 (in-sample avg dev_std = 0.464)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.61
Model XAI F1 of binarized graphs for r=0.9 =  0.20032
Model XAI WIoU of binarized graphs for r=0.9 =  0.21134
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.605
SUFF++ for r=0.9 class 0 = 0.594 +- 0.277 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.9 class 1 = 0.783 +- 0.277 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.9 class 2 = 0.627 +- 0.277 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.9 all KL = 0.714 +- 0.277 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.9 all L1 = 0.669 +- 0.231 (in-sample avg dev_std = 0.442)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.43
Model XAI F1 of binarized graphs for r=0.3 =  0.17290000000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.23147
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.414
SUFF++ for r=0.3 class 0 = 0.547 +- 0.301 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.639 +- 0.301 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.602 +- 0.301 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.557 +- 0.301 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.596 +- 0.175 (in-sample avg dev_std = 0.608)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.42
Model XAI F1 of binarized graphs for r=0.6 =  0.13287000000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.21997
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.401
SUFF++ for r=0.6 class 0 = 0.755 +- 0.229 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 1 = 0.797 +- 0.229 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.229 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all KL = 0.803 +- 0.229 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all L1 = 0.765 +- 0.237 (in-sample avg dev_std = 0.386)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.38
Model XAI F1 of binarized graphs for r=0.9 =  0.11172
Model XAI WIoU of binarized graphs for r=0.9 =  0.21338000000000001
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.379
SUFF++ for r=0.9 class 0 = 0.902 +- 0.159 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 1 = 0.893 +- 0.159 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 2 = 0.912 +- 0.159 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all KL = 0.921 +- 0.159 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all L1 = 0.902 +- 0.132 (in-sample avg dev_std = 0.194)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.31
Model XAI F1 of binarized graphs for r=0.3 =  0.29933000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.22603
len(reference) = 100
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.261
NEC for r=0.3 class 0 = 0.238 +- 0.165 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 1 = 0.26 +- 0.165 (in-sample avg dev_std = 0.228)
NEC for r=0.3 class 2 = 0.229 +- 0.165 (in-sample avg dev_std = 0.228)
NEC for r=0.3 all KL = 0.121 +- 0.165 (in-sample avg dev_std = 0.228)
NEC for r=0.3 all L1 = 0.242 +- 0.175 (in-sample avg dev_std = 0.228)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.39
Model XAI F1 of binarized graphs for r=0.6 =  0.39727999999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.29417000000000004
len(reference) = 100
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.489 +- 0.300 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.42 +- 0.300 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.433 +- 0.300 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.403 +- 0.300 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.448 +- 0.224 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  0.50388
Model XAI WIoU of binarized graphs for r=0.9 =  0.39041999999999993
len(reference) = 100
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.49
NEC for r=0.9 class 0 = 0.589 +- 0.294 (in-sample avg dev_std = 0.554)
NEC for r=0.9 class 1 = 0.279 +- 0.294 (in-sample avg dev_std = 0.554)
NEC for r=0.9 class 2 = 0.603 +- 0.294 (in-sample avg dev_std = 0.554)
NEC for r=0.9 all KL = 0.489 +- 0.294 (in-sample avg dev_std = 0.554)
NEC for r=0.9 all L1 = 0.494 +- 0.240 (in-sample avg dev_std = 0.554)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.50909
Model XAI WIoU of binarized graphs for r=1.0 =  0.3959499999999999
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.54
NEC for r=1.0 class 0 = 0.582 +- 0.316 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 1 = 0.206 +- 0.316 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 2 = 0.628 +- 0.316 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all KL = 0.516 +- 0.316 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all L1 = 0.478 +- 0.244 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.53
Model XAI F1 of binarized graphs for r=0.3 =  0.25276000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.24761000000000005
len(reference) = 100
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.349
NEC for r=0.3 class 0 = 0.279 +- 0.332 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 1 = 0.127 +- 0.332 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 2 = 0.432 +- 0.332 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all KL = 0.223 +- 0.332 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all L1 = 0.276 +- 0.284 (in-sample avg dev_std = 0.213)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.59
Model XAI F1 of binarized graphs for r=0.6 =  0.20754999999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.21616999999999997
len(reference) = 100
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.465
NEC for r=0.6 class 0 = 0.396 +- 0.306 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 1 = 0.185 +- 0.306 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 2 = 0.436 +- 0.306 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all KL = 0.342 +- 0.306 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all L1 = 0.337 +- 0.265 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.61
Model XAI F1 of binarized graphs for r=0.9 =  0.20032
Model XAI WIoU of binarized graphs for r=0.9 =  0.21134
len(reference) = 100
Effective ratio: 0.904 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.47
NEC for r=0.9 class 0 = 0.577 +- 0.327 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 1 = 0.267 +- 0.327 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 2 = 0.627 +- 0.327 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all KL = 0.475 +- 0.327 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all L1 = 0.488 +- 0.254 (in-sample avg dev_std = 0.514)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.86
Model XAI F1 of binarized graphs for r=1.0 =  0.22392999999999996
Model XAI WIoU of binarized graphs for r=1.0 =  0.21844000000000002
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.564
NEC for r=1.0 class 0 = 0.611 +- 0.309 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 1 = 0.222 +- 0.309 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 2 = 0.495 +- 0.309 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all KL = 0.427 +- 0.309 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all L1 = 0.442 +- 0.251 (in-sample avg dev_std = 0.504)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.43
Model XAI F1 of binarized graphs for r=0.3 =  0.17290000000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.23147
len(reference) = 100
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.3
NEC for r=0.3 class 0 = 0.345 +- 0.373 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 1 = 0.273 +- 0.373 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 2 = 0.503 +- 0.373 (in-sample avg dev_std = 0.224)
NEC for r=0.3 all KL = 0.335 +- 0.373 (in-sample avg dev_std = 0.224)
NEC for r=0.3 all L1 = 0.371 +- 0.309 (in-sample avg dev_std = 0.224)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.42
Model XAI F1 of binarized graphs for r=0.6 =  0.13287000000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.21997
len(reference) = 100
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.345
NEC for r=0.6 class 0 = 0.273 +- 0.289 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.219 +- 0.289 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.343 +- 0.289 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.246 +- 0.289 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.277 +- 0.270 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.38
Model XAI F1 of binarized graphs for r=0.9 =  0.11172
Model XAI WIoU of binarized graphs for r=0.9 =  0.21338000000000001
len(reference) = 100
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.349
NEC for r=0.9 class 0 = 0.204 +- 0.269 (in-sample avg dev_std = 0.352)
NEC for r=0.9 class 1 = 0.221 +- 0.269 (in-sample avg dev_std = 0.352)
NEC for r=0.9 class 2 = 0.248 +- 0.269 (in-sample avg dev_std = 0.352)
NEC for r=0.9 all KL = 0.25 +- 0.269 (in-sample avg dev_std = 0.352)
NEC for r=0.9 all L1 = 0.224 +- 0.199 (in-sample avg dev_std = 0.352)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.43
Model XAI F1 of binarized graphs for r=1.0 =  0.11126000000000001
Model XAI WIoU of binarized graphs for r=1.0 =  0.21256
len(reference) = 100
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.373
NEC for r=1.0 class 0 = 0.358 +- 0.315 (in-sample avg dev_std = 0.404)
NEC for r=1.0 class 1 = 0.402 +- 0.315 (in-sample avg dev_std = 0.404)
NEC for r=1.0 class 2 = 0.253 +- 0.315 (in-sample avg dev_std = 0.404)
NEC for r=1.0 all KL = 0.356 +- 0.315 (in-sample avg dev_std = 0.404)
NEC for r=1.0 all L1 = 0.339 +- 0.259 (in-sample avg dev_std = 0.404)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.896, 0.84, 0.863, 1.0], 'all_L1': [0.779, 0.799, 0.823, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.744, 0.881, 1.0], 'all_L1': [0.811, 0.719, 0.851, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.885, 0.807, 0.912, 1.0], 'all_L1': [0.855, 0.809, 0.899, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.726, 0.535, 0.631, 1.0], 'all_L1': [0.73, 0.522, 0.66, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.869, 0.655, 0.659, 1.0], 'all_L1': [0.755, 0.594, 0.648, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.119, 0.359, 0.501, 0.491], 'all_L1': [0.236, 0.376, 0.498, 0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.084, 0.398, 0.536, 0.546], 'all_L1': [0.195, 0.417, 0.506, 0.513]}), defaultdict(<class 'list'>, {'all_KL': [0.117, 0.447, 0.567, 0.58], 'all_L1': [0.172, 0.433, 0.5, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.301, 0.493, 0.562, 0.593], 'all_L1': [0.293, 0.505, 0.49, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.403, 0.489, 0.516], 'all_L1': [0.242, 0.448, 0.494, 0.478]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.941, 0.709, 0.775, 1.0], 'all_L1': [0.883, 0.686, 0.722, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.867, 0.729, 0.75, 1.0], 'all_L1': [0.804, 0.701, 0.671, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.865, 0.803, 0.728, 1.0], 'all_L1': [0.861, 0.732, 0.738, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.65, 0.569, 1.0], 'all_L1': [0.628, 0.588, 0.579, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.781, 0.683, 0.714, 1.0], 'all_L1': [0.745, 0.682, 0.669, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.162, 0.22, 0.354, 0.334], 'all_L1': [0.209, 0.291, 0.396, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.453, 0.449, 0.383], 'all_L1': [0.311, 0.44, 0.486, 0.396]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.383, 0.396, 0.487], 'all_L1': [0.271, 0.423, 0.389, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.486, 0.606, 0.639], 'all_L1': [0.427, 0.485, 0.561, 0.573]}), defaultdict(<class 'list'>, {'all_KL': [0.223, 0.342, 0.475, 0.427], 'all_L1': [0.276, 0.337, 0.488, 0.442]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.906, 0.551, 0.553, 1.0], 'all_L1': [0.855, 0.618, 0.701, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.667, 0.836, 1.0], 'all_L1': [0.569, 0.702, 0.877, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.782, 0.68, 0.805, 1.0], 'all_L1': [0.712, 0.726, 0.807, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.482, 0.734, 1.0], 'all_L1': [0.548, 0.518, 0.694, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.803, 0.921, 1.0], 'all_L1': [0.596, 0.765, 0.902, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.1, 0.362, 0.425, 0.48], 'all_L1': [0.151, 0.33, 0.31, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.359, 0.252, 0.219, 0.194], 'all_L1': [0.404, 0.231, 0.164, 0.139]}), defaultdict(<class 'list'>, {'all_KL': [0.368, 0.302, 0.229, 0.355], 'all_L1': [0.396, 0.288, 0.264, 0.368]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.633, 0.464, 0.545], 'all_L1': [0.482, 0.585, 0.461, 0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.335, 0.246, 0.25, 0.356], 'all_L1': [0.371, 0.277, 0.224, 0.339]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.786 +- 0.044, 0.689 +- 0.113, 0.776 +- 0.103, 1.000 +- 0.000
suff++ class all_KL  =  0.859 +- 0.069, 0.716 +- 0.110, 0.789 +- 0.119, 1.000 +- 0.000
suff++_acc_int  =  0.353 +- 0.022, 0.519 +- 0.094, 0.749 +- 0.062
nec class all_L1  =  0.228 +- 0.042, 0.436 +- 0.042, 0.498 +- 0.005, 0.496 +- 0.013
nec class all_KL  =  0.148 +- 0.078, 0.420 +- 0.046, 0.531 +- 0.031, 0.545 +- 0.038
nec_acc_int  =  0.316 +- 0.027, 0.398 +- 0.024, 0.494 +- 0.031, 0.530 +- 0.009

Eval split val
suff++ class all_L1  =  0.784 +- 0.092, 0.678 +- 0.048, 0.676 +- 0.056, 1.000 +- 0.000
suff++ class all_KL  =  0.803 +- 0.130, 0.715 +- 0.051, 0.707 +- 0.072, 1.000 +- 0.000
suff++_acc_int  =  0.508 +- 0.039, 0.577 +- 0.057, 0.637 +- 0.023
nec class all_L1  =  0.299 +- 0.072, 0.395 +- 0.071, 0.464 +- 0.064, 0.443 +- 0.077
nec class all_KL  =  0.277 +- 0.102, 0.377 +- 0.093, 0.456 +- 0.086, 0.454 +- 0.105
nec_acc_int  =  0.359 +- 0.022, 0.475 +- 0.050, 0.513 +- 0.043, 0.557 +- 0.010

Eval split test
suff++ class all_L1  =  0.656 +- 0.115, 0.666 +- 0.088, 0.796 +- 0.086, 1.000 +- 0.000
suff++ class all_KL  =  0.648 +- 0.168, 0.637 +- 0.111, 0.770 +- 0.124, 1.000 +- 0.000
suff++_acc_int  =  0.458 +- 0.078, 0.412 +- 0.056, 0.391 +- 0.027
nec class all_L1  =  0.361 +- 0.111, 0.342 +- 0.125, 0.285 +- 0.100, 0.328 +- 0.112
nec class all_KL  =  0.334 +- 0.132, 0.359 +- 0.143, 0.317 +- 0.105, 0.386 +- 0.121
nec_acc_int  =  0.332 +- 0.018, 0.342 +- 0.012, 0.345 +- 0.028, 0.362 +- 0.016


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.507 +- 0.005, 0.562 +- 0.040, 0.637 +- 0.054, 0.748 +- 0.006
Faith. Armon (L1)= 		  =  0.350 +- 0.046, 0.525 +- 0.020, 0.604 +- 0.036, 0.663 +- 0.011
Faith. GMean (L1)= 	  =  0.420 +- 0.027, 0.543 +- 0.028, 0.620 +- 0.044, 0.704 +- 0.009
Faith. Aritm (KL)= 		  =  0.504 +- 0.006, 0.568 +- 0.042, 0.660 +- 0.064, 0.773 +- 0.019
Faith. Armon (KL)= 		  =  0.242 +- 0.094, 0.522 +- 0.028, 0.631 +- 0.049, 0.705 +- 0.032
Faith. GMean (KL)= 	  =  0.344 +- 0.064, 0.544 +- 0.032, 0.645 +- 0.056, 0.738 +- 0.026

Eval split val
Faith. Aritm (L1)= 		  =  0.541 +- 0.020, 0.536 +- 0.034, 0.570 +- 0.008, 0.722 +- 0.039
Faith. Armon (L1)= 		  =  0.422 +- 0.056, 0.494 +- 0.054, 0.544 +- 0.027, 0.610 +- 0.073
Faith. GMean (L1)= 	  =  0.477 +- 0.032, 0.514 +- 0.044, 0.557 +- 0.017, 0.663 +- 0.058
Faith. Aritm (KL)= 		  =  0.540 +- 0.027, 0.546 +- 0.050, 0.582 +- 0.015, 0.727 +- 0.053
Faith. Armon (KL)= 		  =  0.390 +- 0.078, 0.485 +- 0.083, 0.544 +- 0.038, 0.618 +- 0.096
Faith. GMean (KL)= 	  =  0.456 +- 0.046, 0.514 +- 0.067, 0.562 +- 0.026, 0.669 +- 0.076

Eval split test
Faith. Aritm (L1)= 		  =  0.508 +- 0.026, 0.504 +- 0.031, 0.540 +- 0.027, 0.664 +- 0.056
Faith. Armon (L1)= 		  =  0.442 +- 0.095, 0.429 +- 0.066, 0.403 +- 0.091, 0.482 +- 0.134
Faith. GMean (L1)= 	  =  0.471 +- 0.060, 0.464 +- 0.048, 0.464 +- 0.060, 0.563 +- 0.106
Faith. Aritm (KL)= 		  =  0.491 +- 0.047, 0.498 +- 0.039, 0.544 +- 0.042, 0.693 +- 0.060
Faith. Armon (KL)= 		  =  0.402 +- 0.115, 0.429 +- 0.065, 0.429 +- 0.084, 0.546 +- 0.131
Faith. GMean (KL)= 	  =  0.438 +- 0.078, 0.461 +- 0.048, 0.481 +- 0.057, 0.613 +- 0.102
Computed for split load_split = id



Completed in  0:06:01.744120  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:22:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:22:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3470) +- tensor(0.1787)
F1 for r=0.3 = 0.494
WIoU for r=0.3 = 0.372
F1 for r=0.6 = 0.578
WIoU for r=0.6 = 0.463
F1 for r=0.9 = 0.520
WIoU for r=0.9 = 0.418
F1 for r=1.0 = 0.491
WIoU for r=1.0 = 0.399
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1406) +- tensor(0.0657)
F1 for r=0.3 = 0.347
WIoU for r=0.3 = 0.287
F1 for r=0.6 = 0.303
WIoU for r=0.6 = 0.241
F1 for r=0.9 = 0.259
WIoU for r=0.9 = 0.205
F1 for r=1.0 = 0.241
WIoU for r=1.0 = 0.192
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0247)
F1 for r=0.3 = 0.195
WIoU for r=0.3 = 0.136
F1 for r=0.6 = 0.149
WIoU for r=0.6 = 0.098
F1 for r=0.9 = 0.121
WIoU for r=0.9 = 0.079
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.074


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.35
Model XAI F1 of binarized graphs for r=0.3 =  0.493784
Model XAI WIoU of binarized graphs for r=0.3 =  0.3717520000000001
len(reference) = 474
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF++ for r=0.3 class 0 = 0.764 +- 0.119 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 1 = 0.812 +- 0.119 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 2 = 0.794 +- 0.119 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all KL = 0.905 +- 0.119 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all L1 = 0.789 +- 0.134 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  0.578038
Model XAI WIoU of binarized graphs for r=0.6 =  0.463002
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.51
SUFF++ for r=0.6 class 0 = 0.71 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 1 = 0.862 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 all KL = 0.797 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 all L1 = 0.76 +- 0.213 (in-sample avg dev_std = 0.390)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  0.5196559999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.417694
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.768
SUFF++ for r=0.9 class 0 = 0.751 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 class 1 = 0.842 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 class 2 = 0.814 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 all KL = 0.855 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.9 all L1 = 0.802 +- 0.223 (in-sample avg dev_std = 0.274)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.498
Model XAI F1 of binarized graphs for r=0.3 =  0.34727199999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.287124
len(reference) = 498
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.478
SUFF++ for r=0.3 class 0 = 0.877 +- 0.094 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 class 1 = 0.912 +- 0.094 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 class 2 = 0.861 +- 0.094 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 all KL = 0.941 +- 0.094 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 all L1 = 0.884 +- 0.083 (in-sample avg dev_std = 0.227)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.534
Model XAI F1 of binarized graphs for r=0.6 =  0.303324
Model XAI WIoU of binarized graphs for r=0.6 =  0.24107
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.52
SUFF++ for r=0.6 class 0 = 0.697 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 1 = 0.798 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 2 = 0.687 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all KL = 0.751 +- 0.259 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all L1 = 0.727 +- 0.222 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.718
Model XAI F1 of binarized graphs for r=0.9 =  0.258956
Model XAI WIoU of binarized graphs for r=0.9 =  0.205058
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.655
SUFF++ for r=0.9 class 0 = 0.657 +- 0.231 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 1 = 0.806 +- 0.231 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 2 = 0.773 +- 0.231 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all KL = 0.793 +- 0.231 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all L1 = 0.744 +- 0.213 (in-sample avg dev_std = 0.341)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.418
Model XAI F1 of binarized graphs for r=0.3 =  0.19532600000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.136006
len(reference) = 498
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.407
SUFF++ for r=0.3 class 0 = 0.822 +- 0.204 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.3 class 1 = 0.875 +- 0.204 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.3 class 2 = 0.814 +- 0.204 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.3 all KL = 0.895 +- 0.204 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.3 all L1 = 0.838 +- 0.183 (in-sample avg dev_std = 0.221)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.368
Model XAI F1 of binarized graphs for r=0.6 =  0.1487
Model XAI WIoU of binarized graphs for r=0.6 =  0.098472
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF++ for r=0.6 class 0 = 0.593 +- 0.417 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 1 = 0.623 +- 0.417 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.417 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all KL = 0.525 +- 0.417 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all L1 = 0.614 +- 0.295 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.358
Model XAI F1 of binarized graphs for r=0.9 =  0.12144800000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.078936
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.382
SUFF++ for r=0.9 class 0 = 0.718 +- 0.431 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.9 class 1 = 0.716 +- 0.431 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.9 class 2 = 0.753 +- 0.431 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.9 all KL = 0.577 +- 0.431 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.9 all L1 = 0.729 +- 0.270 (in-sample avg dev_std = 0.484)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.344
Model XAI F1 of binarized graphs for r=0.3 =  0.493784
Model XAI WIoU of binarized graphs for r=0.3 =  0.3717520000000001
len(reference) = 500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.327
NEC for r=0.3 class 0 = 0.259 +- 0.173 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 1 = 0.2 +- 0.173 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 2 = 0.235 +- 0.173 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all KL = 0.113 +- 0.173 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all L1 = 0.232 +- 0.177 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  0.578038
Model XAI WIoU of binarized graphs for r=0.6 =  0.463002
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.406
NEC for r=0.6 class 0 = 0.405 +- 0.293 (in-sample avg dev_std = 0.448)
NEC for r=0.6 class 1 = 0.254 +- 0.293 (in-sample avg dev_std = 0.448)
NEC for r=0.6 class 2 = 0.447 +- 0.293 (in-sample avg dev_std = 0.448)
NEC for r=0.6 all KL = 0.344 +- 0.293 (in-sample avg dev_std = 0.448)
NEC for r=0.6 all L1 = 0.37 +- 0.245 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  0.5196559999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.417694
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.499
NEC for r=0.9 class 0 = 0.601 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.348 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.589 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.51 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.515 +- 0.213 (in-sample avg dev_std = 0.533)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.490856
Model XAI WIoU of binarized graphs for r=1.0 =  0.399332
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.542
NEC for r=1.0 class 0 = 0.551 +- 0.304 (in-sample avg dev_std = 0.552)
NEC for r=1.0 class 1 = 0.317 +- 0.304 (in-sample avg dev_std = 0.552)
NEC for r=1.0 class 2 = 0.555 +- 0.304 (in-sample avg dev_std = 0.552)
NEC for r=1.0 all KL = 0.479 +- 0.304 (in-sample avg dev_std = 0.552)
NEC for r=1.0 all L1 = 0.476 +- 0.222 (in-sample avg dev_std = 0.552)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.496
Model XAI F1 of binarized graphs for r=0.3 =  0.34727199999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.287124
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.24 +- 0.307 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1 = 0.137 +- 0.307 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 2 = 0.275 +- 0.307 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.169 +- 0.307 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.217 +- 0.262 (in-sample avg dev_std = 0.153)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  0.303324
Model XAI WIoU of binarized graphs for r=0.6 =  0.24107
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.357 +- 0.264 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 1 = 0.123 +- 0.264 (in-sample avg dev_std = 0.315)
NEC for r=0.6 class 2 = 0.352 +- 0.264 (in-sample avg dev_std = 0.315)
NEC for r=0.6 all KL = 0.226 +- 0.264 (in-sample avg dev_std = 0.315)
NEC for r=0.6 all L1 = 0.277 +- 0.247 (in-sample avg dev_std = 0.315)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.718
Model XAI F1 of binarized graphs for r=0.9 =  0.258956
Model XAI WIoU of binarized graphs for r=0.9 =  0.205058
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.458
NEC for r=0.9 class 0 = 0.524 +- 0.299 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 1 = 0.215 +- 0.299 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 2 = 0.524 +- 0.299 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all KL = 0.396 +- 0.299 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all L1 = 0.42 +- 0.260 (in-sample avg dev_std = 0.434)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.772
Model XAI F1 of binarized graphs for r=1.0 =  0.24084999999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.192248
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.515
NEC for r=1.0 class 0 = 0.495 +- 0.318 (in-sample avg dev_std = 0.470)
NEC for r=1.0 class 1 = 0.183 +- 0.318 (in-sample avg dev_std = 0.470)
NEC for r=1.0 class 2 = 0.469 +- 0.318 (in-sample avg dev_std = 0.470)
NEC for r=1.0 all KL = 0.375 +- 0.318 (in-sample avg dev_std = 0.470)
NEC for r=1.0 all L1 = 0.382 +- 0.267 (in-sample avg dev_std = 0.470)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.418
Model XAI F1 of binarized graphs for r=0.3 =  0.19532600000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.136006
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.21 +- 0.258 (in-sample avg dev_std = 0.256)
NEC for r=0.3 class 1 = 0.161 +- 0.258 (in-sample avg dev_std = 0.256)
NEC for r=0.3 class 2 = 0.201 +- 0.258 (in-sample avg dev_std = 0.256)
NEC for r=0.3 all KL = 0.145 +- 0.258 (in-sample avg dev_std = 0.256)
NEC for r=0.3 all L1 = 0.19 +- 0.214 (in-sample avg dev_std = 0.256)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.37
Model XAI F1 of binarized graphs for r=0.6 =  0.1487
Model XAI WIoU of binarized graphs for r=0.6 =  0.098472
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.358
NEC for r=0.6 class 0 = 0.341 +- 0.428 (in-sample avg dev_std = 0.279)
NEC for r=0.6 class 1 = 0.334 +- 0.428 (in-sample avg dev_std = 0.279)
NEC for r=0.6 class 2 = 0.385 +- 0.428 (in-sample avg dev_std = 0.279)
NEC for r=0.6 all KL = 0.392 +- 0.428 (in-sample avg dev_std = 0.279)
NEC for r=0.6 all L1 = 0.352 +- 0.333 (in-sample avg dev_std = 0.279)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.358
Model XAI F1 of binarized graphs for r=0.9 =  0.12144800000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.078936
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.352
NEC for r=0.9 class 0 = 0.259 +- 0.411 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 1 = 0.232 +- 0.411 (in-sample avg dev_std = 0.358)
NEC for r=0.9 class 2 = 0.24 +- 0.411 (in-sample avg dev_std = 0.358)
NEC for r=0.9 all KL = 0.353 +- 0.411 (in-sample avg dev_std = 0.358)
NEC for r=0.9 all L1 = 0.244 +- 0.287 (in-sample avg dev_std = 0.358)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.33
Model XAI F1 of binarized graphs for r=1.0 =  0.113164
Model XAI WIoU of binarized graphs for r=1.0 =  0.074078
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.366
NEC for r=1.0 class 0 = 0.247 +- 0.414 (in-sample avg dev_std = 0.288)
NEC for r=1.0 class 1 = 0.255 +- 0.414 (in-sample avg dev_std = 0.288)
NEC for r=1.0 class 2 = 0.246 +- 0.414 (in-sample avg dev_std = 0.288)
NEC for r=1.0 all KL = 0.389 +- 0.414 (in-sample avg dev_std = 0.288)
NEC for r=1.0 all L1 = 0.249 +- 0.274 (in-sample avg dev_std = 0.288)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:26:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:45 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:26:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3470) +- tensor(0.1787)
F1 for r=0.3 = 0.480
WIoU for r=0.3 = 0.358
F1 for r=0.6 = 0.560
WIoU for r=0.6 = 0.444
F1 for r=0.9 = 0.517
WIoU for r=0.9 = 0.424
F1 for r=1.0 = 0.491
WIoU for r=1.0 = 0.409
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1406) +- tensor(0.0657)
F1 for r=0.3 = 0.396
WIoU for r=0.3 = 0.360
F1 for r=0.6 = 0.318
WIoU for r=0.6 = 0.350
F1 for r=0.9 = 0.258
WIoU for r=0.9 = 0.342
F1 for r=1.0 = 0.241
WIoU for r=1.0 = 0.338
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0247)
F1 for r=0.3 = 0.246
WIoU for r=0.3 = 0.299
F1 for r=0.6 = 0.156
WIoU for r=0.6 = 0.284
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.285
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.284


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.344
Model XAI F1 of binarized graphs for r=0.3 =  0.48030600000000007
Model XAI WIoU of binarized graphs for r=0.3 =  0.35827
len(reference) = 477
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.335
SUFF++ for r=0.3 class 0 = 0.8 +- 0.110 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 class 1 = 0.839 +- 0.110 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 class 2 = 0.829 +- 0.110 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 all KL = 0.931 +- 0.110 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 all L1 = 0.822 +- 0.110 (in-sample avg dev_std = 0.222)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.558
Model XAI F1 of binarized graphs for r=0.6 =  0.559524
Model XAI WIoU of binarized graphs for r=0.6 =  0.44428
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.51
SUFF++ for r=0.6 class 0 = 0.673 +- 0.259 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 1 = 0.798 +- 0.259 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 2 = 0.722 +- 0.259 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all KL = 0.757 +- 0.259 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all L1 = 0.73 +- 0.206 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.776
Model XAI F1 of binarized graphs for r=0.9 =  0.516952
Model XAI WIoU of binarized graphs for r=0.9 =  0.424108
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.766
SUFF++ for r=0.9 class 0 = 0.804 +- 0.227 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 1 = 0.881 +- 0.227 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 2 = 0.807 +- 0.227 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all KL = 0.856 +- 0.227 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.208 (in-sample avg dev_std = 0.301)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  0.39597000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.359902
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.537
SUFF++ for r=0.3 class 0 = 0.803 +- 0.179 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 class 1 = 0.861 +- 0.179 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 class 2 = 0.813 +- 0.179 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all KL = 0.876 +- 0.179 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all L1 = 0.826 +- 0.163 (in-sample avg dev_std = 0.327)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.612
Model XAI F1 of binarized graphs for r=0.6 =  0.317982
Model XAI WIoU of binarized graphs for r=0.6 =  0.350218
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0 = 0.72 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 1 = 0.695 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 2 = 0.752 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all KL = 0.748 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all L1 = 0.722 +- 0.201 (in-sample avg dev_std = 0.425)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.654
Model XAI F1 of binarized graphs for r=0.9 =  0.258
Model XAI WIoU of binarized graphs for r=0.9 =  0.34213
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.692
SUFF++ for r=0.9 class 0 = 0.69 +- 0.249 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.249 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 class 2 = 0.688 +- 0.249 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 all KL = 0.765 +- 0.249 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 all L1 = 0.701 +- 0.238 (in-sample avg dev_std = 0.331)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  0.245778
Model XAI WIoU of binarized graphs for r=0.3 =  0.298942
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.586
SUFF++ for r=0.3 class 0 = 0.604 +- 0.323 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 class 1 = 0.565 +- 0.323 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 class 2 = 0.541 +- 0.323 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 all KL = 0.539 +- 0.323 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 all L1 = 0.57 +- 0.197 (in-sample avg dev_std = 0.534)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.406
Model XAI F1 of binarized graphs for r=0.6 =  0.15625400000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.284148
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.476
SUFF++ for r=0.6 class 0 = 0.752 +- 0.363 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.631 +- 0.363 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.686 +- 0.363 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.639 +- 0.363 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.69 +- 0.280 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.404
Model XAI F1 of binarized graphs for r=0.9 =  0.121896
Model XAI WIoU of binarized graphs for r=0.9 =  0.28512400000000004
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.394
SUFF++ for r=0.9 class 0 = 0.864 +- 0.275 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.275 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 2 = 0.869 +- 0.275 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.829 +- 0.275 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.858 +- 0.226 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.35
Model XAI F1 of binarized graphs for r=0.3 =  0.48030600000000007
Model XAI WIoU of binarized graphs for r=0.3 =  0.35827
len(reference) = 500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.231 +- 0.169 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 1 = 0.18 +- 0.169 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 2 = 0.177 +- 0.169 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all KL = 0.09 +- 0.169 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all L1 = 0.196 +- 0.164 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.558
Model XAI F1 of binarized graphs for r=0.6 =  0.559524
Model XAI WIoU of binarized graphs for r=0.6 =  0.44428
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.463 +- 0.315 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.292 +- 0.315 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.476 +- 0.315 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.389 +- 0.315 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.412 +- 0.235 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.776
Model XAI F1 of binarized graphs for r=0.9 =  0.516952
Model XAI WIoU of binarized graphs for r=0.9 =  0.424108
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.481
NEC for r=0.9 class 0 = 0.579 +- 0.289 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 1 = 0.345 +- 0.289 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 2 = 0.578 +- 0.289 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all KL = 0.542 +- 0.289 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all L1 = 0.503 +- 0.206 (in-sample avg dev_std = 0.602)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.9
Model XAI F1 of binarized graphs for r=1.0 =  0.490856
Model XAI WIoU of binarized graphs for r=1.0 =  0.408864
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.522
NEC for r=1.0 class 0 = 0.584 +- 0.297 (in-sample avg dev_std = 0.600)
NEC for r=1.0 class 1 = 0.358 +- 0.297 (in-sample avg dev_std = 0.600)
NEC for r=1.0 class 2 = 0.569 +- 0.297 (in-sample avg dev_std = 0.600)
NEC for r=1.0 all KL = 0.543 +- 0.297 (in-sample avg dev_std = 0.600)
NEC for r=1.0 all L1 = 0.506 +- 0.212 (in-sample avg dev_std = 0.600)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  0.39597000000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.359902
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.35 +- 0.346 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1 = 0.269 +- 0.346 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 2 = 0.413 +- 0.346 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.293 +- 0.346 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.343 +- 0.278 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.612
Model XAI F1 of binarized graphs for r=0.6 =  0.317982
Model XAI WIoU of binarized graphs for r=0.6 =  0.350218
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.449
NEC for r=0.6 class 0 = 0.493 +- 0.305 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 1 = 0.313 +- 0.305 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 2 = 0.553 +- 0.305 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all KL = 0.468 +- 0.305 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all L1 = 0.452 +- 0.221 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.652
Model XAI F1 of binarized graphs for r=0.9 =  0.258
Model XAI WIoU of binarized graphs for r=0.9 =  0.34213
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.52
NEC for r=0.9 class 0 = 0.53 +- 0.255 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.396 +- 0.255 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.575 +- 0.255 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.499 +- 0.255 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.499 +- 0.179 (in-sample avg dev_std = 0.510)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.698
Model XAI F1 of binarized graphs for r=1.0 =  0.24084999999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.33755799999999997
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.538
NEC for r=1.0 class 0 = 0.469 +- 0.302 (in-sample avg dev_std = 0.484)
NEC for r=1.0 class 1 = 0.354 +- 0.302 (in-sample avg dev_std = 0.484)
NEC for r=1.0 class 2 = 0.486 +- 0.302 (in-sample avg dev_std = 0.484)
NEC for r=1.0 all KL = 0.449 +- 0.302 (in-sample avg dev_std = 0.484)
NEC for r=1.0 all L1 = 0.436 +- 0.216 (in-sample avg dev_std = 0.484)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.548
Model XAI F1 of binarized graphs for r=0.3 =  0.245778
Model XAI WIoU of binarized graphs for r=0.3 =  0.298942
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.359
NEC for r=0.3 class 0 = 0.418 +- 0.321 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 1 = 0.375 +- 0.321 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 2 = 0.445 +- 0.321 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all KL = 0.387 +- 0.321 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all L1 = 0.412 +- 0.265 (in-sample avg dev_std = 0.354)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.406
Model XAI F1 of binarized graphs for r=0.6 =  0.15625400000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.284148
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.374
NEC for r=0.6 class 0 = 0.214 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 1 = 0.218 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 2 = 0.257 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.6 all KL = 0.239 +- 0.282 (in-sample avg dev_std = 0.306)
NEC for r=0.6 all L1 = 0.229 +- 0.257 (in-sample avg dev_std = 0.306)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.404
Model XAI F1 of binarized graphs for r=0.9 =  0.121896
Model XAI WIoU of binarized graphs for r=0.9 =  0.28512400000000004
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.369
NEC for r=0.9 class 0 = 0.168 +- 0.324 (in-sample avg dev_std = 0.270)
NEC for r=0.9 class 1 = 0.144 +- 0.324 (in-sample avg dev_std = 0.270)
NEC for r=0.9 class 2 = 0.136 +- 0.324 (in-sample avg dev_std = 0.270)
NEC for r=0.9 all KL = 0.184 +- 0.324 (in-sample avg dev_std = 0.270)
NEC for r=0.9 all L1 = 0.15 +- 0.255 (in-sample avg dev_std = 0.270)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.384
Model XAI F1 of binarized graphs for r=1.0 =  0.113164
Model XAI WIoU of binarized graphs for r=1.0 =  0.28429200000000004
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.365
NEC for r=1.0 class 0 = 0.147 +- 0.311 (in-sample avg dev_std = 0.285)
NEC for r=1.0 class 1 = 0.14 +- 0.311 (in-sample avg dev_std = 0.285)
NEC for r=1.0 class 2 = 0.117 +- 0.311 (in-sample avg dev_std = 0.285)
NEC for r=1.0 all KL = 0.177 +- 0.311 (in-sample avg dev_std = 0.285)
NEC for r=1.0 all L1 = 0.135 +- 0.233 (in-sample avg dev_std = 0.285)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:30:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:30:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3470) +- tensor(0.1787)
F1 for r=0.3 = 0.581
WIoU for r=0.3 = 0.469
F1 for r=0.6 = 0.612
WIoU for r=0.6 = 0.577
F1 for r=0.9 = 0.513
WIoU for r=0.9 = 0.575
F1 for r=1.0 = 0.491
WIoU for r=1.0 = 0.574
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1406) +- tensor(0.0657)
F1 for r=0.3 = 0.489
WIoU for r=0.3 = 0.475
F1 for r=0.6 = 0.350
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.260
WIoU for r=0.9 = 0.447
F1 for r=1.0 = 0.241
WIoU for r=1.0 = 0.446
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0247)
F1 for r=0.3 = 0.276
WIoU for r=0.3 = 0.216
F1 for r=0.6 = 0.173
WIoU for r=0.6 = 0.165
F1 for r=0.9 = 0.123
WIoU for r=0.9 = 0.146
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.142


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.366
Model XAI F1 of binarized graphs for r=0.3 =  0.5807519999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.468684
len(reference) = 483
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.349
SUFF++ for r=0.3 class 0 = 0.837 +- 0.198 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 1 = 0.928 +- 0.198 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 2 = 0.853 +- 0.198 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all KL = 0.899 +- 0.198 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all L1 = 0.871 +- 0.177 (in-sample avg dev_std = 0.282)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.6118140000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.5771360000000001
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.631
SUFF++ for r=0.6 class 0 = 0.757 +- 0.229 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 1 = 0.848 +- 0.229 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 2 = 0.723 +- 0.229 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all KL = 0.787 +- 0.229 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all L1 = 0.775 +- 0.201 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  0.5133
Model XAI WIoU of binarized graphs for r=0.9 =  0.5750060000000001
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.777
SUFF++ for r=0.9 class 0 = 0.845 +- 0.206 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.206 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 2 = 0.884 +- 0.206 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all KL = 0.883 +- 0.206 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all L1 = 0.867 +- 0.191 (in-sample avg dev_std = 0.305)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  0.489188
Model XAI WIoU of binarized graphs for r=0.3 =  0.474746
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.601
SUFF++ for r=0.3 class 0 = 0.803 +- 0.224 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 1 = 0.905 +- 0.224 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 2 = 0.811 +- 0.224 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all KL = 0.847 +- 0.224 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all L1 = 0.84 +- 0.189 (in-sample avg dev_std = 0.383)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.712
Model XAI F1 of binarized graphs for r=0.6 =  0.35022400000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.452772
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.684
SUFF++ for r=0.6 class 0 = 0.744 +- 0.189 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 1 = 0.78 +- 0.189 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 2 = 0.75 +- 0.189 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all KL = 0.824 +- 0.189 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all L1 = 0.758 +- 0.191 (in-sample avg dev_std = 0.346)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.259656
Model XAI WIoU of binarized graphs for r=0.9 =  0.447202
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.702
SUFF++ for r=0.9 class 0 = 0.734 +- 0.291 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.9 class 1 = 0.829 +- 0.291 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.9 class 2 = 0.82 +- 0.291 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.9 all KL = 0.789 +- 0.291 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.236 (in-sample avg dev_std = 0.402)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.276306
Model XAI WIoU of binarized graphs for r=0.3 =  0.21591000000000002
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.628
SUFF++ for r=0.3 class 0 = 0.705 +- 0.179 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 class 1 = 0.786 +- 0.179 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 class 2 = 0.698 +- 0.179 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 all KL = 0.811 +- 0.179 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.3 all L1 = 0.731 +- 0.154 (in-sample avg dev_std = 0.367)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.482
Model XAI F1 of binarized graphs for r=0.6 =  0.17274
Model XAI WIoU of binarized graphs for r=0.6 =  0.164666
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.547
SUFF++ for r=0.6 class 0 = 0.665 +- 0.241 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 class 1 = 0.801 +- 0.241 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 class 2 = 0.786 +- 0.241 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 all KL = 0.729 +- 0.241 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 all L1 = 0.75 +- 0.204 (in-sample avg dev_std = 0.359)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.372
Model XAI F1 of binarized graphs for r=0.9 =  0.12334
Model XAI WIoU of binarized graphs for r=0.9 =  0.14589
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.406
SUFF++ for r=0.9 class 0 = 0.805 +- 0.224 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 class 1 = 0.836 +- 0.224 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 class 2 = 0.849 +- 0.224 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 all KL = 0.83 +- 0.224 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.176 (in-sample avg dev_std = 0.351)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.37
Model XAI F1 of binarized graphs for r=0.3 =  0.5807519999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.468684
len(reference) = 500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.331
NEC for r=0.3 class 0 = 0.172 +- 0.236 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.108 +- 0.236 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.147 +- 0.236 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.099 +- 0.236 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.143 +- 0.218 (in-sample avg dev_std = 0.155)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.6118140000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.5771360000000001
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.533 +- 0.371 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 1 = 0.24 +- 0.371 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 2 = 0.537 +- 0.371 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all KL = 0.448 +- 0.371 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all L1 = 0.44 +- 0.290 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  0.5133
Model XAI WIoU of binarized graphs for r=0.9 =  0.5750060000000001
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.604 +- 0.324 (in-sample avg dev_std = 0.605)
NEC for r=0.9 class 1 = 0.277 +- 0.324 (in-sample avg dev_std = 0.605)
NEC for r=0.9 class 2 = 0.596 +- 0.324 (in-sample avg dev_std = 0.605)
NEC for r=0.9 all KL = 0.551 +- 0.324 (in-sample avg dev_std = 0.605)
NEC for r=0.9 all L1 = 0.495 +- 0.254 (in-sample avg dev_std = 0.605)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.490856
Model XAI WIoU of binarized graphs for r=1.0 =  0.574476
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.582 +- 0.331 (in-sample avg dev_std = 0.650)
NEC for r=1.0 class 1 = 0.246 +- 0.331 (in-sample avg dev_std = 0.650)
NEC for r=1.0 class 2 = 0.587 +- 0.331 (in-sample avg dev_std = 0.650)
NEC for r=1.0 all KL = 0.552 +- 0.331 (in-sample avg dev_std = 0.650)
NEC for r=1.0 all L1 = 0.475 +- 0.259 (in-sample avg dev_std = 0.650)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  0.489188
Model XAI WIoU of binarized graphs for r=0.3 =  0.474746
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.429 +- 0.429 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 1 = 0.072 +- 0.429 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 2 = 0.459 +- 0.429 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all KL = 0.33 +- 0.429 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all L1 = 0.319 +- 0.366 (in-sample avg dev_std = 0.176)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.712
Model XAI F1 of binarized graphs for r=0.6 =  0.35022400000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.452772
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.432
NEC for r=0.6 class 0 = 0.616 +- 0.352 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1 = 0.204 +- 0.352 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 2 = 0.598 +- 0.352 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.454 +- 0.352 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.472 +- 0.278 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  0.259656
Model XAI WIoU of binarized graphs for r=0.9 =  0.447202
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.56 +- 0.323 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 1 = 0.168 +- 0.323 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 2 = 0.547 +- 0.323 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all KL = 0.434 +- 0.323 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all L1 = 0.424 +- 0.279 (in-sample avg dev_std = 0.517)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  0.24084999999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.44613400000000003
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.533
NEC for r=1.0 class 0 = 0.647 +- 0.328 (in-sample avg dev_std = 0.545)
NEC for r=1.0 class 1 = 0.186 +- 0.328 (in-sample avg dev_std = 0.545)
NEC for r=1.0 class 2 = 0.609 +- 0.328 (in-sample avg dev_std = 0.545)
NEC for r=1.0 all KL = 0.501 +- 0.328 (in-sample avg dev_std = 0.545)
NEC for r=1.0 all L1 = 0.48 +- 0.270 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.276306
Model XAI WIoU of binarized graphs for r=0.3 =  0.21591000000000002
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.352
NEC for r=0.3 class 0 = 0.524 +- 0.414 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 1 = 0.167 +- 0.414 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 2 = 0.49 +- 0.414 (in-sample avg dev_std = 0.190)
NEC for r=0.3 all KL = 0.361 +- 0.414 (in-sample avg dev_std = 0.190)
NEC for r=0.3 all L1 = 0.391 +- 0.336 (in-sample avg dev_std = 0.190)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.482
Model XAI F1 of binarized graphs for r=0.6 =  0.17274
Model XAI WIoU of binarized graphs for r=0.6 =  0.164666
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.307 +- 0.270 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 1 = 0.137 +- 0.270 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 2 = 0.362 +- 0.270 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all KL = 0.261 +- 0.270 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all L1 = 0.266 +- 0.239 (in-sample avg dev_std = 0.313)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.374
Model XAI F1 of binarized graphs for r=0.9 =  0.12334
Model XAI WIoU of binarized graphs for r=0.9 =  0.14589
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.376
NEC for r=0.9 class 0 = 0.263 +- 0.231 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.17 +- 0.231 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.29 +- 0.231 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.199 +- 0.231 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.24 +- 0.204 (in-sample avg dev_std = 0.259)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.446
Model XAI F1 of binarized graphs for r=1.0 =  0.113164
Model XAI WIoU of binarized graphs for r=1.0 =  0.141928
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.356
NEC for r=1.0 class 0 = 0.341 +- 0.265 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 1 = 0.339 +- 0.265 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 2 = 0.332 +- 0.265 (in-sample avg dev_std = 0.318)
NEC for r=1.0 all KL = 0.336 +- 0.265 (in-sample avg dev_std = 0.318)
NEC for r=1.0 all L1 = 0.338 +- 0.208 (in-sample avg dev_std = 0.318)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:34:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:34:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:34:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:34:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:34:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:34:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:35:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3470) +- tensor(0.1787)
F1 for r=0.3 = 0.406
WIoU for r=0.3 = 0.347
F1 for r=0.6 = 0.416
WIoU for r=0.6 = 0.358
F1 for r=0.9 = 0.458
WIoU for r=0.9 = 0.395
F1 for r=1.0 = 0.491
WIoU for r=1.0 = 0.398
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1406) +- tensor(0.0657)
F1 for r=0.3 = 0.329
WIoU for r=0.3 = 0.335
F1 for r=0.6 = 0.268
WIoU for r=0.6 = 0.338
F1 for r=0.9 = 0.222
WIoU for r=0.9 = 0.341
F1 for r=1.0 = 0.241
WIoU for r=1.0 = 0.344
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0247)
F1 for r=0.3 = 0.168
WIoU for r=0.3 = 0.261
F1 for r=0.6 = 0.133
WIoU for r=0.6 = 0.267
F1 for r=0.9 = 0.102
WIoU for r=0.9 = 0.269
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.274


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.46
Model XAI F1 of binarized graphs for r=0.3 =  0.40641200000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.34704199999999996
len(reference) = 496
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.401
SUFF++ for r=0.3 class 0 = 0.646 +- 0.311 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 1 = 0.765 +- 0.311 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 2 = 0.722 +- 0.311 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 all KL = 0.706 +- 0.311 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 all L1 = 0.71 +- 0.277 (in-sample avg dev_std = 0.429)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.616
Model XAI F1 of binarized graphs for r=0.6 =  0.41573799999999994
Model XAI WIoU of binarized graphs for r=0.6 =  0.358482
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.459
SUFF++ for r=0.6 class 0 = 0.394 +- 0.281 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 1 = 0.609 +- 0.281 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 2 = 0.531 +- 0.281 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 all KL = 0.515 +- 0.281 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 all L1 = 0.51 +- 0.229 (in-sample avg dev_std = 0.533)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  0.457614
Model XAI WIoU of binarized graphs for r=0.9 =  0.395396
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.702
SUFF++ for r=0.9 class 0 = 0.638 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 class 1 = 0.729 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 class 2 = 0.656 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 all KL = 0.657 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 all L1 = 0.674 +- 0.254 (in-sample avg dev_std = 0.529)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  0.32938999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.33517399999999997
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.501
SUFF++ for r=0.3 class 0 = 0.558 +- 0.307 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 class 1 = 0.719 +- 0.307 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 class 2 = 0.675 +- 0.307 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 all KL = 0.61 +- 0.307 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.3 all L1 = 0.65 +- 0.260 (in-sample avg dev_std = 0.525)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.26817799999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.33773400000000003
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.518
SUFF++ for r=0.6 class 0 = 0.479 +- 0.276 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 1 = 0.688 +- 0.276 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 class 2 = 0.603 +- 0.276 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all KL = 0.633 +- 0.276 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.6 all L1 = 0.589 +- 0.225 (in-sample avg dev_std = 0.474)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  0.22224000000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.341396
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.606
SUFF++ for r=0.9 class 0 = 0.504 +- 0.306 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.9 class 1 = 0.625 +- 0.306 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.9 class 2 = 0.704 +- 0.306 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.9 all KL = 0.618 +- 0.306 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.9 all L1 = 0.609 +- 0.268 (in-sample avg dev_std = 0.451)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.16847199999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.26075
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.459
SUFF++ for r=0.3 class 0 = 0.515 +- 0.311 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 class 1 = 0.599 +- 0.311 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 class 2 = 0.577 +- 0.311 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 all KL = 0.487 +- 0.311 (in-sample avg dev_std = 0.603)
SUFF++ for r=0.3 all L1 = 0.563 +- 0.238 (in-sample avg dev_std = 0.603)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.426
Model XAI F1 of binarized graphs for r=0.6 =  0.13285
Model XAI WIoU of binarized graphs for r=0.6 =  0.26704
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.426
SUFF++ for r=0.6 class 0 = 0.513 +- 0.280 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 class 1 = 0.547 +- 0.280 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 class 2 = 0.56 +- 0.280 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all KL = 0.498 +- 0.280 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all L1 = 0.539 +- 0.201 (in-sample avg dev_std = 0.530)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.416
Model XAI F1 of binarized graphs for r=0.9 =  0.10166599999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.268972
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.394
SUFF++ for r=0.9 class 0 = 0.711 +- 0.226 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 1 = 0.757 +- 0.226 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 2 = 0.709 +- 0.226 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 all KL = 0.762 +- 0.226 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 all L1 = 0.726 +- 0.210 (in-sample avg dev_std = 0.365)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.40641200000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.34704199999999996
len(reference) = 500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.41 +- 0.355 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.224 +- 0.355 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.37 +- 0.355 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.343 +- 0.355 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.336 +- 0.313 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.614
Model XAI F1 of binarized graphs for r=0.6 =  0.41573799999999994
Model XAI WIoU of binarized graphs for r=0.6 =  0.358482
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.433
NEC for r=0.6 class 0 = 0.617 +- 0.308 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 1 = 0.358 +- 0.308 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 2 = 0.571 +- 0.308 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all KL = 0.521 +- 0.308 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all L1 = 0.518 +- 0.246 (in-sample avg dev_std = 0.537)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.457614
Model XAI WIoU of binarized graphs for r=0.9 =  0.395396
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.592 +- 0.310 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 1 = 0.267 +- 0.310 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 2 = 0.609 +- 0.310 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all KL = 0.556 +- 0.310 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all L1 = 0.492 +- 0.247 (in-sample avg dev_std = 0.644)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.932
Model XAI F1 of binarized graphs for r=1.0 =  0.490856
Model XAI WIoU of binarized graphs for r=1.0 =  0.39807400000000004
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.554
NEC for r=1.0 class 0 = 0.57 +- 0.295 (in-sample avg dev_std = 0.683)
NEC for r=1.0 class 1 = 0.281 +- 0.295 (in-sample avg dev_std = 0.683)
NEC for r=1.0 class 2 = 0.601 +- 0.295 (in-sample avg dev_std = 0.683)
NEC for r=1.0 all KL = 0.571 +- 0.295 (in-sample avg dev_std = 0.683)
NEC for r=1.0 all L1 = 0.487 +- 0.230 (in-sample avg dev_std = 0.683)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  0.32938999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.33517399999999997
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.378
NEC for r=0.3 class 0 = 0.512 +- 0.403 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 1 = 0.261 +- 0.403 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 2 = 0.516 +- 0.403 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all KL = 0.462 +- 0.403 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all L1 = 0.429 +- 0.340 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.26817799999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.33773400000000003
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.452
NEC for r=0.6 class 0 = 0.57 +- 0.381 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1 = 0.316 +- 0.381 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 2 = 0.606 +- 0.381 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.509 +- 0.381 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.496 +- 0.281 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  0.22224000000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.341396
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.513
NEC for r=0.9 class 0 = 0.621 +- 0.279 (in-sample avg dev_std = 0.578)
NEC for r=0.9 class 1 = 0.445 +- 0.279 (in-sample avg dev_std = 0.578)
NEC for r=0.9 class 2 = 0.626 +- 0.279 (in-sample avg dev_std = 0.578)
NEC for r=0.9 all KL = 0.622 +- 0.279 (in-sample avg dev_std = 0.578)
NEC for r=0.9 all L1 = 0.563 +- 0.219 (in-sample avg dev_std = 0.578)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.802
Model XAI F1 of binarized graphs for r=1.0 =  0.24084999999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.344026
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.51
NEC for r=1.0 class 0 = 0.605 +- 0.267 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 1 = 0.473 +- 0.267 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 2 = 0.635 +- 0.267 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all KL = 0.643 +- 0.267 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all L1 = 0.57 +- 0.210 (in-sample avg dev_std = 0.610)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.16847199999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.26075
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.359
NEC for r=0.3 class 0 = 0.539 +- 0.381 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1 = 0.383 +- 0.381 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 2 = 0.529 +- 0.381 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.51 +- 0.381 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.482 +- 0.320 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.426
Model XAI F1 of binarized graphs for r=0.6 =  0.13285
Model XAI WIoU of binarized graphs for r=0.6 =  0.26704
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.373
NEC for r=0.6 class 0 = 0.579 +- 0.373 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 1 = 0.487 +- 0.373 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 2 = 0.545 +- 0.373 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all KL = 0.579 +- 0.373 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all L1 = 0.537 +- 0.252 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.416
Model XAI F1 of binarized graphs for r=0.9 =  0.10166599999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.268972
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.349
NEC for r=0.9 class 0 = 0.46 +- 0.348 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 1 = 0.424 +- 0.348 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 2 = 0.382 +- 0.348 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all KL = 0.429 +- 0.348 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all L1 = 0.423 +- 0.237 (in-sample avg dev_std = 0.434)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.506
Model XAI F1 of binarized graphs for r=1.0 =  0.113164
Model XAI WIoU of binarized graphs for r=1.0 =  0.274084
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.356
NEC for r=1.0 class 0 = 0.486 +- 0.354 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 1 = 0.462 +- 0.354 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 2 = 0.351 +- 0.354 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all KL = 0.481 +- 0.354 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all L1 = 0.435 +- 0.254 (in-sample avg dev_std = 0.425)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:39:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:14 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:39:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3470) +- tensor(0.1787)
F1 for r=0.3 = 0.307
WIoU for r=0.3 = 0.232
F1 for r=0.6 = 0.397
WIoU for r=0.6 = 0.293
F1 for r=0.9 = 0.488
WIoU for r=0.9 = 0.379
F1 for r=1.0 = 0.491
WIoU for r=1.0 = 0.382
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1406) +- tensor(0.0657)
F1 for r=0.3 = 0.307
WIoU for r=0.3 = 0.288
F1 for r=0.6 = 0.250
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.224
WIoU for r=0.9 = 0.233
F1 for r=1.0 = 0.241
WIoU for r=1.0 = 0.238
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0247)
F1 for r=0.3 = 0.189
WIoU for r=0.3 = 0.271
F1 for r=0.6 = 0.139
WIoU for r=0.6 = 0.257
F1 for r=0.9 = 0.113
WIoU for r=0.9 = 0.248
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.247


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.302
Model XAI F1 of binarized graphs for r=0.3 =  0.307458
Model XAI WIoU of binarized graphs for r=0.3 =  0.23232000000000003
len(reference) = 496
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.326
SUFF++ for r=0.3 class 0 = 0.746 +- 0.145 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 class 1 = 0.769 +- 0.145 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 class 2 = 0.81 +- 0.145 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 all KL = 0.882 +- 0.145 (in-sample avg dev_std = 0.288)
SUFF++ for r=0.3 all L1 = 0.775 +- 0.145 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.374
Model XAI F1 of binarized graphs for r=0.6 =  0.396572
Model XAI WIoU of binarized graphs for r=0.6 =  0.29283200000000004
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.389
SUFF++ for r=0.6 class 0 = 0.559 +- 0.269 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 class 1 = 0.62 +- 0.269 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 class 2 = 0.573 +- 0.269 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 all KL = 0.625 +- 0.269 (in-sample avg dev_std = 0.525)
SUFF++ for r=0.6 all L1 = 0.583 +- 0.200 (in-sample avg dev_std = 0.525)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  0.488066
Model XAI WIoU of binarized graphs for r=0.9 =  0.378642
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.623
SUFF++ for r=0.9 class 0 = 0.568 +- 0.297 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 class 1 = 0.804 +- 0.297 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 class 2 = 0.605 +- 0.297 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 all KL = 0.67 +- 0.297 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.9 all L1 = 0.657 +- 0.267 (in-sample avg dev_std = 0.473)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.306772
Model XAI WIoU of binarized graphs for r=0.3 =  0.287666
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.463
SUFF++ for r=0.3 class 0 = 0.715 +- 0.251 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 1 = 0.84 +- 0.251 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 2 = 0.703 +- 0.251 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all KL = 0.78 +- 0.251 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all L1 = 0.753 +- 0.197 (in-sample avg dev_std = 0.445)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.552
Model XAI F1 of binarized graphs for r=0.6 =  0.250046
Model XAI WIoU of binarized graphs for r=0.6 =  0.24818
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.501
SUFF++ for r=0.6 class 0 = 0.62 +- 0.270 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 1 = 0.781 +- 0.270 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 2 = 0.632 +- 0.270 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all KL = 0.673 +- 0.270 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all L1 = 0.678 +- 0.231 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.624
Model XAI F1 of binarized graphs for r=0.9 =  0.22407
Model XAI WIoU of binarized graphs for r=0.9 =  0.23342200000000002
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.61
SUFF++ for r=0.9 class 0 = 0.657 +- 0.280 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.9 class 1 = 0.752 +- 0.280 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.9 class 2 = 0.629 +- 0.280 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.9 all KL = 0.722 +- 0.280 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.9 all L1 = 0.68 +- 0.243 (in-sample avg dev_std = 0.420)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.526
Model XAI F1 of binarized graphs for r=0.3 =  0.18878399999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.270898
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.468
SUFF++ for r=0.3 class 0 = 0.563 +- 0.290 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 class 1 = 0.675 +- 0.290 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 class 2 = 0.587 +- 0.290 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 all KL = 0.568 +- 0.290 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 all L1 = 0.609 +- 0.175 (in-sample avg dev_std = 0.611)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.464
Model XAI F1 of binarized graphs for r=0.6 =  0.13850400000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.256638
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.468
SUFF++ for r=0.6 class 0 = 0.723 +- 0.218 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 class 1 = 0.807 +- 0.218 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 class 2 = 0.763 +- 0.218 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 all KL = 0.805 +- 0.218 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 all L1 = 0.764 +- 0.223 (in-sample avg dev_std = 0.403)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.394
Model XAI F1 of binarized graphs for r=0.9 =  0.11341200000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.24829
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.408
SUFF++ for r=0.9 class 0 = 0.889 +- 0.159 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 1 = 0.886 +- 0.159 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 2 = 0.912 +- 0.159 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all KL = 0.915 +- 0.159 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all L1 = 0.895 +- 0.126 (in-sample avg dev_std = 0.193)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.3
Model XAI F1 of binarized graphs for r=0.3 =  0.307458
Model XAI WIoU of binarized graphs for r=0.3 =  0.23232000000000003
len(reference) = 500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.282
NEC for r=0.3 class 0 = 0.24 +- 0.172 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1 = 0.225 +- 0.172 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 2 = 0.188 +- 0.172 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.108 +- 0.172 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.218 +- 0.183 (in-sample avg dev_std = 0.195)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.376
Model XAI F1 of binarized graphs for r=0.6 =  0.396572
Model XAI WIoU of binarized graphs for r=0.6 =  0.29283200000000004
len(reference) = 500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.46 +- 0.298 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.392 +- 0.298 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.444 +- 0.298 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.389 +- 0.298 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.432 +- 0.224 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.716
Model XAI F1 of binarized graphs for r=0.9 =  0.488066
Model XAI WIoU of binarized graphs for r=0.9 =  0.378642
len(reference) = 500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.502
NEC for r=0.9 class 0 = 0.595 +- 0.305 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 1 = 0.273 +- 0.305 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 2 = 0.595 +- 0.305 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all KL = 0.49 +- 0.305 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all L1 = 0.491 +- 0.245 (in-sample avg dev_std = 0.551)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.898
Model XAI F1 of binarized graphs for r=1.0 =  0.490856
Model XAI WIoU of binarized graphs for r=1.0 =  0.381836
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0 = 0.58 +- 0.320 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 1 = 0.227 +- 0.320 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 2 = 0.596 +- 0.320 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all KL = 0.516 +- 0.320 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all L1 = 0.471 +- 0.248 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.306772
Model XAI WIoU of binarized graphs for r=0.3 =  0.287666
len(reference) = 500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.321 +- 0.341 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1 = 0.135 +- 0.341 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 2 = 0.353 +- 0.341 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.223 +- 0.341 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.269 +- 0.288 (in-sample avg dev_std = 0.195)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.552
Model XAI F1 of binarized graphs for r=0.6 =  0.250046
Model XAI WIoU of binarized graphs for r=0.6 =  0.24818
len(reference) = 500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.44 +- 0.338 (in-sample avg dev_std = 0.424)
NEC for r=0.6 class 1 = 0.189 +- 0.338 (in-sample avg dev_std = 0.424)
NEC for r=0.6 class 2 = 0.439 +- 0.338 (in-sample avg dev_std = 0.424)
NEC for r=0.6 all KL = 0.358 +- 0.338 (in-sample avg dev_std = 0.424)
NEC for r=0.6 all L1 = 0.355 +- 0.291 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.624
Model XAI F1 of binarized graphs for r=0.9 =  0.22407
Model XAI WIoU of binarized graphs for r=0.9 =  0.23342200000000002
len(reference) = 500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.454
NEC for r=0.9 class 0 = 0.589 +- 0.320 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 1 = 0.298 +- 0.320 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 2 = 0.611 +- 0.320 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all KL = 0.488 +- 0.320 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all L1 = 0.498 +- 0.253 (in-sample avg dev_std = 0.512)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.832
Model XAI F1 of binarized graphs for r=1.0 =  0.24084999999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.237604
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.526
NEC for r=1.0 class 0 = 0.613 +- 0.306 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 1 = 0.253 +- 0.306 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 2 = 0.552 +- 0.306 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all KL = 0.468 +- 0.306 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all L1 = 0.472 +- 0.239 (in-sample avg dev_std = 0.533)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.526
Model XAI F1 of binarized graphs for r=0.3 =  0.18878399999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.270898
len(reference) = 500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.343
NEC for r=0.3 class 0 = 0.388 +- 0.363 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 1 = 0.201 +- 0.363 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 2 = 0.444 +- 0.363 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all KL = 0.307 +- 0.363 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all L1 = 0.342 +- 0.304 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.464
Model XAI F1 of binarized graphs for r=0.6 =  0.13850400000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.256638
len(reference) = 500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.377
NEC for r=0.6 class 0 = 0.28 +- 0.272 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 1 = 0.192 +- 0.272 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 2 = 0.331 +- 0.272 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all KL = 0.223 +- 0.272 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all L1 = 0.266 +- 0.255 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.394
Model XAI F1 of binarized graphs for r=0.9 =  0.11341200000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.24829
len(reference) = 500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.371
NEC for r=0.9 class 0 = 0.212 +- 0.272 (in-sample avg dev_std = 0.364)
NEC for r=0.9 class 1 = 0.214 +- 0.272 (in-sample avg dev_std = 0.364)
NEC for r=0.9 class 2 = 0.266 +- 0.272 (in-sample avg dev_std = 0.364)
NEC for r=0.9 all KL = 0.249 +- 0.272 (in-sample avg dev_std = 0.364)
NEC for r=0.9 all L1 = 0.23 +- 0.194 (in-sample avg dev_std = 0.364)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.414
Model XAI F1 of binarized graphs for r=1.0 =  0.113164
Model XAI WIoU of binarized graphs for r=1.0 =  0.24741199999999997
len(reference) = 500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.39
NEC for r=1.0 class 0 = 0.299 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=1.0 class 1 = 0.359 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=1.0 class 2 = 0.301 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=1.0 all KL = 0.314 +- 0.301 (in-sample avg dev_std = 0.385)
NEC for r=1.0 all L1 = 0.32 +- 0.243 (in-sample avg dev_std = 0.385)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.905, 0.797, 0.855, 1.0], 'all_L1': [0.789, 0.76, 0.802, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.931, 0.757, 0.856, 1.0], 'all_L1': [0.822, 0.73, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.787, 0.883, 1.0], 'all_L1': [0.871, 0.775, 0.867, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.706, 0.515, 0.657, 1.0], 'all_L1': [0.71, 0.51, 0.674, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.625, 0.67, 1.0], 'all_L1': [0.775, 0.583, 0.657, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.113, 0.344, 0.51, 0.479], 'all_L1': [0.232, 0.37, 0.515, 0.476]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.389, 0.542, 0.543], 'all_L1': [0.196, 0.412, 0.503, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.099, 0.448, 0.551, 0.552], 'all_L1': [0.143, 0.44, 0.495, 0.475]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.521, 0.556, 0.571], 'all_L1': [0.336, 0.518, 0.492, 0.487]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.389, 0.49, 0.516], 'all_L1': [0.218, 0.432, 0.491, 0.471]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.941, 0.751, 0.793, 1.0], 'all_L1': [0.884, 0.727, 0.744, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.876, 0.748, 0.765, 1.0], 'all_L1': [0.826, 0.722, 0.701, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.847, 0.824, 0.789, 1.0], 'all_L1': [0.84, 0.758, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.633, 0.618, 1.0], 'all_L1': [0.65, 0.589, 0.609, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.78, 0.673, 0.722, 1.0], 'all_L1': [0.753, 0.678, 0.68, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.169, 0.226, 0.396, 0.375], 'all_L1': [0.217, 0.277, 0.42, 0.382]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.468, 0.499, 0.449], 'all_L1': [0.343, 0.452, 0.499, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.33, 0.454, 0.434, 0.501], 'all_L1': [0.319, 0.472, 0.424, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.462, 0.509, 0.622, 0.643], 'all_L1': [0.429, 0.496, 0.563, 0.57]}), defaultdict(<class 'list'>, {'all_KL': [0.223, 0.358, 0.488, 0.468], 'all_L1': [0.269, 0.355, 0.498, 0.472]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.895, 0.525, 0.577, 1.0], 'all_L1': [0.838, 0.614, 0.729, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.639, 0.829, 1.0], 'all_L1': [0.57, 0.69, 0.858, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.729, 0.83, 1.0], 'all_L1': [0.731, 0.75, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.498, 0.762, 1.0], 'all_L1': [0.563, 0.539, 0.726, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.805, 0.915, 1.0], 'all_L1': [0.609, 0.764, 0.895, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.145, 0.392, 0.353, 0.389], 'all_L1': [0.19, 0.352, 0.244, 0.249]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.239, 0.184, 0.177], 'all_L1': [0.412, 0.229, 0.15, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.261, 0.199, 0.336], 'all_L1': [0.391, 0.266, 0.24, 0.338]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.579, 0.429, 0.481], 'all_L1': [0.482, 0.537, 0.423, 0.435]}), defaultdict(<class 'list'>, {'all_KL': [0.307, 0.223, 0.249, 0.314], 'all_L1': [0.342, 0.266, 0.23, 0.32]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.793 +- 0.053, 0.672 +- 0.106, 0.766 +- 0.085, 1.000 +- 0.000
suff++ class all_KL  =  0.865 +- 0.081, 0.696 +- 0.110, 0.784 +- 0.099, 1.000 +- 0.000
suff++_acc_int  =  0.351 +- 0.026, 0.500 +- 0.079, 0.727 +- 0.059
nec class all_L1  =  0.225 +- 0.063, 0.434 +- 0.048, 0.499 +- 0.009, 0.483 +- 0.013
nec class all_KL  =  0.151 +- 0.097, 0.418 +- 0.061, 0.530 +- 0.026, 0.532 +- 0.032
nec_acc_int  =  0.322 +- 0.020, 0.404 +- 0.018, 0.502 +- 0.017, 0.545 +- 0.013

Eval split val
suff++ class all_L1  =  0.791 +- 0.082, 0.695 +- 0.059, 0.705 +- 0.062, 1.000 +- 0.000
suff++ class all_KL  =  0.811 +- 0.113, 0.726 +- 0.067, 0.737 +- 0.065, 1.000 +- 0.000
suff++_acc_int  =  0.516 +- 0.049, 0.567 +- 0.070, 0.653 +- 0.040
nec class all_L1  =  0.315 +- 0.071, 0.410 +- 0.082, 0.481 +- 0.053, 0.468 +- 0.062
nec class all_KL  =  0.295 +- 0.100, 0.403 +- 0.101, 0.488 +- 0.077, 0.487 +- 0.088
nec_acc_int  =  0.352 +- 0.013, 0.425 +- 0.025, 0.491 +- 0.028, 0.525 +- 0.011

Eval split test
suff++ class all_L1  =  0.662 +- 0.107, 0.671 +- 0.085, 0.808 +- 0.069, 1.000 +- 0.000
suff++ class all_KL  =  0.660 +- 0.162, 0.639 +- 0.117, 0.783 +- 0.114, 1.000 +- 0.000
suff++_acc_int  =  0.510 +- 0.083, 0.462 +- 0.052, 0.397 +- 0.009
nec class all_L1  =  0.363 +- 0.098, 0.330 +- 0.111, 0.257 +- 0.090, 0.295 +- 0.100
nec class all_KL  =  0.342 +- 0.119, 0.339 +- 0.134, 0.283 +- 0.094, 0.339 +- 0.100
nec_acc_int  =  0.353 +- 0.006, 0.373 +- 0.008, 0.363 +- 0.011, 0.366 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.509 +- 0.008, 0.553 +- 0.037, 0.633 +- 0.045, 0.742 +- 0.006
Faith. Armon (L1)= 		  =  0.343 +- 0.068, 0.519 +- 0.024, 0.603 +- 0.031, 0.651 +- 0.011
Faith. GMean (L1)= 	  =  0.416 +- 0.044, 0.536 +- 0.029, 0.618 +- 0.038, 0.695 +- 0.009
Faith. Aritm (KL)= 		  =  0.508 +- 0.010, 0.557 +- 0.040, 0.657 +- 0.054, 0.766 +- 0.016
Faith. Armon (KL)= 		  =  0.240 +- 0.112, 0.513 +- 0.033, 0.630 +- 0.041, 0.694 +- 0.028
Faith. GMean (KL)= 	  =  0.342 +- 0.076, 0.534 +- 0.034, 0.643 +- 0.047, 0.729 +- 0.022

Eval split val
Faith. Aritm (L1)= 		  =  0.553 +- 0.027, 0.553 +- 0.043, 0.593 +- 0.010, 0.734 +- 0.031
Faith. Armon (L1)= 		  =  0.442 +- 0.061, 0.509 +- 0.066, 0.567 +- 0.019, 0.635 +- 0.057
Faith. GMean (L1)= 	  =  0.493 +- 0.041, 0.530 +- 0.054, 0.580 +- 0.011, 0.683 +- 0.045
Faith. Aritm (KL)= 		  =  0.553 +- 0.032, 0.564 +- 0.056, 0.613 +- 0.013, 0.744 +- 0.044
Faith. Armon (KL)= 		  =  0.415 +- 0.087, 0.508 +- 0.091, 0.579 +- 0.032, 0.651 +- 0.077
Faith. GMean (KL)= 	  =  0.476 +- 0.057, 0.535 +- 0.074, 0.595 +- 0.022, 0.695 +- 0.062

Eval split test
Faith. Aritm (L1)= 		  =  0.513 +- 0.029, 0.501 +- 0.027, 0.532 +- 0.033, 0.648 +- 0.050
Faith. Armon (L1)= 		  =  0.451 +- 0.076, 0.423 +- 0.066, 0.379 +- 0.089, 0.447 +- 0.123
Faith. GMean (L1)= 	  =  0.479 +- 0.049, 0.460 +- 0.045, 0.447 +- 0.063, 0.535 +- 0.098
Faith. Aritm (KL)= 		  =  0.501 +- 0.051, 0.489 +- 0.036, 0.533 +- 0.049, 0.670 +- 0.050
Faith. Armon (KL)= 		  =  0.419 +- 0.093, 0.413 +- 0.071, 0.400 +- 0.089, 0.498 +- 0.115
Faith. GMean (KL)= 	  =  0.455 +- 0.063, 0.448 +- 0.049, 0.459 +- 0.064, 0.576 +- 0.090
Computed for split load_split = id



Completed in  0:20:47.702781  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:43:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:43:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:43:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:43:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:43:54 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:43:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:44:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.486
WIoU for r=0.3 = 0.364
F1 for r=0.6 = 0.571
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.522
WIoU for r=0.9 = 0.418
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.401
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.334
WIoU for r=0.3 = 0.273
F1 for r=0.6 = 0.295
WIoU for r=0.6 = 0.231
F1 for r=0.9 = 0.256
WIoU for r=0.9 = 0.199
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.187
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.192
WIoU for r=0.3 = 0.131
F1 for r=0.6 = 0.147
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.078
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.073


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.358
Model XAI F1 of binarized graphs for r=0.3 =  0.4858
Model XAI WIoU of binarized graphs for r=0.3 =  0.3643875
len(reference) = 765
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.349
SUFF++ for r=0.3 class 0 = 0.772 +- 0.117 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 1 = 0.808 +- 0.117 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 2 = 0.787 +- 0.117 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all KL = 0.906 +- 0.117 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all L1 = 0.788 +- 0.132 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.5708199999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.453915
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.497
SUFF++ for r=0.6 class 0 = 0.73 +- 0.241 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 1 = 0.857 +- 0.241 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 class 2 = 0.738 +- 0.241 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all KL = 0.814 +- 0.241 (in-sample avg dev_std = 0.370)
SUFF++ for r=0.6 all L1 = 0.774 +- 0.209 (in-sample avg dev_std = 0.370)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.793
Model XAI F1 of binarized graphs for r=0.9 =  0.5218200000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.41843125000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.777
SUFF++ for r=0.9 class 0 = 0.769 +- 0.201 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 1 = 0.842 +- 0.201 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 2 = 0.827 +- 0.201 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 all KL = 0.867 +- 0.201 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 all L1 = 0.812 +- 0.214 (in-sample avg dev_std = 0.267)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.474
Model XAI F1 of binarized graphs for r=0.3 =  0.33412624999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.27287
len(reference) = 796
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.449
SUFF++ for r=0.3 class 0 = 0.862 +- 0.116 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.3 class 1 = 0.907 +- 0.116 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.3 class 2 = 0.868 +- 0.116 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.3 all KL = 0.937 +- 0.116 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.3 all L1 = 0.879 +- 0.096 (in-sample avg dev_std = 0.233)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.516
Model XAI F1 of binarized graphs for r=0.6 =  0.2948075
Model XAI WIoU of binarized graphs for r=0.6 =  0.23113375000000003
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.514
SUFF++ for r=0.6 class 0 = 0.705 +- 0.255 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 1 = 0.806 +- 0.255 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 2 = 0.701 +- 0.255 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all KL = 0.759 +- 0.255 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all L1 = 0.737 +- 0.218 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.25588125
Model XAI WIoU of binarized graphs for r=0.9 =  0.19924624999999999
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.65
SUFF++ for r=0.9 class 0 = 0.658 +- 0.228 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 1 = 0.808 +- 0.228 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 2 = 0.774 +- 0.228 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 all KL = 0.795 +- 0.228 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 all L1 = 0.746 +- 0.210 (in-sample avg dev_std = 0.346)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.415
Model XAI F1 of binarized graphs for r=0.3 =  0.19157874999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.13074124999999998
len(reference) = 798
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.41
SUFF++ for r=0.3 class 0 = 0.824 +- 0.199 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 1 = 0.879 +- 0.199 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 2 = 0.827 +- 0.199 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 all KL = 0.9 +- 0.199 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 all L1 = 0.844 +- 0.178 (in-sample avg dev_std = 0.218)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.359
Model XAI F1 of binarized graphs for r=0.6 =  0.14660250000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.09557874999999999
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.388
SUFF++ for r=0.6 class 0 = 0.602 +- 0.423 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 class 1 = 0.597 +- 0.423 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.423 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 all KL = 0.521 +- 0.423 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 all L1 = 0.608 +- 0.302 (in-sample avg dev_std = 0.543)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.349
Model XAI F1 of binarized graphs for r=0.9 =  0.12152625
Model XAI WIoU of binarized graphs for r=0.9 =  0.07779125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.37
SUFF++ for r=0.9 class 0 = 0.702 +- 0.428 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.9 class 1 = 0.735 +- 0.428 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.9 class 2 = 0.762 +- 0.428 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.9 all KL = 0.583 +- 0.428 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.9 all L1 = 0.732 +- 0.272 (in-sample avg dev_std = 0.467)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.354
Model XAI F1 of binarized graphs for r=0.3 =  0.4858
Model XAI WIoU of binarized graphs for r=0.3 =  0.3643875
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.252 +- 0.172 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 1 = 0.206 +- 0.172 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 2 = 0.236 +- 0.172 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.112 +- 0.172 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.232 +- 0.176 (in-sample avg dev_std = 0.200)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.5708199999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.453915
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.41
NEC for r=0.6 class 0 = 0.405 +- 0.290 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.242 +- 0.290 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.436 +- 0.290 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.335 +- 0.290 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.363 +- 0.243 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.793
Model XAI F1 of binarized graphs for r=0.9 =  0.5218200000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.41843125000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.504
NEC for r=0.9 class 0 = 0.59 +- 0.285 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.344 +- 0.285 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.591 +- 0.285 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.509 +- 0.285 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.511 +- 0.213 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.40064875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.535
NEC for r=1.0 class 0 = 0.549 +- 0.303 (in-sample avg dev_std = 0.561)
NEC for r=1.0 class 1 = 0.327 +- 0.303 (in-sample avg dev_std = 0.561)
NEC for r=1.0 class 2 = 0.552 +- 0.303 (in-sample avg dev_std = 0.561)
NEC for r=1.0 all KL = 0.486 +- 0.303 (in-sample avg dev_std = 0.561)
NEC for r=1.0 all L1 = 0.478 +- 0.221 (in-sample avg dev_std = 0.561)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.33412624999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.27287
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.239 +- 0.291 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1 = 0.144 +- 0.291 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 2 = 0.229 +- 0.291 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.153 +- 0.291 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.204 +- 0.249 (in-sample avg dev_std = 0.153)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.516
Model XAI F1 of binarized graphs for r=0.6 =  0.2948075
Model XAI WIoU of binarized graphs for r=0.6 =  0.23113375000000003
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.355 +- 0.261 (in-sample avg dev_std = 0.308)
NEC for r=0.6 class 1 = 0.122 +- 0.261 (in-sample avg dev_std = 0.308)
NEC for r=0.6 class 2 = 0.326 +- 0.261 (in-sample avg dev_std = 0.308)
NEC for r=0.6 all KL = 0.219 +- 0.261 (in-sample avg dev_std = 0.308)
NEC for r=0.6 all L1 = 0.268 +- 0.243 (in-sample avg dev_std = 0.308)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.25588125
Model XAI WIoU of binarized graphs for r=0.9 =  0.19924624999999999
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.46
NEC for r=0.9 class 0 = 0.523 +- 0.299 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.213 +- 0.299 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.511 +- 0.299 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.389 +- 0.299 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.415 +- 0.262 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.761
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.18704
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.506
NEC for r=1.0 class 0 = 0.492 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=1.0 class 1 = 0.16 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=1.0 class 2 = 0.449 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=1.0 all KL = 0.359 +- 0.325 (in-sample avg dev_std = 0.443)
NEC for r=1.0 all L1 = 0.367 +- 0.277 (in-sample avg dev_std = 0.443)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.415
Model XAI F1 of binarized graphs for r=0.3 =  0.19157874999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.13074124999999998
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.21 +- 0.262 (in-sample avg dev_std = 0.259)
NEC for r=0.3 class 1 = 0.161 +- 0.262 (in-sample avg dev_std = 0.259)
NEC for r=0.3 class 2 = 0.194 +- 0.262 (in-sample avg dev_std = 0.259)
NEC for r=0.3 all KL = 0.144 +- 0.262 (in-sample avg dev_std = 0.259)
NEC for r=0.3 all L1 = 0.188 +- 0.214 (in-sample avg dev_std = 0.259)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.359
Model XAI F1 of binarized graphs for r=0.6 =  0.14660250000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.09557874999999999
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.355
NEC for r=0.6 class 0 = 0.334 +- 0.428 (in-sample avg dev_std = 0.268)
NEC for r=0.6 class 1 = 0.333 +- 0.428 (in-sample avg dev_std = 0.268)
NEC for r=0.6 class 2 = 0.356 +- 0.428 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all KL = 0.381 +- 0.428 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all L1 = 0.341 +- 0.330 (in-sample avg dev_std = 0.268)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.349
Model XAI F1 of binarized graphs for r=0.9 =  0.12152625
Model XAI WIoU of binarized graphs for r=0.9 =  0.07779125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.349
NEC for r=0.9 class 0 = 0.271 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.9 class 1 = 0.239 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.9 class 2 = 0.247 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.9 all KL = 0.359 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.9 all L1 = 0.252 +- 0.292 (in-sample avg dev_std = 0.362)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.333
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.07303625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.357
NEC for r=1.0 class 0 = 0.271 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 class 1 = 0.248 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 class 2 = 0.271 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 all KL = 0.411 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 all L1 = 0.263 +- 0.273 (in-sample avg dev_std = 0.307)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:50:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:50:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.482
WIoU for r=0.3 = 0.360
F1 for r=0.6 = 0.562
WIoU for r=0.6 = 0.446
F1 for r=0.9 = 0.519
WIoU for r=0.9 = 0.426
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.411
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.386
WIoU for r=0.3 = 0.347
F1 for r=0.6 = 0.314
WIoU for r=0.6 = 0.338
F1 for r=0.9 = 0.255
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.325
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.245
WIoU for r=0.3 = 0.290
F1 for r=0.6 = 0.156
WIoU for r=0.6 = 0.275
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.276
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.275


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.354
Model XAI F1 of binarized graphs for r=0.3 =  0.48195374999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.36006374999999996
len(reference) = 757
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF++ for r=0.3 class 0 = 0.785 +- 0.135 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 class 1 = 0.83 +- 0.135 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 class 2 = 0.811 +- 0.135 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 all KL = 0.918 +- 0.135 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 all L1 = 0.808 +- 0.124 (in-sample avg dev_std = 0.232)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.554
Model XAI F1 of binarized graphs for r=0.6 =  0.56219125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4460825
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.512
SUFF++ for r=0.6 class 0 = 0.667 +- 0.251 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.797 +- 0.251 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.707 +- 0.251 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.753 +- 0.251 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.723 +- 0.199 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.779
Model XAI F1 of binarized graphs for r=0.9 =  0.5190312499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.42578249999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.763
SUFF++ for r=0.9 class 0 = 0.799 +- 0.228 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 1 = 0.874 +- 0.228 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 2 = 0.821 +- 0.228 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all KL = 0.855 +- 0.228 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.206 (in-sample avg dev_std = 0.306)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.544
Model XAI F1 of binarized graphs for r=0.3 =  0.38594750000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.34671375
len(reference) = 799
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0 = 0.781 +- 0.197 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.3 class 1 = 0.852 +- 0.197 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.3 class 2 = 0.801 +- 0.197 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.3 all KL = 0.862 +- 0.197 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.3 all L1 = 0.811 +- 0.174 (in-sample avg dev_std = 0.343)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.611
Model XAI F1 of binarized graphs for r=0.6 =  0.31353875000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.3376925
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0 = 0.73 +- 0.235 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 class 1 = 0.711 +- 0.235 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 class 2 = 0.754 +- 0.235 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 all KL = 0.757 +- 0.235 (in-sample avg dev_std = 0.416)
SUFF++ for r=0.6 all L1 = 0.731 +- 0.196 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.25537375
Model XAI WIoU of binarized graphs for r=0.9 =  0.32952624999999997
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.688
SUFF++ for r=0.9 class 0 = 0.695 +- 0.247 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.9 class 1 = 0.728 +- 0.247 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.9 class 2 = 0.677 +- 0.247 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.9 all KL = 0.762 +- 0.247 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.9 all L1 = 0.7 +- 0.235 (in-sample avg dev_std = 0.357)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  0.24477625
Model XAI WIoU of binarized graphs for r=0.3 =  0.28956375
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.569
SUFF++ for r=0.3 class 0 = 0.594 +- 0.324 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 class 1 = 0.568 +- 0.324 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.324 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 all KL = 0.545 +- 0.324 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 all L1 = 0.576 +- 0.194 (in-sample avg dev_std = 0.546)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.399
Model XAI F1 of binarized graphs for r=0.6 =  0.155775
Model XAI WIoU of binarized graphs for r=0.6 =  0.27471625000000005
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.474
SUFF++ for r=0.6 class 0 = 0.756 +- 0.354 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.647 +- 0.354 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.681 +- 0.354 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.659 +- 0.354 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.695 +- 0.279 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.389
Model XAI F1 of binarized graphs for r=0.9 =  0.12197875
Model XAI WIoU of binarized graphs for r=0.9 =  0.27609875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.386
SUFF++ for r=0.9 class 0 = 0.848 +- 0.277 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 1 = 0.847 +- 0.277 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 2 = 0.846 +- 0.277 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all KL = 0.815 +- 0.277 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all L1 = 0.847 +- 0.232 (in-sample avg dev_std = 0.294)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.356
Model XAI F1 of binarized graphs for r=0.3 =  0.48195374999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.36006374999999996
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.216 +- 0.171 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1 = 0.172 +- 0.171 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 2 = 0.191 +- 0.171 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.089 +- 0.171 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.194 +- 0.162 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.554
Model XAI F1 of binarized graphs for r=0.6 =  0.56219125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4460825
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.451 +- 0.314 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.293 +- 0.314 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.461 +- 0.314 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.38 +- 0.314 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.403 +- 0.235 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.779
Model XAI F1 of binarized graphs for r=0.9 =  0.5190312499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.42578249999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.48
NEC for r=0.9 class 0 = 0.561 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 1 = 0.359 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 2 = 0.582 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all KL = 0.54 +- 0.286 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all L1 = 0.503 +- 0.204 (in-sample avg dev_std = 0.600)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.41093
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.522
NEC for r=1.0 class 0 = 0.575 +- 0.304 (in-sample avg dev_std = 0.598)
NEC for r=1.0 class 1 = 0.355 +- 0.304 (in-sample avg dev_std = 0.598)
NEC for r=1.0 class 2 = 0.561 +- 0.304 (in-sample avg dev_std = 0.598)
NEC for r=1.0 all KL = 0.536 +- 0.304 (in-sample avg dev_std = 0.598)
NEC for r=1.0 all L1 = 0.499 +- 0.216 (in-sample avg dev_std = 0.598)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  0.38594750000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.34671375
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.36 +- 0.336 (in-sample avg dev_std = 0.264)
NEC for r=0.3 class 1 = 0.266 +- 0.336 (in-sample avg dev_std = 0.264)
NEC for r=0.3 class 2 = 0.377 +- 0.336 (in-sample avg dev_std = 0.264)
NEC for r=0.3 all KL = 0.279 +- 0.336 (in-sample avg dev_std = 0.264)
NEC for r=0.3 all L1 = 0.334 +- 0.270 (in-sample avg dev_std = 0.264)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.611
Model XAI F1 of binarized graphs for r=0.6 =  0.31353875000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.3376925
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.448
NEC for r=0.6 class 0 = 0.489 +- 0.303 (in-sample avg dev_std = 0.513)
NEC for r=0.6 class 1 = 0.328 +- 0.303 (in-sample avg dev_std = 0.513)
NEC for r=0.6 class 2 = 0.541 +- 0.303 (in-sample avg dev_std = 0.513)
NEC for r=0.6 all KL = 0.469 +- 0.303 (in-sample avg dev_std = 0.513)
NEC for r=0.6 all L1 = 0.452 +- 0.217 (in-sample avg dev_std = 0.513)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.659
Model XAI F1 of binarized graphs for r=0.9 =  0.25537375
Model XAI WIoU of binarized graphs for r=0.9 =  0.32952624999999997
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.511 +- 0.260 (in-sample avg dev_std = 0.524)
NEC for r=0.9 class 1 = 0.394 +- 0.260 (in-sample avg dev_std = 0.524)
NEC for r=0.9 class 2 = 0.578 +- 0.260 (in-sample avg dev_std = 0.524)
NEC for r=0.9 all KL = 0.493 +- 0.260 (in-sample avg dev_std = 0.524)
NEC for r=0.9 all L1 = 0.493 +- 0.179 (in-sample avg dev_std = 0.524)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.701
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.32478625000000005
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.528
NEC for r=1.0 class 0 = 0.462 +- 0.311 (in-sample avg dev_std = 0.485)
NEC for r=1.0 class 1 = 0.347 +- 0.311 (in-sample avg dev_std = 0.485)
NEC for r=1.0 class 2 = 0.484 +- 0.311 (in-sample avg dev_std = 0.485)
NEC for r=1.0 all KL = 0.441 +- 0.311 (in-sample avg dev_std = 0.485)
NEC for r=1.0 all L1 = 0.431 +- 0.220 (in-sample avg dev_std = 0.485)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.544
Model XAI F1 of binarized graphs for r=0.3 =  0.24477625
Model XAI WIoU of binarized graphs for r=0.3 =  0.28956375
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.347
NEC for r=0.3 class 0 = 0.404 +- 0.325 (in-sample avg dev_std = 0.338)
NEC for r=0.3 class 1 = 0.388 +- 0.325 (in-sample avg dev_std = 0.338)
NEC for r=0.3 class 2 = 0.464 +- 0.325 (in-sample avg dev_std = 0.338)
NEC for r=0.3 all KL = 0.395 +- 0.325 (in-sample avg dev_std = 0.338)
NEC for r=0.3 all L1 = 0.417 +- 0.269 (in-sample avg dev_std = 0.338)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.399
Model XAI F1 of binarized graphs for r=0.6 =  0.155775
Model XAI WIoU of binarized graphs for r=0.6 =  0.27471625000000005
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.219 +- 0.287 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 1 = 0.219 +- 0.287 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 2 = 0.278 +- 0.287 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all KL = 0.247 +- 0.287 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all L1 = 0.238 +- 0.264 (in-sample avg dev_std = 0.299)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.389
Model XAI F1 of binarized graphs for r=0.9 =  0.12197875
Model XAI WIoU of binarized graphs for r=0.9 =  0.27609875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.346
NEC for r=0.9 class 0 = 0.193 +- 0.329 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 1 = 0.148 +- 0.329 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 2 = 0.136 +- 0.329 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all KL = 0.191 +- 0.329 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all L1 = 0.159 +- 0.264 (in-sample avg dev_std = 0.274)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.37
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.2752525
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.349
NEC for r=1.0 class 0 = 0.168 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 class 1 = 0.125 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 class 2 = 0.112 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all KL = 0.173 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all L1 = 0.135 +- 0.233 (in-sample avg dev_std = 0.270)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 12:56:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 12:56:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.585
WIoU for r=0.3 = 0.472
F1 for r=0.6 = 0.613
WIoU for r=0.6 = 0.579
F1 for r=0.9 = 0.515
WIoU for r=0.9 = 0.577
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.577
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.477
WIoU for r=0.3 = 0.459
F1 for r=0.6 = 0.345
WIoU for r=0.6 = 0.438
F1 for r=0.9 = 0.256
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.431
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.277
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.173
WIoU for r=0.6 = 0.166
F1 for r=0.9 = 0.123
WIoU for r=0.9 = 0.148
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.144


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.375
Model XAI F1 of binarized graphs for r=0.3 =  0.58452875
Model XAI WIoU of binarized graphs for r=0.3 =  0.47213375
len(reference) = 778
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.351
SUFF++ for r=0.3 class 0 = 0.845 +- 0.207 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 1 = 0.932 +- 0.207 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 2 = 0.848 +- 0.207 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all KL = 0.899 +- 0.207 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all L1 = 0.874 +- 0.179 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.663
Model XAI F1 of binarized graphs for r=0.6 =  0.613045
Model XAI WIoU of binarized graphs for r=0.6 =  0.5787362500000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0 = 0.765 +- 0.231 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 class 1 = 0.844 +- 0.231 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.231 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 all KL = 0.79 +- 0.231 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 all L1 = 0.78 +- 0.201 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  0.51542875
Model XAI WIoU of binarized graphs for r=0.9 =  0.577485
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.785
SUFF++ for r=0.9 class 0 = 0.849 +- 0.188 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 class 1 = 0.888 +- 0.188 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 class 2 = 0.898 +- 0.188 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 all KL = 0.897 +- 0.188 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.9 all L1 = 0.878 +- 0.179 (in-sample avg dev_std = 0.291)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  0.4772875
Model XAI WIoU of binarized graphs for r=0.3 =  0.45941375
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0 = 0.798 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 1 = 0.903 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 class 2 = 0.802 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 all KL = 0.842 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.3 all L1 = 0.834 +- 0.189 (in-sample avg dev_std = 0.386)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.717
Model XAI F1 of binarized graphs for r=0.6 =  0.34513875
Model XAI WIoU of binarized graphs for r=0.6 =  0.43772625
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.697
SUFF++ for r=0.6 class 0 = 0.741 +- 0.187 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 class 1 = 0.775 +- 0.187 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 class 2 = 0.746 +- 0.187 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all KL = 0.818 +- 0.187 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all L1 = 0.754 +- 0.187 (in-sample avg dev_std = 0.360)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  0.25637875
Model XAI WIoU of binarized graphs for r=0.9 =  0.43223625
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.701
SUFF++ for r=0.9 class 0 = 0.751 +- 0.290 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.9 class 1 = 0.842 +- 0.290 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.9 class 2 = 0.793 +- 0.290 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.9 all KL = 0.789 +- 0.290 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.9 all L1 = 0.795 +- 0.234 (in-sample avg dev_std = 0.396)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  0.277145
Model XAI WIoU of binarized graphs for r=0.3 =  0.21495
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.634
SUFF++ for r=0.3 class 0 = 0.701 +- 0.185 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 1 = 0.797 +- 0.185 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 2 = 0.699 +- 0.185 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 all KL = 0.81 +- 0.185 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 all L1 = 0.733 +- 0.156 (in-sample avg dev_std = 0.369)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.464
Model XAI F1 of binarized graphs for r=0.6 =  0.17305625
Model XAI WIoU of binarized graphs for r=0.6 =  0.16601999999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.543
SUFF++ for r=0.6 class 0 = 0.653 +- 0.241 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 class 1 = 0.8 +- 0.241 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 class 2 = 0.77 +- 0.241 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 all KL = 0.723 +- 0.241 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.6 all L1 = 0.741 +- 0.210 (in-sample avg dev_std = 0.357)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.366
Model XAI F1 of binarized graphs for r=0.9 =  0.12338625
Model XAI WIoU of binarized graphs for r=0.9 =  0.14814875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.4
SUFF++ for r=0.9 class 0 = 0.806 +- 0.223 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 class 1 = 0.828 +- 0.223 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 class 2 = 0.849 +- 0.223 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 all KL = 0.829 +- 0.223 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 all L1 = 0.827 +- 0.179 (in-sample avg dev_std = 0.352)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.376
Model XAI F1 of binarized graphs for r=0.3 =  0.58452875
Model XAI WIoU of binarized graphs for r=0.3 =  0.47213375
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.331
NEC for r=0.3 class 0 = 0.174 +- 0.245 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1 = 0.099 +- 0.245 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 2 = 0.169 +- 0.245 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.106 +- 0.245 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.148 +- 0.223 (in-sample avg dev_std = 0.159)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.663
Model XAI F1 of binarized graphs for r=0.6 =  0.613045
Model XAI WIoU of binarized graphs for r=0.6 =  0.5787362500000001
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.392
NEC for r=0.6 class 0 = 0.523 +- 0.371 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.243 +- 0.371 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.539 +- 0.371 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.45 +- 0.371 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.438 +- 0.290 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  0.51542875
Model XAI WIoU of binarized graphs for r=0.9 =  0.577485
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.488
NEC for r=0.9 class 0 = 0.604 +- 0.328 (in-sample avg dev_std = 0.613)
NEC for r=0.9 class 1 = 0.288 +- 0.328 (in-sample avg dev_std = 0.613)
NEC for r=0.9 class 2 = 0.596 +- 0.328 (in-sample avg dev_std = 0.613)
NEC for r=0.9 all KL = 0.555 +- 0.328 (in-sample avg dev_std = 0.613)
NEC for r=0.9 all L1 = 0.499 +- 0.258 (in-sample avg dev_std = 0.613)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.5772025
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.601 +- 0.335 (in-sample avg dev_std = 0.650)
NEC for r=1.0 class 1 = 0.235 +- 0.335 (in-sample avg dev_std = 0.650)
NEC for r=1.0 class 2 = 0.585 +- 0.335 (in-sample avg dev_std = 0.650)
NEC for r=1.0 all KL = 0.557 +- 0.335 (in-sample avg dev_std = 0.650)
NEC for r=1.0 all L1 = 0.477 +- 0.265 (in-sample avg dev_std = 0.650)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  0.4772875
Model XAI WIoU of binarized graphs for r=0.3 =  0.45941375
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.43 +- 0.424 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1 = 0.082 +- 0.424 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 2 = 0.422 +- 0.424 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.32 +- 0.424 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.311 +- 0.362 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.719
Model XAI F1 of binarized graphs for r=0.6 =  0.34513875
Model XAI WIoU of binarized graphs for r=0.6 =  0.43772625
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.439
NEC for r=0.6 class 0 = 0.611 +- 0.348 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 1 = 0.201 +- 0.348 (in-sample avg dev_std = 0.453)
NEC for r=0.6 class 2 = 0.597 +- 0.348 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all KL = 0.45 +- 0.348 (in-sample avg dev_std = 0.453)
NEC for r=0.6 all L1 = 0.468 +- 0.276 (in-sample avg dev_std = 0.453)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  0.25637875
Model XAI WIoU of binarized graphs for r=0.9 =  0.43223625
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.496
NEC for r=0.9 class 0 = 0.541 +- 0.319 (in-sample avg dev_std = 0.519)
NEC for r=0.9 class 1 = 0.18 +- 0.319 (in-sample avg dev_std = 0.519)
NEC for r=0.9 class 2 = 0.544 +- 0.319 (in-sample avg dev_std = 0.519)
NEC for r=0.9 all KL = 0.43 +- 0.319 (in-sample avg dev_std = 0.519)
NEC for r=0.9 all L1 = 0.42 +- 0.274 (in-sample avg dev_std = 0.519)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.889
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.43131
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.653 +- 0.323 (in-sample avg dev_std = 0.539)
NEC for r=1.0 class 1 = 0.184 +- 0.323 (in-sample avg dev_std = 0.539)
NEC for r=1.0 class 2 = 0.597 +- 0.323 (in-sample avg dev_std = 0.539)
NEC for r=1.0 all KL = 0.492 +- 0.323 (in-sample avg dev_std = 0.539)
NEC for r=1.0 all L1 = 0.477 +- 0.266 (in-sample avg dev_std = 0.539)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  0.277145
Model XAI WIoU of binarized graphs for r=0.3 =  0.21495
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.354
NEC for r=0.3 class 0 = 0.529 +- 0.419 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 1 = 0.164 +- 0.419 (in-sample avg dev_std = 0.180)
NEC for r=0.3 class 2 = 0.516 +- 0.419 (in-sample avg dev_std = 0.180)
NEC for r=0.3 all KL = 0.373 +- 0.419 (in-sample avg dev_std = 0.180)
NEC for r=0.3 all L1 = 0.4 +- 0.341 (in-sample avg dev_std = 0.180)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.464
Model XAI F1 of binarized graphs for r=0.6 =  0.17305625
Model XAI WIoU of binarized graphs for r=0.6 =  0.16601999999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.366
NEC for r=0.6 class 0 = 0.311 +- 0.271 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 1 = 0.153 +- 0.271 (in-sample avg dev_std = 0.305)
NEC for r=0.6 class 2 = 0.354 +- 0.271 (in-sample avg dev_std = 0.305)
NEC for r=0.6 all KL = 0.265 +- 0.271 (in-sample avg dev_std = 0.305)
NEC for r=0.6 all L1 = 0.271 +- 0.235 (in-sample avg dev_std = 0.305)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.366
Model XAI F1 of binarized graphs for r=0.9 =  0.12338625
Model XAI WIoU of binarized graphs for r=0.9 =  0.14814875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.35
NEC for r=0.9 class 0 = 0.26 +- 0.237 (in-sample avg dev_std = 0.271)
NEC for r=0.9 class 1 = 0.179 +- 0.237 (in-sample avg dev_std = 0.271)
NEC for r=0.9 class 2 = 0.297 +- 0.237 (in-sample avg dev_std = 0.271)
NEC for r=0.9 all KL = 0.205 +- 0.237 (in-sample avg dev_std = 0.271)
NEC for r=0.9 all L1 = 0.244 +- 0.205 (in-sample avg dev_std = 0.271)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.431
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.14440375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.345
NEC for r=1.0 class 0 = 0.337 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 class 1 = 0.339 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 class 2 = 0.33 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 all KL = 0.328 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 all L1 = 0.335 +- 0.214 (in-sample avg dev_std = 0.294)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 13:02:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:02:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:03:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.402
WIoU for r=0.3 = 0.345
F1 for r=0.6 = 0.416
WIoU for r=0.6 = 0.357
F1 for r=0.9 = 0.460
WIoU for r=0.9 = 0.394
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.397
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.317
WIoU for r=0.3 = 0.320
F1 for r=0.6 = 0.261
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.220
WIoU for r=0.9 = 0.327
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.330
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.167
WIoU for r=0.3 = 0.250
F1 for r=0.6 = 0.134
WIoU for r=0.6 = 0.256
F1 for r=0.9 = 0.102
WIoU for r=0.9 = 0.257
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.262


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.40208625
Model XAI WIoU of binarized graphs for r=0.3 =  0.3445125
len(reference) = 795
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.401
SUFF++ for r=0.3 class 0 = 0.638 +- 0.310 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 1 = 0.762 +- 0.310 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 class 2 = 0.704 +- 0.310 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all KL = 0.696 +- 0.310 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.3 all L1 = 0.7 +- 0.274 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.608
Model XAI F1 of binarized graphs for r=0.6 =  0.41633625
Model XAI WIoU of binarized graphs for r=0.6 =  0.35688250000000005
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.462
SUFF++ for r=0.6 class 0 = 0.399 +- 0.278 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 1 = 0.615 +- 0.278 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 2 = 0.542 +- 0.278 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all KL = 0.524 +- 0.278 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all L1 = 0.517 +- 0.230 (in-sample avg dev_std = 0.524)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.45997874999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.39418
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.71
SUFF++ for r=0.9 class 0 = 0.633 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 class 2 = 0.692 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 all KL = 0.664 +- 0.307 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.9 all L1 = 0.682 +- 0.253 (in-sample avg dev_std = 0.529)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  0.31738875
Model XAI WIoU of binarized graphs for r=0.3 =  0.32046499999999994
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.482
SUFF++ for r=0.3 class 0 = 0.547 +- 0.311 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 class 1 = 0.729 +- 0.311 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 class 2 = 0.663 +- 0.311 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 all KL = 0.61 +- 0.311 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 all L1 = 0.646 +- 0.263 (in-sample avg dev_std = 0.516)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.609
Model XAI F1 of binarized graphs for r=0.6 =  0.26108750000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.32176000000000005
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.511
SUFF++ for r=0.6 class 0 = 0.496 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 1 = 0.697 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 2 = 0.586 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all KL = 0.642 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all L1 = 0.593 +- 0.225 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.716
Model XAI F1 of binarized graphs for r=0.9 =  0.21979625
Model XAI WIoU of binarized graphs for r=0.9 =  0.32715874999999994
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.619
SUFF++ for r=0.9 class 0 = 0.525 +- 0.309 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.9 class 1 = 0.61 +- 0.309 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.9 class 2 = 0.682 +- 0.309 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.9 all KL = 0.608 +- 0.309 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.9 all L1 = 0.604 +- 0.267 (in-sample avg dev_std = 0.458)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.436
Model XAI F1 of binarized graphs for r=0.3 =  0.16691625000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.249725
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.436
SUFF++ for r=0.3 class 0 = 0.528 +- 0.319 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 class 1 = 0.551 +- 0.319 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 class 2 = 0.574 +- 0.319 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 all KL = 0.472 +- 0.319 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.244 (in-sample avg dev_std = 0.601)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.394
Model XAI F1 of binarized graphs for r=0.6 =  0.1338175
Model XAI WIoU of binarized graphs for r=0.6 =  0.2557825
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.434
SUFF++ for r=0.6 class 0 = 0.504 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 1 = 0.557 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 2 = 0.558 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all KL = 0.497 +- 0.281 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all L1 = 0.539 +- 0.204 (in-sample avg dev_std = 0.539)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.419
Model XAI F1 of binarized graphs for r=0.9 =  0.101945
Model XAI WIoU of binarized graphs for r=0.9 =  0.25745125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.403
SUFF++ for r=0.9 class 0 = 0.714 +- 0.217 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.217 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.9 class 2 = 0.733 +- 0.217 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.9 all KL = 0.775 +- 0.217 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.9 all L1 = 0.734 +- 0.205 (in-sample avg dev_std = 0.353)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.469
Model XAI F1 of binarized graphs for r=0.3 =  0.40208625
Model XAI WIoU of binarized graphs for r=0.3 =  0.3445125
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.414 +- 0.360 (in-sample avg dev_std = 0.375)
NEC for r=0.3 class 1 = 0.23 +- 0.360 (in-sample avg dev_std = 0.375)
NEC for r=0.3 class 2 = 0.398 +- 0.360 (in-sample avg dev_std = 0.375)
NEC for r=0.3 all KL = 0.354 +- 0.360 (in-sample avg dev_std = 0.375)
NEC for r=0.3 all L1 = 0.349 +- 0.317 (in-sample avg dev_std = 0.375)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.608
Model XAI F1 of binarized graphs for r=0.6 =  0.41633625
Model XAI WIoU of binarized graphs for r=0.6 =  0.35688250000000005
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.418
NEC for r=0.6 class 0 = 0.6 +- 0.309 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 1 = 0.35 +- 0.309 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 2 = 0.58 +- 0.309 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all KL = 0.518 +- 0.309 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all L1 = 0.512 +- 0.248 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.45997874999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.39418
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.603 +- 0.312 (in-sample avg dev_std = 0.635)
NEC for r=0.9 class 1 = 0.278 +- 0.312 (in-sample avg dev_std = 0.635)
NEC for r=0.9 class 2 = 0.586 +- 0.312 (in-sample avg dev_std = 0.635)
NEC for r=0.9 all KL = 0.556 +- 0.312 (in-sample avg dev_std = 0.635)
NEC for r=0.9 all L1 = 0.492 +- 0.251 (in-sample avg dev_std = 0.635)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.39679125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.545
NEC for r=1.0 class 0 = 0.587 +- 0.297 (in-sample avg dev_std = 0.687)
NEC for r=1.0 class 1 = 0.293 +- 0.297 (in-sample avg dev_std = 0.687)
NEC for r=1.0 class 2 = 0.602 +- 0.297 (in-sample avg dev_std = 0.687)
NEC for r=1.0 all KL = 0.583 +- 0.297 (in-sample avg dev_std = 0.687)
NEC for r=1.0 all L1 = 0.497 +- 0.233 (in-sample avg dev_std = 0.687)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  0.31738875
Model XAI WIoU of binarized graphs for r=0.3 =  0.32046499999999994
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.524 +- 0.404 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 1 = 0.241 +- 0.404 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 2 = 0.503 +- 0.404 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all KL = 0.448 +- 0.404 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all L1 = 0.422 +- 0.341 (in-sample avg dev_std = 0.355)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.61
Model XAI F1 of binarized graphs for r=0.6 =  0.26108750000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.32176000000000005
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.451
NEC for r=0.6 class 0 = 0.554 +- 0.377 (in-sample avg dev_std = 0.464)
NEC for r=0.6 class 1 = 0.308 +- 0.377 (in-sample avg dev_std = 0.464)
NEC for r=0.6 class 2 = 0.575 +- 0.377 (in-sample avg dev_std = 0.464)
NEC for r=0.6 all KL = 0.485 +- 0.377 (in-sample avg dev_std = 0.464)
NEC for r=0.6 all L1 = 0.478 +- 0.276 (in-sample avg dev_std = 0.464)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.716
Model XAI F1 of binarized graphs for r=0.9 =  0.21979625
Model XAI WIoU of binarized graphs for r=0.9 =  0.32715874999999994
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.511
NEC for r=0.9 class 0 = 0.627 +- 0.284 (in-sample avg dev_std = 0.579)
NEC for r=0.9 class 1 = 0.42 +- 0.284 (in-sample avg dev_std = 0.579)
NEC for r=0.9 class 2 = 0.634 +- 0.284 (in-sample avg dev_std = 0.579)
NEC for r=0.9 all KL = 0.62 +- 0.284 (in-sample avg dev_std = 0.579)
NEC for r=0.9 all L1 = 0.56 +- 0.223 (in-sample avg dev_std = 0.579)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.808
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.32957375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.518
NEC for r=1.0 class 0 = 0.609 +- 0.271 (in-sample avg dev_std = 0.602)
NEC for r=1.0 class 1 = 0.45 +- 0.271 (in-sample avg dev_std = 0.602)
NEC for r=1.0 class 2 = 0.619 +- 0.271 (in-sample avg dev_std = 0.602)
NEC for r=1.0 all KL = 0.627 +- 0.271 (in-sample avg dev_std = 0.602)
NEC for r=1.0 all L1 = 0.559 +- 0.213 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.438
Model XAI F1 of binarized graphs for r=0.3 =  0.16691625000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.249725
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.357
NEC for r=0.3 class 0 = 0.52 +- 0.382 (in-sample avg dev_std = 0.386)
NEC for r=0.3 class 1 = 0.423 +- 0.382 (in-sample avg dev_std = 0.386)
NEC for r=0.3 class 2 = 0.527 +- 0.382 (in-sample avg dev_std = 0.386)
NEC for r=0.3 all KL = 0.518 +- 0.382 (in-sample avg dev_std = 0.386)
NEC for r=0.3 all L1 = 0.489 +- 0.321 (in-sample avg dev_std = 0.386)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.394
Model XAI F1 of binarized graphs for r=0.6 =  0.1338175
Model XAI WIoU of binarized graphs for r=0.6 =  0.2557825
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.376
NEC for r=0.6 class 0 = 0.57 +- 0.368 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.505 +- 0.368 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.54 +- 0.368 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.585 +- 0.368 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.539 +- 0.247 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.419
Model XAI F1 of binarized graphs for r=0.9 =  0.101945
Model XAI WIoU of binarized graphs for r=0.9 =  0.25745125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.342
NEC for r=0.9 class 0 = 0.469 +- 0.341 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.423 +- 0.341 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.37 +- 0.341 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.422 +- 0.341 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.422 +- 0.235 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.509
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.26247375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.356
NEC for r=1.0 class 0 = 0.48 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 1 = 0.476 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 2 = 0.349 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all KL = 0.479 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all L1 = 0.437 +- 0.252 (in-sample avg dev_std = 0.426)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 13:08:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 01:08:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:09:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3486) +- tensor(0.1769)
F1 for r=0.3 = 0.312
WIoU for r=0.3 = 0.237
F1 for r=0.6 = 0.403
WIoU for r=0.6 = 0.299
F1 for r=0.9 = 0.492
WIoU for r=0.9 = 0.383
F1 for r=1.0 = 0.493
WIoU for r=1.0 = 0.386
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1390) +- tensor(0.0663)
F1 for r=0.3 = 0.301
WIoU for r=0.3 = 0.279
F1 for r=0.6 = 0.246
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.223
WIoU for r=0.9 = 0.231
F1 for r=1.0 = 0.238
WIoU for r=1.0 = 0.235
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.187
WIoU for r=0.3 = 0.261
F1 for r=0.6 = 0.139
WIoU for r=0.6 = 0.247
F1 for r=0.9 = 0.113
WIoU for r=0.9 = 0.239
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.239


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.309
Model XAI F1 of binarized graphs for r=0.3 =  0.311755
Model XAI WIoU of binarized graphs for r=0.3 =  0.23724249999999997
len(reference) = 793
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.332
SUFF++ for r=0.3 class 0 = 0.733 +- 0.147 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 1 = 0.765 +- 0.147 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 2 = 0.781 +- 0.147 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all KL = 0.866 +- 0.147 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all L1 = 0.759 +- 0.141 (in-sample avg dev_std = 0.314)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.387
Model XAI F1 of binarized graphs for r=0.6 =  0.4027225
Model XAI WIoU of binarized graphs for r=0.6 =  0.29864125
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.395
SUFF++ for r=0.6 class 0 = 0.557 +- 0.257 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 1 = 0.627 +- 0.257 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 2 = 0.578 +- 0.257 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 all KL = 0.636 +- 0.257 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 all L1 = 0.587 +- 0.192 (in-sample avg dev_std = 0.519)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.49176499999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.38325250000000005
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.629
SUFF++ for r=0.9 class 0 = 0.568 +- 0.295 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 1 = 0.786 +- 0.295 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 2 = 0.617 +- 0.295 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 all KL = 0.665 +- 0.295 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 all L1 = 0.655 +- 0.265 (in-sample avg dev_std = 0.482)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.30082125
Model XAI WIoU of binarized graphs for r=0.3 =  0.2791075
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.451
SUFF++ for r=0.3 class 0 = 0.71 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 1 = 0.843 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 2 = 0.711 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all KL = 0.785 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.196 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  0.24631875
Model XAI WIoU of binarized graphs for r=0.6 =  0.24250875
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.498
SUFF++ for r=0.6 class 0 = 0.617 +- 0.260 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 class 1 = 0.797 +- 0.260 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 class 2 = 0.62 +- 0.260 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 all KL = 0.666 +- 0.260 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 all L1 = 0.679 +- 0.221 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.618
Model XAI F1 of binarized graphs for r=0.9 =  0.22255875
Model XAI WIoU of binarized graphs for r=0.9 =  0.2309975
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.605
SUFF++ for r=0.9 class 0 = 0.643 +- 0.280 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 1 = 0.758 +- 0.280 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 2 = 0.622 +- 0.280 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 all KL = 0.719 +- 0.280 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 all L1 = 0.675 +- 0.244 (in-sample avg dev_std = 0.418)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.18709125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.26083625
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.447
SUFF++ for r=0.3 class 0 = 0.574 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 1 = 0.672 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 2 = 0.608 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all KL = 0.586 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all L1 = 0.618 +- 0.174 (in-sample avg dev_std = 0.594)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.447
Model XAI F1 of binarized graphs for r=0.6 =  0.13887
Model XAI WIoU of binarized graphs for r=0.6 =  0.24737749999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.447
SUFF++ for r=0.6 class 0 = 0.719 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 1 = 0.82 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 class 2 = 0.756 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all KL = 0.807 +- 0.219 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.6 all L1 = 0.765 +- 0.224 (in-sample avg dev_std = 0.397)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.391
Model XAI F1 of binarized graphs for r=0.9 =  0.1129725
Model XAI WIoU of binarized graphs for r=0.9 =  0.23908875000000002
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.402
SUFF++ for r=0.9 class 0 = 0.887 +- 0.165 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 1 = 0.89 +- 0.165 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 2 = 0.898 +- 0.165 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all KL = 0.909 +- 0.165 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.128 (in-sample avg dev_std = 0.194)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.306
Model XAI F1 of binarized graphs for r=0.3 =  0.311755
Model XAI WIoU of binarized graphs for r=0.3 =  0.23724249999999997
len(reference) = 800
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.288
NEC for r=0.3 class 0 = 0.25 +- 0.170 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 1 = 0.222 +- 0.170 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 2 = 0.2 +- 0.170 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all KL = 0.113 +- 0.170 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all L1 = 0.224 +- 0.183 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.389
Model XAI F1 of binarized graphs for r=0.6 =  0.4027225
Model XAI WIoU of binarized graphs for r=0.6 =  0.29864125
len(reference) = 800
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.377
NEC for r=0.6 class 0 = 0.45 +- 0.293 (in-sample avg dev_std = 0.469)
NEC for r=0.6 class 1 = 0.39 +- 0.293 (in-sample avg dev_std = 0.469)
NEC for r=0.6 class 2 = 0.445 +- 0.293 (in-sample avg dev_std = 0.469)
NEC for r=0.6 all KL = 0.378 +- 0.293 (in-sample avg dev_std = 0.469)
NEC for r=0.6 all L1 = 0.429 +- 0.222 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.49176499999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.38325250000000005
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.481
NEC for r=0.9 class 0 = 0.614 +- 0.306 (in-sample avg dev_std = 0.548)
NEC for r=0.9 class 1 = 0.288 +- 0.306 (in-sample avg dev_std = 0.548)
NEC for r=0.9 class 2 = 0.603 +- 0.306 (in-sample avg dev_std = 0.548)
NEC for r=0.9 all KL = 0.51 +- 0.306 (in-sample avg dev_std = 0.548)
NEC for r=0.9 all L1 = 0.505 +- 0.245 (in-sample avg dev_std = 0.548)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.904
Model XAI F1 of binarized graphs for r=1.0 =  0.49294499999999997
Model XAI WIoU of binarized graphs for r=1.0 =  0.38576499999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0 = 0.584 +- 0.324 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 1 = 0.218 +- 0.324 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 2 = 0.594 +- 0.324 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all KL = 0.515 +- 0.324 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all L1 = 0.469 +- 0.251 (in-sample avg dev_std = 0.606)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.30082125
Model XAI WIoU of binarized graphs for r=0.3 =  0.2791075
len(reference) = 800
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.347
NEC for r=0.3 class 0 = 0.335 +- 0.329 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1 = 0.134 +- 0.329 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 2 = 0.325 +- 0.329 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.215 +- 0.329 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.265 +- 0.280 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  0.24631875
Model XAI WIoU of binarized graphs for r=0.6 =  0.24250875
len(reference) = 800
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.423
NEC for r=0.6 class 0 = 0.446 +- 0.335 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.177 +- 0.335 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.408 +- 0.335 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.349 +- 0.335 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.343 +- 0.289 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.618
Model XAI F1 of binarized graphs for r=0.9 =  0.22255875
Model XAI WIoU of binarized graphs for r=0.9 =  0.2309975
len(reference) = 800
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.461
NEC for r=0.9 class 0 = 0.604 +- 0.325 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 1 = 0.291 +- 0.325 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 2 = 0.613 +- 0.325 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all KL = 0.491 +- 0.325 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all L1 = 0.502 +- 0.258 (in-sample avg dev_std = 0.505)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.832
Model XAI F1 of binarized graphs for r=1.0 =  0.23826
Model XAI WIoU of binarized graphs for r=1.0 =  0.235275
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.522
NEC for r=1.0 class 0 = 0.63 +- 0.314 (in-sample avg dev_std = 0.502)
NEC for r=1.0 class 1 = 0.251 +- 0.314 (in-sample avg dev_std = 0.502)
NEC for r=1.0 class 2 = 0.535 +- 0.314 (in-sample avg dev_std = 0.502)
NEC for r=1.0 all KL = 0.462 +- 0.314 (in-sample avg dev_std = 0.502)
NEC for r=1.0 all L1 = 0.472 +- 0.248 (in-sample avg dev_std = 0.502)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.18709125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.26083625
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.374 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 1 = 0.227 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 2 = 0.455 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all KL = 0.312 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all L1 = 0.349 +- 0.305 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.447
Model XAI F1 of binarized graphs for r=0.6 =  0.13887
Model XAI WIoU of binarized graphs for r=0.6 =  0.24737749999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.37
NEC for r=0.6 class 0 = 0.274 +- 0.266 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 1 = 0.189 +- 0.266 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 2 = 0.341 +- 0.266 (in-sample avg dev_std = 0.361)
NEC for r=0.6 all KL = 0.222 +- 0.266 (in-sample avg dev_std = 0.361)
NEC for r=0.6 all L1 = 0.266 +- 0.252 (in-sample avg dev_std = 0.361)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.391
Model XAI F1 of binarized graphs for r=0.9 =  0.1129725
Model XAI WIoU of binarized graphs for r=0.9 =  0.23908875000000002
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.371
NEC for r=0.9 class 0 = 0.21 +- 0.268 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 1 = 0.209 +- 0.268 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 2 = 0.268 +- 0.268 (in-sample avg dev_std = 0.369)
NEC for r=0.9 all KL = 0.251 +- 0.268 (in-sample avg dev_std = 0.369)
NEC for r=0.9 all L1 = 0.228 +- 0.194 (in-sample avg dev_std = 0.369)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.414
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.23854
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.379
NEC for r=1.0 class 0 = 0.31 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 1 = 0.352 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 2 = 0.316 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all KL = 0.326 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all L1 = 0.326 +- 0.246 (in-sample avg dev_std = 0.395)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.906, 0.814, 0.867, 1.0], 'all_L1': [0.788, 0.774, 0.812, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.918, 0.753, 0.855, 1.0], 'all_L1': [0.808, 0.723, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.79, 0.897, 1.0], 'all_L1': [0.874, 0.78, 0.878, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.524, 0.664, 1.0], 'all_L1': [0.7, 0.517, 0.682, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.866, 0.636, 0.665, 1.0], 'all_L1': [0.759, 0.587, 0.655, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.112, 0.335, 0.509, 0.486], 'all_L1': [0.232, 0.363, 0.511, 0.478]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.38, 0.54, 0.536], 'all_L1': [0.194, 0.403, 0.503, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.106, 0.45, 0.555, 0.557], 'all_L1': [0.148, 0.438, 0.499, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.354, 0.518, 0.556, 0.583], 'all_L1': [0.349, 0.512, 0.492, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.378, 0.51, 0.515], 'all_L1': [0.224, 0.429, 0.505, 0.469]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.937, 0.759, 0.795, 1.0], 'all_L1': [0.879, 0.737, 0.746, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.862, 0.757, 0.762, 1.0], 'all_L1': [0.811, 0.731, 0.7, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.818, 0.789, 1.0], 'all_L1': [0.834, 0.754, 0.795, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.642, 0.608, 1.0], 'all_L1': [0.646, 0.593, 0.604, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.785, 0.666, 0.719, 1.0], 'all_L1': [0.755, 0.679, 0.675, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.153, 0.219, 0.389, 0.359], 'all_L1': [0.204, 0.268, 0.415, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.469, 0.493, 0.441], 'all_L1': [0.334, 0.452, 0.493, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.45, 0.43, 0.492], 'all_L1': [0.311, 0.468, 0.42, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.485, 0.62, 0.627], 'all_L1': [0.422, 0.478, 0.56, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.215, 0.349, 0.491, 0.462], 'all_L1': [0.265, 0.343, 0.502, 0.472]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.9, 0.521, 0.583, 1.0], 'all_L1': [0.844, 0.608, 0.732, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.545, 0.659, 0.815, 1.0], 'all_L1': [0.576, 0.695, 0.847, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.81, 0.723, 0.829, 1.0], 'all_L1': [0.733, 0.741, 0.827, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.497, 0.775, 1.0], 'all_L1': [0.551, 0.539, 0.734, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.807, 0.909, 1.0], 'all_L1': [0.618, 0.765, 0.892, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.144, 0.381, 0.359, 0.411], 'all_L1': [0.188, 0.341, 0.252, 0.263]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.247, 0.191, 0.173], 'all_L1': [0.417, 0.238, 0.159, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.265, 0.205, 0.328], 'all_L1': [0.4, 0.271, 0.244, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.585, 0.422, 0.479], 'all_L1': [0.489, 0.539, 0.422, 0.437]}), defaultdict(<class 'list'>, {'all_KL': [0.312, 0.222, 0.251, 0.326], 'all_L1': [0.349, 0.266, 0.228, 0.326]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.786 +- 0.057, 0.676 +- 0.106, 0.771 +- 0.087, 1.000 +- 0.000
suff++ class all_KL  =  0.857 +- 0.082, 0.703 +- 0.109, 0.790 +- 0.103, 1.000 +- 0.000
suff++_acc_int  =  0.354 +- 0.025, 0.499 +- 0.076, 0.733 +- 0.058
nec class all_L1  =  0.229 +- 0.067, 0.429 +- 0.049, 0.502 +- 0.006, 0.484 +- 0.012
nec class all_KL  =  0.155 +- 0.100, 0.412 +- 0.064, 0.534 +- 0.021, 0.535 +- 0.033
nec_acc_int  =  0.325 +- 0.020, 0.400 +- 0.015, 0.495 +- 0.016, 0.539 +- 0.010

Eval split val
suff++ class all_L1  =  0.785 +- 0.080, 0.699 +- 0.059, 0.704 +- 0.065, 1.000 +- 0.000
suff++ class all_KL  =  0.807 +- 0.110, 0.728 +- 0.065, 0.735 +- 0.069, 1.000 +- 0.000
suff++_acc_int  =  0.498 +- 0.051, 0.566 +- 0.077, 0.653 +- 0.037
nec class all_L1  =  0.307 +- 0.073, 0.402 +- 0.083, 0.478 +- 0.055, 0.461 +- 0.063
nec class all_KL  =  0.283 +- 0.100, 0.394 +- 0.100, 0.485 +- 0.078, 0.476 +- 0.087
nec_acc_int  =  0.352 +- 0.012, 0.429 +- 0.025, 0.487 +- 0.023, 0.523 +- 0.011

Eval split test
suff++ class all_L1  =  0.664 +- 0.109, 0.670 +- 0.084, 0.806 +- 0.064, 1.000 +- 0.000
suff++ class all_KL  =  0.663 +- 0.164, 0.641 +- 0.118, 0.782 +- 0.109, 1.000 +- 0.000
suff++_acc_int  =  0.499 +- 0.087, 0.457 +- 0.051, 0.392 +- 0.013
nec class all_L1  =  0.369 +- 0.101, 0.331 +- 0.109, 0.261 +- 0.087, 0.299 +- 0.099
nec class all_KL  =  0.348 +- 0.122, 0.340 +- 0.134, 0.286 +- 0.090, 0.343 +- 0.103
nec_acc_int  =  0.348 +- 0.009, 0.364 +- 0.009, 0.352 +- 0.010, 0.357 +- 0.012


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.508 +- 0.011, 0.553 +- 0.037, 0.637 +- 0.044, 0.742 +- 0.006
Faith. Armon (L1)= 		  =  0.347 +- 0.070, 0.517 +- 0.024, 0.606 +- 0.029, 0.652 +- 0.011
Faith. GMean (L1)= 	  =  0.418 +- 0.044, 0.534 +- 0.028, 0.621 +- 0.037, 0.696 +- 0.009
Faith. Aritm (KL)= 		  =  0.506 +- 0.011, 0.558 +- 0.040, 0.662 +- 0.053, 0.768 +- 0.017
Faith. Armon (KL)= 		  =  0.244 +- 0.113, 0.510 +- 0.037, 0.634 +- 0.039, 0.697 +- 0.028
Faith. GMean (KL)= 	  =  0.344 +- 0.077, 0.533 +- 0.035, 0.648 +- 0.046, 0.731 +- 0.023

Eval split val
Faith. Aritm (L1)= 		  =  0.546 +- 0.024, 0.550 +- 0.043, 0.591 +- 0.010, 0.731 +- 0.031
Faith. Armon (L1)= 		  =  0.432 +- 0.063, 0.503 +- 0.069, 0.564 +- 0.019, 0.629 +- 0.059
Faith. GMean (L1)= 	  =  0.485 +- 0.041, 0.526 +- 0.056, 0.577 +- 0.011, 0.678 +- 0.046
Faith. Aritm (KL)= 		  =  0.545 +- 0.029, 0.561 +- 0.057, 0.610 +- 0.012, 0.738 +- 0.044
Faith. Armon (KL)= 		  =  0.401 +- 0.090, 0.502 +- 0.093, 0.575 +- 0.032, 0.641 +- 0.078
Faith. GMean (KL)= 	  =  0.464 +- 0.059, 0.530 +- 0.075, 0.592 +- 0.021, 0.687 +- 0.062

Eval split test
Faith. Aritm (L1)= 		  =  0.516 +- 0.028, 0.500 +- 0.027, 0.534 +- 0.033, 0.650 +- 0.050
Faith. Armon (L1)= 		  =  0.455 +- 0.078, 0.424 +- 0.063, 0.384 +- 0.086, 0.451 +- 0.123
Faith. GMean (L1)= 	  =  0.483 +- 0.050, 0.460 +- 0.043, 0.451 +- 0.061, 0.538 +- 0.098
Faith. Aritm (KL)= 		  =  0.505 +- 0.049, 0.491 +- 0.035, 0.534 +- 0.048, 0.672 +- 0.051
Faith. Armon (KL)= 		  =  0.424 +- 0.095, 0.415 +- 0.069, 0.404 +- 0.086, 0.502 +- 0.119
Faith. GMean (KL)= 	  =  0.459 +- 0.064, 0.450 +- 0.047, 0.463 +- 0.062, 0.579 +- 0.093
Computed for split load_split = id



Completed in  0:31:40.036032  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 13:15:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 01:15:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 01:15:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 01:15:58 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:00 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:16:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3555) +- tensor(0.1811)
F1 for r=0.3 = 0.499
WIoU for r=0.3 = 0.377
F1 for r=0.6 = 0.578
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.528
WIoU for r=0.9 = 0.427
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.410
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1393) +- tensor(0.0670)
F1 for r=0.3 = 0.325
WIoU for r=0.3 = 0.264
F1 for r=0.6 = 0.292
WIoU for r=0.6 = 0.227
F1 for r=0.9 = 0.255
WIoU for r=0.9 = 0.197
F1 for r=1.0 = 0.239
WIoU for r=1.0 = 0.185
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0607) +- tensor(0.0245)
F1 for r=0.3 = 0.196
WIoU for r=0.3 = 0.135
F1 for r=0.6 = 0.147
WIoU for r=0.6 = 0.097
F1 for r=0.9 = 0.121
WIoU for r=0.9 = 0.079
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.074


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.349
Model XAI F1 of binarized graphs for r=0.3 =  0.4994406666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.37741466666666673
len(reference) = 1420
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF++ for r=0.3 class 0 = 0.762 +- 0.135 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.3 class 1 = 0.796 +- 0.135 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.3 class 2 = 0.777 +- 0.135 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.3 all KL = 0.896 +- 0.135 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.3 all L1 = 0.778 +- 0.139 (in-sample avg dev_std = 0.262)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.5781286666666666
Model XAI WIoU of binarized graphs for r=0.6 =  0.4624053333333333
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.502
SUFF++ for r=0.6 class 0 = 0.721 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 1 = 0.855 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 2 = 0.73 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all KL = 0.805 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all L1 = 0.767 +- 0.209 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.5284673333333334
Model XAI WIoU of binarized graphs for r=0.9 =  0.42729466666666666
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0 = 0.765 +- 0.203 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 1 = 0.849 +- 0.203 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 2 = 0.836 +- 0.203 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all KL = 0.87 +- 0.203 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.216 (in-sample avg dev_std = 0.259)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.465
Model XAI F1 of binarized graphs for r=0.3 =  0.325476
Model XAI WIoU of binarized graphs for r=0.3 =  0.26410866666666666
len(reference) = 1494
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.866 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.3 class 1 = 0.907 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.3 class 2 = 0.871 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.3 all KL = 0.941 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.3 all L1 = 0.882 +- 0.091 (in-sample avg dev_std = 0.223)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.499
Model XAI F1 of binarized graphs for r=0.6 =  0.2916993333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.22654266666666664
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.5
SUFF++ for r=0.6 class 0 = 0.719 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 1 = 0.806 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 2 = 0.707 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all KL = 0.769 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all L1 = 0.745 +- 0.214 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.25533800000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.196644
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.63
SUFF++ for r=0.9 class 0 = 0.676 +- 0.229 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 class 1 = 0.8 +- 0.229 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 class 2 = 0.755 +- 0.229 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 all KL = 0.795 +- 0.229 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 all L1 = 0.743 +- 0.209 (in-sample avg dev_std = 0.351)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.413
Model XAI F1 of binarized graphs for r=0.3 =  0.19554266666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.134716
len(reference) = 1497
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF++ for r=0.3 class 0 = 0.812 +- 0.211 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 1 = 0.888 +- 0.211 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 2 = 0.833 +- 0.211 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 all KL = 0.898 +- 0.211 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 all L1 = 0.845 +- 0.184 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.37
Model XAI F1 of binarized graphs for r=0.6 =  0.14651866666666669
Model XAI WIoU of binarized graphs for r=0.6 =  0.09680866666666668
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.398
SUFF++ for r=0.6 class 0 = 0.593 +- 0.415 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 1 = 0.604 +- 0.415 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 2 = 0.628 +- 0.415 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all KL = 0.525 +- 0.415 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all L1 = 0.608 +- 0.297 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.355
Model XAI F1 of binarized graphs for r=0.9 =  0.12127066666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.078766
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF++ for r=0.9 class 0 = 0.716 +- 0.425 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.9 class 1 = 0.711 +- 0.425 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.9 class 2 = 0.758 +- 0.425 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.9 all KL = 0.572 +- 0.425 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.9 all L1 = 0.728 +- 0.270 (in-sample avg dev_std = 0.470)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.35
Model XAI F1 of binarized graphs for r=0.3 =  0.4994406666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.37741466666666673
len(reference) = 1500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.258 +- 0.174 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1 = 0.211 +- 0.174 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 2 = 0.242 +- 0.174 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.117 +- 0.174 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.237 +- 0.176 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.5781286666666666
Model XAI WIoU of binarized graphs for r=0.6 =  0.4624053333333333
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.411
NEC for r=0.6 class 0 = 0.406 +- 0.294 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.252 +- 0.294 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.439 +- 0.294 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.342 +- 0.294 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.367 +- 0.244 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.5284673333333334
Model XAI WIoU of binarized graphs for r=0.9 =  0.42729466666666666
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.5
NEC for r=0.9 class 0 = 0.601 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 1 = 0.338 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 2 = 0.603 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all KL = 0.515 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all L1 = 0.517 +- 0.214 (in-sample avg dev_std = 0.543)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.4998793333333333
Model XAI WIoU of binarized graphs for r=1.0 =  0.4098266666666667
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.558 +- 0.301 (in-sample avg dev_std = 0.564)
NEC for r=1.0 class 1 = 0.328 +- 0.301 (in-sample avg dev_std = 0.564)
NEC for r=1.0 class 2 = 0.563 +- 0.301 (in-sample avg dev_std = 0.564)
NEC for r=1.0 all KL = 0.494 +- 0.301 (in-sample avg dev_std = 0.564)
NEC for r=1.0 all L1 = 0.485 +- 0.220 (in-sample avg dev_std = 0.564)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.325476
Model XAI WIoU of binarized graphs for r=0.3 =  0.26410866666666666
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.233 +- 0.284 (in-sample avg dev_std = 0.154)
NEC for r=0.3 class 1 = 0.141 +- 0.284 (in-sample avg dev_std = 0.154)
NEC for r=0.3 class 2 = 0.224 +- 0.284 (in-sample avg dev_std = 0.154)
NEC for r=0.3 all KL = 0.146 +- 0.284 (in-sample avg dev_std = 0.154)
NEC for r=0.3 all L1 = 0.199 +- 0.243 (in-sample avg dev_std = 0.154)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.499
Model XAI F1 of binarized graphs for r=0.6 =  0.2916993333333333
Model XAI WIoU of binarized graphs for r=0.6 =  0.22654266666666664
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.343 +- 0.258 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 1 = 0.134 +- 0.258 (in-sample avg dev_std = 0.314)
NEC for r=0.6 class 2 = 0.323 +- 0.258 (in-sample avg dev_std = 0.314)
NEC for r=0.6 all KL = 0.221 +- 0.258 (in-sample avg dev_std = 0.314)
NEC for r=0.6 all L1 = 0.266 +- 0.241 (in-sample avg dev_std = 0.314)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.25533800000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.196644
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.451
NEC for r=0.9 class 0 = 0.512 +- 0.298 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 1 = 0.224 +- 0.298 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 2 = 0.515 +- 0.298 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all KL = 0.386 +- 0.298 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all L1 = 0.416 +- 0.260 (in-sample avg dev_std = 0.407)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.739
Model XAI F1 of binarized graphs for r=1.0 =  0.2386686666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.18516666666666667
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.489
NEC for r=1.0 class 0 = 0.473 +- 0.325 (in-sample avg dev_std = 0.444)
NEC for r=1.0 class 1 = 0.161 +- 0.325 (in-sample avg dev_std = 0.444)
NEC for r=1.0 class 2 = 0.461 +- 0.325 (in-sample avg dev_std = 0.444)
NEC for r=1.0 all KL = 0.357 +- 0.325 (in-sample avg dev_std = 0.444)
NEC for r=1.0 all L1 = 0.364 +- 0.278 (in-sample avg dev_std = 0.444)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.413
Model XAI F1 of binarized graphs for r=0.3 =  0.19554266666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.134716
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.353
NEC for r=0.3 class 0 = 0.223 +- 0.258 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.153 +- 0.258 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.179 +- 0.258 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.141 +- 0.258 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.185 +- 0.214 (in-sample avg dev_std = 0.252)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.37
Model XAI F1 of binarized graphs for r=0.6 =  0.14651866666666669
Model XAI WIoU of binarized graphs for r=0.6 =  0.09680866666666668
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.351 +- 0.420 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 1 = 0.302 +- 0.420 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 2 = 0.348 +- 0.420 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.363 +- 0.420 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.334 +- 0.325 (in-sample avg dev_std = 0.259)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.355
Model XAI F1 of binarized graphs for r=0.9 =  0.12127066666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.078766
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.354
NEC for r=0.9 class 0 = 0.24 +- 0.415 (in-sample avg dev_std = 0.360)
NEC for r=0.9 class 1 = 0.265 +- 0.415 (in-sample avg dev_std = 0.360)
NEC for r=0.9 class 2 = 0.263 +- 0.415 (in-sample avg dev_std = 0.360)
NEC for r=0.9 all KL = 0.364 +- 0.415 (in-sample avg dev_std = 0.360)
NEC for r=0.9 all L1 = 0.256 +- 0.291 (in-sample avg dev_std = 0.360)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.328
Model XAI F1 of binarized graphs for r=1.0 =  0.11342999999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.074238
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.366
NEC for r=1.0 class 0 = 0.254 +- 0.416 (in-sample avg dev_std = 0.304)
NEC for r=1.0 class 1 = 0.278 +- 0.416 (in-sample avg dev_std = 0.304)
NEC for r=1.0 class 2 = 0.275 +- 0.416 (in-sample avg dev_std = 0.304)
NEC for r=1.0 all KL = 0.414 +- 0.416 (in-sample avg dev_std = 0.304)
NEC for r=1.0 all L1 = 0.269 +- 0.274 (in-sample avg dev_std = 0.304)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 13:27:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:27:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3555) +- tensor(0.1811)
F1 for r=0.3 = 0.485
WIoU for r=0.3 = 0.366
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.452
F1 for r=0.9 = 0.526
WIoU for r=0.9 = 0.434
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.420
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1393) +- tensor(0.0670)
F1 for r=0.3 = 0.383
WIoU for r=0.3 = 0.343
F1 for r=0.6 = 0.313
WIoU for r=0.6 = 0.333
F1 for r=0.9 = 0.256
WIoU for r=0.9 = 0.325
F1 for r=1.0 = 0.239
WIoU for r=1.0 = 0.320
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0607) +- tensor(0.0245)
F1 for r=0.3 = 0.250
WIoU for r=0.3 = 0.295
F1 for r=0.6 = 0.158
WIoU for r=0.6 = 0.280
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.280
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.279


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.357
Model XAI F1 of binarized graphs for r=0.3 =  0.484712
Model XAI WIoU of binarized graphs for r=0.3 =  0.36559933333333333
len(reference) = 1413
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF++ for r=0.3 class 0 = 0.784 +- 0.140 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 1 = 0.826 +- 0.140 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 2 = 0.801 +- 0.140 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 all KL = 0.912 +- 0.140 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 all L1 = 0.803 +- 0.129 (in-sample avg dev_std = 0.240)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.556
Model XAI F1 of binarized graphs for r=0.6 =  0.566902
Model XAI WIoU of binarized graphs for r=0.6 =  0.451654
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.515
SUFF++ for r=0.6 class 0 = 0.671 +- 0.244 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 1 = 0.804 +- 0.244 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 2 = 0.708 +- 0.244 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all KL = 0.757 +- 0.244 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all L1 = 0.726 +- 0.195 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.785
Model XAI F1 of binarized graphs for r=0.9 =  0.5257033333333334
Model XAI WIoU of binarized graphs for r=0.9 =  0.43420933333333334
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.771
SUFF++ for r=0.9 class 0 = 0.799 +- 0.226 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 1 = 0.876 +- 0.226 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 class 2 = 0.822 +- 0.226 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 all KL = 0.858 +- 0.226 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.208 (in-sample avg dev_std = 0.299)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.548
Model XAI F1 of binarized graphs for r=0.3 =  0.3834473333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.34253000000000006
len(reference) = 1497
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.515
SUFF++ for r=0.3 class 0 = 0.765 +- 0.209 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 1 = 0.846 +- 0.209 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 2 = 0.795 +- 0.209 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 all KL = 0.85 +- 0.209 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.178 (in-sample avg dev_std = 0.363)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.597
Model XAI F1 of binarized graphs for r=0.6 =  0.31329466666666667
Model XAI WIoU of binarized graphs for r=0.6 =  0.332814
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.598
SUFF++ for r=0.6 class 0 = 0.726 +- 0.243 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.703 +- 0.243 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.243 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.742 +- 0.243 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.723 +- 0.198 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.655
Model XAI F1 of binarized graphs for r=0.9 =  0.25647400000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.32511266666666666
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.688
SUFF++ for r=0.9 class 0 = 0.702 +- 0.247 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 class 1 = 0.723 +- 0.247 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 class 2 = 0.681 +- 0.247 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 all KL = 0.764 +- 0.247 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.9 all L1 = 0.702 +- 0.234 (in-sample avg dev_std = 0.352)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.556
Model XAI F1 of binarized graphs for r=0.3 =  0.25009933333333334
Model XAI WIoU of binarized graphs for r=0.3 =  0.29531999999999997
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0 = 0.614 +- 0.316 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.3 class 1 = 0.568 +- 0.316 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.3 class 2 = 0.575 +- 0.316 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.3 all KL = 0.554 +- 0.316 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.3 all L1 = 0.585 +- 0.191 (in-sample avg dev_std = 0.536)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.411
Model XAI F1 of binarized graphs for r=0.6 =  0.15832466666666664
Model XAI WIoU of binarized graphs for r=0.6 =  0.27963133333333334
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.488
SUFF++ for r=0.6 class 0 = 0.777 +- 0.353 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.631 +- 0.353 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.71 +- 0.353 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.667 +- 0.353 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.706 +- 0.280 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.404
Model XAI F1 of binarized graphs for r=0.9 =  0.12235066666666668
Model XAI WIoU of binarized graphs for r=0.9 =  0.28028933333333333
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.398
SUFF++ for r=0.9 class 0 = 0.861 +- 0.274 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.274 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 2 = 0.844 +- 0.274 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all KL = 0.818 +- 0.274 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.232 (in-sample avg dev_std = 0.286)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.361
Model XAI F1 of binarized graphs for r=0.3 =  0.484712
Model XAI WIoU of binarized graphs for r=0.3 =  0.36559933333333333
len(reference) = 1500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.22 +- 0.170 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 1 = 0.178 +- 0.170 (in-sample avg dev_std = 0.184)
NEC for r=0.3 class 2 = 0.199 +- 0.170 (in-sample avg dev_std = 0.184)
NEC for r=0.3 all KL = 0.093 +- 0.170 (in-sample avg dev_std = 0.184)
NEC for r=0.3 all L1 = 0.199 +- 0.163 (in-sample avg dev_std = 0.184)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.566902
Model XAI WIoU of binarized graphs for r=0.6 =  0.451654
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.455 +- 0.313 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.294 +- 0.313 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.467 +- 0.313 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.377 +- 0.313 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.407 +- 0.234 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.785
Model XAI F1 of binarized graphs for r=0.9 =  0.5257033333333334
Model XAI WIoU of binarized graphs for r=0.9 =  0.43420933333333334
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.488
NEC for r=0.9 class 0 = 0.572 +- 0.290 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 1 = 0.352 +- 0.290 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 2 = 0.59 +- 0.290 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all KL = 0.544 +- 0.290 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all L1 = 0.507 +- 0.211 (in-sample avg dev_std = 0.592)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.898
Model XAI F1 of binarized graphs for r=1.0 =  0.4998793333333333
Model XAI WIoU of binarized graphs for r=1.0 =  0.41971333333333327
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.583 +- 0.301 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 1 = 0.35 +- 0.301 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 2 = 0.563 +- 0.301 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all KL = 0.542 +- 0.301 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all L1 = 0.501 +- 0.215 (in-sample avg dev_std = 0.610)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.548
Model XAI F1 of binarized graphs for r=0.3 =  0.3834473333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.34253000000000006
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.387 +- 0.346 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 1 = 0.266 +- 0.346 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 2 = 0.383 +- 0.346 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all KL = 0.294 +- 0.346 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all L1 = 0.345 +- 0.273 (in-sample avg dev_std = 0.274)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.597
Model XAI F1 of binarized graphs for r=0.6 =  0.31329466666666667
Model XAI WIoU of binarized graphs for r=0.6 =  0.332814
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.442
NEC for r=0.6 class 0 = 0.495 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 1 = 0.344 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 2 = 0.533 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all KL = 0.477 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all L1 = 0.456 +- 0.216 (in-sample avg dev_std = 0.519)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.655
Model XAI F1 of binarized graphs for r=0.9 =  0.25647400000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.32511266666666666
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.501
NEC for r=0.9 class 0 = 0.515 +- 0.259 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 1 = 0.401 +- 0.259 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 2 = 0.569 +- 0.259 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all KL = 0.492 +- 0.259 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all L1 = 0.494 +- 0.178 (in-sample avg dev_std = 0.520)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.69
Model XAI F1 of binarized graphs for r=1.0 =  0.2386686666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.31977533333333336
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.516
NEC for r=1.0 class 0 = 0.449 +- 0.310 (in-sample avg dev_std = 0.487)
NEC for r=1.0 class 1 = 0.351 +- 0.310 (in-sample avg dev_std = 0.487)
NEC for r=1.0 class 2 = 0.487 +- 0.310 (in-sample avg dev_std = 0.487)
NEC for r=1.0 all KL = 0.437 +- 0.310 (in-sample avg dev_std = 0.487)
NEC for r=1.0 all L1 = 0.428 +- 0.219 (in-sample avg dev_std = 0.487)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  0.25009933333333334
Model XAI WIoU of binarized graphs for r=0.3 =  0.29531999999999997
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.398 +- 0.322 (in-sample avg dev_std = 0.338)
NEC for r=0.3 class 1 = 0.413 +- 0.322 (in-sample avg dev_std = 0.338)
NEC for r=0.3 class 2 = 0.477 +- 0.322 (in-sample avg dev_std = 0.338)
NEC for r=0.3 all KL = 0.401 +- 0.322 (in-sample avg dev_std = 0.338)
NEC for r=0.3 all L1 = 0.428 +- 0.266 (in-sample avg dev_std = 0.338)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.411
Model XAI F1 of binarized graphs for r=0.6 =  0.15832466666666664
Model XAI WIoU of binarized graphs for r=0.6 =  0.27963133333333334
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.375
NEC for r=0.6 class 0 = 0.201 +- 0.285 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 1 = 0.231 +- 0.285 (in-sample avg dev_std = 0.293)
NEC for r=0.6 class 2 = 0.272 +- 0.285 (in-sample avg dev_std = 0.293)
NEC for r=0.6 all KL = 0.244 +- 0.285 (in-sample avg dev_std = 0.293)
NEC for r=0.6 all L1 = 0.234 +- 0.269 (in-sample avg dev_std = 0.293)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.404
Model XAI F1 of binarized graphs for r=0.9 =  0.12235066666666668
Model XAI WIoU of binarized graphs for r=0.9 =  0.28028933333333333
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.363
NEC for r=0.9 class 0 = 0.166 +- 0.328 (in-sample avg dev_std = 0.267)
NEC for r=0.9 class 1 = 0.167 +- 0.328 (in-sample avg dev_std = 0.267)
NEC for r=0.9 class 2 = 0.141 +- 0.328 (in-sample avg dev_std = 0.267)
NEC for r=0.9 all KL = 0.19 +- 0.328 (in-sample avg dev_std = 0.267)
NEC for r=0.9 all L1 = 0.158 +- 0.264 (in-sample avg dev_std = 0.267)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.377
Model XAI F1 of binarized graphs for r=1.0 =  0.11342999999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.2794846666666667
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.363
NEC for r=1.0 class 0 = 0.149 +- 0.301 (in-sample avg dev_std = 0.264)
NEC for r=1.0 class 1 = 0.143 +- 0.301 (in-sample avg dev_std = 0.264)
NEC for r=1.0 class 2 = 0.106 +- 0.301 (in-sample avg dev_std = 0.264)
NEC for r=1.0 all KL = 0.169 +- 0.301 (in-sample avg dev_std = 0.264)
NEC for r=1.0 all L1 = 0.133 +- 0.233 (in-sample avg dev_std = 0.264)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 13:39:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:14 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:30 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:34 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:39:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3555) +- tensor(0.1811)
F1 for r=0.3 = 0.596
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.620
WIoU for r=0.6 = 0.589
F1 for r=0.9 = 0.523
WIoU for r=0.9 = 0.589
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.589
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1393) +- tensor(0.0670)
F1 for r=0.3 = 0.478
WIoU for r=0.3 = 0.458
F1 for r=0.6 = 0.345
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.257
WIoU for r=0.9 = 0.429
F1 for r=1.0 = 0.239
WIoU for r=1.0 = 0.428
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0607) +- tensor(0.0245)
F1 for r=0.3 = 0.278
WIoU for r=0.3 = 0.216
F1 for r=0.6 = 0.174
WIoU for r=0.6 = 0.166
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.148
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.144


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.384
Model XAI F1 of binarized graphs for r=0.3 =  0.5956133333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.4837566666666667
len(reference) = 1453
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.353
SUFF++ for r=0.3 class 0 = 0.842 +- 0.215 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.3 class 1 = 0.928 +- 0.215 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.3 class 2 = 0.839 +- 0.215 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.3 all KL = 0.894 +- 0.215 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.3 all L1 = 0.868 +- 0.187 (in-sample avg dev_std = 0.286)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.678
Model XAI F1 of binarized graphs for r=0.6 =  0.6202553333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.5893286666666666
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.632
SUFF++ for r=0.6 class 0 = 0.756 +- 0.235 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.855 +- 0.235 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.735 +- 0.235 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.793 +- 0.235 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.781 +- 0.203 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.5227186666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.589426
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.791
SUFF++ for r=0.9 class 0 = 0.845 +- 0.192 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 class 1 = 0.895 +- 0.192 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 class 2 = 0.901 +- 0.192 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 all KL = 0.899 +- 0.192 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.9 all L1 = 0.88 +- 0.184 (in-sample avg dev_std = 0.281)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  0.47847599999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.45838333333333336
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.578
SUFF++ for r=0.3 class 0 = 0.782 +- 0.232 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 1 = 0.89 +- 0.232 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 2 = 0.804 +- 0.232 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 all KL = 0.828 +- 0.232 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 all L1 = 0.825 +- 0.193 (in-sample avg dev_std = 0.406)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.718
Model XAI F1 of binarized graphs for r=0.6 =  0.3449533333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.434242
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.69
SUFF++ for r=0.6 class 0 = 0.741 +- 0.191 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 1 = 0.757 +- 0.191 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 2 = 0.754 +- 0.191 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all KL = 0.814 +- 0.191 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all L1 = 0.751 +- 0.188 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.685
Model XAI F1 of binarized graphs for r=0.9 =  0.2569146666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.4294186666666666
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.695
SUFF++ for r=0.9 class 0 = 0.769 +- 0.281 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.281 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.9 class 2 = 0.803 +- 0.281 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.9 all KL = 0.801 +- 0.281 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.9 all L1 = 0.803 +- 0.228 (in-sample avg dev_std = 0.387)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  0.27830333333333335
Model XAI WIoU of binarized graphs for r=0.3 =  0.21584466666666666
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.636
SUFF++ for r=0.3 class 0 = 0.704 +- 0.189 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.3 class 1 = 0.802 +- 0.189 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.3 class 2 = 0.693 +- 0.189 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.3 all KL = 0.809 +- 0.189 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.3 all L1 = 0.734 +- 0.157 (in-sample avg dev_std = 0.372)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.485
Model XAI F1 of binarized graphs for r=0.6 =  0.17380733333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.16589133333333334
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.557
SUFF++ for r=0.6 class 0 = 0.671 +- 0.246 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.6 class 1 = 0.783 +- 0.246 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.6 class 2 = 0.77 +- 0.246 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.6 all KL = 0.725 +- 0.246 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.6 all L1 = 0.741 +- 0.206 (in-sample avg dev_std = 0.352)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.376
Model XAI F1 of binarized graphs for r=0.9 =  0.12371999999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.14770533333333333
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.406
SUFF++ for r=0.9 class 0 = 0.803 +- 0.222 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.222 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 class 2 = 0.851 +- 0.222 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 all KL = 0.826 +- 0.222 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 all L1 = 0.823 +- 0.178 (in-sample avg dev_std = 0.356)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.385
Model XAI F1 of binarized graphs for r=0.3 =  0.5956133333333333
Model XAI WIoU of binarized graphs for r=0.3 =  0.4837566666666667
len(reference) = 1500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.176 +- 0.246 (in-sample avg dev_std = 0.154)
NEC for r=0.3 class 1 = 0.104 +- 0.246 (in-sample avg dev_std = 0.154)
NEC for r=0.3 class 2 = 0.172 +- 0.246 (in-sample avg dev_std = 0.154)
NEC for r=0.3 all KL = 0.108 +- 0.246 (in-sample avg dev_std = 0.154)
NEC for r=0.3 all L1 = 0.151 +- 0.225 (in-sample avg dev_std = 0.154)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.678
Model XAI F1 of binarized graphs for r=0.6 =  0.6202553333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.5893286666666666
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.406
NEC for r=0.6 class 0 = 0.522 +- 0.370 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 1 = 0.23 +- 0.370 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 2 = 0.537 +- 0.370 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all KL = 0.443 +- 0.370 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all L1 = 0.432 +- 0.290 (in-sample avg dev_std = 0.481)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.5227186666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.589426
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.5
NEC for r=0.9 class 0 = 0.612 +- 0.329 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 1 = 0.27 +- 0.329 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 2 = 0.597 +- 0.329 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all KL = 0.552 +- 0.329 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all L1 = 0.496 +- 0.259 (in-sample avg dev_std = 0.609)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.937
Model XAI F1 of binarized graphs for r=1.0 =  0.4998793333333333
Model XAI WIoU of binarized graphs for r=1.0 =  0.588964
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0 = 0.614 +- 0.332 (in-sample avg dev_std = 0.645)
NEC for r=1.0 class 1 = 0.241 +- 0.332 (in-sample avg dev_std = 0.645)
NEC for r=1.0 class 2 = 0.593 +- 0.332 (in-sample avg dev_std = 0.645)
NEC for r=1.0 all KL = 0.565 +- 0.332 (in-sample avg dev_std = 0.645)
NEC for r=1.0 all L1 = 0.486 +- 0.264 (in-sample avg dev_std = 0.645)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.609
Model XAI F1 of binarized graphs for r=0.3 =  0.47847599999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.45838333333333336
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.427 +- 0.428 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1 = 0.093 +- 0.428 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 2 = 0.439 +- 0.428 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.33 +- 0.428 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.318 +- 0.365 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.718
Model XAI F1 of binarized graphs for r=0.6 =  0.3449533333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.434242
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.437
NEC for r=0.6 class 0 = 0.604 +- 0.349 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 1 = 0.211 +- 0.349 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 2 = 0.597 +- 0.349 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all KL = 0.453 +- 0.349 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all L1 = 0.47 +- 0.277 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.687
Model XAI F1 of binarized graphs for r=0.9 =  0.2569146666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.4294186666666666
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 0 = 0.539 +- 0.317 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 1 = 0.176 +- 0.317 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 2 = 0.538 +- 0.317 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all KL = 0.426 +- 0.317 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all L1 = 0.416 +- 0.274 (in-sample avg dev_std = 0.512)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.875
Model XAI F1 of binarized graphs for r=1.0 =  0.2386686666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.428482
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.521
NEC for r=1.0 class 0 = 0.653 +- 0.327 (in-sample avg dev_std = 0.538)
NEC for r=1.0 class 1 = 0.19 +- 0.327 (in-sample avg dev_std = 0.538)
NEC for r=1.0 class 2 = 0.607 +- 0.327 (in-sample avg dev_std = 0.538)
NEC for r=1.0 all KL = 0.496 +- 0.327 (in-sample avg dev_std = 0.538)
NEC for r=1.0 all L1 = 0.482 +- 0.269 (in-sample avg dev_std = 0.538)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  0.27830333333333335
Model XAI WIoU of binarized graphs for r=0.3 =  0.21584466666666666
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.525 +- 0.417 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1 = 0.157 +- 0.417 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 2 = 0.509 +- 0.417 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.367 +- 0.417 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.394 +- 0.342 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.485
Model XAI F1 of binarized graphs for r=0.6 =  0.17380733333333334
Model XAI WIoU of binarized graphs for r=0.6 =  0.16589133333333334
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.308 +- 0.275 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.165 +- 0.275 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.361 +- 0.275 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.276 +- 0.275 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.276 +- 0.235 (in-sample avg dev_std = 0.309)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.375
Model XAI F1 of binarized graphs for r=0.9 =  0.12371999999999998
Model XAI WIoU of binarized graphs for r=0.9 =  0.14770533333333333
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.367
NEC for r=0.9 class 0 = 0.26 +- 0.233 (in-sample avg dev_std = 0.264)
NEC for r=0.9 class 1 = 0.201 +- 0.233 (in-sample avg dev_std = 0.264)
NEC for r=0.9 class 2 = 0.291 +- 0.233 (in-sample avg dev_std = 0.264)
NEC for r=0.9 all KL = 0.204 +- 0.233 (in-sample avg dev_std = 0.264)
NEC for r=0.9 all L1 = 0.25 +- 0.206 (in-sample avg dev_std = 0.264)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.42
Model XAI F1 of binarized graphs for r=1.0 =  0.11342999999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.143894
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.351
NEC for r=1.0 class 0 = 0.338 +- 0.256 (in-sample avg dev_std = 0.295)
NEC for r=1.0 class 1 = 0.323 +- 0.256 (in-sample avg dev_std = 0.295)
NEC for r=1.0 class 2 = 0.325 +- 0.256 (in-sample avg dev_std = 0.295)
NEC for r=1.0 all KL = 0.318 +- 0.256 (in-sample avg dev_std = 0.295)
NEC for r=1.0 all L1 = 0.329 +- 0.208 (in-sample avg dev_std = 0.295)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 13:50:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 01:50:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:00 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 01:51:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3555) +- tensor(0.1811)
F1 for r=0.3 = 0.412
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.425
WIoU for r=0.6 = 0.369
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.407
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.409
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1393) +- tensor(0.0670)
F1 for r=0.3 = 0.312
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.260
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.220
WIoU for r=0.9 = 0.320
F1 for r=1.0 = 0.239
WIoU for r=1.0 = 0.323
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0607) +- tensor(0.0245)
F1 for r=0.3 = 0.169
WIoU for r=0.3 = 0.253
F1 for r=0.6 = 0.136
WIoU for r=0.6 = 0.260
F1 for r=0.9 = 0.103
WIoU for r=0.9 = 0.261
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.266


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.479
Model XAI F1 of binarized graphs for r=0.3 =  0.4117293333333334
Model XAI WIoU of binarized graphs for r=0.3 =  0.3541833333333334
len(reference) = 1491
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.413
SUFF++ for r=0.3 class 0 = 0.624 +- 0.310 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 1 = 0.773 +- 0.310 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 2 = 0.71 +- 0.310 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 all KL = 0.699 +- 0.310 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 all L1 = 0.701 +- 0.275 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.613
Model XAI F1 of binarized graphs for r=0.6 =  0.424952
Model XAI WIoU of binarized graphs for r=0.6 =  0.36889999999999995
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.469
SUFF++ for r=0.6 class 0 = 0.411 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 1 = 0.62 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 2 = 0.543 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all KL = 0.528 +- 0.278 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all L1 = 0.523 +- 0.231 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.4665826666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.4065593333333334
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.713
SUFF++ for r=0.9 class 0 = 0.636 +- 0.305 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.9 class 1 = 0.739 +- 0.305 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.9 class 2 = 0.687 +- 0.305 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.9 all KL = 0.671 +- 0.305 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.9 all L1 = 0.687 +- 0.253 (in-sample avg dev_std = 0.518)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.518
Model XAI F1 of binarized graphs for r=0.3 =  0.3118626666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.31259666666666663
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.466
SUFF++ for r=0.3 class 0 = 0.56 +- 0.312 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.708 +- 0.312 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.671 +- 0.312 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.613 +- 0.312 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.646 +- 0.260 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  0.26027866666666666
Model XAI WIoU of binarized graphs for r=0.6 =  0.31483066666666665
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.486
SUFF++ for r=0.6 class 0 = 0.494 +- 0.280 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1 = 0.677 +- 0.280 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 2 = 0.577 +- 0.280 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.63 +- 0.280 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.583 +- 0.225 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.691
Model XAI F1 of binarized graphs for r=0.9 =  0.21951733333333331
Model XAI WIoU of binarized graphs for r=0.9 =  0.31981733333333334
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.613
SUFF++ for r=0.9 class 0 = 0.542 +- 0.303 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.9 class 1 = 0.611 +- 0.303 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.9 class 2 = 0.685 +- 0.303 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.9 all KL = 0.622 +- 0.303 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.9 all L1 = 0.611 +- 0.265 (in-sample avg dev_std = 0.456)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.16882133333333332
Model XAI WIoU of binarized graphs for r=0.3 =  0.2530773333333333
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.453
SUFF++ for r=0.3 class 0 = 0.516 +- 0.320 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 1 = 0.57 +- 0.320 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 2 = 0.568 +- 0.320 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all KL = 0.476 +- 0.320 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.244 (in-sample avg dev_std = 0.594)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.391
Model XAI F1 of binarized graphs for r=0.6 =  0.13617600000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.25987866666666665
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.428
SUFF++ for r=0.6 class 0 = 0.514 +- 0.276 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.6 class 1 = 0.555 +- 0.276 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.6 class 2 = 0.558 +- 0.276 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.6 all KL = 0.494 +- 0.276 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.6 all L1 = 0.542 +- 0.200 (in-sample avg dev_std = 0.537)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.407
Model XAI F1 of binarized graphs for r=0.9 =  0.103086
Model XAI WIoU of binarized graphs for r=0.9 =  0.26127199999999995
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.395
SUFF++ for r=0.9 class 0 = 0.72 +- 0.208 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 1 = 0.766 +- 0.208 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 class 2 = 0.759 +- 0.208 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 all KL = 0.791 +- 0.208 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.9 all L1 = 0.748 +- 0.201 (in-sample avg dev_std = 0.337)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.478
Model XAI F1 of binarized graphs for r=0.3 =  0.4117293333333334
Model XAI WIoU of binarized graphs for r=0.3 =  0.3541833333333334
len(reference) = 1500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.428 +- 0.361 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 1 = 0.213 +- 0.361 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 2 = 0.396 +- 0.361 (in-sample avg dev_std = 0.377)
NEC for r=0.3 all KL = 0.352 +- 0.361 (in-sample avg dev_std = 0.377)
NEC for r=0.3 all L1 = 0.348 +- 0.318 (in-sample avg dev_std = 0.377)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.613
Model XAI F1 of binarized graphs for r=0.6 =  0.424952
Model XAI WIoU of binarized graphs for r=0.6 =  0.36889999999999995
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.423
NEC for r=0.6 class 0 = 0.608 +- 0.313 (in-sample avg dev_std = 0.520)
NEC for r=0.6 class 1 = 0.348 +- 0.313 (in-sample avg dev_std = 0.520)
NEC for r=0.6 class 2 = 0.574 +- 0.313 (in-sample avg dev_std = 0.520)
NEC for r=0.6 all KL = 0.517 +- 0.313 (in-sample avg dev_std = 0.520)
NEC for r=0.6 all L1 = 0.512 +- 0.252 (in-sample avg dev_std = 0.520)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.4665826666666667
Model XAI WIoU of binarized graphs for r=0.9 =  0.4065593333333334
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.526
NEC for r=0.9 class 0 = 0.612 +- 0.317 (in-sample avg dev_std = 0.634)
NEC for r=0.9 class 1 = 0.258 +- 0.317 (in-sample avg dev_std = 0.634)
NEC for r=0.9 class 2 = 0.608 +- 0.317 (in-sample avg dev_std = 0.634)
NEC for r=0.9 all KL = 0.559 +- 0.317 (in-sample avg dev_std = 0.634)
NEC for r=0.9 all L1 = 0.496 +- 0.255 (in-sample avg dev_std = 0.634)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.4998793333333333
Model XAI WIoU of binarized graphs for r=1.0 =  0.40929
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0 = 0.594 +- 0.293 (in-sample avg dev_std = 0.684)
NEC for r=1.0 class 1 = 0.281 +- 0.293 (in-sample avg dev_std = 0.684)
NEC for r=1.0 class 2 = 0.603 +- 0.293 (in-sample avg dev_std = 0.684)
NEC for r=1.0 all KL = 0.582 +- 0.293 (in-sample avg dev_std = 0.684)
NEC for r=1.0 all L1 = 0.496 +- 0.231 (in-sample avg dev_std = 0.684)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.517
Model XAI F1 of binarized graphs for r=0.3 =  0.3118626666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.31259666666666663
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.494 +- 0.403 (in-sample avg dev_std = 0.362)
NEC for r=0.3 class 1 = 0.274 +- 0.403 (in-sample avg dev_std = 0.362)
NEC for r=0.3 class 2 = 0.496 +- 0.403 (in-sample avg dev_std = 0.362)
NEC for r=0.3 all KL = 0.449 +- 0.403 (in-sample avg dev_std = 0.362)
NEC for r=0.3 all L1 = 0.421 +- 0.339 (in-sample avg dev_std = 0.362)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  0.26027866666666666
Model XAI WIoU of binarized graphs for r=0.6 =  0.31483066666666665
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.434
NEC for r=0.6 class 0 = 0.56 +- 0.377 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.334 +- 0.377 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.588 +- 0.377 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.499 +- 0.377 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.493 +- 0.278 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.691
Model XAI F1 of binarized graphs for r=0.9 =  0.21951733333333331
Model XAI WIoU of binarized graphs for r=0.9 =  0.31981733333333334
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.621 +- 0.285 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.434 +- 0.285 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.632 +- 0.285 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.619 +- 0.285 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.562 +- 0.222 (in-sample avg dev_std = 0.571)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.791
Model XAI F1 of binarized graphs for r=1.0 =  0.2386686666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.3226813333333333
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.513
NEC for r=1.0 class 0 = 0.597 +- 0.267 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 1 = 0.467 +- 0.267 (in-sample avg dev_std = 0.611)
NEC for r=1.0 class 2 = 0.622 +- 0.267 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all KL = 0.631 +- 0.267 (in-sample avg dev_std = 0.611)
NEC for r=1.0 all L1 = 0.561 +- 0.208 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.16882133333333332
Model XAI WIoU of binarized graphs for r=0.3 =  0.2530773333333333
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.384
NEC for r=0.3 class 0 = 0.536 +- 0.380 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 1 = 0.42 +- 0.380 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 2 = 0.528 +- 0.380 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all KL = 0.524 +- 0.380 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all L1 = 0.494 +- 0.317 (in-sample avg dev_std = 0.399)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.391
Model XAI F1 of binarized graphs for r=0.6 =  0.13617600000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.25987866666666665
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.555 +- 0.368 (in-sample avg dev_std = 0.439)
NEC for r=0.6 class 1 = 0.522 +- 0.368 (in-sample avg dev_std = 0.439)
NEC for r=0.6 class 2 = 0.565 +- 0.368 (in-sample avg dev_std = 0.439)
NEC for r=0.6 all KL = 0.593 +- 0.368 (in-sample avg dev_std = 0.439)
NEC for r=0.6 all L1 = 0.547 +- 0.247 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.407
Model XAI F1 of binarized graphs for r=0.9 =  0.103086
Model XAI WIoU of binarized graphs for r=0.9 =  0.26127199999999995
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.338
NEC for r=0.9 class 0 = 0.457 +- 0.336 (in-sample avg dev_std = 0.424)
NEC for r=0.9 class 1 = 0.429 +- 0.336 (in-sample avg dev_std = 0.424)
NEC for r=0.9 class 2 = 0.371 +- 0.336 (in-sample avg dev_std = 0.424)
NEC for r=0.9 all KL = 0.426 +- 0.336 (in-sample avg dev_std = 0.424)
NEC for r=0.9 all L1 = 0.42 +- 0.233 (in-sample avg dev_std = 0.424)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.492
Model XAI F1 of binarized graphs for r=1.0 =  0.11342999999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.2657646666666667
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.351
NEC for r=1.0 class 0 = 0.477 +- 0.346 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 1 = 0.463 +- 0.346 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 2 = 0.357 +- 0.346 (in-sample avg dev_std = 0.424)
NEC for r=1.0 all KL = 0.479 +- 0.346 (in-sample avg dev_std = 0.424)
NEC for r=1.0 all L1 = 0.434 +- 0.251 (in-sample avg dev_std = 0.424)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 14:02:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 02:02:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 02:02:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 02:02:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 02:02:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 02:02:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:03:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3555) +- tensor(0.1811)
F1 for r=0.3 = 0.319
WIoU for r=0.3 = 0.243
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.308
F1 for r=0.9 = 0.498
WIoU for r=0.9 = 0.390
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.393
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1393) +- tensor(0.0670)
F1 for r=0.3 = 0.301
WIoU for r=0.3 = 0.279
F1 for r=0.6 = 0.248
WIoU for r=0.6 = 0.245
F1 for r=0.9 = 0.224
WIoU for r=0.9 = 0.235
F1 for r=1.0 = 0.239
WIoU for r=1.0 = 0.239
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0607) +- tensor(0.0245)
F1 for r=0.3 = 0.190
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.141
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.114
WIoU for r=0.9 = 0.243
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.242


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.312
Model XAI F1 of binarized graphs for r=0.3 =  0.3192986666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.24261533333333332
len(reference) = 1476
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF++ for r=0.3 class 0 = 0.75 +- 0.146 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.3 class 1 = 0.762 +- 0.146 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.3 class 2 = 0.789 +- 0.146 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.3 all KL = 0.875 +- 0.146 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.3 all L1 = 0.767 +- 0.145 (in-sample avg dev_std = 0.297)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.393
Model XAI F1 of binarized graphs for r=0.6 =  0.411492
Model XAI WIoU of binarized graphs for r=0.6 =  0.30798866666666663
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.395
SUFF++ for r=0.6 class 0 = 0.551 +- 0.263 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 1 = 0.645 +- 0.263 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 2 = 0.573 +- 0.263 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all KL = 0.634 +- 0.263 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all L1 = 0.589 +- 0.198 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  0.49841
Model XAI WIoU of binarized graphs for r=0.9 =  0.39027799999999996
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.633
SUFF++ for r=0.9 class 0 = 0.562 +- 0.296 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 1 = 0.8 +- 0.296 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 2 = 0.601 +- 0.296 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 all KL = 0.664 +- 0.296 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 all L1 = 0.652 +- 0.267 (in-sample avg dev_std = 0.478)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.300992
Model XAI WIoU of binarized graphs for r=0.3 =  0.2788946666666667
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.449
SUFF++ for r=0.3 class 0 = 0.712 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 1 = 0.841 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 2 = 0.712 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all KL = 0.784 +- 0.247 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.195 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  0.24804199999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.2452893333333333
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.485
SUFF++ for r=0.6 class 0 = 0.62 +- 0.265 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 class 1 = 0.788 +- 0.265 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 class 2 = 0.639 +- 0.265 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 all KL = 0.675 +- 0.265 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 all L1 = 0.682 +- 0.226 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.623
Model XAI F1 of binarized graphs for r=0.9 =  0.22416399999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.23500400000000002
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.612
SUFF++ for r=0.9 class 0 = 0.647 +- 0.282 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.282 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.9 class 2 = 0.632 +- 0.282 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.9 all KL = 0.725 +- 0.282 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.9 all L1 = 0.678 +- 0.243 (in-sample avg dev_std = 0.414)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  0.189654
Model XAI WIoU of binarized graphs for r=0.3 =  0.2651033333333333
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.462
SUFF++ for r=0.3 class 0 = 0.568 +- 0.289 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 1 = 0.681 +- 0.289 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 class 2 = 0.595 +- 0.289 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all KL = 0.585 +- 0.289 (in-sample avg dev_std = 0.588)
SUFF++ for r=0.3 all L1 = 0.615 +- 0.181 (in-sample avg dev_std = 0.588)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.449
Model XAI F1 of binarized graphs for r=0.6 =  0.14056466666666667
Model XAI WIoU of binarized graphs for r=0.6 =  0.251848
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.456
SUFF++ for r=0.6 class 0 = 0.721 +- 0.218 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 1 = 0.808 +- 0.218 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 2 = 0.774 +- 0.218 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all KL = 0.81 +- 0.218 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all L1 = 0.768 +- 0.225 (in-sample avg dev_std = 0.391)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.393
Model XAI F1 of binarized graphs for r=0.9 =  0.11440733333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.24347199999999997
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.403
SUFF++ for r=0.9 class 0 = 0.89 +- 0.158 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 1 = 0.897 +- 0.158 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 2 = 0.906 +- 0.158 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all KL = 0.916 +- 0.158 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all L1 = 0.897 +- 0.122 (in-sample avg dev_std = 0.184)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.309
Model XAI F1 of binarized graphs for r=0.3 =  0.3192986666666667
Model XAI WIoU of binarized graphs for r=0.3 =  0.24261533333333332
len(reference) = 1500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.284
NEC for r=0.3 class 0 = 0.244 +- 0.167 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 1 = 0.223 +- 0.167 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 2 = 0.196 +- 0.167 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all KL = 0.11 +- 0.167 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all L1 = 0.221 +- 0.181 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.393
Model XAI F1 of binarized graphs for r=0.6 =  0.411492
Model XAI WIoU of binarized graphs for r=0.6 =  0.30798866666666663
len(reference) = 1500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.378
NEC for r=0.6 class 0 = 0.462 +- 0.292 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 1 = 0.388 +- 0.292 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 2 = 0.45 +- 0.292 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all KL = 0.384 +- 0.292 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all L1 = 0.434 +- 0.219 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.731
Model XAI F1 of binarized graphs for r=0.9 =  0.49841
Model XAI WIoU of binarized graphs for r=0.9 =  0.39027799999999996
len(reference) = 1500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 0 = 0.614 +- 0.309 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.272 +- 0.309 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.601 +- 0.309 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.499 +- 0.309 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.499 +- 0.246 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.903
Model XAI F1 of binarized graphs for r=1.0 =  0.4998793333333333
Model XAI WIoU of binarized graphs for r=1.0 =  0.39277199999999995
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.595 +- 0.325 (in-sample avg dev_std = 0.612)
NEC for r=1.0 class 1 = 0.226 +- 0.325 (in-sample avg dev_std = 0.612)
NEC for r=1.0 class 2 = 0.607 +- 0.325 (in-sample avg dev_std = 0.612)
NEC for r=1.0 all KL = 0.525 +- 0.325 (in-sample avg dev_std = 0.612)
NEC for r=1.0 all L1 = 0.479 +- 0.249 (in-sample avg dev_std = 0.612)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.494
Model XAI F1 of binarized graphs for r=0.3 =  0.300992
Model XAI WIoU of binarized graphs for r=0.3 =  0.2788946666666667
len(reference) = 1500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.329 +- 0.326 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.145 +- 0.326 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.319 +- 0.326 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.215 +- 0.326 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.264 +- 0.276 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  0.24804199999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.2452893333333333
len(reference) = 1500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.406
NEC for r=0.6 class 0 = 0.444 +- 0.331 (in-sample avg dev_std = 0.437)
NEC for r=0.6 class 1 = 0.198 +- 0.331 (in-sample avg dev_std = 0.437)
NEC for r=0.6 class 2 = 0.416 +- 0.331 (in-sample avg dev_std = 0.437)
NEC for r=0.6 all KL = 0.36 +- 0.331 (in-sample avg dev_std = 0.437)
NEC for r=0.6 all L1 = 0.352 +- 0.284 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.623
Model XAI F1 of binarized graphs for r=0.9 =  0.22416399999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.23500400000000002
len(reference) = 1500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.447
NEC for r=0.9 class 0 = 0.607 +- 0.324 (in-sample avg dev_std = 0.497)
NEC for r=0.9 class 1 = 0.31 +- 0.324 (in-sample avg dev_std = 0.497)
NEC for r=0.9 class 2 = 0.613 +- 0.324 (in-sample avg dev_std = 0.497)
NEC for r=0.9 all KL = 0.496 +- 0.324 (in-sample avg dev_std = 0.497)
NEC for r=0.9 all L1 = 0.509 +- 0.256 (in-sample avg dev_std = 0.497)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.818
Model XAI F1 of binarized graphs for r=1.0 =  0.2386686666666667
Model XAI WIoU of binarized graphs for r=1.0 =  0.23933200000000004
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.516
NEC for r=1.0 class 0 = 0.621 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 1 = 0.259 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=1.0 class 2 = 0.549 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all KL = 0.467 +- 0.319 (in-sample avg dev_std = 0.504)
NEC for r=1.0 all L1 = 0.476 +- 0.251 (in-sample avg dev_std = 0.504)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  0.189654
Model XAI WIoU of binarized graphs for r=0.3 =  0.2651033333333333
len(reference) = 1500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.378 +- 0.363 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 1 = 0.223 +- 0.363 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 2 = 0.474 +- 0.363 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all KL = 0.318 +- 0.363 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all L1 = 0.355 +- 0.306 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.449
Model XAI F1 of binarized graphs for r=0.6 =  0.14056466666666667
Model XAI WIoU of binarized graphs for r=0.6 =  0.251848
len(reference) = 1500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.376
NEC for r=0.6 class 0 = 0.267 +- 0.269 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 1 = 0.198 +- 0.269 (in-sample avg dev_std = 0.354)
NEC for r=0.6 class 2 = 0.333 +- 0.269 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all KL = 0.221 +- 0.269 (in-sample avg dev_std = 0.354)
NEC for r=0.6 all L1 = 0.264 +- 0.253 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.393
Model XAI F1 of binarized graphs for r=0.9 =  0.11440733333333333
Model XAI WIoU of binarized graphs for r=0.9 =  0.24347199999999997
len(reference) = 1500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.373
NEC for r=0.9 class 0 = 0.219 +- 0.267 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 1 = 0.21 +- 0.267 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 2 = 0.253 +- 0.267 (in-sample avg dev_std = 0.369)
NEC for r=0.9 all KL = 0.247 +- 0.267 (in-sample avg dev_std = 0.369)
NEC for r=0.9 all L1 = 0.227 +- 0.197 (in-sample avg dev_std = 0.369)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.423
Model XAI F1 of binarized graphs for r=1.0 =  0.11342999999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.242484
len(reference) = 1500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.385
NEC for r=1.0 class 0 = 0.328 +- 0.303 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 1 = 0.321 +- 0.303 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 2 = 0.302 +- 0.303 (in-sample avg dev_std = 0.396)
NEC for r=1.0 all KL = 0.312 +- 0.303 (in-sample avg dev_std = 0.396)
NEC for r=1.0 all L1 = 0.317 +- 0.243 (in-sample avg dev_std = 0.396)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.896, 0.805, 0.87, 1.0], 'all_L1': [0.778, 0.767, 0.816, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.757, 0.858, 1.0], 'all_L1': [0.803, 0.726, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.894, 0.793, 0.899, 1.0], 'all_L1': [0.868, 0.781, 0.88, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.699, 0.528, 0.671, 1.0], 'all_L1': [0.701, 0.523, 0.687, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.875, 0.634, 0.664, 1.0], 'all_L1': [0.767, 0.589, 0.652, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.117, 0.342, 0.515, 0.494], 'all_L1': [0.237, 0.367, 0.517, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.377, 0.544, 0.542], 'all_L1': [0.199, 0.407, 0.507, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.443, 0.552, 0.565], 'all_L1': [0.151, 0.432, 0.496, 0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.352, 0.517, 0.559, 0.582], 'all_L1': [0.348, 0.512, 0.496, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.11, 0.384, 0.499, 0.525], 'all_L1': [0.221, 0.434, 0.499, 0.479]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.941, 0.769, 0.795, 1.0], 'all_L1': [0.882, 0.745, 0.743, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.85, 0.742, 0.764, 1.0], 'all_L1': [0.802, 0.723, 0.702, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.828, 0.814, 0.801, 1.0], 'all_L1': [0.825, 0.751, 0.803, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.63, 0.622, 1.0], 'all_L1': [0.646, 0.583, 0.611, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.784, 0.675, 0.725, 1.0], 'all_L1': [0.755, 0.682, 0.678, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.146, 0.221, 0.386, 0.357], 'all_L1': [0.199, 0.266, 0.416, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.294, 0.477, 0.492, 0.437], 'all_L1': [0.345, 0.456, 0.494, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.33, 0.453, 0.426, 0.496], 'all_L1': [0.318, 0.47, 0.416, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.499, 0.619, 0.631], 'all_L1': [0.421, 0.493, 0.562, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.215, 0.36, 0.496, 0.467], 'all_L1': [0.264, 0.352, 0.509, 0.476]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.898, 0.525, 0.572, 1.0], 'all_L1': [0.845, 0.608, 0.728, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.667, 0.818, 1.0], 'all_L1': [0.585, 0.706, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.809, 0.725, 0.826, 1.0], 'all_L1': [0.734, 0.741, 0.823, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.476, 0.494, 0.791, 1.0], 'all_L1': [0.551, 0.542, 0.748, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.81, 0.916, 1.0], 'all_L1': [0.615, 0.768, 0.897, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.141, 0.363, 0.364, 0.414], 'all_L1': [0.185, 0.334, 0.256, 0.269]}), defaultdict(<class 'list'>, {'all_KL': [0.401, 0.244, 0.19, 0.169], 'all_L1': [0.428, 0.234, 0.158, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.367, 0.276, 0.204, 0.318], 'all_L1': [0.394, 0.276, 0.25, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.593, 0.426, 0.479], 'all_L1': [0.494, 0.547, 0.42, 0.434]}), defaultdict(<class 'list'>, {'all_KL': [0.318, 0.221, 0.247, 0.312], 'all_L1': [0.355, 0.264, 0.227, 0.317]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.783 +- 0.054, 0.677 +- 0.103, 0.773 +- 0.088, 1.000 +- 0.000
suff++ class all_KL  =  0.855 +- 0.079, 0.703 +- 0.107, 0.792 +- 0.103, 1.000 +- 0.000
suff++_acc_int  =  0.355 +- 0.030, 0.502 +- 0.077, 0.741 +- 0.061
nec class all_L1  =  0.231 +- 0.065, 0.430 +- 0.047, 0.503 +- 0.008, 0.489 +- 0.008
nec class all_KL  =  0.156 +- 0.098, 0.413 +- 0.061, 0.534 +- 0.023, 0.542 +- 0.031
nec_acc_int  =  0.323 +- 0.021, 0.405 +- 0.015, 0.501 +- 0.013, 0.541 +- 0.007

Eval split val
suff++ class all_L1  =  0.782 +- 0.079, 0.697 +- 0.062, 0.707 +- 0.064, 1.000 +- 0.000
suff++ class all_KL  =  0.803 +- 0.108, 0.726 +- 0.066, 0.741 +- 0.066, 1.000 +- 0.000
suff++_acc_int  =  0.491 +- 0.050, 0.552 +- 0.081, 0.647 +- 0.036
nec class all_L1  =  0.309 +- 0.075, 0.407 +- 0.086, 0.479 +- 0.056, 0.462 +- 0.065
nec class all_KL  =  0.287 +- 0.103, 0.402 +- 0.102, 0.484 +- 0.079, 0.478 +- 0.090
nec_acc_int  =  0.351 +- 0.009, 0.420 +- 0.023, 0.479 +- 0.025, 0.511 +- 0.011

Eval split test
suff++ class all_L1  =  0.666 +- 0.109, 0.673 +- 0.085, 0.809 +- 0.063, 1.000 +- 0.000
suff++ class all_KL  =  0.664 +- 0.161, 0.644 +- 0.119, 0.785 +- 0.114, 1.000 +- 0.000
suff++_acc_int  =  0.509 +- 0.085, 0.465 +- 0.055, 0.395 +- 0.011
nec class all_L1  =  0.371 +- 0.104, 0.331 +- 0.113, 0.262 +- 0.086, 0.296 +- 0.098
nec class all_KL  =  0.350 +- 0.125, 0.339 +- 0.136, 0.286 +- 0.093, 0.338 +- 0.105
nec_acc_int  =  0.361 +- 0.015, 0.374 +- 0.008, 0.359 +- 0.012, 0.363 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.507 +- 0.010, 0.554 +- 0.035, 0.638 +- 0.046, 0.745 +- 0.004
Faith. Armon (L1)= 		  =  0.350 +- 0.068, 0.518 +- 0.021, 0.608 +- 0.030, 0.657 +- 0.007
Faith. GMean (L1)= 	  =  0.419 +- 0.043, 0.536 +- 0.026, 0.623 +- 0.038, 0.700 +- 0.006
Faith. Aritm (KL)= 		  =  0.506 +- 0.011, 0.558 +- 0.039, 0.663 +- 0.055, 0.771 +- 0.015
Faith. Armon (KL)= 		  =  0.246 +- 0.112, 0.511 +- 0.033, 0.635 +- 0.041, 0.702 +- 0.026
Faith. GMean (KL)= 	  =  0.346 +- 0.076, 0.534 +- 0.033, 0.649 +- 0.048, 0.736 +- 0.021

Eval split val
Faith. Aritm (L1)= 		  =  0.546 +- 0.024, 0.552 +- 0.041, 0.593 +- 0.010, 0.731 +- 0.033
Faith. Armon (L1)= 		  =  0.433 +- 0.067, 0.506 +- 0.069, 0.566 +- 0.021, 0.629 +- 0.061
Faith. GMean (L1)= 	  =  0.485 +- 0.044, 0.528 +- 0.055, 0.579 +- 0.012, 0.678 +- 0.048
Faith. Aritm (KL)= 		  =  0.545 +- 0.029, 0.564 +- 0.053, 0.613 +- 0.013, 0.739 +- 0.045
Faith. Armon (KL)= 		  =  0.403 +- 0.096, 0.507 +- 0.091, 0.577 +- 0.035, 0.642 +- 0.080
Faith. GMean (KL)= 	  =  0.466 +- 0.063, 0.534 +- 0.073, 0.594 +- 0.024, 0.688 +- 0.064

Eval split test
Faith. Aritm (L1)= 		  =  0.519 +- 0.026, 0.502 +- 0.028, 0.535 +- 0.035, 0.648 +- 0.049
Faith. Armon (L1)= 		  =  0.456 +- 0.080, 0.424 +- 0.065, 0.386 +- 0.087, 0.448 +- 0.122
Faith. GMean (L1)= 	  =  0.485 +- 0.050, 0.461 +- 0.045, 0.453 +- 0.063, 0.536 +- 0.097
Faith. Aritm (KL)= 		  =  0.507 +- 0.046, 0.492 +- 0.037, 0.535 +- 0.052, 0.669 +- 0.053
Faith. Armon (KL)= 		  =  0.425 +- 0.096, 0.415 +- 0.069, 0.405 +- 0.089, 0.496 +- 0.122
Faith. GMean (KL)= 	  =  0.461 +- 0.064, 0.450 +- 0.048, 0.463 +- 0.066, 0.574 +- 0.096
Computed for split load_split = id



Completed in  0:58:36.490758  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 14:14:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 02:14:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:00 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:15:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3556) +- tensor(0.1819)
F1 for r=0.3 = 0.499
WIoU for r=0.3 = 0.377
F1 for r=0.6 = 0.576
WIoU for r=0.6 = 0.460
F1 for r=0.9 = 0.529
WIoU for r=0.9 = 0.428
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.410
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1401) +- tensor(0.0669)
F1 for r=0.3 = 0.324
WIoU for r=0.3 = 0.263
F1 for r=0.6 = 0.292
WIoU for r=0.6 = 0.227
F1 for r=0.9 = 0.256
WIoU for r=0.9 = 0.197
F1 for r=1.0 = 0.240
WIoU for r=1.0 = 0.186
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0604) +- tensor(0.0247)
F1 for r=0.3 = 0.193
WIoU for r=0.3 = 0.134
F1 for r=0.6 = 0.144
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.120
WIoU for r=0.9 = 0.078
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.074


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.354
Model XAI F1 of binarized graphs for r=0.3 =  0.4987608
Model XAI WIoU of binarized graphs for r=0.3 =  0.3768972
len(reference) = 2374
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF++ for r=0.3 class 0 = 0.772 +- 0.129 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 1 = 0.797 +- 0.129 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 2 = 0.776 +- 0.129 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all KL = 0.899 +- 0.129 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all L1 = 0.781 +- 0.136 (in-sample avg dev_std = 0.259)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.53
Model XAI F1 of binarized graphs for r=0.6 =  0.5755511999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.45973400000000003
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.5
SUFF++ for r=0.6 class 0 = 0.723 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 1 = 0.854 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 2 = 0.731 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all KL = 0.807 +- 0.241 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all L1 = 0.768 +- 0.207 (in-sample avg dev_std = 0.386)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.5286544
Model XAI WIoU of binarized graphs for r=0.9 =  0.42779120000000004
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0 = 0.756 +- 0.204 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 1 = 0.861 +- 0.204 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 2 = 0.827 +- 0.204 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all KL = 0.868 +- 0.204 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all L1 = 0.814 +- 0.217 (in-sample avg dev_std = 0.262)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.459
Model XAI F1 of binarized graphs for r=0.3 =  0.32374200000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.262756
len(reference) = 2489
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.439
SUFF++ for r=0.3 class 0 = 0.87 +- 0.107 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 class 1 = 0.905 +- 0.107 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 class 2 = 0.867 +- 0.107 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 all KL = 0.941 +- 0.107 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 all L1 = 0.881 +- 0.093 (in-sample avg dev_std = 0.222)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.499
Model XAI F1 of binarized graphs for r=0.6 =  0.2920308
Model XAI WIoU of binarized graphs for r=0.6 =  0.2267216
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.488
SUFF++ for r=0.6 class 0 = 0.721 +- 0.250 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 1 = 0.801 +- 0.250 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 2 = 0.715 +- 0.250 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all KL = 0.77 +- 0.250 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all L1 = 0.746 +- 0.214 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  0.2562852
Model XAI WIoU of binarized graphs for r=0.9 =  0.1970924
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.618
SUFF++ for r=0.9 class 0 = 0.675 +- 0.223 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 1 = 0.803 +- 0.223 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 2 = 0.752 +- 0.223 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all KL = 0.797 +- 0.223 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all L1 = 0.743 +- 0.207 (in-sample avg dev_std = 0.347)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.193424
Model XAI WIoU of binarized graphs for r=0.3 =  0.1341476
len(reference) = 2492
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.408
SUFF++ for r=0.3 class 0 = 0.816 +- 0.210 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 class 1 = 0.88 +- 0.210 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 class 2 = 0.824 +- 0.210 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 all KL = 0.896 +- 0.210 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 all L1 = 0.841 +- 0.183 (in-sample avg dev_std = 0.224)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.374
Model XAI F1 of binarized graphs for r=0.6 =  0.1443744
Model XAI WIoU of binarized graphs for r=0.6 =  0.0958048
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF++ for r=0.6 class 0 = 0.597 +- 0.415 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 1 = 0.605 +- 0.415 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 2 = 0.618 +- 0.415 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all KL = 0.525 +- 0.415 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all L1 = 0.606 +- 0.298 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.361
Model XAI F1 of binarized graphs for r=0.9 =  0.1203056
Model XAI WIoU of binarized graphs for r=0.9 =  0.078252
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.376
SUFF++ for r=0.9 class 0 = 0.719 +- 0.430 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.430 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 class 2 = 0.76 +- 0.430 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 all KL = 0.575 +- 0.430 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.9 all L1 = 0.734 +- 0.271 (in-sample avg dev_std = 0.468)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.355
Model XAI F1 of binarized graphs for r=0.3 =  0.4987608
Model XAI WIoU of binarized graphs for r=0.3 =  0.3768972
len(reference) = 2500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.25 +- 0.174 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.216 +- 0.174 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.241 +- 0.174 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.116 +- 0.174 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.236 +- 0.175 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.53
Model XAI F1 of binarized graphs for r=0.6 =  0.5755511999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.45973400000000003
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.416
NEC for r=0.6 class 0 = 0.406 +- 0.289 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1 = 0.235 +- 0.289 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 2 = 0.443 +- 0.289 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.334 +- 0.289 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.363 +- 0.240 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.5286544
Model XAI WIoU of binarized graphs for r=0.9 =  0.42779120000000004
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.603 +- 0.283 (in-sample avg dev_std = 0.545)
NEC for r=0.9 class 1 = 0.336 +- 0.283 (in-sample avg dev_std = 0.545)
NEC for r=0.9 class 2 = 0.594 +- 0.283 (in-sample avg dev_std = 0.545)
NEC for r=0.9 all KL = 0.513 +- 0.283 (in-sample avg dev_std = 0.545)
NEC for r=0.9 all L1 = 0.514 +- 0.213 (in-sample avg dev_std = 0.545)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.892
Model XAI F1 of binarized graphs for r=1.0 =  0.499784
Model XAI WIoU of binarized graphs for r=1.0 =  0.41014480000000003
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0 = 0.55 +- 0.302 (in-sample avg dev_std = 0.557)
NEC for r=1.0 class 1 = 0.322 +- 0.302 (in-sample avg dev_std = 0.557)
NEC for r=1.0 class 2 = 0.559 +- 0.302 (in-sample avg dev_std = 0.557)
NEC for r=1.0 all KL = 0.487 +- 0.302 (in-sample avg dev_std = 0.557)
NEC for r=1.0 all L1 = 0.479 +- 0.222 (in-sample avg dev_std = 0.557)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.458
Model XAI F1 of binarized graphs for r=0.3 =  0.32374200000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.262756
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.222 +- 0.281 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1 = 0.142 +- 0.281 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 2 = 0.229 +- 0.281 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.143 +- 0.281 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.198 +- 0.241 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.498
Model XAI F1 of binarized graphs for r=0.6 =  0.2920308
Model XAI WIoU of binarized graphs for r=0.6 =  0.2267216
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.321 +- 0.261 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.134 +- 0.261 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.333 +- 0.261 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.216 +- 0.261 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.262 +- 0.243 (in-sample avg dev_std = 0.309)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  0.2562852
Model XAI WIoU of binarized graphs for r=0.9 =  0.1970924
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.442
NEC for r=0.9 class 0 = 0.513 +- 0.302 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 1 = 0.221 +- 0.302 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 2 = 0.521 +- 0.302 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all KL = 0.388 +- 0.302 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all L1 = 0.417 +- 0.263 (in-sample avg dev_std = 0.407)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.73
Model XAI F1 of binarized graphs for r=1.0 =  0.23994400000000002
Model XAI WIoU of binarized graphs for r=1.0 =  0.1858096
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.481
NEC for r=1.0 class 0 = 0.467 +- 0.324 (in-sample avg dev_std = 0.437)
NEC for r=1.0 class 1 = 0.173 +- 0.324 (in-sample avg dev_std = 0.437)
NEC for r=1.0 class 2 = 0.462 +- 0.324 (in-sample avg dev_std = 0.437)
NEC for r=1.0 all KL = 0.357 +- 0.324 (in-sample avg dev_std = 0.437)
NEC for r=1.0 all L1 = 0.366 +- 0.276 (in-sample avg dev_std = 0.437)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.193424
Model XAI WIoU of binarized graphs for r=0.3 =  0.1341476
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.22 +- 0.259 (in-sample avg dev_std = 0.254)
NEC for r=0.3 class 1 = 0.16 +- 0.259 (in-sample avg dev_std = 0.254)
NEC for r=0.3 class 2 = 0.184 +- 0.259 (in-sample avg dev_std = 0.254)
NEC for r=0.3 all KL = 0.143 +- 0.259 (in-sample avg dev_std = 0.254)
NEC for r=0.3 all L1 = 0.188 +- 0.213 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.374
Model XAI F1 of binarized graphs for r=0.6 =  0.1443744
Model XAI WIoU of binarized graphs for r=0.6 =  0.0958048
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.349 +- 0.421 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 1 = 0.317 +- 0.421 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 2 = 0.355 +- 0.421 (in-sample avg dev_std = 0.267)
NEC for r=0.6 all KL = 0.371 +- 0.421 (in-sample avg dev_std = 0.267)
NEC for r=0.6 all L1 = 0.34 +- 0.327 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.361
Model XAI F1 of binarized graphs for r=0.9 =  0.1203056
Model XAI WIoU of binarized graphs for r=0.9 =  0.078252
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.356
NEC for r=0.9 class 0 = 0.249 +- 0.418 (in-sample avg dev_std = 0.363)
NEC for r=0.9 class 1 = 0.256 +- 0.418 (in-sample avg dev_std = 0.363)
NEC for r=0.9 class 2 = 0.247 +- 0.418 (in-sample avg dev_std = 0.363)
NEC for r=0.9 all KL = 0.361 +- 0.418 (in-sample avg dev_std = 0.363)
NEC for r=0.9 all L1 = 0.251 +- 0.291 (in-sample avg dev_std = 0.363)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.334
Model XAI F1 of binarized graphs for r=1.0 =  0.1129528
Model XAI WIoU of binarized graphs for r=1.0 =  0.0739472
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.365
NEC for r=1.0 class 0 = 0.249 +- 0.418 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 1 = 0.269 +- 0.418 (in-sample avg dev_std = 0.302)
NEC for r=1.0 class 2 = 0.266 +- 0.418 (in-sample avg dev_std = 0.302)
NEC for r=1.0 all KL = 0.405 +- 0.418 (in-sample avg dev_std = 0.302)
NEC for r=1.0 all L1 = 0.261 +- 0.271 (in-sample avg dev_std = 0.302)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 14:34:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:34:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3556) +- tensor(0.1819)
F1 for r=0.3 = 0.487
WIoU for r=0.3 = 0.367
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.525
WIoU for r=0.9 = 0.434
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.420
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1401) +- tensor(0.0669)
F1 for r=0.3 = 0.386
WIoU for r=0.3 = 0.345
F1 for r=0.6 = 0.316
WIoU for r=0.6 = 0.335
F1 for r=0.9 = 0.258
WIoU for r=0.9 = 0.326
F1 for r=1.0 = 0.240
WIoU for r=1.0 = 0.321
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0604) +- tensor(0.0247)
F1 for r=0.3 = 0.247
WIoU for r=0.3 = 0.295
F1 for r=0.6 = 0.157
WIoU for r=0.6 = 0.281
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.281
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.280


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.362
Model XAI F1 of binarized graphs for r=0.3 =  0.48671720000000007
Model XAI WIoU of binarized graphs for r=0.3 =  0.36719040000000003
len(reference) = 2361
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.342
SUFF++ for r=0.3 class 0 = 0.792 +- 0.141 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.3 class 1 = 0.821 +- 0.141 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.3 class 2 = 0.798 +- 0.141 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.3 all KL = 0.912 +- 0.141 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.3 all L1 = 0.803 +- 0.128 (in-sample avg dev_std = 0.244)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.566
Model XAI F1 of binarized graphs for r=0.6 =  0.5672412
Model XAI WIoU of binarized graphs for r=0.6 =  0.45277199999999995
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.513
SUFF++ for r=0.6 class 0 = 0.654 +- 0.249 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 1 = 0.802 +- 0.249 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 class 2 = 0.709 +- 0.249 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all KL = 0.75 +- 0.249 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.6 all L1 = 0.72 +- 0.197 (in-sample avg dev_std = 0.461)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  0.5252096
Model XAI WIoU of binarized graphs for r=0.9 =  0.4344119999999999
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.768
SUFF++ for r=0.9 class 0 = 0.805 +- 0.216 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 1 = 0.881 +- 0.216 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 2 = 0.824 +- 0.216 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all KL = 0.863 +- 0.216 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all L1 = 0.836 +- 0.203 (in-sample avg dev_std = 0.296)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.544
Model XAI F1 of binarized graphs for r=0.3 =  0.3862236
Model XAI WIoU of binarized graphs for r=0.3 =  0.34482240000000003
len(reference) = 2493
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF++ for r=0.3 class 0 = 0.764 +- 0.210 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 1 = 0.843 +- 0.210 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 2 = 0.794 +- 0.210 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all KL = 0.848 +- 0.210 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all L1 = 0.8 +- 0.179 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.595
Model XAI F1 of binarized graphs for r=0.6 =  0.3155712
Model XAI WIoU of binarized graphs for r=0.6 =  0.33480959999999993
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.593
SUFF++ for r=0.6 class 0 = 0.728 +- 0.245 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.245 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 class 2 = 0.74 +- 0.245 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 all KL = 0.743 +- 0.245 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 all L1 = 0.725 +- 0.199 (in-sample avg dev_std = 0.431)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.648
Model XAI F1 of binarized graphs for r=0.9 =  0.25772480000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.326262
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.674
SUFF++ for r=0.9 class 0 = 0.698 +- 0.243 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.9 class 1 = 0.723 +- 0.243 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.9 class 2 = 0.682 +- 0.243 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.9 all KL = 0.765 +- 0.243 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.9 all L1 = 0.701 +- 0.231 (in-sample avg dev_std = 0.350)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.551
Model XAI F1 of binarized graphs for r=0.3 =  0.2471948
Model XAI WIoU of binarized graphs for r=0.3 =  0.29529720000000004
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.577
SUFF++ for r=0.3 class 0 = 0.606 +- 0.321 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 class 1 = 0.56 +- 0.321 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 class 2 = 0.571 +- 0.321 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 all KL = 0.539 +- 0.321 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 all L1 = 0.579 +- 0.192 (in-sample avg dev_std = 0.548)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.408
Model XAI F1 of binarized graphs for r=0.6 =  0.1574544
Model XAI WIoU of binarized graphs for r=0.6 =  0.2805424
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.483
SUFF++ for r=0.6 class 0 = 0.773 +- 0.358 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.625 +- 0.358 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.711 +- 0.358 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.659 +- 0.358 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.703 +- 0.282 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.399
Model XAI F1 of binarized graphs for r=0.9 =  0.1219144
Model XAI WIoU of binarized graphs for r=0.9 =  0.2812204
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.393
SUFF++ for r=0.9 class 0 = 0.858 +- 0.267 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.267 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.267 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all KL = 0.826 +- 0.267 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.231 (in-sample avg dev_std = 0.275)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.363
Model XAI F1 of binarized graphs for r=0.3 =  0.48671720000000007
Model XAI WIoU of binarized graphs for r=0.3 =  0.36719040000000003
len(reference) = 2500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.214 +- 0.177 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 1 = 0.186 +- 0.177 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 2 = 0.21 +- 0.177 (in-sample avg dev_std = 0.186)
NEC for r=0.3 all KL = 0.096 +- 0.177 (in-sample avg dev_std = 0.186)
NEC for r=0.3 all L1 = 0.203 +- 0.166 (in-sample avg dev_std = 0.186)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.566
Model XAI F1 of binarized graphs for r=0.6 =  0.5672412
Model XAI WIoU of binarized graphs for r=0.6 =  0.45277199999999995
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.413
NEC for r=0.6 class 0 = 0.467 +- 0.309 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.294 +- 0.309 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.477 +- 0.309 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.383 +- 0.309 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.414 +- 0.230 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  0.5252096
Model XAI WIoU of binarized graphs for r=0.9 =  0.4344119999999999
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.49
NEC for r=0.9 class 0 = 0.571 +- 0.282 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 1 = 0.352 +- 0.282 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 2 = 0.583 +- 0.282 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all KL = 0.541 +- 0.282 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all L1 = 0.504 +- 0.204 (in-sample avg dev_std = 0.602)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.499784
Model XAI WIoU of binarized graphs for r=1.0 =  0.4201944
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.529
NEC for r=1.0 class 0 = 0.57 +- 0.300 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 1 = 0.355 +- 0.300 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 2 = 0.568 +- 0.300 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all KL = 0.541 +- 0.300 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all L1 = 0.5 +- 0.215 (in-sample avg dev_std = 0.609)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.543
Model XAI F1 of binarized graphs for r=0.3 =  0.3862236
Model XAI WIoU of binarized graphs for r=0.3 =  0.34482240000000003
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.347
NEC for r=0.3 class 0 = 0.378 +- 0.346 (in-sample avg dev_std = 0.269)
NEC for r=0.3 class 1 = 0.275 +- 0.346 (in-sample avg dev_std = 0.269)
NEC for r=0.3 class 2 = 0.387 +- 0.346 (in-sample avg dev_std = 0.269)
NEC for r=0.3 all KL = 0.295 +- 0.346 (in-sample avg dev_std = 0.269)
NEC for r=0.3 all L1 = 0.346 +- 0.274 (in-sample avg dev_std = 0.269)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.595
Model XAI F1 of binarized graphs for r=0.6 =  0.3155712
Model XAI WIoU of binarized graphs for r=0.6 =  0.33480959999999993
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.443
NEC for r=0.6 class 0 = 0.492 +- 0.306 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 1 = 0.34 +- 0.306 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 2 = 0.532 +- 0.306 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all KL = 0.477 +- 0.306 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all L1 = 0.454 +- 0.217 (in-sample avg dev_std = 0.519)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.649
Model XAI F1 of binarized graphs for r=0.9 =  0.25772480000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.326262
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.494
NEC for r=0.9 class 0 = 0.525 +- 0.256 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 1 = 0.409 +- 0.256 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 2 = 0.571 +- 0.256 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all KL = 0.497 +- 0.256 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all L1 = 0.501 +- 0.175 (in-sample avg dev_std = 0.525)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.679
Model XAI F1 of binarized graphs for r=1.0 =  0.23994400000000002
Model XAI WIoU of binarized graphs for r=1.0 =  0.32094079999999997
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.507
NEC for r=1.0 class 0 = 0.438 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 1 = 0.353 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=1.0 class 2 = 0.488 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all KL = 0.439 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=1.0 all L1 = 0.426 +- 0.218 (in-sample avg dev_std = 0.492)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  0.2471948
Model XAI WIoU of binarized graphs for r=0.3 =  0.29529720000000004
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.391 +- 0.327 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 1 = 0.405 +- 0.327 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 2 = 0.472 +- 0.327 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all KL = 0.398 +- 0.327 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all L1 = 0.422 +- 0.270 (in-sample avg dev_std = 0.337)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.408
Model XAI F1 of binarized graphs for r=0.6 =  0.1574544
Model XAI WIoU of binarized graphs for r=0.6 =  0.2805424
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.2 +- 0.289 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 1 = 0.225 +- 0.289 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 2 = 0.274 +- 0.289 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all KL = 0.243 +- 0.289 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all L1 = 0.232 +- 0.268 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.399
Model XAI F1 of binarized graphs for r=0.9 =  0.1219144
Model XAI WIoU of binarized graphs for r=0.9 =  0.2812204
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.356
NEC for r=0.9 class 0 = 0.171 +- 0.325 (in-sample avg dev_std = 0.265)
NEC for r=0.9 class 1 = 0.158 +- 0.325 (in-sample avg dev_std = 0.265)
NEC for r=0.9 class 2 = 0.139 +- 0.325 (in-sample avg dev_std = 0.265)
NEC for r=0.9 all KL = 0.188 +- 0.325 (in-sample avg dev_std = 0.265)
NEC for r=0.9 all L1 = 0.157 +- 0.263 (in-sample avg dev_std = 0.265)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.37
Model XAI F1 of binarized graphs for r=1.0 =  0.1129528
Model XAI WIoU of binarized graphs for r=1.0 =  0.28034960000000003
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.351
NEC for r=1.0 class 0 = 0.145 +- 0.304 (in-sample avg dev_std = 0.266)
NEC for r=1.0 class 1 = 0.139 +- 0.304 (in-sample avg dev_std = 0.266)
NEC for r=1.0 class 2 = 0.111 +- 0.304 (in-sample avg dev_std = 0.266)
NEC for r=1.0 all KL = 0.168 +- 0.304 (in-sample avg dev_std = 0.266)
NEC for r=1.0 all L1 = 0.132 +- 0.233 (in-sample avg dev_std = 0.266)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 14:53:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:11 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:23 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 02:53:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3556) +- tensor(0.1819)
F1 for r=0.3 = 0.593
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.618
WIoU for r=0.6 = 0.587
F1 for r=0.9 = 0.523
WIoU for r=0.9 = 0.590
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.590
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1401) +- tensor(0.0669)
F1 for r=0.3 = 0.484
WIoU for r=0.3 = 0.464
F1 for r=0.6 = 0.347
WIoU for r=0.6 = 0.438
F1 for r=0.9 = 0.258
WIoU for r=0.9 = 0.433
F1 for r=1.0 = 0.240
WIoU for r=1.0 = 0.432
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0604) +- tensor(0.0247)
F1 for r=0.3 = 0.276
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.172
WIoU for r=0.6 = 0.165
F1 for r=0.9 = 0.123
WIoU for r=0.9 = 0.146
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.143


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.385
Model XAI F1 of binarized graphs for r=0.3 =  0.5933276
Model XAI WIoU of binarized graphs for r=0.3 =  0.4819768
len(reference) = 2426
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.357
SUFF++ for r=0.3 class 0 = 0.841 +- 0.218 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 class 1 = 0.927 +- 0.218 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 class 2 = 0.83 +- 0.218 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 all KL = 0.889 +- 0.218 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 all L1 = 0.865 +- 0.187 (in-sample avg dev_std = 0.298)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.672
Model XAI F1 of binarized graphs for r=0.6 =  0.6182827999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.5873772
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.631
SUFF++ for r=0.6 class 0 = 0.742 +- 0.234 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.86 +- 0.234 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.739 +- 0.234 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.79 +- 0.234 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.779 +- 0.203 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.5226356
Model XAI WIoU of binarized graphs for r=0.9 =  0.5899008
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.786
SUFF++ for r=0.9 class 0 = 0.84 +- 0.194 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 1 = 0.9 +- 0.194 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 class 2 = 0.903 +- 0.194 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all KL = 0.899 +- 0.194 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.9 all L1 = 0.88 +- 0.186 (in-sample avg dev_std = 0.277)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  0.4838616
Model XAI WIoU of binarized graphs for r=0.3 =  0.46401640000000005
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.574
SUFF++ for r=0.3 class 0 = 0.77 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 1 = 0.887 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 2 = 0.797 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all KL = 0.82 +- 0.244 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all L1 = 0.818 +- 0.203 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.712
Model XAI F1 of binarized graphs for r=0.6 =  0.34654120000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.4377776
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0 = 0.74 +- 0.193 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 1 = 0.765 +- 0.193 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 2 = 0.754 +- 0.193 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all KL = 0.818 +- 0.193 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all L1 = 0.753 +- 0.188 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.25822480000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.4332312
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.69
SUFF++ for r=0.9 class 0 = 0.768 +- 0.283 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.283 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 class 2 = 0.807 +- 0.283 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 all KL = 0.802 +- 0.283 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.227 (in-sample avg dev_std = 0.390)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  0.27569799999999994
Model XAI WIoU of binarized graphs for r=0.3 =  0.21469399999999997
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.625
SUFF++ for r=0.3 class 0 = 0.694 +- 0.190 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 class 1 = 0.8 +- 0.190 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 class 2 = 0.7 +- 0.190 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all KL = 0.806 +- 0.190 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all L1 = 0.732 +- 0.157 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.49
Model XAI F1 of binarized graphs for r=0.6 =  0.1723288
Model XAI WIoU of binarized graphs for r=0.6 =  0.16459400000000002
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.555
SUFF++ for r=0.6 class 0 = 0.68 +- 0.242 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 1 = 0.793 +- 0.242 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 2 = 0.769 +- 0.242 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all KL = 0.732 +- 0.242 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all L1 = 0.747 +- 0.206 (in-sample avg dev_std = 0.346)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.382
Model XAI F1 of binarized graphs for r=0.9 =  0.12306480000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.1464064
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.413
SUFF++ for r=0.9 class 0 = 0.81 +- 0.218 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 class 1 = 0.82 +- 0.218 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.218 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 all KL = 0.833 +- 0.218 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 all L1 = 0.828 +- 0.177 (in-sample avg dev_std = 0.355)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.386
Model XAI F1 of binarized graphs for r=0.3 =  0.5933276
Model XAI WIoU of binarized graphs for r=0.3 =  0.4819768
len(reference) = 2500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.176 +- 0.254 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 1 = 0.108 +- 0.254 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 2 = 0.187 +- 0.254 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all KL = 0.115 +- 0.254 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all L1 = 0.158 +- 0.229 (in-sample avg dev_std = 0.171)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.672
Model XAI F1 of binarized graphs for r=0.6 =  0.6182827999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.5873772
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.402
NEC for r=0.6 class 0 = 0.523 +- 0.368 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 1 = 0.231 +- 0.368 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 2 = 0.538 +- 0.368 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all KL = 0.444 +- 0.368 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all L1 = 0.433 +- 0.288 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.5226356
Model XAI WIoU of binarized graphs for r=0.9 =  0.5899008
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.502
NEC for r=0.9 class 0 = 0.612 +- 0.331 (in-sample avg dev_std = 0.607)
NEC for r=0.9 class 1 = 0.262 +- 0.331 (in-sample avg dev_std = 0.607)
NEC for r=0.9 class 2 = 0.594 +- 0.331 (in-sample avg dev_std = 0.607)
NEC for r=0.9 all KL = 0.547 +- 0.331 (in-sample avg dev_std = 0.607)
NEC for r=0.9 all L1 = 0.492 +- 0.261 (in-sample avg dev_std = 0.607)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  0.499784
Model XAI WIoU of binarized graphs for r=1.0 =  0.589664
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.606 +- 0.332 (in-sample avg dev_std = 0.651)
NEC for r=1.0 class 1 = 0.226 +- 0.332 (in-sample avg dev_std = 0.651)
NEC for r=1.0 class 2 = 0.603 +- 0.332 (in-sample avg dev_std = 0.651)
NEC for r=1.0 all KL = 0.561 +- 0.332 (in-sample avg dev_std = 0.651)
NEC for r=1.0 all L1 = 0.482 +- 0.262 (in-sample avg dev_std = 0.651)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  0.4838616
Model XAI WIoU of binarized graphs for r=0.3 =  0.46401640000000005
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.428 +- 0.428 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 1 = 0.098 +- 0.428 (in-sample avg dev_std = 0.182)
NEC for r=0.3 class 2 = 0.446 +- 0.428 (in-sample avg dev_std = 0.182)
NEC for r=0.3 all KL = 0.334 +- 0.428 (in-sample avg dev_std = 0.182)
NEC for r=0.3 all L1 = 0.323 +- 0.366 (in-sample avg dev_std = 0.182)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.34654120000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.4377776
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.434
NEC for r=0.6 class 0 = 0.601 +- 0.349 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.211 +- 0.349 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.6 +- 0.349 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.45 +- 0.349 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.469 +- 0.279 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  0.25822480000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.4332312
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.482
NEC for r=0.9 class 0 = 0.544 +- 0.316 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 1 = 0.189 +- 0.316 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 2 = 0.532 +- 0.316 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all KL = 0.43 +- 0.316 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all L1 = 0.421 +- 0.275 (in-sample avg dev_std = 0.507)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.871
Model XAI F1 of binarized graphs for r=1.0 =  0.23994400000000002
Model XAI WIoU of binarized graphs for r=1.0 =  0.4324
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.516
NEC for r=1.0 class 0 = 0.655 +- 0.326 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 1 = 0.193 +- 0.326 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 2 = 0.598 +- 0.326 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all KL = 0.494 +- 0.326 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all L1 = 0.481 +- 0.270 (in-sample avg dev_std = 0.525)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  0.27569799999999994
Model XAI WIoU of binarized graphs for r=0.3 =  0.21469399999999997
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.516 +- 0.416 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 1 = 0.155 +- 0.416 (in-sample avg dev_std = 0.179)
NEC for r=0.3 class 2 = 0.505 +- 0.416 (in-sample avg dev_std = 0.179)
NEC for r=0.3 all KL = 0.361 +- 0.416 (in-sample avg dev_std = 0.179)
NEC for r=0.3 all L1 = 0.389 +- 0.341 (in-sample avg dev_std = 0.179)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.49
Model XAI F1 of binarized graphs for r=0.6 =  0.1723288
Model XAI WIoU of binarized graphs for r=0.6 =  0.16459400000000002
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.296 +- 0.273 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 1 = 0.159 +- 0.273 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 2 = 0.359 +- 0.273 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all KL = 0.268 +- 0.273 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all L1 = 0.269 +- 0.234 (in-sample avg dev_std = 0.311)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.381
Model XAI F1 of binarized graphs for r=0.9 =  0.12306480000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.1464064
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.372
NEC for r=0.9 class 0 = 0.248 +- 0.227 (in-sample avg dev_std = 0.266)
NEC for r=0.9 class 1 = 0.198 +- 0.227 (in-sample avg dev_std = 0.266)
NEC for r=0.9 class 2 = 0.29 +- 0.227 (in-sample avg dev_std = 0.266)
NEC for r=0.9 all KL = 0.198 +- 0.227 (in-sample avg dev_std = 0.266)
NEC for r=0.9 all L1 = 0.244 +- 0.204 (in-sample avg dev_std = 0.266)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.423
Model XAI F1 of binarized graphs for r=1.0 =  0.1129528
Model XAI WIoU of binarized graphs for r=1.0 =  0.14258800000000002
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.35
NEC for r=1.0 class 0 = 0.338 +- 0.251 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 1 = 0.322 +- 0.251 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 2 = 0.328 +- 0.251 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all KL = 0.314 +- 0.251 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all L1 = 0.329 +- 0.209 (in-sample avg dev_std = 0.292)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 15:12:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:27 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:12:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3556) +- tensor(0.1819)
F1 for r=0.3 = 0.413
WIoU for r=0.3 = 0.355
F1 for r=0.6 = 0.424
WIoU for r=0.6 = 0.368
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.407
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.410
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1401) +- tensor(0.0669)
F1 for r=0.3 = 0.312
WIoU for r=0.3 = 0.314
F1 for r=0.6 = 0.262
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.222
WIoU for r=0.9 = 0.321
F1 for r=1.0 = 0.240
WIoU for r=1.0 = 0.324
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0604) +- tensor(0.0247)
F1 for r=0.3 = 0.170
WIoU for r=0.3 = 0.256
F1 for r=0.6 = 0.136
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.103
WIoU for r=0.9 = 0.263
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.268


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.468
Model XAI F1 of binarized graphs for r=0.3 =  0.4132816000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.35456079999999995
len(reference) = 2482
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF++ for r=0.3 class 0 = 0.626 +- 0.307 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 1 = 0.775 +- 0.307 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 2 = 0.719 +- 0.307 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all KL = 0.705 +- 0.307 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all L1 = 0.706 +- 0.271 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.612
Model XAI F1 of binarized graphs for r=0.6 =  0.424426
Model XAI WIoU of binarized graphs for r=0.6 =  0.36799360000000003
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.476
SUFF++ for r=0.6 class 0 = 0.41 +- 0.276 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 1 = 0.611 +- 0.276 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 2 = 0.551 +- 0.276 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all KL = 0.53 +- 0.276 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all L1 = 0.523 +- 0.228 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.893
Model XAI F1 of binarized graphs for r=0.9 =  0.46707160000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.4070124
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0 = 0.636 +- 0.301 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 class 1 = 0.745 +- 0.301 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 class 2 = 0.71 +- 0.301 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 all KL = 0.683 +- 0.301 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 all L1 = 0.696 +- 0.251 (in-sample avg dev_std = 0.509)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.511
Model XAI F1 of binarized graphs for r=0.3 =  0.31225319999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.3135004
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.462
SUFF++ for r=0.3 class 0 = 0.579 +- 0.312 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 1 = 0.716 +- 0.312 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 2 = 0.662 +- 0.312 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all KL = 0.622 +- 0.312 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all L1 = 0.652 +- 0.263 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.576
Model XAI F1 of binarized graphs for r=0.6 =  0.2622276
Model XAI WIoU of binarized graphs for r=0.6 =  0.3161796
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.482
SUFF++ for r=0.6 class 0 = 0.505 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 1 = 0.678 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 class 2 = 0.574 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all KL = 0.63 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.6 all L1 = 0.586 +- 0.223 (in-sample avg dev_std = 0.472)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.221536
Model XAI WIoU of binarized graphs for r=0.9 =  0.32107399999999997
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.614
SUFF++ for r=0.9 class 0 = 0.548 +- 0.306 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 class 1 = 0.621 +- 0.306 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 class 2 = 0.688 +- 0.306 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 all KL = 0.627 +- 0.306 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.9 all L1 = 0.618 +- 0.265 (in-sample avg dev_std = 0.453)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.17006079999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.2557196
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.451
SUFF++ for r=0.3 class 0 = 0.522 +- 0.321 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 class 1 = 0.569 +- 0.321 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 class 2 = 0.574 +- 0.321 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 all KL = 0.474 +- 0.321 (in-sample avg dev_std = 0.601)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.243 (in-sample avg dev_std = 0.601)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.4
Model XAI F1 of binarized graphs for r=0.6 =  0.13578800000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.26192839999999995
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.434
SUFF++ for r=0.6 class 0 = 0.507 +- 0.282 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 1 = 0.559 +- 0.282 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 2 = 0.562 +- 0.282 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 all KL = 0.502 +- 0.282 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 all L1 = 0.542 +- 0.202 (in-sample avg dev_std = 0.532)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.413
Model XAI F1 of binarized graphs for r=0.9 =  0.102906
Model XAI WIoU of binarized graphs for r=0.9 =  0.26323159999999995
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.41
SUFF++ for r=0.9 class 0 = 0.711 +- 0.216 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 1 = 0.767 +- 0.216 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 2 = 0.747 +- 0.216 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all KL = 0.786 +- 0.216 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all L1 = 0.741 +- 0.205 (in-sample avg dev_std = 0.341)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.467
Model XAI F1 of binarized graphs for r=0.3 =  0.4132816000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.35456079999999995
len(reference) = 2500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.347
NEC for r=0.3 class 0 = 0.431 +- 0.361 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 1 = 0.216 +- 0.361 (in-sample avg dev_std = 0.381)
NEC for r=0.3 class 2 = 0.4 +- 0.361 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all KL = 0.356 +- 0.361 (in-sample avg dev_std = 0.381)
NEC for r=0.3 all L1 = 0.351 +- 0.316 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.612
Model XAI F1 of binarized graphs for r=0.6 =  0.424426
Model XAI WIoU of binarized graphs for r=0.6 =  0.36799360000000003
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.432
NEC for r=0.6 class 0 = 0.613 +- 0.315 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 1 = 0.342 +- 0.315 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 2 = 0.568 +- 0.315 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all KL = 0.512 +- 0.315 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all L1 = 0.51 +- 0.254 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.893
Model XAI F1 of binarized graphs for r=0.9 =  0.46707160000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.4070124
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.614 +- 0.319 (in-sample avg dev_std = 0.633)
NEC for r=0.9 class 1 = 0.257 +- 0.319 (in-sample avg dev_std = 0.633)
NEC for r=0.9 class 2 = 0.6 +- 0.319 (in-sample avg dev_std = 0.633)
NEC for r=0.9 all KL = 0.557 +- 0.319 (in-sample avg dev_std = 0.633)
NEC for r=0.9 all L1 = 0.494 +- 0.256 (in-sample avg dev_std = 0.633)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.499784
Model XAI WIoU of binarized graphs for r=1.0 =  0.409674
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.585 +- 0.296 (in-sample avg dev_std = 0.678)
NEC for r=1.0 class 1 = 0.285 +- 0.296 (in-sample avg dev_std = 0.678)
NEC for r=1.0 class 2 = 0.594 +- 0.296 (in-sample avg dev_std = 0.678)
NEC for r=1.0 all KL = 0.574 +- 0.296 (in-sample avg dev_std = 0.678)
NEC for r=1.0 all L1 = 0.491 +- 0.234 (in-sample avg dev_std = 0.678)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.512
Model XAI F1 of binarized graphs for r=0.3 =  0.31225319999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.3135004
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.371
NEC for r=0.3 class 0 = 0.483 +- 0.397 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 1 = 0.277 +- 0.397 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 2 = 0.499 +- 0.397 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all KL = 0.445 +- 0.397 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all L1 = 0.419 +- 0.335 (in-sample avg dev_std = 0.365)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.578
Model XAI F1 of binarized graphs for r=0.6 =  0.2622276
Model XAI WIoU of binarized graphs for r=0.6 =  0.3161796
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.431
NEC for r=0.6 class 0 = 0.553 +- 0.378 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.332 +- 0.378 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.59 +- 0.378 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.495 +- 0.378 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.491 +- 0.277 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  0.221536
Model XAI WIoU of binarized graphs for r=0.9 =  0.32107399999999997
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.507
NEC for r=0.9 class 0 = 0.616 +- 0.284 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.434 +- 0.284 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.633 +- 0.284 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.617 +- 0.284 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.56 +- 0.222 (in-sample avg dev_std = 0.576)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.787
Model XAI F1 of binarized graphs for r=1.0 =  0.23994400000000002
Model XAI WIoU of binarized graphs for r=1.0 =  0.32369000000000003
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.516
NEC for r=1.0 class 0 = 0.602 +- 0.272 (in-sample avg dev_std = 0.604)
NEC for r=1.0 class 1 = 0.461 +- 0.272 (in-sample avg dev_std = 0.604)
NEC for r=1.0 class 2 = 0.614 +- 0.272 (in-sample avg dev_std = 0.604)
NEC for r=1.0 all KL = 0.626 +- 0.272 (in-sample avg dev_std = 0.604)
NEC for r=1.0 all L1 = 0.558 +- 0.213 (in-sample avg dev_std = 0.604)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.17006079999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.2557196
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.381
NEC for r=0.3 class 0 = 0.528 +- 0.383 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.408 +- 0.383 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.524 +- 0.383 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.518 +- 0.383 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.486 +- 0.320 (in-sample avg dev_std = 0.389)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.4
Model XAI F1 of binarized graphs for r=0.6 =  0.13578800000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.26192839999999995
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.551 +- 0.370 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 1 = 0.514 +- 0.370 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 2 = 0.55 +- 0.370 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all KL = 0.58 +- 0.370 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all L1 = 0.538 +- 0.249 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.413
Model XAI F1 of binarized graphs for r=0.9 =  0.102906
Model XAI WIoU of binarized graphs for r=0.9 =  0.26323159999999995
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.339
NEC for r=0.9 class 0 = 0.46 +- 0.341 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 1 = 0.428 +- 0.341 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 2 = 0.367 +- 0.341 (in-sample avg dev_std = 0.423)
NEC for r=0.9 all KL = 0.422 +- 0.341 (in-sample avg dev_std = 0.423)
NEC for r=0.9 all L1 = 0.419 +- 0.236 (in-sample avg dev_std = 0.423)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.515
Model XAI F1 of binarized graphs for r=1.0 =  0.1129528
Model XAI WIoU of binarized graphs for r=1.0 =  0.2676232
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.356
NEC for r=1.0 class 0 = 0.483 +- 0.345 (in-sample avg dev_std = 0.423)
NEC for r=1.0 class 1 = 0.469 +- 0.345 (in-sample avg dev_std = 0.423)
NEC for r=1.0 class 2 = 0.342 +- 0.345 (in-sample avg dev_std = 0.423)
NEC for r=1.0 all KL = 0.473 +- 0.345 (in-sample avg dev_std = 0.423)
NEC for r=1.0 all L1 = 0.433 +- 0.252 (in-sample avg dev_std = 0.423)

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Apr 15 15:31:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/15/2024 03:31:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3556) +- tensor(0.1819)
F1 for r=0.3 = 0.322
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.414
WIoU for r=0.6 = 0.311
F1 for r=0.9 = 0.499
WIoU for r=0.9 = 0.392
F1 for r=1.0 = 0.500
WIoU for r=1.0 = 0.394
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1401) +- tensor(0.0669)
F1 for r=0.3 = 0.303
WIoU for r=0.3 = 0.281
F1 for r=0.6 = 0.250
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.226
WIoU for r=0.9 = 0.238
F1 for r=1.0 = 0.240
WIoU for r=1.0 = 0.242
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0604) +- tensor(0.0247)
F1 for r=0.3 = 0.190
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.140
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.114
WIoU for r=0.9 = 0.244
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.243


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.314
Model XAI F1 of binarized graphs for r=0.3 =  0.3219128
Model XAI WIoU of binarized graphs for r=0.3 =  0.2455808
len(reference) = 2466
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF++ for r=0.3 class 0 = 0.746 +- 0.149 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 1 = 0.762 +- 0.149 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 class 2 = 0.78 +- 0.149 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 all KL = 0.87 +- 0.149 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.3 all L1 = 0.762 +- 0.145 (in-sample avg dev_std = 0.307)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.402
Model XAI F1 of binarized graphs for r=0.6 =  0.41407839999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.3106804
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.407
SUFF++ for r=0.6 class 0 = 0.555 +- 0.258 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.6 class 1 = 0.645 +- 0.258 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.6 class 2 = 0.578 +- 0.258 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.6 all KL = 0.641 +- 0.258 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.6 all L1 = 0.592 +- 0.195 (in-sample avg dev_std = 0.512)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.732
Model XAI F1 of binarized graphs for r=0.9 =  0.49926159999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.3918572
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.634
SUFF++ for r=0.9 class 0 = 0.565 +- 0.294 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 class 1 = 0.81 +- 0.294 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 class 2 = 0.602 +- 0.294 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 all KL = 0.669 +- 0.294 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.9 all L1 = 0.657 +- 0.265 (in-sample avg dev_std = 0.476)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.487
Model XAI F1 of binarized graphs for r=0.3 =  0.3028744
Model XAI WIoU of binarized graphs for r=0.3 =  0.2811976
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.444
SUFF++ for r=0.3 class 0 = 0.719 +- 0.249 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 1 = 0.841 +- 0.249 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 class 2 = 0.7 +- 0.249 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all KL = 0.781 +- 0.249 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.197 (in-sample avg dev_std = 0.445)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.536
Model XAI F1 of binarized graphs for r=0.6 =  0.2504372
Model XAI WIoU of binarized graphs for r=0.6 =  0.2482296
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.484
SUFF++ for r=0.6 class 0 = 0.616 +- 0.266 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 class 1 = 0.778 +- 0.266 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 class 2 = 0.639 +- 0.266 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 all KL = 0.671 +- 0.266 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.6 all L1 = 0.678 +- 0.227 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.22638999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.23801279999999997
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.606
SUFF++ for r=0.9 class 0 = 0.638 +- 0.277 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.277 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.9 class 2 = 0.642 +- 0.277 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.9 all KL = 0.724 +- 0.277 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.9 all L1 = 0.678 +- 0.240 (in-sample avg dev_std = 0.421)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.518
Model XAI F1 of binarized graphs for r=0.3 =  0.1901148
Model XAI WIoU of binarized graphs for r=0.3 =  0.2664516
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.458
SUFF++ for r=0.3 class 0 = 0.579 +- 0.287 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.287 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 class 2 = 0.587 +- 0.287 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 all KL = 0.582 +- 0.287 (in-sample avg dev_std = 0.596)
SUFF++ for r=0.3 all L1 = 0.615 +- 0.178 (in-sample avg dev_std = 0.596)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.454
Model XAI F1 of binarized graphs for r=0.6 =  0.14014880000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.25262439999999997
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.453
SUFF++ for r=0.6 class 0 = 0.727 +- 0.223 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1 = 0.81 +- 0.223 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 2 = 0.764 +- 0.223 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.807 +- 0.223 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.767 +- 0.225 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  0.11359359999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.244088
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.41
SUFF++ for r=0.9 class 0 = 0.886 +- 0.168 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 class 1 = 0.891 +- 0.168 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 class 2 = 0.898 +- 0.168 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 all KL = 0.908 +- 0.168 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 all L1 = 0.891 +- 0.127 (in-sample avg dev_std = 0.192)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.312
Model XAI F1 of binarized graphs for r=0.3 =  0.3219128
Model XAI WIoU of binarized graphs for r=0.3 =  0.2455808
len(reference) = 2500
Effective ratio: 0.313 +- 0.011
Model Accuracy over intervened graphs for r=0.3 =  0.286
NEC for r=0.3 class 0 = 0.245 +- 0.173 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.223 +- 0.173 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.203 +- 0.173 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.113 +- 0.173 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.224 +- 0.183 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.402
Model XAI F1 of binarized graphs for r=0.6 =  0.41407839999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.3106804
len(reference) = 2500
Effective ratio: 0.613 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.388
NEC for r=0.6 class 0 = 0.46 +- 0.292 (in-sample avg dev_std = 0.478)
NEC for r=0.6 class 1 = 0.386 +- 0.292 (in-sample avg dev_std = 0.478)
NEC for r=0.6 class 2 = 0.453 +- 0.292 (in-sample avg dev_std = 0.478)
NEC for r=0.6 all KL = 0.383 +- 0.292 (in-sample avg dev_std = 0.478)
NEC for r=0.6 all L1 = 0.434 +- 0.218 (in-sample avg dev_std = 0.478)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.732
Model XAI F1 of binarized graphs for r=0.9 =  0.49926159999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.3918572
len(reference) = 2500
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.489
NEC for r=0.9 class 0 = 0.612 +- 0.309 (in-sample avg dev_std = 0.537)
NEC for r=0.9 class 1 = 0.272 +- 0.309 (in-sample avg dev_std = 0.537)
NEC for r=0.9 class 2 = 0.609 +- 0.309 (in-sample avg dev_std = 0.537)
NEC for r=0.9 all KL = 0.501 +- 0.309 (in-sample avg dev_std = 0.537)
NEC for r=0.9 all L1 = 0.501 +- 0.247 (in-sample avg dev_std = 0.537)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.499784
Model XAI WIoU of binarized graphs for r=1.0 =  0.3938916
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.583 +- 0.322 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 1 = 0.233 +- 0.322 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 2 = 0.595 +- 0.322 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all KL = 0.516 +- 0.322 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all L1 = 0.473 +- 0.246 (in-sample avg dev_std = 0.610)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.487
Model XAI F1 of binarized graphs for r=0.3 =  0.3028744
Model XAI WIoU of binarized graphs for r=0.3 =  0.2811976
len(reference) = 2500
Effective ratio: 0.306 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.315 +- 0.327 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.149 +- 0.327 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.326 +- 0.327 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.214 +- 0.327 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.263 +- 0.277 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.536
Model XAI F1 of binarized graphs for r=0.6 =  0.2504372
Model XAI WIoU of binarized graphs for r=0.6 =  0.2482296
len(reference) = 2500
Effective ratio: 0.606 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.404
NEC for r=0.6 class 0 = 0.434 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.6 class 1 = 0.202 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.6 class 2 = 0.408 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.6 all KL = 0.353 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.6 all L1 = 0.348 +- 0.284 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.22638999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.23801279999999997
len(reference) = 2500
Effective ratio: 0.905 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.449
NEC for r=0.9 class 0 = 0.608 +- 0.325 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.304 +- 0.325 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.607 +- 0.325 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.493 +- 0.325 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.506 +- 0.257 (in-sample avg dev_std = 0.496)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.813
Model XAI F1 of binarized graphs for r=1.0 =  0.23994400000000002
Model XAI WIoU of binarized graphs for r=1.0 =  0.24196320000000002
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.509
NEC for r=1.0 class 0 = 0.621 +- 0.317 (in-sample avg dev_std = 0.510)
NEC for r=1.0 class 1 = 0.265 +- 0.317 (in-sample avg dev_std = 0.510)
NEC for r=1.0 class 2 = 0.551 +- 0.317 (in-sample avg dev_std = 0.510)
NEC for r=1.0 all KL = 0.47 +- 0.317 (in-sample avg dev_std = 0.510)
NEC for r=1.0 all L1 = 0.478 +- 0.249 (in-sample avg dev_std = 0.510)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.518
Model XAI F1 of binarized graphs for r=0.3 =  0.1901148
Model XAI WIoU of binarized graphs for r=0.3 =  0.2664516
len(reference) = 2500
Effective ratio: 0.302 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.361 +- 0.363 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 1 = 0.22 +- 0.363 (in-sample avg dev_std = 0.208)
NEC for r=0.3 class 2 = 0.471 +- 0.363 (in-sample avg dev_std = 0.208)
NEC for r=0.3 all KL = 0.312 +- 0.363 (in-sample avg dev_std = 0.208)
NEC for r=0.3 all L1 = 0.347 +- 0.306 (in-sample avg dev_std = 0.208)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.454
Model XAI F1 of binarized graphs for r=0.6 =  0.14014880000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.25262439999999997
len(reference) = 2500
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.267 +- 0.272 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 1 = 0.199 +- 0.272 (in-sample avg dev_std = 0.362)
NEC for r=0.6 class 2 = 0.337 +- 0.272 (in-sample avg dev_std = 0.362)
NEC for r=0.6 all KL = 0.225 +- 0.272 (in-sample avg dev_std = 0.362)
NEC for r=0.6 all L1 = 0.266 +- 0.254 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.4
Model XAI F1 of binarized graphs for r=0.9 =  0.11359359999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.244088
len(reference) = 2500
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.376
NEC for r=0.9 class 0 = 0.208 +- 0.268 (in-sample avg dev_std = 0.366)
NEC for r=0.9 class 1 = 0.217 +- 0.268 (in-sample avg dev_std = 0.366)
NEC for r=0.9 class 2 = 0.265 +- 0.268 (in-sample avg dev_std = 0.366)
NEC for r=0.9 all KL = 0.249 +- 0.268 (in-sample avg dev_std = 0.366)
NEC for r=0.9 all L1 = 0.229 +- 0.195 (in-sample avg dev_std = 0.366)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.438
Model XAI F1 of binarized graphs for r=1.0 =  0.1129528
Model XAI WIoU of binarized graphs for r=1.0 =  0.2432096
len(reference) = 2500
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.388
NEC for r=1.0 class 0 = 0.338 +- 0.308 (in-sample avg dev_std = 0.392)
NEC for r=1.0 class 1 = 0.336 +- 0.308 (in-sample avg dev_std = 0.392)
NEC for r=1.0 class 2 = 0.312 +- 0.308 (in-sample avg dev_std = 0.392)
NEC for r=1.0 all KL = 0.324 +- 0.308 (in-sample avg dev_std = 0.392)
NEC for r=1.0 all L1 = 0.329 +- 0.247 (in-sample avg dev_std = 0.392)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.899, 0.807, 0.868, 1.0], 'all_L1': [0.781, 0.768, 0.814, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.75, 0.863, 1.0], 'all_L1': [0.803, 0.72, 0.836, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.79, 0.899, 1.0], 'all_L1': [0.865, 0.779, 0.88, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.705, 0.53, 0.683, 1.0], 'all_L1': [0.706, 0.523, 0.696, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.641, 0.669, 1.0], 'all_L1': [0.762, 0.592, 0.657, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.116, 0.334, 0.513, 0.487], 'all_L1': [0.236, 0.363, 0.514, 0.479]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.383, 0.541, 0.541], 'all_L1': [0.203, 0.414, 0.504, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.115, 0.444, 0.547, 0.561], 'all_L1': [0.158, 0.433, 0.492, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.512, 0.557, 0.574], 'all_L1': [0.351, 0.51, 0.494, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.383, 0.501, 0.516], 'all_L1': [0.224, 0.434, 0.501, 0.473]})]

Eval split val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.941, 0.77, 0.797, 1.0], 'all_L1': [0.881, 0.746, 0.743, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.848, 0.743, 0.765, 1.0], 'all_L1': [0.8, 0.725, 0.701, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.82, 0.818, 0.802, 1.0], 'all_L1': [0.818, 0.753, 0.804, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.63, 0.627, 1.0], 'all_L1': [0.652, 0.586, 0.618, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.781, 0.671, 0.724, 1.0], 'all_L1': [0.754, 0.678, 0.678, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.143, 0.216, 0.388, 0.357], 'all_L1': [0.198, 0.262, 0.417, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.295, 0.477, 0.497, 0.439], 'all_L1': [0.346, 0.454, 0.501, 0.426]}), defaultdict(<class 'list'>, {'all_KL': [0.334, 0.45, 0.43, 0.494], 'all_L1': [0.323, 0.469, 0.421, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.495, 0.617, 0.626], 'all_L1': [0.419, 0.491, 0.56, 0.558]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.353, 0.493, 0.47], 'all_L1': [0.263, 0.348, 0.506, 0.478]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.896, 0.525, 0.575, 1.0], 'all_L1': [0.841, 0.606, 0.734, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.659, 0.826, 1.0], 'all_L1': [0.579, 0.703, 0.852, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.732, 0.833, 1.0], 'all_L1': [0.732, 0.747, 0.828, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.502, 0.786, 1.0], 'all_L1': [0.555, 0.542, 0.741, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.807, 0.908, 1.0], 'all_L1': [0.615, 0.767, 0.891, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.143, 0.371, 0.361, 0.405], 'all_L1': [0.188, 0.34, 0.251, 0.261]}), defaultdict(<class 'list'>, {'all_KL': [0.398, 0.243, 0.188, 0.168], 'all_L1': [0.422, 0.232, 0.157, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.268, 0.198, 0.314], 'all_L1': [0.389, 0.269, 0.244, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.58, 0.422, 0.473], 'all_L1': [0.486, 0.538, 0.419, 0.433]}), defaultdict(<class 'list'>, {'all_KL': [0.312, 0.225, 0.249, 0.324], 'all_L1': [0.347, 0.266, 0.229, 0.329]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.783 +- 0.052, 0.676 +- 0.101, 0.777 +- 0.085, 1.000 +- 0.000
suff++ class all_KL  =  0.855 +- 0.076, 0.704 +- 0.104, 0.796 +- 0.099, 1.000 +- 0.000
suff++_acc_int  =  0.357 +- 0.028, 0.505 +- 0.072, 0.741 +- 0.059
nec class all_L1  =  0.234 +- 0.064, 0.431 +- 0.047, 0.501 +- 0.008, 0.485 +- 0.009
nec class all_KL  =  0.159 +- 0.099, 0.411 +- 0.061, 0.532 +- 0.021, 0.536 +- 0.031
nec_acc_int  =  0.325 +- 0.021, 0.410 +- 0.015, 0.504 +- 0.015, 0.546 +- 0.009

Eval split val
suff++ class all_L1  =  0.781 +- 0.076, 0.698 +- 0.062, 0.709 +- 0.062, 1.000 +- 0.000
suff++ class all_KL  =  0.802 +- 0.104, 0.726 +- 0.068, 0.743 +- 0.064, 1.000 +- 0.000
suff++_acc_int  =  0.486 +- 0.051, 0.547 +- 0.082, 0.641 +- 0.034
nec class all_L1  =  0.310 +- 0.075, 0.405 +- 0.087, 0.481 +- 0.055, 0.462 +- 0.064
nec class all_KL  =  0.286 +- 0.103, 0.398 +- 0.103, 0.485 +- 0.078, 0.477 +- 0.088
nec_acc_int  =  0.351 +- 0.010, 0.419 +- 0.022, 0.475 +- 0.025, 0.506 +- 0.013

Eval split test
suff++ class all_L1  =  0.664 +- 0.107, 0.673 +- 0.086, 0.809 +- 0.062, 1.000 +- 0.000
suff++ class all_KL  =  0.659 +- 0.163, 0.645 +- 0.117, 0.786 +- 0.112, 1.000 +- 0.000
suff++_acc_int  =  0.504 +- 0.083, 0.464 +- 0.054, 0.400 +- 0.014
nec class all_L1  =  0.366 +- 0.100, 0.329 +- 0.110, 0.260 +- 0.086, 0.297 +- 0.099
nec class all_KL  =  0.346 +- 0.122, 0.337 +- 0.131, 0.284 +- 0.093, 0.337 +- 0.102
nec_acc_int  =  0.358 +- 0.012, 0.373 +- 0.011, 0.360 +- 0.013, 0.362 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.509 +- 0.012, 0.554 +- 0.035, 0.639 +- 0.043, 0.742 +- 0.005
Faith. Armon (L1)= 		  =  0.354 +- 0.066, 0.519 +- 0.022, 0.607 +- 0.028, 0.653 +- 0.009
Faith. GMean (L1)= 	  =  0.423 +- 0.042, 0.536 +- 0.026, 0.623 +- 0.035, 0.696 +- 0.007
Faith. Aritm (KL)= 		  =  0.507 +- 0.013, 0.557 +- 0.038, 0.664 +- 0.053, 0.768 +- 0.016
Faith. Armon (KL)= 		  =  0.251 +- 0.112, 0.510 +- 0.034, 0.635 +- 0.038, 0.697 +- 0.027
Faith. GMean (KL)= 	  =  0.351 +- 0.076, 0.533 +- 0.032, 0.650 +- 0.045, 0.732 +- 0.021

Eval split val
Faith. Aritm (L1)= 		  =  0.545 +- 0.024, 0.551 +- 0.042, 0.595 +- 0.011, 0.731 +- 0.032
Faith. Armon (L1)= 		  =  0.434 +- 0.068, 0.504 +- 0.070, 0.568 +- 0.021, 0.629 +- 0.060
Faith. GMean (L1)= 	  =  0.485 +- 0.045, 0.526 +- 0.056, 0.581 +- 0.013, 0.678 +- 0.047
Faith. Aritm (KL)= 		  =  0.544 +- 0.029, 0.562 +- 0.054, 0.614 +- 0.013, 0.739 +- 0.044
Faith. Armon (KL)= 		  =  0.403 +- 0.098, 0.503 +- 0.094, 0.579 +- 0.035, 0.641 +- 0.079
Faith. GMean (KL)= 	  =  0.465 +- 0.065, 0.531 +- 0.075, 0.596 +- 0.024, 0.688 +- 0.063

Eval split test
Faith. Aritm (L1)= 		  =  0.515 +- 0.026, 0.501 +- 0.027, 0.535 +- 0.033, 0.648 +- 0.050
Faith. Armon (L1)= 		  =  0.453 +- 0.077, 0.423 +- 0.065, 0.383 +- 0.087, 0.448 +- 0.123
Faith. GMean (L1)= 	  =  0.481 +- 0.048, 0.460 +- 0.044, 0.451 +- 0.062, 0.536 +- 0.098
Faith. Aritm (KL)= 		  =  0.503 +- 0.047, 0.491 +- 0.036, 0.535 +- 0.050, 0.668 +- 0.051
Faith. Armon (KL)= 		  =  0.421 +- 0.093, 0.414 +- 0.069, 0.402 +- 0.089, 0.495 +- 0.120
Faith. GMean (KL)= 	  =  0.456 +- 0.062, 0.450 +- 0.047, 0.461 +- 0.065, 0.573 +- 0.094
Computed for split load_split = id



Completed in  1:36:03.768885  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size
DONE all :)
